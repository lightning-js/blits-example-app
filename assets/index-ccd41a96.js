var Nb=Object.defineProperty;var Ob=(h,r,i)=>r in h?Nb(h,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):h[r]=i;var L=(h,r,i)=>(Ob(h,typeof r!="symbol"?r+"":r,i),i);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const y of d)if(y.type==="childList")for(const x of y.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&u(x)}).observe(document,{childList:!0,subtree:!0});function i(d){const y={};return d.integrity&&(y.integrity=d.integrity),d.referrerPolicy&&(y.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?y.credentials="include":d.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function u(d){if(d.ep)return;d.ep=!0;const y=i(d);fetch(d.href,y)}})();const ue={currentView:Symbol("currentView"),cursorTagStart:Symbol("cursorTagStart"),computedKeys:Symbol("computedKeys"),destroy:Symbol("destroy"),getChildren:Symbol("getChildren"),holder:Symbol("holder"),id:Symbol("id"),identifier:Symbol("identifier"),index:Symbol("index"),init:Symbol("init"),inputEvents:Symbol("inputEvents"),intervals:Symbol("intervals"),level:Symbol("level"),methodKeys:Symbol("methodKeys"),originalState:Symbol("originalState"),pluginsRegistered:Symbol("pluginsRegistered"),propKeys:Symbol("propKeys"),raw:Symbol("raw"),ready:Symbol("ready"),renderer:Symbol("renderer"),routes:Symbol("routes"),settings:Symbol("settings"),state:Symbol("state"),stateKeys:Symbol("stateKeys"),textnode:Symbol("textnode"),timeouts:Symbol("timeouts"),type:Symbol("type"),watchers:Symbol("watchers"),watchKeys:Symbol("watchKeys"),wrapper:Symbol("wrapper"),children:Symbol.for("children"),components:Symbol.for("components"),isSlot:Symbol.for("isSlot"),props:Symbol.for("props"),slots:Symbol.for("slots"),componentType:Symbol.for("componentType")},Mi={[ue.settings]:{},get(h,r=null){return h in this[ue.settings]?this[ue.settings][h]:r},set(h,r){typeof h=="object"?Object.keys(h).forEach(i=>{this.set(i,h[i])}):this[ue.settings][h]=r}},Ku=()=>{},Bd=()=>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),n2=h=>{const r=Mi.get("debugLevel"),i={};return Object.defineProperty(i,"info",{get(){return(r>=1||Array.isArray(r)&&r.indexOf("info")>-1)&&console.info.bind(window.console,`%c ⚡️ ${h} %c ${Bd()}`,"background-color: #0284c7; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Ku}}),Object.defineProperty(i,"warn",{get(){return(r>=1||Array.isArray(r)&&r.indexOf("warn")>-1)&&console.warn.bind(window.console,`%c ⚡️ ${h} %c ${Bd()}`,"background-color: #fbbf24; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Ku}}),Object.defineProperty(i,"error",{get(){return(r>=1||Array.isArray(r)&&r.indexOf("error")>-1)&&console.error.bind(window.console,`%c ⚡️ ${h} %c ${Bd()}`,"background-color: #dc2626; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Ku}}),Object.defineProperty(i,"debug",{get(){return(r>=2||Array.isArray(r)&&r.indexOf("debug")>-1)&&console.debug.bind(window.console,`%c ⚡️ ${h} %c (${new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})`,"background-color: #e2e8f0; color: #334155; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Ku}}),i};let Nt;const Ub=()=>{Nt=n2("Blits")},Aa={aliceblue:"0xf0f8ffff",antiquewhite:"0xfaebd7ff",aqua:"0xffffff00",aquamarine:"0x7fffd4ff",azure:"0xf0ffffff",beige:"0xf5f5dcff",bisque:"0xffe4c4ff",black:"0x000000ff",blanchedalmond:"0xffebcdff",blue:"0x0000ffff",blueviolet:"0x8a2be2ff",brown:"0xa52a2aff",burlywood:"0xdeb887ff",cadetblue:"0x5f9ea0ff",chartreuse:"0x7fff00ff",chocolate:"0xd2691eff",coral:"0xff7f50ff",cornflowerblue:"0x6495edff",cornsilk:"0xfff8dcff",crimson:"0xdc143cff",cyan:"0x00ffffff",darkblue:"0x00008bff",darkcyan:"0x008b8bff",darkgoldenrod:"0xb8860bff",darkgray:"0xa9a9a9ff",darkgreen:"0x006400ff",darkgrey:"0xa9a9a9ff",darkkhaki:"0xbdb76bff",darkmagenta:"0x8b008bff",darkolivegreen:"0x556b2fff",darkorange:"0xff8c00ff",darkorchid:"0x9932ccff",darkred:"0x8b0000ff",darksalmon:"0xe9967aff",darkseagreen:"0x8fbc8fff",darkslateblue:"0x483d8bff",darkslategray:"0x2f4f4fff",darkslategrey:"0x2f4f4fff",darkturquoise:"0x00ced1ff",darkviolet:"0x9400d3ff",deeppink:"0xff1493ff",deepskyblue:"0x00bfffff",dimgray:"0x696969ff",dimgrey:"0x696969ff",dodgerblue:"0x1e90ffff",firebrick:"0xb22222ff",floralwhite:"0xfffaf0ff",forestgreen:"0x228b22ff",fuchsia:"0xff00ffff",gainsboro:"0xdcdcdcff",ghostwhite:"0xf8f8ffff",gold:"0xffd700ff",goldenrod:"0xdaa520ff",gray:"0x808080ff",green:"0x008000ff",greenyellow:"0xadff2fff",grey:"0x808080ff",honeydew:"0xf0fff0ff",hotpink:"0xff69b4ff",indianred:"0xcd5c5cff",indigo:"0x4b0082ff",ivory:"0xfffff0ff",khaki:"0xf0e68cff",lavender:"0xe6e6faff",lavenderblush:"0xfff0f5ff",lawngreen:"0x7cfc00ff",lemonchiffon:"0xfffacdff",lightblue:"0xadd8e6ff",lightcoral:"0xf08080ff",lightcyan:"0xe0ffffff",lightgoldenrodyellow:"0xfafad2ff",lightgray:"0xd3d3d3ff",lightgreen:"0x90ee90ff",lightgrey:"0xd3d3d3ff",lightpink:"0xffb6c1ff",lightsalmon:"0xffa07aff",lightseagreen:"0x20b2aaff",lightskyblue:"0x87cefaff",lightslategray:"0x778899ff",lightslategrey:"0x778899ff",lightsteelblue:"0xb0c4deff",lightyellow:"0xffffe0ff",lime:"0x00ff00ff",limegreen:"0x32cd32ff",linen:"0xfaf0e6ff",magenta:"0xff00ffff",maroon:"0x800000ff",mediumaquamarine:"0x66cdaaff",mediumblue:"0x0000cdff",mediumorchid:"0xba55d3ff",mediumpurple:"0x9370dbff",mediumseagreen:"0x3cb371ff",mediumslateblue:"0x7b68eeff",mediumspringgreen:"0x00fa9aff",mediumturquoise:"0x48d1ccff",mediumvioletred:"0xc71585ff",midnightblue:"0x191970ff",mintcream:"0xf5fffaff",mistyrose:"0xffe4e1ff",moccasin:"0xffe4b5ff",navajowhite:"0xffdeadff",navy:"0x000080ff",oldlace:"0xfdf5e6ff",olive:"0x808000ff",olivedrab:"0x6b8e23ff",orange:"0xffa500ff",orangered:"0xff4500ff",orchid:"0xda70d6ff",palegoldenrod:"0xeee8aaff",palegreen:"0x98fb98ff",paleturquoise:"0xafeeeeff",palevioletred:"0xdb7093ff",papayawhip:"0xffefd5ff",peachpuff:"0xffdab9ff",peru:"0xcd853fff",pink:"0xffc0cbff",plum:"0xdda0ddff",powderblue:"0xb0e0e6ff",purple:"0x800080ff",rebeccapurple:"0x663399ff",red:"0xff0000ff",rosybrown:"0xbc8f8fff",royalblue:"0x4169e1ff",saddlebrown:"0x8b4513ff",salmon:"0xfa8072ff",sandybrown:"0xf4a460ff",seagreen:"0x2e8b57ff",seashell:"0xfff5eeff",sienna:"0xa0522dff",silver:"0xc0c0c0ff",skyblue:"0x87ceebff",slateblue:"0x6a5acdff",slategray:"0x708090ff",slategrey:"0x708090ff",snow:"0xfffafaff",springgreen:"0x00ff7fff",steelblue:"0x4682b4ff",tan:"0xd2b48cff",teal:"0x008080ff",thistle:"0xd8bfd8ff",tomato:"0xff6347ff",transparent:"0x00000000",turquoise:"0x40e0d0ff",violet:"0xee82eeff",wheat:"0xf5deb3ff",white:"0xffffffff",whitesmoke:"0xf5f5f5ff",yellow:"0xffff00ff",yellowgreen:"0x9acd32ff"},Bb=/^#?([0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i,jb=/^(rgba?)\((\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*)(,(\s*(-?\d+(?:\.\d+)?)\s*))?\)$/,Fb=/^(hsla?)\((\s*(360|3[0-5][0-9]|[12]?[0-9]{1,2})\s*),(\s*(100|[1-9]?[0-9])\s*)%,(\s*(100|[1-9]?[0-9])\s*)%(,(\s*(1|0(?:\.\d+)?)\s*))?\)$/,jd={},Yu=h=>{if(jd[h]!==void 0)return jd[h];const r=parseInt(h).toString(16).padStart(2,"0");return jd[h]=r,r},hs={normalize:(h="",r="0xffffffff")=>{if(h=h.toString(),Aa[h]!==void 0)return Aa[h];if(h.startsWith("0x")&&h.length===10)return Aa[h]=h,h;if(Bb.test(h)){h=h.replace("#","").toLowerCase(),h.length===3&&(h=h.split("").map(d=>d+d).join(""));const u="0x"+h.padEnd(8,"f");return Aa[h]=u,u}const i=jb.exec(h);if(i){const u=Yu(i[3]),d=Yu(i[5]),y=Yu(i[7]);let x="ff";if(i[10]&&i[1]==="rgba"){const g=Math.min(Math.max(Math.round(parseFloat(i[10])*255),0),255);x=Yu(g)}const s="0x"+u+d+y+x;return Aa[h]=s,s}return Fb.test(h)?(console.warn("HSL(A) color format is not supported yet"),"0xffffffff"):r}},zb=(h="",r,i,u=null)=>{let d=0,y=0,x=[],s=null,g=0;const M=/^<\/?([a-zA-Z0-9_\-.]+)\s*/,A=/^\s*(\/?>)\s*/,k=/^([A-Za-z0-9:.\-_@]+)=\s*(["'])/,b=/^<>\s*/,P=/^\s*(<\/>)\s*/,w=()=>{h=B(h);try{return R(W),fe(x)}catch(ne){throw(ne.name=="TemplateParseError"||ne.name=="TemplateStructureError")&&(ne.message=`${ne.message}
${ne.context}`),ne}},R=ne=>{d>=h.length||ne()},B=ne=>ne.replace(/<!--.*?-->/gms,"").replace(/\r?\n\s*\r\n/gm," ").replace(/\r?\n\s*(\S)/gm," $1").replace(/\r?\n/g,"").trim(),U=ne=>{const le=h.slice(d).match(ne);return le&&(y=d,d+=le[0].length),le},W=()=>{U(b)?(x.push({[Symbol.for("componentType")]:null,[ue.type]:"opening",[ue.level]:g,[ue.cursorTagStart]:y}),g++,R(W)):R(G)},G=()=>{U(P)?(g--,x.push({[Symbol.for("componentType")]:null,[ue.type]:"closing",[ue.level]:g}),R(W)):R(Q)},Q=()=>{const ne=U(M);if(ne)s={[Symbol.for("componentType")]:ne[1],[ue.level]:g,[ue.cursorTagStart]:y},ne[0].startsWith("</")?(g--,s[ue.type]="closing",s[ue.level]=g):(s[ue.type]="opening",g++),R(ee);else throw re("InvalidTag")},ee=()=>{const ne=U(A);if(ne){if(ne[1]==="/>"){if(s[ue.type]==="closing")throw re("InvalidClosingTag");s[ue.type]="self-closing",g--}if(s[ue.type]==="opening"){const le=h.slice(d,h.indexOf("<",d));le&&(s.content=le,d+=le.length)}x.push(s),R(W)}else R(Z)},Z=()=>{const ne=U(k);if(ne){if(s[ue.type]==="closing")throw re("AttributesInClosingTag");const le=ne[2],xe=new RegExp(`^(.*?)${le}\\s*`),we=U(xe);if(we){const Te=H(ne[1],we[1]);s[Te.name]=Te.value,R(ee)}else throw re("MissingOrInvalidAttributeValue")}else throw re("InvalidAttribute")},H=(ne,le)=>{if(ne.includes(".")){const[xe,we]=ne.split(".");return{name:xe,value:`{${we}: ${le}}`}}return["color",":color",":effects","effects"].includes(ne)?J(ne,le):{name:ne,value:le}},J=(ne,le)=>{let xe=le,we=hs.normalize(xe,null);if(we===null){const Te=/'([^']+)'/g;let Ie,Ee=0,_e="";for(;(Ie=Te.exec(le))!==null;){const z=Ie[1],Re=Ie.index,Ae=Ie[0].length;_e+=le.slice(Ee,Re),we=hs.normalize(z,null),we===null?_e+=le.slice(Re,Re+Ae):_e+=`'${we}'`,Ee=Re+Ae}_e+=le.slice(Ee),xe=_e}else xe=we;return{name:ne,value:xe}},fe=ne=>{let le=[],xe=!1,we={children:[]},Te=we;for(let Ie=0;Ie<ne.length;Ie++){let Ee=ne[Ie];if(Ee[ue.level]===0&&Ee[ue.type]!=="closing"){if(xe)throw ye("MultipleTopLevelTags",Ee);xe=!0}if(Ee[ue.type]==="opening")le.push({[ue.level]:Ee[ue.level],[ue.type]:Ee[ue.type],[ue.cursorTagStart]:Ee[ue.cursorTagStart],[Symbol.for("componentType")]:Ee[Symbol.for("componentType")],parent:Te});else if(Ee[ue.type]==="closing"){const z=le.length===0;let Re=!1,Ae=!1;if(z||(Re=le[le.length-1][ue.level]!==Ee[ue.level],Ae=le[le.length-1][Symbol.for("componentType")]!==Ee[Symbol.for("componentType")]),z||Re||Ae)throw ye("MismatchedClosingTag",Ee);Te=le.pop().parent}const _e={...Ee};delete _e[ue.type],delete _e[ue.level],delete _e[ue.cursorTagStart],Ee[ue.type]==="opening"?(Ie+1<ne.length&&ne[Ie+1][ue.type]!=="closing"&&(_e.children=[]),Te.children.push(_e),Te=_e):Ee[ue.type]==="self-closing"&&Te.children.push(_e)}if(le.length>0)throw ye("UnclosedTags",le);return we},E=10,F=50,re=ne=>{const le=se();ne=`${ne} in ${le}`;const xe=new Error(ne);xe.name="TemplateParseError";const we=Math.max(0,y-E),Te=Math.min(h.length,d+F),Ie=h.slice(we,Te),Ee=d-we;return xe.context=ie(Ee,Ie),xe},ye=(ne,le)=>{const xe=se();ne=`${ne} in ${xe}`;const we=new Error(ne);we.name="TemplateStructureError",Array.isArray(le)?we.context=le.map(Ie=>Te(Ie)).join(`
`):we.context=Te(le);function Te(Ie){const Ee=Math.max(0,Ie[ue.cursorTagStart]-E),_e=h.slice(Ee,Ee+F);return ie(E,_e)}return we},ie=(ne,le)=>{const xe=" ".repeat(ne)+"^";return`
${le}
${xe}
`},se=()=>{if(i){let ne=r||"",le=i;for(;le;)ne=`${le[Symbol.for("componentType")]}/${ne}`,le=le.parent;return ne}return u||"Blits.Application"};return w()};let mt;function Vb(h={children:[]}){const r={renderCode:["const elms = []","let componentType","const rootComponent = component"],effectsCode:[],context:{props:[],components:this.components}};return mt=-1,o2.call(r,h),r.renderCode.push("return elms"),{render:new Function("parent","component","context","components","effect","getRaw",r.renderCode.join(`
`)),effects:r.effectsCode.map(i=>new Function("component","elms","context","components","rootComponent","effect",i)),context:r.context}}const Af=function(h,r=!1,i={key:!1,component:"component.",forceEffect:!1,forloop:!1}){const u=i.forceEffect?this.effectsCode:this.renderCode;r&&u.push(`parent = ${r}`),"key"in h&&(i.key=gi(h.key,i.component));const d=i.key?`elms[${mt}][${i.key}]`:`elms[${mt}]`;i.key&&u.push(`
      if(elms[${mt}] === undefined) {
        elms[${mt}] = {}
      }
    `),u.push(`const elementConfig${mt} = {}`),i.forloop&&u.push(`if(!${d}) {`),u.push(`
    ${d} = this.element({parent: parent || 'root'}, component)
  `),i.forloop&&u.push("}");const y=h.children;delete h.children,h[Symbol.for("componentType")]==="Slot"&&u.push(`elementConfig${mt}[Symbol.for('isSlot')] = true`),Object.keys(h).forEach(x=>{if(x==="slot"&&u.push(`
        elementConfig${mt}['parent'] = component[Symbol.for('slots')].filter(slot => slot.ref === '${h.slot}').shift() || component[Symbol.for('slots')][0] || parent
      `),x!=="key")if(r2(x)){if(i.holder&&x===":color")return;this.effectsCode.push(`${d}.set('${x.substring(1)}', ${gi(h[x],i.component)})`),u.push(`elementConfig${mt}['${x.substring(1)}'] = ${gi(h[x],i.component)}`)}else u.push(`elementConfig${mt}['${x}'] = ${yp(h[x],x,i.component)}`)}),i.holder===!0&&u.push(`
    if(typeof cmp${mt} !== 'undefined') {
      for(let key in cmp${mt}.config.props) {
        delete elementConfig${mt}[cmp${mt}.config.props[key]]
      }
    }
    `),i.forloop&&u.push(`if(!${d}.nodeId) {`),u.push(`${d}.populate(elementConfig${mt})`),i.forloop&&u.push("}"),y&&o2.call(this,{children:y},`${d}`,i)},i2=function(h,r=!1,i={key:!1,component:"component.",forceEffect:!1,holder:!1,forloop:!1}){const u=i.forceEffect?this.effectsCode:this.renderCode;u.push(`
    const cmp${mt} =
      (context.components && context.components['${h[Symbol.for("componentType")]}']) || components['${h[Symbol.for("componentType")]}']
  `),"key"in h&&(i.key=gi(h.key,i.component));const d=h.children;delete h.children,Af.call(this,h,r,{...i,holder:!0}),r=i.key?`elms[${mt}][${i.key}]`:`elms[${mt}]`,mt++;const y=i.key?`elms[${mt}][${i.key}]`:`elms[${mt}]`;i.key&&u.push(`
      if(elms[${mt}] === undefined) {
        elms[${mt}] = {}
      }
    `),r&&u.push(`parent = ${r}`),u.push(`const props${mt} = {}`),Object.keys(h).forEach(x=>{r2(x)?(this.effectsCode.push(`
        ${y}[Symbol.for('props')]['${x.substring(1)}'] = ${gi(h[x],i.component)}`),u.push(`props${mt}['${x.substring(1)}'] = ${gi(h[x],i.component)}`)):u.push(`props${mt}['${x}'] = ${yp(h[x],x,i.component)}`)}),i.forloop&&u.push(`if(!${y}) {`),u.push(`
    componentType = props${mt}['is'] || '${h[Symbol.for("componentType")]}'

    let component${mt}
    if(typeof componentType === 'string') {
      component${mt} = context.components && context.components[componentType] || components[componentType]
      if(!component${mt}) {
        throw new Error('Component "${h[Symbol.for("componentType")]}" not found')
      }
    } else if(typeof componentType === 'function' && componentType.name === 'factory') {
      component${mt} = componentType
    }

    ${y} = component${mt}.call(null, {props: props${mt}}, ${r}, component)

    if (${y}[Symbol.for('slots')][0]) {
      parent = ${y}[Symbol.for('slots')][0]
      component = ${y}
    } else {
      parent = ${y}[Symbol.for('children')][0]
    }
  `),i.forloop&&u.push("}"),d&&(mt++,Af.call(this,{children:d},!1,{...i}))},Hb=function(h,r){const i=h[":for"];delete h[":for"];const u=h.key,d=gi(u,"scope.");delete h.key;const x=/(.+)\s+in\s+(.+)/gi.exec(i),[s,g="index"]=x[1].replace("(","").replace(")","").split(/\s*,\s*/),M=new RegExp(`(scope\\.(?!${s}\\.|${g}|key)(\\w+))`,"gi"),A={renderCode:[],effectsCode:[],context:{props:[],components:this.components}};r&&A.renderCode.push(`parent = ${r}`);const k=mt;A.renderCode.push(`
    const created${k} = []
    const forloop${k} = (collection = [], elms, created) => {
      const rawCollection = getRaw(collection)
      const keys = new Set(rawCollection.map((${s}) => '' +  ${gi(u,"")}))
  `);const b=A.renderCode.length;A.renderCode.push(`
      created.length = 0
      const length = collection.length
      for(let __index = 0; __index < length; __index++) {
        const scope = Object.create(component)
        parent = ${r}
        scope['${g}'] = __index
        scope['${s}'] = rawCollection[__index]
        scope['key'] = ${d||"__index"}
  `),"ref"in h&&h.ref.indexOf("$")===-1&&(A.renderCode.push(`
        scope['__ref'] = '${h.ref}' + __index
    `),h.ref="$__ref"),A.renderCode.push(`
        created.push(scope.key)
  `),h[Symbol.for("componentType")]==="Element"||h[Symbol.for("componentType")]==="Slot"||h[Symbol.for("componentType")]==="Text"?Af.call(A,h,r,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0}):i2.call(A,h,!1,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0});const P=A.effectsCode.filter(U=>[...U.matchAll(M)].length===0),w=A.effectsCode.filter(U=>[...U.matchAll(M)].length!==0);A.renderCode.push(`
    scope['${s}'] = collection[__index]
  `),P.forEach(U=>{const W=U.indexOf(`scope.${g}`)>-1?`'${gi(x[2],"")}'`:null;A.renderCode.push(`
      effect(() => {
        ${U}
      }, ${W})
    `)}),A.renderCode.push(`
      if(elms[${k}][0] && elms[${k}][0].forComponent && elms[${k}][0].forComponent.___layout) {
        elms[${k}][0].forComponent.___layout()
      }
    }
  }`);const R=[];R.push(`
      let i = created.length

      while (i--) {
        const key = created[i]
        if (!keys.has(key)) {
  `);const B=mt;for(let U=k;U<=B;U++)R.push(`
          elms[${U}][key] && elms[${U}][key].destroy()
          delete elms[${U}][key]
      `);R.push(`
       }
    }
  `),A.renderCode.splice(b,0,...R),A.renderCode.push(`
    effect(() => {
      forloop${k}(${yp(x[2],":for")}, elms, created${k})
    }, '${gi(x[2],"")}')
  `),w.forEach(U=>{const W=[...U.matchAll(M)];let G=W.length;const Q=[];for(;G--;){const ee=W[G],Z=`component.${ee[2]}`;Q.indexOf(Z)===-1&&Q.push(Z),U=U.substring(0,ee.index)+Z+U.substring(ee.index+ee[1].length)}A.renderCode.push(`
      effect(() => {
        void ${Q.join(", ")}
        for(let __index = 0; __index < ${gi(x[2])}.length; __index++) {
          const scope = {}
          scope['${g}'] = __index
          scope['${s}'] = ${gi(x[2])}[__index]
          scope['key'] = ${d||"__index"}
    `),A.renderCode.push(`
          ${U}
        }
      })
    `)}),this.renderCode.push(A.renderCode.join(`
`))},o2=function(h,r=!1,i={}){h.children&&h.children.forEach(u=>{mt++,Object.keys(u).indexOf(":for")>-1?Hb.call(this,u,r):u[Symbol.for("componentType")]==="Element"||u[Symbol.for("componentType")]==="Slot"||u[Symbol.for("componentType")]==="Text"?(u[Symbol.for("componentType")]==="Text"&&(u.__textnode="true"),Af.call(this,u,r,i)):i2.call(this,u,r,i)})},gi=(h,r="component.")=>{if(h===void 0)return h;const i=/('.*?')+/gi,u=/\$(\$(?=\$)|\$?)/g,d=h.matchAll(i),y=[];let x=0;for(const s of d)y.push(s[0]),h=h.replace(s[0],`[@@REPLACEMENT${x}@@]`),x++;return h=h.replace(u,(s,g)=>{if(g==="")return r;if(g==="$")return r+"$"}),y.forEach((s,g)=>{h=h.replace(`[@@REPLACEMENT${g}@@]`,s)}),h},yp=(h="",r=!1,i="component.")=>{let u;if(r==="content")if(h.startsWith("$"))u=`${i}${h.replace("$","")}`;else{const d=h.replace(/\\\\/g,"__DOUBLE_BACKSLASH__").replace(/(^|[^\\])'/g,"$1\\'").replace(/__DOUBLE_BACKSLASH__/g,"\\\\");u=`'${$b(d,i)}'`}else if(r!=="color"&&!isNaN(parseFloat(h))){if(u=parseFloat(h),h.endsWith("%")){const y={w:"width",width:"width",x:"width",h:"height",height:"height",y:"height"}[r];y&&(u=`parent.node.${y} * (${u} / 100)`)}}else if(h.toLowerCase()==="true")u=!0;else if(h.toLowerCase()==="false")u=!1;else if(r.startsWith("@")&&h){const d=i.slice(0,-1);u=`${d}['${h.replace("$","")}'] && ${d}['${h.replace("$","")}'].bind(${d})`}else h.startsWith("$")?u=`${i}${h.replace("$","")}`:u=`"${h}"`;return u},r2=h=>h.startsWith(":"),$b=(h,r)=>{const i=/\{\{\s*(\$\S+)\s*\}\}/g,u=[...h.matchAll(i)];if(u.length)for(let[d,y]of u)h=h.replace(d,`${y.replace("$",`'+${r}`)}+'`);return h},Ex={};let Gb=0;const Wb=h=>`BlitsComponent::${h}_${Ex[h]=(Ex[h]||0)+1}`,Xb=()=>++Gb,Eo={},Qd=(h,r,i,u=[])=>{Eo[r]&&Eo[r][h]&&Eo[r][h].apply(i,u)},Kb=(h,r,i)=>{const u=ue[h];Eo[r]&&Eo[r][u]&&Eo[r][u].apply(i)},Yb=(h={},r)=>{Eo[r]={},[...Object.keys(h),...Object.getOwnPropertySymbols(h)].forEach(u=>{typeof h[u]=="function"&&(Eo[r][u]=h[u])})};let Oa=null,bf=null,jf=!1;const qb=()=>{jf=!0},Qb=()=>{jf=!1},Zd=new WeakMap,yf=(h,r)=>{if(Oa){if(jf||bf!==null&&r!==bf)return;let i=Zd.get(h);i||(i=new Map,Zd.set(h,i));let u=i.get(r);u||(u=new Set,i.set(r,u)),u.add(Oa)}},ds=(h,r,i=!1)=>{if(jf===!0)return;const u=Zd.get(h);if(!u)return;const d=u.get(r);if(d)for(let y of d)y(i)},qu=(h,r=null)=>{Oa=h,bf=r,Oa(),Oa=null,bf=null},vf=["push","pop","shift","unshift","splice","sort"],Ax=new WeakMap,fs=h=>{const r=h&&h[ue.raw];return r?fs(r):h},Jd=(h,r=null,i)=>{if(typeof h=="object"&&h[ue.id]||h.constructor.name==="_ImageTexture")return h;const u=Ax.get(h);if(u)return u;const d={get(x,s,g){return s===ue.raw?h:Array.isArray(x)?typeof x[s]=="object"&&x[s]!==null?(Array.isArray(x[s])&&yf(x,s),Jd(fs(x[s]),x,s)):vf.indexOf(s)!==-1?function(...M){qb();const A=x[s].apply(this,M);return Qb(),ds(r,i),A}:s==="length"?h.length:Reflect.get(x,s,g):typeof x[s]=="object"&&x[s]!==null?(Array.isArray(x[s])&&yf(x,s),Jd(fs(x[s]),x,s)):(yf(x,s),Reflect.get(x,s,g))},set(x,s,g,M){const A=fs(x[s]),k=fs(g);let b=!0;return A!==k&&(b=Reflect.set(x,s,g,M)),b&&A!==k&&(Array.isArray(x)&&s in x&&ds(r,i,!0),ds(x,s,!0)),b}},y=new Proxy(h,d);return Ax.set(h,y),y},s2=h=>(Object.keys(h).forEach(r=>{let i=h[r];if(h[r]!==null&&typeof h[r]=="object"){if(Object.getPrototypeOf(h[r])===Object.prototype)return s2(h[r]);if(Array.isArray(h[r]))for(let u=0;u<vf.length-1;u++)h[r][vf[u]]=function(d){Array.prototype[vf[u]].call(this,d),ds(h,r)}}Object.defineProperty(h,r,{enumerable:!0,configurable:!0,get(){return yf(h,r),i},set(u){i!==u&&(i=u,ds(h,r))}})}),h),ep=(h,r="Proxy")=>r==="defineProperty"?s2(h):Jd(h),Zb=["init","ready","focus","unfocus","destroy","attach","detach","enter","exit"],Jb={previous:null,current:null,get state(){return this.current},set state(h){Zb.indexOf(h)>-1&&(h!==this.current||h==="focus")&&(Nt.debug(`Setting lifecycle state from ${this.current} to ${h} for ${this.component.componentId}`),this.previous=this.current,this.current=h,Kb(h,this.component[ue.identifier],this.component),Qd(h,this.component[ue.identifier],this.component))}};function eI(h,r){const i={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},u=h.getContext("webgl",i)||h.getContext("experimental-webgl",i);if(!u)throw new Error("Unable to create WebGL context");return r?new Proxy(u,{get(d,y){const x=d[y];return typeof x=="function"?(r.increment(String(y)),x.bind(d)):x}}):u}function Ye(h,r){if(!vp()&&!h)throw new Error(r||"Assertion failed")}function bx(h,r,i){const u=Math.trunc(h>>>24),d=Math.trunc(h>>>16&255),y=Math.trunc(h>>>8&255),x=Math.trunc(h&255),s=Math.trunc(r>>>24),g=Math.trunc(r>>>16&255),M=Math.trunc(r>>>8&255),A=Math.trunc(r&255),k=Math.round(s*i+u*(1-i)),b=Math.round(g*i+d*(1-i)),P=Math.round(M*i+y*(1-i)),w=Math.round(A*i+x*(1-i));return(k<<24|b<<16|P<<8|w)>>>0}function tI(h,r){const i=h>>>24,u=h>>>16&255,d=h>>>8&255,y=Math.trunc((h&255)*r);return(i<<24|u<<16|d<<8|y)>>>0}let a2=!0;function nI(h){a2=h==="webgl"}function Qu(h,r,i=!1){const u=(h&255)/255*r,d=a2?u:1,y=Math.trunc((h>>>24)*d),x=Math.trunc((h>>>16&255)*d),s=Math.trunc((h>>>8&255)*d),g=Math.trunc(u*255);return i?(g<<24|s<<16|x<<8|y)>>>0:(y<<24|x<<16|s<<8|g)>>>0}function tp(h,r){return Object.prototype.hasOwnProperty.call(h,r)}function vp(){return{VITE_TMDB_KEY:"ABC123",VITE_TMDB_BASE_URL:"https://8b4fa39d.lightningjs.workers.dev",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&!0}let iI=1;function oI(){return iI++}class Ao{constructor(){L(this,"eventListeners",{})}on(r,i){let u=this.eventListeners[r];u||(u=[]),u.push(i),this.eventListeners[r]=u}off(r,i){const u=this.eventListeners[r];if(!u)return;if(!i){delete this.eventListeners[r];return}const d=u.indexOf(i);d>=0&&u.splice(d,1)}once(r,i){const u=(d,y)=>{this.off(r,u),i(d,y)};this.on(r,u)}emit(r,i){const u=this.eventListeners[r];u&&[...u].forEach(d=>{d(this,i)})}removeAllListeners(){this.eventListeners={}}}const rI=/^(data|ftps?|https?):/,Va=h=>{const r=h>>>24,i=h>>>16&255,u=h>>>8&255,d=h&255;return[r/255,i/255,u/255,d/255]},sI=h=>{const r=h>>>24,i=h>>>16&255,u=h>>>8&255,d=h&255;return[r,i,u,d]};function aI(h){return(h&255)/255}function Fd(h){const r=Math.floor(h[0]*255),i=Math.floor(h[1]*255),u=Math.floor(h[2]*255),d=Math.floor(h[3]*255);return`rgba(${r},${i},${u},${d.toFixed(4)})`}function Zu(h,r,i,u,d){return d?(d.x1=h,d.y1=r,d.x2=i,d.y2=u,d):{x1:h,y1:r,x2:i,y2:u}}function zd(h,r){return h.x1<r.x2&&h.x2>r.x1&&h.y1<r.y2&&h.y2>r.y1}function lI(h,r){return r?(r.x=h.x1,r.y=h.y1,r.width=h.x2-h.x1,r.height=h.y2-h.y1,r):{x:h.x1,y:h.y1,width:h.x2-h.x1,height:h.y2-h.y1}}function l2(h,r,i){const u=Math.max(h.x,r.x),d=Math.max(h.y,r.y),y=Math.min(h.x+h.width,r.x+r.width)-u,x=Math.min(h.y+h.height,r.y+r.height)-d;return y>0&&x>0?i?(i.x=u,i.y=d,i.width=y,i.height=x,i):{x:u,y:d,width:y,height:x}:i?(i.x=0,i.y=0,i.width=0,i.height=0,i):{x:0,y:0,width:0,height:0}}function u2(h,r){return r?(r.x=h.x,r.y=h.y,r.width=h.width,r.height=h.height,r):{x:h.x,y:h.y,width:h.width,height:h.height}}function uI(h,r){return h===r?!0:h===null||r===null?!1:h.x===r.x&&h.y===r.y&&h.width===r.width&&h.height===r.height}function Ix(h,r){return h.x1<=r.x2&&h.y1<=r.y2&&h.x2>=r.x1&&h.y2>=r.y1}function fI(h){return h.x1<h.x2&&h.y1<h.y2}function cI(h){if(self.location.protocol==="file:"&&!rI.test(h)){const i=self.location.pathname.split("/");i.pop();const u=i.join("/"),d=self.location.protocol+"//"+u;return h.charAt(0)==="."&&(h=h.slice(1)),h.charAt(0)==="/"&&(h=h.slice(1)),d+"/"+h}return new URL(h,self.location.href).href}class kn{constructor(){L(this,"ta");L(this,"tb");L(this,"tx");L(this,"tc");L(this,"td");L(this,"ty");L(this,"_floatArr",null);L(this,"mutation");this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return hI}static multiply(r,i,u){const d=r.ta*i.ta+r.tb*i.tc,y=r.ta*i.tb+r.tb*i.td,x=r.ta*i.tx+r.tb*i.ty+r.tx,s=r.tc*i.ta+r.td*i.tc,g=r.tc*i.tb+r.td*i.td,M=r.tc*i.tx+r.td*i.ty+r.ty;return u||(u=new kn),u.ta=d,u.tb=y,u.tx=x,u.tc=s,u.td=g,u.ty=M,u.mutation=!0,u}static identity(r){return r||(r=new kn),r.ta=1,r.tb=0,r.tx=0,r.tc=0,r.td=1,r.ty=0,r.mutation=!0,r}static translate(r,i,u){return u||(u=new kn),u.ta=1,u.tb=0,u.tx=r,u.tc=0,u.td=1,u.ty=i,u.mutation=!0,u}static scale(r,i,u){return u||(u=new kn),u.ta=r,u.tb=0,u.tx=0,u.tc=0,u.td=i,u.ty=0,u.mutation=!0,u}static rotate(r,i){const u=Math.cos(r),d=Math.sin(r);return i||(i=new kn),i.ta=u,i.tb=-d,i.tx=0,i.tc=d,i.td=u,i.ty=0,i.mutation=!0,i}static copy(r,i){return i||(i=new kn),i.ta=r.ta,i.tc=r.tc,i.tb=r.tb,i.td=r.td,i.tx=r.tx,i.ty=r.ty,i.mutation=!0,i}translate(r,i){return this.tx=this.ta*r+this.tb*i+this.tx,this.ty=this.tc*r+this.td*i+this.ty,this.mutation=!0,this}scale(r,i){return this.ta=this.ta*r,this.tb=this.tb*i,this.tc=this.tc*r,this.td=this.td*i,this.mutation=!0,this}rotate(r){if(r===0||!(r%Math.PI*2))return this;const i=Math.cos(r),u=Math.sin(r),d=this.ta*i+this.tb*u,y=this.tb*i-this.ta*u,x=this.tc*i+this.td*u,s=this.td*i-this.tc*u;return this.ta=d,this.tb=y,this.tc=x,this.td=s,this.mutation=!0,this}multiply(r){return kn.multiply(this,r,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}const hI=new kn,Ju=0,ef=2,tf=4,nf=6,of=1,rf=3,sf=5,af=7;class If{constructor(r){L(this,"data");this.data=new Float32Array(8),r&&(this.data[Ju]=r[Ju],this.data[ef]=r[ef],this.data[tf]=r[tf],this.data[nf]=r[nf],this.data[of]=r[of],this.data[rf]=r[rf],this.data[sf]=r[sf],this.data[af]=r[af])}static translate(r,i,u,d,y,x,s,g,M){return M||(M=new If),M.data[Ju]=r,M.data[ef]=u,M.data[tf]=y,M.data[nf]=s,M.data[of]=i,M.data[rf]=d,M.data[sf]=x,M.data[af]=g,M}get x1(){return this.data[Ju]}get x2(){return this.data[ef]}get x3(){return this.data[tf]}get x4(){return this.data[nf]}get y1(){return this.data[of]}get y2(){return this.data[rf]}get y3(){return this.data[sf]}get y4(){return this.data[af]}}const kx=h=>h&&!(h&h-1),f2=(h,r,i,u)=>{const d=3*h,y=3*(i-h)-d,x=1-d-y,s=3*r,g=3*(u-r)-s,M=1-s-g;return function(A){if(A>=1)return 1;if(A<=0)return 0;let k=.5,b,P,w;for(let U=0;U<20;U++){if(b=k*(k*(k*x+y)+d),w=A-b,w>-1e-8&&w<1e-8)return k*(k*(k*M+g)+s);if(P=k*(k*(3*x)+2*y)+d,P>1e-10&&P<1e-10)break;k+=w/P}let R=0,B=1;for(let U=0;U<20;U++){if(k=.5*(R+B),b=k*(k*(k*x+y)+d),w=A-b,w>-1e-8&&w<1e-8)return k*(k*(k*M+g)+s);w<0?B=k:R=k}}},xf={},dI={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},wf=h=>h,pI=h=>{const r=/-?\d*\.?\d+/g,i=h.match(r);if(i){const[u,d,y,x]=i,s=parseFloat(u||"0.42"),g=parseFloat(d||"0"),M=parseFloat(y||"1"),A=parseFloat(x||"1"),k=f2(s,g,M,A);return xf[h]=k,k}return console.warn("Unknown cubic-bezier timing: "+h),wf},gI=h=>{if(h==="linear")return wf;if(xf[h]!==void 0)return xf[h]||wf;if(h==="step-start")return()=>1;if(h==="step-end")return i=>i===1?1:0;const r=dI[h];if(r!==void 0){const[i,u,d,y]=r,x=f2(i,u,d,y);return xf[h]=x,x}return h.startsWith("cubic-bezier")?pI(h):(console.warn("Unknown timing function: "+h),wf)};function Mx(h){return(h/1024/1024).toFixed(2)}class mI extends Ao{constructor(i,u,d){super();L(this,"node");L(this,"props");L(this,"settings");L(this,"progress",0);L(this,"delayFor",0);L(this,"timingFunction");L(this,"propValuesMap",{});L(this,"dynPropValuesMap");this.node=i,this.props=u;for(const s in u)if(s!=="shaderProps")this.propValuesMap.props===void 0&&(this.propValuesMap.props={}),this.propValuesMap.props[s]={start:i[s],target:u[s]};else if(i.shader.type!=="DynamicShader"){this.propValuesMap.shaderProps={};for(const g in u.shaderProps)this.propValuesMap.shaderProps[g]={start:i.shader.props[g],target:u.shaderProps[g]}}else{const g=Object.keys(u.shaderProps),M=g.length;this.dynPropValuesMap={};for(let A=0;A<M;A++){const k=g[A],b=u.shaderProps[k];this.dynPropValuesMap[k]={};const P=Object.entries(b),w=P.length;for(let R=0;R<w;R++){const[B,U]=P[R];this.dynPropValuesMap[k][B]={start:i.shader.props[k][B],target:U}}}}const y=d.easing||"linear",x=d.delay??0;this.settings={duration:d.duration??0,delay:x,easing:y,loop:d.loop??!1,repeat:d.repeat??0,repeatDelay:d.repeatDelay??0,stopMethod:d.stopMethod??!1},this.timingFunction=gI(y),this.delayFor=x}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(i,u){const d=Object.entries(u),y=d.length;for(let x=0;x<y;x++){const[s,g]=d[x];i[s]=g.start}}restore(){if(this.reset(),this.propValuesMap.props!==void 0&&this.restoreValues(this.node,this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const i=Object.keys(this.dynPropValuesMap),u=i.length;if(u>0)for(let d=0;d<u;d++){const y=i[d];this.restoreValues(this.node.shader.props[y],this.dynPropValuesMap[y])}}}reverseValues(i){const u=Object.entries(i),d=u.length;for(let y=0;y<d;y++){const[x,s]=u[y];i[x]={start:s.target,target:s.start}}}reverse(){if(this.progress=0,this.propValuesMap.props!==void 0&&this.reverseValues(this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.reverseValues(this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const i=Object.keys(this.dynPropValuesMap),u=i.length;if(u>0)for(let d=0;d<u;d++){const y=i[d];this.reverseValues(this.dynPropValuesMap[y])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(i,u,d){return(this.timingFunction(i)||i)*(d-u)+u}updateValue(i,u,d,y){if(this.progress===1)return u;if(this.progress===0)return d;const x=u;if(i.indexOf("color")!==-1){if(d===x)return d;if(y){const s=this.timingFunction(this.progress)||this.progress;return bx(d,x,s)}return bx(d,x,this.progress)}return y?this.applyEasing(this.progress,d,x):d+(x-d)*this.progress}updateValues(i,u,d){const y=Object.entries(u),x=y.length;for(let s=0;s<x;s++){const[g,M]=y[s];i[g]=this.updateValue(g,M.target,M.start,d)}}update(i){const{duration:u,loop:d,easing:y,stopMethod:x}=this.settings,{delayFor:s}=this;if(u===0&&s===0){this.emit("finished",{});return}if(this.delayFor>0){if(this.delayFor-=i,this.delayFor>=0)return;i=-this.delayFor,this.delayFor=0}if(u===0){this.emit("finished",{});return}if(this.progress===0&&this.emit("animating",{}),this.progress+=i/u,this.progress>1&&(this.progress=d?0:1,x)){this.emit("finished",{});return}if(this.propValuesMap.props!==void 0&&this.updateValues(this.node,this.propValuesMap.props,y),this.propValuesMap.shaderProps!==void 0&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,y),this.dynPropValuesMap!==void 0){const g=Object.keys(this.dynPropValuesMap),M=g.length;if(M>0)for(let A=0;A<M;A++){const k=g[A];this.updateValues(this.node.shader.props[k],this.dynPropValuesMap[k],y)}}this.progress===1&&this.emit("finished",{})}}class yI extends Ao{constructor(i,u){super();L(this,"manager");L(this,"animation");L(this,"stoppedPromise");L(this,"stoppedResolve",null);L(this,"state");this.manager=i,this.animation=u,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this)}start(){return this.state!=="running"&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="running"),this}stop(){return this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating)}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(i=>{this.stoppedResolve=i}))}onFinished(){Ye(this.stoppedResolve);const{loop:i,stopMethod:u}=this.animation.settings;if(u==="reverse"){this.animation.once("finished",this.onFinished),this.animation.reverse();return}i||(this.unregisterAnimation(),this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this),this.state="stopped")}onAnimating(){this.emit("animating",this)}}var Ii;(function(h){h[h.Init=0]="Init",h[h.OutOfBounds=2]="OutOfBounds",h[h.InBounds=4]="InBounds",h[h.InViewport=8]="InViewport"})(Ii||(Ii={}));const Ha=new Map;Ha.set(Ii.Init,"init");Ha.set(Ii.OutOfBounds,"outOfBounds");Ha.set(Ii.InBounds,"inBounds");Ha.set(Ii.InViewport,"inViewport");var Pe;(function(h){h[h.Children=1]="Children",h[h.ScaleRotate=2]="ScaleRotate",h[h.Local=4]="Local",h[h.Global=8]="Global",h[h.Clipping=16]="Clipping",h[h.CalculatedZIndex=32]="CalculatedZIndex",h[h.ZIndexSortedChildren=64]="ZIndexSortedChildren",h[h.PremultipliedColors=128]="PremultipliedColors",h[h.WorldAlpha=256]="WorldAlpha",h[h.RenderState=512]="RenderState",h[h.IsRenderable=1024]="IsRenderable",h[h.RenderTexture=2048]="RenderTexture",h[h.ParentRenderTexture=4096]="ParentRenderTexture",h[h.None=0]="None",h[h.All=8191]="All"})(Pe||(Pe={}));class np extends Ao{constructor(i,u){super();L(this,"stage");L(this,"children",[]);L(this,"_id",oI());L(this,"props");L(this,"updateType",Pe.All);L(this,"globalTransform");L(this,"scaleRotateTransform");L(this,"localTransform");L(this,"renderCoords");L(this,"renderBound");L(this,"strictBound");L(this,"preloadBound");L(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1});L(this,"isRenderable",!1);L(this,"renderState",Ii.Init);L(this,"worldAlpha",1);L(this,"premultipliedColorTl",0);L(this,"premultipliedColorTr",0);L(this,"premultipliedColorBl",0);L(this,"premultipliedColorBr",0);L(this,"calcZIndex",0);L(this,"hasRTTupdates",!1);L(this,"parentHasRenderTexture",!1);L(this,"onTextureLoaded",(i,u)=>{var d,y;this.autosizeNode(u),this.stage.requestRender(),this.parentHasRenderTexture&&this.setRTTUpdates(1),this.emit("loaded",{type:"texture",dimensions:u}),((y=(d=this.props.textureOptions)==null?void 0:d.resizeMode)==null?void 0:y.type)==="contain"&&this.setUpdateType(Pe.Local)});L(this,"onTextureFailed",(i,u)=>{this.emit("failed",{type:"texture",error:u})});L(this,"onTextureFreed",()=>{this.emit("freed",{type:"texture"})});this.stage=i,this.props={...u,parent:null,texture:null,src:null,rtt:!1},this.parent=u.parent,this.texture=u.texture,this.src=u.src,this.rtt=u.rtt,this.updateScaleRotateTransform()}loadTexture(){const{texture:i}=this.props;Ye(i),queueMicrotask(()=>{this.textureOptions.preload&&i.ctxTexture.load(),i.state==="loaded"?(Ye(i.dimensions),this.onTextureLoaded(i,i.dimensions)):i.state==="failed"?(Ye(i.error),this.onTextureFailed(i,i.error)):i.state==="freed"&&this.onTextureFreed(i),i.on("loaded",this.onTextureLoaded),i.on("failed",this.onTextureFailed),i.on("freed",this.onTextureFreed)})}unloadTexture(){this.texture&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this,!1))}autosizeNode(i){this.autosize&&(this.width=i.width,this.height=i.height)}setUpdateType(i){this.updateType|=i;const u=this.props.parent;u&&!(u.updateType&Pe.Children)&&u.setUpdateType(Pe.Children),this.parentHasRenderTexture&&this.setRTTUpdates(i)}sortChildren(){this.children.sort((i,u)=>i.calcZIndex-u.calcZIndex)}updateScaleRotateTransform(){const{rotation:i,scaleX:u,scaleY:d}=this.props;if(i===0&&u===1&&d===1){this.scaleRotateTransform=void 0;return}this.scaleRotateTransform=kn.rotate(i,this.scaleRotateTransform).scale(u,d)}updateLocalTransform(){var M,A;const{x:i,y:u,width:d,height:y}=this.props,x=this.props.mountX*d,s=this.props.mountY*y;if(this.scaleRotateTransform){const k=this.props.pivotX*d,b=this.props.pivotY*y;this.localTransform=kn.translate(i-x+k,u-s+b,this.localTransform).multiply(this.scaleRotateTransform).translate(-k,-b)}else this.localTransform=kn.translate(i-x,u-s,this.localTransform);const g=this.props.texture;if(g&&g.dimensions&&((A=(M=this.props.textureOptions)==null?void 0:M.resizeMode)==null?void 0:A.type)==="contain"){let k=1,b=1,P=0,w=0;const{width:R,height:B}=g.dimensions,U=R/B,W=d/y;if(U>W){const G=d/R,Q=B*G;w=(y-Q)/2,b=Q/y}else{const G=y/B,Q=R*G;P=(d-Q)/2,k=Q/d}this.localTransform.translate(P,w).scale(k,b)}this.setUpdateType(Pe.Global)}update(i,u){var x;this.updateType&Pe.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(Pe.Local)),this.updateType&Pe.Local&&(this.updateLocalTransform(),this.setUpdateType(Pe.Global));const d=this.props.parent;let y=Pe.None;if(this.updateType&Pe.ParentRenderTexture){let s=this.parent;for(;s;)s.rtt&&(this.parentHasRenderTexture=!0),s=s.parent}this.updateType^Pe.All&&this.updateType&Pe.RenderTexture&&this.children.forEach(s=>{s.setUpdateType(Pe.All)}),this.updateType&Pe.Global&&(Ye(this.localTransform),this.globalTransform=kn.copy((d==null?void 0:d.globalTransform)||this.localTransform,this.globalTransform),this.parentHasRenderTexture&&((x=this.props.parent)!=null&&x.rtt)&&(this.globalTransform=kn.identity()),d&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(Pe.Clipping|Pe.RenderState|Pe.Children),y|=Pe.Global),this.updateType&Pe.Clipping&&(this.calculateClippingRect(u),this.setUpdateType(Pe.Children),y|=Pe.Clipping),this.updateType&Pe.WorldAlpha&&(d?this.worldAlpha=d.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(Pe.Children|Pe.PremultipliedColors|Pe.IsRenderable),y|=Pe.WorldAlpha),this.updateType&Pe.PremultipliedColors&&(this.premultipliedColorTl=Qu(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=Qu(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=Qu(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=Qu(this.props.colorBr,this.worldAlpha,!0))),this.updateType&Pe.RenderState&&(this.updateRenderState(u),this.setUpdateType(Pe.IsRenderable)),this.updateType&Pe.IsRenderable&&this.updateIsRenderable(),d&&this.updateType&Pe.CalculatedZIndex&&(this.calculateZIndex(),d.setUpdateType(Pe.ZIndexSortedChildren)),this.updateType&Pe.Children&&this.children.length&&!this.rtt&&this.children.forEach(s=>{s.setUpdateType(y),s.updateType!==0&&s.update(i,this.clippingRect)}),this.updateType&Pe.ZIndexSortedChildren&&this.sortChildren(),this.updateType=0}checkRenderProps(){return this.props.texture?!0:!this.props.width||!this.props.height?!1:!!(this.props.shader!==this.stage.defShaderCtr||this.props.clipping||this.props.color!==0||this.props.colorTop!==0||this.props.colorBottom!==0||this.props.colorLeft!==0||this.props.colorRight!==0||this.props.colorTl!==0||this.props.colorTr!==0||this.props.colorBl!==0||this.props.colorBr!==0)}checkRenderBounds(i){Ye(this.renderBound);const u=i.width||this.stage.root.width,d=i.height||this.stage.root.height;if(this.strictBound=Zu(i.x,i.y,i.x+u,i.y+d,this.strictBound),Ix(this.renderBound,this.strictBound))return Ii.InViewport;const y=this.stage.boundsMargin;return this.preloadBound=Zu(this.strictBound.x1-y[3],this.strictBound.y1-y[0],this.strictBound.x2+y[1],this.strictBound.y2+y[2],this.preloadBound),Ix(this.renderBound,this.preloadBound)?Ii.InBounds:Ii.OutOfBounds}updateRenderState(i){const u=this.checkRenderBounds(i);if(u===this.renderState)return;const d=this.renderState;this.renderState=u;const y=Ha.get(u);Ye(y),this.emit(y,{previous:d,current:u})}updateIsRenderable(){let i;this.worldAlpha===0||!this.checkRenderProps()?i=!1:i=this.renderState>Ii.OutOfBounds,this.isRenderable!==i&&(this.isRenderable=i,this.onChangeIsRenderable(i))}onChangeIsRenderable(i){var u;(u=this.texture)==null||u.setRenderableOwner(this,i)}calculateRenderCoords(){const{width:i,height:u,globalTransform:d}=this;Ye(d);const{tx:y,ty:x,ta:s,tb:g,tc:M,td:A}=d;if(g===0&&M===0){const k=y,b=y+i*s,P=x,w=x+u*A;this.renderCoords=If.translate(k,P,b,P,b,w,k,w,this.renderCoords)}else this.renderCoords=If.translate(y,x,y+i*s,x+i*M,y+i*s+u*g,x+i*M+u*A,y+u*g,x+u*A,this.renderCoords)}updateBoundingRect(){const{renderCoords:i,globalTransform:u}=this;Ye(u),Ye(i);const{tb:d,tc:y}=u,{x1:x,y1:s,x3:g,y3:M}=i;if(d===0||y===0)this.renderBound=Zu(x,s,g,M,this.renderBound);else{const{x2:A,x4:k,y2:b,y4:P}=i;this.renderBound=Zu(Math.min(x,A,g,k),Math.min(s,b,M,P),Math.max(x,A,g,k),Math.max(s,b,M,P),this.renderBound)}}calculateClippingRect(i){Ye(this.globalTransform);const{clippingRect:u,props:d,globalTransform:y}=this,{clipping:x}=d,s=y.tb!==0||y.tc!==0;x&&!s?(u.x=y.tx,u.y=y.ty,u.width=this.width*y.ta,u.height=this.height*y.td,u.valid=!0):u.valid=!1,i.valid&&u.valid?l2(i,u,u):i.valid&&(u2(i,u),u.valid=!0)}calculateZIndex(){var x,s;const i=this.props,u=i.zIndex||0,d=((x=i.parent)==null?void 0:x.zIndex)||0;let y=u;(s=i.parent)!=null&&s.zIndexLocked&&(y=u<d?u:d),this.calcZIndex=y}destroy(){this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,delete this.renderCoords,delete this.renderBound,delete this.strictBound,delete this.preloadBound,delete this.globalTransform,delete this.scaleRotateTransform,delete this.localTransform,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;const i=[...this.children];for(let u=0;u<i.length;u++)i[u].destroy();this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}renderQuads(i){const{texture:u,width:d,height:y,textureOptions:x,rtt:s,shader:g}=this.props;if(this.parentHasRenderTexture&&(!i.renderToTextureActive||this.parentRenderTexture!==i.activeRttNode))return;const{premultipliedColorTl:M,premultipliedColorTr:A,premultipliedColorBl:k,premultipliedColorBr:b}=this,{zIndex:P,worldAlpha:w,globalTransform:R,clippingRect:B,renderCoords:U}=this;Ye(R),Ye(U),i.addQuad({width:d,height:y,colorTl:M,colorTr:A,colorBl:k,colorBr:b,texture:u,textureOptions:x,zIndex:P,shader:g.shader,shaderProps:g.getResolvedProps(),alpha:w,clippingRect:B,tx:R.tx,ty:R.ty,ta:R.ta,tb:R.tb,tc:R.tc,td:R.td,renderCoords:U,rtt:s,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions})}get id(){return this._id}get x(){return this.props.x}set x(i){this.props.x!==i&&(this.props.x=i,this.setUpdateType(Pe.Local))}get absX(){var i,u,d;return this.props.x+(((i=this.props.parent)==null?void 0:i.absX)||((d=(u=this.props.parent)==null?void 0:u.globalTransform)==null?void 0:d.tx)||0)}get absY(){var i;return this.props.y+(((i=this.props.parent)==null?void 0:i.absY)??0)}get y(){return this.props.y}set y(i){this.props.y!==i&&(this.props.y=i,this.setUpdateType(Pe.Local))}get width(){return this.props.width}set width(i){this.props.width!==i&&(this.props.width=i,this.setUpdateType(Pe.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(Pe.RenderTexture)))}get height(){return this.props.height}set height(i){this.props.height!==i&&(this.props.height=i,this.setUpdateType(Pe.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(Pe.RenderTexture)))}get scale(){return this.scaleX}set scale(i){this.scaleX=i,this.scaleY=i}get scaleX(){return this.props.scaleX}set scaleX(i){this.props.scaleX!==i&&(this.props.scaleX=i,this.setUpdateType(Pe.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(i){this.props.scaleY!==i&&(this.props.scaleY=i,this.setUpdateType(Pe.ScaleRotate))}get mount(){return this.props.mount}set mount(i){(this.props.mountX!==i||this.props.mountY!==i)&&(this.props.mountX=i,this.props.mountY=i,this.props.mount=i,this.setUpdateType(Pe.Local))}get mountX(){return this.props.mountX}set mountX(i){this.props.mountX!==i&&(this.props.mountX=i,this.setUpdateType(Pe.Local))}get mountY(){return this.props.mountY}set mountY(i){this.props.mountY!==i&&(this.props.mountY=i,this.setUpdateType(Pe.Local))}get pivot(){return this.props.pivot}set pivot(i){(this.props.pivotX!==i||this.props.pivotY!==i)&&(this.props.pivotX=i,this.props.pivotY=i,this.props.pivot=i,this.setUpdateType(Pe.Local))}get pivotX(){return this.props.pivotX}set pivotX(i){this.props.pivotX!==i&&(this.props.pivotX=i,this.setUpdateType(Pe.Local))}get pivotY(){return this.props.pivotY}set pivotY(i){this.props.pivotY!==i&&(this.props.pivotY=i,this.setUpdateType(Pe.Local))}get rotation(){return this.props.rotation}set rotation(i){this.props.rotation!==i&&(this.props.rotation=i,this.setUpdateType(Pe.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(i){this.props.alpha=i,this.setUpdateType(Pe.PremultipliedColors|Pe.WorldAlpha)}get autosize(){return this.props.autosize}set autosize(i){this.props.autosize=i}get clipping(){return this.props.clipping}set clipping(i){this.props.clipping=i,this.setUpdateType(Pe.Clipping)}get color(){return this.props.color}set color(i){this.colorTop=i,this.colorBottom=i,this.colorLeft=i,this.colorRight=i,this.props.color=i,this.setUpdateType(Pe.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(i){(this.props.colorTl!==i||this.props.colorTr!==i)&&(this.colorTl=i,this.colorTr=i),this.props.colorTop=i,this.setUpdateType(Pe.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(i){(this.props.colorBl!==i||this.props.colorBr!==i)&&(this.colorBl=i,this.colorBr=i),this.props.colorBottom=i,this.setUpdateType(Pe.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(i){(this.props.colorTl!==i||this.props.colorBl!==i)&&(this.colorTl=i,this.colorBl=i),this.props.colorLeft=i,this.setUpdateType(Pe.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(i){(this.props.colorTr!==i||this.props.colorBr!==i)&&(this.colorTr=i,this.colorBr=i),this.props.colorRight=i,this.setUpdateType(Pe.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(i){this.props.colorTl=i,this.setUpdateType(Pe.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(i){this.props.colorTr=i,this.setUpdateType(Pe.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(i){this.props.colorBl=i,this.setUpdateType(Pe.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(i){this.props.colorBr=i,this.setUpdateType(Pe.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(i){this.props.zIndexLocked=i,this.setUpdateType(Pe.CalculatedZIndex|Pe.Children),this.children.forEach(u=>{u.setUpdateType(Pe.CalculatedZIndex)})}get zIndex(){return this.props.zIndex}set zIndex(i){this.props.zIndex=i,this.setUpdateType(Pe.CalculatedZIndex|Pe.Children),this.children.forEach(u=>{u.setUpdateType(Pe.CalculatedZIndex)})}get parent(){return this.props.parent}set parent(i){const u=this.props.parent;if(u!==i){if(this.props.parent=i,u){const d=u.children.indexOf(this);Ye(d!==-1,"CoreNode.parent: Node not found in old parent's children!"),u.children.splice(d,1),u.setUpdateType(Pe.Children|Pe.ZIndexSortedChildren)}i&&(i.children.push(this),this.setUpdateType(Pe.All),i.setUpdateType(Pe.Children|Pe.ZIndexSortedChildren),(i.rtt||i.parentHasRenderTexture)&&this.setRTTUpdates(Pe.All)),this.updateScaleRotateTransform()}}get rtt(){return this.props.rtt}set rtt(i){var u,d;if(this.props.rtt===!0&&(this.props.rtt=i,i===!1&&this.texture!==null)){this.unloadTexture(),this.setUpdateType(Pe.All),this.children.forEach(y=>{y.parentHasRenderTexture=!1}),(u=this.stage.renderer)==null||u.removeRTTNode(this);return}i!==!1&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.props.rtt=!0,this.hasRTTupdates=!0,this.setUpdateType(Pe.All),this.children.forEach(y=>{y.setUpdateType(Pe.All)}),(d=this.stage.renderer)==null||d.renderToTexture(this))}get shader(){return this.props.shader}set shader(i){this.props.shader!==i&&(this.props.shader=i,this.setUpdateType(Pe.IsRenderable))}get src(){return this.props.src}set src(i){if(this.props.src!==i){if(this.props.src=i,!i){this.texture=null;return}this.texture=this.stage.txManager.loadTexture("ImageTexture",{src:i})}}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){let i=this.parent;for(;i;){if(i.rtt)return i;i=i.parent}return null}get texture(){return this.props.texture}set texture(i){if(this.props.texture===i)return;const u=this.props.texture;u&&(u.setRenderableOwner(this,!1),this.unloadTexture()),this.props.texture=i,i&&(i.setRenderableOwner(this,this.isRenderable),this.loadTexture()),this.setUpdateType(Pe.IsRenderable)}set textureOptions(i){this.props.textureOptions=i}get textureOptions(){return this.props.textureOptions}setRTTUpdates(i){var u;this.hasRTTupdates=!0,(u=this.parent)==null||u.setRTTUpdates(i)}animate(i,u){const d=new mI(this,i,u);return new yI(this.stage.animationManager,d)}flush(){}}const lf={alpha:h=>h===1?null:{prop:"opacity",value:`${h}`},x:h=>({prop:"left",value:`${h}px`}),y:h=>({prop:"top",value:`${h}px`}),width:h=>h===0?null:{prop:"width",value:`${h}px`},height:h=>h===0?null:{prop:"height",value:`${h}px`},zIndex:()=>"zIndex",fontFamily:()=>"font-family",fontSize:()=>"font-size",fontStyle:()=>"font-style",fontWeight:()=>"font-weight",fontStretch:()=>"font-stretch",lineHeight:()=>"line-height",letterSpacing:()=>"letter-spacing",textAlign:()=>"text-align",overflowSuffix:()=>"overflow-suffix",maxLines:()=>"max-lines",contain:()=>"contain",verticalAlign:()=>"vertical-align",clipping:h=>h===!1?null:{prop:"overflow",value:h?"hidden":"visible"},rotation:h=>h===0?null:{prop:"transform",value:`rotate(${h}rad)`},scale:h=>h===1?null:{prop:"transform",value:`scale(${h})`},scaleX:h=>h===1?null:{prop:"transform",value:`scaleX(${h})`},scaleY:h=>h===1?null:{prop:"transform",value:`scaleY(${h})`},color:h=>h===0?null:{prop:"color",value:c2(h)}},c2=h=>{const r=(h&255)/255,i=h>>8&255,u=h>>16&255;return`rgba(${h>>24&255},${u},${i},${r})`},_x={id:"id"};class vI{constructor(r,i){L(this,"root",null);L(this,"canvas",null);L(this,"height",1080);L(this,"width",1920);L(this,"scaleX",1);L(this,"scaleY",1);if(vp())return;if(!i)throw new Error("settings is required");this.height=Math.ceil(i.appHeight??1080/(i.deviceLogicalPixelRatio??1)),this.width=Math.ceil(i.appWidth??1900/(i.deviceLogicalPixelRatio??1)),this.scaleX=i.deviceLogicalPixelRatio??1,this.scaleY=i.deviceLogicalPixelRatio??1,this.canvas=r,this.root=document.createElement("div"),this.setRootPosition(),document.body.appendChild(this.root),new MutationObserver(this.setRootPosition.bind(this)).observe(r,{attributes:!0,childList:!1,subtree:!1}),new ResizeObserver(this.setRootPosition.bind(this)).observe(r),window.addEventListener("resize",this.setRootPosition.bind(this)),console.warn("Inspector is enabled, this will impact performance")}setRootPosition(){if(this.root===null||this.canvas===null)return;const r=this.canvas.getBoundingClientRect(),i=document.documentElement.scrollTop+r.top,u=document.documentElement.scrollLeft+r.left;this.root.id="root",this.root.style.left=`${u}px`,this.root.style.top=`${i}px`,this.root.style.width=`${this.width}px`,this.root.style.height=`${this.height}px`,this.root.style.position="absolute",this.root.style.transformOrigin="0 0 0",this.root.style.transform=`scale(${this.scaleX}, ${this.scaleY})`,this.root.style.overflow="hidden",this.root.style.zIndex="65534"}createDiv(r,i){const u=document.createElement("div");u.style.position="absolute",u.id=r.toString();for(const d in i)this.updateNodeProperty(u,d,i[d]);return u}createNode(r){const i=this.createDiv(r.id,r.props);return i.node=r,r.div=i,this.createProxy(r,i)}createTextNode(r){const i=this.createDiv(r.id,r.props);return i.node=r,r.div=i,this.createProxy(r,i)}createProxy(r,i){return new Proxy(r,{set:(u,d,y)=>(this.updateNodeProperty(i,d,y),Reflect.set(u,d,y)),get:(u,d,y)=>(d==="destroy"&&this.destroyNode(u.id),d==="animate"?(x,s)=>{const g=u.animate(x,s);return new Proxy(g,{get:(M,A,k)=>(A==="start"&&this.animateNode(i,x,s),Reflect.get(M,A,k))})}:Reflect.get(u,d,y))})}destroyNode(r){const i=document.getElementById(r.toString());i==null||i.remove()}updateNodeProperty(r,i,u){var d;if(!(this.root===null||u===void 0||u===null)){if(i==="parent"){const y=u.id;if(y===1){this.root.appendChild(r);return}const x=document.getElementById(y.toString());x==null||x.appendChild(r);return}if(i==="text"){r.innerHTML=String(u),r.style.visibility="hidden";return}if(i==="src"&&u){r.setAttribute("data-src",String(u));return}if(lf[i]){const y=(d=lf[i])==null?void 0:d.call(lf,u);if(y===null)return;if(typeof y=="string"){r.style.setProperty(y,String(u));return}typeof y=="object"&&r.style.setProperty(y.prop,y.value);return}if(_x[i]){const y=_x[i];if(!y)return;r.setAttribute(String(y),String(u));return}if(i==="data"){for(const y in u){const x=u[y];x===void 0?r.removeAttribute(`data-${y}`):r.setAttribute(`data-${y}`,String(x))}return}}}animateNode(r,i,u){const{duration:d=1e3,delay:y=0}=u,{x,y:s,width:g,height:M,alpha:A=1,rotation:k=0,scale:b=1,color:P}=i;function w(){setTimeout(()=>{r.style.top=`${s}px`,r.style.left=`${x}px`,r.style.width=`${g}px`,r.style.height=`${M}px`,r.style.opacity=`${A}`,r.style.rotate=`${k}rad`,r.style.scale=`${b}`,r.style.color=c2(P)},d)}setTimeout(w,y)}}const xI=h=>{let r=!1;const i=()=>{if(h.updateFrameTime(),h.updateAnimations(),!h.hasSceneUpdates()){h.calculateFps(),setTimeout(i,16.666666666666668),r||(h.txMemManager.checkCleanup()&&h.txMemManager.cleanup(),h.eventBus.emit("idle"),r=!0),h.flushFrameEvents();return}r=!1,h.drawFrame(),h.flushFrameEvents(),requestAnimationFrame(i)};requestAnimationFrame(i)},wI=()=>performance?performance.now():Date.now();class h2{constructor(r,i){L(this,"textureSource");L(this,"memManager");this.memManager=r,this.textureSource=i}setTextureMemUse(r){this.memManager.setTextureMemUse(this.textureSource,r)}get renderable(){return this.textureSource.renderable}}class d2{constructor(r){L(this,"options");L(this,"mode");L(this,"stage");L(this,"txManager");L(this,"txMemManager");L(this,"shManager");L(this,"rttNodes",[]);this.options=r,this.stage=r.stage,this.txManager=r.txManager,this.txMemManager=r.txMemManager,this.shManager=r.shManager}}class SI{}class p2{static makeCacheKey(r){return!1}static resolveDefaults(r){return{}}}function Rx(h,r,i){const u=h.createShader(r);if(!u)throw new Error;if(h.shaderSource(u,i),h.compileShader(u),h.getShaderParameter(u,h.COMPILE_STATUS))return u;console.log(h.getShaderInfoLog(u)),h.deleteShader(u)}function TI(h,r,i){const u=h.createProgram();if(!u)throw new Error;if(h.attachShader(u,r),h.attachShader(u,i),h.linkProgram(u),h.getProgramParameter(u,h.LINK_STATUS))return u;console.log(h.getProgramInfoLog(u)),h.deleteProgram(u)}class bo extends p2{constructor(i){super();L(this,"boundBufferCollection",null);L(this,"buffersBound",!1);L(this,"program");L(this,"vao");L(this,"renderer");L(this,"glw");L(this,"attributeBuffers");L(this,"attributeLocations");L(this,"attributeNames");L(this,"uniformLocations");L(this,"uniformTypes");L(this,"supportsIndexedTextures");const u=this.renderer=i.renderer,d=this.glw=this.renderer.glw;this.supportsIndexedTextures=i.supportsIndexedTextures||!1;const y=d.isWebGl2(),x=y&&i.webgl2Extensions||!y&&i.webgl1Extensions||[],s=y?"2.0":"1.0";x.forEach(R=>{if(!d.getExtension(R))throw new Error(`Shader "${this.constructor.name}" requires extension "${R}" for WebGL ${s} but wasn't found`)});const g=i.shaderSources||this.constructor.shaderSources;if(g)y&&(g!=null&&g.webGl2)&&(g.fragment=g.webGl2.fragment,g.vertex=g.webGl2.vertex,delete g.webGl2);else throw new Error(`Shader "${this.constructor.name}" is missing shaderSources.`);const M=u.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,A=g.vertex instanceof Function?g.vertex(M):g.vertex,k=g.fragment instanceof Function?g.fragment(M):g.fragment,b=Rx(d,d.VERTEX_SHADER,A),P=Rx(d,d.FRAGMENT_SHADER,k);if(!b||!P)throw new Error;const w=TI(d,b,P);if(!w)throw new Error;if(this.program=w,y){const R=d.createVertexArray();if(!R)throw new Error;this.vao=R,d.bindVertexArray(this.vao)}this.attributeLocations={},this.attributeBuffers={},this.attributeNames=[],[...i.attributes].forEach(R=>{const B=d.getAttribLocation(this.program,R);if(B<0)throw new Error(`${this.constructor.name}: Vertex shader must have an attribute "${R}"!`);const U=d.createBuffer();if(!U)throw new Error(`${this.constructor.name}: Could not create buffer for attribute "${R}"`);this.attributeLocations[R]=B,this.attributeBuffers[R]=U,this.attributeNames.push(R)}),this.uniformLocations={},this.uniformTypes={},i.uniforms.forEach(R=>{const B=d.getUniformLocation(this.program,R.name);if(this.uniformTypes[R.name]=R.uniform,!B){console.warn(`Shader "${this.constructor.name}" could not get uniform location for "${R.name}"`);return}this.uniformLocations[R.name]=B})}bindBufferAttribute(i,u,d){const{glw:y}=this;y.enableVertexAttribArray(i),y.vertexAttribPointer(u,i,d.size,d.type,d.normalized,d.stride,d.offset)}disableAttribute(i){this.glw.disableVertexAttribArray(i)}disableAttributes(){for(const i in this.attributeLocations)this.disableAttribute(this.attributeLocations[i]);this.boundBufferCollection=null}canBatchShaderProps(i,u){return!1}bindRenderOp(i,u){this.bindBufferCollection(i.buffers),i.textures.length>0&&this.bindTextures(i.textures);const{glw:d,parentHasRenderTexture:y,renderToTexture:x}=i;if(!(x&&y)){if(y){const{width:s,height:g}=i.framebufferDimensions||{};this.setUniform("u_pixelRatio",1),this.setUniform("u_resolution",new Float32Array([s??0,g??0]))}else this.setUniform("u_pixelRatio",i.options.pixelRatio),this.setUniform("u_resolution",new Float32Array([d.canvas.width,d.canvas.height]));if(u){if(tp(u,"$dimensions")){let s=u.$dimensions;s||(s=i.dimensions),this.setUniform("u_dimensions",[s.width,s.height])}if(tp(u,"$alpha")){let s=u.$alpha;s||(s=i.alpha),this.setUniform("u_alpha",s)}this.bindProps(u)}}}setUniform(i,...u){this.glw.setUniform(this.uniformTypes[i],this.uniformLocations[i],...u)}bindBufferCollection(i){if(this.boundBufferCollection!==i){for(const u in this.attributeLocations){const d=i.getBuffer(u),y=i.getAttributeInfo(u);Ye(d,`Buffer for "${u}" not found`),Ye(y),this.bindBufferAttribute(this.attributeLocations[u],d,y)}this.boundBufferCollection=i}}bindProps(i){}bindTextures(i){}attach(){this.glw.useProgram(this.program),this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}L(bo,"shaderSources");class g2 extends SI{constructor(i,u,d,y,x,s,g,M,A,k,b,P,w){super();L(this,"glw");L(this,"options");L(this,"buffers");L(this,"shader");L(this,"shaderProps");L(this,"alpha");L(this,"clippingRect");L(this,"dimensions");L(this,"bufferIdx");L(this,"zIndex");L(this,"renderToTexture");L(this,"parentHasRenderTexture");L(this,"framebufferDimensions");L(this,"length",0);L(this,"numQuads",0);L(this,"textures",[]);L(this,"maxTextures");this.glw=i,this.options=u,this.buffers=d,this.shader=y,this.shaderProps=x,this.alpha=s,this.clippingRect=g,this.dimensions=M,this.bufferIdx=A,this.zIndex=k,this.renderToTexture=b,this.parentHasRenderTexture=P,this.framebufferDimensions=w,this.maxTextures=y.supportsIndexedTextures?i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(i){const{textures:u,maxTextures:d}=this,y=u.findIndex(s=>s===i);if(y!==-1)return y;const x=u.length;return x>=d?4294967295:(this.textures.push(i),x)}draw(){const{glw:i,shader:u,shaderProps:d,options:y}=this,{shManager:x}=y;x.useShader(u),u.bindRenderOp(this,d);const s=this.bufferIdx/24*6*2;if(this.clippingRect.valid){const{x:g,y:M,width:A,height:k}=this.clippingRect,b=y.pixelRatio,P=y.canvas.height,w=Math.round(g*b),R=Math.round(A*b),B=Math.round(k*b),U=Math.round(P-B-M*b);i.setScissorTest(!0),i.scissor(w,U,R,B)}else i.setScissorTest(!1);i.drawElements(i.TRIANGLES,6*this.numQuads,i.UNSIGNED_SHORT,s)}}function CI(h){const r={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(r).forEach(u=>{r[u]=h.getParameter(h[u])}),r}function EI(h){const r={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(r).forEach(u=>{r[u]=h.getExtension(u)}),r}function AI(h,r){const i=~~(r/80),u=new Uint16Array(i*6);for(let y=0,x=0;y<i;y+=6,x+=4)u[y]=x,u[y+1]=x+1,u[y+2]=x+2,u[y+3]=x+2,u[y+4]=x+1,u[y+5]=x+3;const d=h.createBuffer();h.elementArrayBufferData(d,u,h.STATIC_DRAW)}function bI(h){return h!==null&&typeof h=="object"&&h.constructor&&h.constructor.name==="HTMLImageElement"}const Vd=new Uint8Array([0,0,0,0]);class kf extends h2{constructor(i,u,d){super(u,d);L(this,"glw");L(this,"_nativeCtxTexture",null);L(this,"_state","freed");L(this,"_w",0);L(this,"_h",0);this.glw=i}get ctxTexture(){return this._state==="freed"&&this.load(),Ye(this._nativeCtxTexture),this._nativeCtxTexture}get w(){return this._w}get h(){return this._h}load(){this._state==="loading"||this._state==="loaded"||(this._state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),this.onLoadRequest().then(({width:i,height:u})=>{this._state!=="freed"&&(this._state="loaded",this._w=i,this._h=u,this.textureSource.setState("loaded",{width:i,height:u}))}).catch(i=>{this._state!=="freed"&&(this._state="failed",this.textureSource.setState("failed",i),console.error(i))}))}async onLoadRequest(){var x;const{glw:i}=this;i.texImage2D(0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,null),this.setTextureMemUse(Vd.byteLength);const u=await((x=this.textureSource)==null?void 0:x.getTextureData());if(!this._nativeCtxTexture)return Ye(this._state==="freed"),{width:0,height:0};let d=0,y=0;if(Ye(this._nativeCtxTexture),i.activeTexture(0),u.data instanceof ImageBitmap||u.data instanceof ImageData||bI(u.data)){const s=u.data;d=s.width,y=s.height,i.bindTexture(this._nativeCtxTexture),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!u.premultiplyAlpha),i.texImage2D(0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,s),this.setTextureMemUse(d*y*4),(i.isWebGl2()||kx(d)&&kx(y))&&i.generateMipmap()}else if(u.data===null)d=0,y=0,i.bindTexture(this._nativeCtxTexture),i.texImage2D(0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Vd),this.setTextureMemUse(Vd.byteLength);else if("mipmaps"in u.data&&u.data.mipmaps){const{mipmaps:s,width:g=0,height:M=0,type:A,glInternalFormat:k}=u.data,b=A==="ktx"?new DataView(s[0]??new ArrayBuffer(0)):s[0];i.bindTexture(this._nativeCtxTexture),i.compressedTexImage2D(0,k,g,M,0,b),i.texParameteri(i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_MIN_FILTER,i.LINEAR),this.setTextureMemUse(b.byteLength)}else console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",u);return{width:d,height:y}}free(){if(this._state==="freed"||(this._state="freed",this.textureSource.setState("freed"),this._w=0,this._h=0,!this._nativeCtxTexture))return;const{glw:i}=this;i.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null}createNativeCtxTexture(){const{glw:i}=this,u=i.createTexture();if(!u)throw new Error("Could not create WebGL Texture");return i.activeTexture(0),i.bindTexture(u),i.texParameteri(i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),u}}class ms extends Ao{constructor(i){super();L(this,"txManager");L(this,"dimensions",null);L(this,"error",null);L(this,"state","freed");L(this,"renderableOwners",new Set);L(this,"renderable",!1);L(this,"lastRenderableChangeTime",0);this.txManager=i}setRenderableOwner(i,u){var y,x;const d=this.renderableOwners.size;if(u){this.renderableOwners.add(i);const s=this.renderableOwners.size;s>d&&s===1&&(this.renderable=!0,this.lastRenderableChangeTime=this.txManager.frameTime,(y=this.onChangeIsRenderable)==null||y.call(this,!0))}else{this.renderableOwners.delete(i);const s=this.renderableOwners.size;s<d&&s===0&&(this.renderable=!1,this.lastRenderableChangeTime=this.txManager.frameTime,(x=this.onChangeIsRenderable)==null||x.call(this,!1))}}get ctxTexture(){const i=this.txManager.renderer.createCtxTexture(this);return Object.defineProperty(this,"ctxTexture",{value:i}),i}setState(i,...u){if(this.state!==i){if(this.state=i,i==="loaded"){const d=u;this.dimensions=d[0]}else if(i==="failed"){const d=u;this.error=d[0]}this.emit(i,...u)}}static makeCacheKey(i){return!1}static resolveDefaults(i){return{}}}const Ua=class Ua extends ms{constructor(i,u){super(i);L(this,"props");this.props=Ua.resolveDefaults(u||{})}get color(){return this.props.color}set color(i){this.props.color=i}async getTextureData(){const i=new Uint32Array([this.color]),u=new Uint8ClampedArray(i.buffer);return{data:new ImageData(u,1,1),premultiplyAlpha:!0}}static makeCacheKey(i){return`ColorTexture,${Ua.resolveDefaults(i).color}`}static resolveDefaults(i){return{color:i.color||4294967295}}};L(Ua,"z$__type__Props");let Mf=Ua;const Of=class Of extends ms{constructor(i,u){super(i);L(this,"props");L(this,"parentTexture");L(this,"onParentTxLoaded",()=>{this.setState("loaded",{width:this.props.width,height:this.props.height})});L(this,"onParentTxFailed",(i,u)=>{this.setState("failed",u)});this.props=Of.resolveDefaults(u||{}),this.parentTexture=this.props.texture,queueMicrotask(()=>{const d=this.parentTexture;d.state==="loaded"?this.onParentTxLoaded(d,d.dimensions):d.state==="failed"&&this.onParentTxFailed(d,d.error),d.on("loaded",this.onParentTxLoaded),d.on("failed",this.onParentTxFailed)})}onChangeIsRenderable(i){this.parentTexture.setRenderableOwner(this,i)}async getTextureData(){return{data:this.props}}static makeCacheKey(i){return!1}static resolveDefaults(i){return{texture:i.texture,x:i.x||0,y:i.y||0,width:i.width||0,height:i.height||0}}};L(Of,"z$__type__Props");let gs=Of;class II extends kf{constructor(r,i,u){super(r,i,u)}async onLoadRequest(){var i,u;const r=await this.textureSource.getTextureData();return{width:((i=r.data)==null?void 0:i.width)||0,height:((u=r.data)==null?void 0:u.height)||0}}}class m2 extends bo{constructor(r){super({renderer:r,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(r){const{glw:i}=this;i.activeTexture(0),i.bindTexture(r[0].ctxTexture)}}L(m2,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;


      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio;
        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);

        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);
        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
          vec4 color = texture2D(u_texture, v_textureCoordinate);
          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);
      }
    `});class y2 extends bo{constructor(i){super({renderer:i,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});L(this,"supportsIndexedTextures",!0)}bindTextures(i){const{renderer:u,glw:d}=this;if(i.length>u.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${u.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);i.forEach((x,s)=>{d.activeTexture(s),d.bindTexture(x.ctxTexture)});const y=Array.from(Array(i.length).keys());this.setUniform("u_textures[0]",y)}}L(y2,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_textureCoordinate;
      attribute vec2 a_position;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      void main(){
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;
        v_textureIndex = a_textureIndex;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:i=>`
      #define txUnits ${i}
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_image;
      uniform sampler2D u_textures[txUnits];

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      vec4 sampleFromTexture(sampler2D textures[${i}], int idx, vec2 uv) {
        ${Array.from(Array(i).keys()).map(u=>`
          ${u!==0?"else ":""}if (idx == ${u}) {
            return texture2D(textures[${u}], uv);
          }
        `).join("")}
        return texture2D(textures[0], uv);
      }

      void main(){
        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);
      }
    `});class an{constructor(r){L(this,"priority",1);L(this,"name","");L(this,"ref");L(this,"target");L(this,"passParameters","");L(this,"declaredUniforms","");L(this,"uniformInfo",{});const{ref:i,target:u,props:d={}}=r;this.ref=i,this.target=u;const y={},x=[];let s="";const g=this.constructor.uniforms||{};for(const M in g){const A=g[M],k=A.type,b=`${i}_${M}`;let P="";A.size&&(P=`[${A.size(d)}]`),x.push(b),s+=`uniform ${k} ${b}${P};`,y[M]={name:b,uniform:g[M].method}}this.passParameters=x.join(","),this.declaredUniforms=s,this.uniformInfo=y}static getEffectKey(r){return""}static getMethodParameters(r,i){const u=[];for(const d in r){const y=r[d];let x="";y.size&&(x=`[${y.size(i)}]`),u.push(`${y.type} ${d}${x}`)}return u.join(",")}static resolveDefaults(r){return{}}static makeEffectKey(r){return!1}}L(an,"uniforms",{}),L(an,"methods"),L(an,"onShaderMask"),L(an,"onColorize"),L(an,"onEffectMask");const Hd=new Map,kI=(h,r)=>{const i=JSON.stringify(h);if(Hd.has(i))return Hd.get(i);h=h??[];const u=[],d=h.length;let y=0;for(;y<d;y++){const{name:x,type:s,props:g}=h[y],M={name:x,type:s,props:{}},A=r[s],k=A.resolveDefaults(g),b=A.uniforms,P=Object.keys(b),w=P.length;let R=0;for(;R<w;R++){const B=P[R],U=b[B],W={value:k[B],programValue:void 0,updateOnBind:U.updateOnBind||!1,hasValidator:U.validator!==void 0,hasProgramValueUpdater:U.updateProgramValue!==void 0},G=W.hasValidator&&U.validator(k[B],k)||k[B];k[B]!==G&&(W.validatedValue=G),W.hasProgramValueUpdater&&U.updateProgramValue(W),W.programValue===void 0&&(W.programValue=W.value),M.props[B]=W}u.push(M)}return Hd.set(i,u),u},io=class io extends bo{constructor(i,u,d){const y=io.createShader(u,d);super({renderer:i,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...y.uniforms],shaderSources:{vertex:y.vertex,fragment:y.fragment}});L(this,"effects",[]);this.effects=y.effects}bindTextures(i){const{glw:u}=this;u.activeTexture(0),u.bindTexture(i[0].ctxTexture)}bindProps(i){var x;const u=i.effects,d=u.length;let y=0;for(;y<d;y++){const s=u[y],g=this.effects[y].uniformInfo,M=Object.keys(s.props),A=M.length;let k=0;for(;k<A;k++){const b=M[k];if(s.props[b].updateOnBind===!0){const w=(x=this.renderer.shManager.getRegisteredEffects()[s.type])==null?void 0:x.uniforms[b];w==null||w.updateProgramValue(s.props[b],i)}this.setUniform(g[b].name,s.props[b].programValue)}}}canBatchShaderProps(i,u){if(i.$dimensions.width!==u.$dimensions.width||i.$dimensions.height!==u.$dimensions.height||i.effects.length!==u.effects.length)return!1;const d=i.effects.length;let y=0;for(;y<d;y++){const x=i.effects[y],s=u.effects[y];if(x.type!==s.type)return!1;for(const g in x.props)if(s.props&&!s.props[g]||x.props[g].value!==s.props[g].value)return!1}return!0}static createShader(i,u){const d={},y={};let x="";const s=[],g=[],M=i.effects.map(w=>{const R=u[w.type],B=R.getEffectKey(w.props||{});d[B]=d[B]?++d[B]:1;const U=d[B];U===1&&g.push({key:B,type:w.type,props:w.props});const W=new R({ref:`${B}${U===1?"":U}`,target:B,props:w.props});return x+=W.declaredUniforms,s.push(...Object.values(W.uniformInfo)),W});let A="";g==null||g.forEach(w=>{const R=u[w.type],B=R.resolveDefaults(w.props??{}),U=[];for(const H in R.methods){let J=H;const fe=R.methods[H];y[H]&&y[H]!==fe&&(J=io.resolveMethodDuplicate(H,fe,y)),y[J]=fe.replace("function",J),U.push({m:H,cm:J})}let W=R.onShaderMask instanceof Function?R.onShaderMask(B):R.onShaderMask,G=R.onColorize instanceof Function?R.onColorize(B):R.onColorize,Q=R.onEffectMask instanceof Function?R.onEffectMask(B):R.onEffectMask;U.forEach(H=>{const{m:J,cm:fe}=H,E=new RegExp(`\\$${J}`,"g");W&&(W=W.replace(E,fe)),G&&(G=G.replace(E,fe)),Q&&(Q=Q.replace(E,fe))});const ee=R.getMethodParameters(R.uniforms,B),Z=ee.length>0?`, ${ee}`:"";W&&(A+=`
        float fx_${w.key}_onShaderMask(float shaderMask ${Z}) {
          ${W}
        }
        `),G&&(A+=`
          vec4 fx_${w.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${Z}) {
            ${G}
          }
        `),Q&&(A+=`
          vec4 fx_${w.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${Z}) {
            ${Q}
          }
        `)});let k="";for(const w in y)k+=y[w];let b="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",P=`

    `;for(let w=0;w<M.length;w++){const R=M[w],B=R.passParameters.length>0?`, ${R.passParameters}`:"",U=u[R.name];U.onShaderMask&&(P+=`
        shaderMask = fx_${R.target}_onShaderMask(shaderMask ${B});
        `),U.onColorize&&(P+=`
        maskColor = fx_${R.target}_onColorize(shaderMask, maskColor, shaderColor${B});
        `),U.onEffectMask&&(b=`fx_${R.target}_onEffectMask(shaderMask, maskColor, shaderColor${B})`);const W=M[w+1];(W===void 0||u[W.name].onEffectMask)&&(P+=`
          shaderColor = ${b};
        `)}return{effects:M,uniforms:s,fragment:io.fragment(x,k,A,P),vertex:io.vertex()}}static resolveMethodDuplicate(i,u,d,y=0){const x=i+(y>0?y:"");return d[x]&&d[x]!==u?this.resolveMethodDuplicate(i,u,d,++y):x}static resolveDefaults(i,u){return Ye(u),{effects:kI(i.effects??[],u),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(i,u){var y;let d="";return(y=i.effects)==null||y.forEach(x=>{const g=u[x.type].getEffectKey(x.props||{});d+=`,${g}`}),`DynamicShader${d}`}};L(io,"z$__type__Props"),L(io,"vertex",()=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    attribute vec2 a_textureCoordinate;
    attribute vec2 a_position;
    attribute vec4 a_color;
    attribute float a_textureIndex;

    uniform vec2 u_resolution;
    uniform float u_pixelRatio;

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;
    varying float v_textureIndex;

    void main(){
      vec2 normalized = a_position * u_pixelRatio / u_resolution;
      vec2 zero_two = normalized * 2.0;
      vec2 clip_space = zero_two - 1.0;

      // pass to fragment
      v_color = a_color;
      v_textureCoordinate = a_textureCoordinate;
      v_textureIndex = a_textureIndex;

      // flip y
      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
    }
  `),L(io,"fragment",(i,u,d,y)=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    #define PI 3.14159265359

    uniform vec2 u_resolution;
    uniform vec2 u_dimensions;
    uniform float u_alpha;
    uniform float u_radius;
    uniform sampler2D u_texture;
    uniform float u_pixelRatio;

    ${i}

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;

    ${u}

    ${d}

    void main() {
      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;
      vec2 d = abs(p) - (u_dimensions) * 0.5;
      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));

      vec4 shaderColor = vec4(0.0);
      float shaderMask = lng_DefaultMask;

      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;

      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));

      ${y}

      gl_FragColor = shaderColor * u_alpha;
    }
  `);let cs=io;class ip extends bo{constructor(r){super({renderer:r,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(r){return{radius:r.radius||10,$dimensions:{width:0,height:0}}}bindTextures(r){const{glw:i}=this;i.activeTexture(0),i.bindTexture(r[0].ctxTexture)}bindProps(r){const i=Math.min(r.$dimensions.width,r.$dimensions.height)/(2*r.radius);this.setUniform("u_radius",r.radius*Math.min(i,1))}canBatchShaderProps(r,i){return r.radius===i.radius&&r.$dimensions.width===i.$dimensions.width&&r.$dimensions.height===i.$dimensions.height}}L(ip,"z$__type__Props"),L(ip,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform vec2 u_dimensions;
      uniform float u_radius;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      float boxDist(vec2 p, vec2 size, float radius){
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }

      float fillMask(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }

      void main() {
        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;
        vec2 halfDimensions = u_dimensions * 0.5;

        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);
        gl_FragColor = mix(vec4(0.0), color, fillMask(d));
      }
    `});const MI=new Float32Array([1,0,0,0,1,0,0,0,1]),Uf=class Uf extends bo{constructor(r){super({renderer:r,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(r){const{glw:i}=this;i.activeTexture(0),i.bindTexture(r[0].ctxTexture)}bindProps(r){const i=Uf.resolveDefaults(r);for(const u in i)if(u==="transform")this.setUniform("u_transform",!1,i[u]);else if(u==="scrollY")this.setUniform("u_scrollY",i[u]);else if(u==="color"){const d=Va(i.color);this.setUniform("u_color",d)}else u==="size"?this.setUniform("u_size",i[u]):u==="distanceRange"?this.setUniform("u_distanceRange",i[u]):u==="debug"&&this.setUniform("u_debug",i[u]?1:0)}static resolveDefaults(r={}){return{transform:r.transform??MI,scrollY:r.scrollY??0,color:r.color??4294967295,size:r.size??16,distanceRange:r.distanceRange??1,debug:r.debug??!1}}};L(Uf,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      // an attribute is an input (in) to a vertex shader.
      // It will receive data from a buffer
      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;

      uniform vec2 u_resolution;
      uniform mat3 u_transform;
      uniform float u_scrollY;
      uniform float u_pixelRatio;
      uniform float u_size;

      varying vec2 v_texcoord;

      void main() {
        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);
        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;

        // Calculate screen space with pixel ratio
        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);

        gl_Position = vec4(screenSpace, 0.0, 1.0);
        v_texcoord = a_textureCoordinate;

      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      uniform vec4 u_color;
      uniform sampler2D u_texture;
      uniform float u_distanceRange;
      uniform float u_pixelRatio;
      uniform int u_debug;

      varying vec2 v_texcoord;

      float median(float r, float g, float b) {
          return max(min(r, g), min(max(r, g), b));
      }

      void main() {
          vec3 sample = texture2D(u_texture, v_texcoord).rgb;
          if (u_debug == 1) {
            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);
            return;
          }
          float scaledDistRange = u_distanceRange * u_pixelRatio;
          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);
          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;

          // Build the final color.
          // IMPORTANT: We must premultiply the color by the alpha value before returning it.
          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);
      }
    `});let op=Uf;const ys=h=>{h.programValue===void 0&&(h.programValue=new Float32Array(4));const r=h.value,i=h.programValue;i[0]=(r>>>24)/255,i[1]=(r>>>16&255)/255,i[2]=(r>>>8&255)/255,i[3]=(r&255)/255},_I=h=>{const r=h.validatedValue||h.value;if(h.programValue instanceof Float32Array){const i=h.programValue;i[0]=r[0],i[1]=r[1]}else h.programValue=new Float32Array(r)},RI=h=>{const r=h.validatedValue||h.value;if(h.programValue instanceof Float32Array){const i=h.programValue;i[0]=r[0],i[1]=r[1],i[2]=r[1],i[3]=r[1]}else h.programValue=new Float32Array(r)},v2=h=>{const r=h.validatedValue||h.value;if(h.programValue instanceof Float32Array){const i=r.length,u=h.programValue;for(let d=0;d<i;d++)u[d]=r[d]}else h.programValue=new Float32Array(r)},xp=h=>{const r=Array.isArray(h);if(r){if(r&&h.length===4)return h;if(r&&h.length===2)return[h[0],h[1],h[0],h[1]];if(r&&h.length===3)return[h[0],h[1],h[2],h[0]]}else return[h,h,h,h];return[h[0],h[0],h[0],h[0]]},x2=(h,r)=>{h.programValue===void 0&&(h.programValue=new Float32Array(4));const i=h.programValue,u=h.validatedValue||h.value;if(r===void 0&&h.$dimensions===void 0){i[0]=u[0],i[1]=u[1],i[2]=u[2],i[3]=u[3];return}let d=h.$dimensions;if(r!==void 0){const{$dimensions:b}=r;if(d!==void 0&&(d.width===b.width||d.height===b.height))return;d===void 0&&(d={width:b==null?void 0:b.width,height:b==null?void 0:b.height},h.$dimensions=d)}const{width:y,height:x}=d,[s,g,M,A]=u,k=Math.min(Math.min(Math.min(y/Math.max(y,s+g),y/Math.max(y,M+A)),Math.min(x/Math.max(x,s+M),x/Math.max(x,g+A))),1);i[0]=s*k,i[1]=g*k,i[2]=M*k,i[3]=A*k};class ns extends an{constructor(){super(...arguments);L(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(i){return{radius:i.radius??10}}}L(ns,"z$__type__Props"),L(ns,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:xp,updateProgramValue:x2}}),L(ns,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),L(ns,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);
  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);
  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);
  `),L(ns,"onEffectMask",`
  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));
  `);class Ra extends an{constructor(){super(...arguments);L(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(i){return{width:i.width??10,color:i.color??4294967295}}}L(Ra,"z$__type__Props"),L(Ra,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ys,method:"uniform4fv",type:"vec4"}}),L(Ra,"onEffectMask",`
  float intR = shaderMask + 1.0;
  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);
  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);
  `),L(Ra,"onColorize",`
    return color;
  `);const So=class So extends an{constructor(){super(...arguments);L(this,"name","linearGradient")}static getEffectKey(i){return`linearGradient${i.colors.length}`}static resolveDefaults(i){const u=i.colors??[4278190080,4294967295];let d=i.stops||[];if(d.length===0||d.length!==u.length){const y=u.length;let x=0;const s=d;for(;x<y;x++)d[x]?(s[x]=d[x],d[x-1]===void 0&&s[x-2]!==void 0&&(s[x-1]=s[x-2]+(d[x]-s[x-2])/2)):s[x]=x*(1/(u.length-1));d=s}return{colors:u,stops:d,angle:i.angle??0}}};L(So,"z$__type__Props"),L(So,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:i=>i.reduce((u,d)=>u.concat(Va(d)),[]),updateProgramValue:v2,size:i=>i.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:i=>i.colors.length,method:"uniform1fv",type:"float"}}),L(So,"methods",{fromLinear:`
      vec4 function(vec4 linearRGB) {
        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);
        vec4 lower = linearRGB * vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,toLinear:`
      vec4 function(vec4 sRGB) {
        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));
        vec4 lower = sRGB/vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,calcPoint:`
      vec2 function(float d, float angle) {
        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);
      }
    `}),L(So,"ColorLoop",i=>{let u="";for(let d=2;d<i;d++)u+=`colorOut = mix(colorOut, colors[${d}], clamp((dist - stops[${d-1}]) / (stops[${d}] - stops[${d-1}]), 0.0, 1.0));`;return u}),L(So,"onColorize",i=>{const u=i.colors.length||1;return`
      float a = angle - (PI / 180.0 * 90.0);
      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));
      vec2 f = $calcPoint(lineDist * 0.5, a);
      vec2 t = $calcPoint(lineDist * 0.5, a + PI);
      vec2 gradVec = t - f;
      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));
      ${So.ColorLoop(u)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let rp=So;class sp extends an{constructor(){super(...arguments);L(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(i){return{amount:i.amount??1}}}L(sp,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),L(sp,"onColorize",`
    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;
    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);
  `);class is extends an{constructor(){super(...arguments);L(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(i){return{width:i.width??10,color:i.color??4294967295}}}L(is,"z$__type__Props"),L(is,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ys,method:"uniform4fv",type:"vec4"}}),L(is,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),L(is,"onEffectMask",`
  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),L(is,"onColorize",`
    return color;
  `);class os extends an{constructor(){super(...arguments);L(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(i){return{width:i.width??10,color:i.color??4294967295}}}L(os,"z$__type__Props"),L(os,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ys,method:"uniform4fv",type:"vec4"}}),L(os,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),L(os,"onEffectMask",`
  vec2 pos = vec2(0.0, width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),L(os,"onColorize",`
    return color;
  `);class rs extends an{constructor(){super(...arguments);L(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(i){return{width:i.width??10,color:i.color??4294967295}}}L(rs,"z$__type__Props"),L(rs,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ys,method:"uniform4fv",type:"vec4"}}),L(rs,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),L(rs,"onEffectMask",`
  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),L(rs,"onColorize",`
    return color;
  `);class ss extends an{constructor(){super(...arguments);L(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(i){return{width:i.width??10,color:i.color??4294967295}}}L(ss,"z$__type__Props"),L(ss,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ys,method:"uniform4fv",type:"vec4"}}),L(ss,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),L(ss,"onEffectMask",`
  vec2 pos = vec2(width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),L(ss,"onColorize",`
    return color;
  `);class La extends an{constructor(){super(...arguments);L(this,"name","glitch")}static getEffectKey(i){return"glitch"}static resolveDefaults(i){return{amplitude:i.amplitude??.2,narrowness:i.narrowness??4,blockiness:i.blockiness??2,minimizer:i.minimizer??8,time:i.time??Date.now()}}}L(La,"z$__type__Props"),L(La,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:i=>{const u=i.value=(Date.now()-i.value)%1e3;i.programValue=u},type:"float"}}),L(La,"methods",{rand:`
      float function(vec2 p, float time) {
        float t = floor(time * 20.) / 10.;
        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);
      }
    `,noise:`
      float function(vec2 uv, float blockiness, float time) {
        vec2 lv = fract(uv);
        vec2 id = floor(uv);

        float n1 = rand(id, time);
        float n2 = rand(id+vec2(1,0), time);
        float n3 = rand(id+vec2(0,1), time);
        float n4 = rand(id+vec2(1,1), time);
        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);
        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);
      }
    `,fbm:`
      float function(vec2 uv, int count, float blockiness, float complexity, float time) {
        float val = 0.0;
        float amp = 0.5;
        const int MAX_ITERATIONS = 10;

        for(int i = 0; i < MAX_ITERATIONS; i++) {
          if(i >= count) {break;}
          val += amp * noise(uv, blockiness, time);
          amp *= 0.5;
          uv *= complexity;
        }
        return val;
      }
    `}),L(La,"onColorize",`
    vec2 uv = v_textureCoordinate.xy;
    float aspect = u_dimensions.x / u_dimensions.y;
    vec2 a = vec2(uv.x * aspect , uv.y);
    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));

    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);
    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);
    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);
    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);

    vec3 f = vec3(colR, colG, colB);
    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);
  `);class Sf extends an{constructor(){super(...arguments);L(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(i){return{fade:i.fade??10}}}L(Sf,"z$__type__Props"),L(Sf,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:xp,updateProgramValue:RI}}),L(Sf,"onColorize",`
  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;
  vec2 pos1;
  vec2 pos2;
  vec2 d;
  float c;
  vec4 result = maskColor;


  if(fade[0] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x, point.y + fade[0]);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[1] > 0.0) {
    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);
    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[2] > 0.0) {
    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);
    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[3] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x + fade[3], point.y);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  return result;
  `);const Jo=class Jo extends an{constructor(){super(...arguments);L(this,"name","radialGradient")}static getEffectKey(i){return`radialGradient${i.colors.length}`}static resolveDefaults(i){const u=i.colors??[4278190080,4294967295];let d=i.stops||[];if(d.length===0||d.length!==u.length){const y=u.length;let x=0;const s=d;for(;x<y;x++)d[x]?(s[x]=d[x],d[x-1]===void 0&&s[x-2]!==void 0&&(s[x-1]=s[x-2]+(d[x]-s[x-2])/2)):s[x]=x*(1/(u.length-1));d=s}return{colors:u,stops:d,width:i.width??0,height:i.height??i.width??0,pivot:i.pivot??[.5,.5]}}};L(Jo,"z$__type__Props"),L(Jo,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:_I,method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:i=>i.reduce((u,d)=>u.concat(Va(d)),[]),updateProgramValue:v2,size:i=>i.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:i=>i.colors.length,method:"uniform1fv",type:"float"}}),L(Jo,"ColorLoop",i=>{let u="";for(let d=2;d<i;d++)u+=`colorOut = mix(colorOut, colors[${d}], clamp((dist - stops[${d-1}]) / (stops[${d}] - stops[${d-1}]), 0.0, 1.0));`;return u}),L(Jo,"onColorize",i=>{const u=i.colors.length||1;return`
      vec2 point = v_textureCoordinate.xy * u_dimensions;
      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);

      float dist = length((point - projection) / vec2(width, height));

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = mix(colors[0], colors[1], stopCalc);
      ${Jo.ColorLoop(u)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let ap=Jo;class as extends an{constructor(){super(...arguments);L(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(i){return{width:i.width??10,progress:i.progress??.5,offset:i.offset??0,range:i.range??Math.PI*2,rounded:i.rounded??!1,radius:i.radius??1,color:i.color??4294967295}}}L(as,"z$__type__Props"),L(as,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:i=>i?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ys,method:"uniform4fv",type:"vec4"}}),L(as,"methods",{rotateUV:`
    vec2 function(vec2 uv, float d) {
      float s = sin(d);
      float c = cos(d);
      mat2 rotMatrix = mat2(c, -s, s, c);
      return uv * rotMatrix;
    }
    `,drawDot:`
    float function(vec2 uv, vec2 p, float r) {
      uv += p;
      float circle = length(uv) - r;
      return clamp(-circle, 0.0, 1.0);
    }
    `}),L(as,"onEffectMask",`
    float outerRadius = radius * u_dimensions.y * 0.5;

    float endAngle = range * progress - 0.0005;

    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;

    uv = $rotateUV(uv, -(offset));
    float linewidth = width * u_pixelRatio;
    float circle = length(uv) - (outerRadius - linewidth) ;
    circle = abs(circle) - linewidth;
    circle = clamp(-circle, 0.0, 1.0);

    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);
    float p = endAngle / (PI * 2.);

    circle *= step(fract(angle), fract(p));

    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));
    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));

    return mix(shaderColor, maskColor, circle);
  `),L(as,"onColorize",`
    return color;
  `);class ls extends an{constructor(){super(...arguments);L(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(i){return{x:i.x||0,y:i.y||0,width:i.width||50,height:i.height||50,radius:i.radius??0}}}L(ls,"z$__type__Props"),L(ls,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:xp,updateProgramValue:x2}}),L(ls,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),L(ls,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  vec2 size = vec2(width, height) * 0.5;
  vec2 basePos = v_textureCoordinate.xy * u_dimensions.xy - vec2(x, y);
  vec2 pos = basePos - size;
  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);
  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);
  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);
  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);
  return $boxDist(pos, size, r);
  `),L(ls,"onEffectMask",`
  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));
  `);const w2="RoundedRectangle";class wp extends p2{constructor(i){super();L(this,"shType");this.shType=i,i!==w2&&console.warn("Unsupported shader:",i)}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class LI{constructor(r,i,u,d){L(this,"type");L(this,"shader");L(this,"resolvedProps");L(this,"props");this.type=r,this.shader=i,this.resolvedProps=u;const y=Object.keys(u),x=y.length,s={};for(let g=0;g<x;g++){const M=y[g];Object.defineProperty(s,M,{get:()=>this.resolvedProps[M],set:A=>{this.resolvedProps[M]=A,d.requestRender()}})}this.props=s}getResolvedProps(){return this.resolvedProps}}class PI{constructor(r,i,u){L(this,"shader");L(this,"resolvedProps");L(this,"props");L(this,"type");this.shader=r,this.type="DynamicShader",this.resolvedProps=i;const d=u.getRegisteredEffects(),y={},x=i.effects,s=x.length;for(let g=0;g<s;g++){const{name:M,props:A,type:k}=x[g];if(M===void 0)continue;const b={},P=Object.keys(A),w=P.length;for(let R=0;R<w;R++){const B=P[R];Object.defineProperty(b,B,{get:()=>this.resolvedProps.effects[g].props[B].value,set:U=>{var G,Q;const W=this.resolvedProps.effects[g].props[B];W.value=U,W.hasValidator&&(U=W.validatedValue=(G=d[k].uniforms[B])==null?void 0:G.validator(U,A)),W.hasProgramValueUpdater?(Q=d[k].uniforms[B])==null||Q.updateProgramValue(W):W.programValue=U,u.renderer.stage.requestRender()}})}Object.defineProperty(y,M,{get:()=>b})}this.props=y}getResolvedProps(){return this.resolvedProps}}class DI{constructor(){L(this,"shCache",new Map);L(this,"shConstructors",{});L(this,"attachedShader",null);L(this,"effectConstructors",{});L(this,"renderer");this.registerShaderType("DefaultShader",m2),this.registerShaderType("DefaultShaderBatched",y2),this.registerShaderType("RoundedRectangle",ip),this.registerShaderType("DynamicShader",cs),this.registerShaderType("SdfShader",op),this.registerEffectType("border",Ra),this.registerEffectType("borderBottom",rs),this.registerEffectType("borderLeft",ss),this.registerEffectType("borderRight",is),this.registerEffectType("borderTop",os),this.registerEffectType("fadeOut",Sf),this.registerEffectType("linearGradient",rp),this.registerEffectType("radialGradient",ap),this.registerEffectType("grayscale",sp),this.registerEffectType("glitch",La),this.registerEffectType("radius",ns),this.registerEffectType("radialProgress",as),this.registerEffectType("holePunch",ls)}registerShaderType(r,i){this.shConstructors[r]=i}registerEffectType(r,i){this.effectConstructors[r]=i}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(r,i){if(!this.renderer)throw new Error("Renderer is not been defined");const u=this.shConstructors[r];if(!u)throw new Error(`Shader type "${r}" is not registered`);if(this.renderer.mode==="canvas"&&u.prototype instanceof bo)return this._createShaderCtr(r,new wp(r),i);if(r==="DynamicShader")return this.loadDynamicShader(i);const d=u.resolveDefaults(i),y=u.makeCacheKey(d)||u.name;if(y&&this.shCache.has(y))return this._createShaderCtr(r,this.shCache.get(y),d);const x=new u(this.renderer,i);return y&&this.shCache.set(y,x),this._createShaderCtr(r,x,d)}loadDynamicShader(r){if(!this.renderer)throw new Error("Renderer is not been defined");const i=cs.resolveDefaults(r,this.effectConstructors),u=cs.makeCacheKey(i,this.effectConstructors);if(u&&this.shCache.has(u))return this._createDynShaderCtr(this.shCache.get(u),i);const d=new cs(this.renderer,r,this.effectConstructors);return u&&this.shCache.set(u,d),this._createDynShaderCtr(d,i)}_createShaderCtr(r,i,u){return new LI(r,i,u,this.renderer.stage)}_createDynShaderCtr(r,i){return new PI(r,i,this)}useShader(r){this.attachedShader!==r&&(this.attachedShader&&this.attachedShader.detach(),r.attach(),this.attachedShader=r)}}class S2{constructor(r){L(this,"config");this.config=r}getBuffer(r){var i;return(i=this.config.find(u=>u.attributes[r]))==null?void 0:i.buffer}getAttributeInfo(r){var i;return(i=this.config.find(u=>u.attributes[r]))==null?void 0:i.attributes[r]}}function NI(h){return self.WebGL2RenderingContext&&h instanceof self.WebGL2RenderingContext}class OI{constructor(r){L(this,"gl");L(this,"activeTextureUnit",0);L(this,"texture2dUnits");L(this,"texture2dParams",new WeakMap);L(this,"scissorEnabled");L(this,"scissorX");L(this,"scissorY");L(this,"scissorWidth");L(this,"scissorHeight");L(this,"blendEnabled");L(this,"blendSrcRgb");L(this,"blendDstRgb");L(this,"blendSrcAlpha");L(this,"blendDstAlpha");L(this,"boundArrayBuffer");L(this,"boundElementArrayBuffer");L(this,"curProgram");L(this,"programUniforms",new WeakMap);L(this,"canvas");L(this,"MAX_RENDERBUFFER_SIZE");L(this,"MAX_TEXTURE_SIZE");L(this,"MAX_VIEWPORT_DIMS");L(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS");L(this,"MAX_TEXTURE_IMAGE_UNITS");L(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS");L(this,"MAX_VERTEX_ATTRIBS");L(this,"MAX_VARYING_VECTORS");L(this,"MAX_VERTEX_UNIFORM_VECTORS");L(this,"MAX_FRAGMENT_UNIFORM_VECTORS");L(this,"TEXTURE_MAG_FILTER");L(this,"TEXTURE_MIN_FILTER");L(this,"TEXTURE_WRAP_S");L(this,"TEXTURE_WRAP_T");L(this,"LINEAR");L(this,"CLAMP_TO_EDGE");L(this,"RGBA");L(this,"UNSIGNED_BYTE");L(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL");L(this,"UNPACK_FLIP_Y_WEBGL");L(this,"FLOAT");L(this,"TRIANGLES");L(this,"UNSIGNED_SHORT");L(this,"ONE");L(this,"ONE_MINUS_SRC_ALPHA");L(this,"VERTEX_SHADER");L(this,"FRAGMENT_SHADER");L(this,"STATIC_DRAW");L(this,"COMPILE_STATUS");L(this,"LINK_STATUS");L(this,"DYNAMIC_DRAW");L(this,"COLOR_ATTACHMENT0");this.gl=r,this.activeTextureUnit=r.getParameter(r.ACTIVE_TEXTURE)-r.TEXTURE0;const i=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(i).fill(void 0).map((d,y)=>(this.activeTexture(y),r.getParameter(r.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=r.isEnabled(r.SCISSOR_TEST);const u=r.getParameter(r.SCISSOR_BOX);this.scissorX=u[0],this.scissorY=u[1],this.scissorWidth=u[2],this.scissorHeight=u[3],this.blendEnabled=r.isEnabled(r.BLEND),this.blendSrcRgb=r.getParameter(r.BLEND_SRC_RGB),this.blendDstRgb=r.getParameter(r.BLEND_DST_RGB),this.blendSrcAlpha=r.getParameter(r.BLEND_SRC_ALPHA),this.blendDstAlpha=r.getParameter(r.BLEND_DST_ALPHA),this.boundArrayBuffer=r.getParameter(r.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=r.getParameter(r.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=r.getParameter(r.CURRENT_PROGRAM),this.canvas=r.canvas,this.MAX_RENDERBUFFER_SIZE=r.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=r.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=r.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=r.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=r.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=r.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=r.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=r.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=r.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=r.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=r.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=r.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=r.TEXTURE_WRAP_T,this.LINEAR=r.LINEAR,this.CLAMP_TO_EDGE=r.CLAMP_TO_EDGE,this.RGBA=r.RGBA,this.UNSIGNED_BYTE=r.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=r.UNPACK_FLIP_Y_WEBGL,this.FLOAT=r.FLOAT,this.TRIANGLES=r.TRIANGLES,this.UNSIGNED_SHORT=r.UNSIGNED_SHORT,this.ONE=r.ONE,this.ONE_MINUS_SRC_ALPHA=r.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=r.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=r.TRIANGLES,this.UNSIGNED_SHORT=r.UNSIGNED_SHORT,this.VERTEX_SHADER=r.VERTEX_SHADER,this.FRAGMENT_SHADER=r.FRAGMENT_SHADER,this.STATIC_DRAW=r.STATIC_DRAW,this.COMPILE_STATUS=r.COMPILE_STATUS,this.LINK_STATUS=r.LINK_STATUS,this.DYNAMIC_DRAW=r.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=r.COLOR_ATTACHMENT0}isWebGl2(){return NI(this.gl)}activeTexture(r){const{gl:i}=this;this.activeTextureUnit!==r&&(i.activeTexture(r+i.TEXTURE0),this.activeTextureUnit=r)}bindTexture(r){const{gl:i,activeTextureUnit:u,texture2dUnits:d}=this;d[u]!==r&&(d[u]=r,i.bindTexture(this.gl.TEXTURE_2D,r))}_getActiveTexture(){const{activeTextureUnit:r,texture2dUnits:i}=this;return i[r]}texParameteri(r,i){const{gl:u,texture2dParams:d}=this,y=this._getActiveTexture();if(!y)throw new Error("No active texture");let x=d.get(y);x||(x={},d.set(y,x)),x[r]!==i&&(x[r]=i,u.texParameteri(u.TEXTURE_2D,r,i))}texImage2D(r,i,u,d,y,x,s,g){const{gl:M}=this;x?M.texImage2D(M.TEXTURE_2D,r,i,u,d,y,x,s,g):M.texImage2D(M.TEXTURE_2D,r,i,u,d,y)}compressedTexImage2D(r,i,u,d,y,x){const{gl:s}=this;s.compressedTexImage2D(s.TEXTURE_2D,r,i,u,d,y,x)}pixelStorei(r,i){const{gl:u}=this;u.pixelStorei(r,i)}generateMipmap(){const{gl:r}=this;r.generateMipmap(r.TEXTURE_2D)}createTexture(){const{gl:r}=this;return r.createTexture()}deleteTexture(r){const{gl:i}=this;r&&this.texture2dParams.delete(r),i.deleteTexture(r)}viewport(r,i,u,d){const{gl:y}=this;y.viewport(r,i,u,d)}clearColor(r,i,u,d){const{gl:y}=this;y.clearColor(r,i,u,d)}setScissorTest(r){const{gl:i,scissorEnabled:u}=this;r!==u&&(r?i.enable(i.SCISSOR_TEST):i.disable(i.SCISSOR_TEST),this.scissorEnabled=r)}scissor(r,i,u,d){const{gl:y,scissorX:x,scissorY:s,scissorWidth:g,scissorHeight:M}=this;(r!==x||i!==s||u!==g||d!==M)&&(y.scissor(r,i,u,d),this.scissorX=r,this.scissorY=i,this.scissorWidth=u,this.scissorHeight=d)}setBlend(r){const{gl:i,blendEnabled:u}=this;r!==u&&(r?i.enable(i.BLEND):i.disable(i.BLEND),this.blendEnabled=r)}blendFunc(r,i){const{gl:u,blendSrcRgb:d,blendDstRgb:y,blendSrcAlpha:x,blendDstAlpha:s}=this;(r!==d||i!==y||r!==x||i!==s)&&(u.blendFunc(r,i),this.blendSrcRgb=r,this.blendDstRgb=i,this.blendSrcAlpha=r,this.blendDstAlpha=i)}createBuffer(){const{gl:r}=this;return r.createBuffer()}createFramebuffer(){const{gl:r}=this;return r.createFramebuffer()}bindFramebuffer(r){const{gl:i}=this;i.bindFramebuffer(i.FRAMEBUFFER,r)}framebufferTexture2D(r,i,u){const{gl:d}=this;d.framebufferTexture2D(d.FRAMEBUFFER,r,d.TEXTURE_2D,i,u)}clear(){const{gl:r}=this;r.clear(r.COLOR_BUFFER_BIT)}arrayBufferData(r,i,u){const{gl:d,boundArrayBuffer:y}=this;y!==r&&(d.bindBuffer(d.ARRAY_BUFFER,r),this.boundArrayBuffer=r),d.bufferData(d.ARRAY_BUFFER,i,u)}elementArrayBufferData(r,i,u){const{gl:d,boundElementArrayBuffer:y}=this;y!==r&&(d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,r),this.boundElementArrayBuffer=r),d.bufferData(d.ELEMENT_ARRAY_BUFFER,i,u)}vertexAttribPointer(r,i,u,d,y,x,s){const{gl:g,boundArrayBuffer:M}=this;M!==r&&(g.bindBuffer(g.ARRAY_BUFFER,r),this.boundArrayBuffer=r),g.vertexAttribPointer(i,u,d,y,x,s)}useProgram(r){const{gl:i,curProgram:u}=this;u!==r&&(i.useProgram(r),this.curProgram=r)}setUniform(r,i,...u){const{gl:d,programUniforms:y}=this;let x=y.get(this.curProgram);x||(x=new Map,y.set(this.curProgram,x));const s=x.get(i);(!s||!UI(s,u))&&(x.set(i,u),d[r](i,...u))}getParameter(r){const{gl:i}=this;return i.getParameter(r)}drawElements(r,i,u,d){const{gl:y}=this;y.drawElements(r,i,u,d)}getExtension(r){const{gl:i}=this;return i.getExtension(r)}createVertexArray(){const{gl:r}=this;return Ye(r instanceof WebGL2RenderingContext),r.createVertexArray()}bindVertexArray(r){const{gl:i}=this;Ye(i instanceof WebGL2RenderingContext),i.bindVertexArray(r)}getAttribLocation(r,i){const{gl:u}=this;return u.getAttribLocation(r,i)}getUniformLocation(r,i){const{gl:u}=this;return u.getUniformLocation(r,i)}enableVertexAttribArray(r){const{gl:i}=this;i.enableVertexAttribArray(r)}disableVertexAttribArray(r){const{gl:i}=this;i.disableVertexAttribArray(r)}createShader(r){const{gl:i}=this;return i.createShader(r)}compileShader(r){const{gl:i}=this;i.compileShader(r)}attachShader(r,i){const{gl:u}=this;u.attachShader(r,i)}linkProgram(r){const{gl:i}=this;i.linkProgram(r)}deleteProgram(r){const{gl:i}=this;i.deleteProgram(r)}getShaderParameter(r,i){const{gl:u}=this;return u.getShaderParameter(r,i)}getShaderInfoLog(r){const{gl:i}=this;return i.getShaderInfoLog(r)}createProgram(){const{gl:r}=this;return r.createProgram()}getProgramParameter(r,i){const{gl:u}=this;return u.getProgramParameter(r,i)}getProgramInfoLog(r){const{gl:i}=this;return i.getProgramInfoLog(r)}shaderSource(r,i){const{gl:u}=this;u.shaderSource(r,i)}deleteShader(r){const{gl:i}=this;i.deleteShader(r)}}function UI(h,r){return h.length!==r.length?!1:h.every((i,u)=>Array.isArray(i)||i instanceof Float32Array?!1:i===r[u])}const Bf=class Bf extends ms{constructor(i,u){super(i);L(this,"props");this.props=Bf.resolveDefaults(u||{})}get width(){return this.props.width}set width(i){this.props.width=i}get height(){return this.props.height}set height(i){this.props.height=i}async getTextureData(){return{data:null,premultiplyAlpha:null}}static resolveDefaults(i){return{width:i.width||256,height:i.height||256}}};L(Bf,"z$__type__Props");let Fa=Bf;class Lx extends kf{constructor(i,u,d){super(i,u,d);L(this,"framebuffer");const y=i.createFramebuffer();Ye(y,"Unable to create framebuffer"),this.framebuffer=y}async onLoadRequest(){const{glw:i}=this,u=this._nativeCtxTexture=this.createNativeCtxTexture(),{width:d,height:y}=this.textureSource;return i.texImage2D(0,i.RGBA,d,y,0,i.RGBA,i.UNSIGNED_BYTE,null),this.setTextureMemUse(d*y*4),i.bindFramebuffer(this.framebuffer),i.framebufferTexture2D(i.COLOR_ATTACHMENT0,u,0),i.bindFramebuffer(null),{width:d,height:y}}}function BI(h){return/\.(ktx|pvr)$/.test(h)}const jI=async h=>{const i=await(await fetch(h)).arrayBuffer();return h.indexOf(".ktx")!==-1?FI(i):zI(i)},FI=async h=>{const r=new DataView(h),i=r.getUint32(12)===16909060,u=[],d={glInternalFormat:r.getUint32(28,i),pixelWidth:r.getUint32(36,i),pixelHeight:r.getUint32(40,i),numberOfMipmapLevels:r.getUint32(56,i),bytesOfKeyValueData:r.getUint32(60,i)};let y=64;y+=d.bytesOfKeyValueData;for(let x=0;x<d.numberOfMipmapLevels;x++){const s=r.getUint32(y);y+=4,u.push(r.buffer.slice(y,s)),y+=s}return{data:{glInternalFormat:d.glInternalFormat,mipmaps:u,width:d.pixelWidth||0,height:d.pixelHeight||0,type:"ktx"},premultiplyAlpha:!1}},zI=async h=>{const s=h,g=new Int32Array(s,0,13),M=g[12]+52,A=new Uint8Array(s,M),k=[],b={pixelWidth:g[7],pixelHeight:g[6],numberOfMipmapLevels:g[11]||0};let P=0,w=b.pixelWidth||0,R=b.pixelHeight||0;for(let B=0;B<b.numberOfMipmapLevels;B++){const U=(w+3>>2)*(R+3>>2)*8,W=new Uint8Array(s,A.byteOffset+P,U);k.push(W),P+=U,w=w>>1,R=R>>1}return{data:{glInternalFormat:36196,mipmaps:k,width:b.pixelWidth||0,height:b.pixelHeight||0,type:"pvr"},premultiplyAlpha:!1}},Ba=class Ba extends ms{constructor(i,u){super(i);L(this,"props");this.props=Ba.resolveDefaults(u)}hasAlphaChannel(i){return i.indexOf("image/png")!==-1}async getTextureData(){const{src:i,premultiplyAlpha:u}=this.props;if(!i)return{data:null};if(typeof i!="string")return i instanceof ImageData?{data:i,premultiplyAlpha:u}:{data:i(),premultiplyAlpha:u};if(BI(i))return jI(i);const d=cI(i);if(this.txManager.imageWorkerManager)return await this.txManager.imageWorkerManager.getImage(d,u);if(this.txManager.hasCreateImageBitmap){const x=await(await fetch(d)).blob(),s=u??this.hasAlphaChannel(x.type);return{data:await createImageBitmap(x,{premultiplyAlpha:s?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:s}}else{const y=new Image;return i.substr(0,5)!=="data:"&&(y.crossOrigin="Anonymous"),y.src=d,await new Promise((x,s)=>{y.onload=()=>x(),y.onerror=()=>s(new Error("Failed to load image"))}).catch(x=>{console.error(x)}),{data:y,premultiplyAlpha:u??!0}}}static makeCacheKey(i){const u=Ba.resolveDefaults(i),d=u.key||u.src;return typeof d!="string"?!1:`ImageTexture,${d},${u.premultiplyAlpha??"true"}`}static resolveDefaults(i){return{src:i.src??"",premultiplyAlpha:i.premultiplyAlpha??!0,key:i.key??null}}};L(Ba,"z$__type__Props");let _f=Ba;const VI=24;class Sp extends d2{constructor(i){super(i);L(this,"glw");L(this,"system");L(this,"quadBuffer");L(this,"fQuadBuffer");L(this,"uiQuadBuffer");L(this,"renderOps",[]);L(this,"curBufferIdx",0);L(this,"curRenderOp",null);L(this,"rttNodes",[]);L(this,"activeRttNode",null);L(this,"defShaderCtrl");L(this,"defaultShader");L(this,"quadBufferCollection");L(this,"defaultTexture");L(this,"quadBufferUsage",0);L(this,"renderToTextureActive",!1);this.quadBuffer=new ArrayBuffer(this.stage.options.quadBufferSize),this.fQuadBuffer=new Float32Array(this.quadBuffer),this.uiQuadBuffer=new Uint32Array(this.quadBuffer),this.mode="webgl";const{canvas:u,clearColor:d,bufferMemory:y}=i;this.defaultTexture=new Mf(this.txManager),this.defaultTexture.setRenderableOwner(this,!0),this.defaultTexture.once("loaded",()=>{this.stage.requestRender()});const x=eI(u,i.contextSpy),s=this.glw=new OI(x),g=Va(d);s.viewport(0,0,u.width,u.height),s.clearColor(g[0],g[1],g[2],g[3]),s.setBlend(!0),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),AI(s,y),this.system={parameters:CI(this.glw),extensions:EI(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;const M=s.createBuffer();Ye(M);const A=6*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new S2([{buffer:M,attributes:{a_position:{name:"a_position",size:2,type:s.FLOAT,normalized:!1,stride:A,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:s.FLOAT,normalized:!1,stride:A,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:s.UNSIGNED_BYTE,normalized:!0,stride:A,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:s.FLOAT,normalized:!1,stride:A,offset:5*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:i}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,i.setScissorTest(!1),i.clear()}getShaderManager(){return this.shManager}createCtxTexture(i){return i instanceof gs?new II(this.glw,this.txMemManager,i):i instanceof Fa?new Lx(this.glw,this.txMemManager,i):new kf(this.glw,this.txMemManager,i)}addQuad(i){const{fQuadBuffer:u,uiQuadBuffer:d}=this,{width:y,height:x,colorTl:s,colorTr:g,colorBl:M,colorBr:A,textureOptions:k,shader:b,shaderProps:P,alpha:w,clippingRect:R,tx:B,ty:U,ta:W,tb:G,tc:Q,td:ee,renderCoords:Z,rtt:H,parentHasRenderTexture:J,framebufferDimensions:fe}=i;let{texture:E}=i;if(P&&tp(P,"$dimensions")){const z=P.$dimensions;z.width=y,z.height=x}E=E??this.defaultTexture,Ye(E instanceof ms,"Invalid texture type");let{curBufferIdx:F,curRenderOp:re}=this;const ye={width:y,height:x},ie=b||this.defaultShader;Ye(ie instanceof bo),this.reuseRenderOp(i)||(this.newRenderOp(ie,P,w,ye,R,F,H,J,fe),re=this.curRenderOp,Ye(re));const se=(k==null?void 0:k.flipX)??!1;let ne=(k==null?void 0:k.flipY)??!1;E instanceof Fa&&(ne=!ne);let le=0,xe=0,we=1,Te=1;if(E instanceof gs){const{x:z,y:Re,width:Ae,height:oe}=E.props,{width:D=0,height:me=0}=E.parentTexture.dimensions||{width:0,height:0};le=z/D,we=le+Ae/D,xe=Re/me,Te=xe+oe/me,E=E.parentTexture}const Ie=(k==null?void 0:k.resizeMode)??!1;if(E instanceof _f&&Ie&&E.dimensions){const{width:z,height:Re}=E.dimensions;if(Ie.type==="cover"){const Ae=y/z,oe=x/Re,D=Math.max(Ae,oe),me=1/D;if(D&&Ae&&Ae<D){const Ce=me*y;le=(1-Ce/z)*(Ie.clipX??.5),we=le+Ce/z}if(D&&oe&&oe<D){const Ce=me*x;xe=(1-Ce/Re)*(Ie.clipY??.5),Te=xe+Ce/Re}}}se&&([le,we]=[we,le]),ne&&([xe,Te]=[Te,xe]);const Ee=E.ctxTexture;Ye(Ee instanceof kf);const _e=this.addTexture(Ee,F);if(re=this.curRenderOp,Ye(re),Z){const{x1:z,y1:Re,x2:Ae,y2:oe,x3:D,y3:me,x4:Ce,y4:ze}=Z;u[F++]=z,u[F++]=Re,u[F++]=le,u[F++]=xe,d[F++]=s,u[F++]=_e,u[F++]=Ae,u[F++]=oe,u[F++]=we,u[F++]=xe,d[F++]=g,u[F++]=_e,u[F++]=Ce,u[F++]=ze,u[F++]=le,u[F++]=Te,d[F++]=M,u[F++]=_e,u[F++]=D,u[F++]=me,u[F++]=we,u[F++]=Te,d[F++]=A,u[F++]=_e}else if(G!==0||Q!==0)u[F++]=B,u[F++]=U,u[F++]=le,u[F++]=xe,d[F++]=s,u[F++]=_e,u[F++]=B+y*W,u[F++]=U+y*Q,u[F++]=we,u[F++]=xe,d[F++]=g,u[F++]=_e,u[F++]=B+x*G,u[F++]=U+x*ee,u[F++]=le,u[F++]=Te,d[F++]=M,u[F++]=_e,u[F++]=B+y*W+x*G,u[F++]=U+y*Q+x*ee,u[F++]=we,u[F++]=Te,d[F++]=A,u[F++]=_e;else{const z=B+y*W,Re=U+x*ee;u[F++]=B,u[F++]=U,u[F++]=le,u[F++]=xe,d[F++]=s,u[F++]=_e,u[F++]=z,u[F++]=U,u[F++]=we,u[F++]=xe,d[F++]=g,u[F++]=_e,u[F++]=B,u[F++]=Re,u[F++]=le,u[F++]=Te,d[F++]=M,u[F++]=_e,u[F++]=z,u[F++]=Re,u[F++]=we,u[F++]=Te,d[F++]=A,u[F++]=_e}re.length+=VI,re.numQuads++,this.curBufferIdx=F}newRenderOp(i,u,d,y,x,s,g,M,A){const k=new g2(this.glw,this.options,this.quadBufferCollection,i,u,d,x,y,s,0,g,M,A);this.curRenderOp=k,this.renderOps.push(k)}addTexture(i,u,d){const{curRenderOp:y}=this;Ye(y);const x=y.addTexture(i);if(x===4294967295){if(d)throw new Error("Unable to add texture to render op");const{shader:s,shaderProps:g,dimensions:M,clippingRect:A,alpha:k}=y;return this.newRenderOp(s,g,k,M,A,u),this.addTexture(i,u,!0)}return x}reuseRenderOp(i){var M;const{shader:u,shaderProps:d,parentHasRenderTexture:y,rtt:x,clippingRect:s}=i,g=u||this.defaultShader;return!(((M=this.curRenderOp)==null?void 0:M.shader)!==g||!uI(this.curRenderOp.clippingRect,s)||y||x||this.curRenderOp.shader!==this.defaultShader&&(!d||!this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,d)))}addRenderOp(i){this.renderOps.push(i),this.curRenderOp=null}render(i="screen"){const{glw:u,quadBuffer:d}=this,y=new Float32Array(d,0,this.curBufferIdx),x=this.quadBufferCollection.getBuffer("a_position")??null;u.arrayBufferData(x,y,u.STATIC_DRAW),this.renderOps.forEach((s,g)=>{s.draw()}),this.quadBufferUsage=this.curBufferIdx*y.BYTES_PER_ELEMENT}renderToTexture(i){for(let u=0;u<this.rttNodes.length;u++)if(this.rttNodes[u]===i)return;this.rttNodes.unshift(i)}renderRTTNodes(){const{glw:i}=this;this.stage;for(let u=0;u<this.rttNodes.length;u++){const d=this.rttNodes[u];if(!d||!d.hasRTTupdates)continue;this.activeRttNode=d,Ye(d.texture,"RTT node missing texture");const y=d.texture.ctxTexture;Ye(y instanceof Lx),this.renderToTextureActive=!0,i.bindFramebuffer(y.framebuffer),i.viewport(0,0,y.w,y.h),i.clear();for(let x=0;x<d.children.length;x++){const s=d.children[x];s&&(s.update(this.stage.deltaTime,{x:0,y:0,width:0,height:0,valid:!1}),this.stage.addQuads(s),s.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,d.hasRTTupdates=!1}i.bindFramebuffer(null),i.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(i){const u=this.rttNodes.indexOf(i);u!==-1&&this.rttNodes.splice(u,1)}getBufferInfo(){return{totalAvailable:this.stage.options.quadBufferSize,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}}class HI{constructor(){L(this,"activeAnimations",new Set)}registerAnimation(r){this.activeAnimations.add(r)}unregisterAnimation(r){this.activeAnimations.delete(r)}update(r){this.activeAnimations.forEach(i=>{i.update(r)})}}function $I(){function h(i){return i.indexOf("image/png")!==-1}function r(i,u){return new Promise(function(d,y){var x=new XMLHttpRequest;x.open("GET",i,!0),x.responseType="blob",x.onload=function(){if(x.status!==200)return y(new Error("Failed to load image: "+x.statusText));var s=x.response,g=u!==void 0?u:h(s.type);createImageBitmap(s,{premultiplyAlpha:g?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}).then(function(M){d({data:M,premultiplyAlpha:u})}).catch(function(M){y(M)})},x.onerror=function(){y(new Error("Network error occurred while trying to fetch the image."))},x.send()})}self.onmessage=i=>{var u=i.data.src,d=i.data.id,y=i.data.premultiplyAlpha;r(u,y).then(function(x){self.postMessage({id:d,src:u,data:x})}).catch(function(x){self.postMessage({id:d,src:u,error:x.message})})}}class GI{constructor(r){L(this,"imageWorkersEnabled",!0);L(this,"messageManager",{});L(this,"workers",[]);L(this,"workerIndex",0);L(this,"nextId",0);this.workers=this.createWorkers(r),this.workers.forEach(i=>{i.onmessage=this.handleMessage.bind(this)})}handleMessage(r){const{id:i,data:u,error:d}=r.data,y=this.messageManager[i];if(y){const[x,s]=y;delete this.messageManager[i],d?s(new Error(d)):x(u)}}createWorkers(r=1){const i=`(${$I.toString()})()`,u=new Blob([i.replace('"use strict";',"")],{type:"application/javascript"}),d=(self.URL?URL:webkitURL).createObjectURL(u),y=[];for(let x=0;x<r;x++)y.push(new Worker(d));return y}getNextWorker(){const r=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,r}getImage(r,i){return new Promise((u,d)=>{try{if(this.workers){const y=this.nextId++;this.messageManager[y]=[u,d];const x=this.getNextWorker();x&&x.postMessage({id:y,src:r,premultiplyAlpha:i})}}catch(y){d(y)}})}}const ja=class ja extends ms{constructor(i,u){super(i);L(this,"props");this.props=ja.resolveDefaults(u)}async getTextureData(){const{width:i,height:u}=this.props,d=i*u*4,y=new Uint8ClampedArray(d);for(let x=0;x<d;x+=4){const s=Math.floor(Math.random()*256);y[x]=s,y[x+1]=s,y[x+2]=s,y[x+3]=255}return{data:new ImageData(y,i,u)}}static makeCacheKey(i){if(i.cacheId===void 0)return!1;const u=ja.resolveDefaults(i);return`NoiseTexture,${u.width},${u.height},${u.cacheId}`}static resolveDefaults(i){return{width:i.width??128,height:i.height??128,cacheId:i.cacheId??0}}};L(ja,"z$__type__Props");let lp=ja;class WI{constructor(r){L(this,"keyCache",new Map);L(this,"inverseKeyCache",new WeakMap);L(this,"txConstructors",{});L(this,"imageWorkerManager",null);L(this,"hasCreateImageBitmap",!!self.createImageBitmap);L(this,"hasWorker",!!self.Worker);L(this,"renderer");L(this,"frameTime",0);this.hasCreateImageBitmap&&this.hasWorker&&r>0&&(this.imageWorkerManager=new GI(r)),this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.registerTextureType("ImageTexture",_f),this.registerTextureType("ColorTexture",Mf),this.registerTextureType("NoiseTexture",lp),this.registerTextureType("SubTexture",gs),this.registerTextureType("RenderTexture",Fa)}registerTextureType(r,i){this.txConstructors[r]=i}loadTexture(r,i){let u;const d=this.txConstructors[r];if(!d)throw new Error(`Texture type "${r}" is not registered`);if(!u){const y=d.makeCacheKey(i);y&&this.keyCache.has(y)?u=this.keyCache.get(y):(u=new d(this,i),y&&this.initTextureToCache(u,y))}return u}initTextureToCache(r,i){const{keyCache:u,inverseKeyCache:d}=this;u.set(i,r),d.set(r,i)}removeTextureFromCache(r){const{inverseKeyCache:i,keyCache:u}=this,d=i.get(r);d&&u.delete(d)}}function XI(h,r){var i=0,u,d;r=r||{};function y(){var x=u,s=arguments.length,g,M;e:for(;x;){if(x.args.length!==arguments.length){x=x.next;continue}for(M=0;M<s;M++)if(x.args[M]!==arguments[M]){x=x.next;continue e}return x!==u&&(x===d&&(d=x.prev),x.prev.next=x.next,x.next&&(x.next.prev=x.prev),x.next=u,x.prev=null,u.prev=x,u=x),x.val}for(g=new Array(s),M=0;M<s;M++)g[M]=arguments[M];return x={args:g,val:h.apply(null,g)},u?(u.prev=x,x.next=u):d=x,i===r.maxSize?(d=d.prev,d.next=null):i++,u=x,x.val}return y.clear=function(){u=null,d=null,i=0},y}const KI={normal:400,bold:700,bolder:900,lighter:100},Px=h=>typeof h=="number"?h:KI[h]||400;function YI(h,r,i,u,d){let y=Px(i);for(const x of h){const s=x[r];if(!s)continue;if(s.size===1)return console.warn(`TrFontManager: Only one font face found for family: '${r}' - will be used for all weights and styles`),s.values().next().value;const g=new Map;for(const A of s){const k=Px(A.descriptors.weight);if(k===y&&A.descriptors.style===u&&A.descriptors.stretch===d)return A;g.set(k,A)}const M=`TrFontManager: No exact match: '${r} Weight: ${y} Style: ${u} Stretch: ${d}'`;if(console.error(M),y===400&&g.has(500))return g.get(500);if(y===500&&g.has(400))return g.get(400);if(y<400){for(;y>0;){if(g.has(y))return g.get(y);y-=100}y=600}for(;y<1e3;){if(g.has(y))return g.get(y);y+=100}for(y=500;y>0;){if(g.has(y))return g.get(y);y-=100}}}const qI=XI(YI);class Tp{constructor(r){L(this,"textRenderers");this.textRenderers=r}addFontFace(r){for(const i in this.textRenderers){const u=this.textRenderers[i];u&&u.isFontFaceSupported(r)&&u.addFontFace(r)}}static resolveFontFace(r,i){const{fontFamily:u,fontWeight:d,fontStyle:y,fontStretch:x}=i;return qI(r,u,d,y,x)}}const QI={x:(h,r)=>{h.props.x=r},y:(h,r)=>{h.props.y=r},width:(h,r)=>{h.props.width=r},height:(h,r)=>{h.props.height=r},color:(h,r)=>{h.props.color=r},zIndex:(h,r)=>{h.props.zIndex=r},fontFamily:(h,r)=>{h.props.fontFamily=r},fontWeight:(h,r)=>{h.props.fontWeight=r},fontStyle:(h,r)=>{h.props.fontStyle=r},fontStretch:(h,r)=>{h.props.fontStretch=r},fontSize:(h,r)=>{h.props.fontSize=r},text:(h,r)=>{h.props.text=r},textAlign:(h,r)=>{h.props.textAlign=r},contain:(h,r)=>{h.props.contain=r},offsetY:(h,r)=>{h.props.offsetY=r},scrollable:(h,r)=>{h.props.scrollable=r},scrollY:(h,r)=>{h.props.scrollY=r},letterSpacing:(h,r)=>{h.props.letterSpacing=r},lineHeight:(h,r)=>{h.props.lineHeight=r},maxLines:(h,r)=>{h.props.maxLines=r},textBaseline:(h,r)=>{h.props.textBaseline=r},verticalAlign:(h,r)=>{h.props.verticalAlign=r},overflowSuffix:(h,r)=>{h.props.overflowSuffix=r},debug:(h,r)=>{h.props.debug=r}};class T2{constructor(r){L(this,"stage");L(this,"set");this.stage=r;const i={...QI,...this.getPropertySetters()};this.set=Object.freeze(Object.fromEntries(Object.entries(i).map(([u,d])=>[u,(y,x)=>{y.props[u]!==x&&(d(y,x),this.stage.requestRender())}])))}setStatus(r,i,u){r.status!==i&&(r.status=i,r.emitter.emit(i,u))}setIsRenderable(r,i){r.isRenderable=i}destroyState(r){this.setStatus(r,"destroyed"),r.emitter.removeAllListeners()}scheduleUpdateState(r){r.updateScheduled||(r.updateScheduled=!0,queueMicrotask(()=>{r.status!=="destroyed"&&(r.updateScheduled=!1,this.updateState(r))}))}}class C2 extends Ao{constructor(i){super();L(this,"fontFamily");L(this,"descriptors");L(this,"loaded",!1);L(this,"metrics",null);const{fontFamily:u,descriptors:d,metrics:y}=i;y&&(this.metrics={ascender:y.ascender/y.unitsPerEm,descender:y.descender/y.unitsPerEm,lineGap:y.lineGap/y.unitsPerEm}),this.fontFamily=u,this.descriptors={style:"normal",weight:"normal",stretch:"normal",...d}}static convertToCssFontFaceDescriptors(i){return{style:i.style,weight:typeof i.weight=="number"?`${i.weight}`:i.weight,stretch:i.stretch,unicodeRange:i.unicodeRange,featureSettings:i.featureSettings,display:i.display}}}const ZI={LINE_FEED:10,CARRIAGE_RETURN:13,SPACE:32,TAB:9,ZERO_WIDTH_SPACE:8203,ZERO_WIDTH_NON_JOINER:8204,ZERO_WIDTH_JOINER:8205,LEFT_TO_RIGHT_MARK:8206,RIGHT_TO_LEFT_MARK:8207,LEFT_TO_RIGHT_EMBEDDING:8234,RIGHT_TO_LEFT_EMBEDDING:8235,POP_DIRECTIONAL_FORMATTING:8236,LEFT_TO_RIGHT_OVERRIDE:8237,RIGHT_TO_LEFT_OVERRIDE:8238,LINE_SEPARATOR:8232,PARAGRAPH_SEPARATOR:8233,OBJECT_REPLACEMENT_CHARACTER:65532,REPLACEMENT_CHARACTER:65533,ZERO_WIDTH_NO_BREAK_SPACE:65279,LEFT_TO_RIGHT_ISOLATE:8294,RIGHT_TO_LEFT_ISOLATE:8295,FIRST_STRONG_ISOLATE:8296,POP_DIRECTIONAL_ISOLATE:8297,INHIBIT_SYMMETRIC_SWAPPING:8298,ACTIVATE_SYMMETRIC_SWAPPING:8299,INHIBIT_ARABIC_FORM_SHAPING:8300,ACTIVATE_ARABIC_FORM_SHAPING:8301,NATIONAL_DIGIT_SHAPES:8302,NOMINAL_DIGIT_SHAPES:8303,LEFT_TO_RIGHT_BOUNDARY:8206,RIGHT_TO_LEFT_BOUNDARY:8207};class JI{}class e3 extends JI{constructor(i,u){super();L(this,"data");L(this,"glyphMap");L(this,"kernings");this.data=i,this.glyphMap=u;const d=this.kernings={};i.kernings.forEach(y=>{const x=y.second,s=d[x]=d[x]||{};s[y.first]=y.amount}),this.kernings=d}*shapeText(i,u){var x;let d,y;for(;(d=u.peek())&&!d.done;){const s=d.value,g=this.glyphMap.get(s);if(u.next(),g!==void 0){const M=y!==void 0?(((x=this.kernings[g.id])==null?void 0:x[y])||0)+i.letterSpacing:0;y=g.id,yield{mapped:!0,glyphId:g.id,codepoint:s,cluster:u.lastIndex,xAdvance:g.xadvance+M,yAdvance:0,xOffset:g.xoffset+M,yOffset:g.yoffset,xBearing:0,yBearing:0,width:g.width,height:g.height}}else s===ZI.LINE_FEED&&(y=void 0),yield{mapped:!1,codepoint:s,cluster:u.lastIndex}}}}class up extends C2{constructor(i,u){super(u);L(this,"type");L(this,"texture");L(this,"maxCharHeight",0);L(this,"data");L(this,"shaper");L(this,"glyphMap",new Map);const{atlasUrl:d,atlasDataUrl:y,stage:x}=u;this.type=i;const s=x.renderer;Ye(s instanceof Sp,"SDF Font Faces can only be used with the WebGL Renderer"),this.texture=x.txManager.loadTexture("ImageTexture",{src:d,premultiplyAlpha:!1}),this.texture.on("loaded",()=>{this.checkLoaded(),x.requestRender()}),this.texture.ctxTexture.load(),fetch(y).then(async g=>{var A;this.data=await g.json(),Ye(this.data);let M=0;if(this.data.chars.forEach(k=>{this.glyphMap.set(k.id,k);const b=k.yoffset+k.height;b>M&&(M=b)}),this.maxCharHeight=M,this.shaper=new e3(this.data,this.glyphMap),!this.metrics)if((A=this.data)!=null&&A.lightningMetrics){const{ascender:k,descender:b,lineGap:P,unitsPerEm:w}=this.data.lightningMetrics;this.metrics={ascender:k/w,descender:b/w,lineGap:P/w}}else throw new Error(`Font metrics not found in ${this.type} font ${this.fontFamily}. Make sure you are using the latest version of the Lightning 3 \`msdf-generator\` tool to generate your SDF fonts.`);this.checkLoaded()}).catch(console.error)}getAtlasEntry(i){const u=this.glyphMap.get(i);if(u===void 0)throw new Error(`Glyph ${i} not found in font ${this.fontFamily}`);return{x:u.x,y:u.y,width:u.width,height:u.height}}checkLoaded(){this.loaded||this.texture.state==="loaded"&&this.data&&(this.loaded=!0,this.emit("loaded"))}}const t3=24;function n3(h,r,i,u,d,y,x,s,g){const M=Math.min(Math.max(x.firstLineIdx,0),s.length),A=0,{metrics:k}=i;Ye(k,"Font metrics not loaded"),Ye(i.data,"Font data not loaded");const b=(k.ascender-k.descender)*h;let P=0;u==="middle"?P=(r-b)/2:u==="bottom"&&(P=r-b);const w=d/y,R=i.data.common.base,U=k.ascender*h-R,W=w+U+M*r+P;if(!(g&&W>=g/y))return{sdfX:A,sdfY:W,lineIndex:M}}class Pa{constructor(r,i=0){L(this,"iterator");L(this,"peekBuffer",[]);L(this,"_lastIndex");this.iterator=r,this.iterator=r,this._lastIndex=i-1,this.peekBuffer=[]}next(){const r=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return r.done?this._lastIndex=-1:this._lastIndex++,r}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const r=this.iterator.next();return this.peekBuffer.push(r),r}get lastIndex(){return this._lastIndex}}function*Da(h,r=0){let i=r;for(;i<h.length;){const u=h.codePointAt(i);if(u===void 0)throw new Error("Invalid Unicode code point");yield u,i+=u<=65535?1:2}}function i3(h,r,i){const u=i.shapeText(r,new Pa(Da(h,0),0));let d=0;for(const y of u)y.mapped&&(d+=y.xAdvance);return d}function o3(h,r,i,u,d,y,x,s,g,M,A,k,b,P,w,R,B,U,W){Ye(w,"Font face must be loaded"),Ye(w.loaded,"Font face must be loaded"),Ye(w.data,"Font face must be loaded"),Ye(w.shaper,"Font face must be loaded");const G=s/w.data.info.size,Q=g/G,ee=y/G,Z=M/G,H=b[h],J=(H==null?void 0:H.codepointIndex)||0,fe=(H==null?void 0:H.maxX)||0,E=(H==null?void 0:H.maxY)||0;let F=fe,re=E,ye=r,ie=i,se=0;const ne={codepointIndex:-1,bufferOffset:-1,xStart:-1},le=w.shaper,xe={letterSpacing:Z};let we=le.shapeText(xe,new Pa(Da(u,J),J)),Te,Ie=-1;const Ee=[],_e=x/G,z=i3(U,xe,le);let Re=!0;for(;Re;){const Ae=(W===0||h+1<W)&&(k!=="both"||B||ie+Q+w.maxCharHeight<=_e),oe=Ae?ee:ee-z;let D=0;const me=ie+w.maxCharHeight>=P.y1,Ce=ie<=P.y2,ze=me&&Ce;for(;(Te=we.next())&&!Te.done;){const ae=Te.value;if(h===b.length)b.push({codepointIndex:ae.cluster,maxY:re,maxX:F});else if(h>b.length)throw new Error("Unexpected lineCache length");if(ae.codepoint===32||ae.codepoint===10?ne.codepointIndex!==-1&&(ne.codepointIndex=-1,D=ye):ne.codepointIndex===-1&&(ne.codepointIndex=ae.cluster,ne.bufferOffset=se,ne.xStart=D),ae.mapped){const Be=ye+ae.xOffset+ae.width;if(k!=="none"&&Be>=oe&&ne.codepointIndex!==-1&&ne.xStart>0)if(Ae){we=le.shapeText(xe,new Pa(Da(u,ne.codepointIndex),ne.codepointIndex)),se=ne.bufferOffset;break}else we=le.shapeText(xe,new Pa(Da(U,0),0)),ye=ne.xStart,se=ne.bufferOffset,k="none";else{const Y=ye+ae.xOffset,$=ie+ae.yOffset;if(ze){Ie===-1&&(Ie=se);const be=w.getAtlasEntry(ae.glyphId),De=be.x/w.data.common.scaleW,Le=be.y/w.data.common.scaleH,it=be.width/w.data.common.scaleW,zn=be.height/w.data.common.scaleH;A[se++]=Y,A[se++]=$,A[se++]=De,A[se++]=Le,A[se++]=Y+ae.width,A[se++]=$,A[se++]=De+it,A[se++]=Le,A[se++]=Y,A[se++]=$+ae.height,A[se++]=De,A[se++]=Le+zn,A[se++]=Y+ae.width,A[se++]=$+ae.height,A[se++]=De+it,A[se++]=Le+zn}re=Math.max(re,$+ae.height),F=Math.max(F,Y+ae.width),ye+=ae.xAdvance}}else if(ae.codepoint===10){if(Ae)break;we=le.shapeText(xe,new Pa(Da(U,0),0)),k="none"}}Ie!==-1&&(Ee.push({bufferStart:Ie,bufferEnd:se}),Ie=-1),ye=0,ie+=Q,h++,ne.codepointIndex=-1,D=0,!R&&k==="both"&&ie>P.y2||Te&&Te.done?Re=!1:Ae||(Re=!1)}if(d==="center"){const Ae=k==="none"?F:ee;for(let oe=0;oe<Ee.length;oe++){const D=Ee[oe],me=A[D.bufferEnd-4]-A[D.bufferStart],Ce=(Ae-me)/2;for(let ze=D.bufferStart;ze<D.bufferEnd;ze+=4)A[ze]+=Ce}}else if(d==="right"){const Ae=k==="none"?F:ee;for(let oe=0;oe<Ee.length;oe++){const D=Ee[oe],me=D.bufferEnd===D.bufferStart?0:A[D.bufferEnd-4]-A[D.bufferStart],Ce=Ae-me;for(let ze=D.bufferStart;ze<D.bufferEnd;ze+=4)A[ze]+=Ce}}return Ye(Te),{bufferNumFloats:se,bufferNumQuads:se/16,layoutNumCharacters:Te.done?u.length-J:Te.value.cluster-J+1,fullyProcessed:!!Te.done,maxX:F,maxY:re,numLines:b.length}}function r3(h,r){return Math.ceil(h/r)*r}function s3(h,r){return Math.floor(h/r)*r}function a3(h,r,i,u,d,y,x,s){const{screen:g,sdf:M}=h;if(!fI(x))g.x1=0,g.y1=0,g.x2=0,g.y2=0,M.x1=0,M.y1=0,M.x2=0,M.y2=0,h.numLines=0,h.firstLineIdx=0;else{const A=x.x1-r,k=A+(x.x2-x.x1),b=x.y1-i+u,P=s3(b-y,d||1),w=r3(b+(x.y2-x.y1)+y,d||1);g.x1=A,g.y1=P,g.x2=k,g.y2=w,M.x1=A/s,M.y1=P/s,M.x2=k/s,M.y2=w/s,h.numLines=Math.ceil((w-P)/d),h.firstLineIdx=d?Math.floor(P/d):0}h.valid=!0}function E2(h,r){return r*(h.ascender-h.descender+h.lineGap)}const l3={x:0,y:0,width:0,height:0};class u3 extends T2{constructor(i){super(i);L(this,"ssdfFontFamilies",{});L(this,"msdfFontFamilies",{});L(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]);L(this,"sdfShader");L(this,"rendererBounds");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(i,u)=>{i.props.fontFamily=u,this.releaseFontFace(i),this.invalidateLayoutCache(i)},fontWeight:(i,u)=>{i.props.fontWeight=u,this.releaseFontFace(i),this.invalidateLayoutCache(i)},fontStyle:(i,u)=>{i.props.fontStyle=u,this.releaseFontFace(i),this.invalidateLayoutCache(i)},fontStretch:(i,u)=>{i.props.fontStretch=u,this.releaseFontFace(i),this.invalidateLayoutCache(i)},fontSize:(i,u)=>{i.props.fontSize=u,this.invalidateLayoutCache(i)},text:(i,u)=>{i.props.text=u,this.invalidateLayoutCache(i)},textAlign:(i,u)=>{i.props.textAlign=u,this.invalidateLayoutCache(i)},color:(i,u)=>{i.props.color=u},x:(i,u)=>{i.props.x=u,i.elementBounds.valid&&(this.setElementBoundsX(i),!i.renderWindow.valid&&zd(i.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(i))},y:(i,u)=>{i.props.y=u,i.elementBounds.valid&&(this.setElementBoundsY(i),!i.renderWindow.valid&&zd(i.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(i))},contain:(i,u)=>{i.props.contain=u,this.invalidateLayoutCache(i)},width:(i,u)=>{i.props.width=u,i.props.contain!=="none"&&this.invalidateLayoutCache(i)},height:(i,u)=>{i.props.height=u,i.props.contain==="both"&&this.invalidateLayoutCache(i)},offsetY:(i,u)=>{i.props.offsetY=u,this.invalidateLayoutCache(i)},scrollable:(i,u)=>{i.props.scrollable=u,this.invalidateLayoutCache(i)},scrollY:(i,u)=>{i.props.scrollY=u,this.scheduleUpdateState(i)},letterSpacing:(i,u)=>{i.props.letterSpacing=u,this.invalidateLayoutCache(i)},lineHeight:(i,u)=>{i.props.lineHeight=u,i.resLineHeight=void 0,this.invalidateLayoutCache(i)},maxLines:(i,u)=>{i.props.maxLines=u,this.invalidateLayoutCache(i)},textBaseline:(i,u)=>{i.props.textBaseline=u,this.invalidateLayoutCache(i)},verticalAlign:(i,u)=>{i.props.verticalAlign=u,this.invalidateLayoutCache(i)},overflowSuffix:(i,u)=>{i.props.overflowSuffix=u,this.invalidateLayoutCache(i)},debug:(i,u)=>{i.props.debug=u}}}canRenderFont(i){const{fontFamily:u}=i;return u in this.ssdfFontFamilies||u in this.msdfFontFamilies||u==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(i){return i instanceof up}addFontFace(i){Ye(i instanceof up);const u=i.fontFamily,d=i.type==="ssdf"?this.ssdfFontFamilies:i.type==="msdf"?this.msdfFontFamilies:void 0;if(!d){console.warn(`Invalid font face type: ${i.type}`);return}let y=d[u];y||(y=new Set,d[u]=y),y.add(i)}createState(i){return{props:i,status:"initialState",updateScheduled:!1,emitter:new Ao,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(i){let{trFontFace:u}=i;const{textH:d,lineCache:y,debugData:x,forceFullLayoutCalc:s}=i;if(x.updateCount++,i.status==="initialState"&&this.setStatus(i,"loading"),!u){if(u=this.resolveFontFace(i.props),i.trFontFace=u,!u){const le=`SdfTextRenderer: Could not resolve font face for family: '${i.props.fontFamily}'`;console.error(le),this.setStatus(i,"failed",new Error(le));return}u.texture.setRenderableOwner(i,!0)}if(!u.loaded){u.once("loaded",()=>{this.scheduleUpdateState(i)});return}Ye(u.data,"Font face data should be loaded"),Ye(u.metrics,"Font face metrics should be loaded");const{text:g,fontSize:M,x:A,y:k,contain:b,width:P,height:w,verticalAlign:R,scrollable:B,overflowSuffix:U,maxLines:W}=i.props,G=b==="both"&&B?i.props.scrollY:0,{renderWindow:Q}=i,ee=u.data.info.size,Z=M/ee;let H=i.resLineHeight;if(H===void 0){const le=i.props.lineHeight;le===void 0?H=E2(u.metrics,M):H=le,i.resLineHeight=H}const J=H/Z;i.distanceRange=Z*u.data.distanceField.distanceRange;const fe=g.length*t3;let E=i.vertexBuffer;(!E||E.length<fe)&&(E=new Float32Array(fe*2));const F=i.elementBounds;if(F.valid||(this.setElementBoundsX(i),this.setElementBoundsY(i),F.valid=!0),!s&&Q.valid){const le=Q.screen;if(A+le.x1<=F.x1&&A+le.x2>=F.x2&&k-G+le.y1<=F.y1&&k-G+le.y2>=F.y2){this.setStatus(i,"loaded");return}Q.valid=!1,this.setStatus(i,"loading")}const{offsetY:re,textAlign:ye}=i.props;if(!Q.valid){if(!zd(F,this.rendererBounds))return;a3(Q,A,k,G,H,b==="both"?F.y2-F.y1:0,F,Z)}const ie=n3(ee,J,u,R,re,Z,Q,y,d);if(!ie){this.setStatus(i,"loaded");return}const{letterSpacing:se}=i.props,ne=o3(ie.lineIndex,ie.sdfX,ie.sdfY,g,ye,P,w,M,H,se,E,b,y,Q.sdf,u,s,B,U,W);i.bufferUploaded=!1,i.bufferNumFloats=ne.bufferNumFloats,i.bufferNumQuads=ne.bufferNumQuads,i.vertexBuffer=E,i.renderWindow=Q,x.lastLayoutNumCharacters=ne.layoutNumCharacters,x.bufferSize=E.byteLength,ne.fullyProcessed&&(i.textW=ne.maxX*Z,i.textH=ne.numLines*J*Z),this.setStatus(i,"loaded")}renderQuads(i,u,d,y,x,s){var F,re;if(!i.vertexBuffer)return;const g=this.stage.renderer;Ye(g instanceof Sp);const{fontSize:M,color:A,contain:k,scrollable:b,zIndex:P,debug:w}=i.props,R=k==="both"&&b?i.props.scrollY:0,{textW:B=0,textH:U=0,distanceRange:W,vertexBuffer:G,bufferUploaded:Q,trFontFace:ee,elementBounds:Z}=i;let{webGlBuffers:H}=i;if(!H){const ye=g.glw,ie=4*Float32Array.BYTES_PER_ELEMENT,se=ye.createBuffer();Ye(se),i.webGlBuffers=new S2([{buffer:se,attributes:{a_position:{name:"a_position",size:2,type:ye.FLOAT,normalized:!1,stride:ie,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:ye.FLOAT,normalized:!1,stride:ie,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),i.bufferUploaded=!1,Ye(i.webGlBuffers),H=i.webGlBuffers}if(!Q){const ye=g.glw,ie=(H==null?void 0:H.getBuffer("a_textureCoordinate"))??null;ye.arrayBufferData(ie,G,ye.STATIC_DRAW),i.bufferUploaded=!0}if(Ye(ee),b&&k==="both"){Ye(Z.valid);const ye=lI(Z,l3);d.valid?(i.clippingRect.valid=!0,d=l2(d,ye,i.clippingRect)):(i.clippingRect.valid=!0,d=u2(ye,i.clippingRect))}const J=new g2(g.glw,g.options,H,this.sdfShader,{transform:u.getFloatArr(),color:tI(A,y),size:M/(((F=ee.data)==null?void 0:F.info.size)||0),scrollY:R,distanceRange:W,debug:w.sdfShaderDebug},y,d,{height:U,width:B},0,P,!1,x,s),fe=(re=i.trFontFace)==null?void 0:re.texture;Ye(fe);const E=fe.ctxTexture;J.addTexture(E),J.length=i.bufferNumFloats,J.numQuads=i.bufferNumQuads,g.addRenderOp(J)}setIsRenderable(i,u){var d;super.setIsRenderable(i,u),(d=i.trFontFace)==null||d.texture.setRenderableOwner(i,u)}destroyState(i){var u;super.destroyState(i),(u=i.trFontFace)==null||u.texture.setRenderableOwner(i,!1)}resolveFontFace(i){return Tp.resolveFontFace(this.fontFamilyArray,i)}releaseFontFace(i){i.resLineHeight=void 0,i.trFontFace&&(i.trFontFace.texture.setRenderableOwner(i,!1),i.trFontFace=void 0)}invalidateLayoutCache(i){i.renderWindow.valid=!1,i.elementBounds.valid=!1,i.textH=void 0,i.textW=void 0,i.lineCache=[],this.setStatus(i,"loading"),this.scheduleUpdateState(i)}setElementBoundsX(i){const{x:u,contain:d,width:y}=i.props,{elementBounds:x}=i;x.x1=u,x.x2=d!=="none"?u+y:1/0}setElementBoundsY(i){const{y:u,contain:d,height:y}=i.props,{elementBounds:x}=i;x.y1=u,x.y2=d==="both"?u+y:1/0}}class Tf extends C2{constructor(i){super(i);L(this,"fontFace");L(this,"fontUrl");const{fontFamily:u,fontUrl:d}=i,y=d.replace(/\(|\)/g,""),x=this.descriptors,s={style:x.style,weight:typeof x.weight=="number"?`${x.weight}`:x.weight,stretch:x.stretch,unicodeRange:x.unicodeRange,featureSettings:x.featureSettings,display:x.display},g=new FontFace(u,`url(${y})`,s);g.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error),this.fontFace=g,this.fontUrl=d}}function f3(h,r,i){if(r.metrics)return r.metrics;const u=h.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz");console.warn(`Font metrics not provided for Canvas Web font ${r.fontFamily}. Using fallback values. It is HIGHLY recommended you use the latest version of the Lightning 3 \`msdf-generator\` tool to extract the default metrics for the font and provide them in the Canvas Web font definition.`);let d;return u.actualBoundingBoxDescent&&u.actualBoundingBoxAscent?d={ascender:u.actualBoundingBoxAscent/i,descender:-u.actualBoundingBoxDescent/i,lineGap:.2}:d={ascender:.8,descender:-.2,lineGap:.2},r.metrics=d,d}const Dx=2048;function Nx(h,r,i,u,d){const y=h!=="bottom"?.5*r:0;return i*(u-1)+y+Math.max(i,r)+(d||0)}class c3{constructor(r,i){L(this,"_canvas");L(this,"_context");L(this,"_settings");this._canvas=r,this._context=i,this._settings=this.mergeDefaults({})}set settings(r){this._settings=this.mergeDefaults(r)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const r=[this._settings.fontFamily],i=[];for(let u=0,d=r.length;u<d;u++)r[u]==="serif"||r[u]==="sans-serif"?i.push(r[u]):i.push(`"${r[u]}"`);return`${this._settings.fontStyle} ${this._settings.fontSize*this.getPrecision()}px ${i.join(",")}`}_load(){if(document.fonts){const r=this._getFontSetting();try{if(!document.fonts.check(r,this._settings.text))return document.fonts.load(r,this._settings.text).catch(i=>{console.warn("[Lightning] Font load error",i,r)}).then(()=>{document.fonts.check(r,this._settings.text)||console.warn("[Lightning] Font not found",r)})}catch{console.warn("[Lightning] Can't check font loading for "+r)}}}calculateRenderInfo(){const r={},i=this.getPrecision(),u=this._settings.paddingLeft*i,d=this._settings.paddingRight*i,y=this._settings.fontSize*i;let x=this._settings.offsetY===null?null:this._settings.offsetY*i;const s=this._settings.w*i,g=this._settings.h*i;let M=this._settings.wordWrapWidth*i;const A=this._settings.cutSx*i,k=this._settings.cutEx*i,b=this._settings.cutSy*i,P=this._settings.cutEy*i,w=(this._settings.letterSpacing||0)*i,R=this._settings.textIndent*i,B=this._settings.trFontFace;this.setFontProperties(),Ye(B);const U=f3(this._context,B,y),W=E2(U,y)*i,G=this._settings.lineHeight!==null?this._settings.lineHeight*i:W,Q=this._settings.maxHeight,ee=Q!==null&&G>0?Math.floor(Q/G):0,Z=this._settings.maxLines,H=ee>0&&Z>0?Math.min(ee,Z):Math.max(ee,Z);let J=s||2048/this.getPrecision(),fe=J-u;if(fe<10&&(J+=10-fe,fe=10),M||(M=fe),this._settings.textOverflow&&!this._settings.wordWrap){let se;switch(this._settings.textOverflow){case"clip":se="";break;case"ellipsis":se=this._settings.overflowSuffix;break;default:se=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,M-R,se)}let E;if(this._settings.wordWrap)E=this.wrapText(this._settings.text,M,w,R);else{E={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const se=E.l.length;for(let ne=0;ne<se-1;ne++)E.n.push(ne)}let F=E.l;if(H&&F.length>H){const se=F.slice(0,H);let ne=null;if(this._settings.overflowSuffix){const Ie=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,Ee=this.wrapText(se[se.length-1],M-Ie,w,R);se[se.length-1]=`${Ee.l[0]}${this._settings.overflowSuffix}`,ne=[Ee.l.length>1?Ee.l[1]:""]}else ne=[""];let le;const xe=F.length;let we=0;const Te=E.n.length;for(le=H;le<xe;le++)ne[we]+=`${ne[we]?" ":""}${F[le]}`,le+1<Te&&E.n[le+1]&&we++;r.remainingText=ne.join(`
`),r.moreTextLines=!0,F=se}else r.moreTextLines=!1,r.remainingText="";let re=0;const ye=[];for(let se=0;se<F.length;se++){const ne=this.measureText(F[se],w)+(se===0?R:0);ye.push(ne),re=Math.max(re,ne)}r.lineWidths=ye,s||(J=re+u+d,fe=re);let ie;return g?ie=g:ie=Nx(this._settings.textBaseline,y,G,F.length,x),x===null&&(x=y),r.w=J,r.h=ie,r.lines=F,r.precision=i,J||(J=1),ie||(ie=1),(A||k)&&(J=Math.min(J,k-A)),(b||P)&&(ie=Math.min(ie,P-b)),r.width=J,r.innerWidth=fe,r.height=ie,r.fontSize=y,r.cutSx=A,r.cutSy=b,r.cutEx=k,r.cutEy=P,r.lineHeight=G,r.defLineHeight=W,r.lineWidths=ye,r.offsetY=x,r.paddingLeft=u,r.paddingRight=d,r.letterSpacing=w,r.textIndent=R,r.metrics=U,r}draw(r,i){const u=this.getPrecision(),d=(i==null?void 0:i.lines)||r.lines,y=(i==null?void 0:i.lineWidths)||r.lineWidths,x=i?Nx(this._settings.textBaseline,r.fontSize,r.lineHeight,i.lines.length,this._settings.offsetY===null?null:this._settings.offsetY*u):r.height;this._canvas.width=Math.min(Math.ceil(r.width+this._settings.textRenderIssueMargin),Dx),this._canvas.height=Math.min(Math.ceil(x),Dx),this.setFontProperties(),r.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(r.cutSx||r.cutSy)&&this._context.translate(-r.cutSx,-r.cutSy);let s,g;const M=[],{metrics:A}=r,k=A?A.ascender*r.fontSize:r.fontSize,b=(A.ascender-A.descender)*r.fontSize;for(let w=0,R=d.length;w<R;w++)s=w===0?r.textIndent:0,g=w*r.lineHeight+k,this._settings.verticalAlign=="middle"?g+=(r.lineHeight-b)/2:this._settings.verticalAlign=="bottom"&&(g+=r.lineHeight-b),this._settings.textAlign==="right"?s+=r.innerWidth-y[w]:this._settings.textAlign==="center"&&(s+=(r.innerWidth-y[w])/2),s+=r.paddingLeft,M.push({text:d[w],x:s,y:g,w:y[w]});if(this._settings.highlight){const w=this._settings.highlightColor,R=this._settings.highlightHeight*u||r.fontSize*1.5,B=this._settings.highlightOffset*u,U=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*u:r.paddingLeft,W=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*u:r.paddingRight;this._context.fillStyle=Fd(w);for(let G=0;G<M.length;G++){const Q=M[G];this._context.fillRect(Q.x-U,Q.y-r.offsetY+B,Q.w+W+U,R)}}let P=null;this._settings.shadow&&(P=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=Fd(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*u,this._context.shadowOffsetY=this._settings.shadowOffsetY*u,this._context.shadowBlur=this._settings.shadowBlur*u),this._context.fillStyle=Fd(this._settings.textColor);for(let w=0,R=M.length;w<R;w++){const B=M[w];if(r.letterSpacing===0)this._context.fillText(B.text,B.x,B.y);else{const U=B.text.split("");let W=B.x;for(let G=0,Q=U.length;G<Q;G++)this._context.fillText(U[G],W,B.y),W+=this.measureText(U[G],r.letterSpacing)}}P&&(this._context.shadowColor=P[0],this._context.shadowOffsetX=P[1],this._context.shadowOffsetY=P[2],this._context.shadowBlur=P[3]),(r.cutSx||r.cutSy)&&this._context.translate(r.cutSx,r.cutSy)}wrapWord(r,i,u){const d=this._context.measureText(u).width,y=r.length,x=this._context.measureText(r).width;if(x<=i)return r;let s=Math.floor(i*y/x),g=this._context.measureText(r.substring(0,s)).width+d;if(g>i)for(;s>0&&(g=this._context.measureText(r.substring(0,s)).width+d,g>i);)s-=1;else for(;s<y;)if(g=this._context.measureText(r.substring(0,s)).width+d,g<i)s+=1;else{s-=1;break}return r.substring(0,s)+(i>=d?u:"")}wrapText(r,i,u,d=0){const y=r.split(/\r?\n/g);let x=[];const s=[];for(let g=0;g<y.length;g++){const M=[];let A="",k=i-d;const b=y[g].split(" ");for(let P=0;P<b.length;P++){const w=this.measureText(b[P],u),R=w+this.measureText(" ",u);P===0||R>k?(P>0&&(M.push(A),A=""),A+=b[P],k=i-w-(P===0?d:0)):(k-=R,A+=` ${b[P]}`)}M.push(A),A="",x=x.concat(M),g<y.length-1&&s.push(x.length)}return{l:x,n:s}}measureText(r,i=0){return i?r.split("").reduce((u,d)=>u+this._context.measureText(d).width+i,0):this._context.measureText(r).width}mergeDefaults(r){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFamily:null,trFontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxHeight:null,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...r}}}const Ox=typeof self>"u"?globalThis:self;var t2;const Ux=((t2=Ox.document)==null?void 0:t2.fonts)||Ox.fonts;function h3(h){const{fontFamily:r,fontStyle:i,fontWeight:u,fontStretch:d,fontSize:y}=h;return[i,u,d,`${y}px`,r].join(" ")}class Bx extends T2{constructor(i){super(i);L(this,"canvas");L(this,"context");L(this,"fontFamilies",{});L(this,"fontFamilyArray",[this.fontFamilies]);L(this,"loadFont",i=>{const u=h3(i.props),d=Tp.resolveFontFace(this.fontFamilyArray,i.props);if(Ye(d,`Could not resolve font face for ${u}`),i.fontInfo={fontFace:d,cssString:u,loaded:!1},!i.fontInfo.loaded){Ux.load(u).then(this.onFontLoaded.bind(this,i,u)).catch(this.onFontLoadError.bind(this,i,u));return}});typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let u=this.canvas.getContext("2d",{willReadFrequently:!0});u||(this.canvas=document.createElement("canvas"),u=this.canvas.getContext("2d",{willReadFrequently:!0})),Ye(u),this.context=u,this.addFontFace(new Tf({fontFamily:"sans-serif",descriptors:{},fontUrl:""}))}getPropertySetters(){return{fontFamily:(i,u)=>{i.props.fontFamily=u,i.fontInfo=void 0,this.invalidateLayoutCache(i)},fontWeight:(i,u)=>{i.props.fontWeight=u,i.fontInfo=void 0,this.invalidateLayoutCache(i)},fontStyle:(i,u)=>{i.props.fontStyle=u,i.fontInfo=void 0,this.invalidateLayoutCache(i)},fontStretch:(i,u)=>{i.props.fontStretch=u,i.fontInfo=void 0,this.invalidateLayoutCache(i)},fontSize:(i,u)=>{i.props.fontSize=u,i.fontInfo=void 0,this.invalidateLayoutCache(i)},text:(i,u)=>{i.props.text=u,this.invalidateLayoutCache(i)},textAlign:(i,u)=>{i.props.textAlign=u,this.invalidateLayoutCache(i)},color:(i,u)=>{i.props.color=u,this.invalidateLayoutCache(i)},x:(i,u)=>{i.props.x=u},y:(i,u)=>{i.props.y=u},contain:(i,u)=>{i.props.contain=u,this.invalidateLayoutCache(i)},width:(i,u)=>{i.props.width=u,i.props.contain!=="none"&&this.invalidateLayoutCache(i)},height:(i,u)=>{i.props.height=u,i.props.contain==="both"&&this.invalidateLayoutCache(i)},offsetY:(i,u)=>{i.props.offsetY=u,this.invalidateLayoutCache(i)},scrollY:(i,u)=>{i.props.scrollY=u},letterSpacing:(i,u)=>{i.props.letterSpacing=u,this.invalidateLayoutCache(i)},lineHeight:(i,u)=>{i.props.lineHeight=u,this.invalidateLayoutCache(i)},maxLines:(i,u)=>{i.props.maxLines=u,this.invalidateLayoutCache(i)},textBaseline:(i,u)=>{i.props.textBaseline=u,this.invalidateLayoutCache(i)},verticalAlign:(i,u)=>{i.props.verticalAlign=u,this.invalidateLayoutCache(i)},overflowSuffix:(i,u)=>{i.props.overflowSuffix=u,this.invalidateLayoutCache(i)}}}canRenderFont(i){return!0}isFontFaceSupported(i){return i instanceof Tf}addFontFace(i){Ye(i instanceof Tf),i.fontFamily!=="sans-serif"&&Ux.add(i.fontFace);const{fontFamilies:u}=this,d=i.fontFace.family;let y=u[d];y||(y=new Set,u[d]=y),y.add(i)}createState(i,u){return{node:u,props:i,status:"initialState",updateScheduled:!1,emitter:new Ao,textureNode:void 0,lightning2TextRenderer:new c3(this.canvas,this.context),renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(i){if(i.status==="initialState"&&this.setStatus(i,"loading"),i.status!=="loaded"){if(!i.fontInfo)return this.loadFont(i);i.fontInfo.loaded&&(i.renderInfo||(i.renderInfo=this.calculateRenderInfo(i),i.textH=i.renderInfo.lineHeight*i.renderInfo.lines.length,i.textW=i.renderInfo.width,this.renderSingleCanvasPage(i)))}}renderSingleCanvasPage(i){Ye(i.renderInfo);const u=i.node,d=this.stage.txManager.loadTexture("ImageTexture",{src:(function(y,x){return Ye(x),y.draw(x,{lines:x.lines,lineWidths:x.lineWidths}),this.canvas.width===0||this.canvas.height===0?null:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)}).bind(this,i.lightning2TextRenderer,i.renderInfo)});if(i.textureNode)i.textureNode.texture=d;else{const y=this.stage.createNode({parent:u,texture:d,autosize:!0,alpha:aI(i.props.color)});i.textureNode=y}this.setStatus(i,"loaded")}calculateRenderInfo(i){var u;return i.lightning2TextRenderer.settings={text:i.props.text,textAlign:i.props.textAlign,fontFamily:i.props.fontFamily,trFontFace:(u=i.fontInfo)==null?void 0:u.fontFace,fontSize:i.props.fontSize,fontStyle:[i.props.fontStretch,i.props.fontStyle,i.props.fontWeight].join(" "),textColor:Va(i.props.color),offsetY:i.props.offsetY,wordWrap:i.props.contain!=="none",wordWrapWidth:i.props.contain==="none"?void 0:i.props.width,letterSpacing:i.props.letterSpacing,lineHeight:i.props.lineHeight??null,maxLines:i.props.maxLines,maxHeight:i.props.contain==="both"?i.props.height-i.props.offsetY:null,textBaseline:i.props.textBaseline,verticalAlign:i.props.verticalAlign,overflowSuffix:i.props.overflowSuffix,w:i.props.contain!=="none"?i.props.width:void 0},i.renderInfo=i.lightning2TextRenderer.calculateRenderInfo(),i.renderInfo}renderQuads(){}destroyState(i){i.status!=="destroyed"&&(super.destroyState(i),i.textureNode&&(i.textureNode.destroy(),delete i.textureNode),delete i.renderInfo)}invalidateLayoutCache(i){i.renderInfo=void 0,this.setStatus(i,"loading"),this.scheduleUpdateState(i)}onFontLoaded(i,u){var d;u!==((d=i.fontInfo)==null?void 0:d.cssString)||!i.fontInfo||(i.fontInfo.loaded=!0,this.scheduleUpdateState(i))}onFontLoadError(i,u,d){var y;u!==((y=i.fontInfo)==null?void 0:y.cssString)||!i.fontInfo||(i.fontInfo.loaded=!0,console.error(`CanvasTextRenderer: Error loading font '${i.fontInfo.cssString}'`,d),this.scheduleUpdateState(i))}}class d3{constructor(){L(this,"data",{})}reset(){this.data={}}increment(r){this.data[r]||(this.data[r]=0),this.data[r]++}getData(){return{...this.data}}}class p3{constructor(r,i){L(this,"stage");L(this,"memUsed",0);L(this,"loadedTextures",new Map);L(this,"criticalThreshold");L(this,"targetThreshold");L(this,"cleanupInterval");L(this,"debugLogging");L(this,"lastCleanupTime",0);L(this,"criticalCleanupRequested",!1);L(this,"frameTime",0);this.stage=r;const{criticalThreshold:u}=i;this.criticalThreshold=Math.round(u);const d=Math.max(0,Math.min(1,i.targetThresholdLevel));if(this.targetThreshold=Math.round(u*d),this.cleanupInterval=i.cleanupInterval,this.debugLogging=i.debugLogging,i.debugLogging){let y=0;setInterval(()=>{y!==this.memUsed&&(y=this.memUsed,console.log(`[TextureMemoryManager] Memory used: ${Mx(this.memUsed)} mb / ${Mx(this.criticalThreshold)} mb (${(this.memUsed/this.criticalThreshold*100).toFixed(1)}%)`))},1e3)}u===0&&(this.setTextureMemUse=()=>{})}setTextureMemUse(r,i){if(this.loadedTextures.has(r)&&(this.memUsed-=this.loadedTextures.get(r)),i===0){this.loadedTextures.delete(r);return}else this.memUsed+=i,this.loadedTextures.set(r,i);this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}cleanup(){const r=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,this.criticalCleanupRequested=!1,r&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.debugLogging&&console.log(`[TextureMemoryManager] Cleaning up textures. Critical: ${r}`);const i=[...this.loadedTextures.keys()].sort((y,x)=>{const s=y.renderable,g=x.renderable;return s===g?y.lastRenderableChangeTime-x.lastRenderableChangeTime:s?1:g?-1:0}),u=this.targetThreshold,d=this.stage.txManager;for(const y of i)if(y.renderable||(y.ctxTexture.free(),d.removeTextureFromCache(y),this.memUsed<=u))break;this.memUsed>=this.criticalThreshold&&(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),console.warn(`[TextureMemoryManager] Memory usage above critical threshold after cleanup: ${this.memUsed}`))}getMemoryInfo(){let r=0;const i=[...this.loadedTextures.keys()].reduce((u,d)=>(r+=d.renderable?1:0,u+(d.renderable?this.loadedTextures.get(d):0)),0);return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:i,memUsed:this.memUsed,renderableTexturesLoaded:r,loadedTextures:this.loadedTextures.size}}}const g3={isWhite:!0,a:1,r:255,g:255,b:255};function $d(h){if(h===4294967295)return g3;const r=(h>>>24&255)/255,i=h>>>16&255&255,u=h>>>8&255&255,d=h&255&255;return{isWhite:!1,a:r,r:d,g:u,b:i}}function Cf({a:h,r,g:i,b:u}){return`rgba(${r},${i},${u},${h})`}class m3 extends h2{constructor(){super(...arguments);L(this,"image");L(this,"tintCache")}load(){this.textureSource.state==="freed"&&(this.textureSource.setState("loading"),this.onLoadRequest().then(i=>{this.textureSource.setState("loaded",i),this.updateMemSize()}).catch(i=>{this.textureSource.setState("failed",i)}))}free(){this.image=void 0,this.tintCache=void 0,this.textureSource.setState("freed"),this.setTextureMemUse(0)}updateMemSize(){const i=this.tintCache?8:4;if(this.textureSource.dimensions){const{width:u,height:d}=this.textureSource.dimensions;this.setTextureMemUse(u*d*i)}}hasImage(){return this.image!==void 0}getImage(i){var x;const u=this.image;if(Ye(u,"Attempt to get unloaded image texture"),i.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),u;const d=Cf(i);if(((x=this.tintCache)==null?void 0:x.key)===d)return this.tintCache.image;const y=this.tintTexture(u,d);return this.tintCache={key:d,image:y},this.updateMemSize(),y}tintTexture(i,u){const{width:d,height:y}=i,x=document.createElement("canvas");x.width=d,x.height=y;const s=x.getContext("2d");return s&&(s.fillStyle=u,s.globalCompositeOperation="copy",s.fillRect(0,0,d,y),s.globalCompositeOperation="multiply",s.drawImage(i,0,0,d,y,0,0,d,y),s.globalCompositeOperation="destination-in",s.drawImage(i,0,0,d,y,0,0,d,y)),x}async onLoadRequest(){const{data:i}=await this.textureSource.getTextureData();if(i instanceof ImageData){const u=document.createElement("canvas");u.width=i.width,u.height=i.height;const d=u.getContext("2d");return d&&d.putImageData(i,0,0),this.image=u,{width:i.width,height:i.height}}else if(i instanceof ImageBitmap)return this.image=i,{width:i.width,height:i.height};return{width:0,height:0}}}function y3(h){var r;return h.shader instanceof wp&&h.shader.shType===w2?((r=h.shaderProps)==null?void 0:r.radius)??0:0}class v3 extends d2{constructor(i){super(i);L(this,"context");L(this,"canvas");L(this,"pixelRatio");L(this,"clearColor");L(this,"renderToTextureActive",!1);L(this,"activeRttNode",null);L(this,"defShaderCtr");this.mode="canvas",this.shManager.renderer=this;const{canvas:u,pixelRatio:d,clearColor:y}=i;this.canvas=u,this.context=u.getContext("2d"),this.pixelRatio=d,this.clearColor=y?sI(y):void 0,this.defShaderCtr={type:"DefaultShader",props:{},shader:new wp("DefaultShader"),getResolvedProps:()=>()=>({})}}reset(){this.canvas.width=this.canvas.width;const i=this.context;if(this.clearColor){const[u,d,y,x]=this.clearColor;i.fillStyle=`rgba(${u}, ${d}, ${y}, ${x/255})`,i.fillRect(0,0,this.canvas.width,this.canvas.height)}i.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(i){const u=this.context,{tx:d,ty:y,width:x,height:s,alpha:g,colorTl:M,colorTr:A,colorBr:k,ta:b,tb:P,tc:w,td:R,clippingRect:B}=i;let U=i.texture,W,G;if(U){if(U instanceof gs&&(G=U.props,U=U.parentTexture),W=U.ctxTexture,U.state==="freed"){W.load();return}if(U.state!=="loaded"||!W.hasImage())return}const Q=$d(M),ee=b!==1,Z=B.width!==0&&B.height!==0,H=M!==A||M!==k,J=i.shader?y3(i):0;if((ee||Z||J)&&u.save(),Z){const fe=new Path2D,{x:E,y:F,width:re,height:ye}=B;fe.rect(E,F,re,ye),u.clip(fe)}if(ee){const fe=this.pixelRatio;u.setTransform(b,w,P,R,d*fe,y*fe),u.scale(fe,fe),u.translate(-d,-y)}if(J){const fe=new Path2D;fe.roundRect(d,y,x,s,J),u.clip(fe)}if(W){const fe=W.getImage(Q);u.globalAlpha=g,G?u.drawImage(fe,G.x,G.y,G.width,G.height,d,y,x,s):u.drawImage(fe,d,y,x,s),u.globalAlpha=1}else if(H){let fe=d,E=y,F;M===A?(fe=d,E=y+s,F=$d(k)):(fe=d+x,E=y,F=$d(A));const re=u.createLinearGradient(d,y,fe,E);re.addColorStop(0,Cf(Q)),re.addColorStop(1,Cf(F)),u.fillStyle=re,u.fillRect(d,y,x,s)}else u.fillStyle=Cf(Q),u.fillRect(d,y,x,s);(ee||Z||J)&&u.restore()}createCtxTexture(i){return new m3(this.txMemManager,i)}getShaderManager(){return this.shManager}getDefShaderCtr(){return this.defShaderCtr}renderRTTNodes(){}removeRTTNode(i){}renderToTexture(i){}getBufferInfo(){return null}}class x3 extends np{constructor(i,u){super(i,u);L(this,"textRenderer");L(this,"trState");L(this,"_textRendererOverride",null);L(this,"onTextLoaded",()=>{const{contain:i}=this,u=this.trState.props.width,d=this.trState.props.height,y=this.trState.textW||0,x=this.trState.textH||0;i==="both"?(this.props.width=u,this.props.height=d):i==="width"?(this.props.width=u,this.props.height=x):i==="none"&&(this.props.width=y,this.props.height=x),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});L(this,"onTextFailed",(i,u)=>{this.emit("failed",{type:"text",error:u})});this._textRendererOverride=u.textRendererOverride;const{resolvedTextRenderer:d,textRendererState:y}=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:u.width,height:u.height,textAlign:u.textAlign,color:u.color,zIndex:u.zIndex,contain:u.contain,scrollable:u.scrollable,scrollY:u.scrollY,offsetY:u.offsetY,letterSpacing:u.letterSpacing,debug:u.debug,fontFamily:u.fontFamily,fontSize:u.fontSize,fontStretch:u.fontStretch,fontStyle:u.fontStyle,fontWeight:u.fontWeight,text:u.text,lineHeight:u.lineHeight,maxLines:u.maxLines,textBaseline:u.textBaseline,verticalAlign:u.verticalAlign,overflowSuffix:u.overflowSuffix});this.textRenderer=d,this.trState=y}get width(){return this.props.width}set width(i){this.props.width=i,this.textRenderer.set.width(this.trState,i),this.contain==="none"&&this.setUpdateType(Pe.Local)}get height(){return this.props.height}set height(i){this.props.height=i,this.textRenderer.set.height(this.trState,i),this.contain!=="both"&&this.setUpdateType(Pe.Local)}get color(){return this.trState.props.color}set color(i){this.textRenderer.set.color(this.trState,i)}get text(){return this.trState.props.text}set text(i){this.textRenderer.set.text(this.trState,i)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(i){this._textRendererOverride=i,this.textRenderer.destroyState(this.trState);const{resolvedTextRenderer:u,textRendererState:d}=this.resolveTextRendererAndState(this.trState.props);this.textRenderer=u,this.trState=d}get fontSize(){return this.trState.props.fontSize}set fontSize(i){this.textRenderer.set.fontSize(this.trState,i)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(i){this.textRenderer.set.fontFamily(this.trState,i)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(i){this.textRenderer.set.fontStretch(this.trState,i)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(i){this.textRenderer.set.fontStyle(this.trState,i)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(i){this.textRenderer.set.fontWeight(this.trState,i)}get textAlign(){return this.trState.props.textAlign}set textAlign(i){this.textRenderer.set.textAlign(this.trState,i)}get contain(){return this.trState.props.contain}set contain(i){this.textRenderer.set.contain(this.trState,i)}get scrollable(){return this.trState.props.scrollable}set scrollable(i){this.textRenderer.set.scrollable(this.trState,i)}get scrollY(){return this.trState.props.scrollY}set scrollY(i){this.textRenderer.set.scrollY(this.trState,i)}get offsetY(){return this.trState.props.offsetY}set offsetY(i){this.textRenderer.set.offsetY(this.trState,i)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(i){this.textRenderer.set.letterSpacing(this.trState,i)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(i){this.textRenderer.set.lineHeight&&this.textRenderer.set.lineHeight(this.trState,i)}get maxLines(){return this.trState.props.maxLines}set maxLines(i){this.textRenderer.set.maxLines&&this.textRenderer.set.maxLines(this.trState,i)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(i){this.textRenderer.set.textBaseline&&this.textRenderer.set.textBaseline(this.trState,i)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(i){this.textRenderer.set.verticalAlign&&this.textRenderer.set.verticalAlign(this.trState,i)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(i){this.textRenderer.set.overflowSuffix&&this.textRenderer.set.overflowSuffix(this.trState,i)}get debug(){return this.trState.props.debug}set debug(i){this.textRenderer.set.debug(this.trState,i)}update(i,u){super.update(i,u),Ye(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkRenderProps(){return this.trState.props.text!==""?!0:super.checkRenderProps()}onChangeIsRenderable(i){super.onChangeIsRenderable(i),this.textRenderer.setIsRenderable(this.trState,i)}renderQuads(i){var u;if(Ye(this.globalTransform),!this.textRenderer.renderQuads){super.renderQuads(i);return}this.parentHasRenderTexture&&(!i.renderToTextureActive||this.parentRenderTexture!==i.activeRttNode)||(this.parentHasRenderTexture&&((u=this.props.parent)!=null&&u.rtt)&&(this.globalTransform=kn.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),Ye(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions))}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}resolveTextRendererAndState(i){const u=this.stage.resolveTextRenderer(i,this._textRendererOverride),d=u.createState(i,this);return d.emitter.on("loaded",this.onTextLoaded),d.emitter.on("failed",this.onTextFailed),u.scheduleUpdateState(d),{resolvedTextRenderer:u,textRendererState:d}}}function w3(h){const r={boolean:!0,string:!0,number:!0,undefined:!0},i=Object.keys(h);for(let u=0;u<i.length;u++){const d=i[u];if(!d)continue;const y=h[d],x=typeof y;x==="string"&&y.length>2048&&(console.warn(`Custom Data value for ${d} is too long, it will be truncated to 2048 characters`),h[d]=y.substring(0,2048)),r[x]||(console.warn(`Custom Data value for ${d} is not a boolean, string, or number, it will be ignored`),delete h[d])}return h}const S3=2e6;class T3{constructor(r){L(this,"options");L(this,"animationManager");L(this,"txManager");L(this,"txMemManager");L(this,"fontManager");L(this,"textRenderers");L(this,"shManager");L(this,"renderer");L(this,"root");L(this,"boundsMargin");L(this,"defShaderCtr");L(this,"eventBus");L(this,"deltaTime",0);L(this,"lastFrameTime",0);L(this,"currentFrameTime",0);L(this,"fpsNumFrames",0);L(this,"fpsElapsedTime",0);L(this,"renderRequested",!1);L(this,"frameEventQueue",[]);L(this,"contextSpy",null);this.options=r;const{canvas:i,clearColor:u,appWidth:d,appHeight:y,boundsMargin:x,enableContextSpy:s,numImageWorkers:g,textureMemory:M,renderMode:A}=r;this.eventBus=r.eventBus,this.txManager=new WI(g),this.txMemManager=new p3(this,M),this.shManager=new DI,this.animationManager=new HI,this.contextSpy=s?new d3:null;let k=[0,0,0,0];x&&(k=Array.isArray(x)?x:[x,x,x,x]),this.boundsMargin=k;const b={stage:this,canvas:i,pixelRatio:r.devicePhysicalPixelRatio*r.deviceLogicalPixelRatio,clearColor:u??4278190080,bufferMemory:S3,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy};A==="canvas"?this.renderer=new v3(b):this.renderer=new Sp(b),this.defShaderCtr=this.renderer.getDefShaderCtr(),nI(A),this.txManager.renderer=this.renderer,this.textRenderers=A==="webgl"?{canvas:new Bx(this),sdf:new u3(this)}:{canvas:new Bx(this)},this.fontManager=new Tp(this.textRenderers);const P=new np(this,{x:0,y:0,width:d,height:y,alpha:1,autosize:!1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1});this.root=P,xI(this)}updateFrameTime(){const r=wI();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=r,this.deltaTime=this.lastFrameTime?r-this.lastFrameTime:100/6,this.txManager.frameTime=r,this.txMemManager.frameTime=r,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}updateAnimations(){const{animationManager:r}=this;this.root&&r.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested}drawFrame(){const{renderer:r,renderRequested:i}=this;Ye(r),this.root.updateType!==0&&this.root.update(this.deltaTime,this.root.clippingRect),r.reset(),this.txMemManager.criticalCleanupRequested&&this.txMemManager.cleanup(),r.rttNodes.length>0&&r.renderRTTNodes(),this.addQuads(this.root),r==null||r.render(),this.calculateFps(),i&&(this.renderRequested=!1)}queueFrameEvent(r,i){this.frameEventQueue.push([r,i])}flushFrameEvents(){for(const[r,i]of this.frameEventQueue)this.eventBus.emit(r,i);this.frameEventQueue=[]}calculateFps(){var i,u;const{fpsUpdateInterval:r}=this.options;if(r&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=r)){const d=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:d,contextSpyData:((i=this.contextSpy)==null?void 0:i.getData())??null}),(u=this.contextSpy)==null||u.reset()}}addQuads(r){Ye(this.renderer&&r.globalTransform),r.isRenderable&&r.renderQuads(this.renderer);for(let i=0;i<r.children.length;i++){const u=r.children[i];u&&(u==null?void 0:u.worldAlpha)!==0&&this.addQuads(u)}}requestRender(){this.renderRequested=!0}resolveTextRenderer(r,i=null){let u=i,d=!1;if(u){const x=this.textRenderers[u];x?x.canRenderFont(r)||(console.warn(`Cannot use override text renderer '${u}' for font`,r),u=null,d=!0):(console.warn(`Text renderer override '${u}' not found.`),u=null,d=!0)}if(!u){for(const[x,s]of Object.entries(this.textRenderers))if(x!=="canvas"&&s.canRenderFont(r)){u=x;break}u||(u="canvas")}d&&console.warn(`Falling back to text renderer ${String(u)}`);const y=this.textRenderers[u];return Ye(y,"resolvedTextRenderer undefined"),y}createShaderCtr(r,i){return this.shManager.loadShader(r,i)}createNode(r){const i=this.resolveNodeDefaults(r);return new np(this,i)}createTextNode(r){const i=r.fontSize??16,u={...this.resolveNodeDefaults(r),text:r.text??"",textRendererOverride:r.textRendererOverride??null,fontSize:i,fontFamily:r.fontFamily??"sans-serif",fontStyle:r.fontStyle??"normal",fontWeight:r.fontWeight??"normal",fontStretch:r.fontStretch??"normal",textAlign:r.textAlign??"left",contain:r.contain??"none",scrollable:r.scrollable??!1,scrollY:r.scrollY??0,offsetY:r.offsetY??0,letterSpacing:r.letterSpacing??0,lineHeight:r.lineHeight,maxLines:r.maxLines??0,textBaseline:r.textBaseline??"alphabetic",verticalAlign:r.verticalAlign??"middle",overflowSuffix:r.overflowSuffix??"...",debug:r.debug??{},shaderProps:null};return new x3(this,u)}resolveNodeDefaults(r){const i=r.color??4294967295,u=r.colorTl??r.colorTop??r.colorLeft??i,d=r.colorTr??r.colorTop??r.colorRight??i,y=r.colorBl??r.colorBottom??r.colorLeft??i,x=r.colorBr??r.colorBottom??r.colorRight??i,s=w3(r.data??{});return{x:r.x??0,y:r.y??0,width:r.width??0,height:r.height??0,alpha:r.alpha??1,autosize:r.autosize??!1,clipping:r.clipping??!1,color:i,colorTop:r.colorTop??i,colorBottom:r.colorBottom??i,colorLeft:r.colorLeft??i,colorRight:r.colorRight??i,colorBl:y,colorBr:x,colorTl:u,colorTr:d,zIndex:r.zIndex??0,zIndexLocked:r.zIndexLocked??0,parent:r.parent??null,texture:r.texture??null,textureOptions:r.textureOptions??{},shader:r.shader??this.defShaderCtr,src:r.src??null,scale:r.scale??null,scaleX:r.scaleX??r.scale??1,scaleY:r.scaleY??r.scale??1,mount:r.mount??0,mountX:r.mountX??r.mount??0,mountY:r.mountY??r.mount??0,pivot:r.pivot??.5,pivotX:r.pivotX??r.pivot??.5,pivotY:r.pivotY??r.pivot??.5,rotation:r.rotation??0,rtt:r.rtt??!1,data:s}}}class C3 extends Ao{constructor(i,u){var R,B,U,W;super();L(this,"root");L(this,"canvas");L(this,"settings");L(this,"stage");L(this,"inspector",null);const d={criticalThreshold:((R=i.textureMemory)==null?void 0:R.criticalThreshold)||124e6,targetThresholdLevel:((B=i.textureMemory)==null?void 0:B.targetThresholdLevel)||.5,cleanupInterval:((U=i.textureMemory)==null?void 0:U.cleanupInterval)||3e4,debugLogging:((W=i.textureMemory)==null?void 0:W.debugLogging)||!1},y={appWidth:i.appWidth||1920,appHeight:i.appHeight||1080,textureMemory:d,boundsMargin:i.boundsMargin||0,deviceLogicalPixelRatio:i.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:i.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:i.clearColor??0,fpsUpdateInterval:i.fpsUpdateInterval||0,numImageWorkers:i.numImageWorkers!==void 0?i.numImageWorkers:2,enableContextSpy:i.enableContextSpy??!1,enableInspector:i.enableInspector??!1,renderMode:i.renderMode??"webgl",quadBufferSize:i.quadBufferSize??4*1024*1024};this.settings=y;const{appWidth:x,appHeight:s,deviceLogicalPixelRatio:g,devicePhysicalPixelRatio:M,enableInspector:A}=y,k=x*g,b=s*g,P=document.createElement("canvas");this.canvas=P,P.width=k*M,P.height=b*M,P.style.width=`${k}px`,P.style.height=`${b}px`,this.stage=new T3({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,fpsUpdateInterval:this.settings.fpsUpdateInterval,numImageWorkers:this.settings.numImageWorkers,renderMode:this.settings.renderMode,textureMemory:d,eventBus:this,quadBufferSize:this.settings.quadBufferSize}),this.root=this.stage.root;let w;if(typeof u=="string"?w=document.getElementById(u):w=u,!w)throw new Error("Could not find target element");w.appendChild(P),A&&!vp()&&(this.inspector=new vI(P,y))}createNode(i){Ye(this.stage,"Stage is not initialized");const u=this.stage.createNode(i);return this.inspector?this.inspector.createNode(u):u}createTextNode(i){const u=this.stage.createTextNode(i);return this.inspector?this.inspector.createTextNode(u):u}destroyNode(i){return this.inspector&&this.inspector.destroyNode(i.id),i.destroy()}createTexture(i,u){return this.stage.txManager.loadTexture(i,u)}createShader(i,u){return this.stage.shManager.loadShader(i,u)}createDynamicShader(i){return this.stage.shManager.loadDynamicShader({effects:i})}createEffect(i,u,d){return{name:d,type:i,props:u}}getNodeById(i){var y;const u=(y=this.stage)==null?void 0:y.root;if(!u)return null;const d=x=>{if(x.id===i)return x;for(const s of x.children){const g=d(s);if(g)return g}return null};return d(u)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){throw new Error("Not implemented")}}const A2=50,jx={hd:.66666667,"720p":.66666667,720:.66666667,fhd:1,fullhd:1,"1080p":1,1080:1,"4k":2,"2160p":2,2160:2},E3=()=>{const h=ki.stage;Mi.get("fonts",[]).forEach(r=>{r.type==="sdf"||r.type==="msdf"?(!r.png&&r.file&&(r.png=r.file.replace(/\.[^.]+$/,`.${r.type}.png`)),!r.json&&r.file&&(r.json=r.file.replace(/\.[^.]+$/,`.${r.type}.json`)),h.fontManager.addFontFace(new up(r.type,{fontFamily:r.family,descriptors:{},atlasUrl:r.png,atlasDataUrl:r.json,stage:h,metrics:r.metrics}))):r.type==="web"&&h.fontManager.addFontFace(new Tf({fontFamily:r.family,fontUrl:r.file,descriptors:{},metrics:r.metrics}))})},A3=()=>{const h=ki.stage;Mi.get("shaders",[]).forEach(r=>{h.shManager.registerShaderType(r.name,r.type)}),Mi.get("effects",[]).forEach(r=>{h.shManager.registerShaderType(r.name,r.type)})};let ki={};const b3=(h,r,i={})=>{"fontLoader"in i&&Nt.warn("\n\nStarting version 0.9.0 of Blits, the Launch setting `fontLoader` is not supported / required anymore.\nYou can remove the option from your `src/index.js`-file. And you can safely remove the file `src/fontLoader.js` from your project.\n      "),ki=new C3({appWidth:i.w||1920,appHeight:i.h||1080,fpsUpdateInterval:i.fpsInterval||1e3,deviceLogicalPixelRatio:i.pixelRatio||jx[i.screenResolution]||jx[window.innerHeight]||1,numImageWorkers:"webWorkersLimit"in i?i.webWorkersLimit:window.navigator.hardwareConcurrency||2,clearColor:i.canvasColor&&hs.normalize(i.canvasColor)||0,enableInspector:i.inspector||!1,boundsMargin:i.viewportMargin||0,txMemByteThreshold:"gpuMemoryLimit"in i?i.gpuMemoryLimit*1024*1024:200*1024*1024,renderMode:"renderMode"in i?i.renderMode:"webgl"},r);const u=()=>{let d=h();d.quit=()=>{Nt.info("Closing App"),d.destroy(),d=null,ki=null}};return A3(),E3(),u(),ki},Fx=h=>h!==null&&typeof h=="object"&&"transition"in h,uf=h=>typeof h=="string"&&h.startsWith("{")&&h.endsWith("}"),ff=h=>JSON.parse(h.replace(/'/g,'"').replace(/([\w-_]+)\s*:/g,'"$1":')),ts=function(h,r){return typeof h!="string"?h:h.indexOf("%")===h.length-1?this.element.parent&&this.element.parent[r]&&this.element.parent[r]*(parseFloat(h)/100):h},fp=h=>{if(h===null||typeof h=="string")return h;if(typeof h=="number")return h;if(typeof h=="object"&&h.constructor===Object){if("value"in h)return h.value;if("transition"in h)return fp(h.transition)}return h},I3={top:"colorTop",bottom:"colorBottom",left:"colorLeft",right:"colorRight"};let cp;const k3={set parent(h){this.props.parent=h==="root"?ki.root:h.node},set rotation(h){this.props.rotation=h*(Math.PI/180)},set w(h){this.props.width=ts.call(this,h,"width")},set width(h){this.props.width=ts.call(this,h,"width")},set h(h){this.props.height=ts.call(this,h,"height")},set height(h){this.props.height=ts.call(this,h,"height")},set x(h){this.props.x=ts.call(this,h,"width")},set y(h){this.props.y=ts.call(this,h,"height")},set z(h){this.props.zIndex=h},set zIndex(h){this.props.zIndex=h},set color(h){typeof h=="string"&&h.indexOf("{")===-1?this.props.color=hs.normalize(h):(typeof h=="object"||uf(h)&&(h=ff(h)))&&(this.props.color=0,Object.entries(h).forEach(r=>{this.props[I3[r[0]]]=hs.normalize(r[1])}))},set src(h){this.props.src=h,this.raw.get("color")===void 0&&(this.props.color=4294967295)},set texture(h){this.props.texture=h,this.raw.get("color")===void 0&&h==null?this.props.color=0:this.raw.get("color")===void 0&&(this.props.color=4294967295)},set rtt(h){this.props.rtt=h,h===!0&&this.raw.get("color")===void 0&&(this.props.color=4294967295)},set mount(h){typeof h=="object"||uf(h)&&(h=ff(h))?("x"in h&&(this.props.mountX=h.x),"y"in h&&(this.props.mountY=h.y)):(this.props.mountX=h,this.props.mountY=h)},set pivot(h){typeof h=="object"||uf(h)&&(h=ff(h))?("x"in h&&(this.props.pivotX=h.x),"y"in h&&(this.props.pivotY=h.y)):(this.props.pivotX=h,this.props.pivotY=h)},set scale(h){typeof h=="object"||uf(h)&&(h=ff(h))?("x"in h&&(this.props.scaleX=h.x),"y"in h&&(this.props.scaleY=h.y)):this.props.scale=h},set show(h){this.props.alpha=h?1:0},set alpha(h){this.props.alpha=h},set shader(h){h!==null?this.props.shader=ki.createShader(h.type,h.props):this.props.shader=ki.createShader("DefaultShader")},set effects(h){this.props.shader=ki.createShader("DynamicShader",{effects:h.map(r=>(r.props&&r.props.color&&(r.props.color=hs.normalize(r.props.color)),r))})},set clipping(h){this.props.clipping=h},set overflow(h){this.props.clipping=!h},set font(h){this.props.fontFamily=h},set size(h){this.props.fontSize=h},set wordwrap(h){this.props.width=h,this.props.contain="width"},set maxheight(h){this.props.height=h,this.props.contain="both"},set contain(h){this.props.contain=h},set maxlines(h){this.props.maxLines=h},set textoverflow(h){this.props.overflowSuffix=h===!1?" ":h===!0?void 0:h},set letterspacing(h){this.props.letterSpacing=h||1},set lineheight(h){this.props.lineHeight=h},set align(h){this.props.textAlign=h},set content(h){this.props.text=""+h}},M3={populate(h){const r={...this.config,...h};r[ue.isSlot]&&(this[ue.isSlot]=!0),this.props.element=this;const i=Object.keys(r),u=i.length;this.props.parent=r.parent,delete r.parent,this.props.raw=new Map(Object.entries(r));for(let d=0;d<u;d++){const y=i[d],x=r[y];x!==void 0&&(this.props[y]=fp(x))}this.props.props.color===void 0&&!("__textnode"in r)&&(this.props.props.color=0),this.node=r.__textnode?ki.createTextNode({...cp,...this.props.props}):ki.createNode(this.props.props),r["@loaded"]&&this.node.on("loaded",(d,{type:y,dimensions:x})=>{r["@loaded"]({w:x.width,h:x.height,type:y},this)}),r["@error"]&&this.node.on("failed",(d,y)=>{r["@error"](y,this)}),this.component&&this.component.___layout&&this.node.on("loaded",()=>{this.component.___layout()})},set(h,r){if(r===void 0||this.props.raw.get(h)===r)return;this.props.raw.set(h,r),this.props.props={},this.props[h]=fp(r);const i=Object.entries(this.props.props);if(i.length===1){const[u,d]=i[0];if(Fx(r))return this.animate(u,d,r.transition);this.node[u]=d}else for(let u=0;u<i.length;u++){const[d,y]=i[u];if(Fx(r))return this.animate(d,y,r.transition);this.node[d]=y}this.component&&this.component.___layout&&this.component.___layout()},animate(h,r,i){if(this.node[h]===r)return;this.scheduledTransitions[h]&&this.scheduledTransitions[h].f.state==="running"&&(this.node[h]=this.scheduledTransitions[h].v);const u={};u[h]=r;const d=this.node.animate(u,{duration:typeof i=="object"&&"duration"in i?i.duration:300,easing:typeof i=="object"&&"easing"in i?i.easing:"ease",delay:typeof i=="object"&&"delay"in i?i.delay:0}),y=this.node[h];this.scheduledTransitions[h]={v:u[h],cancel:!1,f:d},i.start&&typeof i.start=="function"&&d.once("animating",()=>{i.start.call(this.component,this,h,y)}),d.once("stopped",()=>{this.scheduledTransitions[h]=null,i.end&&typeof i.end=="function"&&i.end.call(this.component,this,h,this.node[h])}),d.start()},destroy(){Nt.debug("Deleting  Node",this.nodeId),this.node.destroy()},get nodeId(){return this.node&&this.node.id},get ref(){return this.props.ref||null},get parent(){return this.node&&this.node.parent},get children(){return this.component[ue.getChildren]().filter(h=>h.parent===(this[ue.isSlot]?this.node.children[0]:this.node))}},_3=(h,r)=>(cp||(cp={fontSize:32,fontFamily:Mi.get("defaultFont","sans-serif")}),Object.assign(Object.create(M3),{props:Object.assign(Object.create(k3),{props:{}}),scheduledTransitions:{},config:h,component:r})),zx={Element:_3,Launch:b3};let za={};const Rf={},R3=(h,r,i)=>{Mi.set(i),Ub(),Rf.element=zx.Element,za=zx.Launch(h,r,i)},L3={before:{prop:"alpha",value:0},in:{prop:"alpha",value:1,duration:200},out:{prop:"alpha",value:0,duration:100}},To=window.speechSynthesis,P3=()=>(window.navigator||{}).userAgent||"",Vx=()=>/android/i.test(P3());let b2=!1,Lf=null;const Cp=()=>Lf&&clearTimeout(Lf),hp=h=>{if(!h||Lf)return Cp();To.pause(),To.resume(),Lf=setTimeout(()=>{hp(h)},5e3)},us={lang:"en-US",pitch:1,rate:1,voice:null,volume:1},D3=()=>{us.voice=To.getVoices()[0],b2=!0},N3=(h,r)=>{const i=new SpeechSynthesisUtterance(r.value);i.lang=r.lang||us.lang,i.pitch=r.pitch||us.pitch,i.rate=r.rate||us.rate,i.voice=r.voice||us.voice,i.volume=r.volume||us.volume,i.onstart=()=>{Vx()||hp(i),h.onstart()},i.onresume=()=>{Vx()||hp(i),h.onresume()},i.onpause=()=>{h.onpause()},i.onend=()=>{h.onend()},i.onerror=()=>{Cp(),h.onerror()},To.speak(i)},Ef={speak(h){b2||D3(),this.cancel(),N3(this,h)},resume(){To.resume()},pause(){To.pause()},cancel(){To.cancel(),Cp()},getVoices(){return To.getVoices()},onend(){},onerror(){},onstart(){},onresume(){},onpause(){}};let Hx;const Ep=(h,r="off")=>{clearTimeout(Hx),Ef.cancel(),r==="assertive"?Ef.speak({value:h}):Hx=setTimeout(()=>{Ef.speak({value:h})},400)},O3=h=>Ep(h,"polite"),U3=h=>Ep(h,"assertive"),B3=()=>{Ef.cancel()},I2={speak:Ep,polite:O3,assertive:U3,stop:B3};let Pf,Df=!1;const k2=new WeakMap,M2=[];let _2={},R2={},dp=!1,L2;const j3=()=>(document.location.hash||"/").replace(/^#/,""),$x=h=>h.replace(/^\/+|\/+$/g,"").toLowerCase(),F3=h=>typeof h=="object"&&h!==null,z3=h=>typeof h=="string",V3=(h,r=[])=>{const i=h;h=$x(h);let u=!1,d=0;for(;!u&&d<r.length;){const y=r[d];if(y.path=$x(y.path),y.path===h)y.params={},u=y;else if(y.path.indexOf(":")>-1){const x=[...y.path.matchAll(/:([^\s/]+)/gi)];let s=y.path;x.reverse().forEach(M=>{s=s.substring(0,M.index)+"([^\\s/]+)"+s.substring(M.index+M[0].length)});const g=i.match(new RegExp(`${s}`,"i"));g&&(y.params=x.reverse().reduce((M,A,k)=>(M[A[1]]=g[k+1],M),{}),u=y)}else if(y.path.endsWith("*")){const x=new RegExp(y.path.replace(/\/?\*/,"/?([^\\s]*)"),"i"),s=h.match(x);s&&(s[1]&&(y.params={path:s[1]}),u=y)}d++}return u&&(u.options={...u.options,..._2},u.data||(u.data={}),Pf=u),u},H3=async function(){if(Df=!0,this.parent[ue.routes]){const h=Pf,r=j3();let i=V3(r,this.parent[ue.routes]),u;if(i){if(i.hooks&&i.hooks.before&&(u=await i.hooks.before(i,h),z3(u))){Pf=h,Ff(u);return}i=F3(u)?u:i,dp===!1&&h&&h.options.inHistory===!0&&M2.push(h),"transition"in i||(i.transition=L3),typeof i.transition=="function"&&(i.transition=i.transition(h,i));let d,{view:y,focus:x}=k2.get(i)||{};if(y)d=y[ue.holder];else{d=Rf.element({parent:this[ue.children][0]}),d.populate({}),d.set("w","100%"),d.set("h","100%");const g={...this[ue.props],...i.params,...R2,...i.data};y=await i.component({props:g},d,this),y[Symbol.toStringTag]==="Module"&&(y.default&&typeof y.default=="function"?y=y.default({props:g},d,this):Nt.error("Dynamic import doesn't have a default export or default is not a function")),typeof y=="function"&&(y=y({props:g},d,this))}if(this[ue.children].push(y),L2=Co.get(),x?Co.set(x):Co.set(y),i.transition.before)if(Array.isArray(i.transition.before))for(let g=0;g<i.transition.before.length;g++)d.set(i.transition.before[g].prop,i.transition.before[g].value);else d.set(i.transition.before.prop,i.transition.before.value);let s=!1;if(h){s=!0;const g=this[ue.children].splice(1,1).pop();g&&$3(h,g,i.transition.out)}if(i.transition.in)if(Array.isArray(i.transition.in))for(let g=0;g<i.transition.in.length;g++)g===i.transition.length-1?await ps(d,i.transition.in[g],s):ps(d,i.transition.in[g],s);else await ps(d,i.transition.in,s);i.announce&&(typeof i.announce=="string"&&(i.announce={message:i.announce}),I2.speak(i.announce.message,i.announce.politeness)),this.activeView=this[ue.children][this[ue.children].length-1]}else Nt.error(`Route ${r} not found`)}dp=!1,Df=!1},$3=async(h,r,i)=>{if(i)if(Array.isArray(i))for(let u=0;u<i.length;u++)u===i.length-1?await ps(r[ue.holder],i[u]):ps(r[ue.holder],i[u]);else await ps(r[ue.holder],i);h.options&&h.options.keepAlive===!0?k2.set(h,{view:r,focus:L2}):(r.destroy(),r=null)},ps=(h,r,i=!0)=>new Promise(u=>{if(i){const d=r.end;r.end=d?(...y)=>{d(...y),u()}:u,h.set(r.prop,{transition:r})}else h.set(r.prop,r.value),u()}),Ff=(h,r={},i={})=>{R2=r,_2=i,window.location.hash=`#${h}`},P2=()=>{const h=M2.pop();if(h){dp=!0;let r=h.path;return r.indexOf(":")>-1&&Object.keys(h.params).forEach(i=>{r=r.replace(`:${i}`,h.params[i])}),Ff(r),!0}else return!1},Gd={navigate:H3,to:Ff,back:P2};let xo=null,cf=[],Gx;const Co={_hold:!1,set hold(h){this._hold=h},get hold(){return this._hold},get(){return xo},set(h,r){clearTimeout(Gx),xo&&xo!==h.parent&&xo.unfocus(),cf.reverse().forEach(i=>i.unfocus()),h!==xo&&(Gx=setTimeout(()=>{xo=h,xo.lifecycle.state="focus",r instanceof KeyboardEvent?document.dispatchEvent(new KeyboardEvent("keydown",r)):cf=[]},this.hold?Mi.get("holdTimeout",A2):0))},input(h,r){if(Df===!0)return;cf=D2([xo],h);const i=cf.shift();i&&(i[ue.inputEvents][h]?i[ue.inputEvents][h].call(i,r):i[ue.inputEvents].any&&i[ue.inputEvents].any.call(i,r))}},D2=(h,r)=>h[0][ue.inputEvents]&&(typeof h[0][ue.inputEvents][r]=="function"||typeof h[0][ue.inputEvents].any=="function")?h:h[0].parent?(h.unshift(h[0].parent),D2(h,r)):[],hf=new Map,pp={registerListener(h,r,i){let u=hf.get(r);u||(u=new Map,hf.set(r,u));let d=u.get(h);d||(d=new Set,u.set(h,d)),d.add(i)},executeListeners(h,r){const i=hf.get(h);i&&i.forEach(u=>{u.forEach(d=>{d(r)})})},removeListeners(h){hf.forEach(r=>{const i=r.get(h);i&&(i.clear(),r.delete(i))})}},G3={focus:{value:function(h){this[ue.state].hasFocus=!0,Co.set(this,h)},writable:!1,enumerable:!0,configurable:!1},unfocus:{value:function(){this[ue.state].hasFocus=!1,this.lifecycle.state="unfocus"},writable:!1,enumerable:!0,configurable:!1},destroy:{value:function(){this.lifecycle.state="destroy",this.$clearTimeouts(),this.$clearIntervals(),pp.removeListeners(this),N2(this[ue.children]),Nt.debug(`Destroyed component ${this.componentId}`)},writable:!1,enumerable:!0,configurable:!1},select:{value:function(h){let r=null;return this[ue.children].forEach(i=>{Array.isArray(i)?i.forEach(u=>{u.ref===h&&(r=u)}):Object.getPrototypeOf(i)===Object.prototype?Object.keys(i).forEach(u=>{i[u].ref===h&&(r=i[u])}):i.ref===h&&(r=i)}),r},writable:!1,enumerable:!0,configurable:!1},trigger:{value:function(h){ds(this[ue.originalState],h,!0)},writable:!1,enumerable:!0,configurable:!1},$trigger:{value:function(h){return Nt.warn("this.$trigger is deprecated, use this.trigger instead"),this.trigger(h)},writable:!1,enumerable:!0,configurable:!1},shader:{value:function(h,r){return{type:h,props:r}},writable:!1,enumerable:!0,configurable:!1}},N2=function(h){for(let r=0;r<h.length;r++){if(!h[r])return;h[r].destroy&&typeof h[r].destroy=="function"?h[r].destroy():Object.getPrototypeOf(h[r])===Object.prototype&&N2(Object.values(h[r])),h[r]=null}h.length=0},W3={$setTimeout:{value:function(h,r,...i){const u=setTimeout(()=>{this[ue.timeouts]=this[ue.timeouts].filter(d=>d!==u),h.apply(null,i)},r,i);return this[ue.timeouts].push(u),u},writable:!1,enumerable:!0,configurable:!1},$clearTimeout:{value:function(h){this[ue.timeouts].indexOf(h)>-1&&(this[ue.timeouts]=this[ue.timeouts].filter(r=>r!==h),clearTimeout(h))},writable:!1,enumerable:!0,configurable:!1},$clearTimeouts:{value:function(){for(let h=0;h<this[ue.timeouts].length;h++)clearTimeout(this[ue.timeouts][h]);this[ue.timeouts]=[]},writable:!1,enumerable:!0,configurable:!1},$setInterval:{value:function(h,r,...i){const u=setInterval(()=>h.apply(null,i),r,i);return this[ue.intervals].push(u),u},writable:!1,enumerable:!0,configurable:!1},$clearInterval:{value:function(h){this[ue.intervals].indexOf(h)>-1&&(this[ue.intervals]=this[ue.intervals].filter(r=>r!==h),clearInterval(h))},writable:!1,enumerable:!0,configurable:!1},$clearIntervals:{value:function(){for(let h=0;h<this[ue.intervals].length;h++)clearInterval(this[ue.intervals][h]);this[ue.intervals]=[]},writable:!1,enumerable:!0,configurable:!1}},X3={$emit:{value:function(h,r){pp.executeListeners(h,r)},writable:!1,enumerable:!0,configurable:!1},$listen:{value:function(h,r){pp.registerListener(this,h,r)},writable:!1,enumerable:!0,configurable:!1}},K3={$log:{value:n2("App"),writable:!1,enumerable:!0,configurable:!1}},Y3={$router:{value:{to:Ff,back:P2,get currentRoute(){return Pf},get routes(){return this[ue.routes]},get navigating(){return Df}},writable:!1,enumerable:!0,configurable:!1}},q3={$announcer:{value:I2,writable:!1,enumerable:!0,configurable:!1}},Q3={[ue.renderer]:{value:()=>za,writable:!1,enumerable:!0,configurable:!1},[ue.getChildren]:{value(){const h=this.rootParent||this.parent;return(this[ue.children]||[]).concat(h&&h[ue.getChildren]().map(r=>Object.getPrototypeOf(r)===Object.prototype?Object.values(r).map(i=>(i.forComponent=i.config&&i.config.parent.component,i)):r).flat().filter(r=>{if(r&&r.component)return r.component&&r.component.componentId===this.componentId||r.forComponent&&r.forComponent.componentId===this.componentId})||[])},writable:!1,enumerable:!0,configurable:!1}},ba=Object.defineProperties({[ue.pluginsRegistered]:!1},{...G3,...W3,...X3,...K3,...Y3,...q3,...Q3}),Z3={cast:h=>h,required:!1},J3=(h,r=[])=>{r.indexOf("ref")===-1&&r.push("ref"),h[ue.propKeys]=[],r.forEach(i=>{i={...Z3,...typeof i=="object"?i:{key:i}},h[ue.propKeys].push(i.key),Object.defineProperty(h,i.key,{get(){const u=i.cast(this[ue.props]&&i.key in this[ue.props]?this[ue.props][i.key]:"default"in i?i.default:void 0);return i.required&&u===void 0&&Nt.warn(`${i.key} is required`),u},set(u){Nt.warn(`Warning! Avoid mutating props directly (${i.key})`),this[ue.props][i.key]=u}})})},ek=(h,r)=>{h[ue.methodKeys]=[];for(let i in r)h[ue.propKeys]&&h[ue.propKeys].indexOf(i)>-1?Nt.error(`${i} already exists as a prop`):(typeof r[i]!="function"&&Nt.warn(`${i} is not a function`),h[ue.methodKeys].push(i),h[i]=r[i])},tk=(h,r=()=>{})=>{Object.defineProperty(h,ue.stateKeys,{value:[],enumerable:!1,configurable:!1,writable:!1}),Object.keys(r.apply(h)||{}).concat(["hasFocus"]).forEach(u=>{h[ue.propKeys]&&h[ue.propKeys].indexOf(u)>-1&&Nt.error(`State ${u} already exists as a prop`),h[ue.methodKeys]&&h[ue.methodKeys].indexOf(u)>-1&&Nt.error(`State ${u} already exists as a method`),h[ue.stateKeys].push(u);try{Object.defineProperty(h,u,{get(){return this[ue.state]&&u in this[ue.state]&&this[ue.state][u]},set(d){this[ue.state]&&(this[ue.state][u]=d)}})}catch(d){Nt.error(d)}})},nk=(h,r)=>{h[ue.computedKeys]=[];for(let i in r)h[ue.stateKeys]&&h[ue.stateKeys].indexOf(i)>-1?Nt.error(`${i} already exists as a state variable`):h[ue.propKeys]&&h[ue.propKeys].indexOf(i)>-1?Nt.error(`${i} already exists as a prop`):h[ue.methodKeys]&&h[ue.methodKeys].indexOf(i)>-1?Nt.error(`${i} already exists as a method`):(typeof r[i]!="function"&&Nt.warn(`${i} is not a function`),h[ue.computedKeys].push(i),Object.defineProperty(h,i,{get(){return r[i].apply(this)}}))},ik=(h,r)=>{h[ue.inputEvents]=[],Object.keys(r).forEach(i=>{typeof r[i]!="function"&&Nt.warn(`${r[i]} is not a function`),h[ue.inputEvents][i]=r[i]})},ok=(h,r)=>{h[ue.routes]=[],Object.keys(r).forEach(i=>{h[ue.routes][i]={...r[i],options:{inHistory:!0,...r[i].options}}})},rk=(h,r)=>{h[ue.watchKeys]=[],h[ue.watchers]={};for(let i in r)typeof r[i]!="function"&&console.warn(`${i} is not a function`),h[ue.watchKeys].push(i),h[ue.watchers][i]=function(u,d){r[i].call(this,u,d)}};let sk=0;function ak(h,r){return h[ue.identifier]=++sk,Yb(r.hooks,h[ue.identifier]),J3(h,r.props),r.methods&&ek(h,r.methods),tk(h,r.state),r.computed&&nk(h,r.computed),r.watch&&rk(h,r.watch),r.routes&&ok(h,r.routes),r.input&&ik(h,r.input),h}const lk=()=>tr("Circle",{code:{render:function(r,i,u,d,y,x){const s=[],g={};return s[0]=this.element({parent:r||"root"},i),g.color=i.color,g.w=i.size,g.h=i.size,g.effects=[i.shader("radius",{radius:i.radius})],s[0].populate(g),s},effects:[function(r,i,u,d,y,x){i[0].set("color",r.color)},function(r,i,u,d,y,x){i[0].set("w",r.size)},function(r,i,u,d,y,x){i[0].set("h",r.size)},function(r,i,u,d,y,x){i[0].set("effects",[r.shader("radius",{radius:r.radius})])}],context:{}},props:[{key:"size",default:40},"color"],computed:{radius(){return this.size/2}}});let Wd;const uk=()=>tr("RouterView",{code:{render:function(r,i,u,d,y,x){const s=[],g={};return s[0]=this.element({parent:r||"root"},i),g.w=r.node.width*(100/100),g.height=r.node.height*(100/100),s[0].populate(g),s},effects:[],context:{}},state(){return{activeView:null}},hooks:{ready(){Wd=()=>Gd.navigate.apply(this),Gd.navigate.apply(this),window.addEventListener("hashchange",Wd)},destroy(){window.removeEventListener("hashchange",Wd,!1)},focus(){this.activeView&&this.activeView.focus()}},input:{back(){Gd.back()}}}),fk=()=>tr("Sprite",{code:{render:function(r,i,u,d,y,x){const s=[],g={};return s[0]=this.element({parent:r||"root"},i),g.w=r.node.width*(100/100),g.h=r.node.height*(100/100),g.texture=i.texture,g.color=i.color,s[0].populate(g),s},effects:[function(r,i,u,d,y,x){i[0].set("texture",r.texture)},function(r,i,u,d,y,x){i[0].set("color",r.color)}],context:{}},props:["image","map","frame","color"],state(){return{spriteTexture:!1}},computed:{texture(){const h="frames"in this.map?Object.assign({},this.map.defaults||{},this.map.frames[this.frame]):this.map[this.frame];if(this.spriteTexture&&h)return this[ue.renderer]().createTexture("SubTexture",{texture:this.spriteTexture,x:h.x,y:h.y,width:h.w,height:h.h})}},hooks:{ready(){this.spriteTexture=this[ue.renderer]().createTexture("ImageTexture",{src:this.image})}}}),ck="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaMAAAAbCAYAAADRe+BYAAAAAXNSR0IArs4c6QAAGn9JREFUeF7tXQ1UVdWePxcWFg7ZA0sym5n0Tmk1z4+0YeVU4yo1h1jvPVBo1ETU8QvTdJlhsmKpi0he5jyXX0CKIWkpl3OlME3RGcdJixVEas+nJtq0sMwXN/kIgbxn1m+791n/ezifF0hr7lmrVV3O2Wfv/977//v//h/7uKTQFZJASAIhCYQkEJLADZaAy+j9iqIMkCRpliRJGeSeWkmSClwuV25X9VtRlOGSJI3m7wq6bd5Osqa/6OZSSZJKXC4X+h7UpSgKZABZQCbiKuHt4t+dvri8z5GG3E77rChKtCRJ9TY647ht0aaiKJAx5LCK/4Y5m23jneotiqJgvg84eCaYd6Cf4h/xqgo+ZwUO3h1wK5cx1oIYP/5eJUlSrsvl6tRakGUZbYr9tjQpKanL9lmw4w09F5LAzyUBXTDiih3KAspN76pwuVxjgu2koijYzGibbmg0tzQYoOPt5Zv0xydJ0hiXywWlYfviAAE5UBDSPu9YUep1QFEUvAdKWlyOAYPP26c2BhhM25ivXZo+4lWOxx8EGEHRw6iwdXHjQbu26LMwTlJsNUZusrEeHMuC9kGWZRgSYs/VJiUluZ32MXR/SAK/VAkYgREsdKaAKysr58fFxd0Di23Xrl1ScjKMTUl69913906cODHe6cDNFAVvcyAUHCxNO21rGIVv7969ufHx8djQGatWrZIyMq4bmj6frz4mJuYRSZJsMyQNQJS43e4/19bWThk+fPiA/Px8afhwkDpJKikpKUhJSXHEDujY9MDU7XZLtbWsq1BItvrMWQsAQxozZoxUUQEiYHrZapuzAYCcAOWSnJycv2RmZjZThiRJklMZGDIkyHfWLNgskkRkgXVh+g4N0NUuWLCgYN26dcMHDBiQjPUr5qyoqOjttLS0KVYC0syTui/q6+tX9O7duyU6OnoV2h09+rodEexakGUZG4vNnbiWL18uHT9+HCBsay84Gcv/13s9Hs/osLAwlZW7XK6KxMRES8Pa6/Ue4GuLic7v94+ZMGGC5Qb7OeXcXWMrLS3Nd7lcs+zKKtgxdwAjupnPnDlTNHDgwN9RhlRfXy9FR0dDuUsxMTGYDMuJ1GxooAO0eNWgQYNaX3jhhcfnzp2bhHuWLl0q5eayfWd7AyqKoro2uIJ5jr7vwIEDqqKIi4trqKysfJK7VUxlRl1ebW1tX99yyy3tlCFB+aBtroCklJQUS0Wp90L+Hii5ABYaJBhBtowRjBgxQqqqsiSCdsEISpJZIZcuXVp01113PaPHkKyAQmf8umCE9XXu3Dm2zgCoAFZ+YXGYMiS6HjZt2iSnp6eztYVLZ87gVrPFkCjQX758+d0+ffr8k1gP6Oenn34qDRgwgBkQbrfb8VqQZVnIGCyerYX9+/dLeXl5MERuSoYky7JiU/GoLE+r1A2eh4cEIKG7gD0ez4CwsDCsxwD2qygKmGlFUlKSobtUq7A5sLgnTJhgaPDx91EX+i8CjLpqbHSeXS7XCKN5sbkWDG/TAyNVuSckJHyzZ8+evvxpbNoSRVHgDmMmK1d4toFD0wumOGH9wgruBBip7q2YmBgGkiBCXDGiv6qCnj17tlRQUGBrc5PYgJSZmTk1JyfnAd5/LPTZBESowoTV7igeoSiKUEK1ly5dCo+Njf17vKezYERkAU0etAVHjZPm5uaiqKioxylD4uMNun0DgFbnbNq0aXveeustgB8TixVLpOuTsEPMeYqiKFgXTKkQkLM1ZxTkNPuCrf8rV678qVevXi+QfWGrXdxfXl4e3dbWxmJ933zzzbHz588/OnLkSKmpqUlKT0/Hv9U51CjGDq482hZk1aNHjxEJCQlsU3D2JYxB/MRiXTQG6Pf7TRUzna9uBCPxmg5xM1mW1bVhovxKkpKSdI0MPTAqLi6WvF6voWGt907OWtGFTu2vzipw+nx3jU0wo6+++qpu0aJF/bg+cURC7IxTD4xUK5goRNUipco9JSUFbgks9Bg7L9MBo+EbN24M7wwzIm3S4K+qCKgSIcpphB12xNumSQEqkFElDTYHVgewtmtp42ZqbX/99dfTzp07VzBq1KiIToCRaii4XOrUOhlrh2mk8nv66acr9u/fL+JatpWtk7VBmaLf778QHh5+O2cKtli4jvGB17O+0jkrKCiQYJzYnTMKcnpuQ+pqdWL0cJBQFeybb7557Nq1a4/OmTOHiS0vLw8MKYBpERYlaS1VjbsvNykpiS1MCyWOdc1csMGCUVKSSkDNprvW6/XWCncXUejqM2PHjpXE2PFjdXX10uzsbOYu0Shb39mzZ7MyMjL+BkYt5mTKlCnS4MGDWVunTp0qy8zM/IO2M3oKGyx8yZIlbNvpGTuyLMNFfd0nz69fChh18dgoE+6UXtFbJHpgpDINsulU9DfY7EF3jG7iYNx0ZFA0AQDg6KOK7erVqy2RkZGR/H4nihRgdD14cZ1xCaUGxT/A7/dfue+++27n8R1bCpMDEdoVcRgE1OH2SxaxhyCZEZMBxrpt27ZIEXPhfQdQMjeGQ3BgG7G9vb0pPj4+Cm2KuCFvJ6ikE6M+0PWgcbPZskDpnGNOYDBVVVWNURQFCheGFlMqRL625syAcdF9gTXCKD5Zx7b2hVB2iqL8MHXq1N+gjW3btjERcWWCdQdFyRiO1+udxfsjcateBSuakQcFi+fvvffeD9asWSPiu779+/e/lZeX9wRkAcUPABDX3Llz4Yo1VMx03igz6iowQvsUkI4fPy4tX76csU8Kwh6PZ/uOHTsm0/5ERUVJGzdulPBvXDNmzCjz+XwBgETBCOOMjY1l93JZdfDyeL3e4YqisKSgpqam+qioKGZ43+xg1E1jE8aurT3jRM/gXrtgpFoMBmDEXHhOX86Vst4mDtb1F9AFatVv3br18PTp0/+F32BLsdHGqDIiv1ekpqZuKy4uvq45rrs8bGV9kb75EhMTs3bv3r2OxreCBCM1wG4yFylOUpAVRWHWUEtLy9XIyMhbDdqtgoUezPxrn1EUhY0BivmOO+6Q6uvroZxtuVZFW8gqrKurK+vXrx9cCtqrdv369fnz588XSQG24jt03RNWRfeFyswJGFkaPVTZnT9//sTixYt/iw5v2LDhWN++fR8lilJti7riuLJWvRMiI6+xsVEFtldffbXsgQce+D3a2rdvn1xQUBBAY15//XUGzri6AIwMy0XQPo0ZGSl0Oj64KlNTU/FoCgdaxuBIP1WXPH7Pz88vvfPOO9n4Vq9eLR09ejRgT1Iw8nq9UmJiIhs3/ru4uBhuy4B1TMF93759344bN+4u3K/Xd85KA8oJYPwhlkXjWBp21sHVKsuyuo9RNpGYmGjL9d9dY6P9SUpKYvNL3cUYn6IoyHjNQKID2XCOyhO6CowsN52RoupCZhTwCtruTz/9VBMREYFYDNhIUG5FPTACW5gxY0ZzcXExzCu0i4VsmflG3UU8KwtZXQOqq6svDRs2jJlqQYIR3D0Zp0+fDp88eXKvqqoq9KkkIyNjFjILcTU3N7c9+eSTz1ZWVu62Ag9t7RMSItLT05EEMn7o0KGLNm/eHC+y04LNrqR9oG7L3bt3y4mJiUJpOlpfkK/f738zLCzsXu0YwWRnzpz5fWFhocgMtIxDoQ1togkHHGbUUKMH9zph+FTZbdiwofbgwYPol2/Lli0ro6Oj/8NIUVKWAGXd1NQ0AgpVWPFQnAUFBVCcPlmWsSYZI+T34j9VJU4B4mYAI3ROh3VV8PExNzF3XzKQ0jGEsc9pUhDzlHAlqmbTgVUOGTKEufbAJDB2vofVxAkB7j/88EPF+++/PxquQD0wEnEVkz0VoJg196t/o6wX4zKKfem9h4JRV47NCox4yAPrtkMpEIBq/PjxtrJsf5VgpEnv9Y0cOXLXsWPHhEA6y7ryR48ezZS7UMRz5sw5kZ+fD3eAJRBxxSYsHzAKUF6AiK+xsfHPUVFR/xwsGJEF2oEh0VRpriwt2SwFI7i8kLDiu54hwhYdssfgBsLFs8g6WJZWgKcBI9XVOnDgwK/PnDnzt1yJqC4qq/ZorVVTU9Op+Ph46ciRIw+gr5CBcIOmpqZeKi4uRualbbclBUudfqhxFx4zYrhklZYtlJ3f729IS0vrBSYAJVReXj5bJDUQdqC6/ajS4gxgqSzLeJZZHcJFB9esLMvMWqVsScTRONipacs3AxhRpUpiHj6v17tUuCcJIBkZE2r8lAKWVmE3NzerMSrOdlQmRe997733Prxy5crTemDk9XrB5JmLFvt50aJF2y9cuBDvdruTX3zxRdUVuGrVqvmVlZXrcR/YX0tLy/+Gh4dHYX7nzZt34Z133nm4ra1NgKjv+eefb7p48SL2AC5Lg6w7xob9oQEj1hmPx+MOCwtTMwyPHj0qFRYWFtXX168cMWLE6wsWLEgS7tL09PQV33777XKrvfurAyNt4eeMGTNyCgsLl3FBdEpZ8jbYIqeK+LPPPrv28MMPT7TjqqTunldeeSU9Ozt7I28XGw1WH7P8gmFGZLIZQ+LgiEVcpRO8D4hD6C0UCkaaFGvIkbXb0tJy4tZbb/1HPM8z+CwVsMG71DTv48ePVwwZMkQkSjhqj9aGpaamphYXF2MTMBZEU8YvXLjg79+//7/ZmTPa39OnT//hiy++2JmYmNgDv6N+LTo6+mVaxE3S6k37TpMNvvzyy7+89NJLg/i7mKFA2Y/W5URdWTwFvMrr9SJOOhqxjdTUVJFUBPcWq186ffp0w8svv9yLv0NlC13BjEwUTYAbyspNx2WCPcYMHsKAmK7XnFIhtbe3/xgREbHS7/eXmKVni/5pXVlgW1u2bGmJiIiI1KbSE/biS01NdT333HO/EfE16qaTZRl9ZWtsyZIlQ8+dO4d1xS64AQWA8bGoa4IaFHh3ZGTk3scff/xf8dwnn3wi5+bmCs+ArcSo7hibHTAirBJ6gTEkjFm4QPnatXSH282m040Z8Ww6W6httFi70k2nPTli/fr1GSQ2YNuNZoXg4u/Nzc0Xe/bsyVLfefaaKdtwcFyP2oUDBw6kjh07tthun0zkjEXCLJmSkhIW2Ley3Gl/CRiBAcBCZ24PnSwzR/Ed0V/aTkpKSnVJScnD/G+23GikHRbjunr1al1kZKSIGang2djY+D8a9mnJEHVk2qFAVRSEX7lyBSAXxksMTK1ZCjZW8wvLc/Xq1QEuZvG8SAEXSQ8ffPDBic2bNyP2xO4XLi+iNALm6EaBkdWYz58/v3Px4sXP8vtUQ3LatGn5Dz744CwR5yLtwNNQYBZjoQqbg4/0xhtvnOjfv/9vCQNl7lfBWuvq6vbMnz//GZrsYRDvUuPfnHGneL3eZE2yCbqrrumdO3f+V0REhIhls6EoinJh/PjxIovUtt7qrrFZMSMetxTTwEpfOBtnLJ0YFKoBpDf3pnVGBGwoGKmp38QCtKSQ3Q1G3IpH1guzqD766KOcxx57TDAi/GQrs4koNXFmHn4S7rSAYYhgOwEjU+alc/6c1X5Ehp0tMOLMR6Sf4rimgIJBg7RmS2uFxyCG8yJn9Dcgk4YyEVLbZLrotIOmcvnuu++qY2NjBRBZ9k+nLQZGFy9ebOnXr5/InqTrV5stGhR4kvMUkylLPnLkSOUTTzyBgljTNaepB7JcB7iBx3tU8KTMCjECYYFnZGQ0nD17FgyIyY+mJvM2AuawK8DIRjYdk7PNotdcj8fTtmPHjudJHEKrY5DOnYF4Dyxw4RLie7EiIiIiRdRXUeHqKewJEyaUTZo0iSV4CCtelmXIiDHKDRs27Dl48OAz8+bNa33qqaduwW96YJSVlfV2bGxsXN++ff9Bb0J55iP+pI6FJrCIZwoLCzeXl5f/O/9/256B7hqbAzBS9xItJbCI76miMj2BwSBriJ2fxY/XUV0BTt0dROl3OptOe2bY559/vm7o0KGIB4iAWjDZc1Ds4py3DmfxUQV64sSJ1sGDB7NFqpehqLMwdQ80NcimE4+bjkETz+hwRhplHiTAbkn/deq0VEWmiSn91e1238E765TNqP7911577ciyZctQWIsrmHlTa0K4q5PWhqmB7aampvbbbruN1XTZKaY1QwsKyMOGDfugpqYGadSmblC6WQmT6fAa6u7gykydMw5oLMYAqx4KuaGhoTYtLU0kZwgLX83044ohAIApWHVBzMhIVB3ASK/OyOBhoyxVcTDycIASAFHUGV2+fPnU7NmzH9S2p6eweVwNbUULBsrBCL/5ONBG5+Tk1A4aNIjJloJReXl5VVtbG4ycgFok7bsJGAUADJU/Ya943JGh1B1js+OmI8xI1Q0GYGRKWozOplM3NGdH4vQFlRWtXbv2xMKFC1kaqlPWQSeps2467blptbW1f3S73TNNLCozvRLwN8p8uMWbybOnsOigQNniW7hw4V/Xrl0rFLFpait/geoyoy/sDBihHdpfnt32Co8XqUWVyACMjY2N4m4kS+ZBs8jwzMSJE5s+/PDD2zgQqXU7mZmZp8gpFbaZEW2fH7skArZB1TLQmByy/yZNmoREiL/j71EPevV4PHXJycnCjecIPMWcaU9z52vvJf53U9lSBUSSDTqsTQAqUq9xkWC+Kl+tq+/QoUOH169fD7eP6tKjabgALQDS0aNHWRvaLDAKRvw5duaV3llsBnVGwaR2G+1JgBDWgVWSifBiZGzatCla1A5lZWVVnjx5cpxwKeMlVGETJYokD8iLHWQJGWzatIn1iRfPMta0devW6ttvv52xdgpGpaWlySKlGQkMa9asOYWkGbBnWjOlB0Z6ZxISJuHIGOuOsd0MYIQiR/gyr1ePdbzAFLAAYGk6Qm9tU10ARnaOB1Ff6yJHE1ihEmJQ165dOxQeHi6Cvh0eqaury7/nnntEpl6nEiSohR1MAgP629TUtCcqKup6JV/Hy5eQkPCfe/bsEYFRWy4Aq1O2OyMDCh55eXmVc+fOFS6uzrh+aSZVBym0trYevvvuu4fwGiZHqf4mspjtcrlgSYvEC0OAo66Z77//vm7mzJkCFHXnQwe41Pu0yoy46ALYhCZl2HDpUzAqLS1V60b0UnS7EIwsla5mnIYpz+vWrSvv168fOz6KK/UAo8ZIYXu9XtTKME8IQEowrJUrV1bU1NRgTpHNJxKBAsBIlmVWAI9n09LSahoaGoYKAdsAI5H56vvxxx979ezZM1xk1zU2Nva30lH0790xthsORhggLN+cnJz/XrZsGS0cFN8zAhBdP77bRvqqmUBvZjDicohesWLFl1OmTIlBbIBcBTt27KiZPHnyDELPg1ag/F16p184strBANDfBQsWxCB7jFxLR40aFXP48GFhuVtm09GHy8rKhp09e/bo4sWLaeFrRWVlZVlcXFxaMDKgrKgzRa566ys7O/vtuLi4ySKVm99TVV9fX967d2+kzwvQsGSHtH0NGDGr3e12R+I0d3JmnynIUzZSWlpat337drHHdOOa1OUhMudEcSZ11RHmhC53UPBZWVlTwsLCtglFC5der169cIIGTnRg8jBiRgZFnurxMCRmFAwzsgQjTYzN16NHD7deTIjGpHj8B8NS5WqgsBlg0dgIHmpvbz/57LPPskxRpOhzI4LJSZNNB8Yd3dra2jpx4kThrkebSLfH/SyQr2VGdF5ramq2f/zxx5PFUUh8nh3pk+4Y200BRnwCADqm3zVyemq3CTDRTBRbFrumLUcMyWZsR7zCSg5ssdo9fcEMnPnf6NFGjsCIzBs2iNF3mNj3nRyczye6bPVRvM7IgM5fMPOvJ1ZThiQynqgbx8bcWMnCiQKhcUk7rJqekaYFLno2oxnbo/uMjYWewECKYum6o3KkRw/9bGCEflLlDeA9dOjQsb17947E3wBWra2tq4S7rKGhgdVt8clS58RCYQfokLKysi+LiopEMgKKilfpnKsHEINMmXFOAAdZjAEfYaRg5PF4SkidTu3UqVPDGhsb783Ly/P36dMnDG1xlovCbXHQrehfLXebBtQ1dsfYuhqMPB5PBf+EB3RTQCGw3fiG9rh2xpCsCvocbGzcejODEfonzqjTfvEVckBQ2cqv7UQcnQUj2l8sYEqR2Jdv7Rbo6nRa7wvAGLuQg5NxintpxbwjxmbjZVi7mDP64UIofsigM98JosAs4hqQAVMcNi+q5O0AMFWWWkZH+9PBKOBuLgT5MW7ci7ZGI74i4iN1dXUN8+fPFwqcghFtW2UxP6ebTshz+/btf4qMjGSno5tcvqysrLMnT54ULl81A9FMYWs/FUGAmRkKRjVSvL7LyGhXi6H5kUPo9lKv1ztaABs9oikhIWHz9OnTWSYdZ7oU/E2PCeqOsXU1GPFTNMSHUANq0OyAkc19FbotJIGQBG5GCXAlK8oe6NEzOARUTcQpKir6qqysjH3ChJ/EbwqsNwKM0LGHHnoo9/77739Jm9INpt/Y2Fg+depU1P6JM9ICYtpmChttC8DR1M4wQ8GsYBcyrqqqOvDII48wb0R7ezsKaVf06NGjQJykITLlZs2aJY8bN47FbTWuQFbD5/V6dwmg4myKsWDBDFHUvGTJkphLly7hfhgHjCF119gcpHZbZtNRZrRz5876nTt3IpGGyTcERjej9gj1KSSBLpQAXFjt7e2qgtNruqGh4d20tDRxcoAdlyFthn5awK5OoezfMmak02fqljSSlpk7Wsts6fd5tNmu2uxQo76bufNVhqRx6dO2qIuX9k87H/S4Lz23cHeMjZE14voX80xlpZcBS9k87Sv1hDGDwe7C6cKtEWoqJIGQBG6EBHJzc5+vr69/Iy4ujh1lxK+S6urqquzsbLgzRZ2Mk7gXmrkRYIT3QhGKWiPqirbjhjVT2GhbgISegjUDUvQJCph+dgZuU7jb2AcUSQYyVch6BgB9D3XjqrEjyozInHbX2LoSjCAnjI/FjkLM6EZohNA7QxK4cRKAwlZrrQy64Si78MYNJfTmX5sEQszo1zajofGEJGAtAfHNHVGegSeQ2CD+sW4hdEdIAl0sgRAYdbFAQ82FJBCSQEgCIQk4l0AIjJzLLPRESAIhCYQkEJJAF0vg/wBMng85iZWBHAAAAABJRU5ErkJggg==",hk=()=>tr("FPScounter",{code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.y=15,A.x=20,s[1].populate(A),r=s[1];const k={};s[2]=this.element({parent:r||"root"},i),s[2].populate(k);const b=u.components&&u.components.Sprite||d.Sprite;r=s[2];const P={};if(s[3]=this.element({parent:r||"root"},i),P.image=i.image,P.w=43,P.h=25,P.map=i.sprite,P.frame="fps",typeof b<"u")for(let xt in b.config.props)delete P[b.config.props[xt]];s[3].populate(P),r=s[3];const w={};w.image=i.image,w.w=43,w.h=25,w.map=i.sprite,w.frame="fps",g=w.is||"Sprite";let R;if(typeof g=="string"){if(R=u.components&&u.components[g]||d[g],!R)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(R=g);s[4]=R.call(null,{props:w},s[3],i),s[4][Symbol.for("slots")][0]?(r=s[4][Symbol.for("slots")][0],i=s[4]):r=s[4][Symbol.for("children")][0],r=s[2];const B={};s[5]=this.element({parent:r||"root"},i),B.x=58,B.y=2,s[5].populate(B);const U=u.components&&u.components.Sprite||d.Sprite;r=s[5];const W={};if(s[6]=this.element({parent:r||"root"},i),W.image=i.image,W.x=0,W.h=20,W.w=20,W.map=i.sprite,W.frame=i.fps[0],typeof U<"u")for(let xt in U.config.props)delete W[U.config.props[xt]];s[6].populate(W),r=s[6];const G={};G.image=i.image,G.x=0,G.h=20,G.w=20,G.map=i.sprite,G.frame=i.fps[0],g=G.is||"Sprite";let Q;if(typeof g=="string"){if(Q=u.components&&u.components[g]||d[g],!Q)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(Q=g);s[7]=Q.call(null,{props:G},s[6],i),s[7][Symbol.for("slots")][0]?(r=s[7][Symbol.for("slots")][0],i=s[7]):r=s[7][Symbol.for("children")][0];const ee=u.components&&u.components.Sprite||d.Sprite;r=s[5];const Z={};if(s[8]=this.element({parent:r||"root"},i),Z.image=i.image,Z.x=18,Z.h=20,Z.w=20,Z.map=i.sprite,Z.frame=i.fps[1],typeof ee<"u")for(let xt in ee.config.props)delete Z[ee.config.props[xt]];s[8].populate(Z),r=s[8];const H={};H.image=i.image,H.x=18,H.h=20,H.w=20,H.map=i.sprite,H.frame=i.fps[1],g=H.is||"Sprite";let J;if(typeof g=="string"){if(J=u.components&&u.components[g]||d[g],!J)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(J=g);s[9]=J.call(null,{props:H},s[8],i),s[9][Symbol.for("slots")][0]?(r=s[9][Symbol.for("slots")][0],i=s[9]):r=s[9][Symbol.for("children")][0];const fe=u.components&&u.components.Sprite||d.Sprite;r=s[5];const E={};if(s[10]=this.element({parent:r||"root"},i),E.image=i.image,E.x=36,E.h=20,E.w=20,E.map=i.sprite,E.frame=i.fps[2],typeof fe<"u")for(let xt in fe.config.props)delete E[fe.config.props[xt]];s[10].populate(E),r=s[10];const F={};F.image=i.image,F.x=36,F.h=20,F.w=20,F.map=i.sprite,F.frame=i.fps[2],g=F.is||"Sprite";let re;if(typeof g=="string"){if(re=u.components&&u.components[g]||d[g],!re)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(re=g);s[11]=re.call(null,{props:F},s[10],i),s[11][Symbol.for("slots")][0]?(r=s[11][Symbol.for("slots")][0],i=s[11]):r=s[11][Symbol.for("children")][0],r=s[1];const ye={};s[12]=this.element({parent:r||"root"},i),ye.x=150,s[12].populate(ye);const ie=u.components&&u.components.Sprite||d.Sprite;r=s[12];const se={};if(s[13]=this.element({parent:r||"root"},i),se.image=i.image,se.y=2,se.w=48,se.h=25,se.map=i.sprite,se.frame="avg",typeof ie<"u")for(let xt in ie.config.props)delete se[ie.config.props[xt]];s[13].populate(se),r=s[13];const ne={};ne.image=i.image,ne.y=2,ne.w=48,ne.h=25,ne.map=i.sprite,ne.frame="avg",g=ne.is||"Sprite";let le;if(typeof g=="string"){if(le=u.components&&u.components[g]||d[g],!le)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(le=g);s[14]=le.call(null,{props:ne},s[13],i),s[14][Symbol.for("slots")][0]?(r=s[14][Symbol.for("slots")][0],i=s[14]):r=s[14][Symbol.for("children")][0],r=s[12];const xe={};s[15]=this.element({parent:r||"root"},i),xe.x=63,xe.y=2,s[15].populate(xe);const we=u.components&&u.components.Sprite||d.Sprite;r=s[15];const Te={};if(s[16]=this.element({parent:r||"root"},i),Te.image=i.image,Te.x=0,Te.h=20,Te.w=20,Te.map=i.sprite,Te.frame=i.avgFps[0],typeof we<"u")for(let xt in we.config.props)delete Te[we.config.props[xt]];s[16].populate(Te),r=s[16];const Ie={};Ie.image=i.image,Ie.x=0,Ie.h=20,Ie.w=20,Ie.map=i.sprite,Ie.frame=i.avgFps[0],g=Ie.is||"Sprite";let Ee;if(typeof g=="string"){if(Ee=u.components&&u.components[g]||d[g],!Ee)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(Ee=g);s[17]=Ee.call(null,{props:Ie},s[16],i),s[17][Symbol.for("slots")][0]?(r=s[17][Symbol.for("slots")][0],i=s[17]):r=s[17][Symbol.for("children")][0];const _e=u.components&&u.components.Sprite||d.Sprite;r=s[15];const z={};if(s[18]=this.element({parent:r||"root"},i),z.image=i.image,z.x=18,z.h=20,z.w=20,z.map=i.sprite,z.frame=i.avgFps[1],typeof _e<"u")for(let xt in _e.config.props)delete z[_e.config.props[xt]];s[18].populate(z),r=s[18];const Re={};Re.image=i.image,Re.x=18,Re.h=20,Re.w=20,Re.map=i.sprite,Re.frame=i.avgFps[1],g=Re.is||"Sprite";let Ae;if(typeof g=="string"){if(Ae=u.components&&u.components[g]||d[g],!Ae)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(Ae=g);s[19]=Ae.call(null,{props:Re},s[18],i),s[19][Symbol.for("slots")][0]?(r=s[19][Symbol.for("slots")][0],i=s[19]):r=s[19][Symbol.for("children")][0];const oe=u.components&&u.components.Sprite||d.Sprite;r=s[15];const D={};if(s[20]=this.element({parent:r||"root"},i),D.image=i.image,D.x=36,D.h=20,D.w=20,D.map=i.sprite,D.frame=i.avgFps[2],typeof oe<"u")for(let xt in oe.config.props)delete D[oe.config.props[xt]];s[20].populate(D),r=s[20];const me={};me.image=i.image,me.x=36,me.h=20,me.w=20,me.map=i.sprite,me.frame=i.avgFps[2],g=me.is||"Sprite";let Ce;if(typeof g=="string"){if(Ce=u.components&&u.components[g]||d[g],!Ce)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(Ce=g);s[21]=Ce.call(null,{props:me},s[20],i),s[21][Symbol.for("slots")][0]?(r=s[21][Symbol.for("slots")][0],i=s[21]):r=s[21][Symbol.for("children")][0],r=s[1];const ze={};s[22]=this.element({parent:r||"root"},i),ze.x=0,ze.y=40,s[22].populate(ze);const ae=u.components&&u.components.Sprite||d.Sprite;r=s[22];const Be={};if(s[23]=this.element({parent:r||"root"},i),Be.image=i.image,Be.x=-2,Be.w=47,Be.h=25,Be.map=i.sprite,Be.frame="min",typeof ae<"u")for(let xt in ae.config.props)delete Be[ae.config.props[xt]];s[23].populate(Be),r=s[23];const Y={};Y.image=i.image,Y.x=-2,Y.w=47,Y.h=25,Y.map=i.sprite,Y.frame="min",g=Y.is||"Sprite";let $;if(typeof g=="string"){if($=u.components&&u.components[g]||d[g],!$)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&($=g);s[24]=$.call(null,{props:Y},s[23],i),s[24][Symbol.for("slots")][0]?(r=s[24][Symbol.for("slots")][0],i=s[24]):r=s[24][Symbol.for("children")][0],r=s[22];const be={};s[25]=this.element({parent:r||"root"},i),be.x=58,be.y=2,s[25].populate(be);const De=u.components&&u.components.Sprite||d.Sprite;r=s[25];const Le={};if(s[26]=this.element({parent:r||"root"},i),Le.image=i.image,Le.x=0,Le.h=20,Le.w=20,Le.map=i.sprite,Le.frame=i.minFps[0],typeof De<"u")for(let xt in De.config.props)delete Le[De.config.props[xt]];s[26].populate(Le),r=s[26];const it={};it.image=i.image,it.x=0,it.h=20,it.w=20,it.map=i.sprite,it.frame=i.minFps[0],g=it.is||"Sprite";let zn;if(typeof g=="string"){if(zn=u.components&&u.components[g]||d[g],!zn)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(zn=g);s[27]=zn.call(null,{props:it},s[26],i),s[27][Symbol.for("slots")][0]?(r=s[27][Symbol.for("slots")][0],i=s[27]):r=s[27][Symbol.for("children")][0];const oo=u.components&&u.components.Sprite||d.Sprite;r=s[25];const mi={};if(s[28]=this.element({parent:r||"root"},i),mi.image=i.image,mi.x=18,mi.h=20,mi.w=20,mi.map=i.sprite,mi.frame=i.minFps[1],typeof oo<"u")for(let xt in oo.config.props)delete mi[oo.config.props[xt]];s[28].populate(mi),r=s[28];const yi={};yi.image=i.image,yi.x=18,yi.h=20,yi.w=20,yi.map=i.sprite,yi.frame=i.minFps[1],g=yi.is||"Sprite";let rt;if(typeof g=="string"){if(rt=u.components&&u.components[g]||d[g],!rt)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(rt=g);s[29]=rt.call(null,{props:yi},s[28],i),s[29][Symbol.for("slots")][0]?(r=s[29][Symbol.for("slots")][0],i=s[29]):r=s[29][Symbol.for("children")][0];const ve=u.components&&u.components.Sprite||d.Sprite;r=s[25];const Ot={};if(s[30]=this.element({parent:r||"root"},i),Ot.image=i.image,Ot.x=36,Ot.h=20,Ot.w=20,Ot.map=i.sprite,Ot.frame=i.minFps[2],typeof ve<"u")for(let xt in ve.config.props)delete Ot[ve.config.props[xt]];s[30].populate(Ot),r=s[30];const Zt={};Zt.image=i.image,Zt.x=36,Zt.h=20,Zt.w=20,Zt.map=i.sprite,Zt.frame=i.minFps[2],g=Zt.is||"Sprite";let Mn;if(typeof g=="string"){if(Mn=u.components&&u.components[g]||d[g],!Mn)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(Mn=g);s[31]=Mn.call(null,{props:Zt},s[30],i),s[31][Symbol.for("slots")][0]?(r=s[31][Symbol.for("slots")][0],i=s[31]):r=s[31][Symbol.for("children")][0],r=s[1];const Vn={};s[32]=this.element({parent:r||"root"},i),Vn.x=150,Vn.y=40,s[32].populate(Vn);const _n=u.components&&u.components.Sprite||d.Sprite;r=s[32];const nt={};if(s[33]=this.element({parent:r||"root"},i),nt.image=i.image,nt.w=53,nt.h=25,nt.map=i.sprite,nt.frame="max",typeof _n<"u")for(let xt in _n.config.props)delete nt[_n.config.props[xt]];s[33].populate(nt),r=s[33];const Ue={};Ue.image=i.image,Ue.w=53,Ue.h=25,Ue.map=i.sprite,Ue.frame="max",g=Ue.is||"Sprite";let Pt;if(typeof g=="string"){if(Pt=u.components&&u.components[g]||d[g],!Pt)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(Pt=g);s[34]=Pt.call(null,{props:Ue},s[33],i),s[34][Symbol.for("slots")][0]?(r=s[34][Symbol.for("slots")][0],i=s[34]):r=s[34][Symbol.for("children")][0],r=s[32];const Ve={};s[35]=this.element({parent:r||"root"},i),Ve.x=63,Ve.y=2,s[35].populate(Ve);const $t=u.components&&u.components.Sprite||d.Sprite;r=s[35];const Et={};if(s[36]=this.element({parent:r||"root"},i),Et.image=i.image,Et.x=0,Et.h=20,Et.w=20,Et.map=i.sprite,Et.frame=i.maxFps[0],typeof $t<"u")for(let xt in $t.config.props)delete Et[$t.config.props[xt]];s[36].populate(Et),r=s[36];const ni={};ni.image=i.image,ni.x=0,ni.h=20,ni.w=20,ni.map=i.sprite,ni.frame=i.maxFps[0],g=ni.is||"Sprite";let _i;if(typeof g=="string"){if(_i=u.components&&u.components[g]||d[g],!_i)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(_i=g);s[37]=_i.call(null,{props:ni},s[36],i),s[37][Symbol.for("slots")][0]?(r=s[37][Symbol.for("slots")][0],i=s[37]):r=s[37][Symbol.for("children")][0];const nn=u.components&&u.components.Sprite||d.Sprite;r=s[35];const vn={};if(s[38]=this.element({parent:r||"root"},i),vn.image=i.image,vn.x=18,vn.h=20,vn.w=20,vn.map=i.sprite,vn.frame=i.maxFps[1],typeof nn<"u")for(let xt in nn.config.props)delete vn[nn.config.props[xt]];s[38].populate(vn),r=s[38];const xn={};xn.image=i.image,xn.x=18,xn.h=20,xn.w=20,xn.map=i.sprite,xn.frame=i.maxFps[1],g=xn.is||"Sprite";let Io;if(typeof g=="string"){if(Io=u.components&&u.components[g]||d[g],!Io)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(Io=g);s[39]=Io.call(null,{props:xn},s[38],i),s[39][Symbol.for("slots")][0]?(r=s[39][Symbol.for("slots")][0],i=s[39]):r=s[39][Symbol.for("children")][0];const wn=u.components&&u.components.Sprite||d.Sprite;r=s[35];const vi={};if(s[40]=this.element({parent:r||"root"},i),vi.image=i.image,vi.x=36,vi.h=20,vi.w=20,vi.map=i.sprite,vi.frame=i.maxFps[2],typeof wn<"u")for(let xt in wn.config.props)delete vi[wn.config.props[xt]];s[40].populate(vi),r=s[40];const ii={};ii.image=i.image,ii.x=36,ii.h=20,ii.w=20,ii.map=i.sprite,ii.frame=i.maxFps[2],g=ii.is||"Sprite";let ct;if(typeof g=="string"){if(ct=u.components&&u.components[g]||d[g],!ct)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(ct=g);return s[41]=ct.call(null,{props:ii},s[40],i),s[41][Symbol.for("slots")][0]?(r=s[41][Symbol.for("slots")][0],i=s[41]):r=s[41][Symbol.for("children")][0],s},effects:[function(r,i,u,d,y,x){i[6].set("frame",r.fps[0])},function(r,i,u,d,y,x){i[7][Symbol.for("props")].frame=r.fps[0]},function(r,i,u,d,y,x){i[8].set("frame",r.fps[1])},function(r,i,u,d,y,x){i[9][Symbol.for("props")].frame=r.fps[1]},function(r,i,u,d,y,x){i[10].set("frame",r.fps[2])},function(r,i,u,d,y,x){i[11][Symbol.for("props")].frame=r.fps[2]},function(r,i,u,d,y,x){i[16].set("frame",r.avgFps[0])},function(r,i,u,d,y,x){i[17][Symbol.for("props")].frame=r.avgFps[0]},function(r,i,u,d,y,x){i[18].set("frame",r.avgFps[1])},function(r,i,u,d,y,x){i[19][Symbol.for("props")].frame=r.avgFps[1]},function(r,i,u,d,y,x){i[20].set("frame",r.avgFps[2])},function(r,i,u,d,y,x){i[21][Symbol.for("props")].frame=r.avgFps[2]},function(r,i,u,d,y,x){i[26].set("frame",r.minFps[0])},function(r,i,u,d,y,x){i[27][Symbol.for("props")].frame=r.minFps[0]},function(r,i,u,d,y,x){i[28].set("frame",r.minFps[1])},function(r,i,u,d,y,x){i[29][Symbol.for("props")].frame=r.minFps[1]},function(r,i,u,d,y,x){i[30].set("frame",r.minFps[2])},function(r,i,u,d,y,x){i[31][Symbol.for("props")].frame=r.minFps[2]},function(r,i,u,d,y,x){i[36].set("frame",r.maxFps[0])},function(r,i,u,d,y,x){i[37][Symbol.for("props")].frame=r.maxFps[0]},function(r,i,u,d,y,x){i[38].set("frame",r.maxFps[1])},function(r,i,u,d,y,x){i[39][Symbol.for("props")].frame=r.maxFps[1]},function(r,i,u,d,y,x){i[40].set("frame",r.maxFps[2])},function(r,i,u,d,y,x){i[41][Symbol.for("props")].frame=r.maxFps[2]}],context:{}},state(){return{image:ck,sprite:{defaults:{y:1,w:20,h:20},frames:{"-":{x:-1e3},0:{x:1},1:{x:23},2:{x:45},3:{x:67},4:{x:89},5:{x:111},6:{x:133},7:{x:155},8:{x:177},9:{x:199},avg:{x:221,w:48,h:25},fps:{x:271,w:43,h:25},max:{x:316,w:53,h:25},min:{x:371,w:47,h:25}}},fps:"---",avgFps:"---",minFps:"---",maxFps:"---"}},hooks:{ready(){let h=1e4,r=0,i=0,u=0,d=0;za.on("fpsUpdate",(y,{fps:x})=>{h=Math.min(x,h),r=Math.max(x,r),u+=x,d++,i=Math.round(u/d),this.fps=x.toString().padStart(3,"0"),this.avgFps=i.toString().padStart(3,"0"),this.minFps=h.toString().padStart(3,"0"),this.maxFps=r.toString().padStart(3,"0")})}}}),dk=()=>tr("Layout",{code:{render:function(r,i,u,d,y,x){const s=[],g={};return s[0]=this.element({parent:r||"root"},i),g[Symbol.for("isSlot")]=!0,g.ref="slot",s[0].populate(g),s},effects:[],context:{}},props:["direction",{key:"gap",default:0}],hooks:{ready(){this.___layout()}},methods:{___layout(){let h=0;this.select("slot").children.forEach(r=>{r.set(this.direction==="vertical"?"y":"x",h),h+=(r.node[this.direction==="vertical"?"height":"width"]||0)+(this.gap||0)})}}}),pk=()=>({Circle:lk(),RouterView:uk(),Sprite:fk(),FPScounter:hk(),Layout:dk()}),gp={},O2=(h,r="",i={})=>{let u;if(typeof r=="object"?(i=r,u=""):u=r,typeof h=="function"){if(u==="")throw Error("Error registering plugin: name is required for plugin");gp[u]={plugin:h,options:i}}else h.plugin&&O2(h.plugin,h.name,i)};let df;const Wx=h=>{throw new Error(`Parameter ${h} is required`)},tr=(h=Wx("name"),r=Wx("config"))=>{let i;const u=function(y,x,s,g){this.componentId=Wb(h),this.lifecycle=Object.assign(Object.create(Jb),{component:this,previous:null,current:null}),this.parent=s,this.rootParent=g,this[ue.holder]=x,this[ue.id]=Xb(),this[ue.props]=ep(y.props||{},Mi.get("reactivityMode")),this[ue.timeouts]=[],this[ue.intervals]=[],this[ue.originalState]={...r.state&&typeof r.state=="function"&&r.state.apply(this)||{},hasFocus:!1},this[ue.state]=ep(this[ue.originalState],Mi.get("reactivityMode")),this.lifecycle.state="init",this[ue.children]=r.code.render.apply(Rf,[x,this,r,df,qu,fs])||[],this[ue.wrapper]=this[ue.children][0],this[ue.slots]=this[ue.children].filter(M=>M[ue.isSlot]),r.hooks&&(r.hooks.frameTick&&za.on("frameTick",(M,A)=>Qd("frameTick",this[ue.identifier],this,[A])),r.hooks.idle&&za.on("idle",()=>{Qd("idle",this[ue.identifier],this)}),r.hooks.attach&&this[ue.wrapper].node.on("inBounds",()=>{this.lifecycle.state="attach"}),r.hooks.detach&&this[ue.wrapper].node.on("outOfBounds",(M,{previous:A})=>{A>0&&(this.lifecycle.state="detach")}),r.hooks.enter&&this[ue.wrapper].node.on("inViewport",()=>{this.lifecycle.state="enter"}),r.hooks.exit&&this[ue.wrapper].node.on("outOfViewport",()=>{this.lifecycle.state="exit"}));for(let M=0;M<r.code.effects.length;M++)qu(()=>{r.code.effects[M].apply(Rf,[this,this[ue.children],r,df,g,qu])});return this[ue.watchers]&&Object.keys(this[ue.watchers]).forEach(M=>{let A=this[M];qu((k=!1)=>{(A!==this[M]||k===!0)&&(this[ue.watchers][M].apply(this,[this[M],A]),A=this[M])})}),Object.getOwnPropertySymbols(this).forEach(M=>{Object.defineProperties(this,{[M]:{enumerable:!1,configurable:!1}})}),setTimeout(()=>this.lifecycle.state="ready"),this},d=(y={},x,s,g)=>(ba[ue.pluginsRegistered]===!1&&(Object.keys(gp).forEach(M=>{const A=`$${M}`;A in ba&&Nt.warn(`"${M}" (this.${A}) already exists as a property or plugin on the Base Component. You may be overwriting built-in functionality. Proceed with care!`);const k=gp[M];Object.defineProperty(ba,A,{value:k.plugin(k.options),writable:!1,enumerable:!0,configurable:!1})}),ba[ue.pluginsRegistered]=!0),i||(Nt.debug(`Setting up ${h} component`),i=ak(Object.create(ba),r)),r.code||(Nt.debug(`Generating code for ${h} component`),r.code=Vb.call(r,zb(r.template,h))),df||(df=pk()),u.call(Object.create(i),y,x,s,g));return d.config=r,d},gk=h=>{const r={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Enter:"enter"," ":"space",Backspace:"back",Escape:"escape",37:"left",39:"right",38:"up",40:"down",13:"enter",32:"space",8:"back",27:"escape"};h.hooks=h.hooks||{};let i,u,d;return h.hooks[ue.destroy]=function(){document.removeEventListener("keydown",i),document.removeEventListener("keyup",u)},h.hooks[ue.init]=function(){const y={...r,...Mi.get("keymap",{})};i=x=>{const s=y[x.key]||y[x.keyCode]||x.key||x.keyCode;Co.input(s,x),clearTimeout(d),d=setTimeout(()=>{Co.hold=!0},Mi.get("holdTimeout",A2))},u=()=>{clearTimeout(d),Co.hold=!1},document.addEventListener("keydown",i),document.addEventListener("keyup",u),setTimeout(()=>Co.set(this))},tr("App",h)},et={Component:tr,Application:gk,Launch:R3,Plugin:O2},mk=h=>new Promise((r,i)=>{const u=new XMLHttpRequest;u.onreadystatechange=function(){u.readyState==XMLHttpRequest.DONE&&(u.status===0||u.status===200?r(JSON.parse(u.responseText)):i(u.statusText))},u.open("GET",h),u.send(null)}),yk={name:"language",plugin(h={}){let r={},i={};const u=ep({language:"",loaded:0}),d=s=>{i=r[s]||{},u.language=s,Object.keys(r).length===0&&Nt.warn("No translations loaded. Please load a file with translations or specify a translations object manually"),s in r||Nt.warn(`Language ${s} not available in the loaded translations`)},y=s=>mk(s).then(g=>{x(g)}).catch(g=>{Nt.error(g)}),x=s=>{r=s,i=r[u.language]||{},u.loaded++};return"file"in h?y(h.file).then(()=>{"language"in h&&d(h.language)}):"language"in h&&d(h.language),{translate(s){u.language,u.loaded;let g=[...arguments].slice(1);return g.length===0?i&&i[s]||s:(g.length===1&&typeof g[0]=="object"&&(g=g.pop()),Object.keys(Array.isArray(g)?Object.assign({},g):g).reduce((M,A)=>M.replace(new RegExp("{\\s?"+A+"\\s?}","g"),g[A]),i&&i[s]||s))},get language(){return u.language},set(s){d(s)},translations(s){x(s)},load(s){return y(s)}}}},Xd=h=>new URLSearchParams(window.location.search).get(h),Ia={sky:{test(){return navigator.userAgent.indexOf("WPE Sky")>-1||Xd("keymapping")==="sky"},mapping:{Escape:"back",27:"back"}},webos:{test(){return navigator.userAgent.indexOf("WebOS")>-1||Xd("keymapping")==="webos"},mapping:{19:"pause",33:"channelUp",34:"channelDown",412:"rewind",413:"stop",415:"play",417:"fastForward",461:"back"}},tizen:{test(){return navigator.userAgent.indexOf("Tizen")>-1||Xd("keymapping")==="tizen"},mapping:{10009:"back",10252:"playPause",19:"pause",412:"rewind",413:"stop",415:"play",417:"fastForward",427:"channelUp",428:"channelDown"}}},vk=()=>{let h={};return Object.keys(Ia).forEach(r=>{if(Ia[r].test&&typeof Ia[r].test=="function"&&Ia[r].test()===!0){h=Ia[r].mapping;return}}),h},xk="modulepreload",wk=function(h){return"/"+h},Xx={},Sk=function(r,i,u){if(!i||i.length===0)return r();const d=document.getElementsByTagName("link");return Promise.all(i.map(y=>{if(y=wk(y),y in Xx)return;Xx[y]=!0;const x=y.endsWith(".css"),s=x?'[rel="stylesheet"]':"";if(!!u)for(let A=d.length-1;A>=0;A--){const k=d[A];if(k.href===y&&(!x||k.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${y}"]${s}`))return;const M=document.createElement("link");if(M.rel=x?"stylesheet":xk,x||(M.as="script",M.crossOrigin=""),M.href=y,document.head.appendChild(M),x)return new Promise((A,k)=>{M.addEventListener("load",A),M.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${y}`)))})})).then(()=>r()).catch(y=>{const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=y,window.dispatchEvent(x),!x.defaultPrevented)throw y})},Tk=et.Component("PortalItem",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.w=370,g.h=320,g.scale={transition:i.hasFocus?1.1:1},g.color=i.backgroundColor,g.effects=[i.shader("radius",{radius:6})],s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.x=30,M.y=30,M.content=i.number,M.size=84,M.color=i.fontColor,M.__textnode=!0,s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.x=30,A.y=140,A.content=i.title,A.size=42,A.font="raleway",A.color=i.fontColor,A.letterspacing=2,A.__textnode=!0,s[2].populate(A),r=s[0];const k={};return s[3]=this.element({parent:r||"root"},i),k.x=30,k.y=200,k.content=i.description,k.wordwrap=300,k.size=28,k.color=i.fontColor,k.lineheight=32,k.__textnode=!0,s[3].populate(k),s},effects:[function(r,i,u,d,y,x){i[0].set("scale",{transition:r.hasFocus?1.1:1})},function(r,i,u,d,y,x){i[0].set("color",r.backgroundColor)},function(r,i,u,d,y,x){i[0].set("effects",[r.shader("radius",{radius:6})])},function(r,i,u,d,y,x){i[1].set("content",r.number)},function(r,i,u,d,y,x){i[1].set("color",r.fontColor)},function(r,i,u,d,y,x){i[2].set("content",r.title)},function(r,i,u,d,y,x){i[2].set("color",r.fontColor)},function(r,i,u,d,y,x){i[3].set("content",r.description)},function(r,i,u,d,y,x){i[3].set("color",r.fontColor)}],context:{}},props:["title","description","index","id"],state(){return{backgroundColor:"#44037a",fontColor:"#e8d7f9",number:this.index<9?`0${this.index+1}`:this.index+1}},hooks:{focus(){this.backgroundColor="#fafafa",this.fontColor="#000"},unfocus(){this.$router.navigating||(this.backgroundColor="#44037a",this.fontColor="#e8d7f9")}},input:{enter(){this.$router.to(`/${this.id}`)},back(){}}}),Ck=et.Component("PortalRow",{components:{PortalItem:Tk},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.alpha={transition:{value:i.itemOffset<240?1:0,duration:200}},s[1].populate(A),r=s[1];const k={};s[2]=this.element({parent:r||"root"},i),k.content=i.title,k.x=60,k.__textnode=!0,s[2].populate(k),r=s[1];const b={};s[3]=this.element({parent:r||"root"},i),b.y=50,b.x=60,b.h=1,b.w=1800,b.color="0xe8d7f9ff",s[3].populate(b),r=s[0];const P={};s[4]=this.element({parent:r||"root"},i),P.y=100,P.x={transition:i.rowOffset},s[4].populate(P),r=s[4];const w=[],R=(B=[],U,W)=>{const G=x(B),Q=new Set(G.map(H=>""+H.id));let ee=W.length;for(;ee--;){const H=W[ee];Q.has(H)||(U[5][H]&&U[5][H].destroy(),delete U[5][H],U[6][H]&&U[6][H].destroy(),delete U[6][H])}W.length=0;const Z=B.length;for(let H=0;H<Z;H++){const J=Object.create(i);r=U[4],J.index=H,J.item=G[H],J.key=J.item.id,W.push(J.key);const fe=u.components&&u.components.PortalItem||d.PortalItem;U[5]===void 0&&(U[5]={});const E={};if(U[5][J.key]||(U[5][J.key]=this.element({parent:r||"root"},i)),E.x={transition:{value:J.itemOffset+J.index*430,delay:50*(J.index%4),duration:500}},E.title=J.item.title,E.description=J.item.description,E.id=J.item.id,E.index=J.index,E.ref="item"+J.index,typeof fe<"u")for(let re in fe.config.props)delete E[fe.config.props[re]];U[5][J.key].nodeId||U[5][J.key].populate(E),U[6]===void 0&&(U[6]={}),r=U[5][J.key];const F={};if(F.x={transition:{value:J.itemOffset+J.index*430,delay:50*(J.index%4),duration:500}},F.title=J.item.title,F.description=J.item.description,F.id=J.item.id,F.index=J.index,F.ref="item"+J.index,!U[6][J.key]){g=F.is||"PortalItem";let re;if(typeof g=="string"){if(re=u.components&&u.components[g]||d[g],!re)throw new Error('Component "PortalItem" not found')}else typeof g=="function"&&g.name==="factory"&&(re=g);U[6][J.key]=re.call(null,{props:F},U[5][J.key],i),U[6][J.key][Symbol.for("slots")][0]?(r=U[6][J.key][Symbol.for("slots")][0],i=U[6][J.key]):r=U[6][J.key][Symbol.for("children")][0]}J.item=B[H],y(()=>{U[5][J.key].set("ref","item"+J.index)},"items"),y(()=>{U[6][J.key][Symbol.for("props")].ref="item"+J.index},"items"),U[5][0]&&U[5][0].forComponent&&U[5][0].forComponent.___layout&&U[5][0].forComponent.___layout()}};return y(()=>{R(i.items,s,w)},"items"),y(()=>{i.itemOffset;for(let B=0;B<i.items.length;B++){const U={};U.index=B,U.item=i.items[B],U.key=U.item.id,s[5][U.key].set("x",{transition:{value:i.itemOffset+U.index*430,delay:50*(U.index%4),duration:500}})}}),y(()=>{i.itemOffset;for(let B=0;B<i.items.length;B++){const U={};U.index=B,U.item=i.items[B],U.key=U.item.id,s[6][U.key][Symbol.for("props")].x={transition:{value:i.itemOffset+U.index*430,delay:50*(U.index%4),duration:500}}}}),s},effects:[function(r,i,u,d,y,x){i[1].set("alpha",{transition:{value:r.itemOffset<240?1:0,duration:200}})},function(r,i,u,d,y,x){i[4].set("x",{transition:r.rowOffset})}],context:{}},props:["title","items"],state(){return{focused:0,rowOffset:60,itemOffset:240}},hooks:{ready(){this.itemOffset=0},focus(){this.trigger("focused")}},watch:{focused(h){const r=this.select(`item${h}`);r&&r.focus&&(r.focus(),h<1?this.rowOffset=60:h>this.items.length-2?this.rowOffset=60-(this.items.length-2)*430+430:this.rowOffset=60-h*430+430)}},input:{left(){this.focused>0?this.focused--:this.focused=this.items.length-1},right(){this.focused<this.items.length-1?this.focused++:this.focused=0}}}),Ek="@lightningjs/blits-example-app",Ak="1.1.0",bk="Lightning 3 Blits Example App",Ik="index.js",kk="module",Mk={start:"npm run dev","start:test":"NODE_ENV=testing npm run dev",lint:"eslint '**/*.js'","lint:fix":"eslint '**/*.js' --fix",build:"vite build",dev:"vite dev --host",test:"NODE_ENV=testing backstop --config=backstop.cjs test","test:reference":"NODE_ENV=testing backstop --config=backstop.cjs reference"},_k={hooks:{"pre-commit":"lint-staged"}},Rk="Michiel van der Geest <hello@michielvandergeest.com>",Lk="Apache-2",Pk={backstopjs:"^6.3.22",eslint:"^8.8.0","eslint-config-prettier":"^8.3.0","eslint-plugin-prettier":"^4.0.0",husky:"^7.0.4","lint-staged":"^12.3.3",playwright:"^1.41.0",prettier:"^2.5.1","shaka-player":"^4.7.1",vite:"^4.0.4"},Dk={"@lightningjs/blits":"^1.2.0"},Nk={name:Ek,version:Ak,description:bk,main:Ik,type:kk,scripts:Mk,"lint-staged":{"*.js":["eslint --fix"]},husky:_k,author:Rk,license:Lk,devDependencies:Pk,dependencies:Dk},Ok=et.Component("Portal",{components:{PortalRow:Ck},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),M.w=1920,M.h=1080,M.color="{top: '0x44037aff', bottom: '0x240244ff'}",s[0].populate(M);const A=u.components&&u.components.PortalRow||d.PortalRow;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),k.mount="{y: 0.5}",k.h=500,k.y={transition:-i.rowFocused*420+550},k.title="Demos",k.items=i.demo,k.ref="row0",typeof A<"u")for(let ie in A.config.props)delete k[A.config.props[ie]];s[1].populate(k),r=s[1];const b={};b.mount="{y: 0.5}",b.h=500,b.y={transition:-i.rowFocused*420+550},b.title="Demos",b.items=i.demo,b.ref="row0",g=b.is||"PortalRow";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "PortalRow" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0];const w=u.components&&u.components.PortalRow||d.PortalRow;r=s[0];const R={};if(s[3]=this.element({parent:r||"root"},i),R.mount="{y: 0.5}",R.h=500,R.y={transition:-i.rowFocused*420+1100},R.title="Examples and tests",R.items=i.example,R.ref="row1",typeof w<"u")for(let ie in w.config.props)delete R[w.config.props[ie]];s[3].populate(R),r=s[3];const B={};B.mount="{y: 0.5}",B.h=500,B.y={transition:-i.rowFocused*420+1100},B.title="Examples and tests",B.items=i.example,B.ref="row1",g=B.is||"PortalRow";let U;if(typeof g=="string"){if(U=u.components&&u.components[g]||d[g],!U)throw new Error('Component "PortalRow" not found')}else typeof g=="function"&&g.name==="factory"&&(U=g);s[4]=U.call(null,{props:B},s[3],i),s[4][Symbol.for("slots")][0]?(r=s[4][Symbol.for("slots")][0],i=s[4]):r=s[4][Symbol.for("children")][0];const W=u.components&&u.components.PortalRow||d.PortalRow;r=s[0];const G={};if(s[5]=this.element({parent:r||"root"},i),G.mount="{y: 0.5}",G.h=500,G.y={transition:-i.rowFocused*420+1650},G.title="Benchmarks and stress tests",G.items=i.benchmark,G.ref="row2",typeof W<"u")for(let ie in W.config.props)delete G[W.config.props[ie]];s[5].populate(G),r=s[5];const Q={};Q.mount="{y: 0.5}",Q.h=500,Q.y={transition:-i.rowFocused*420+1650},Q.title="Benchmarks and stress tests",Q.items=i.benchmark,Q.ref="row2",g=Q.is||"PortalRow";let ee;if(typeof g=="string"){if(ee=u.components&&u.components[g]||d[g],!ee)throw new Error('Component "PortalRow" not found')}else typeof g=="function"&&g.name==="factory"&&(ee=g);s[6]=ee.call(null,{props:Q},s[5],i),s[6][Symbol.for("slots")][0]?(r=s[6][Symbol.for("slots")][0],i=s[6]):r=s[6][Symbol.for("children")][0],r=s[0];const Z={};s[7]=this.element({parent:r||"root"},i),Z.w=1920,Z.h=200,Z.color="0x44037aff",s[7].populate(Z),r=s[7];const H={};s[8]=this.element({parent:r||"root"},i),H.w=1920,H.h=70,H.y=200,H.color="{top: '0x44037aff'}",s[8].populate(H),r=s[7];const J={};s[9]=this.element({parent:r||"root"},i),J.y={transition:{value:80-i.logoOffset,duration:400}},s[9].populate(J),r=s[9];const fe={};s[10]=this.element({parent:r||"root"},i),fe.src="assets/blits-logo-full.png",fe.w=200,fe.h=112,fe.x=60,s[10].populate(fe),r=s[9];const E={};s[11]=this.element({parent:r||"root"},i),E.w=2,E.h=120,E.y=-10,E.color="0xffffff80",E.x=300,s[11].populate(E),r=s[9];const F={};s[12]=this.element({parent:r||"root"},i),F.x=320,F.y=16,s[12].populate(F),r=s[12];const re={};s[13]=this.element({parent:r||"root"},i),re.y=0,re.size=36,re.content="Example App",re.__textnode=!0,s[13].populate(re),r=s[12];const ye={};return s[14]=this.element({parent:r||"root"},i),ye.y=50,ye.size=24,ye.content="v"+i.version,ye.__textnode=!0,s[14].populate(ye),s},effects:[function(r,i,u,d,y,x){i[1].set("y",{transition:-r.rowFocused*420+550})},function(r,i,u,d,y,x){i[2][Symbol.for("props")].y={transition:-r.rowFocused*420+550}},function(r,i,u,d,y,x){i[3].set("y",{transition:-r.rowFocused*420+1100})},function(r,i,u,d,y,x){i[4][Symbol.for("props")].y={transition:-r.rowFocused*420+1100}},function(r,i,u,d,y,x){i[5].set("y",{transition:-r.rowFocused*420+1650})},function(r,i,u,d,y,x){i[6][Symbol.for("props")].y={transition:-r.rowFocused*420+1650}},function(r,i,u,d,y,x){i[9].set("y",{transition:{value:80-r.logoOffset,duration:400}})}],context:{}},state(){return{version:Nk.version,offset:60,rowFocused:0,rows:["demo","example","benchmark"],logoOffset:50,demo:[{title:"Loader",id:"demos/loading",description:"A basic loading screen"},{title:"Intro",id:"demos/intro",description:"A splash screen with custom animations"},{title:"Theming",id:"demos/theming",description:"Dynamically changing the styling of a component with themes"},{title:"TMDB",id:"demos/tmdb",description:"The Movie Database (TMDB) example using data from a remote API"},{title:"Sprites",id:"demos/sprites",description:"Display multiple images while keeping low memory footprint"},{title:"Focus",id:"demos/focushandling",description:"Managing focus between components in a simple layout"},{title:"Memory Game",id:"demos/memory-game",description:"Memory game with speech assistence (for accessibility)"},{title:"Video player",id:"demos/player",description:"Example of Video Playback with basic controls"}],example:[{title:"Positioning",id:"examples/positioning",description:"Positioning Elements and Components"},{title:"Colors",id:"examples/colors",description:"Using different formats and notations for defining colors"},{title:"Gradients",id:"examples/gradients",description:"Example of Basic gradients"},{title:"Transitions",id:"examples/transitions",description:"Comparing different transition easing functions"},{title:"Components",id:"examples/components",description:"Reusable Components"},{title:"Alpha",id:"examples/alpha",description:"Applying transparency to Elements, Images and Components"},{title:"Scaling",id:"examples/scaling",description:"Resizing and scaling Elements and Components"},{title:"Rotation",id:"examples/rotation",description:"Rotating Elements"},{title:"Key input",id:"examples/keyinput",description:"Handling user input events"},{title:"For Loop",id:"examples/forloop",description:"Iterating over Elements and Components using for loops"},{title:"Advanced loop",id:"examples/forloop-advanced",description:"Testing various Array operations with a for loop"},{title:"Effects",id:"examples/effects",description:"Applying one or multiple effects (aka shaders)"},{title:"Show",id:"examples/showif",description:"Conditionally show or hide Elements and Components"},{title:"Events",id:"examples/events",description:"Communication between components by emitting and listening for events"},{title:"Images",id:"examples/images",description:"1 image says more than 1000 words ;)"},{title:"Texts",id:"examples/texts",description:"Displaying and formatting text"},{title:"Slots",id:"examples/slots",description:"Insert dynamic content from a parent into a child using slots"},{title:"Viewport",id:"examples/viewport",description:"Lifecycle events when entering and leaving the viewport (margins)"},{title:"Translations",id:"examples/languageplugin",description:"Language Plugin for internationalization"}],benchmark:[{title:"Exponential",id:"benchmarks/exponential",description:"Spawn a large number of components at an exponential rate"}]}},hooks:{ready(){this.logoOffset=0,this.trigger("rowFocused"),console.log("backstopjs:ready")}},watch:{rowFocused(h){const r=this.select(`row${h}`);r&&r.focus&&r.focus()}},input:{up(){this.rowFocused=(this.rowFocused-1+this.rows.length)%this.rows.length},down(){this.rowFocused=(this.rowFocused+1)%this.rows.length}}}),Uk=et.Component("Letter",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.w=i.w,M.h={transition:{value:410+i.offset,duration:i.duration,delay:i.wait,easing:i.timingFunction}},M.color="0xe6e6e6ff",s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.w=i.w,A.h=280,A.src=i.image,A.y={transition:{value:400+i.offset,duration:i.duration,delay:i.wait,easing:i.timingFunction}},s[2].populate(A),r=s[0];const k={};return s[3]=this.element({parent:r||"root"},i),k.w=i.w,k.color="0xe6e6e6ff",k.h={transition:{value:500-i.offset,duration:i.duration,delay:i.wait,easing:i.timingFunction}},k.y={transition:{value:660+i.offset,duration:i.duration,delay:i.wait,easing:i.timingFunction}},s[3].populate(k),s},effects:[function(r,i,u,d,y,x){i[1].set("h",{transition:{value:410+r.offset,duration:r.duration,delay:r.wait,easing:r.timingFunction}})},function(r,i,u,d,y,x){i[2].set("src",r.image)},function(r,i,u,d,y,x){i[2].set("y",{transition:{value:400+r.offset,duration:r.duration,delay:r.wait,easing:r.timingFunction}})},function(r,i,u,d,y,x){i[3].set("h",{transition:{value:500-r.offset,duration:r.duration,delay:r.wait,easing:r.timingFunction}})},function(r,i,u,d,y,x){i[3].set("y",{transition:{value:660+r.offset,duration:r.duration,delay:r.wait,easing:r.timingFunction}})}],context:{}},props:["w","letter","direction","delay"],computed:{image(){return`assets/${this.letter}.png`}},state(){return{offset:this.direction==="up"?-680:680,duration:1e3,wait:0,timingFunction:"cubic-bezier(1,-0.64,.39,1.44)"}},hooks:{ready(){this.animate()}},methods:{animate(){this.$setTimeout(()=>{this.offset=0},1e3),this.$setTimeout(()=>{this.wait=this.delay+150,this.duration=1e3,this.offset=1080},2800),this.$setTimeout(()=>{this.wait=this.delay/3,this.timingFunction="ease-in-out",this.duration=1500,this.offset=0},5e3)}}}),Bk=et.Component("Intro",{components:{Letter:Uk},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),M.w=1920,M.h=1080,M.src="assets/background.jpg",s[0].populate(M);const A=u.components&&u.components.Letter||d.Letter;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),k.letter="l",k.w=294,typeof A<"u")for(let Ce in A.config.props)delete k[A.config.props[Ce]];s[1].populate(k),r=s[1];const b={};b.letter="l",b.w=294,g=b.is||"Letter";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "Letter" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0];const w=u.components&&u.components.Letter||d.Letter;r=s[0];const R={};if(s[3]=this.element({parent:r||"root"},i),R.letter="i-1",R.w=128,R.x=294,R.direction="up",R.delay=50,typeof w<"u")for(let Ce in w.config.props)delete R[w.config.props[Ce]];s[3].populate(R),r=s[3];const B={};B.letter="i-1",B.w=128,B.x=294,B.direction="up",B.delay=50,g=B.is||"Letter";let U;if(typeof g=="string"){if(U=u.components&&u.components[g]||d[g],!U)throw new Error('Component "Letter" not found')}else typeof g=="function"&&g.name==="factory"&&(U=g);s[4]=U.call(null,{props:B},s[3],i),s[4][Symbol.for("slots")][0]?(r=s[4][Symbol.for("slots")][0],i=s[4]):r=s[4][Symbol.for("children")][0];const W=u.components&&u.components.Letter||d.Letter;r=s[0];const G={};if(s[5]=this.element({parent:r||"root"},i),G.letter="g-1",G.w=205,G.x=422,G.delay=100,typeof W<"u")for(let Ce in W.config.props)delete G[W.config.props[Ce]];s[5].populate(G),r=s[5];const Q={};Q.letter="g-1",Q.w=205,Q.x=422,Q.delay=100,g=Q.is||"Letter";let ee;if(typeof g=="string"){if(ee=u.components&&u.components[g]||d[g],!ee)throw new Error('Component "Letter" not found')}else typeof g=="function"&&g.name==="factory"&&(ee=g);s[6]=ee.call(null,{props:Q},s[5],i),s[6][Symbol.for("slots")][0]?(r=s[6][Symbol.for("slots")][0],i=s[6]):r=s[6][Symbol.for("children")][0];const Z=u.components&&u.components.Letter||d.Letter;r=s[0];const H={};if(s[7]=this.element({parent:r||"root"},i),H.letter="h",H.w=224,H.x=627,H.direction="up",H.delay=150,typeof Z<"u")for(let Ce in Z.config.props)delete H[Z.config.props[Ce]];s[7].populate(H),r=s[7];const J={};J.letter="h",J.w=224,J.x=627,J.direction="up",J.delay=150,g=J.is||"Letter";let fe;if(typeof g=="string"){if(fe=u.components&&u.components[g]||d[g],!fe)throw new Error('Component "Letter" not found')}else typeof g=="function"&&g.name==="factory"&&(fe=g);s[8]=fe.call(null,{props:J},s[7],i),s[8][Symbol.for("slots")][0]?(r=s[8][Symbol.for("slots")][0],i=s[8]):r=s[8][Symbol.for("children")][0];const E=u.components&&u.components.Letter||d.Letter;r=s[0];const F={};if(s[9]=this.element({parent:r||"root"},i),F.letter="t",F.w=190,F.x=851,F.delay=200,typeof E<"u")for(let Ce in E.config.props)delete F[E.config.props[Ce]];s[9].populate(F),r=s[9];const re={};re.letter="t",re.w=190,re.x=851,re.delay=200,g=re.is||"Letter";let ye;if(typeof g=="string"){if(ye=u.components&&u.components[g]||d[g],!ye)throw new Error('Component "Letter" not found')}else typeof g=="function"&&g.name==="factory"&&(ye=g);s[10]=ye.call(null,{props:re},s[9],i),s[10][Symbol.for("slots")][0]?(r=s[10][Symbol.for("slots")][0],i=s[10]):r=s[10][Symbol.for("children")][0];const ie=u.components&&u.components.Letter||d.Letter;r=s[0];const se={};if(s[11]=this.element({parent:r||"root"},i),se.letter="n-1",se.w=221,se.x=1041,se.direction="up",se.delay=250,typeof ie<"u")for(let Ce in ie.config.props)delete se[ie.config.props[Ce]];s[11].populate(se),r=s[11];const ne={};ne.letter="n-1",ne.w=221,ne.x=1041,ne.direction="up",ne.delay=250,g=ne.is||"Letter";let le;if(typeof g=="string"){if(le=u.components&&u.components[g]||d[g],!le)throw new Error('Component "Letter" not found')}else typeof g=="function"&&g.name==="factory"&&(le=g);s[12]=le.call(null,{props:ne},s[11],i),s[12][Symbol.for("slots")][0]?(r=s[12][Symbol.for("slots")][0],i=s[12]):r=s[12][Symbol.for("children")][0];const xe=u.components&&u.components.Letter||d.Letter;r=s[0];const we={};if(s[13]=this.element({parent:r||"root"},i),we.letter="i-2",we.w=115,we.x=1262,we.delay=300,typeof xe<"u")for(let Ce in xe.config.props)delete we[xe.config.props[Ce]];s[13].populate(we),r=s[13];const Te={};Te.letter="i-2",Te.w=115,Te.x=1262,Te.delay=300,g=Te.is||"Letter";let Ie;if(typeof g=="string"){if(Ie=u.components&&u.components[g]||d[g],!Ie)throw new Error('Component "Letter" not found')}else typeof g=="function"&&g.name==="factory"&&(Ie=g);s[14]=Ie.call(null,{props:Te},s[13],i),s[14][Symbol.for("slots")][0]?(r=s[14][Symbol.for("slots")][0],i=s[14]):r=s[14][Symbol.for("children")][0];const Ee=u.components&&u.components.Letter||d.Letter;r=s[0];const _e={};if(s[15]=this.element({parent:r||"root"},i),_e.letter="n-2",_e.w=219,_e.x=1377,_e.direction="up",_e.delay=350,typeof Ee<"u")for(let Ce in Ee.config.props)delete _e[Ee.config.props[Ce]];s[15].populate(_e),r=s[15];const z={};z.letter="n-2",z.w=219,z.x=1377,z.direction="up",z.delay=350,g=z.is||"Letter";let Re;if(typeof g=="string"){if(Re=u.components&&u.components[g]||d[g],!Re)throw new Error('Component "Letter" not found')}else typeof g=="function"&&g.name==="factory"&&(Re=g);s[16]=Re.call(null,{props:z},s[15],i),s[16][Symbol.for("slots")][0]?(r=s[16][Symbol.for("slots")][0],i=s[16]):r=s[16][Symbol.for("children")][0];const Ae=u.components&&u.components.Letter||d.Letter;r=s[0];const oe={};if(s[17]=this.element({parent:r||"root"},i),oe.letter="g-2",oe.w=324,oe.x=1596,oe.direction="up",oe.delay=400,typeof Ae<"u")for(let Ce in Ae.config.props)delete oe[Ae.config.props[Ce]];s[17].populate(oe),r=s[17];const D={};D.letter="g-2",D.w=324,D.x=1596,D.direction="up",D.delay=400,g=D.is||"Letter";let me;if(typeof g=="string"){if(me=u.components&&u.components[g]||d[g],!me)throw new Error('Component "Letter" not found')}else typeof g=="function"&&g.name==="factory"&&(me=g);return s[18]=me.call(null,{props:D},s[17],i),s[18][Symbol.for("slots")][0]?(r=s[18][Symbol.for("slots")][0],i=s[18]):r=s[18][Symbol.for("children")][0],s},effects:[],context:{}}}),jk=et.Component("Toggle",{code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),M.w=100,M.h=50,M.y=5,M.color=i.bgColor,M.effects=[i.shader("radius",{radius:25})],s[0].populate(M);const A=u.components&&u.components.Circle||d.Circle;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),k.x={transition:i.on?0:50},k.size=50,typeof A<"u")for(let w in A.config.props)delete k[A.config.props[w]];s[1].populate(k),r=s[1];const b={};b.x={transition:i.on?0:50},b.size=50,b.color=i.primaryColor,g=b.is||"Circle";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "Circle" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);return s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0],s},effects:[function(r,i,u,d,y,x){i[0].set("color",r.bgColor)},function(r,i,u,d,y,x){i[0].set("effects",[r.shader("radius",{radius:25})])},function(r,i,u,d,y,x){i[1].set("x",{transition:r.on?0:50})},function(r,i,u,d,y,x){i[2][Symbol.for("props")].x={transition:r.on?0:50}},function(r,i,u,d,y,x){i[2][Symbol.for("props")].color=r.primaryColor}],context:{}},props:["bgColor","primaryColor","on"]}),Fk=et.Component("Bar",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.w={value:i.w,duration:i.duration},g.h={value:i.h,duration:i.duration},g.color=i.bgColor,g.x=i.index*(i.w+i.w/4),g.effects=[i.shader("radius",{radius:10})],s[0].populate(g),r=s[0];const M={};return s[1]=this.element({parent:r||"root"},i),M.w=i.w,M.y={transition:{value:i.h-i.innerH,duration:i.duration}},M.h={transition:{value:i.innerH,duration:i.duration}},M.color=i.primaryColor,M.effects=[i.shader("radius",{radius:10})],s[1].populate(M),s},effects:[function(r,i,u,d,y,x){i[0].set("w",{value:r.w,duration:r.duration})},function(r,i,u,d,y,x){i[0].set("h",{value:r.h,duration:r.duration})},function(r,i,u,d,y,x){i[0].set("color",r.bgColor)},function(r,i,u,d,y,x){i[0].set("x",r.index*(r.w+r.w/4))},function(r,i,u,d,y,x){i[0].set("effects",[r.shader("radius",{radius:10})])},function(r,i,u,d,y,x){i[1].set("w",r.w)},function(r,i,u,d,y,x){i[1].set("y",{transition:{value:r.h-r.innerH,duration:r.duration}})},function(r,i,u,d,y,x){i[1].set("h",{transition:{value:r.innerH,duration:r.duration}})},function(r,i,u,d,y,x){i[1].set("color",r.primaryColor)},function(r,i,u,d,y,x){i[1].set("effects",[r.shader("radius",{radius:10})])}],context:{}},props:["bgColor","primaryColor","height","index","size"],state(){return{h:200,innerH:0,duration:400}},hooks:{ready(){this.innerH=this.height}},computed:{w(){return this.size==="large"?110:72}},watch:{bgColor(){this.duration=1e-6,this.innerH=0,this.$setTimeout(()=>{this.duration=400,this.innerH=this.height},200)},size(){this.duration=1e-6,this.innerH=0,this.$setTimeout(()=>{this.duration=400,this.innerH=this.height},100)}}}),zk={color1:"#475569",color2:"#64748b",color3:"#cbd5e1",color4:"#38bdf8",bg:"#1e293b80"},Vk={color1:"#f8fafc",color2:"#e2e8f0",color3:"#1e293b",color4:"#0369a1",bg:"#f1f5f9"},Hk=et.Component("Theming",{components:{Bar:Fk,Toggle:jk},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),M.w=1920,M.h=1080,M.color={transition:i.colors.bg},s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.y=1020,A.x=1160,A.size=28,A.color=i.colors.color4,A.content='Use "up", "down", "left" and "right" to change the appearance',A.__textnode=!0,s[1].populate(A),r=s[0];const k={};s[2]=this.element({parent:r||"root"},i),k.x={transition:(1920-i.width)/2},k.y={transition:(1080-i.height)/2},s[2].populate(k),r=s[2];const b={};s[3]=this.element({parent:r||"root"},i),b.x=-250,b.y=-100,b.src="assets/shadow.png",b.w=1e3,b.h=900,b.alpha=.5,s[3].populate(b),r=s[2];const P={};s[4]=this.element({parent:r||"root"},i),P.w={transition:i.width},P.h={transition:i.height},P.color=i.colors.color1,P.effects=[i.shader("radius",{radius:i.radius})],s[4].populate(P),r=s[4];const w={};s[5]=this.element({parent:r||"root"},i),w.w={transition:i.width},w.h=100,w.color=i.colors.color2,w.effects=[i.shader("radius",{radius:i.radius})],s[5].populate(w),r=s[4];const R={};s[6]=this.element({parent:r||"root"},i),R.w={transition:i.width},R.h=80,R.y=20,R.color=i.colors.color2,s[6].populate(R),r=s[4];const B={};s[7]=this.element({parent:r||"root"},i),B.content=i.text,B.color=i.colors.color3,B.size=28,B.x=20,B.y=14,B.__textnode=!0,s[7].populate(B);const U=u.components&&u.components.Toggle||d.Toggle;r=s[4];const W={};if(s[8]=this.element({parent:r||"root"},i),W.x={transition:i.width-120},W.on=i.mode==="dark",W.bgColor=i.colors.color1,W.primaryColor="#22c55e",typeof U<"u")for(let me in U.config.props)delete W[U.config.props[me]];s[8].populate(W),r=s[8];const G={};G.x={transition:i.width-120},G.on=i.mode==="dark",G.bgColor=i.colors.color1,G.primaryColor="#22c55e",g=G.is||"Toggle";let Q;if(typeof g=="string"){if(Q=u.components&&u.components[g]||d[g],!Q)throw new Error('Component "Toggle" not found')}else typeof g=="function"&&g.name==="factory"&&(Q=g);s[9]=Q.call(null,{props:G},s[8],i),s[9][Symbol.for("slots")][0]?(r=s[9][Symbol.for("slots")][0],i=s[9]):r=s[9][Symbol.for("children")][0],r=s[2];const ee={};s[10]=this.element({parent:r||"root"},i),ee.w=200,ee.h={transition:i.block1.height},ee.x=25,ee.y=140,ee.color=i.colors.color2,ee.effects=[i.shader("radius",{radius:i.radius/2})],s[10].populate(ee),r=s[2];const Z={};s[11]=this.element({parent:r||"root"},i),Z.w={transition:i.block2.w},Z.h=i.block2.h,Z.x=270,Z.y={transition:i.block2.y},Z.color=i.colors.color2,Z.effects=[i.shader("radius",{radius:i.radius/2})],s[11].populate(Z),r=s[2];const H={};s[12]=this.element({parent:r||"root"},i),H.x={transition:i.graph.x},H.y={transition:i.graph.y},H.w=i.graph.w,H.h=i.graph.h,H.color="0x00000000",s[12].populate(H),r=s[12];const J={};s[13]=this.element({parent:r||"root"},i),J.x={transition:i.graph.offset},J.y={transition:i.graph.offset},s[13].populate(J);const fe=u.components&&u.components.Bar||d.Bar;r=s[13];const E={};if(s[14]=this.element({parent:r||"root"},i),E.bgColor=i.colors.color2,E.primaryColor=i.colors.color4,E.size=i.graph.size,E.height=100,E.index=0,typeof fe<"u")for(let me in fe.config.props)delete E[fe.config.props[me]];s[14].populate(E),r=s[14];const F={};F.bgColor=i.colors.color2,F.primaryColor=i.colors.color4,F.size=i.graph.size,F.height=100,F.index=0,g=F.is||"Bar";let re;if(typeof g=="string"){if(re=u.components&&u.components[g]||d[g],!re)throw new Error('Component "Bar" not found')}else typeof g=="function"&&g.name==="factory"&&(re=g);s[15]=re.call(null,{props:F},s[14],i),s[15][Symbol.for("slots")][0]?(r=s[15][Symbol.for("slots")][0],i=s[15]):r=s[15][Symbol.for("children")][0];const ye=u.components&&u.components.Bar||d.Bar;r=s[13];const ie={};if(s[16]=this.element({parent:r||"root"},i),ie.bgColor=i.colors.color2,ie.primaryColor=i.colors.color4,ie.size=i.graph.size,ie.height=140,ie.index=1,typeof ye<"u")for(let me in ye.config.props)delete ie[ye.config.props[me]];s[16].populate(ie),r=s[16];const se={};se.bgColor=i.colors.color2,se.primaryColor=i.colors.color4,se.size=i.graph.size,se.height=140,se.index=1,g=se.is||"Bar";let ne;if(typeof g=="string"){if(ne=u.components&&u.components[g]||d[g],!ne)throw new Error('Component "Bar" not found')}else typeof g=="function"&&g.name==="factory"&&(ne=g);s[17]=ne.call(null,{props:se},s[16],i),s[17][Symbol.for("slots")][0]?(r=s[17][Symbol.for("slots")][0],i=s[17]):r=s[17][Symbol.for("children")][0];const le=u.components&&u.components.Bar||d.Bar;r=s[13];const xe={};if(s[18]=this.element({parent:r||"root"},i),xe.bgColor=i.colors.color2,xe.primaryColor=i.colors.color4,xe.size=i.graph.size,xe.height=170,xe.index=2,typeof le<"u")for(let me in le.config.props)delete xe[le.config.props[me]];s[18].populate(xe),r=s[18];const we={};we.bgColor=i.colors.color2,we.primaryColor=i.colors.color4,we.size=i.graph.size,we.height=170,we.index=2,g=we.is||"Bar";let Te;if(typeof g=="string"){if(Te=u.components&&u.components[g]||d[g],!Te)throw new Error('Component "Bar" not found')}else typeof g=="function"&&g.name==="factory"&&(Te=g);s[19]=Te.call(null,{props:we},s[18],i),s[19][Symbol.for("slots")][0]?(r=s[19][Symbol.for("slots")][0],i=s[19]):r=s[19][Symbol.for("children")][0];const Ie=u.components&&u.components.Bar||d.Bar;r=s[13];const Ee={};if(s[20]=this.element({parent:r||"root"},i),Ee.bgColor=i.colors.color2,Ee.primaryColor=i.colors.color4,Ee.size=i.graph.size,Ee.height=150,Ee.index=3,typeof Ie<"u")for(let me in Ie.config.props)delete Ee[Ie.config.props[me]];s[20].populate(Ee),r=s[20];const _e={};_e.bgColor=i.colors.color2,_e.primaryColor=i.colors.color4,_e.size=i.graph.size,_e.height=150,_e.index=3,g=_e.is||"Bar";let z;if(typeof g=="string"){if(z=u.components&&u.components[g]||d[g],!z)throw new Error('Component "Bar" not found')}else typeof g=="function"&&g.name==="factory"&&(z=g);s[21]=z.call(null,{props:_e},s[20],i),s[21][Symbol.for("slots")][0]?(r=s[21][Symbol.for("slots")][0],i=s[21]):r=s[21][Symbol.for("children")][0];const Re=u.components&&u.components.Bar||d.Bar;r=s[13];const Ae={};if(s[22]=this.element({parent:r||"root"},i),Ae.bgColor=i.colors.color2,Ae.primaryColor=i.colors.color4,Ae.size=i.graph.size,Ae.height=90,Ae.index=4,typeof Re<"u")for(let me in Re.config.props)delete Ae[Re.config.props[me]];s[22].populate(Ae),r=s[22];const oe={};oe.bgColor=i.colors.color2,oe.primaryColor=i.colors.color4,oe.size=i.graph.size,oe.height=90,oe.index=4,g=oe.is||"Bar";let D;if(typeof g=="string"){if(D=u.components&&u.components[g]||d[g],!D)throw new Error('Component "Bar" not found')}else typeof g=="function"&&g.name==="factory"&&(D=g);return s[23]=D.call(null,{props:oe},s[22],i),s[23][Symbol.for("slots")][0]?(r=s[23][Symbol.for("slots")][0],i=s[23]):r=s[23][Symbol.for("children")][0],s},effects:[function(r,i,u,d,y,x){i[0].set("color",{transition:r.colors.bg})},function(r,i,u,d,y,x){i[1].set("color",r.colors.color4)},function(r,i,u,d,y,x){i[2].set("x",{transition:(1920-r.width)/2})},function(r,i,u,d,y,x){i[2].set("y",{transition:(1080-r.height)/2})},function(r,i,u,d,y,x){i[4].set("w",{transition:r.width})},function(r,i,u,d,y,x){i[4].set("h",{transition:r.height})},function(r,i,u,d,y,x){i[4].set("color",r.colors.color1)},function(r,i,u,d,y,x){i[4].set("effects",[r.shader("radius",{radius:r.radius})])},function(r,i,u,d,y,x){i[5].set("w",{transition:r.width})},function(r,i,u,d,y,x){i[5].set("color",r.colors.color2)},function(r,i,u,d,y,x){i[5].set("effects",[r.shader("radius",{radius:r.radius})])},function(r,i,u,d,y,x){i[6].set("w",{transition:r.width})},function(r,i,u,d,y,x){i[6].set("color",r.colors.color2)},function(r,i,u,d,y,x){i[7].set("content",r.text)},function(r,i,u,d,y,x){i[7].set("color",r.colors.color3)},function(r,i,u,d,y,x){i[8].set("x",{transition:r.width-120})},function(r,i,u,d,y,x){i[8].set("on",r.mode==="dark")},function(r,i,u,d,y,x){i[8].set("bgColor",r.colors.color1)},function(r,i,u,d,y,x){i[9][Symbol.for("props")].x={transition:r.width-120}},function(r,i,u,d,y,x){i[9][Symbol.for("props")].on=r.mode==="dark"},function(r,i,u,d,y,x){i[9][Symbol.for("props")].bgColor=r.colors.color1},function(r,i,u,d,y,x){i[10].set("h",{transition:r.block1.height})},function(r,i,u,d,y,x){i[10].set("color",r.colors.color2)},function(r,i,u,d,y,x){i[10].set("effects",[r.shader("radius",{radius:r.radius/2})])},function(r,i,u,d,y,x){i[11].set("w",{transition:r.block2.w})},function(r,i,u,d,y,x){i[11].set("h",r.block2.h)},function(r,i,u,d,y,x){i[11].set("y",{transition:r.block2.y})},function(r,i,u,d,y,x){i[11].set("color",r.colors.color2)},function(r,i,u,d,y,x){i[11].set("effects",[r.shader("radius",{radius:r.radius/2})])},function(r,i,u,d,y,x){i[12].set("x",{transition:r.graph.x})},function(r,i,u,d,y,x){i[12].set("y",{transition:r.graph.y})},function(r,i,u,d,y,x){i[12].set("w",r.graph.w)},function(r,i,u,d,y,x){i[12].set("h",r.graph.h)},function(r,i,u,d,y,x){i[13].set("x",{transition:r.graph.offset})},function(r,i,u,d,y,x){i[13].set("y",{transition:r.graph.offset})},function(r,i,u,d,y,x){i[14].set("bgColor",r.colors.color2)},function(r,i,u,d,y,x){i[14].set("primaryColor",r.colors.color4)},function(r,i,u,d,y,x){i[14].set("size",r.graph.size)},function(r,i,u,d,y,x){i[15][Symbol.for("props")].bgColor=r.colors.color2},function(r,i,u,d,y,x){i[15][Symbol.for("props")].primaryColor=r.colors.color4},function(r,i,u,d,y,x){i[15][Symbol.for("props")].size=r.graph.size},function(r,i,u,d,y,x){i[16].set("bgColor",r.colors.color2)},function(r,i,u,d,y,x){i[16].set("primaryColor",r.colors.color4)},function(r,i,u,d,y,x){i[16].set("size",r.graph.size)},function(r,i,u,d,y,x){i[17][Symbol.for("props")].bgColor=r.colors.color2},function(r,i,u,d,y,x){i[17][Symbol.for("props")].primaryColor=r.colors.color4},function(r,i,u,d,y,x){i[17][Symbol.for("props")].size=r.graph.size},function(r,i,u,d,y,x){i[18].set("bgColor",r.colors.color2)},function(r,i,u,d,y,x){i[18].set("primaryColor",r.colors.color4)},function(r,i,u,d,y,x){i[18].set("size",r.graph.size)},function(r,i,u,d,y,x){i[19][Symbol.for("props")].bgColor=r.colors.color2},function(r,i,u,d,y,x){i[19][Symbol.for("props")].primaryColor=r.colors.color4},function(r,i,u,d,y,x){i[19][Symbol.for("props")].size=r.graph.size},function(r,i,u,d,y,x){i[20].set("bgColor",r.colors.color2)},function(r,i,u,d,y,x){i[20].set("primaryColor",r.colors.color4)},function(r,i,u,d,y,x){i[20].set("size",r.graph.size)},function(r,i,u,d,y,x){i[21][Symbol.for("props")].bgColor=r.colors.color2},function(r,i,u,d,y,x){i[21][Symbol.for("props")].primaryColor=r.colors.color4},function(r,i,u,d,y,x){i[21][Symbol.for("props")].size=r.graph.size},function(r,i,u,d,y,x){i[22].set("bgColor",r.colors.color2)},function(r,i,u,d,y,x){i[22].set("primaryColor",r.colors.color4)},function(r,i,u,d,y,x){i[22].set("size",r.graph.size)},function(r,i,u,d,y,x){i[23][Symbol.for("props")].bgColor=r.colors.color2},function(r,i,u,d,y,x){i[23][Symbol.for("props")].primaryColor=r.colors.color4},function(r,i,u,d,y,x){i[23][Symbol.for("props")].size=r.graph.size}],context:{}},state(){return{mode:"dark",radius:20,width:500,height:600}},computed:{colors(){return this.mode==="dark"?zk:Vk},text(){return this.mode==="dark"?"Dark mode":"Light mode"},block1(){return{height:this.height===600?180:720}},block2(){return{y:this.height===600?140:560,h:this.height===600?180:300,w:this.height===600?200:890}},graph(){return{x:this.height===600?32:270,y:this.height===600?370:140,w:this.height===600?0:890,h:this.height===600?0:400,offset:this.height===600?0:110,size:this.height===600?"small":"large"}}},input:{right(){this.toggleX=0,this.$setTimeout(()=>{this.mode="light"},150)},left(){this.toggleX=48,this.$setTimeout(()=>{this.mode="dark"},150)},up(){this.width=1200,this.height=900},down(){this.width=500,this.height=600}}}),$k="ABC123",Gk="https://8b4fa39d.lightningjs.workers.dev";let U2,B2;const Wk="w185",Xk={headers:{"Content-Type":"application/json",Authorization:"Bearer "+$k}};function Kx(h,r=Wk){return B2+r+h}function Kk(...h){return U2?mp(...h):j2().then(()=>mp(...h))}function mp(h,r={}){return fetch(Gk+h,{...Xk,...r}).then(i=>i.json())}function j2(){return mp("/configuration").then(h=>(U2=h,B2=h.images.secure_base_url,h))}const Ap={get:Kk,loadConfig:j2},Yx=h=>Ap.get(`/${h}/popular`).then(F2),F2=h=>h.results.filter(i=>!i.adult).map(i=>({poster:Kx(i.poster_path||i.profile_path),background:Kx(i.backdrop_path,"w1280"),identifier:i.id,title:i.title||i.name,overview:i.overview})),ka=h=>{const r=Array.isArray(h)?h:[h];return Yk("movie").then(({genres:i})=>{let u=[];return i.forEach(d=>{r.includes(d.name)&&u.push(d.id)}),Ap.get(`/discover/movie?with_genres=${u.join()}`).then(F2)})},Yk=h=>Ap.get(`/genre/${h}/list`),qk=et.Component("Poster",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.w=1280,g.h=720,g.x=i.x,g.src=i.item.background,g.color="{top: '0xffffffff', bottom: '0x000000ff'}",g.scale={transition:{value:i.scale,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},g._effects=[i.shader("radius",{radius:8})],s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.alpha={transition:{value:i.alpha,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},s[1].populate(M),r=s[1];const A={};s[2]=this.element({parent:r||"root"},i),A.w=185,A.h=278,A.x=54,A.y=220,A.src=i.item.poster,s[2].populate(A),r=s[1];const k={};s[3]=this.element({parent:r||"root"},i),k.content=i.item.title,k.font="raleway",k.y=520,k.x=54,k.size=64,k.wordwrap=1e3,k.maxlines=1,k.__textnode=!0,s[3].populate(k),r=s[1];const b={};return s[4]=this.element({parent:r||"root"},i),b.content=i.item.overview,b.size=21,b.y=620,b.x=60,b.color="0xccccccff",b.wordwrap=1e3,b.maxlines=2,b.lineheight=36,b.__textnode=!0,s[4].populate(b),s},effects:[function(r,i,u,d,y,x){i[0].set("src",r.item.background)},function(r,i,u,d,y,x){i[0].set("scale",{transition:{value:r.scale,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,i,u,d,y,x){i[0].set("_effects",[r.shader("radius",{radius:8})])},function(r,i,u,d,y,x){i[1].set("alpha",{transition:{value:r.alpha,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,i,u,d,y,x){i[2].set("src",r.item.poster)},function(r,i,u,d,y,x){i[3].set("content",r.item.title)},function(r,i,u,d,y,x){i[4].set("content",r.item.overview)}],context:{}},props:["src","index","item","width"],state(){return{scale:1,zIndex:1,alpha:0}},computed:{x(){return this.index*this.width}},hooks:{focus(){this.scale=1.1,this.alpha=1},unfocus(){this.scale=1,this.alpha=0}}}),Qk=et.Component("Poster",{code:{render:function(r,i,u,d,y,x){const s=[],g={};return s[0]=this.element({parent:r||"root"},i),g.w=185,g.h=278,g.x=i.x,g.src=i.item.poster,g.scale={transition:{value:i.scale,duration:200,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},g._effects=[i.shader("radius",{radius:8})],s[0].populate(g),s},effects:[function(r,i,u,d,y,x){i[0].set("src",r.item.poster)},function(r,i,u,d,y,x){i[0].set("scale",{transition:{value:r.scale,duration:200,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,i,u,d,y,x){i[0].set("_effects",[r.shader("radius",{radius:8})])}],context:{}},props:["src","index","item","width"],state(){return{scale:1,color:"#333"}},computed:{x(){return this.index*this.width}},hooks:{focus(){this.color="#fff",this.scale=1.1},unfocus(){this.color="#333",this.scale=1}}}),Zk=et.Component("PosterTitle",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.w=185,g.h=278,g.x=i.x,g.src=i.item.poster,g.scale={transition:{value:i.scale,duration:200,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},g._effects=[i.shader("radius",{radius:8})],s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.x=10,M.y={transition:{value:i.y,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},M.alpha={transition:{value:i.alpha,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},s[1].populate(M),r=s[1];const A={};return s[2]=this.element({parent:r||"root"},i),A.content=i.item.title,A.font="raleway",A.size=22,A.wordwrap=185,A.maxlines=2,A.lineheight=28,A.__textnode=!0,s[2].populate(A),s},effects:[function(r,i,u,d,y,x){i[0].set("src",r.item.poster)},function(r,i,u,d,y,x){i[0].set("scale",{transition:{value:r.scale,duration:200,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,i,u,d,y,x){i[0].set("_effects",[r.shader("radius",{radius:8})])},function(r,i,u,d,y,x){i[1].set("y",{transition:{value:r.y,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,i,u,d,y,x){i[1].set("alpha",{transition:{value:r.alpha,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,i,u,d,y,x){i[2].set("content",r.item.title)}],context:{}},props:["src","index","item","width"],state(){return{scale:1,alpha:0,y:278}},computed:{x(){return this.index*this.width}},hooks:{focus(){this.scale=1.1,this.alpha=1,this.y=288},unfocus(){this.scale=1,this.alpha=0,this.y=278}}}),Jk=et.Component("TmdbRow",{components:{Hero:qk,Poster:Qk,PosterTitle:Zk},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.x={transition:{value:i.x,duration:300,easing:"ease-in-out"}},A.y=80,s[1].populate(A),r=s[1];const k=[],b=(P=[],w,R)=>{const B=x(P),U=new Set(B.map(Q=>""+Q.identifier));let W=R.length;for(;W--;){const Q=R[W];U.has(Q)||(w[2][Q]&&w[2][Q].destroy(),delete w[2][Q],w[3][Q]&&w[3][Q].destroy(),delete w[3][Q])}R.length=0;const G=P.length;for(let Q=0;Q<G;Q++){const ee=Object.create(i);r=w[1],ee.index=Q,ee.item=B[Q],ee.key=ee.item.identifier,ee.__ref="poster"+Q,R.push(ee.key);const Z=u.components&&u.components.Component||d.Component;w[2]===void 0&&(w[2]={});const H={};if(w[2][ee.key]||(w[2][ee.key]=this.element({parent:r||"root"},i)),H.is=ee.type,H.index=ee.index,H.item=ee.item,H.ref=ee.__ref,H.width=ee.width,typeof Z<"u")for(let fe in Z.config.props)delete H[Z.config.props[fe]];w[2][ee.key].nodeId||w[2][ee.key].populate(H),w[3]===void 0&&(w[3]={}),r=w[2][ee.key];const J={};if(J.is=ee.type,J.index=ee.index,J.item=ee.item,J.ref=ee.__ref,J.width=ee.width,!w[3][ee.key]){g=J.is||"Component";let fe;if(typeof g=="string"){if(fe=u.components&&u.components[g]||d[g],!fe)throw new Error('Component "Component" not found')}else typeof g=="function"&&g.name==="factory"&&(fe=g);w[3][ee.key]=fe.call(null,{props:J},w[2][ee.key],i),w[3][ee.key][Symbol.for("slots")][0]?(r=w[3][ee.key][Symbol.for("slots")][0],i=w[3][ee.key]):r=w[3][ee.key][Symbol.for("children")][0]}ee.item=P[Q],w[2][0]&&w[2][0].forComponent&&w[2][0].forComponent.___layout&&w[2][0].forComponent.___layout()}};return y(()=>{b(i.items,s,k)},"items"),s},effects:[function(r,i,u,d,y,x){i[1].set("x",{transition:{value:r.x,duration:300,easing:"ease-in-out"}})}],context:{}},props:["title","type","items","width"],state(){return{focused:0,offset:0}},hooks:{focus(){this.trigger("focused")}},computed:{x(){return 150-Math.min(this.focused,this.items.length-1720/this.width)*this.width}},watch:{focused(h){const r=this.select("poster"+h);r&&r.focus&&(r.focus(),this.$emit("posterSelect",this.items[h]))}},input:{left(){this.focused=Math.max(this.focused-1,0)},right(){this.focused=Math.min(this.focused+1,this.items.length-1)}}}),eM=et.Component("Background",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.src=i.bg1,M.w=1920,M.h=1080,M.color="{top: '0xffffffff', bottom: '0x000000ff'}",M.alpha={transition:{value:i.alpha1,duration:400,easing:"ease-in"}},s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.src=i.bg2,A.w=1920,A.h=1080,A.color="{top: '0xffffffff', bottom: '0x000000ff'}",A.alpha={transition:{value:i.alpha2,duration:400,easing:"ease-in"}},s[2].populate(A),r=s[0];const k={};return s[3]=this.element({parent:r||"root"},i),k.w=1920,k.h=1080,k.src="assets/gradient.png",k.color="0x8866ddff",k.alpha=.8,s[3].populate(k),s},effects:[function(r,i,u,d,y,x){i[1].set("src",r.bg1)},function(r,i,u,d,y,x){i[1].set("alpha",{transition:{value:r.alpha1,duration:400,easing:"ease-in"}})},function(r,i,u,d,y,x){i[2].set("src",r.bg2)},function(r,i,u,d,y,x){i[2].set("alpha",{transition:{value:r.alpha2,duration:400,easing:"ease-in"}})}],context:{}},props:["src"],state(){return{counter:0,alpha1:0,alpha2:0,bg1:!1,bg2:!1}},watch:{src(h){this.counter=(this.counter+1)%2,this.counter===0?(this.bg1=h,this.alpha1=.8,this.alpha2=0):(this.bg2=h,this.alpha1=0,this.alpha2=.8)}}}),tM=et.Component("TMdb",{components:{Background:eM,TmdbRow:Jk},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),M.w=1920,M.h=1080,M.color="0x000000ff",s[0].populate(M);const A=u.components&&u.components.Background||d.Background;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),k.src=i.src,typeof A<"u")for(let Z in A.config.props)delete k[A.config.props[Z]];s[1].populate(k),r=s[1];const b={};b.src=i.src,g=b.is||"Background";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "Background" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0],r=s[0];const w={};s[3]=this.element({parent:r||"root"},i),s[3].populate(w),r=s[3];const R={};s[4]=this.element({parent:r||"root"},i),R.y={transition:{value:i.contentY,duration:i.duration}},R.alpha={transition:{value:i.alpha,duration:i.duration}},s[4].populate(R),r=s[4];const B={};s[5]=this.element({parent:r||"root"},i),B.src="assets/logo.png",B.x=140,B.y=90,B.w=243,B.h=52,s[5].populate(B),r=s[4];const U={};s[6]=this.element({parent:r||"root"},i),U.content=i.title,U.font="raleway",U.size=80,U.x=140,U.y=300,U.wordwrap=1e3,U["@loaded"]=i.positionText&&i.positionText.bind(i),U.maxlines=1,U.__textnode=!0,s[6].populate(U),r=s[4];const W={};s[7]=this.element({parent:r||"root"},i),W.content=i.overview,W.wordwrap=880,W.x=140,W.y=430,W.lineheight=40,W.maxlines=3,W.__textnode=!0,s[7].populate(W),r=s[3];const G={};s[8]=this.element({parent:r||"root"},i),G.y={transition:{value:i.y,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},s[8].populate(G),r=s[8];const Q=[],ee=(Z=[],H,J)=>{const fe=x(Z),E=new Set(fe.map(ye=>""+ye.title));let F=J.length;for(;F--;){const ye=J[F];E.has(ye)||(H[9][ye]&&H[9][ye].destroy(),delete H[9][ye],H[10][ye]&&H[10][ye].destroy(),delete H[10][ye])}J.length=0;const re=Z.length;for(let ye=0;ye<re;ye++){const ie=Object.create(i);r=H[8],ie.index=ye,ie.row=fe[ye],ie.key=ie.row.title,ie.__ref="row"+ye,J.push(ie.key);const se=u.components&&u.components.TmdbRow||d.TmdbRow;H[9]===void 0&&(H[9]={});const ne={};if(H[9][ie.key]||(H[9][ie.key]=this.element({parent:r||"root"},i)),ne.title=ie.row.title,ne.items=ie.row.items,ne.type=ie.row.type,ne.width=ie.row.width,ne.y=ie.row.y,ne.ref=ie.__ref,typeof se<"u")for(let xe in se.config.props)delete ne[se.config.props[xe]];H[9][ie.key].nodeId||H[9][ie.key].populate(ne),H[10]===void 0&&(H[10]={}),r=H[9][ie.key];const le={};if(le.title=ie.row.title,le.items=ie.row.items,le.type=ie.row.type,le.width=ie.row.width,le.y=ie.row.y,le.ref=ie.__ref,!H[10][ie.key]){g=le.is||"TmdbRow";let xe;if(typeof g=="string"){if(xe=u.components&&u.components[g]||d[g],!xe)throw new Error('Component "TmdbRow" not found')}else typeof g=="function"&&g.name==="factory"&&(xe=g);H[10][ie.key]=xe.call(null,{props:le},H[9][ie.key],i),H[10][ie.key][Symbol.for("slots")][0]?(r=H[10][ie.key][Symbol.for("slots")][0],i=H[10][ie.key]):r=H[10][ie.key][Symbol.for("children")][0]}ie.row=Z[ye],y(()=>{H[9][ie.key].set("items",ie.row.items)},null),y(()=>{H[9][ie.key].set("type",ie.row.type)},null),y(()=>{H[9][ie.key].set("width",ie.row.width)},null),y(()=>{H[10][ie.key][Symbol.for("props")].items=ie.row.items},null),y(()=>{H[10][ie.key][Symbol.for("props")].type=ie.row.type},null),y(()=>{H[10][ie.key][Symbol.for("props")].width=ie.row.width},null),H[9][0]&&H[9][0].forComponent&&H[9][0].forComponent.___layout&&H[9][0].forComponent.___layout()}};return y(()=>{ee(i.rows,s,Q)},"rows"),s},effects:[function(r,i,u,d,y,x){i[1].set("src",r.src)},function(r,i,u,d,y,x){i[2][Symbol.for("props")].src=r.src},function(r,i,u,d,y,x){i[4].set("y",{transition:{value:r.contentY,duration:r.duration}})},function(r,i,u,d,y,x){i[4].set("alpha",{transition:{value:r.alpha,duration:r.duration}})},function(r,i,u,d,y,x){i[6].set("content",r.title)},function(r,i,u,d,y,x){i[7].set("content",r.overview)},function(r,i,u,d,y,x){i[8].set("y",{transition:{value:r.y,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})}],context:{}},state(){return{rows:[],items:[],src:"",focused:null,alpha:1,y:550,contentY:0,scale:1,title:"",overview:"",type:"Poster",duration:300}},watch:{focused(h){const r=this.select("row"+h);r&&r.focus&&r.focus()}},hooks:{async ready(){this.$listen("posterSelect",h=>{this.focused===0&&(this.src=h.background,this.title=h.title,this.overview=h.overview)}),this.rows.push({title:"Popular Movies",items:await Yx("movie"),type:"Poster",width:215,y:0}),this.rows.push({title:"Best Western movies",items:await ka(["Western"]),type:"Hero",width:1370,y:358}),this.rows.push({title:"Best Comedy movies",items:await ka(["Comedy"]),type:"PosterTitle",width:215,y:1158}),this.rows.push({title:"Popular TV shows",items:await Yx("tv"),type:"PosterTitle",width:215,y:1536}),this.rows.push({title:"Best Adventure and Action movies",items:await ka(["adventure","action"]),type:"Hero",width:1370,y:1914}),this.rows.push({title:"Best Documentaries",items:await ka("Documentary"),type:"PosterTitle",width:215,y:2714}),this.rows.push({title:"Best Western movies 2",items:await ka("Western"),type:"PosterTitle",width:215,y:3092}),this.focused=0},focus(){this.trigger("focused")}},input:{up(){this.contentY=0,this.duration=300,this.focused=Math.max(this.focused-1,0),this.y=(this.focused===0?550:90)-this.rows[this.focused].y,this.alpha=this.focused===0?1:0},down(){this.contentY=-60,this.duration=200,this.focused=Math.min(this.focused+1,this.rows.length-1),this.y=(this.focused===0?550:90)-this.rows[this.focused].y,this.alpha=this.focused===0?1:0}}}),nM=et.Component("MenuSprite",{code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.src="assets/menusprite.png",A.x=748,A.y=120,A.w=425,A.h=340,s[1].populate(A),r=s[0];const k={};s[2]=this.element({parent:r||"root"},i),k.y=680,k.x=560,s[2].populate(k);const b=u.components&&u.components.Sprite||d.Sprite;r=s[2];const P={};if(s[3]=this.element({parent:r||"root"},i),P.image="assets/menusprite.png",P.x=0,P.w=140,P.h=140,P.map=i.map,P.frame=i.icon1,typeof b<"u")for(let re in b.config.props)delete P[b.config.props[re]];s[3].populate(P),r=s[3];const w={};w.image="assets/menusprite.png",w.x=0,w.w=140,w.h=140,w.map=i.map,w.frame=i.icon1,g=w.is||"Sprite";let R;if(typeof g=="string"){if(R=u.components&&u.components[g]||d[g],!R)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(R=g);s[4]=R.call(null,{props:w},s[3],i),s[4][Symbol.for("slots")][0]?(r=s[4][Symbol.for("slots")][0],i=s[4]):r=s[4][Symbol.for("children")][0];const B=u.components&&u.components.Sprite||d.Sprite;r=s[2];const U={};if(s[5]=this.element({parent:r||"root"},i),U.image="assets/menusprite.png",U.x=220,U.w=140,U.h=140,U.map=i.map,U.frame="icon2",typeof B<"u")for(let re in B.config.props)delete U[B.config.props[re]];s[5].populate(U),r=s[5];const W={};W.image="assets/menusprite.png",W.x=220,W.w=140,W.h=140,W.map=i.map,W.frame="icon2",g=W.is||"Sprite";let G;if(typeof g=="string"){if(G=u.components&&u.components[g]||d[g],!G)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(G=g);s[6]=G.call(null,{props:W},s[5],i),s[6][Symbol.for("slots")][0]?(r=s[6][Symbol.for("slots")][0],i=s[6]):r=s[6][Symbol.for("children")][0];const Q=u.components&&u.components.Sprite||d.Sprite;r=s[2];const ee={};if(s[7]=this.element({parent:r||"root"},i),ee.image="assets/menusprite.png",ee.x=440,ee.w=140,ee.h=140,ee.map=i.map,ee.frame="icon3",typeof Q<"u")for(let re in Q.config.props)delete ee[Q.config.props[re]];s[7].populate(ee),r=s[7];const Z={};Z.image="assets/menusprite.png",Z.x=440,Z.w=140,Z.h=140,Z.map=i.map,Z.frame="icon3",g=Z.is||"Sprite";let H;if(typeof g=="string"){if(H=u.components&&u.components[g]||d[g],!H)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(H=g);s[8]=H.call(null,{props:Z},s[7],i),s[8][Symbol.for("slots")][0]?(r=s[8][Symbol.for("slots")][0],i=s[8]):r=s[8][Symbol.for("children")][0];const J=u.components&&u.components.Sprite||d.Sprite;r=s[2];const fe={};if(s[9]=this.element({parent:r||"root"},i),fe.image="assets/menusprite.png",fe.x=660,fe.w=140,fe.h=140,fe.map=i.map,fe.frame="icon4_unfocus",typeof J<"u")for(let re in J.config.props)delete fe[J.config.props[re]];s[9].populate(fe),r=s[9];const E={};E.image="assets/menusprite.png",E.x=660,E.w=140,E.h=140,E.map=i.map,E.frame="icon4_unfocus",g=E.is||"Sprite";let F;if(typeof g=="string"){if(F=u.components&&u.components[g]||d[g],!F)throw new Error('Component "Sprite" not found')}else typeof g=="function"&&g.name==="factory"&&(F=g);return s[10]=F.call(null,{props:E},s[9],i),s[10][Symbol.for("slots")][0]?(r=s[10][Symbol.for("slots")][0],i=s[10]):r=s[10][Symbol.for("children")][0],s},effects:[function(r,i,u,d,y,x){i[3].set("frame",r.icon1)},function(r,i,u,d,y,x){i[4][Symbol.for("props")].frame=r.icon1}],context:{}},state(){return{icon1:"icon1_unfocus",map:{defaults:{w:160,h:160},frames:{icon1_focus:{x:0,y:0},icon1_unfocus:{x:170,y:340},icon2:{x:170,y:0},icon3:{x:350,y:0},icon4_unfocus:{x:680,y:170}}}}},hooks:{ready(){this.$setInterval(()=>{this.icon1=this.icon1==="icon1_unfocus"?"icon1_focus":"icon1_unfocus"},2e3)}}}),pf=["menu"],iM=et.Component("Sprites",{components:{MenuSprite:nM},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M);const A=u.components&&u.components.MenuSprite||d.MenuSprite;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),k.show=i.currentSprite==="menu",typeof A<"u")for(let w in A.config.props)delete k[A.config.props[w]];s[1].populate(k),r=s[1];const b={};b.show=i.currentSprite==="menu",g=b.is||"MenuSprite";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "MenuSprite" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);return s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0],s},effects:[function(r,i,u,d,y,x){i[1].set("show",r.currentSprite==="menu")},function(r,i,u,d,y,x){i[2][Symbol.for("props")].show=r.currentSprite==="menu"}],context:{}},state(){return{currentSprite:"menu"}},input:{down(){const h=pf.indexOf(this.currentSprite);h<pf.length-1?this.currentSprite=pf[h+1]:this.currentSprite=pf[0]}}}),Nf=et.Component("Button",{code:{render:function(r,i,u,d,y,x){const s=[],g={};return s[0]=this.element({parent:r||"root"},i),g.w=300,g.h=80,g.color=i.color||"0xff0000ff",g.effects=[i.shader("radius",{radius:20})],g.alpha={transition:i.alpha},g.scale={transition:i.scale},g.z=i.zIndex,g.rotation=i.rotate,s[0].populate(g),s},effects:[function(r,i,u,d,y,x){i[0].set("effects",[r.shader("radius",{radius:20})])},function(r,i,u,d,y,x){i[0].set("alpha",{transition:r.alpha})},function(r,i,u,d,y,x){i[0].set("scale",{transition:r.scale})},function(r,i,u,d,y,x){i[0].set("z",r.zIndex)},function(r,i,u,d,y,x){i[0].set("rotation",r.rotate)}],context:{}},props:["color"],state(){return{alpha:.4,scale:1,zIndex:1,rotate:0}},hooks:{focus(){this.$log.info(`Button with color ${this.color} received focus`),this.alpha=1,this.scale=this.scale===1?1.2:1,this.zIndex=100},unfocus(){this.$log.info(`Button with color ${this.color} lost focus`),this.alpha=.4,this.scale=1,this.zIndex=1,this.rotate=0}},input:{enter(){this.rotate=this.rotate===0?-4:0,this.scale=this.scale===1.2?1.3:1.2}}}),oM=et.Component("Menu",{components:{Button:Nf},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),M.x={transition:i.x},M.w=400,M.h=1080,M.color="{right: '0x64748baa', left: '0x475569aa'}",s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.x=50,A.y=40,s[1].populate(A);const k=u.components&&u.components.Button||d.Button;r=s[1];const b={};if(s[2]=this.element({parent:r||"root"},i),b.color="0xe4e4e7ff",b.ref="menu1",typeof k<"u")for(let F in k.config.props)delete b[k.config.props[F]];s[2].populate(b),r=s[2];const P={};P.color="0xe4e4e7ff",P.ref="menu1",g=P.is||"Button";let w;if(typeof g=="string"){if(w=u.components&&u.components[g]||d[g],!w)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(w=g);s[3]=w.call(null,{props:P},s[2],i),s[3][Symbol.for("slots")][0]?(r=s[3][Symbol.for("slots")][0],i=s[3]):r=s[3][Symbol.for("children")][0];const R=u.components&&u.components.Button||d.Button;r=s[1];const B={};if(s[4]=this.element({parent:r||"root"},i),B.color="0xe4e4e7ff",B.y=100,B.ref="menu2",typeof R<"u")for(let F in R.config.props)delete B[R.config.props[F]];s[4].populate(B),r=s[4];const U={};U.color="0xe4e4e7ff",U.y=100,U.ref="menu2",g=U.is||"Button";let W;if(typeof g=="string"){if(W=u.components&&u.components[g]||d[g],!W)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(W=g);s[5]=W.call(null,{props:U},s[4],i),s[5][Symbol.for("slots")][0]?(r=s[5][Symbol.for("slots")][0],i=s[5]):r=s[5][Symbol.for("children")][0];const G=u.components&&u.components.Button||d.Button;r=s[1];const Q={};if(s[6]=this.element({parent:r||"root"},i),Q.color="0xe4e4e7ff",Q.y=200,Q.ref="menu3",typeof G<"u")for(let F in G.config.props)delete Q[G.config.props[F]];s[6].populate(Q),r=s[6];const ee={};ee.color="0xe4e4e7ff",ee.y=200,ee.ref="menu3",g=ee.is||"Button";let Z;if(typeof g=="string"){if(Z=u.components&&u.components[g]||d[g],!Z)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(Z=g);s[7]=Z.call(null,{props:ee},s[6],i),s[7][Symbol.for("slots")][0]?(r=s[7][Symbol.for("slots")][0],i=s[7]):r=s[7][Symbol.for("children")][0];const H=u.components&&u.components.Button||d.Button;r=s[1];const J={};if(s[8]=this.element({parent:r||"root"},i),J.color="0xe4e4e7ff",J.y=300,J.ref="menu4",typeof H<"u")for(let F in H.config.props)delete J[H.config.props[F]];s[8].populate(J),r=s[8];const fe={};fe.color="0xe4e4e7ff",fe.y=300,fe.ref="menu4",g=fe.is||"Button";let E;if(typeof g=="string"){if(E=u.components&&u.components[g]||d[g],!E)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(E=g);return s[9]=E.call(null,{props:fe},s[8],i),s[9][Symbol.for("slots")][0]?(r=s[9][Symbol.for("slots")][0],i=s[9]):r=s[9][Symbol.for("children")][0],s},effects:[function(r,i,u,d,y,x){i[0].set("x",{transition:r.x})}],context:{}},state(){return{x:-360,focused:1}},hooks:{focus(){this.trigger("focused"),this.x=0}},watch:{focused(){const h=this.select(`menu${this.focused}`);h&&h.focus&&h.focus()}},input:{right(){this.parent.focus(),this.x=-360},down(){this.focused=Math.min(this.focused+1,4)},up(){this.focused=Math.max(this.focused-1,1)},left(){}}}),rM=et.Component("FocusHandling",{components:{Menu:oM,Button:Nf},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.x=300,A.y=150,s[1].populate(A);const k=u.components&&u.components.Button||d.Button;r=s[1];const b={};if(s[2]=this.element({parent:r||"root"},i),b.color="0xef4444ff",b.x=0,b.ref="button1",typeof k<"u")for(let $ in k.config.props)delete b[k.config.props[$]];s[2].populate(b),r=s[2];const P={};P.color="0xef4444ff",P.x=0,P.ref="button1",g=P.is||"Button";let w;if(typeof g=="string"){if(w=u.components&&u.components[g]||d[g],!w)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(w=g);s[3]=w.call(null,{props:P},s[2],i),s[3][Symbol.for("slots")][0]?(r=s[3][Symbol.for("slots")][0],i=s[3]):r=s[3][Symbol.for("children")][0];const R=u.components&&u.components.Button||d.Button;r=s[1];const B={};if(s[4]=this.element({parent:r||"root"},i),B.color="0xf97316ff",B.x=320,B.ref="button2",typeof R<"u")for(let $ in R.config.props)delete B[R.config.props[$]];s[4].populate(B),r=s[4];const U={};U.color="0xf97316ff",U.x=320,U.ref="button2",g=U.is||"Button";let W;if(typeof g=="string"){if(W=u.components&&u.components[g]||d[g],!W)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(W=g);s[5]=W.call(null,{props:U},s[4],i),s[5][Symbol.for("slots")][0]?(r=s[5][Symbol.for("slots")][0],i=s[5]):r=s[5][Symbol.for("children")][0];const G=u.components&&u.components.Button||d.Button;r=s[1];const Q={};if(s[6]=this.element({parent:r||"root"},i),Q.color="0x84cc16ff",Q.x=640,Q.ref="button3",typeof G<"u")for(let $ in G.config.props)delete Q[G.config.props[$]];s[6].populate(Q),r=s[6];const ee={};ee.color="0x84cc16ff",ee.x=640,ee.ref="button3",g=ee.is||"Button";let Z;if(typeof g=="string"){if(Z=u.components&&u.components[g]||d[g],!Z)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(Z=g);s[7]=Z.call(null,{props:ee},s[6],i),s[7][Symbol.for("slots")][0]?(r=s[7][Symbol.for("slots")][0],i=s[7]):r=s[7][Symbol.for("children")][0];const H=u.components&&u.components.Button||d.Button;r=s[1];const J={};if(s[8]=this.element({parent:r||"root"},i),J.color="0x10b981ff",J.x=0,J.y=100,J.ref="button4",typeof H<"u")for(let $ in H.config.props)delete J[H.config.props[$]];s[8].populate(J),r=s[8];const fe={};fe.color="0x10b981ff",fe.x=0,fe.y=100,fe.ref="button4",g=fe.is||"Button";let E;if(typeof g=="string"){if(E=u.components&&u.components[g]||d[g],!E)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(E=g);s[9]=E.call(null,{props:fe},s[8],i),s[9][Symbol.for("slots")][0]?(r=s[9][Symbol.for("slots")][0],i=s[9]):r=s[9][Symbol.for("children")][0];const F=u.components&&u.components.Button||d.Button;r=s[1];const re={};if(s[10]=this.element({parent:r||"root"},i),re.color="0x06b6d4ff",re.y=100,re.x=320,re.ref="button5",typeof F<"u")for(let $ in F.config.props)delete re[F.config.props[$]];s[10].populate(re),r=s[10];const ye={};ye.color="0x06b6d4ff",ye.y=100,ye.x=320,ye.ref="button5",g=ye.is||"Button";let ie;if(typeof g=="string"){if(ie=u.components&&u.components[g]||d[g],!ie)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(ie=g);s[11]=ie.call(null,{props:ye},s[10],i),s[11][Symbol.for("slots")][0]?(r=s[11][Symbol.for("slots")][0],i=s[11]):r=s[11][Symbol.for("children")][0];const se=u.components&&u.components.Button||d.Button;r=s[1];const ne={};if(s[12]=this.element({parent:r||"root"},i),ne.color="0x3b82f6ff",ne.y=100,ne.x=640,ne.ref="button6",typeof se<"u")for(let $ in se.config.props)delete ne[se.config.props[$]];s[12].populate(ne),r=s[12];const le={};le.color="0x3b82f6ff",le.y=100,le.x=640,le.ref="button6",g=le.is||"Button";let xe;if(typeof g=="string"){if(xe=u.components&&u.components[g]||d[g],!xe)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(xe=g);s[13]=xe.call(null,{props:le},s[12],i),s[13][Symbol.for("slots")][0]?(r=s[13][Symbol.for("slots")][0],i=s[13]):r=s[13][Symbol.for("children")][0];const we=u.components&&u.components.Button||d.Button;r=s[1];const Te={};if(s[14]=this.element({parent:r||"root"},i),Te.color="0x8b5cf6ff",Te.y=200,Te.x=0,Te.ref="button7",typeof we<"u")for(let $ in we.config.props)delete Te[we.config.props[$]];s[14].populate(Te),r=s[14];const Ie={};Ie.color="0x8b5cf6ff",Ie.y=200,Ie.x=0,Ie.ref="button7",g=Ie.is||"Button";let Ee;if(typeof g=="string"){if(Ee=u.components&&u.components[g]||d[g],!Ee)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(Ee=g);s[15]=Ee.call(null,{props:Ie},s[14],i),s[15][Symbol.for("slots")][0]?(r=s[15][Symbol.for("slots")][0],i=s[15]):r=s[15][Symbol.for("children")][0];const _e=u.components&&u.components.Button||d.Button;r=s[1];const z={};if(s[16]=this.element({parent:r||"root"},i),z.color="0xd946efff",z.y=200,z.x=320,z.ref="button8",typeof _e<"u")for(let $ in _e.config.props)delete z[_e.config.props[$]];s[16].populate(z),r=s[16];const Re={};Re.color="0xd946efff",Re.y=200,Re.x=320,Re.ref="button8",g=Re.is||"Button";let Ae;if(typeof g=="string"){if(Ae=u.components&&u.components[g]||d[g],!Ae)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(Ae=g);s[17]=Ae.call(null,{props:Re},s[16],i),s[17][Symbol.for("slots")][0]?(r=s[17][Symbol.for("slots")][0],i=s[17]):r=s[17][Symbol.for("children")][0];const oe=u.components&&u.components.Button||d.Button;r=s[1];const D={};if(s[18]=this.element({parent:r||"root"},i),D.color="0xf43f5eff",D.y=200,D.x=640,D.ref="button9",typeof oe<"u")for(let $ in oe.config.props)delete D[oe.config.props[$]];s[18].populate(D),r=s[18];const me={};me.color="0xf43f5eff",me.y=200,me.x=640,me.ref="button9",g=me.is||"Button";let Ce;if(typeof g=="string"){if(Ce=u.components&&u.components[g]||d[g],!Ce)throw new Error('Component "Button" not found')}else typeof g=="function"&&g.name==="factory"&&(Ce=g);s[19]=Ce.call(null,{props:me},s[18],i),s[19][Symbol.for("slots")][0]?(r=s[19][Symbol.for("slots")][0],i=s[19]):r=s[19][Symbol.for("children")][0];const ze=u.components&&u.components.Menu||d.Menu;r=s[0];const ae={};if(s[20]=this.element({parent:r||"root"},i),ae.ref="menu",typeof ze<"u")for(let $ in ze.config.props)delete ae[ze.config.props[$]];s[20].populate(ae),r=s[20];const Be={};Be.ref="menu",g=Be.is||"Menu";let Y;if(typeof g=="string"){if(Y=u.components&&u.components[g]||d[g],!Y)throw new Error('Component "Menu" not found')}else typeof g=="function"&&g.name==="factory"&&(Y=g);return s[21]=Y.call(null,{props:Be},s[20],i),s[21][Symbol.for("slots")][0]?(r=s[21][Symbol.for("slots")][0],i=s[21]):r=s[21][Symbol.for("children")][0],s},effects:[],context:{}},state(){return{focused:1}},hooks:{focus(){this.trigger("focused")}},watch:{focused(h){const r=this.select(`button${h}`);r&&r.focus&&r.focus()}},input:{right(){this.focused=Math.min(this.focused+1,9)},left(){const h=this.focused-1;if(h===0){const r=this.select("menu");r&&r.focus&&r.focus()}else this.focused=Math.max(h,1)},a(){const h=this.select("menu");h&&h.focus&&h.focus()}}}),sM=et.Component("Positioning",{code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.w=100,A.h=100,A.x=20,A.y=20,A.color="0xecfeffff",s[1].populate(A),r=s[0];const k={};s[2]=this.element({parent:r||"root"},i),k.w=100,k.h=100,k.x=140,k.y=20,k.color="0xa5f3fcff",s[2].populate(k),r=s[0];const b={};s[3]=this.element({parent:r||"root"},i),b.w=100,b.h=100,b.x=260,b.y=20,b.color="0x22d3eeff",s[3].populate(b),r=s[0];const P={};s[4]=this.element({parent:r||"root"},i),P.w=100,P.h=100,P.x=380,P.y=20,P.color="0x0891b2ff",s[4].populate(P),r=s[0];const w={};s[5]=this.element({parent:r||"root"},i),w.w=100,w.h=100,w.x=i.x1,w.y=i.y,w.color="0xfdf4ffff",s[5].populate(w),r=s[0];const R={};s[6]=this.element({parent:r||"root"},i),R.w=100,R.h=100,R.x=i.x2,R.y=i.y,R.color="0xf5d0feff",s[6].populate(R),r=s[0];const B={};s[7]=this.element({parent:r||"root"},i),B.w=100,B.h=100,B.x=i.x3,B.y=i.y,B.color="0xe879f9ff",s[7].populate(B),r=s[0];const U={};s[8]=this.element({parent:r||"root"},i),U.w=100,U.h=100,U.x=i.x4,U.y=i.y,U.color="0xc026d3ff",s[8].populate(U),r=s[0];const W={};s[9]=this.element({parent:r||"root"},i),W.w=100,W.h=100,W.x=i.xA,W.y=260,W.color="0xfff7edff",s[9].populate(W),r=s[0];const G={};s[10]=this.element({parent:r||"root"},i),G.w=100,G.h=100,G.x=i.xB,G.y=260,G.color="0xfed7aaff",s[10].populate(G),r=s[0];const Q={};s[11]=this.element({parent:r||"root"},i),Q.w=100,Q.h=100,Q.x=i.xC,Q.y=260,Q.color="0xfb923cff",s[11].populate(Q),r=s[0];const ee={};s[12]=this.element({parent:r||"root"},i),ee.w=100,ee.h=100,ee.x=i.xD,ee.y=260,ee.color="0xea580cff",s[12].populate(ee),r=s[0];const Z={};s[13]=this.element({parent:r||"root"},i),Z.w=800,Z.h=800,Z.y=20,Z.x=800,Z.color="0xecfdf5ff",s[13].populate(Z),r=s[13];const H={};s[14]=this.element({parent:r||"root"},i),H.w=600,H.h=600,H.y=20,H.x=20,H.color="0xa7f3d0ff",s[14].populate(H),r=s[14];const J={};s[15]=this.element({parent:r||"root"},i),J.w=400,J.h=400,J.y=100,J.x=20,J.color="0x34d399ff",s[15].populate(J),r=s[15];const fe={};s[16]=this.element({parent:r||"root"},i),fe.w=200,fe.h=100,fe.y=(400-100)/2,fe.x=(400-200)/2,fe.color="0x059669ff",s[16].populate(fe),r=s[16];const E={};s[17]=this.element({parent:r||"root"},i),E.w=50,E.h=50,E.y={transition:i.yNested},E.x={transition:i.xNested},E.color="0x065f46ff",s[17].populate(E),r=s[0];const F={};s[18]=this.element({parent:r||"root"},i),F.w=100,F.h=100,F.y=500,F.x=20,F.color="0xe11d48ff",s[18].populate(F),r=s[0];const re={};s[19]=this.element({parent:r||"root"},i),re.w=200,re.h=200,re.x=300,re.y=600,re.color="0x94a3b8ff",re.z=100,s[19].populate(re),r=s[19];const ye={};s[20]=this.element({parent:r||"root"},i),ye.content="Lightning!",ye.x=100,ye.y=140,ye.__textnode=!0,s[20].populate(ye),r=s[19];const ie={};s[21]=this.element({parent:r||"root"},i),ie.w=300,ie.h=100,ie.color="0x475569ff",s[21].populate(ie);const se=u.components&&u.components.Circle||d.Circle;r=s[19];const ne={};if(s[22]=this.element({parent:r||"root"},i),ne.x=150,ne.y=150,ne.size=100,ne.color="0xffffffff",typeof se<"u")for(let z in se.config.props)delete ne[se.config.props[z]];s[22].populate(ne),r=s[22];const le={};le.x=150,le.y=150,le.size=100,le.color="0xffffffff",g=le.is||"Circle";let xe;if(typeof g=="string"){if(xe=u.components&&u.components[g]||d[g],!xe)throw new Error('Component "Circle" not found')}else typeof g=="function"&&g.name==="factory"&&(xe=g);s[23]=xe.call(null,{props:le},s[22],i),s[23][Symbol.for("slots")][0]?(r=s[23][Symbol.for("slots")][0],i=s[23]):r=s[23][Symbol.for("children")][0],r=s[0];const we={};s[24]=this.element({parent:r||"root"},i),we.w=300,we.h=300,we.x=300,we.y=600,we.color="0xef444480",s[24].populate(we),r=s[0];const Te={};s[25]=this.element({parent:r||"root"},i),Te.w=400,Te.h=100,Te.x=800,Te.y=900,Te.color="0x0284c7ff",s[25].populate(Te),r=s[25];const Ie={};s[26]=this.element({parent:r||"root"},i),Ie.w=r.node.width*(42/100),Ie.h=r.node.height*(30/100),Ie.y=r.node.height*(5/100),Ie.x=r.node.width*(1/100),Ie.color="0x075985ff",s[26].populate(Ie),r=s[25];const Ee={};s[27]=this.element({parent:r||"root"},i),Ee.w=i.bar2.v,Ee.h=r.node.height*(30/100),Ee.y=r.node.height*(35/100),Ee.x=r.node.width*(1/100),Ee.color="0x6b21a8ff",s[27].populate(Ee),r=s[25];const _e={};return s[28]=this.element({parent:r||"root"},i),_e.w={transition:i.bar3},_e.h=r.node.height*(30/100),_e.y=r.node.height*(65/100),_e.x=r.node.width*(1/100),_e.color="0x9f1239ff",s[28].populate(_e),s},effects:[function(r,i,u,d,y,x){i[9].set("x",r.xA)},function(r,i,u,d,y,x){i[10].set("x",r.xB)},function(r,i,u,d,y,x){i[11].set("x",r.xC)},function(r,i,u,d,y,x){i[12].set("x",r.xD)},function(r,i,u,d,y,x){i[16].set("y",(400-100)/2)},function(r,i,u,d,y,x){i[16].set("x",(400-200)/2)},function(r,i,u,d,y,x){i[17].set("y",{transition:r.yNested})},function(r,i,u,d,y,x){i[17].set("x",{transition:r.xNested})},function(r,i,u,d,y,x){i[27].set("w",r.bar2.v)},function(r,i,u,d,y,x){i[28].set("w",{transition:r.bar3})}],context:{}},state(){return{x1:20,x2:140,x3:20+140+100,x4:380,y:140,xA:20,xB:140,xC:260,xD:380,yNested:0,xNested:0,bar2:{direction:"up",v:"10%"},bar3:"10%"}},hooks:{ready(){this.$setTimeout(()=>{this.xD=this.xD+200,this.xC=this.xC+100,this.xB=this.xB+50,this.xA=this.xA+25},4e3),this.$setInterval(()=>{this.yNested=this.yNested===0?50:0},2e3),this.$setInterval(()=>{this.xNested=this.xNested===0?150:0},1e3),this.$setInterval(()=>{const h=parseFloat(this.bar2.v),r=this.bar2.direction==="up"?h+10:h-10;this.bar2.v=r+"%",r>=90&&(this.bar2.direction="down"),r<=10&&(this.bar2.direction="up")},400),this.$setInterval(()=>{this.bar3=Math.ceil(Math.random()*96)+"%"},2e3)}}});var aM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lM(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var z2={};/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/(function(h){(function(){var r=typeof window<"u"?window:aM,i={};(function(d,y,x){var s;function g(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var M=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};function A(e){e=[typeof globalThis=="object"&&globalThis,e,typeof d=="object"&&d,typeof self=="object"&&self,typeof y=="object"&&y];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}var k=A(this);function b(e,t){if(t)e:{var n=k;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}e=e[e.length-1],o=n[e],t=t(o),t!=o&&t!=null&&M(n,e,{configurable:!0,writable:!0,value:t})}}b("Symbol",function(e){function t(l){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new n(o+(l||"")+"_"+a++,l)}function n(l,f){this.g=l,M(this,"description",{configurable:!0,writable:!0,value:f})}if(e)return e;n.prototype.toString=function(){return this.g};var o="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",a=0;return t}),b("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var o=k[t[n]];typeof o=="function"&&typeof o.prototype[e]!="function"&&M(o.prototype,e,{configurable:!0,writable:!0,value:function(){return P(g(this))}})}return e});function P(e){return e={next:e},e[Symbol.iterator]=function(){return this},e}function w(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:g(e)}}function R(e){if(!(e instanceof Array)){e=w(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}var B=typeof Object.create=="function"?Object.create:function(e){function t(){}return t.prototype=e,new t},U;if(typeof Object.setPrototypeOf=="function")U=Object.setPrototypeOf;else{var W;e:{var G={a:!0},Q={};try{Q.__proto__=G,W=Q.a;break e}catch{}W=!1}U=W?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var ee=U;function Z(e,t){if(e.prototype=B(t.prototype),e.prototype.constructor=e,ee)ee(e,t);else for(var n in t)if(n!="prototype")if(Object.defineProperties){var o=Object.getOwnPropertyDescriptor(t,n);o&&Object.defineProperty(e,n,o)}else e[n]=t[n];e.ej=t.prototype}function H(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.u=this.i=null}function J(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}H.prototype.s=function(e){this.h=e};function fe(e,t){e.i={Mf:t,Xf:!0},e.g=e.m||e.j}H.prototype.return=function(e){this.i={return:e},this.g=this.j};function E(e,t,n){return e.g=n,{value:t}}H.prototype.B=function(e){this.g=e};function F(e){e.g=0}function re(e,t,n){e.m=t,n!=null&&(e.j=n)}function ye(e,t){e.m=0,e.j=t||0}function ie(e,t,n){e.g=t,e.m=n||0}function se(e,t){return e.m=t||0,t=e.i.Mf,e.i=null,t}function ne(e){e.u=[e.i],e.m=0,e.j=0}function le(e,t){var n=e.u.splice(0)[0];(n=e.i=e.i||n)?n.Xf?e.g=e.m||e.j:n.B!=null&&e.j<n.B?(e.g=n.B,e.i=null):e.g=e.j:e.g=t}function xe(e){this.g=new H,this.h=e}function we(e,t){J(e.g);var n=e.g.l;return n?Te(e,"return"in n?n.return:function(o){return{value:o,done:!0}},t,e.g.return):(e.g.return(t),Ie(e))}function Te(e,t,n,o){try{var a=t.call(e.g.l,n);if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");if(!a.done)return e.g.o=!1,a;var l=a.value}catch(f){return e.g.l=null,fe(e.g,f),Ie(e)}return e.g.l=null,o.call(e.g,l),Ie(e)}function Ie(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.o=!1,{value:t.value,done:!1}}catch(n){e.g.h=void 0,fe(e.g,n)}if(e.g.o=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.Xf)throw t.Mf;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function Ee(e){this.next=function(t){return J(e.g),e.g.l?t=Te(e,e.g.l.next,t,e.g.s):(e.g.s(t),t=Ie(e)),t},this.throw=function(t){return J(e.g),e.g.l?t=Te(e,e.g.l.throw,t,e.g.s):(fe(e.g,t),t=Ie(e)),t},this.return=function(t){return we(e,t)},this[Symbol.iterator]=function(){return this}}function _e(e){function t(o){return e.next(o)}function n(o){return e.throw(o)}return new Promise(function(o,a){function l(f){f.done?o(f.value):Promise.resolve(f.value).then(t,n).then(l,a)}l(e.next())})}function z(e){return _e(new Ee(new xe(e)))}function Re(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}b("Promise",function(e){function t(f){this.h=0,this.i=void 0,this.g=[],this.o=!1;var c=this.j();try{f(c.resolve,c.reject)}catch(p){c.reject(p)}}function n(){this.g=null}function o(f){return f instanceof t?f:new t(function(c){c(f)})}if(e)return e;n.prototype.h=function(f){if(this.g==null){this.g=[];var c=this;this.i(function(){c.l()})}this.g.push(f)};var a=k.setTimeout;n.prototype.i=function(f){a(f,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var f=this.g;this.g=[];for(var c=0;c<f.length;++c){var p=f[c];f[c]=null;try{p()}catch(m){this.j(m)}}}this.g=null},n.prototype.j=function(f){this.i(function(){throw f})},t.prototype.j=function(){function f(m){return function(v){p||(p=!0,m.call(c,v))}}var c=this,p=!1;return{resolve:f(this.F),reject:f(this.l)}},t.prototype.F=function(f){if(f===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(f instanceof t)this.H(f);else{e:switch(typeof f){case"object":var c=f!=null;break e;case"function":c=!0;break e;default:c=!1}c?this.C(f):this.m(f)}},t.prototype.C=function(f){var c=void 0;try{c=f.then}catch(p){this.l(p);return}typeof c=="function"?this.I(c,f):this.m(f)},t.prototype.l=function(f){this.s(2,f)},t.prototype.m=function(f){this.s(1,f)},t.prototype.s=function(f,c){if(this.h!=0)throw Error("Cannot settle("+f+", "+c+"): Promise already settled in state"+this.h);this.h=f,this.i=c,this.h===2&&this.G(),this.u()},t.prototype.G=function(){var f=this;a(function(){if(f.A()){var c=k.console;typeof c<"u"&&c.error(f.i)}},1)},t.prototype.A=function(){if(this.o)return!1;var f=k.CustomEvent,c=k.Event,p=k.dispatchEvent;return typeof p>"u"?!0:(typeof f=="function"?f=new f("unhandledrejection",{cancelable:!0}):typeof c=="function"?f=new c("unhandledrejection",{cancelable:!0}):(f=k.document.createEvent("CustomEvent"),f.initCustomEvent("unhandledrejection",!1,!0,f)),f.promise=this,f.reason=this.i,p(f))},t.prototype.u=function(){if(this.g!=null){for(var f=0;f<this.g.length;++f)l.h(this.g[f]);this.g=null}};var l=new n;return t.prototype.H=function(f){var c=this.j();f.rd(c.resolve,c.reject)},t.prototype.I=function(f,c){var p=this.j();try{f.call(c,p.resolve,p.reject)}catch(m){p.reject(m)}},t.prototype.then=function(f,c){function p(C,T){return typeof C=="function"?function(I){try{m(C(I))}catch(_){v(_)}}:T}var m,v,S=new t(function(C,T){m=C,v=T});return this.rd(p(f,m),p(c,v)),S},t.prototype.catch=function(f){return this.then(void 0,f)},t.prototype.rd=function(f,c){function p(){switch(m.h){case 1:f(m.i);break;case 2:c(m.i);break;default:throw Error("Unexpected state: "+m.h)}}var m=this;this.g==null?l.h(p):this.g.push(p),this.o=!0},t.resolve=o,t.reject=function(f){return new t(function(c,p){p(f)})},t.race=function(f){return new t(function(c,p){for(var m=w(f),v=m.next();!v.done;v=m.next())o(v.value).rd(c,p)})},t.all=function(f){var c=w(f),p=c.next();return p.done?o([]):new t(function(m,v){function S(I){return function(_){C[I]=_,T--,T==0&&m(C)}}var C=[],T=0;do C.push(void 0),T++,o(p.value).rd(S(C.length-1),v),p=c.next();while(!p.done)})},t});function Ae(e,t){return Object.prototype.hasOwnProperty.call(e,t)}b("WeakMap",function(e){function t(p){if(this.g=(c+=Math.random()+1).toString(),p){p=w(p);for(var m;!(m=p.next()).done;)m=m.value,this.set(m[0],m[1])}}function n(){}function o(p){var m=typeof p;return m==="object"&&p!==null||m==="function"}function a(p){if(!Ae(p,f)){var m=new n;M(p,f,{value:m})}}function l(p){var m=Object[p];m&&(Object[p]=function(v){return v instanceof n?v:(Object.isExtensible(v)&&a(v),m(v))})}if(function(){if(!e||!Object.seal)return!1;try{var p=Object.seal({}),m=Object.seal({}),v=new e([[p,2],[m,3]]);return v.get(p)!=2||v.get(m)!=3?!1:(v.delete(p),v.set(m,4),!v.has(p)&&v.get(m)==4)}catch{return!1}}())return e;var f="$jscomp_hidden_"+Math.random();l("freeze"),l("preventExtensions"),l("seal");var c=0;return t.prototype.set=function(p,m){if(!o(p))throw Error("Invalid WeakMap key");if(a(p),!Ae(p,f))throw Error("WeakMap key fail: "+p);return p[f][this.g]=m,this},t.prototype.get=function(p){return o(p)&&Ae(p,f)?p[f][this.g]:void 0},t.prototype.has=function(p){return o(p)&&Ae(p,f)&&Ae(p[f],this.g)},t.prototype.delete=function(p){return o(p)&&Ae(p,f)&&Ae(p[f],this.g)?delete p[f][this.g]:!1},t}),b("Map",function(e){function t(){var c={};return c.sb=c.next=c.head=c}function n(c,p){var m=c.g;return P(function(){if(m){for(;m.head!=c.g;)m=m.sb;for(;m.next!=m.head;)return m=m.next,{done:!1,value:p(m)};m=null}return{done:!0,value:void 0}})}function o(c,p){var m=p&&typeof p;m=="object"||m=="function"?l.has(p)?m=l.get(p):(m=""+ ++f,l.set(p,m)):m="p_"+p;var v=c.h[m];if(v&&Ae(c.h,m))for(c=0;c<v.length;c++){var S=v[c];if(p!==p&&S.key!==S.key||p===S.key)return{id:m,list:v,index:c,entry:S}}return{id:m,list:v,index:-1,entry:void 0}}function a(c){if(this.h={},this.g=t(),this.size=0,c){c=w(c);for(var p;!(p=c.next()).done;)p=p.value,this.set(p[0],p[1])}}if(function(){if(!e||typeof e!="function"||!e.prototype.entries||typeof Object.seal!="function")return!1;try{var c=Object.seal({x:4}),p=new e(w([[c,"s"]]));if(p.get(c)!="s"||p.size!=1||p.get({x:4})||p.set({x:4},"t")!=p||p.size!=2)return!1;var m=p.entries(),v=m.next();return v.done||v.value[0]!=c||v.value[1]!="s"?!1:(v=m.next(),!(v.done||v.value[0].x!=4||v.value[1]!="t"||!m.next().done))}catch{return!1}}())return e;var l=new WeakMap;a.prototype.set=function(c,p){c=c===0?0:c;var m=o(this,c);return m.list||(m.list=this.h[m.id]=[]),m.entry?m.entry.value=p:(m.entry={next:this.g,sb:this.g.sb,head:this.g,key:c,value:p},m.list.push(m.entry),this.g.sb.next=m.entry,this.g.sb=m.entry,this.size++),this},a.prototype.delete=function(c){return c=o(this,c),c.entry&&c.list?(c.list.splice(c.index,1),c.list.length||delete this.h[c.id],c.entry.sb.next=c.entry.next,c.entry.next.sb=c.entry.sb,c.entry.head=null,this.size--,!0):!1},a.prototype.clear=function(){this.h={},this.g=this.g.sb=t(),this.size=0},a.prototype.has=function(c){return!!o(this,c).entry},a.prototype.get=function(c){return(c=o(this,c).entry)&&c.value},a.prototype.entries=function(){return n(this,function(c){return[c.key,c.value]})},a.prototype.keys=function(){return n(this,function(c){return c.key})},a.prototype.values=function(){return n(this,function(c){return c.value})},a.prototype.forEach=function(c,p){for(var m=this.entries(),v;!(v=m.next()).done;)v=v.value,c.call(p,v[1],v[0],this)},a.prototype[Symbol.iterator]=a.prototype.entries;var f=0;return a}),b("Set",function(e){function t(n){if(this.g=new Map,n){n=w(n);for(var o;!(o=n.next()).done;)this.add(o.value)}this.size=this.g.size}return function(){if(!e||typeof e!="function"||!e.prototype.entries||typeof Object.seal!="function")return!1;try{var n=Object.seal({x:4}),o=new e(w([n]));if(!o.has(n)||o.size!=1||o.add(n)!=o||o.size!=1||o.add({x:4})!=o||o.size!=2)return!1;var a=o.entries(),l=a.next();return l.done||l.value[0]!=n||l.value[1]!=n?!1:(l=a.next(),l.done||l.value[0]==n||l.value[0].x!=4||l.value[1]!=l.value[0]?!1:a.next().done)}catch{return!1}}()?e:(t.prototype.add=function(n){return n=n===0?0:n,this.g.set(n,n),this.size=this.g.size,this},t.prototype.delete=function(n){return n=this.g.delete(n),this.size=this.g.size,n},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(n){return this.g.has(n)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(n,o){var a=this;this.g.forEach(function(l){return n.call(o,l,l,a)})},t)});function oe(e,t,n){e instanceof String&&(e=String(e));for(var o=e.length,a=0;a<o;a++){var l=e[a];if(t.call(n,l,a,e))return{Uf:a,v:l}}return{Uf:-1,v:void 0}}b("Array.prototype.findIndex",function(e){return e||function(t,n){return oe(this,t,n).Uf}}),b("Object.is",function(e){return e||function(t,n){return t===n?t!==0||1/t===1/n:t!==t&&n!==n}}),b("Array.prototype.includes",function(e){return e||function(t,n){var o=this;o instanceof String&&(o=String(o));var a=o.length;for(n=n||0,0>n&&(n=Math.max(n+a,0));n<a;n++){var l=o[n];if(l===t||Object.is(l,t))return!0}return!1}});function D(e,t,n){if(e==null)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}b("String.prototype.includes",function(e){return e||function(t,n){return D(this,t,"includes").indexOf(t,n||0)!==-1}}),b("Array.prototype.find",function(e){return e||function(t,n){return oe(this,t,n).v}}),b("String.prototype.startsWith",function(e){return e||function(t,n){var o=D(this,t,"startsWith"),a=o.length,l=t.length;n=Math.max(0,Math.min(n|0,o.length));for(var f=0;f<l&&n<a;)if(o[n++]!=t[f++])return!1;return f>=l}});function me(e,t){e instanceof String&&(e+="");var n=0,o=!1,a={next:function(){if(!o&&n<e.length){var l=n++;return{value:t(l,e[l]),done:!1}}return o=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}b("Array.prototype.keys",function(e){return e||function(){return me(this,function(t){return t})}}),b("WeakSet",function(e){function t(n){if(this.g=new WeakMap,n){n=w(n);for(var o;!(o=n.next()).done;)this.add(o.value)}}return function(){if(!e||!Object.seal)return!1;try{var n=Object.seal({}),o=Object.seal({}),a=new e([n]);return!a.has(n)||a.has(o)?!1:(a.delete(n),a.add(o),!a.has(n)&&a.has(o))}catch{return!1}}()?e:(t.prototype.add=function(n){return this.g.set(n,!0),this},t.prototype.has=function(n){return this.g.has(n)},t.prototype.delete=function(n){return this.g.delete(n)},t)}),b("Array.from",function(e){return e||function(t,n,o){n=n??function(c){return c};var a=[],l=typeof Symbol<"u"&&Symbol.iterator&&t[Symbol.iterator];if(typeof l=="function"){t=l.call(t);for(var f=0;!(l=t.next()).done;)a.push(n.call(o,l.value,f++))}else for(l=t.length,f=0;f<l;f++)a.push(n.call(o,t[f],f));return a}});var Ce=typeof Object.assign=="function"?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var o=arguments[n];if(o)for(var a in o)Ae(o,a)&&(e[a]=o[a])}return e};b("Object.assign",function(e){return e||Ce}),b("Array.prototype.values",function(e){return e||function(){return me(this,function(t,n){return n})}}),b("Promise.prototype.finally",function(e){return e||function(t){return this.then(function(n){return Promise.resolve(t()).then(function(){return n})},function(n){return Promise.resolve(t()).then(function(){throw n})})}}),b("Array.prototype.entries",function(e){return e||function(){return me(this,function(t,n){return[t,n]})}}),b("String.prototype.repeat",function(e){return e||function(t){var n=D(this,null,"repeat");if(0>t||1342177279<t)throw new RangeError("Invalid count value");t|=0;for(var o="";t;)t&1&&(o+=n),(t>>>=1)&&(n+=n);return o}}),b("Number.isNaN",function(e){return e||function(t){return typeof t=="number"&&isNaN(t)}}),b("Number.isFinite",function(e){return e||function(t){return typeof t!="number"?!1:!isNaN(t)&&t!==1/0&&t!==-1/0}}),b("Object.values",function(e){return e||function(t){var n=[],o;for(o in t)Ae(t,o)&&n.push(t[o]);return n}}),b("Math.log2",function(e){return e||function(t){return Math.log(t)/Math.LN2}}),b("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991}),b("Math.trunc",function(e){return e||function(t){if(t=Number(t),isNaN(t)||t===1/0||t===-1/0||t===0)return t;var n=Math.floor(Math.abs(t));return 0>t?-n:n}}),b("Object.entries",function(e){return e||function(t){var n=[],o;for(o in t)Ae(t,o)&&n.push([o,t[o]]);return n}});var ze=this||self;function ae(e,t){e=e.split(".");var n=ze;e[0]in n||typeof n.execScript>"u"||n.execScript("var "+e[0]);for(var o;e.length&&(o=e.shift());)e.length||t===void 0?n[o]&&n[o]!==Object.prototype[o]?n=n[o]:n=n[o]={}:n[o]=t}function Be(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}Be.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)};function Y(e){return e.h/(1-Math.pow(e.g,e.i))}function $(){this.h=new Be(2),this.j=new Be(5),this.g=0,this.i=128e3,this.l=16e3}$.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},$.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},$.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(Y(this.h),Y(this.j))};function be(){}function De(){}function Le(){}function it(e){var t=Re.apply(1,arguments);rt.has(e)||(rt.add(e),Le.apply(be,R(t)))}function zn(){}function oo(){}function mi(){}function yi(){}var rt=new Set;d.console&&(Le=function(){return console.warn.apply(console,R(Re.apply(0,arguments)))},De=function(){console.error.apply(console,R(Re.apply(0,arguments)))});function ve(e){if(Zt.has(e))return Zt.get(e);if(d.ManagedMediaSource){var t=ManagedMediaSource.isTypeSupported(e);return Zt.set(e,t),t}return d.MediaSource?(t=MediaSource.isTypeSupported(e),Zt.set(e,t),t):!1}function Ot(){return!!d.SourceBuffer&&!!SourceBuffer.prototype&&!!SourceBuffer.prototype.changeType}var Zt=new Map;function Mn(){}Mn.prototype.extract=function(){},Mn.prototype.decode=function(){return[]},Mn.prototype.clear=function(){},Mn.prototype.getStreams=function(){return[]};function Vn(){}Vn.prototype.init=function(){},Vn.prototype.parse=function(){return[]};function _n(){}function nt(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if(Ue(e)==Ue(t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=Ve(e);t=Ve(t);for(var o=0;o<e.byteLength;o++)if(n[o]!=t[o])return!1;return!0}function Ue(e){return e instanceof ArrayBuffer?e:e.buffer}function Pt(e){return e instanceof ArrayBuffer?e:e.byteOffset==0&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}function Ve(e,t,n){return n=n===void 0?1/0:n,ni(e,t===void 0?0:t,n,Uint8Array)}function $t(e,t,n){return n=n===void 0?1/0:n,ni(e,t===void 0?0:t,n,Uint16Array)}function Et(e,t,n){return n=n===void 0?1/0:n,ni(e,t===void 0?0:t,n,DataView)}function ni(e,t,n,o){var a=Ue(e),l=1;"BYTES_PER_ELEMENT"in o&&(l=o.BYTES_PER_ELEMENT);var f=((e.byteOffset||0)+e.byteLength)/l;return e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/l,f))),new o(a,e,Math.floor(Math.min(e+Math.max(n,0),f))-e)}ae("shaka.util.BufferUtils",_n),_n.toDataView=Et,_n.toUint16=$t,_n.toUint8=Ve,_n.toArrayBuffer=Pt,_n.equal=nt;function _i(){}_i.prototype.init=function(){},_i.prototype.i=function(){},_i.prototype.h=function(){},_i.prototype.j=function(){},ae("shaka.media.IClosedCaptionParser",_i);function nn(e){this.l=new Vn,(e=vn[e.toLowerCase()])&&(this.l=e()),this.g=new Mn,(e=xn)&&(this.g=e())}nn.prototype.init=function(e){this.l.init(e)},nn.prototype.i=function(e){e=this.l.parse(e),e=w(e);for(var t=e.next();!t.done;t=e.next()){t=t.value;var n=Ve(t.packet);0<n.length&&this.g.extract(n,t.pts)}return this.g.decode()},nn.prototype.h=function(){this.g.clear()},nn.prototype.j=function(){return this.g.getStreams()},ae("shaka.media.ClosedCaptionParser",nn),nn.findDecoder=function(){return xn},nn.unregisterDecoder=function(){xn=null},nn.registerDecoder=function(e){xn=e},nn.findParser=function(e){return vn[e]},nn.unregisterParser=function(e){delete vn[e]},nn.registerParser=function(e,t){vn[e]=t};var vn={},xn=null;function Io(e,t){return typeof e=="number"&&typeof t=="number"&&isNaN(e)&&isNaN(t)?!0:e===t}function wn(e,t){t=e.indexOf(t),-1<t&&e.splice(t,1)}function vi(e,t,n){if(n||(n=Io),e.length!=t.length)return!1;t=t.slice();var o={};e=w(e);for(var a=e.next();!a.done;o={ae:o.ae},a=e.next()){if(o.ae=a.value,a=t.findIndex(function(l){return function(f){return n(l.ae,f)}}(o)),a==-1)return!1;t[a]=t[t.length-1],t.pop()}return t.length==0}function ii(e,t,n){if(n||(n=Io),e.length!=t.length)return!1;for(var o=0;o<e.length;o++)if(!n(e[o],t[o]))return!1;return!0}function ct(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new Mo,this.position=null,this.positionAlign=$a,this.size=0,this.textAlign=Ui,this.direction=ws,this.writingMode=Ss,this.lineInterpretation=Ga,this.line=null,this.lineHeight="",this.lineAlign=ko,this.displayAlign=xs,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=_p,this.fontStyle=$f,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={Kb:32,rows:15}}function xt(e,t){return e=new ct(e,t,""),e.lineBreak=!0,e}ct.prototype.clone=function(){var e=new ct(0,0,""),t;for(t in this)e[t]=this[t],e[t]&&e[t].constructor==Array&&(e[t]=e[t].slice());return e};function zf(e,t){if(e.startTime!=t.startTime||e.endTime!=t.endTime||e.payload!=t.payload)return!1;for(var n in e)if(n!="startTime"&&n!="endTime"&&n!="payload"){if(n=="nestedCues"){if(!ii(e.nestedCues,t.nestedCues,zf))return!1}else if(n=="region"||n=="cellResolution"){for(var o in e[n])if(e[n][o]!=t[n][o])return!1}else if(Array.isArray(e[n])){if(!ii(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1}return!0}ae("shaka.text.Cue",ct),ct.equal=zf,ct.prototype.clone=ct.prototype.clone;var $a="auto";ct.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:$a};var Ui="center",Vf={LEFT:"left",RIGHT:"right",CENTER:Ui,START:"start",END:"end"};ct.textAlign=Vf;var xs="after",Ip={BEFORE:"before",CENTER:"center",AFTER:xs};ct.displayAlign=Ip;var ws="ltr";ct.direction={HORIZONTAL_LEFT_TO_RIGHT:ws,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var Ss="horizontal-tb";ct.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Ss,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var Ga=0;ct.lineInterpretation={LINE_NUMBER:Ga,PERCENTAGE:1};var ko="start",Hf={CENTER:"center",START:ko,END:"end"};ct.lineAlign=Hf;var kp={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};ct.defaultTextColor=kp;var Mp={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};ct.defaultTextBackgroundColor=Mp;var _p=400;ct.fontWeight={NORMAL:_p,BOLD:700};var $f="normal",Rp={NORMAL:$f,ITALIC:"italic",OBLIQUE:"oblique"};ct.fontStyle=Rp,ct.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};function Mo(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Hn,this.scroll=Lp}ae("shaka.text.CueRegion",Mo);var Hn=1;Mo.units={PX:0,PERCENTAGE:Hn,LINES:2};var Lp="";Mo.scrollMode={NONE:Lp,UP:"up"};function ro(){}ro.prototype.destroy=function(){};function Bi(e,t,n){Gf[e.toLowerCase().split(";")[0]+"-"+n]={priority:n,Vd:t}}function _o(e,t){for(var n=e.toLowerCase().split(";")[0],o=w([Pp,Xf,Wf,so]),a=o.next();!a.done;a=o.next())if(a=Gf[n+"-"+a.value]){var l=a.Vd(),f=l.isSupported(e,t);if(l.destroy(),f)return a.Vd}return null}ae("shaka.transmuxer.TransmuxerEngine",ro),ro.findTransmuxer=_o,ro.unregisterTransmuxer=function(e,t){delete Gf[e.toLowerCase().split(";")[0]+"-"+t]},ro.registerTransmuxer=Bi,ro.prototype.destroy=ro.prototype.destroy;var Gf={},so=1,Wf=2,Xf=3,Pp=4;ro.PluginPriority={FALLBACK:so,PREFERRED_SECONDARY:Wf,PREFERRED:Xf,APPLICATION:Pp};/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/var $2=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/function Bt(e){var t;e instanceof Bt?(Wa(this,e.ab),this.Wb=e.Wb,Xa(this,e.ob),Kf(this,e.nc),this.Ga=e.Ga,Ts(this,e.g.clone()),this.Lb=e.Lb):e&&(t=String(e).match($2))?(Wa(this,t[1]||"",!0),this.Wb=Cs(t[2]||""),Xa(this,t[3]||"",!0),Kf(this,t[4]),this.Ga=Cs(t[5]||"",!0),Ts(this,t[6]||"",!0),this.Lb=Cs(t[7]||"")):this.g=new As(null)}s=Bt.prototype,s.ab="",s.Wb="",s.ob="",s.nc=null,s.Ga="",s.Lb="",s.toString=function(){var e=[],t=this.ab;if(t&&e.push(Es(t,Dp,!0),":"),t=this.ob){e.push("//");var n=this.Wb;n&&e.push(Es(n,Dp,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.nc,t!=null&&e.push(":",String(t))}return(t=this.Ga)&&(this.ob&&t.charAt(0)!="/"&&e.push("/"),e.push(Es(t,t.charAt(0)=="/"?X2:W2,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.Lb)&&e.push("#",Es(t,Y2)),e.join("")},s.resolve=function(e){var t=this.clone();t.ab==="data"&&(t=new Bt);var n=!!e.ab;n?Wa(t,e.ab):n=!!e.Wb,n?t.Wb=e.Wb:n=!!e.ob,n?Xa(t,e.ob):n=e.nc!=null;var o=e.Ga;if(n)Kf(t,e.nc);else if(n=!!e.Ga){if(o.charAt(0)!="/")if(this.ob&&!this.Ga)o="/"+o;else{var a=t.Ga.lastIndexOf("/");a!=-1&&(o=t.Ga.substr(0,a+1)+o)}if(o==".."||o==".")o="";else if(o.indexOf("./")!=-1||o.indexOf("/.")!=-1){a=o.lastIndexOf("/",0)==0,o=o.split("/");for(var l=[],f=0;f<o.length;){var c=o[f++];c=="."?a&&f==o.length&&l.push(""):c==".."?((1<l.length||l.length==1&&l[0]!="")&&l.pop(),a&&f==o.length&&l.push("")):(l.push(c),a=!0)}o=l.join("/")}}return n?t.Ga=o:n=e.g.toString()!=="",n?Ts(t,e.g.clone()):n=!!e.Lb,n&&(t.Lb=e.Lb),t},s.clone=function(){return new Bt(this)};function Wa(e,t,n){e.ab=n?Cs(t,!0):t,e.ab&&(e.ab=e.ab.replace(/:$/,""))}function Xa(e,t,n){e.ob=n?Cs(t,!0):t}function Kf(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.nc=t}else e.nc=null}function Ts(e,t,n){t instanceof As?e.g=t:(n||(t=Es(t,K2)),e.g=new As(t))}function Cs(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function Es(e,t,n){return e!=null?(e=encodeURI(e).replace(t,G2),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function G2(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var Dp=/[#\/\?@]/g,W2=/[#\?:]/g,X2=/[#\?]/g,K2=/[#\?@]/g,Y2=/#/g;function As(e){this.g=e||null}function Ka(e){if(!e.xa&&(e.xa={},e.Nc=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var o=t[n].indexOf("="),a=null;if(0<=o){var l=t[n].substring(0,o);a=t[n].substring(o+1)}else l=t[n];l=decodeURIComponent(l.replace(/\+/g," ")),a=a||"",e.add(l,decodeURIComponent(a.replace(/\+/g," ")))}}s=As.prototype,s.xa=null,s.Nc=null;function Np(e){return Ka(e),e.Nc}s.add=function(e,t){Ka(this),this.g=null;var n=this.xa.hasOwnProperty(e)?this.xa[e]:null;return n||(this.xa[e]=n=[]),n.push(t),this.Nc++,this},s.set=function(e,t){return Ka(this),this.g=null,this.xa.hasOwnProperty(e)?this.xa[e]=[t]:this.add(e,t),this},s.get=function(e){return Ka(this),this.xa[e]||[]},s.toString=function(){if(this.g)return this.g;if(!this.xa)return"";var e=[],t;for(t in this.xa)for(var n=encodeURIComponent(t),o=this.xa[t],a=0;a<o.length;a++){var l=n;o[a]!==""&&(l+="="+encodeURIComponent(o[a])),e.push(l)}return this.g=e.join("&")},s.clone=function(){var e=new As;if(e.g=this.g,this.xa){var t={},n;for(n in this.xa)t[n]=this.xa[n].concat();e.xa=t,e.Nc=this.Nc}return e};function K(e,t,n){var o=Re.apply(3,arguments);this.severity=e,this.category=t,this.code=n,this.data=o,this.handled=!1,this.message="Shaka Error "+this.code;try{throw Error(this.message||"Shaka Error")}catch(a){this.stack=a.stack}}K.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},ae("shaka.util.Error",K),K.Severity={RECOVERABLE:1,CRITICAL:2},K.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},K.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_CODEC_UNKNOWN:3021,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005};function on(e,t){if(t.length==0)return e;if(e.length==1&&t.length==1){var n=new Bt(e[0]);return t=new Bt(t[0]),[n.resolve(t).toString()]}t=t.map(function(f){return new Bt(f)}),n=[],e=w(e);for(var o=e.next();!o.done;o=e.next()){o=new Bt(o.value);for(var a=w(t),l=a.next();!l.done;l=a.next())n.push(o.resolve(l.value).toString())}return n}function ao(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:t||[],keyIds:new Set}}function nr(e,t){if(t.length==1)return t[0];if(e=Sn(e,t),e!=null)return e;throw new K(2,4,4025,t)}function Sn(e,t){for(var n=w(q2[e]),o=n.next();!o.done;o=n.next()){o=o.value;for(var a=w(t),l=a.next();!l.done;l=a.next())if(l=l.value,o.test(l.trim()))return l.trim()}return e==lt?"":null}var lt="text",Gt={$:"video",P:"audio",na:lt,he:"image",fi:"application"},q2={audio:[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4$/,/^dts[cex]$/],video:[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function Yf(){}function Rn(e,t){var n=e;return t&&!rr.includes(e)&&(n+='; codecs="'+t+'"'),n}function ir(e,t){return t&&(e+='; codecs="'+t+'"'),e}function or(e,t,n){var o=Rn(e,t);return t=ir(e,t),_o(t)?(e=_o(t))?(e=e(),n=e.convertCodecs(n,t),e.destroy()):n=t:n=e!="video/mp2t"&&n=="audio"?o.replace("video","audio"):o,n}function oi(e){var t=Op(e);switch(e=t[0],t=t[1].toLowerCase(),!0){case(e==="mp4a"&&t==="69"):case(e==="mp4a"&&t==="6b"):case(e==="mp4a"&&t==="40.34"):return"mp3";case(e==="mp4a"&&t==="66"):case(e==="mp4a"&&t==="67"):case(e==="mp4a"&&t==="68"):case(e==="mp4a"&&t==="40.2"):case(e==="mp4a"&&t==="40.02"):case(e==="mp4a"&&t==="40.5"):case(e==="mp4a"&&t==="40.05"):case(e==="mp4a"&&t==="40.29"):case(e==="mp4a"&&t==="40.42"):return"aac";case(e==="mp4a"&&t==="a5"):return"ac-3";case(e==="mp4a"&&t==="a6"):return"ec-3";case(e==="mp4a"&&t==="b2"):return"dtsx";case(e==="mp4a"&&t==="a9"):return"dtsc";case e==="avc1":case e==="avc3":return"avc";case e==="hvc1":case e==="hev1":return"hevc";case e==="dvh1":case e==="dvhe":return"dovi"}return e}function xi(e){var t=[];e=w(e.split(","));for(var n=e.next();!n.done;n=e.next())n=Op(n.value),t.push(n[0]);return t.sort().join(",")}function ji(e){return e.split(";")[0]}function ri(e){return e=e.split(/ *; */),e.shift(),(e=e.find(function(t){return t.startsWith("codecs=")}))?e.split("=")[1].replace(/^"|"$/g,""):""}function Op(e){e=e.split(".");var t=e[0];return e.shift(),[t,e.join(".")]}ae("shaka.util.MimeUtils",Yf),Yf.getFullTypeWithAllCodecs=ir,Yf.getFullType=Rn,new Map().set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");var rr=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function Fi(e){this.i=null,this.j=e,this.u=!1,this.l=this.s=0,this.m=1/0,this.h=this.g=null,this.A="",this.o=new Map}function Ya(e){return Kt[e]?!0:e=="application/cea-608"||e=="application/cea-708"?!!xn:!1}Fi.prototype.destroy=function(){return this.j=this.i=null,this.o.clear(),Promise.resolve()};function Q2(e,t,n,o,a){var l,f,c,p;return z(function(m){if(m.g==1)return E(m,Promise.resolve(),2);if(!e.i||!e.j)return m.return();if(n==null||o==null)return e.i.parseInit(Ve(t)),m.return();l=e.u?n:e.s,f={periodStart:e.s,segmentStart:n,segmentEnd:o,vttOffset:l},c=e.i.parseMedia(Ve(t),f,a),p=c.filter(function(v){return v.startTime>=e.l&&v.startTime<e.m}),e.j.append(p),e.g==null&&(e.g=Math.max(n,e.l)),e.h=Math.min(o,e.m),F(m)})}Fi.prototype.remove=function(e,t){var n=this;return z(function(o){if(o.g==1)return E(o,Promise.resolve(),2);!n.j||!n.j.remove(e,t)||n.g==null||t<=n.g||e>=n.h||(e<=n.g&&t>=n.h?n.g=n.h=null:e<=n.g&&t<n.h?n.g=t:e>n.g&&t>=n.h&&(n.h=e)),F(o)})};function Z2(e,t,n){e.l=t,e.m=n}function Up(e,t,n){if(e.A=t,t=e.o.get(t))for(var o=w(t.keys()),a=o.next();!a.done;a=o.next())(a=t.get(a.value).filter(function(l){return l.endTime<=n}))&&e.j.append(a)}function Bp(e,t,n){t.startTime+=n,t.endTime+=n,t=w(t.nestedCues);for(var o=t.next();!o.done;o=t.next())Bp(e,o.value,n)}function J2(e,t,n,o,a){var l=n+" "+o,f=new Map;t=w(t);for(var c=t.next();!c.done;c=t.next()){var p=c.value;c=p.stream,p=p.cue,f.has(c)||f.set(c,new Map),f.get(c).has(l)||f.get(c).set(l,[]),Bp(e,p,a),p.startTime>=e.l&&p.startTime<e.m&&(f.get(c).get(l).push(p),c==e.A&&e.j.append([p]))}for(a=w(f.keys()),l=a.next();!l.done;l=a.next())for(l=l.value,e.o.has(l)||e.o.set(l,new Map),t=w(f.get(l).keys()),c=t.next();!c.done;c=t.next())c=c.value,p=f.get(l).get(c),e.o.get(l).set(c,p);e.g=e.g==null?Math.max(n,e.l):Math.min(e.g,Math.max(n,e.l)),e.h=Math.max(e.h,Math.min(o,e.m))}ae("shaka.text.TextEngine",Fi),Fi.prototype.destroy=Fi.prototype.destroy,Fi.findParser=function(e){return Kt[e]},Fi.unregisterParser=function(e){delete Kt[e]},Fi.registerParser=function(e,t){Kt[e]=t};var Kt={};function ew(e,t){return e.concat(t)}function jp(){}function sr(e){return e!=null}function si(){}function qa(e,t){return e=ht(e),t=ht(t),e.split("-")[0]==t.split("-")[0]}function bs(e,t){return e=ht(e),t=ht(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&e.length==1&&t.length==2}function qf(e,t){return e=ht(e),t=ht(t),e=e.split("-"),t=t.split("-"),e.length==2&&t.length==2&&e[0]==t[0]}function ht(e){e=w(e.split("-x-"));var t=e.next().value;t=t===void 0?"":t,e=e.next().value,e=e===void 0?"":e;var n=w(t.split("-"));return t=n.next().value,t=t===void 0?"":t,n=n.next().value,n=n===void 0?"":n,e=e?"x-"+e:"",t=t.toLowerCase(),t=Fp.get(t)||t,n=n.toUpperCase(),(n?t+"-"+n:t)+(e?"-"+e:"")}function Ro(e,t){return e=ht(e),t=ht(t),t==e?4:bs(t,e)?3:qf(t,e)?2:bs(e,t)?1:0}function Qf(e){var t=e.indexOf("-");return e=0<=t?e.substring(0,t):e,e=e.toLowerCase(),e=Fp.get(e)||e}function Zf(e){return e.language?ht(e.language):e.audio&&e.audio.language?ht(e.audio.language):e.video&&e.video.language?ht(e.video.language):"und"}function Qa(e,t){e=ht(e);var n=new Set,o=w(t);for(t=o.next();!t.done;t=o.next())n.add(ht(t.value));for(o=w(n),t=o.next();!t.done;t=o.next())if(t=t.value,t==e)return t;for(o=w(n),t=o.next();!t.done;t=o.next())if(t=t.value,bs(t,e))return t;for(o=w(n),t=o.next();!t.done;t=o.next())if(t=t.value,qf(t,e))return t;for(n=w(n),t=n.next();!t.done;t=n.next())if(t=t.value,bs(e,t))return t;return null}ae("shaka.util.LanguageUtils",si),si.findClosestLocale=Qa,si.getLocaleForVariant=Zf,si.getLocaleForText=function(e){return ht(e.language||"und")},si.getBase=Qf,si.relatedness=Ro,si.areSiblings=function(e,t){var n=Qf(e),o=Qf(t);return e!=n&&t!=o&&n==o},si.normalize=ht,si.isSiblingOf=qf,si.isParentOf=bs,si.areLanguageCompatible=qa,si.areLocaleCompatible=function(e,t){return e=ht(e),t=ht(t),e==t};var Fp=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function Za(){this.g={}}s=Za.prototype,s.push=function(e,t){this.g.hasOwnProperty(e)?this.g[e].push(t):this.g[e]=[t]},s.get=function(e){return(e=this.g[e])?e.slice():null},s.remove=function(e,t){e in this.g&&(this.g[e]=this.g[e].filter(function(n){return n!=t}),this.g[e].length==0&&delete this.g[e])},s.forEach=function(e){for(var t in this.g)e(t,this.g[t])},s.size=function(){return Object.keys(this.g).length},s.keys=function(){return Object.keys(this.g)};function Lo(e){function t(o){switch(typeof o){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return o;default:if(!o||o.buffer&&o.buffer.constructor==ArrayBuffer)return o;if(n.has(o))return null;var a=o.constructor==Array;if(o.constructor!=Object&&!a)return null;n.add(o);var l=a?[]:{},f;for(f in o)l[f]=t(o[f]);return a&&(l.length=o.length),l}}var n=new WeakSet;return t(e)}function zp(e){var t={},n;for(n in e)t[n]=e[n];return t}function Is(e){this.h=e,this.g=null}Is.prototype.U=function(e){var t=this;this.stop();var n=!0,o=null;return this.g=function(){d.clearTimeout(o),n=!1},o=d.setTimeout(function(){n&&t.h()},1e3*e),this},Is.prototype.stop=function(){this.g&&(this.g(),this.g=null)};function st(e){this.h=e,this.g=null}st.prototype.qc=function(){return this.stop(),this.h(),this},st.prototype.U=function(e){var t=this;return this.stop(),this.g=new Is(function(){t.h()}).U(e),this},st.prototype.$a=function(e){var t=this;return this.stop(),this.g=new Is(function(){t.g.U(e),t.h()}).U(e),this},st.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},ae("shaka.util.Timer",st),st.prototype.stop=st.prototype.stop,st.prototype.tickEvery=st.prototype.$a,st.prototype.tickAfter=st.prototype.U,st.prototype.tickNow=st.prototype.qc;function wi(){var e=d.ManagedMediaSource||d.MediaSource;return!!(e&&e.isTypeSupported)}function ks(e){return Vp().canPlayType(e)!=""}function Jf(){return!!navigator.userAgent.match(/Edge?\//)}function Ms(){return Rt("Xbox One")}function Po(){return Rt("Tizen")}function Ja(){return Rt("Tizen 3")}function el(){return Rt("Tizen 2")}function ec(){return Rt("Web0S")&&Rt("Chrome/38.0.2125.122 Safari/537.36")}function ar(){return Rt("CrKey")}function tl(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!Po()&&!Rt("PC=EOS")&&!Rt("PC=APL")&&!Rt("VirginMedia")&&!Rt("SOPOpenBrowser")&&!lr()&&!Rt("AFT")&&!Rt("WPE")}function lr(){return Rt("PlayStation 4")}function nl(){if(!tl())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function Rt(e){return(navigator.userAgent||"").includes(e)}function Vp(){return ur||(tc||(tc=new st(function(){ur=null})),(ur=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(ur=document.createElement("video")),tc.U(1),ur)}var tc=null,ur=null;function Hp(){}function $p(e,t,n,o){var a=e.variants;if((t.length||n.length)&&(a=tw(a,t,n)),o.length){for(t=new Za,n=w(a),a=n.next();!a.done;a=n.next())a=a.value,t.push(String(a.video.width||0),a);var l=[];t.forEach(function(I,_){I=0;var N=[],j={};_=w(_);for(var O=_.next();!O.done;j={Gc:j.Gc},O=_.next())j.Gc=O.value,O=o.filter(function(X){return function(V){return X.Gc.decodingInfos[0][V]}}(j)).length,O>I?(I=O,N=[j.Gc]):O==I&&N.push(j.Gc);l.push.apply(l,R(N))}),a=l}n=new Set,t=new Set;var f=w(a);for(a=f.next();!a.done;a=f.next())a=a.value,a.audio&&n.add(a.audio),a.video&&t.add(a.video);n=Array.from(n).sort(function(I,_){return I.bandwidth-_.bandwidth});var c=[];for(a=new Map,n=w(n),f=n.next();!f.done;f=n.next()){f=f.value;var p=f.language+(f.channelsCount||0)+(f.audioSamplingRate||0)+f.roles.join(",")+f.label+f.groupId+f.fastSwitching,m=a.get(p)||[];if(m.length){var v=m[m.length-1],S=oi(v.codecs),C=oi(f.codecs);S==C&&f.bandwidth>v.bandwidth&&(m.push(f),c.push(f.id))}else m.push(f),c.push(f.id);a.set(p,m)}n=Array.from(t).sort(function(I,_){return I.bandwidth&&_.bandwidth?I.bandwidth-_.bandwidth:I.width-_.width}),t=Ot();var T=[];for(a=new Map,n=w(n),f=n.next();!f.done;f=n.next()){if(f=f.value,p=Math.round(f.frameRate||0)+(f.hdr||"")+f.fastSwitching,m=a.get(p)||[],m.length){if(v=m[m.length-1],!t&&(S=oi(v.codecs),C=oi(f.codecs),S!==C))continue;f.width>v.width||f.height>v.height?(m.push(f),T.push(f.id)):f.width==v.width&&f.height==v.height&&(S=oi(v.codecs),C=oi(f.codecs),S==C&&f.bandwidth>v.bandwidth&&(m.push(f),T.push(f.id)))}else m.push(f),T.push(f.id);a.set(p,m)}e.variants=e.variants.filter(function(I){var _=I.audio;return I=I.video,!(_&&!c.includes(_.id)||I&&!T.includes(I.id))})}function tw(e,t,n){var o={};t=w(t);for(var a=t.next();!a.done;o={ge:o.ge},a=t.next())if(o.ge=a.value,a=e.filter(function(l){return function(f){return f.video&&f.video.codecs.startsWith(l.ge)}}(o)),a.length){e=a;break}for(o={},n=w(n),t=n.next();!t.done;o={$d:o.$d},t=n.next())if(o.$d=t.value,t=e.filter(function(l){return function(f){return f.audio&&f.audio.codecs.startsWith(l.$d)}}(o)),t.length){e=t;break}return e}function nw(e,t,n){e.variants=e.variants.filter(function(o){return il(o,t,n)})}function il(e,t,n){function o(l,f,c){return l>=f&&l<=c}var a=e.video;return!(a&&a.width&&a.height&&(!o(a.width,t.minWidth,Math.min(t.maxWidth,n.width))||!o(a.height,t.minHeight,Math.min(t.maxHeight,n.height))||!o(a.width*a.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!o(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!o(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function Gp(e,t,n){var o=!1;e=w(e);for(var a=e.next();!a.done;a=e.next()){a=a.value;var l=a.allowedByApplication;a.allowedByApplication=il(a,t,n),l!=a.allowedByApplication&&(o=!0)}return o}function iw(e,t){return z(function(n){return n.g==1?E(n,Wp(e,t,0<t.offlineSessionIds.length),2):(rw(t),E(n,sw(t),0))})}function Wp(e,t,n){var o,a,l,f,c;return z(function(p){if(p.g==1)return E(p,Yp(t.variants,n,!1,[]),2);o=null,e&&(a=e.g)&&(o=a.keySystem),l=Gt,f=Ms(),c=Rt("Firefox")&&Rt("Android"),t.variants=t.variants.filter(function(m){var v=m.video,S=v&&v.width||0,C=v&&v.height||0;if(f&&v&&(1920<S||1080<C)&&(v.codecs.includes("avc1.")||v.codecs.includes("avc3.")))return sc(m),!1;if(v){if(S=rl(v.codecs),v.codecs.includes(",")){C=v.codecs.split(","),S=nr(l.$,C),S=rl(S),C=nr(l.P,C),C=ol(C);var T=or(v.mimeType,C,l.P);if(!ve(T))return!1;S=[S,C].join()}if(C=or(v.mimeType,S,l.$),!ve(C))return!1;v.codecs=S}if(v=m.audio,c&&v&&v.encrypted&&v.codecs.toLowerCase().includes("opus"))return sc(m),!1;if(v){if(S=ol(v.codecs),C=or(v.mimeType,S,l.P),!ve(C))return!1;v.codecs=S}return(v=m.decodingInfos.some(function(I){return!(!I.supported||o&&(I=I.keySystemAccess)&&I.keySystem!=o)}))||(sc(m),void 0),v}),F(p)})}function Xp(e){var t=[];for(n in e)t.push(n);t.sort();var n=[];t=w(t);for(var o=t.next();!o.done;o=t.next()){var a=o.value;o=JSON.stringify(a),a=e[a],a instanceof Object?(a=Xp(a),n.push(o+":"+a)):(a=JSON.stringify(a),n.push(o+":"+a))}return"{"+n.join(",")+"}"}function Kp(e,t){var n,o,a,l,f,c,p;return z(function(m){if(m.g==1)return n=Xp(t),o=lw,o[n]?(e.decodingInfos.push(o[n]),m.B(0)):E(m,ow(t),3);if((a=m.h)&&a.length){for(l=null,f=w(a),c=f.next();!c.done;c=f.next())p=c.value,l?(l.supported=l.supported&&p.supported,l.powerEfficient=l.powerEfficient&&p.powerEfficient,l.smooth=l.smooth&&p.smooth,p.keySystemAccess||(l.keySystemAccess=null)):l=p;l&&(o[n]=l,e.decodingInfos.push(l))}F(m)})}function ow(e){var t=[""];e.video&&(t=ri(e.video.contentType).split(","));var n=[""];e.audio&&(n=ri(e.audio.contentType).split(","));var o=[];t=w(t);for(var a=t.next();!a.done;a=t.next()){a=a.value;for(var l={},f=w(n),c=f.next();!c.done;l={Gb:l.Gb},c=f.next())c=c.value,l.Gb=Lo(e),e.video&&(l.Gb.video.contentType=Rn(ji(l.Gb.video.contentType),a)),e.audio&&(l.Gb.audio.contentType=Rn(ji(l.Gb.audio.contentType),c)),o.push(new Promise(function(p){return function(m,v){navigator.mediaCapabilities.decodingInfo(p.Gb).then(function(S){m(S)}).catch(v)}}(l)))}return Promise.all(o).catch(function(){return JSON.stringify(e),null})}function Yp(e,t,n,o){var a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X;return z(function(V){switch(V.g){case 1:if(e.some(function(q){return q.decodingInfos.length}))return V.return();a={},l=w(o),f=l.next();case 2:if(f.done){V.B(4);break}a.be=f.value,c=!1,p=w(e),m=p.next();case 5:if(m.done){V.B(7);break}v=m.value,S=qp(v,t,n).filter(function(q){return function(te){return(te.keySystemConfiguration&&te.keySystemConfiguration.keySystem)===q.be}}(a)),C=w(S),T=C.next();case 8:if(T.done){V.B(10);break}return I=T.value,E(V,Kp(v,I),9);case 9:T=C.next(),V.B(8);break;case 10:v.decodingInfos.length&&(c=!0),m=p.next(),V.B(5);break;case 7:if(c)return V.return();a={be:a.be},f=l.next(),V.B(2);break;case 4:_=w(e),m=_.next();case 12:if(m.done){V.B(0);break}N=m.value,j=qp(N,t,n).filter(function(q){return q=q.keySystemConfiguration&&q.keySystemConfiguration.keySystem,!q||!o.includes(q)}),O=w(j),T=O.next();case 15:if(T.done){m=_.next(),V.B(12);break}return X=T.value,E(V,Kp(N,X),16);case 16:T=O.next(),V.B(15)}})}function qp(e,t,n){var o=e.audio,a=e.video;if(n={type:n?"file":"media-source"},a){var l=a.codecs;if(a.codecs.includes(",")){var f=a.codecs.split(",");l=nr("video",f),l=rl(l),f=nr("audio",f),f=ol(f),f=or(a.mimeType,f,"audio"),n.audio={contentType:f,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1}}if(l=rl(l),l=or(a.mimeType,l,"video"),n.video={contentType:l,width:a.width||64,height:a.height||64,bitrate:a.bandwidth||e.bandwidth||1,framerate:a.frameRate||1},a.hdr)switch(a.hdr){case"SDR":n.video.transferFunction="srgb";break;case"PQ":n.video.transferFunction="pq";break;case"HLG":n.video.transferFunction="hlg"}}if(o&&(l=ol(o.codecs),l=or(o.mimeType,l,"audio"),n.audio={contentType:l,channels:o.channelsCount||2,bitrate:o.bandwidth||e.bandwidth||1,samplerate:o.audioSamplingRate||1,spatialRendering:o.spatialAudio}),f=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]),!f.length)return[n];e=[],l=new Map,f=w(f);for(var c=f.next();!c.done;c=f.next()){var p=c.value;l.get(p.keySystem)||l.set(p.keySystem,[]),l.get(p.keySystem).push(p)}f=t?"required":"optional",t=t?["persistent-license"]:["temporary"],p=w(l.keys());for(var m=p.next();!m.done;m=p.next()){var v=m.value;m=Object.assign({},n);var S=l.get(v);for(v={keySystem:v,initDataType:"cenc",persistentState:f,distinctiveIdentifier:"optional",sessionTypes:t},S=w(S),c=S.next();!c.done;c=S.next()){if(c=c.value,c.initData&&c.initData.length){for(var C=new Set,T=w(c.initData),I=T.next();!I.done;I=T.next())C.add(I.value.initDataType);v.initDataType=c.initData[0].initDataType}c.distinctiveIdentifierRequired&&(v.distinctiveIdentifier="required"),c.persistentStateRequired&&(v.persistentState="required"),c.sessionType&&(v.sessionTypes=[c.sessionType]),o&&(c.audioRobustness!=""?v.audio?v.audio.robustness=v.audio.robustness||c.audioRobustness:v.audio={robustness:c.audioRobustness}:v.audio||(v.audio={})),a&&(c.videoRobustness!=""?v.video?v.video.robustness=v.video.robustness||c.videoRobustness:v.video={robustness:c.videoRobustness}:v.video||(v.video={}))}m.keySystemConfiguration=v,e.push(m)}return e}function ol(e){return e!=="fLaC"||nl()?e==="Opus"?"opus":e:"flac"}function rl(e){if(e.includes("avc1")){var t=e.split(".");if(t.length==3)return e=t.shift()+".",e+=parseInt(t.shift(),10).toString(16),e+=("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if(e=="vp9")return"vp09.00.41.08";return e}function rw(e){e.textStreams=e.textStreams.filter(function(t){return t=Rn(t.mimeType,t.codecs),Ya(t)})}function sw(e){var t,n,o,a,l,f,c;return z(function(p){switch(p.g){case 1:t=[],n=w(e.imageStreams),o=n.next();case 2:if(o.done){p.B(4);break}if(a=o.value,l=a.mimeType,l=="application/mp4"&&a.codecs=="mjpg"&&(l="image/jpg"),ll.has(l)){p.B(5);break}if(f=fw.get(l),!f){ll.set(l,!1),p.B(5);break}return E(p,aw(f),7);case 7:c=p.h,ll.set(l,c);case 5:ll.get(l)&&t.push(a),o=n.next(),p.B(2);break;case 4:e.imageStreams=t,F(p)}})}function aw(e){return new Promise(function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then(function(){t(!0)}).catch(function(){t(!1)}):n.onload=n.onerror=function(){t(n.height===2)}})}function fr(e){var t=e.audio,n=e.video,o=t?t.mimeType:null,a=n?n.mimeType:null,l=t?t.codecs:null,f=n?n.codecs:null,c=[];f&&c.push(f),l&&c.push(l);var p=[];n&&p.push(n.mimeType),t&&p.push(t.mimeType),p=p[0]||null;var m=[];t&&m.push(t.kind),n&&m.push(n.kind),m=m[0]||null;var v=new Set;if(t)for(var S=w(t.roles),C=S.next();!C.done;C=S.next())v.add(C.value);if(n)for(S=w(n.roles),C=S.next();!C.done;C=S.next())v.add(C.value);return e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:m,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:p,audioMimeType:o,videoMimeType:a,codecs:c.join(", "),audioCodec:l,videoCodec:f,primary:e.primary,roles:Array.from(v),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null,e.hdr=n.hdr||null,e.videoLayout=n.videoLayout||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage),e}function sl(e){return{id:e.id,active:!1,type:lt,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null,accessibilityPurpose:e.accessibilityPurpose,originalLanguage:e.originalLanguage}}function nc(e){var t=e.width||null,n=e.height||null,o=null;e.segmentIndex&&(o=e.segmentIndex.get(0));var a=e.tilesLayout;return o&&(a=o.tilesLayout||a),a&&t!=null&&(t/=Number(a.split("x")[0])),a&&n!=null&&(n/=Number(a.split("x")[1])),{id:e.id,active:!1,type:"image",bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:t,height:n,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:a||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId,accessibilityPurpose:null,originalLanguage:null}}function ic(e){return e.__shaka_id||(e.__shaka_id=uw++),e.__shaka_id}function Qp(e){var t=Zp(e);return t.active=e.mode!="disabled",t.type="text",t.originalTextId=e.id,e.kind=="captions"&&(t.mimeType="application/cea-608"),e.kind=="subtitles"&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),e.kind=="forced"&&(t.forced=!0),t}function oc(e){var t=Zp(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,e.kind=="main"&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t}function Zp(e){var t=e.language;return{id:ic(e),active:!1,type:"",bandwidth:0,language:ht(t||"und"),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:t}}function al(e){return e.allowedByApplication&&e.allowedByKeySystem&&e.disabledUntilTime==0}function rc(e){return e.filter(function(t){return al(t)})}function _s(e,t,n,o){var a=e,l=e.filter(function(p){return p.primary});l.length&&(a=l);var f=a.length?a[0].language:"";if(a=a.filter(function(p){return p.language==f}),t){var c=Qa(ht(t),e.map(function(p){return p.language}));c&&(a=e.filter(function(p){return ht(p.language)==c}))}if(a=a.filter(function(p){return p.forced==o}),n){if(e=Jp(a,n),e.length)return e}else if(e=a.filter(function(p){return p.roles.length==0}),e.length)return e;return e=a.map(function(p){return p.roles}).reduce(ew,[]),e.length?Jp(a,e[0]):a}function Jp(e,t){return e.filter(function(n){return n.roles.includes(t)})}function sc(e){var t=[];return e.audio&&t.push(e0(e.audio)),e.video&&t.push(e0(e.video)),t.join(", ")}function e0(e){return e.type=="audio"?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:e.type=="video"?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}ae("shaka.util.StreamUtils",Hp),Hp.meetsRestrictions=il;var lw={},uw=0,ll=new Map().set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),fw=new Map().set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function At(){var e=this;this.s=null,this.o=!1,this.i=new $,this.A=null,navigator.connection&&navigator.connection.addEventListener&&(this.A=function(){if(e.o&&e.g.useNetworkInformation){e.i=new $,e.g&&e.i.configure(e.g.advanced);var t=e.chooseVariant();t&&navigator.onLine&&e.s(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}},navigator.connection.addEventListener("change",this.A)),this.m=[],this.C=1,this.G=!1,this.h=this.l=this.g=this.u=null,this.F=new st(function(){if(e.g.restrictToElementSize){var t=e.chooseVariant();t&&e.s(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}}),this.j=null}s=At.prototype,s.stop=function(){this.s=null,this.o=!1,this.m=[],this.C=1,this.l=this.u=null,this.h&&(this.h.disconnect(),this.h=null),this.F.stop(),this.j=null},s.release=function(){navigator.connection&&navigator.connection.removeEventListener&&(navigator.connection.removeEventListener("change",this.A),this.A=null),this.F=null},s.init=function(e){this.s=e},s.chooseVariant=function(e){e=e===void 0?!1:e;var t=1/0,n=1/0;if(this.g.restrictToScreenSize&&(n=this.g.ignoreDevicePixelRatio?1:d.devicePixelRatio,t=d.screen.height*n,n*=d.screen.width),this.h&&this.g.restrictToElementSize){var o=this.g.ignoreDevicePixelRatio?1:d.devicePixelRatio;t=Math.min(t,this.l.clientHeight*o),n=Math.min(n,this.l.clientWidth*o)}var a=this.m.filter(function(m){return!(m.audio&&m.audio.fastSwitching||m.video&&m.video.fastSwitching)});if(a.length||(a=this.m),o=a,e&&a.length!=this.m.length&&(o=this.m.filter(function(m){return!!(m.audio&&m.audio.fastSwitching||m.video&&m.video.fastSwitching)})),e=ac(this,this.g.restrictions,o,1/0,1/0),t!=1/0||n!=1/0){for(e=cw(e),e=w(e),a=e.next();!a.done;a=e.next())if(a=a.value,a.height>=t&&a.width>=n){t=a.height,n=a.width;break}e=ac(this,this.g.restrictions,o,t,n)}for(t=this.getBandwidthEstimate(),o.length&&!e.length&&(e=ac(this,null,o,1/0,1/0),e=[e[0]]),n=e[0]||null,o=0;o<e.length;o++){a=e[o];for(var l=isNaN(this.C)?1:Math.abs(this.C),f=l*a.bandwidth/this.g.bandwidthDowngradeTarget,c={bandwidth:1/0},p=o+1;p<e.length;p++)if(a.bandwidth!=e[p].bandwidth){c=e[p];break}l=l*c.bandwidth/this.g.bandwidthUpgradeTarget,t>=f&&t<=l&&n.bandwidth!=a.bandwidth&&(n=a)}return this.u=Date.now(),n},s.enable=function(){this.o=!0},s.disable=function(){this.o=!1},s.segmentDownloaded=function(e,t,n){this.i.sample(e,t),n&&this.u!=null&&this.o&&t0(this)},s.trySuggestStreams=function(){this.u!=null&&this.o&&t0(this)},s.getBandwidthEstimate=function(){var e=this.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&(e=1e6*navigator.connection.downlink),e=this.i.getBandwidthEstimate(e),this.j?this.j.getBandwidthEstimate(e):e},s.setVariants=function(e){this.m=e},s.playbackRateChanged=function(e){this.C=e},s.setMediaElement=function(e){var t=this;this.l=e,this.h&&(this.h.disconnect(),this.h=null),this.l&&"ResizeObserver"in d&&(this.h=new ResizeObserver(function(){t.F.U(hw)}),this.h.observe(this.l))},s.setCmsdManager=function(e){this.j=e},s.configure=function(e){this.g=e,this.i&&this.g&&this.i.configure(this.g.advanced)};function t0(e){if(e.G){if(Date.now()-e.u<1e3*e.g.switchInterval)return}else{var t=e.i;if(!(t.g>=t.i))return;e.G=!0}t=e.chooseVariant(),e.getBandwidthEstimate(),t&&e.s(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}function ac(e,t,n,o,a){if(e.j){var l=e.j.Rf();l&&(n=n.filter(function(f){return f.bandwidth&&l?f.bandwidth<=l:!0}))}return t&&(n=n.filter(function(f){return il(f,t,{width:a,height:o})})),n.sort(function(f,c){return f.bandwidth-c.bandwidth})}function cw(e){var t=[];e=w(e);for(var n=e.next();!n.done;n=e.next())(n=n.value.video)&&n.height&&n.width&&t.push({height:n.height,width:n.width});return t.sort(function(o,a){return o.width-a.width})}ae("shaka.abr.SimpleAbrManager",At),At.prototype.configure=At.prototype.configure,At.prototype.setCmsdManager=At.prototype.setCmsdManager,At.prototype.setMediaElement=At.prototype.setMediaElement,At.prototype.playbackRateChanged=At.prototype.playbackRateChanged,At.prototype.setVariants=At.prototype.setVariants,At.prototype.getBandwidthEstimate=At.prototype.getBandwidthEstimate,At.prototype.trySuggestStreams=At.prototype.trySuggestStreams,At.prototype.segmentDownloaded=At.prototype.segmentDownloaded,At.prototype.disable=At.prototype.disable,At.prototype.enable=At.prototype.enable,At.prototype.chooseVariant=At.prototype.chooseVariant,At.prototype.init=At.prototype.init,At.prototype.release=At.prototype.release,At.prototype.stop=At.prototype.stop;var hw=1;function lc(e,t){this.g=e,this.h=t}lc.prototype.toString=function(){return"v"+this.g+"."+this.h};function ai(e,t){var n=new lc(5,0),o=n0,a=o.g,l=n.h-a.h;(0<(n.g-a.g||l)?o.i:o.h)(o.g,n,e,t)}function dw(e,t,n,o){Le([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",o].join(" "))}function pw(e,t,n,o){De([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",o].join(" "))}var n0=null;ae("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),ae("shaka.config.CodecSwitchingStrategy",{Hi:"reload",yg:"smooth"});function ul(e,t,n,o){for(n=n===void 0?!0:n,o=o===void 0?!1:o,this.h=e,this.g=new Set([e]),t=t||[],e=w(t),t=e.next();!t.done;t=e.next())this.add(t.value,n,o)}ul.prototype.add=function(e,t,n){return i0(this.h,e,t===void 0?!0:t,n===void 0?!1:n)?(this.g.add(e),!0):!1};function i0(e,t,n,o){var a;if(!(a=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(a=e.audio&&t.audio)){a=e.audio;var l=t.audio;a=!!((!a.channelsCount||!l.channelsCount||2<a.channelsCount||2<l.channelsCount)&&a.channelsCount!=l.channelsCount||n&&!o0(a,l)||!r0(a.roles,l.roles)||o&&a.groupId!==l.groupId)}return!(o=a)&&(o=e.video&&t.video)&&(e=e.video,t=t.video,o=!((!n||o0(e,t))&&r0(e.roles,t.roles))),!o}ul.prototype.values=function(){return this.g.values()};function o0(e,t){if(e.mimeType!=t.mimeType||(e=e.codecs.split(",").map(function(o){return xi(o)}),t=t.codecs.split(",").map(function(o){return xi(o)}),e.length!=t.length))return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function r0(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;e=w(e);for(var n=e.next();!n.done;n=e.next())if(!t.has(n.value))return!1;return!0}function s0(e,t,n){t=t===void 0?"reload":t,n=n===void 0?!1:n,this.i=e,this.h=t,this.g=n,this.j=new cr(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"",!1,"","","",t,n)}s0.prototype.create=function(e){var t=this,n=this.h=="smooth"&&Ot(),o=e.filter(function(a){return i0(t.i,a,!n,t.g)});return o.length?new ul(o[0],o,!n,this.g):this.j.create(e)};function cr(e,t,n,o,a,l,f,c,p,m){this.s=e,this.u=t,this.h=n,this.i=o,this.A=a,this.l=l,this.g=f===void 0?"":f,this.j=c===void 0?"":c,this.m=p===void 0?"reload":p,this.o=m===void 0?!1:m}cr.prototype.create=function(e){var t=[];t=gw(e,this.s);var n=e.filter(function(o){return o.primary});return t=t.length?t:n.length?n:e,e=mw(t,this.u),e.length&&(t=e),this.l&&(e=Sw(t,this.l),e.length&&(t=e)),this.i&&(e=ww(t,this.i),e.length&&(t=e)),this.h&&(e=xw(t,this.h),e.length&&(t=e)),this.g&&(e=yw(t,this.g),e.length&&(t=e)),this.j&&(e=vw(t,this.j),e.length&&(t=e)),e=Tw(t,this.A),e.length&&(t=e),new ul(t[0],t,!(this.m=="smooth"&&Ot()),this.o)};function gw(e,t){t=ht(t);var n=Qa(t,e.map(function(o){return Zf(o)}));return n?e.filter(function(o){return n==Zf(o)}):[]}function mw(e,t){return e.filter(function(n){return n.audio?t?n.audio.roles.includes(t):n.audio.roles.length==0:!1})}function yw(e,t){return e.filter(function(n){return n.audio&&n.audio.label?n.audio.label.toLowerCase()==t.toLowerCase():!1})}function vw(e,t){return e.filter(function(n){return n.video&&n.video.label?n.video.label.toLowerCase()==t.toLowerCase():!1})}function xw(e,t){return e.filter(function(n){return!(n.audio&&n.audio.channelsCount&&n.audio.channelsCount!=t)})}function ww(e,t){return t=="AUTO"&&(t=d.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR"),e.filter(function(n){return!(n.video&&n.video.hdr&&n.video.hdr!=t)})}function Sw(e,t){return e.filter(function(n){return!(n.video&&n.video.videoLayout&&n.video.videoLayout!=t)})}function Tw(e,t){return e.filter(function(n){return!(n.audio&&n.audio.spatialAudio!=t)})}function Cw(){this.g=fl,this.h=new Map().set(fl,2).set(hr,1)}function a0(e,t,n){e.h.set(fl,n).set(hr,t)}var hr=0,fl=1;function l0(e,t){var n=Ri();this.l=e.maxAttempts==null?n.maxAttempts:e.maxAttempts,this.j=e.baseDelay==null?n.baseDelay:e.baseDelay,this.o=e.fuzzFactor==null?n.fuzzFactor:e.fuzzFactor,this.m=e.backoffFactor==null?n.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=t===void 0?!1:t)&&(this.g=1)}function u0(e){var t,n;return z(function(o){if(o.g==1){if(e.g>=e.l)if(e.i)e.g=1,e.h=e.j;else throw new K(2,7,1010);return t=e.g,e.g++,t==0?o.return():(n=e.h*(1+(2*Math.random()-1)*e.o),E(o,new Promise(function(a){new st(a).U(n/1e3)}),2))}e.h*=e.m,F(o)})}function Ri(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}}function bt(){var e,t,n=new Promise(function(o,a){e=o,t=a});return n.resolve=e,n.reject=t,n}bt.prototype.resolve=function(){},bt.prototype.reject=function(){};function Ut(e,t){this.promise=e,this.i=t,this.g=!1}function Do(e){return new Ut(Promise.reject(e),function(){return Promise.resolve()})}function uc(){var e=Promise.reject(new K(2,7,7001));return e.catch(function(){}),new Ut(e,function(){return Promise.resolve()})}function dr(e){return new Ut(Promise.resolve(e),function(){return Promise.resolve()})}function f0(e){return new Ut(e,function(){return e.catch(function(){})})}Ut.prototype.abort=function(){return this.g=!0,this.i()};function c0(e){return new Ut(Promise.all(e.map(function(t){return t.promise})),function(){return Promise.all(e.map(function(t){return t.abort()}))})}Ut.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},Ut.prototype.pa=function(e,t){function n(c){return function(p){if(a.g&&c)l.reject(f);else{var m=c?e:t;m?o=Ew(m,p,l):(c?l.resolve:l.reject)(p)}}}function o(){return l.reject(f),a.abort()}var a=this,l=new bt,f=new K(2,7,7001);return this.promise.then(n(!0),n(!1)),new Ut(l,function(){return o()})};function Ew(e,t,n){try{var o=e(t);return o&&o.promise&&o.abort?(n.resolve(o.promise),function(){return o.abort()}):(n.resolve(o),function(){return Promise.resolve(o).then(function(){},function(){})})}catch(a){return n.reject(a),function(){return Promise.resolve()}}}ae("shaka.util.AbortableOperation",Ut),Ut.prototype.chain=Ut.prototype.pa,Ut.prototype.finally=Ut.prototype.finally,Ut.all=c0,Ut.prototype.abort=Ut.prototype.abort,Ut.notAbortable=f0,Ut.completed=dr,Ut.aborted=uc,Ut.failed=Do;function We(e,t){if(t)if(t instanceof Map)for(var n=w(t.keys()),o=n.next();!o.done;o=n.next())o=o.value,Object.defineProperty(this,o,{value:t.get(o),writable:!0,enumerable:!0});else for(n in t)Object.defineProperty(this,n,{value:t[n],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=d.performance&&d.performance.now?d.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function h0(e){var t=new We(e.type),n;for(n in e)Object.defineProperty(t,n,{value:e[n],writable:!0,enumerable:!0});return t}We.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},We.prototype.stopImmediatePropagation=function(){this.g=!0},We.prototype.stopPropagation=function(){},ae("shaka.util.FakeEvent",We);var cl={hi:"abrstatuschanged",ii:"adaptation",ji:"buffering",ki:"complete",li:"downloadfailed",mi:"downloadheadersreceived",ni:"drmsessionupdate",pi:"emsg",Gi:"prft",Error:"error",ri:"expirationupdated",si:"firstquartile",ti:"gapjumped",wi:"keystatuschanged",yi:"loaded",zi:"loading",Bi:"manifestparsed",Ci:"manifestupdated",Di:"mediaqualitychanged",Metadata:"metadata",Ei:"midpoint",Fi:"onstatechange",Ii:"ratechange",Ji:"segmentappended",Ki:"sessiondata",Li:"stalldetected",Mi:"started",Ni:"statechanged",Oi:"streaming",Pi:"textchanged",Qi:"texttrackvisibility",Ri:"thirdquartile",Si:"timelineregionadded",Ti:"timelineregionenter",Ui:"timelineregionexit",Vi:"trackschanged",Xi:"unloading",Zi:"variantchanged"};function dt(){this.ka=new Za,this.zd=this}dt.prototype.addEventListener=function(e,t){this.ka&&this.ka.push(e,t)},dt.prototype.removeEventListener=function(e,t){this.ka&&this.ka.remove(e,t)},dt.prototype.dispatchEvent=function(e){if(!this.ka)return!0;var t=this.ka.get(e.type)||[],n=this.ka.get("All");for(n&&(t=t.concat(n)),t=w(t),n=t.next();!n.done;n=t.next()){n=n.value,e.target=this.zd,e.currentTarget=this.zd;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch{}if(e.g)break}return e.defaultPrevented},dt.prototype.release=function(){this.ka=null};function pr(){this.g=[]}function No(e,t){e.g.push(t.finally(function(){wn(e.g,t)}))}pr.prototype.destroy=function(){for(var e=[],t=w(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.promise.catch(function(){}),e.push(n.abort());return this.g=[],Promise.all(e)};function Tt(e,t,n,o,a){dt.call(this),this.i=!1,this.m=new pr,this.g=new Set,this.h=new Set,this.l=e||null,this.j=t||null,this.s=n||null,this.u=o||null,this.A=a||null,this.o=!1}Z(Tt,dt),s=Tt.prototype,s.nf=function(e){this.o=e};function zi(e,t,n,o){n=n||m0;var a=dl[e];(!a||n>=a.priority)&&(dl[e]={priority:n,Vd:t,Ih:o===void 0?!1:o})}s.Jh=function(e){this.g.add(e)},s.bi=function(e){this.g.delete(e)},s.Hg=function(){this.g.clear()},s.Kh=function(e){this.h.add(e)},s.ci=function(e){this.h.delete(e)},s.Ig=function(){this.h.clear()};function Yt(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:n===void 0?null:n}}s.destroy=function(){return this.i=!0,this.g.clear(),this.h.clear(),dt.prototype.release.call(this),this.m.destroy()},s.request=function(e,t,n){var o=this,a=new g0;if(this.i){var l=Promise.reject(new K(2,7,7001));return l.catch(function(){}),new hl(l,function(){return Promise.resolve()},a)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?Lo(t.retryParameters):Ri(),t.uris=Lo(t.uris),l=Aw(this,e,t,n);var f=l.pa(function(){return d0(o,e,t,n,new l0(t.retryParameters,!1),0,null,a)}),c=f.pa(function(C){return bw(o,e,C,n)}),p=Date.now(),m=0;l.promise.then(function(){m=Date.now()-p},function(){});var v=0;f.promise.then(function(){v=Date.now()},function(){});var S=c.pa(function(C){var T=Date.now()-v,I=C.response;return I.timeMs+=m,I.timeMs+=T,C.qh||!o.l||I.fromCache||t.method=="HEAD"||e!=Li||o.l(I.timeMs,I.data.byteLength,p0(n)),I},function(C){throw C&&(C.severity=2),C});return l=new hl(S.promise,function(){return S.abort()},a),No(this.m,l),l};function Aw(e,t,n,o){function a(c){l=l.pa(function(){return n.body&&(n.body=Pt(n.body)),c(t,n,o)})}var l=dr(void 0);e.u&&a(e.u),e=w(e.g);for(var f=e.next();!f.done;f=e.next())a(f.value);return l.pa(void 0,function(c){throw c instanceof K&&c.code==7001?c:new K(2,1,1006,c)})}function d0(e,t,n,o,a,l,f,c){e.o&&(n.uris[l]=n.uris[l].replace("http://","https://")),0<l&&e.A&&e.A(t,o,n.uris[l],n.uris[l-1]);var p=new Bt(n.uris[l]),m=p.ab,v=!1;m||(m=location.protocol,m=m.slice(0,-1),Wa(p,m),n.uris[l]=p.toString()),m=m.toLowerCase();var S=(m=dl[m])?m.Vd:null;if(!S)return Do(new K(2,1,1e3,p));var C=m.Ih,T=null,I=null,_=!1,N=!1,j;return f0(u0(a)).pa(function(){if(e.i)return uc();j=Date.now();var O=S(n.uris[l],n,t,function(q,te,de){T&&T.stop(),I&&I.U(V/1e3),e.l&&t==Li&&(e.l(q,te,p0(o)),v=!0,c.g=de)},function(q){e.j&&e.j(q,n,t),N=!0});if(!C)return O;var X=n.retryParameters.connectionTimeout;X&&(T=new st(function(){_=!0,O.abort()}),T.U(X/1e3));var V=n.retryParameters.stallTimeout;return V&&(I=new st(function(){_=!0,O.abort()})),O}).pa(function(O){T&&T.stop(),I&&I.stop(),O.timeMs==null&&(O.timeMs=Date.now()-j);var X={response:O,qh:v};return!N&&e.j&&e.j(O.headers,n,t),X},function(O){if(T&&T.stop(),I&&I.stop(),e.s){var X=null,V=0;O instanceof K&&(X=O,O.code==1001&&(V=O.data[1])),e.s(n,X,V,_)}if(e.i)return uc();if(_&&(O=new K(1,1,1003,n.uris[l],t)),O instanceof K){if(O.code==7001)throw O;if(O.code==1010)throw f;if(O.severity==1)return X=new Map().set("error",O),X=new We("retry",X),e.dispatchEvent(X),l=(l+1)%n.uris.length,d0(e,t,n,o,a,l,O,c)}throw O})}function bw(e,t,n,o){var a=dr(void 0),l={};e=w(e.h);for(var f=e.next();!f.done;l={de:l.de},f=e.next())l.de=f.value,a=a.pa(function(c){return function(){var p=n.response;return p.data&&(p.data=Pt(p.data)),c.de(t,p,o)}}(l));return a.pa(function(){return n},function(c){var p=2;if(c instanceof K){if(c.code==7001)throw c;p=c.severity}throw new K(p,1,1007,c)})}function p0(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.Zc)return!1}return!0}ae("shaka.net.NetworkingEngine",Tt),Tt.prototype.request=Tt.prototype.request,Tt.prototype.destroy=Tt.prototype.destroy,Tt.makeRequest=Yt,Tt.defaultRetryParameters=function(){return Ri()},Tt.prototype.clearAllResponseFilters=Tt.prototype.Ig,Tt.prototype.unregisterResponseFilter=Tt.prototype.ci,Tt.prototype.registerResponseFilter=Tt.prototype.Kh,Tt.prototype.clearAllRequestFilters=Tt.prototype.Hg,Tt.prototype.unregisterRequestFilter=Tt.prototype.bi,Tt.prototype.registerRequestFilter=Tt.prototype.Jh,Tt.unregisterScheme=function(e){delete dl[e]},Tt.registerScheme=zi,Tt.prototype.setForceHTTPS=Tt.prototype.nf;function g0(){this.g=0}Tt.NumBytesRemainingClass=g0;function hl(e,t,n){Ut.call(this,e,t),this.h=n}Z(hl,Ut),Tt.PendingRequest=hl;var Li=1;Tt.RequestType={MANIFEST:0,SEGMENT:Li,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8},Tt.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5};var m0=3;Tt.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:m0};var dl={};function gr(e){this.g=!1,this.h=new bt,this.i=e}gr.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then(function(){e.h.resolve()},function(){e.h.resolve()}))};function yt(e,t){if(e.g)throw t instanceof K&&t.code==7003?t:new K(2,7,7003,t)}function Ct(){this.g=new Za}s=Ct.prototype,s.release=function(){this.Za(),this.g=null},s.D=function(e,t,n,o){this.g&&(e=new y0(e,t,n,o),this.g.push(t,e))},s.ja=function(e,t,n,o){function a(f){l.Vb(e,t,a),n(f)}var l=this;this.D(e,t,a,o)},s.Vb=function(e,t,n){if(this.g){var o=this.g.get(t)||[];o=w(o);for(var a=o.next();!a.done;a=o.next())a=a.value,a.target!=e||n!=a.listener&&n||(a.Vb(),this.g.remove(t,a))}},s.Za=function(){if(this.g){var e=this.g,t=[],n;for(n in e.g)t.push.apply(t,R(e.g[n]));for(e=w(t),t=e.next();!t.done;t=e.next())t.value.Vb();this.g.g={}}},ae("shaka.util.EventManager",Ct),Ct.prototype.removeAll=Ct.prototype.Za,Ct.prototype.unlisten=Ct.prototype.Vb,Ct.prototype.listenOnce=Ct.prototype.ja,Ct.prototype.listen=Ct.prototype.D,Ct.prototype.release=Ct.prototype.release;function y0(e,t,n,o){this.target=e,this.type=t,this.listener=n,this.g=Iw(e,o),this.target.addEventListener(t,n,this.g)}y0.prototype.Vb=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};function Iw(e,t){if(t==null)return!1;if(typeof t=="boolean")return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter(function(o){return!n.has(o)}),kw(e)?t:t.capture||!1}function kw(e){var t=v0;if(t==null){t=!1;try{var n={},o={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",o),Object.defineProperty(n,"capture",o),o=function(){},e.addEventListener("test",o,n),e.removeEventListener("test",o,n)}catch{t=!1}v0=t}return t||!1}var v0=void 0;function fc(e,t){var n=[];e=w(e);for(var o=e.next();!o.done;o=e.next())n.push(t(o.value));return n}function Mw(e,t){e=w(e);for(var n=e.next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}function mr(e){this.h=e,this.g=void 0}mr.prototype.value=function(){return this.g==null&&(this.g=this.h()),this.g};function Rs(e){for(var t=new Map,n=w(Object.keys(e)),o=n.next();!o.done;o=n.next())o=o.value,t.set(o,e[o]);return t}function cc(e){var t={};return e.forEach(function(n,o){t[o]=n}),t}function Oo(){}function It(e){if(!e)return"";if(e=Ve(e),e[0]==239&&e[1]==187&&e[2]==191&&(e=e.subarray(3)),d.TextDecoder&&!lr())return e=new TextDecoder().decode(e),e.includes("�")&&De('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),e;for(var t="",n=0;n<e.length;++n){var o=65533;if(e[n]&128?e.length>=n+2&&(e[n]&224)==192&&(e[n+1]&192)==128?(o=(e[n]&31)<<6|e[n+1]&63,n+=1):e.length>=n+3&&(e[n]&240)==224&&(e[n+1]&192)==128&&(e[n+2]&192)==128?(o=(e[n]&15)<<12|(e[n+1]&63)<<6|e[n+2]&63,n+=2):e.length>=n+4&&(e[n]&241)==240&&(e[n+1]&192)==128&&(e[n+2]&192)==128&&(e[n+3]&192)==128&&(o=(e[n]&7)<<18|(e[n+1]&63)<<12|(e[n+2]&63)<<6|e[n+3]&63,n+=3):o=e[n],65535>=o)t+=String.fromCharCode(o);else{o-=65536;var a=o&1023;t+=String.fromCharCode(55296+(o>>10)),t+=String.fromCharCode(56320+a)}}return t}function Vi(e,t,n){if(!e)return"";if(!n&&e.byteLength%2!=0)throw new K(2,2,2004);n=Math.floor(e.byteLength/2);var o=new Uint16Array(n);e=Et(e);for(var a=0;a<n;a++)o[a]=e.getUint16(2*a,t);return dc.value()(o)}function lo(e){function t(o){return n.byteLength<=o||32<=n[o]&&126>=n[o]}if(!e)return"";var n=Ve(e);if(n[0]==239&&n[1]==187&&n[2]==191)return It(n);if(n[0]==254&&n[1]==255)return Vi(n.subarray(2),!1);if(n[0]==255&&n[1]==254)return Vi(n.subarray(2),!0);if(n[0]==0&&n[2]==0)return Vi(e,!1);if(n[1]==0&&n[3]==0)return Vi(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return It(e);throw new K(2,2,2003)}function Hi(e){if(d.TextEncoder&&!lr()){var t=new TextEncoder;return Pt(t.encode(e))}e=encodeURIComponent(e),e=unescape(e),t=new Uint8Array(e.length);for(var n=0;n<e.length;n++)t[n]=e[n].charCodeAt(0);return Pt(t)}function hc(e,t){for(var n=new ArrayBuffer(2*e.length),o=new DataView(n),a=0;a<e.length;++a)o.setUint16(2*a,e.charCodeAt(a),t);return n}ae("shaka.util.StringUtils",Oo),Oo.resetFromCharCode=function(){dc.g=void 0},Oo.toUTF16=hc,Oo.toUTF8=Hi,Oo.fromBytesAutoDetect=lo,Oo.fromUTF16=Vi,Oo.fromUTF8=It;var dc=new mr(function(){function e(n){try{var o=new Uint8Array(n);return 0<String.fromCharCode.apply(null,o).length}catch{return!1}}for(var t={yb:65536};0<t.yb;t={yb:t.yb},t.yb/=2)if(e(t.yb))return function(n){return function(o){for(var a="",l=0;l<o.length;l+=n.yb)a+=String.fromCharCode.apply(null,o.subarray(l,l+n.yb));return a}}(t);return null});function vt(e,t){this.h=Et(e),this.i=t==x0,this.g=0}s=vt.prototype,s.ia=function(){return this.g<this.h.byteLength},s.qa=function(){return this.g},s.getLength=function(){return this.h.byteLength},s.ga=function(){try{var e=this.h.getUint8(this.g);return this.g+=1,e}catch{throw $i()}},s.Ea=function(){try{var e=this.h.getUint16(this.g,this.i);return this.g+=2,e}catch{throw $i()}},s.L=function(){try{var e=this.h.getUint32(this.g,this.i);return this.g+=4,e}catch{throw $i()}},s.fg=function(){try{var e=this.h.getInt32(this.g,this.i);return this.g+=4,e}catch{throw $i()}},s.oc=function(){try{if(this.i)var e=this.h.getUint32(this.g,!0),t=this.h.getUint32(this.g+4,!0);else t=this.h.getUint32(this.g,!1),e=this.h.getUint32(this.g+4,!1)}catch{throw $i()}if(2097151<t)throw new K(2,3,3001);return this.g+=8,t*Math.pow(2,32)+e},s.ub=function(e){if(this.g+e>this.h.byteLength)throw $i();var t=Ve(this.h,this.g,e);return this.g+=e,t},s.skip=function(e){if(this.g+e>this.h.byteLength)throw $i();this.g+=e},s.Rh=function(e){if(this.g<e)throw $i();this.g-=e},s.seek=function(e){if(0>e||e>this.h.byteLength)throw $i();this.g=e},s.ad=function(){for(var e=this.g;this.ia()&&this.h.getUint8(this.g)!=0;)this.g+=1;return e=Ve(this.h,e,this.g-e),this.g+=1,It(e)};function $i(){return new K(2,3,3e3)}ae("shaka.util.DataViewReader",vt),vt.prototype.readTerminatedString=vt.prototype.ad,vt.prototype.seek=vt.prototype.seek,vt.prototype.rewind=vt.prototype.Rh,vt.prototype.skip=vt.prototype.skip,vt.prototype.readBytes=vt.prototype.ub,vt.prototype.readUint64=vt.prototype.oc,vt.prototype.readInt32=vt.prototype.fg,vt.prototype.readUint32=vt.prototype.L,vt.prototype.readUint16=vt.prototype.Ea,vt.prototype.readUint8=vt.prototype.ga,vt.prototype.getLength=vt.prototype.getLength,vt.prototype.getPosition=vt.prototype.qa,vt.prototype.hasMoreData=vt.prototype.ia;var x0=1;vt.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:x0};function St(){this.i=[],this.h=[],this.g=!1}s=St.prototype,s.box=function(e,t){return e=w0(e),this.i[e]=_w,this.h[e]=t,this},s.O=function(e,t){return e=w0(e),this.i[e]=S0,this.h[e]=t,this},s.stop=function(){this.g=!0},s.parse=function(e,t,n){for(e=new vt(e,0),this.g=!1;e.ia()&&!this.g;)this.Yc(0,e,t,n)},s.Yc=function(e,t,n,o){var a=t.qa();if(o&&a+8>t.getLength())this.g=!0;else{var l=t.L(),f=t.L(),c=gl(f),p=!1;switch(l){case 0:l=t.getLength()-a;break;case 1:if(o&&t.qa()+8>t.getLength()){this.g=!0;return}l=t.oc(),p=!0}var m=this.h[f];if(m){var v=null,S=null;if(this.i[f]==S0){if(o&&t.qa()+4>t.getLength()){this.g=!0;return}S=t.L(),v=S>>>24,S&=16777215}f=a+l,n&&f>t.getLength()&&(f=t.getLength()),o&&f>t.getLength()?this.g=!0:(o=f-t.qa(),t=0<o?t.ub(o):new Uint8Array(0),t=new vt(t,0),m({name:c,parser:this,partialOkay:n||!1,version:v,flags:S,reader:t,size:l,start:a+e,has64BitSize:p}))}else t.skip(Math.min(a+l-t.qa(),t.getLength()-t.qa()))}};function pt(e){for(var t=Ls(e);e.reader.ia()&&!e.parser.g;)e.parser.Yc(e.start+t,e.reader,e.partialOkay)}function yr(e){for(var t=Ls(e),n=e.reader.L(),o=0;o<n&&(e.parser.Yc(e.start+t,e.reader,e.partialOkay),!e.parser.g);o++);}function pl(e){var t=Ls(e);for(e.reader.skip(78);e.reader.ia()&&!e.parser.g;)e.parser.Yc(e.start+t,e.reader,e.partialOkay)}function vr(e){return function(t){e(t.reader.ub(t.reader.getLength()-t.reader.qa()))}}function w0(e){var t=0;e=w(e);for(var n=e.next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function gl(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,e&255)}function Ls(e){return 8+(e.has64BitSize?8:0)+(e.flags!=null?4:0)}ae("shaka.util.Mp4Parser",St),St.headerSize=Ls,St.typeToString=gl,St.allData=vr,St.visualSampleEntry=pl,St.sampleDescription=yr,St.children=pt,St.prototype.parseNext=St.prototype.Yc,St.prototype.parse=St.prototype.parse,St.prototype.stop=St.prototype.stop,St.prototype.fullBox=St.prototype.O,St.prototype.box=St.prototype.box;var _w=0,S0=1;function ln(){}function T0(e){return e=Ve(e),e=dc.value()(e),btoa(e)}function Uo(e,t){return t=t??!0,e=T0(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function li(e){e=d.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t}function Bo(e){for(var t=e.length/2,n=new Uint8Array(t),o=0;o<t;o++)n[o]=d.parseInt(e.substr(2*o,2),16);return n}function xr(e){var t=Ve(e);e="",t=w(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n=n.toString(16),n.length==1&&(n="0"+n),e+=n;return e}function Lt(){for(var e=Re.apply(0,arguments),t=0,n=0;n<e.length;++n)t+=e[n].byteLength;t=new Uint8Array(t);for(var o=n=0;o<e.length;++o){var a=e[o];a instanceof Uint8Array?t.set(a,n):t.set(Ve(a),n),n+=a.byteLength}return t}ae("shaka.util.Uint8ArrayUtils",ln),ln.concat=Lt,ln.toHex=xr,ln.fromHex=Bo,ln.fromBase64=li,ln.toBase64=Uo,ln.toStandardBase64=T0;function C0(e){var t=this;this.g=[],this.h=[],this.data=[],new St().box("moov",pt).box("moof",pt).O("pssh",function(n){if(!(1<n.version)){var o=Ve(n.reader.h,-12,n.size);if(t.data.push(o),t.g.push(xr(n.reader.ub(16))),0<n.version){o=n.reader.L();for(var a=0;a<o;a++){var l=xr(n.reader.ub(16));t.h.push(l)}}}}).parse(e)}function ml(e,t,n,o){var a=e.length,l=t.length+16+a;0<o&&(l+=4+16*n.size);var f=new Uint8Array(l),c=Et(f),p=0;if(c.setUint32(p,l),p+=4,c.setUint32(p,1886614376),p+=4,1>o?c.setUint32(p,0):c.setUint32(p,16777216),p+=4,f.set(t,p),p+=t.length,0<o)for(c.setUint32(p,n.size),p+=4,t=w(n),n=t.next();!n.done;n=t.next())n=Bo(n.value),f.set(n,p),p+=n.length;return c.setUint32(p,a),f.set(e,p+4),f}function ui(e,t){return e=kt(e,t),e.length!=1?null:e[0]}function Gi(e,t,n){return e=E0(e,t,n),e.length!=1?null:e[0]}function kt(e,t){var n=[];e=w(e.childNodes);for(var o=e.next();!o.done;o=e.next())o=o.value,o instanceof Element&&o.tagName==t&&n.push(o);return n}function Rw(e){return Array.from(e.childNodes).filter(function(t){return t instanceof Element})}function E0(e,t,n){var o=[];e=w(e.childNodes);for(var a=e.next();!a.done;a=e.next())a=a.value,a instanceof Element&&a.localName==n&&a.namespaceURI==t&&o.push(a);return o}function jo(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function Pi(e,t,n){t=w(t);for(var o=t.next();!o.done;o=t.next())if(o=o.value,e.hasAttributeNS(o,n))return e.getAttributeNS(o,n);return null}function Fo(e){return Array.from(e.childNodes).every(pc)?e.textContent.trim():null}function pc(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}function at(e,t,n,o){o=o===void 0?null:o;var a=null;return e=e.getAttribute(t),e!=null&&(a=n(e)),a??o}function A0(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function Wi(e){return!e||(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e),!e)?null:(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null)}function yl(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return!t||(e=Number(t[1]),!isFinite(e))?null:(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null)}function vl(e){return e=Number(e),e%1===0?e:null}function Xi(e){return e=Number(e),e%1===0&&0<e?e:null}function dn(e){return e=Number(e),e%1===0&&0<=e?e:null}function Ps(e){return e=Number(e),isNaN(e)?null:e}function gc(e){return e?e.toLowerCase()==="true":!1}function Lw(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function wr(e,t){var n=new DOMParser,o=Pw.value()(e);e=null;try{e=n.parseFromString(o,"text/xml")}catch{return null}if(n=e.documentElement,!n||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;if(!("createNodeIterator"in document))return n;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}function mc(e,t){try{var n=lo(e);return wr(n,t)}catch{return null}}var Pw=new mr(function(){if(typeof trustedTypes<"u"){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(t){return t}});return function(t){return e.createHTML(t)}}return function(t){return t}});function xl(e,t){var n=this;t=t===void 0?1:t,this.C=e,this.H=new Set,this.m=this.s=null,this.ma=this.da=!1,this.I=0,this.g=null,this.A=new Ct,this.i=new Map,this.u=new Map,this.l=new bt,this.h=null,this.o=function(o){o.severity==2&&n.l.reject(o),e.onError(o)},this.V=new Map,this.ea=new Map,this.W=new st(function(){return $w(n)}),this.K=!1,this.J=[],this.N=!1,this.ka=new st(function(){Xw(n)}).$a(t),this.l.catch(function(){}),this.j=new gr(function(){return Dw(n)}),this.Y=!1,this.F=this.G=null}s=xl.prototype,s.destroy=function(){return this.j.destroy()};function Dw(e){return z(function(t){switch(t.g){case 1:return e.A.release(),e.A=null,e.l.reject(),e.ka.stop(),e.ka=null,e.W.stop(),e.W=null,E(t,O0(e),2);case 2:if(!e.m){t.B(3);break}return re(t,4),E(t,e.m.setMediaKeys(null),6);case 6:ie(t,5);break;case 4:se(t);case 5:e.m=null;case 3:e.g=null,e.H.clear(),e.s=null,e.u=new Map,e.h=null,e.o=function(){},e.C=null,e.Y=!1,e.G=null,F(t)}})}s.configure=function(e){this.h=e};function Nw(e,t,n){return e.ma=!0,e.u=new Map,e.K=n,I0(e,t)}function b0(e,t,n){e.u=new Map,n=w(n);for(var o=n.next();!o.done;o=n.next())e.u.set(o.value,{initData:null,initDataType:null});for(n=w(e.h.persistentSessionsMetadata),o=n.next();!o.done;o=n.next())o=o.value,e.u.set(o.sessionId,{initData:o.initData,initDataType:o.initDataType});return e.K=0<e.u.size,I0(e,t)}function Ow(e,t,n,o,a,l){var f=new Map;return a={audioCapabilities:a,videoCapabilities:l,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t},a.drmInfos=[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:o,serverCertificateUri:"",initData:null,keyIds:null}],f.set(t,a),L0(e,f,[])}function I0(e,t){var n,o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O;return z(function(X){if(X.g==1){if(n=Vw(e))for(o=w(t),a=o.next();!a.done;a=o.next())l=a.value,l.video&&(l.video.drmInfos=[n]),l.audio&&(l.audio.drmInfos=[n]);for(f=t.some(function(V){return!!(V.video&&V.video.drmInfos.length||V.audio&&V.audio.drmInfos.length)}),f||(c=Rs(e.h.servers),Yw(t,c)),p=new Set,m=w(t),a=m.next();!a.done;a=m.next())for(v=a.value,S=B0(v),C=w(S),T=C.next();!T.done;T=C.next())I=T.value,p.add(I);for(_=w(p),T=_.next();!T.done;T=_.next())N=T.value,qw(N,Rs(e.h.servers),Rs(e.h.advanced||{}),e.h.keySystemsMapping);return E(X,Yp(t,e.K,e.Y,e.h.preferredKeySystems),2)}return j=f||Object.keys(e.h.servers).length,j?(O=L0(e,void 0,t),X.return(f?O:O.catch(function(){}))):(e.da=!0,X.return(Promise.resolve()))})}function k0(e){var t;return z(function(n){switch(n.g){case 1:if(e.m.mediaKeys)return n.return();if(!e.G){n.B(2);break}return E(n,e.G,3);case 3:return yt(e.j),n.return();case 2:return re(n,4),e.G=e.m.setMediaKeys(e.s),E(n,e.G,6);case 6:ie(n,5);break;case 4:t=se(n),e.o(new K(2,6,6003,t.message));case 5:yt(e.j),F(n)}})}function Uw(e,t){return z(function(n){if(n.g==1)return E(n,k0(e),2);Ds(e,t.initDataType,Ve(t.initData)),F(n)})}s.Ic=function(e){var t=this;return z(function(n){if(n.g==1)return t.s?(t.m=e,t.A.ja(t.m,"play",function(){for(var o=w(t.J),a=o.next();!a.done;a=o.next())vc(t,a.value);t.N=!0,t.J=[]}),"webkitCurrentPlaybackTargetIsWireless"in t.m&&t.A.D(t.m,"webkitcurrentplaybacktargetiswirelesschanged",function(){return O0(t)}),t.F=t.g&&t.g.initData.find(function(o){return 0<o.initData.length})||null,t.F||t.g.keySystem!=="com.apple.fps"||t.u.size?E(n,k0(t),2):n.B(2)):(t.A.ja(e,"encrypted",function(){t.o(new K(2,6,6010))}),n.return());M0(t).catch(function(){}),t.F||t.u.size||t.h.parseInbandPsshEnabled||t.A.D(t.m,"encrypted",function(o){return Uw(t,o)}),F(n)})};function Bw(e){var t,n,o,a,l;return z(function(f){switch(f.g){case 1:if(!e.s||!e.g)return f.return();if(!e.g.serverCertificateUri||e.g.serverCertificate&&e.g.serverCertificate.length){f.B(2);break}return t=Yt([e.g.serverCertificateUri],e.h.retryParameters),re(f,3),n=e.C.Tb.request(5,t),E(f,n.promise,5);case 5:o=f.h,e.g.serverCertificate=Ve(o.data),ie(f,4);break;case 3:throw a=se(f),new K(2,6,6017,a);case 4:if(e.j.g)return f.return();case 2:return!e.g.serverCertificate||!e.g.serverCertificate.length?f.return():(re(f,6),E(f,e.s.setServerCertificate(e.g.serverCertificate),8));case 8:ie(f,0);break;case 6:throw l=se(f),new K(2,6,6004,l.message)}})}function jw(e,t){var n,o,a;return z(function(l){if(l.g==1)return E(l,D0(e,t,{initData:null,initDataType:null}),2);if(l.g!=3)return n=l.h,n?(o=[],(a=e.i.get(n))&&(a.hb=new bt,o.push(a.hb)),o.push(n.remove()),E(l,Promise.all(o),3)):l.return();e.i.delete(n),F(l)})}function M0(e){var t,n,o,a,l;return z(function(f){if(f.g==1)return e.u.size?(e.u.forEach(function(c,p){D0(e,p,c)}),E(f,e.l,3)):f.B(2);if(f.g!=2){if(t=e.g&&e.g.keyIds||new Set([]),0<t.size&&Kw(e))return f.return(e.l);e.l=new bt,e.l.catch(function(){})}for(n=(e.g?e.g.initData:[])||[],o=w(n),a=o.next();!a.done;a=o.next())l=a.value,Ds(e,l.initDataType,l.initData);return n.length||e.l.resolve(),f.return(e.l)})}function Ds(e,t,n){if(n.length){var o=e.i.values();o=w(o);for(var a=o.next();!a.done;a=o.next())if(nt(n,a.value.initData)&&e.h.ignoreDuplicateInitData)return;0<e.i.size&&wc(e)&&(e.l.resolve(),e.l=new bt,e.l.catch(function(){})),Hw(e,t,n,e.g.sessionType)}}function _0(e){return e?!!e.match(/^com\.(microsoft|chromecast)\.playready/):!1}function R0(e){return e=e.i.keys(),e=fc(e,function(t){return t.sessionId}),Array.from(e)}s.Fe=function(){var e=this,t=this.i.keys();return t=fc(t,function(n){var o=e.i.get(n);return{sessionId:n.sessionId,sessionType:o.type,initData:o.initData,initDataType:o.initDataType}}),Array.from(t)},s.Qc=function(){var e=1/0,t=this.i.keys();t=w(t);for(var n=t.next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},s.Bd=function(){return cc(this.ea)};function L0(e,t,n){var o,a,l,f,c,p,m,v,S,C,T,I,_,N,j;return z(function(O){switch(O.g){case 1:if(o=new Map,n.length){a=Fw(e,n,o),O.B(2);break}return E(O,zw(e,t),3);case 3:a=O.h;case 2:if(l=a,!l)throw new K(2,6,6001);for(yt(e.j),re(O,4),e.H.clear(),f=l.getConfiguration(),c=f.audioCapabilities||[],p=f.videoCapabilities||[],m=w(c),v=m.next();!v.done;v=m.next())S=v.value,e.H.add(S.contentType.toLowerCase());for(C=w(p),v=C.next();!v.done;v=C.next())T=v.value,e.H.add(T.contentType.toLowerCase());if(n.length){var X=l.keySystem,V=o.get(l.keySystem),q=[],te=[],de=[],ce=[],he=new Set;j0(V,q,de,te,ce,he);var ge=e.K?"persistent-license":"temporary";for(X={keySystem:X,licenseServerUri:q[0],distinctiveIdentifierRequired:V[0].distinctiveIdentifierRequired,persistentStateRequired:V[0].persistentStateRequired,sessionType:V[0].sessionType||ge,audioRobustness:V[0].audioRobustness||"",videoRobustness:V[0].videoRobustness||"",serverCertificate:de[0],serverCertificateUri:te[0],initData:ce,keyIds:he},V=w(V),q=V.next();!q.done;q=V.next())q=q.value,q.distinctiveIdentifierRequired&&(X.distinctiveIdentifierRequired=q.distinctiveIdentifierRequired),q.persistentStateRequired&&(X.persistentStateRequired=q.persistentStateRequired);V=X}else V=l.keySystem,X=t.get(l.keySystem),q=[],te=[],de=[],ce=[],he=new Set,j0(X.drmInfos,q,de,te,ce,he),V={keySystem:V,licenseServerUri:q[0],distinctiveIdentifierRequired:X.distinctiveIdentifier=="required",persistentStateRequired:X.persistentState=="required",sessionType:X.sessionTypes[0]||"temporary",audioRobustness:(X.audioCapabilities?X.audioCapabilities[0].robustness:"")||"",videoRobustness:(X.videoCapabilities?X.videoCapabilities[0].robustness:"")||"",serverCertificate:de[0],serverCertificateUri:te[0],initData:ce,keyIds:he};if(e.g=V,!e.g.licenseServerUri)throw new K(2,6,6012,e.g.keySystem);return E(O,l.createMediaKeys(),6);case 6:if(I=O.h,yt(e.j),e.s=I,!(e.h.minHdcpVersion!=""&&"getStatusForPolicy"in e.s)){O.B(7);break}return re(O,8),E(O,e.s.getStatusForPolicy({minHdcpVersion:e.h.minHdcpVersion}),10);case 10:if(_=O.h,_!="usable")throw new K(2,6,6018);yt(e.j),ie(O,7,4);break;case 8:throw N=se(O,4),N instanceof K?N:new K(2,6,6019,N.message);case 7:return e.da=!0,E(O,Bw(e),11);case 11:yt(e.j),ie(O,0);break;case 4:throw j=se(O),yt(e.j,j),e.g=null,e.H.clear(),j instanceof K?j:new K(2,6,6002,j.message)}})}function Fw(e,t,n){for(var o=w(t),a=o.next();!a.done;a=o.next()){var l=w(B0(a.value));for(a=l.next();!a.done;a=l.next())a=a.value,n.has(a.keySystem)||n.set(a.keySystem,[]),n.get(a.keySystem).push(a)}if(n.size==1&&n.has(""))throw new K(2,6,6e3);for(o={},e=w(e.h.preferredKeySystems),a=e.next();!a.done;o={ce:o.ce},a=e.next())for(o.ce=a.value,l=w(t),a=l.next();!a.done;a=l.next())if(a=a.value.decodingInfos.find(function(m){return function(v){return v.supported&&v.keySystemAccess!=null&&v.keySystemAccess.keySystem==m.ce}}(o)))return a.keySystemAccess;for(e=w([!0,!1]),a=e.next();!a.done;a=e.next())for(o=a.value,l=w(t),a=l.next();!a.done;a=l.next()){var f=w(a.value.decodingInfos);for(a=f.next();!a.done;a=f.next()){var c=a.value;if(c.supported&&c.keySystemAccess){a=n.get(c.keySystemAccess.keySystem);var p=w(a);for(a=p.next();!a.done;a=p.next())if(!!a.value.licenseServerUri==o)return c.keySystemAccess}}}return null}function zw(e,t){var n,o,a,l,f,c,p,m,v,S,C,T,I,_,N;return z(function(j){switch(j.g){case 1:if(t.size==1&&t.has(""))throw new K(2,6,6e3);for(o=w(t.values()),a=o.next();!a.done;a=o.next())l=a.value,l.audioCapabilities.length==0&&delete l.audioCapabilities,l.videoCapabilities.length==0&&delete l.videoCapabilities;f=w(e.h.preferredKeySystems),c=f.next();case 2:if(c.done){j.B(4);break}if(p=c.value,!t.has(p)){j.B(3);break}return m=t.get(p),re(j,6),E(j,navigator.requestMediaKeySystemAccess(p,[m]),8);case 8:return n=j.h,j.return(n);case 6:se(j);case 7:yt(e.j);case 3:c=f.next(),j.B(2);break;case 4:v=w([!0,!1]),S=v.next();case 9:if(S.done){j.B(11);break}C=S.value,T=w(t.keys()),c=T.next();case 12:if(c.done){S=v.next(),j.B(9);break}if(I=c.value,_=t.get(I),N=_.drmInfos.some(function(O){return!!O.licenseServerUri}),N!=C){j.B(13);break}return re(j,15),E(j,navigator.requestMediaKeySystemAccess(I,[_]),17);case 17:return n=j.h,j.return(n);case 15:se(j);case 16:yt(e.j);case 13:c=T.next(),j.B(12);break;case 11:return j.return(n)}})}function Vw(e){if(e=Rs(e.h.clearKeys),e.size==0)return null;var t=[],n=[];e.forEach(function(a,l){var f=l;f.length!=22&&(f=Uo(Bo(l),!1)),l=a,l.length!=22&&(l=Uo(Bo(a),!1)),a={kty:"oct",kid:f,k:l},t.push(a),n.push(a.kid)}),e=JSON.stringify({keys:t});var o=JSON.stringify({kids:n});return o=[{initData:Ve(Hi(o)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+d.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:o,keyIds:new Set(n)}}function yc(e){wc(e)&&e.l.resolve()}function P0(e,t){new st(function(){t.loaded=!0,yc(e)}).U(Zw)}function D0(e,t,n){var o,a,l,f,c,p,m;return z(function(v){switch(v.g){case 1:try{o=e.s.createSession("persistent-license")}catch(S){return a=new K(2,6,6005,S.message),e.o(a),v.return(Promise.reject(a))}return e.A.D(o,"message",function(S){e.m&&e.h.delayLicenseRequestUntilPlayed&&e.m.paused&&!e.N?e.J.push(S):vc(e,S)}),e.A.D(o,"keystatuseschange",function(S){return N0(e,S)}),l={initData:n.initData,initDataType:n.initDataType,loaded:!1,$e:1/0,hb:null,type:"persistent-license"},e.i.set(o,l),re(v,2),E(v,o.load(t),4);case 4:return f=v.h,yt(e.j),f||(e.i.delete(o),c=e.h.persistentSessionOnlinePlayback?1:2,e.o(new K(c,6,6013)),l.loaded=!0),P0(e,l),yc(e),v.return(o);case 2:p=se(v),yt(e.j,p),e.i.delete(o),m=e.h.persistentSessionOnlinePlayback?1:2,e.o(new K(m,6,6005,p.message)),l.loaded=!0,yc(e);case 3:return v.return(Promise.resolve())}})}function Hw(e,t,n,o){try{var a=e.s.createSession(o)}catch(l){e.o(new K(2,6,6005,l.message));return}e.A.D(a,"message",function(l){e.m&&e.h.delayLicenseRequestUntilPlayed&&e.m.paused&&!e.N?e.J.push(l):vc(e,l)}),e.A.D(a,"keystatuseschange",function(l){return N0(e,l)}),e.i.set(a,{initData:n,initDataType:t,loaded:!1,$e:1/0,hb:null,type:o});try{n=e.h.initDataTransform(n,t,e.g)}catch(l){t=l,l instanceof K||(t=new K(2,6,6016,l)),e.o(t);return}e.h.logLicenseExchange&&Uo(n),a.generateRequest(t,n).catch(function(l){if(!e.j.g){e.i.delete(a);var f=l.errorCode;if(f&&f.systemCode){var c=f.systemCode;0>c&&(c+=Math.pow(2,32)),c="0x"+c.toString(16)}e.o(new K(2,6,6006,l.message,l,c))}})}function vc(e,t){var n,o,a,l,f,c,p,m,v,S,C,T,I;z(function(_){switch(_.g){case 1:if(n=t.target,e.h.logLicenseExchange&&Uo(t.message),o=e.i.get(n),a=e.g.licenseServerUri,l=e.h.advanced[e.g.keySystem],t.messageType=="individualization-request"&&l&&l.individualizationServer&&(a=l.individualizationServer),f=Yt([a],e.h.retryParameters),f.body=t.message,f.method="POST",f.licenseRequestType=t.messageType,f.sessionId=n.sessionId,f.drmInfo=e.g,o&&(f.initData=o.initData,f.initDataType=o.initDataType),_0(e.g.keySystem)){var N=Vi(f.body,!0,!0);if(N.includes("PlayReadyKeyMessage")){N=wr(N,"PlayReadyKeyMessage");for(var j=w(N.getElementsByTagName("HttpHeader")),O=j.next();!O.done;O=j.next())O=O.value,f.headers[O.getElementsByTagName("name")[0].textContent]=O.getElementsByTagName("value")[0].textContent;f.body=li(N.getElementsByTagName("Challenge")[0].textContent)}else f.headers["Content-Type"]="text/xml; charset=utf-8"}return c=Date.now(),re(_,2),m=e.C.Tb.request(2,f),E(_,m.promise,4);case 4:p=_.h,ie(_,3);break;case 2:return v=se(_),S=new K(2,6,6007,v),e.o(S),o&&o.hb&&o.hb.reject(S),_.return();case 3:return e.j.g?_.return():(e.I+=(Date.now()-c)/1e3,e.h.logLicenseExchange&&Uo(p.data),re(_,5),E(_,n.update(p.data),7));case 7:ie(_,6);break;case 5:return C=se(_),T=new K(2,6,6008,C.message),e.o(T),o&&o.hb&&o.hb.reject(T),_.return();case 6:if(e.j.g)return _.return();I=new We("drmsessionupdate"),e.C.onEvent(I),o&&(o.hb&&o.hb.resolve(),P0(e,o)),F(_)}})}function N0(e,t){t=t.target;var n=e.i.get(t),o=!1;t.keyStatuses.forEach(function(l,f){if(typeof f=="string"){var c=f;f=l,l=c}if(_0(e.g.keySystem)&&f.byteLength==16&&(Jf()||lr())){c=Et(f);var p=c.getUint32(0,!0),m=c.getUint16(4,!0),v=c.getUint16(6,!0);c.setUint32(0,p,!1),c.setUint16(4,m,!1),c.setUint16(6,v,!1)}l!="status-pending"&&(n.loaded=!0),l=="expired"&&(o=!0),f=xr(f).slice(0,32),e.V.set(f,l)});var a=t.expiration-Date.now();(0>a||o&&1e3>a)&&n&&!n.hb&&(e.i.delete(t),t.close().catch(function(){})),wc(e)&&(e.l.resolve(),e.W.U(Jw))}function $w(e){var t=e.V,n=e.ea;n.clear(),t.forEach(function(o,a){return n.set(a,o)}),t=Array.from(n.values()),t.length&&t.every(function(o){return o=="expired"})&&e.o(new K(2,6,6014)),e.C.Ud(cc(n))}function Gw(){var e,t,n,o,a,l,f,c;return z(function(p){return p.g==1?(e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.recommendation com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" "),t=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],n={initDataTypes:["cenc"],videoCapabilities:t},o={videoCapabilities:t,persistentState:"required",sessionTypes:["persistent-license"]},a=[o,n],l=new Map,f=function(m){var v,S,C;return z(function(T){switch(T.g){case 1:if(re(T,2),m==="org.w3.clearkey"&&nl())throw Error("Unsupported keySystem");return E(T,navigator.requestMediaKeySystemAccess(m,a),4);case 4:return v=T.h,C=(S=v.getConfiguration().sessionTypes)?S.includes("persistent-license"):!1,Ja()&&(C=!1),l.set(m,{persistentState:C}),E(T,v.createMediaKeys(),5);case 5:ie(T,0);break;case 2:se(T),l.set(m,null),F(T)}})},c=e.map(function(m){return f(m)}),E(p,Promise.all(c),2)):p.return(cc(l))})}function Ww(e){var t;return z(function(n){if(n.g==1)return t=new Promise(function(o,a){new st(a).U(Qw)}),re(n,2),E(n,Promise.race([Promise.all([e.close(),e.closed]),t]),4);if(n.g!=2)return ie(n,0);se(n),F(n)})}function O0(e){var t;return z(function(n){return t=Array.from(e.i.entries()),e.i.clear(),E(n,Promise.all(t.map(function(o){o=w(o);var a=o.next().value,l=o.next().value;return z(function(f){if(f.g==1)return re(f,2),e.ma||e.u.has(a.sessionId)||l.type!=="persistent-license"||e.h.persistentSessionOnlinePlayback?E(f,Ww(a),5):E(f,a.remove(),5);if(f.g!=2)return ie(f,0);se(f),F(f)})})),0)})}function U0(e,t){return e.length&&t.length&&e!==t?0<xc(e,t).length:!0}function xc(e,t){if(!e.length)return t;if(!t.length)return e;var n=[];e=w(e);for(var o=e.next();!o.done;o=e.next()){o=o.value;for(var a=w(t),l=a.next();!l.done;l=a.next())if(l=l.value,o.keySystem==l.keySystem){a=new Map;for(var f=w((o.initData||[]).concat(l.initData||[])),c=f.next();!c.done;c=f.next())c=c.value,a.set(c.keyId,c);a=Array.from(a.values()),f=o.keyIds&&l.keyIds?new Set([].concat(R(o.keyIds),R(l.keyIds))):o.keyIds||l.keyIds,n.push({keySystem:o.keySystem,licenseServerUri:o.licenseServerUri||l.licenseServerUri,distinctiveIdentifierRequired:o.distinctiveIdentifierRequired||l.distinctiveIdentifierRequired,persistentStateRequired:o.persistentStateRequired||l.persistentStateRequired,videoRobustness:o.videoRobustness||l.videoRobustness,audioRobustness:o.audioRobustness||l.audioRobustness,serverCertificate:o.serverCertificate||l.serverCertificate,serverCertificateUri:o.serverCertificateUri||l.serverCertificateUri,initData:a,keyIds:f});break}}return n}function B0(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function Xw(e){e.i.forEach(function(t,n){var o=t.$e,a=n.expiration;isNaN(a)&&(a=1/0),a!=o&&(e.C.onExpirationUpdated(n.sessionId,a),t.$e=a)})}function wc(e){return e=e.i.values(),Mw(e,function(t){return t.loaded})}function Kw(e){for(var t=w(e.g&&e.g.keyIds||new Set([])),n=t.next();!n.done;n=t.next())if(e.V.get(n.value)!=="usable")return!1;return!0}function Yw(e,t){var n=[];for(t.forEach(function(o,a){n.push({keySystem:a,licenseServerUri:o,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})}),e=w(e),t=e.next();!t.done;t=e.next())t=t.value,t.video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}function j0(e,t,n,o,a,l){var f={};e=w(e);for(var c=e.next();!c.done;f={Fa:f.Fa},c=e.next()){if(f.Fa=c.value,t.includes(f.Fa.licenseServerUri)||t.push(f.Fa.licenseServerUri),o.includes(f.Fa.serverCertificateUri)||o.push(f.Fa.serverCertificateUri),f.Fa.serverCertificate&&(n.some(function(v){return function(S){return nt(S,v.Fa.serverCertificate)}}(f))||n.push(f.Fa.serverCertificate)),f.Fa.initData){c={};for(var p=w(f.Fa.initData),m=p.next();!m.done;c={kd:c.kd},m=p.next())c.kd=m.value,a.some(function(v){return function(S){var C=v.kd;return S.keyId&&S.keyId==C.keyId?!0:S.initDataType==C.initDataType&&nt(S.initData,C.initData)}}(c))||a.push(c.kd)}if(f.Fa.keyIds)for(c=w(f.Fa.keyIds),p=c.next();!p.done;p=c.next())l.add(p.value)}}function qw(e,t,n,o){var a=e.keySystem;a&&(a!="org.w3.clearkey"||!e.licenseServerUri)&&(t.size&&(t=t.get(a)||"",e.licenseServerUri=t),e.keyIds||(e.keyIds=new Set),(n=n.get(a))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=n.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=n.persistentStateRequired),e.videoRobustness||(e.videoRobustness=n.videoRobustness),e.audioRobustness||(e.audioRobustness=n.audioRobustness),e.serverCertificate||(e.serverCertificate=n.serverCertificate),n.sessionType&&(e.sessionType=n.sessionType),e.serverCertificateUri||(e.serverCertificateUri=n.serverCertificateUri)),o[a]&&(e.keySystem=o[a]),d.cast&&d.cast.__platform__&&a=="com.microsoft.playready"&&(e.keySystem="com.chromecast.playready"))}var Qw=1,Zw=5,Jw=.5,wl=new mr(function(){return Pt(new Uint8Array([0]))});function Ns(){}function F0(e,t){if(t){var n=fi[t.toLowerCase()];if(n)return n}throw new K(2,4,4e3,e,t)}ae("shaka.media.ManifestParser",Ns),Ns.unregisterParserByMime=function(e){delete fi[e]},Ns.registerParserByMime=function(e,t){fi[e]=t},Ns.registerParserByExtension=function(){ai("ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},Ns.AccessibilityPurpose={Yi:"visually impaired",ui:"hard of hearing"};var fi={};function eS(e){function t(){o=!0}function n(m){l.push(m),pt(m)}e=Ve(e);var o=!1,a,l=[],f=[];if(new St().box("moov",n).box("trak",n).box("mdia",n).box("minf",n).box("stbl",n).O("stsd",function(m){a=m,l.push(m),yr(m)}).O("encv",t).O("enca",t).O("dvav",function(m){f.push({box:m,Ma:1701733238})}).O("dva1",function(m){f.push({box:m,Ma:1701733238})}).O("dvh1",function(m){f.push({box:m,Ma:1701733238})}).O("dvhe",function(m){f.push({box:m,Ma:1701733238})}).O("hev1",function(m){f.push({box:m,Ma:1701733238})}).O("hvc1",function(m){f.push({box:m,Ma:1701733238})}).O("avc1",function(m){f.push({box:m,Ma:1701733238})}).O("avc3",function(m){f.push({box:m,Ma:1701733238})}).O("ac-3",function(m){f.push({box:m,Ma:1701733217})}).O("ec-3",function(m){f.push({box:m,Ma:1701733217})}).O("ac-4",function(m){f.push({box:m,Ma:1701733217})}).O("mp4a",function(m){f.push({box:m,Ma:1701733217})}).parse(e),o)return e;if(f.length==0||!a)throw xr(e),new K(2,3,3019);f.reverse();for(var c=w(f),p=c.next();!p.done;p=c.next())p=p.value,e=tS(e,a,p.box,l,p.Ma);return e}function tS(e,t,n,o,a){var l=nS.value(),f=e.subarray(n.start,n.start+n.size),c=Et(f),p=new Uint8Array(n.size+l.byteLength);for(p.set(f,0),f=Et(p),f.setUint32(4,a),p.set(l,n.size),a=c.getUint32(4),f.setUint32(n.size+16,a),z0(p,0,p.byteLength),a=new Uint8Array(e.byteLength+p.byteLength),n=Ms()?n.start:n.start+n.size,l=e.subarray(n),a.set(e.subarray(0,n)),a.set(p,n),a.set(l,n+p.byteLength),e=w(o),o=e.next();!o.done;o=e.next())o=o.value,z0(a,o.start,o.size+p.byteLength);return p=Et(a,t.start),t=Ls(t),e=p.getUint32(t),p.setUint32(t,e+1),a}function z0(e,t,n){e=Et(e,t),t=e.getUint32(0),t!=0&&(t==1?(e.setUint32(8,n>>32),e.setUint32(12,n&4294967295)):e.setUint32(0,n))}var nS=new mr(function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])});function $n(e,t,n,o,a,l,f){this.Z=e,this.Qa=t,this.wa=n,this.Ve=o===void 0?null:o,this.timescale=a===void 0?null:a,this.g=l===void 0?null:l,this.aes128Key=f===void 0?null:f,this.mimeType=this.codecs=null}$n.prototype.ic=function(){return this.Qa},$n.prototype.fc=function(){return this.wa};function V0(e,t){return e===t?!0:e&&t?e.ic()==t.ic()&&e.fc()==t.fc()&&ii(e.Z().sort(),t.Z().sort())&&nt(e.g,t.g):e==t}ae("shaka.media.InitSegmentReference",$n),$n.prototype.getEndByte=$n.prototype.fc,$n.prototype.getStartByte=$n.prototype.ic;function Xe(e,t,n,o,a,l,f,c,p,m,v,S,C,T,I,_){for(m=m===void 0?[]:m,T=T===void 0?uo:T,this.startTime=e,this.h=this.endTime=t,this.A=n,this.Qa=o,this.wa=a,this.aa=l,this.timestampOffset=f,this.appendWindowStart=c,this.appendWindowEnd=p,this.g=m,this.tilesLayout=v===void 0?"":v,this.u=S===void 0?null:S,this.ca=C===void 0?null:C,this.status=T,this.l=!1,this.j=!0,this.m=!1,this.aes128Key=I===void 0?null:I,this.s=null,this.i=0,this.o=_===void 0?!1:_,this.Md=this.Zc=!1,e=w(this.g),t=e.next();!t.done;t=e.next())t.value.ag();this.o&&this.g.length&&this.g[this.g.length-1].$f(),this.mimeType=this.codecs=null}s=Xe.prototype,s.Z=function(){return this.A()},s.getStartTime=function(){return this.startTime},s.Ug=function(){return this.endTime},s.ic=function(){return this.Qa},s.fc=function(){return this.wa},s.lh=function(){return this.tilesLayout},s.kh=function(){return this.u},s.Pb=function(){return this.status},s.Bh=function(){this.status=H0},s.Ue=function(){this.l=!0},s.xh=function(){return this.l},s.Od=function(){this.j=!1},s.uh=function(){return this.j},s.ag=function(){this.Zc=!0},s.wh=function(){return this.Zc},s.$f=function(){this.Md=!0},s.vh=function(){return this.Md},s.Zf=function(){this.m=!0},s.rh=function(){return this.m},s.pg=function(e){this.s=e},s.jh=function(){return this.s},s.offset=function(e){this.startTime+=e,this.endTime+=e,this.h+=e;for(var t=w(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.startTime+=e,n.endTime+=e,n.h+=e},s.tf=function(e){this.ca==null?De("Sync attempted without sync time!"):(e=this.ca-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},ae("shaka.media.SegmentReference",Xe),Xe.prototype.syncAgainst=Xe.prototype.tf,Xe.prototype.offset=Xe.prototype.offset,Xe.prototype.getThumbnailSprite=Xe.prototype.jh,Xe.prototype.setThumbnailSprite=Xe.prototype.pg,Xe.prototype.hasByterangeOptimization=Xe.prototype.rh,Xe.prototype.markAsByterangeOptimization=Xe.prototype.Zf,Xe.prototype.isLastPartial=Xe.prototype.vh,Xe.prototype.markAsLastPartial=Xe.prototype.$f,Xe.prototype.isPartial=Xe.prototype.wh,Xe.prototype.markAsPartial=Xe.prototype.ag,Xe.prototype.isIndependent=Xe.prototype.uh,Xe.prototype.markAsNonIndependent=Xe.prototype.Od,Xe.prototype.isPreload=Xe.prototype.xh,Xe.prototype.markAsPreload=Xe.prototype.Ue,Xe.prototype.markAsUnavailable=Xe.prototype.Bh,Xe.prototype.getStatus=Xe.prototype.Pb,Xe.prototype.getTileDuration=Xe.prototype.kh,Xe.prototype.getTilesLayout=Xe.prototype.lh,Xe.prototype.getEndByte=Xe.prototype.fc,Xe.prototype.getStartByte=Xe.prototype.ic,Xe.prototype.getEndTime=Xe.prototype.Ug,Xe.prototype.getStartTime=Xe.prototype.getStartTime,Xe.prototype.getUris=Xe.prototype.Z;var uo=0,H0=1;Xe.Status={gi:uo,Wi:H0,Ai:2};function Sc(e){return!e||e.length==1&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function Tc(e,t){return!e||!e.length||e.length==1&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1)?!1:t>=e.start(0)}function $0(e,t){if(!e||!e.length||e.length==1&&1e-6>e.end(0)-e.start(0))return 0;var n=0;e=w(fo(e));for(var o=e.next();!o.done;o=e.next()){var a=o.value;o=a.start,a=a.end,a>t&&(n+=a-Math.max(o,t))}return n}function iS(e,t,n){return!e||!e.length||e.length==1&&1e-6>e.end(0)-e.start(0)?null:(e=fo(e).findIndex(function(o,a,l){return o.start>t&&(a==0||l[a-1].end-t<=n)}),0<=e?e:null)}function fo(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function Cc(){}function G0(e,t){return t+10<=e.length&&e[t]===73&&e[t+1]===68&&e[t+2]===51&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function W0(e,t){return t+10<=e.length&&e[t]===51&&e[t+1]===68&&e[t+2]===73&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function Ec(e,t){var n=(e[t]&127)<<21;return n|=(e[t+1]&127)<<14,n|=(e[t+2]&127)<<7,n|=e[t+3]&127}function oS(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if(e.type==="APIC"){if(2>e.size||e.data[0]!==3)return null;var n=e.data.subarray(1).indexOf(0);if(n===-1)return null;var o=It(Ve(e.data,1,n)),a=e.data[2+n],l=e.data.subarray(3+n).indexOf(0);if(l===-1)return null;var f=It(Ve(e.data,3+n,l)),c;return o==="-->"?c=It(Ve(e.data,4+n+l)):c=Pt(e.data.subarray(4+n+l)),t.mimeType=o,t.pictureType=a,t.description=f,t.data=c,t}return e.type==="TXXX"?2>e.size||e.data[0]!==3||(o=e.data.subarray(1).indexOf(0),o===-1)?null:(n=It(Ve(e.data,1,o)),e=It(Ve(e.data,2+o)).replace(/\0*$/,""),t.description=n,t.data=e,t):e.type==="WXXX"?2>e.size||e.data[0]!==3||(o=e.data.subarray(1).indexOf(0),o===-1)?null:(n=It(Ve(e.data,1,o)),e=It(Ve(e.data,2+o)).replace(/\0*$/,""),t.description=n,t.data=e,t):e.type==="PRIV"?2>e.size||(n=e.data.indexOf(0),n===-1)?null:(n=It(Ve(e.data,0,n)),t.description=n,n=="com.apple.streaming.transportStreamTimestamp"?(n=e.data.subarray(n.length+1),e=n[3]&1,n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,e&&(n+=4772185884e-2),t.data=n):(e=Pt(e.data.subarray(n.length+1)),t.data=e),t):e.type[0]==="T"?2>e.size||e.data[0]!==3?null:(e=It(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):e.type[0]==="W"?(e=It(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=Pt(e.data),t):null}function zo(e){for(var t=0,n=[];G0(e,t);){var o=Ec(e,t+6);for(e[t+5]>>6&1&&(t+=10),t+=10,o=t+o;t+10<o;){var a=e.subarray(t),l=Ec(a,4);a={type:String.fromCharCode(a[0],a[1],a[2],a[3]),size:l,data:a.subarray(10,10+l)},(l=oS(a))&&n.push(l),t+=a.size+10}W0(e,t)&&(t+=10)}return n}function Os(e,t){for(var n=t=t===void 0?0:t,o=0;G0(e,t);)e[t+5]>>6&1&&(o+=10),o+=10,o+=Ec(e,t+6),W0(e,t+10)&&(o+=10),t+=o;return 0<o?e.subarray(n,n+o):new Uint8Array([])}ae("shaka.util.Id3Utils",Cc),Cc.getID3Data=Os,Cc.getID3Frames=zo;function X0(e,t){var n=null,o=null,a=null,l=e.L();return t&1&&(a=e.oc()),t&2&&e.skip(4),t&8&&(n=e.L()),t&16&&(o=e.L()),{trackId:l,Kf:n,Mg:o,$i:a}}function Ac(e,t){return t==1?(t=e.L(),e=e.L(),{baseMediaDecodeTime:t*Math.pow(2,32)+e}):{baseMediaDecodeTime:e.L()}}function Sl(e,t){return t==1?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.L(),e.skip(4),e=e.Ea(),{timescale:t,language:String.fromCharCode((e>>10)+96)+String.fromCharCode(((e&960)>>5)+96)+String.fromCharCode((e&31)+96)}}function K0(e,t,n){var o=e.L(),a=[],l=null;n&1&&(l=e.L()),n&4&&e.skip(4);for(var f=0;f<o;f++){var c={hf:null,sampleSize:null,Wd:null};n&256&&(c.hf=e.L()),n&512&&(c.sampleSize=e.L()),n&1024&&e.skip(4),n&2048&&(c.Wd=t==0?e.L():e.fg()),a.push(c)}return{dj:o,ig:a,Lg:l}}function Y0(e,t){t==1?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4));var n=e.L();return t==1?e.skip(8):e.skip(4),e.skip(4),e.skip(8),e.skip(2),e.skip(2),e.skip(2),e.skip(2),e.skip(36),t=e.Ea()+e.Ea()/16,e=e.Ea()+e.Ea()/16,{trackId:n,width:t,height:e}}function rS(e){for(var t="mp4a",n,o;e.ia();){n=e.ga();for(var a=e.ga();a&128;)a=e.ga();if(n==3)e.Ea(),a=e.ga(),a&128&&e.Ea(),a&64&&e.skip(e.ga()),a&32&&e.Ea();else if(n==4)o=e.ga(),e.skip(12);else if(n==5)break}return o&&(t+="."+this.g(o),n==5&&e.ia()&&(n=e.ga(),o=(n&248)>>3,o===31&&e.ia()&&(o=32+((n&7)<<3)+((e.ga()&224)>>5)),t+="."+o)),{ha:t}}function q0(e,t){return e.skip(87),{ha:t+"."+this.g(e.ga())+this.g(e.ga())+this.g(e.ga())}}function Q0(e){return e=e.L(),{ha:gl(e)}}function Ki(e,t){if(this.j=e,t!==void 0&&t){t=new Uint8Array(e.byteLength);for(var n=0,o=0;o<e.byteLength;o++)2<=o&&e[o]==3&&e[o-1]==0&&e[o-2]==0||(t[n]=e[o],n++);this.j=Ve(t,0,n)}this.i=this.j.byteLength,this.g=this.h=0}function bc(e){var t=e.j.byteLength-e.i,n=new Uint8Array(4),o=Math.min(4,e.i);o!==0&&(n.set(e.j.subarray(t,t+o)),e.h=new vt(n,0).L(),e.g=8*o,e.i-=o)}function Tn(e,t){if(e.g<=t){t-=e.g;var n=Math.floor(t/8);t-=8*n,e.g-=n,bc(e)}e.h<<=t,e.g-=t}function tt(e,t){var n=Math.min(e.g,t),o=e.h>>>32-n;return e.g-=n,0<e.g?e.h<<=n:0<e.i&&bc(e),n=t-n,0<n?o<<n|tt(e,n):o}function Ic(e){var t;for(t=0;t<e.g;++t)if(e.h&2147483648>>>t)return e.h<<=t,e.g-=t,t;return bc(e),t+Ic(e)}function pn(e){Tn(e,1+Ic(e))}function Me(e){var t=Ic(e);return tt(e,t+1)-1}function Sr(e){return e=Me(e),1&e?1+e>>>1:-1*(e>>>1)}function je(e){return tt(e,1)===1}function ut(e){return tt(e,8)}function Tl(e,t){for(var n=8,o=8,a=0;a<t;a++)o!==0&&(o=Sr(e),o=(n+o+256)%256),n=o===0?n:o}function sS(e){return ut(e),Me(e),Me(e)}ae("shaka.util.ExpGolomb",Ki);function wt(){this.A=null,this.C=!1,this.m=this.F=null,this.j=[],this.g=[],this.o=this.s=null,this.i=[],this.h=[],this.u=null,this.l=[]}s=wt.prototype,s.clearData=function(){this.j=[],this.g=[],this.i=[],this.h=[],this.l=[]},s.parse=function(e){if(564>e.length)return this;for(var t=Math.max(0,_c(e)),n=e.length-(e.length+t)%188,o=!1,a=t;a<n;a+=188)if(e[a]==71){var l=!!(e[a+1]&64),f=((e[a+1]&31)<<8)+e[a+2];if(1<(e[a+3]&48)>>4){var c=a+5+e[a+4];if(c==a+188)continue}else c=a+4;switch(f){case 0:l&&(c+=e[c]+1),this.A=(e[c+10]&31)<<8|e[c+11];break;case 17:case 8191:break;case this.A:l&&(c+=e[c]+1),l=e,f={audio:-1,video:-1,Jd:-1,audioCodec:"",videoCodec:""};var p=c+3+((l[c+1]&15)<<8|l[c+2])-4;for(c+=12+((l[c+10]&15)<<8|l[c+11]);c<p;){var m=(l[c+1]&31)<<8|l[c+2],v=(l[c+3]&15)<<8|l[c+4];switch(l[c]){case 6:if(f.audio==-1&&0<v)for(var S=c+5,C=v;2<C;){switch(l[S]){case 106:f.audio=m,f.audioCodec="ac3";break;case 122:f.audio=m,f.audioCodec="ec3"}var T=l[S+1]+2;S+=T,C-=T}break;case 15:f.audio==-1&&(f.audio=m,f.audioCodec="aac");break;case 21:f.Jd==-1&&(f.Jd=m);break;case 27:f.video==-1&&(f.video=m,f.videoCodec="avc");break;case 3:case 4:f.audio==-1&&(f.audio=m,f.audioCodec="mp3");break;case 36:f.video==-1&&(f.video=m,f.videoCodec="hvc");break;case 129:f.audio==-1&&(f.audio=m,f.audioCodec="ac3");break;case 132:case 135:f.audio==-1&&(f.audio=m,f.audioCodec="ec3")}c+=v+5}l=f,l.video!=-1&&(this.F=l.video,this.m=l.videoCodec),l.audio!=-1&&(this.s=l.audio,this.o=l.audioCodec),l.Jd!=-1&&(this.u=l.Jd),o&&!this.C&&(o=!1,a=t-188),this.C=!0;break;case this.F:c=e.subarray(c,a+188),l?this.j.push([c]):this.j.length&&this.j[this.j.length-1]&&this.j[this.j.length-1].push(c);break;case this.s:c=e.subarray(c,a+188),l?this.i.push([c]):this.i.length&&this.i[this.i.length-1]&&this.i[this.i.length-1].push(c);break;case this.u:c=e.subarray(c,a+188),l?this.l.push([c]):this.l.length&&this.l[this.l.length-1]&&this.l[this.l.length-1].push(c);break;default:o=!0}}return this};function kc(e){if((e[0]<<16|e[1]<<8|e[2])!==1)return null;var t={data:new Uint8Array(0),packetLength:e[4]<<8|e[5],pts:null,dts:null,nalus:[]};if(t.packetLength&&t.packetLength>e.byteLength-6)return null;var n=e[7];return n&192&&(t.pts=536870912*(e[9]&14)+4194304*(e[10]&255)+16384*(e[11]&254)+128*(e[12]&255)+(e[13]&254)/2,t.dts=t.pts,n&64&&(t.dts=536870912*(e[14]&14)+4194304*(e[15]&255)+16384*(e[16]&254)+128*(e[17]&255)+(e[18]&254)/2)),n=e[8]+9,e.byteLength<=n?null:(t.data=e.subarray(n),t)}s.Hh=function(e){return ai("TsParser.parseAvcNalus","Please use parseNalus function instead."),this.cf(e)},s.cf=function(e,t,n){var o=e.pts?e.pts/9e4:null;e=e.data;var a=e.byteLength,l=1;this.m=="hvc"&&(l=2);for(var f=n||0,c=[],p=-1,m=0,v,S=0;S<a;++S){var C=e[S];if(C){if(2<=f&&C==1){if(t&&!c.length&&p==-1&&(C=S-(3<f?3:f),n&&C!=0&&(C=e.subarray(0,C),t.data=Lt(t.data,C),t.fullData=Lt(t.fullData,C))),0<=p?(f=S-((3<f?3:f)+1),c.push({data:e.subarray(p+l,f+1),fullData:e.subarray(p,f+1),type:m,time:o})):t&&!c.length&&(p=S-f,0<p&&(p=e.subarray(0,p),t.data=Lt(t.data,p),t.fullData=Lt(t.fullData,p))),S>=a-l)return c;S++,p=S,m=this.m=="hvc"?e[S]>>1&63:e[S]&31}f=0}else f++;S>=a-1&&0<=p&&0<=f&&(v={data:e.subarray(p+l,a),fullData:e.subarray(p,a),type:m,time:o})}return v&&c.push(v),!c.length&&t&&(t.data=Lt(t.data,e),t.fullData=Lt(t.fullData,e)),c},s.getMetadata=function(){for(var e=[],t=w(this.l),n=t.next();!n.done;n=t.next())n=Lt.apply(ln,R(n.value)),(n=kc(n))&&e.push({cueTime:n.pts?n.pts/9e4:null,data:n.data,frames:zo(n.data),dts:n.dts,pts:n.pts});return e},s.Mb=function(){if(this.i.length&&!this.h.length){for(var e=!1,t=w(this.i),n=t.next();!n.done;n=t.next()){var o=Lt.apply(ln,R(n.value)),a=kc(o);n=this.h.length?this.h[this.h.length-1]:null,a&&a.pts!=null&&a.dts!=null&&(!n||n.pts!=a.pts&&n.dts!=a.dts)?(this.h.length&&a.dts<(n.dts||0)&&(e=!0),this.h.push(a)):this.h.length&&(o=a?a.data:o)&&(n=this.h.pop(),n.data=Lt(n.data,o),this.h.push(n))}e&&(this.h=this.h.sort(function(l,f){var c=(l.pts||0)-(f.pts||0);return(l.dts||0)-(f.dts||0)||c}))}return this.h},s.kc=function(e){if(e=e===void 0?!0:e,this.j.length&&!this.g.length){for(var t=!1,n=w(this.j),o=n.next();!o.done;o=n.next()){var a=Lt.apply(ln,R(o.value)),l=kc(a);o=this.g.length?this.g[this.g.length-1]:null,l&&l.pts!=null&&l.dts!=null&&(!o||o.pts!=l.pts&&o.dts!=l.dts)?(this.g.length&&l.dts<(o.dts||0)&&(t=!0),this.g.push(l)):this.g.length&&(a=l?l.data:a)&&(o=this.g.pop(),o.data=Lt(o.data,a),this.g.push(o))}if(e){var f;for(n=w(this.g),o=n.next();!o.done;o=n.next())o=o.value,o.nalus=this.cf(o,f,void 0),o.nalus.length&&(f=o.nalus[o.nalus.length-1]);this.g=this.g.filter(function(c){return c.nalus.length})}t&&(this.g=this.g.sort(function(c,p){var m=(c.pts||0)-(p.pts||0);return(c.dts||0)-(p.dts||0)||m}))}return e?this.g:(e=this.g,this.g=[],e)},s.getStartTime=function(e){if(e=="audio"){e=null;var t=this.Mb();return t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e}return e=="video"?(e=null,t=this.kc(!1),t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e):null},s.Pc=function(){return{audio:this.o,video:this.m}},s.Fd=function(){for(var e=[],t=w(this.kc()),n=t.next();!n.done;n=t.next())e.push.apply(e,R(n.value.nalus));return e},s.oh=function(){ai("TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.Je();return{height:e.height,width:e.width}},s.Je=function(){return this.m=="hvc"?lS(this):aS(this)};function aS(e){var t={height:null,width:null,ha:null};if(e=e.Fd(),!e.length||(e=e.find(function(C){return C.type==7}),!e))return t;e=new Ki(e.data);var n=ut(e),o=ut(e),a=ut(e);if(pn(e),uS.includes(n)){var l=Me(e);if(l===3&&Tn(e,1),pn(e),pn(e),Tn(e,1),je(e)){l=l!==3?8:12;for(var f=0;f<l;f++)je(e)&&(6>f?Tl(e,16):Tl(e,64))}}if(pn(e),l=Me(e),l===0)Me(e);else if(l===1)for(Tn(e,1),pn(e),pn(e),l=Me(e),f=0;f<l;f++)pn(e);pn(e),Tn(e,1),l=Me(e),f=Me(e);var c=tt(e,1);c===0&&Tn(e,1),Tn(e,1);var p=0,m=0,v=0,S=0;return je(e)&&(p=Me(e),m=Me(e),v=Me(e),S=Me(e)),t.height=String((2-c)*(f+1)*16-2*v-2*S),t.width=String(16*(l+1)-2*p-2*m),t.ha="avc1."+("0"+n.toString(16).toUpperCase()).slice(-2)+("0"+o.toString(16).toUpperCase()).slice(-2)+("0"+a.toString(16).toUpperCase()).slice(-2),t}function lS(e){var t={height:null,width:null,ha:null};if(e=e.Fd(),!e.length||(e=e.find(function(V){return V.type==33}),!e))return t;var n=new Ki(e.fullData,!0);ut(n),ut(n),tt(n,4);var o=tt(n,3);je(n);var a=tt(n,2),l=tt(n,1),f=tt(n,5),c=tt(n,32);e=ut(n);for(var p=ut(n),m=ut(n),v=ut(n),S=ut(n),C=ut(n),T=ut(n),I=[],_=[],N=0;N<o;N++)I.push(je(n)),_.push(je(n));if(0<o)for(N=o;8>N;N++)tt(n,2);for(N=0;N<o;N++)I[N]&&tt(n,88),_[N]&&ut(n);Me(n),o=Me(n),o==3&&tt(n,1),I=Me(n),_=Me(n);var j=N=0,O=0,X=0;return je(n)&&(N+=Me(n),j+=Me(n),O+=Me(n),X+=Me(n)),t.width=String(I-(N+j)*(o===1||o===2?2:1)),t.height=String(_-(O+X)*(o===1?2:1)),n=function(V){for(var q=0,te=0;32>te;te++)q|=(V>>te&1)<<31-te;return q>>>0}(c),l=l==1?"H":"L",a="hvc1"+("."+["","A","B","C"][a]+f),a+="."+n.toString(16).toUpperCase(),a+="."+l+T,C&&(a+="."+C.toString(16).toUpperCase()),S&&(a+="."+S.toString(16).toUpperCase()),v&&(a+="."+v.toString(16).toUpperCase()),m&&(a+="."+m.toString(16).toUpperCase()),p&&(a+="."+p.toString(16).toUpperCase()),e&&(a+="."+e.toString(16).toUpperCase()),t.ha=a,t}function Mc(e){return!(0>_c(e))}function _c(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(e[n]==71&&e[n+188]==71&&e[n+376]==71)return n;n++}return-1}ae("shaka.util.TsParser",wt),wt.syncOffset=_c,wt.probe=Mc,wt.prototype.getVideoInfo=wt.prototype.Je,wt.prototype.getVideoResolution=wt.prototype.oh,wt.prototype.getVideoNalus=wt.prototype.Fd,wt.prototype.getCodecs=wt.prototype.Pc,wt.prototype.getStartTime=wt.prototype.getStartTime,wt.prototype.getVideoData=wt.prototype.kc,wt.prototype.getAudioData=wt.prototype.Mb,wt.prototype.getMetadata=wt.prototype.getMetadata,wt.prototype.parseNalus=wt.prototype.cf,wt.prototype.parseAvcNalus=wt.prototype.Hh,wt.prototype.parse=wt.prototype.parse,wt.prototype.clearData=wt.prototype.clearData,wt.Timescale=9e4;var uS=[100,110,122,244,44,83,86,118,128,138,139,134];function Us(e,t,n){this.g=null,this.o=-1,this.l=e,this.i=t,this.m=n,this.j=!1;e:{if(typeof libDPIModule>"u"&&Le("Could not find LCEVC Library dependencies on this page"),typeof LCEVCdec<"u")this.h=LCEVCdec;else if(typeof LcevcDil<"u")this.h=LcevcDil,this.j=!0,ai("LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead");else{Le("Could not find LCEVC Library on this page"),e=!1;break e}typeof this.h.SupportObject>"u"?(Le("Could not find LCEVC Library on this page"),e=!1):(this.h.SupportObject.SupportStatus||Le(this.h.SupportObject.SupportError),e=typeof this.h<"u"&&typeof libDPIModule<"u"&&this.i instanceof HTMLCanvasElement&&this.h.SupportObject.SupportStatus)}e&&!this.g&&this.h.SupportObject.webGLSupport(this.i)&&(this.i.classList.remove("shaka-hidden"),this.g=this.j?new this.h.LcevcDil(this.l,this.i,this.m):new this.h.LCEVCdec(this.l,this.i,this.m))}function Z0(e){e.g&&e.i.classList.add("shaka-hidden")}Us.prototype.release=function(){this.g&&(this.g.close(),this.g=null)};function J0(e,t,n){var o=fS,a=gS;switch(t.mimeType){case"video/webm":o=cS;break;case"video/mp4":o=hS}switch(n){case"DASH":a=pS;break;case"HLS":a=dS}e.g&&(e.o=t.id,e.g.setLevelSwitching(t.id,!0),e.g.setContainerFormat(o),e.j||e.g.setStreamingFormat(a))}ae("shaka.lcevc.Dec",Us),Us.prototype.release=Us.prototype.release;var fS=0,cS=1,hS=2,dS=0,pS=1,gS=-1;function eg(e,t,n,o){var a=this;this.i=e,this.C=null,this.F=t,this.g={},this.G={},this.ma={},this.h=null,this.Y=!1,this.Aa=n||function(){},this.N=o||null,this.j={},this.s=new Ct,this.m={},this.H=null,this.J=new bt,this.K="",this.da=!1,this.l=tg(this,this.J),this.A=!1,this.I=new gr(function(){return mS(a)}),this.u=!1,this.W="UNKNOWN",this.ka=this.za=!1,this.Ba=new bt,this.o=!1,this.ea=!0,this.V=null}function tg(e,t){if(d.ManagedMediaSource){e.i.disableRemotePlayback=!0;var n=new ManagedMediaSource;return e.s.D(n,"startstreaming",function(){e.ea=!0}),e.s.D(n,"endstreaming",function(){e.ea=!1}),e.s.ja(n,"sourceopen",function(){URL.revokeObjectURL(e.K),t.resolve()}),e.s.ja(e.i,"playing",function(){e.da=!0}),e.K=kl(n),e.i.src=e.K,n}return n=new MediaSource,e.s.ja(n,"sourceopen",function(){URL.revokeObjectURL(e.K),t.resolve()}),e.s.ja(e.i,"playing",function(){e.da=!0}),e.K=kl(n),e.i.src=e.K,n}s=eg.prototype,s.destroy=function(){return this.I.destroy()};function mS(e){var t,n,o,a,l,f,c,p;return z(function(m){if(m.g==1){t=[];for(n in e.j)for(o=e.j[n],a=o[0],e.j[n]=o.slice(0,1),a&&t.push(a.p.catch(jp)),l=w(o.slice(1)),f=l.next();!f.done;f=l.next())c=f.value,c.p.reject(new K(2,7,7003,void 0));e.h&&t.push(e.h.destroy()),e.F&&t.push(e.F.destroy());for(p in e.m)t.push(e.m[p].destroy());return E(m,Promise.all(t),2)}e.s&&(e.s.release(),e.s=null),e.i&&(e.i.removeAttribute("src"),e.i.load(),e.i=null),e.C=null,e.l=null,e.h=null,e.F=null,e.g={},e.m={},e.H=null,e.j={},e.N=null,F(m)})}s.init=function(e,t,n,o){t=t===void 0?!1:t,n=n===void 0?"UNKNOWN":n,o=o===void 0?!1:o;var a=this,l,f,c,p,m;return z(function(v){if(v.g==1)return l=Gt,E(v,a.J,2);for(a.u=t,a.W=n,a.za=o,a.ka=!a.u&&a.W=="HLS"&&!a.za,f=w(e.keys()),c=f.next();!c.done;c=f.next())p=c.value,m=e.get(p),Cl(a,p,m,m.codecs),a.o?(a.j[l.P]=[],a.j[l.$]=[]):a.j[p]=[];F(v)})};function Cl(e,t,n,o,a){a=a===void 0?!1:a;var l=Rn(n.mimeType,o);if(t==lt)El(e,l,e.u,n.external);else{var f=e.C.forceTransmux||a;if((!ve(l)||!e.u&&rr.includes(l))&&(f=!0),a=ir(n.mimeType,o),f){if(f=Sn("audio",(o||"").split(",")),o=Sn("video",(o||"").split(",")),f&&o){e.o=!0,Cl(e,"audio",n,f,!0),Cl(e,"video",n,o,!0);return}(o=_o(a))&&(l=o(),e.m[t]=l,l=l.convertCodecs(t,a))}a=l+e.C.sourceBufferExtraFeatures,yt(e.I);try{var c=e.l.addSourceBuffer(a)}catch(p){throw new K(2,3,3015,p,"The mediaSource_ status was "+e.l.readyState+" expected 'open'")}e.u&&(c.mode=kS),e.s.D(c,"error",function(){e.j[t][0].p.reject(new K(2,3,3014,e.i.error?e.i.error.code:0))}),e.s.D(c,"updateend",function(){return Yi(e,t)}),e.g[t]=c,e.G[t]=l,e.ma[t]=!!n.drmInfos.length}}s.configure=function(e){this.C=e};function El(e,t,n,o){e.h||(e.h=new Fi(e.F));var a=e.h;o=o||e.Y,e=e.W,t=="application/cea-608"||t=="application/cea-708"?a.i=null:(a.i=(0,Kt[t])(),a.i.setSequenceMode?a.i.setSequenceMode(n):Le('Text parsers should have a "setSequenceMode" method!'),a.i.setManifestType?a.i.setManifestType(e):Le('Text parsers should have a "setManifestType" method!'),a.u=o)}function ng(e){return e.A?!1:e.l?e.l.readyState=="ended":!0}function ig(e,t){return e.A||!Object.keys(e.g).length?e=null:t==lt?e=e.h.g:(e=Tr(e,t),e=!e||e.length==1&&1e-6>e.end(0)-e.start(0)?null:e.length==1&&0>e.start(0)?0:e.length?e.start(0):null),e}function Al(e,t){return e.A?null:t==lt?e.h.h:Sc(Tr(e,t))}function yS(e,t,n){return e.A?0:t==lt?(e=e.h,e.h==null||e.h<n?0:e.h-Math.max(n,e.g)):(e=Tr(e,t),$0(e,n))}s.pb=function(){var e={total:this.A?[]:fo(this.i.buffered),audio:this.A?[]:fo(Tr(this,"audio")),video:this.A?[]:fo(Tr(this,"video")),text:[]};if(this.h){var t=this.h.g,n=this.h.h;t!=null&&n!=null&&e.text.push({start:t,end:n})}return e};function Tr(e,t){try{return e.g[t].buffered}catch{return null}}function vS(e,t,n,o,a,l){var f=null,c=Ve(n);if(rr.includes(a))l=zo(c),l.length&&o&&((t=l.find(function(S){return S.description==="com.apple.streaming.transportStreamTimestamp"}))&&t.data&&(f=Math.round(t.data)/1e3),e.Aa([{cueTime:o.startTime,data:c,frames:l,dts:o.startTime,pts:o.startTime}],0,o.endTime));else if(a.includes("/mp4")&&o&&o.timestampOffset==0&&o.aa&&o.aa.timescale){var p=o.aa.timescale;if(!isNaN(p)){var m=0,v=!1;new St().box("moof",pt).box("traf",pt).O("tfdt",function(S){m=Ac(S.reader,S.version).baseMediaDecodeTime/p,v=!0,S.parser.stop()}).parse(n,!0),v&&(f=m)}}else a.includes("/mp4")||a.includes("/webm")||!Mc(c)||(c=new wt().parse(c),t=c.getStartTime(t),t!=null&&(f=t),c=c.getMetadata(),c.length&&e.Aa(c,l,o?o.endTime:null));return f}function bl(e,t,n,o,a,l,f,c,p,m){f=f===void 0?!1:f,c=c===void 0?!1:c,p=p===void 0?!1:p,m=m===void 0?!1:m;var v,S,C,T,I,_,N,j,O,X,V;return z(function(q){switch(q.g){case 1:if(v=Gt,t!=v.na){q.B(2);break}if(!e.u){q.B(3);break}return E(q,e.Ba,4);case 4:S=q.h,e.h.s=S;case 3:return E(q,Q2(e.h,n,o?o.startTime:null,o?o.endTime:null,o?o.Z()[0]:null),5);case 5:return q.return();case 2:if(m||!e.o){q.B(6);break}return E(q,bl(e,v.P,n,o,a,l,f,c,p,!0),7);case 7:return E(q,bl(e,v.$,n,o,a,l,f,c,p,!0),8);case 8:return q.return();case 6:if(!e.g[t])return q.return();if(C=e.g[t].timestampOffset,T=e.G[t],e.m[t]&&(T=e.m[t].getOriginalMimeType()),o&&(I=vS(e,t,n,o,T,C),I!=null&&(_=o.startTime-I,N=Math.abs(C-_),(.001<=N||f||c)&&(!p||0<_||!C)&&(C=_,e.ka&&(Ht(e,t,function(){return Cr(e,t)}),Ht(e,t,function(){return Er(e,t,C)}))),j=t==v.$||!(v.$ in e.g),e.u&&j&&e.Ba.resolve(C))),l&&t==v.$&&(e.h||El(e,"application/cea-608",e.u,!1),e.H||(O=T.split(";",1)[0],e.H=new nn(O)),o?(X=e.H.i(n),X.length&&J2(e.h,X,o.startTime,o.endTime,C)):e.H.init(n)),!e.m[t]){q.B(9);break}return E(q,e.m[t].transmux(n,a,o,e.l.duration,t),10);case 10:n=q.h;case 9:return n=CS(e,n,o?o.startTime:null,t),o&&e.u&&t!=v.na&&(f||c)&&(V=o.startTime,Ht(e,t,function(){return Cr(e,t)}),Ht(e,t,function(){return Er(e,t,V)})),E(q,Ht(e,t,function(){var te=n;if(t=="video"&&e.N){var de=e.N;de.g&&de.g.appendBuffer(te,"video",de.o,-C)}e.g[t].appendBuffer(te)}),11);case 11:F(q)}})}function xS(e,t){var n=Al(e,"video")||0;Up(e.h,t,n)}function wS(e){e.h&&Up(e.h,"",0)}s.remove=function(e,t,n){var o=this,a;return z(function(l){return l.g==1?(a=Gt,e==a.na?E(l,o.h.remove(t,n),0):E(l,Ht(o,e,function(){return Il(o,e,t,n)}),4)):o.o?E(l,Ht(o,a.P,function(){return Il(o,a.P,t,n)}),0):l.B(0)})};function og(e,t){var n;return z(function(o){return o.g==1?(n=Gt,t==n.na?e.h?E(o,e.h.remove(0,1/0),0):o.return():E(o,Ht(e,t,function(){return Il(e,t,0,e.l.duration)}),4)):e.o?E(o,Ht(e,n.P,function(){return Il(e,n.P,0,e.l.duration)}),0):o.B(0)})}s.flush=function(e){var t=this,n;return z(function(o){return o.g==1?(n=Gt,e==n.na?o.return():E(o,Ht(t,e,function(){t.i.currentTime-=.001,Yi(t,e)}),2)):t.o?E(o,Ht(t,n.P,function(){var a=n.P;t.i.currentTime-=.001,Yi(t,a)}),0):o.B(0)})};function SS(e,t,n,o,a,l,f,c,p){var m,v,S;return z(function(C){return C.g==1?(m=Gt,t==m.na?(l||(e.h.s=n),Z2(e.h,o,a),C.return()):(v=[],E(C,bS(e,t,f,c,p),2))):(S=C.h,S||(v.push(Ht(e,t,function(){return Cr(e,t)})),e.o&&v.push(Ht(e,m.P,function(){return Cr(e,m.P)}))),l||(v.push(Ht(e,t,function(){return Er(e,t,n)})),e.o&&v.push(Ht(e,m.P,function(){return Er(e,m.P,n)}))),v.push(Ht(e,t,function(){e.g[t].appendWindowStart=0,e.g[t].appendWindowEnd=a,e.g[t].appendWindowStart=o,Yi(e,t)})),e.o&&v.push(Ht(e,m.P,function(){var T=m.P;e.g[T].appendWindowStart=0,e.g[T].appendWindowEnd=a,e.g[T].appendWindowStart=o,Yi(e,T)})),E(C,Promise.all(v),0))})}function TS(e,t,n){var o;return z(function(a){return a.g==1?(o=Gt,t==o.na?a.return():(Ht(e,t,function(){return Cr(e,t)}),e.o&&Ht(e,o.P,function(){return Cr(e,o.P)}),E(a,Ht(e,t,function(){return Er(e,t,n)}),2))):e.o?E(a,Ht(e,o.P,function(){return Er(e,o.P,n)}),0):a.B(0)})}s.endOfStream=function(e){var t=this;return z(function(n){return E(n,Rc(t,function(){ng(t)||t.l.readyState==="closed"||(e?t.l.endOfStream(e):t.l.endOfStream())}),0)})},s.Pa=function(e){var t=this;return z(function(n){return E(n,Rc(t,function(){if(e<t.l.duration)for(var o in t.g){var a={start:function(){},p:new bt};t.j[o].unshift(a)}t.l.duration=e,t.V=e}),0)})},s.getDuration=function(){return this.l.duration};function Il(e,t,n,o){o<=n?Yi(e,t):e.g[t].remove(n,o)}function Cr(e,t){var n=e.g[t].appendWindowStart,o=e.g[t].appendWindowEnd;e.g[t].abort(),e.g[t].appendWindowStart=n,e.g[t].appendWindowEnd=o,Yi(e,t)}function Er(e,t,n){0>n&&(n+=.001),e.g[t].timestampOffset=n,Yi(e,t)}function Yi(e,t){if(!e.A){var n=e.j[t][0];n&&(n.p.resolve(),Lc(e,t))}}function Ht(e,t,n){return yt(e.I),n={start:n,p:new bt},e.j[t].push(n),e.j[t].length==1&&rg(e,t),n.p}function Rc(e,t){var n,o,a,l,f,c,p;return z(function(m){switch(m.g){case 1:yt(e.I),n=[],o={};for(a in e.g)o.yc=new bt,l={start:function(v){return function(){return v.yc.resolve()}}(o),p:o.yc},e.j[a].push(l),n.push(o.yc),e.j[a].length==1&&l.start(),o={yc:o.yc};return re(m,2),E(m,Promise.all(n),4);case 4:ie(m,3);break;case 2:throw f=se(m),f;case 3:return re(m,5,6),E(m,t(),6);case 6:ne(m);for(c in e.g)Lc(e,c);le(m,0);break;case 5:throw p=se(m),new K(2,3,3015,p,e.i.error||"No error in the media element")}})}function Lc(e,t){e.j[t].shift(),rg(e,t)}function rg(e,t){var n=e.j[t][0];if(n)try{n.start()}catch(o){o.name=="QuotaExceededError"?n.p.reject(new K(2,3,3017,t)):n.p.reject(new K(2,3,3015,o,e.i.error||"No error in the media element")),Lc(e,t)}}function CS(e,t,n,o){var a=e.ma[o];return e.C.insertFakeEncryptionInInit&&n==null&&a&&(Po()||Ms()||Rt("SOPOpenBrowser"))&&e.G[o].split(";")[0].split("/")[1]=="mp4"&&(t=eS(t)),t}function ES(e,t,n,o){return Ht(e,t,function(){t!==lt&&(Ot()&&(e.m[t]&&(e.m[t].destroy(),delete e.m[t]),o&&(e.m[t]=o),e.g[t].changeType(n+e.C.sourceBufferExtraFeatures),e.G[t]=n),Yi(e,t))})}function AS(e,t){var n,o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X,V,q,te,de,ce;return z(function(he){switch(he.g){case 1:n=Gt,e.A=!0,e.o=!1,o=e.i.currentTime,a=e.i.autoplay,l=e.i.paused,e.da&&(e.i.autoplay=!1),ye(he,2),e.s.Za(),f=[];for(c in e.m)f.push(e.m[c].destroy());for(p in e.j)for(m=e.j[p],v=m[0],e.j[p]=m.slice(0,1),v&&f.push(v.p.catch(jp)),S=w(m.slice(1)),C=S.next();!C.done;C=S.next())T=C.value,T.p.reject(new K(2,7,7003,void 0));for(I in e.g){_=e.g[I];try{e.l.removeSourceBuffer(_)}catch{}}return E(he,Promise.all(f),4);case 4:return e.m={},e.g={},N=e.l.duration,e.J=new bt,e.l=tg(e,e.J),E(he,e.J,5);case 5:for(!isNaN(N)&&N?e.l.duration=N:!isNaN(e.V)&&e.V&&(e.l.duration=e.V),j=new bt,O=e.l.sourceBuffers,X=t.size,V=0,e.s.D(O,"addsourcebuffer",function(){V++,V===X&&j.resolve()}),q=w(t.keys()),te=q.next();!te.done;te=q.next())de=te.value,ce=t.get(de),Cl(e,de,ce,ce.codecs),e.o?(e.j[n.P]=[],e.j[n.$]=[]):e.j[de]=[];return e.i.currentTime=o,E(he,j,2);case 2:ne(he),e.A=!1,yt(e.I),e.s.ja(e.i,"canplaythrough",function(){yt(e.I),e.i.autoplay=a,l||e.i.play()}),le(he,0)}})}function sg(e,t){return Rc(e,function(){return AS(e,t)})}function bS(e,t,n,o,a){var l,f,c,p,m,v,S,C,T,I,_,N,j,O,X;return z(function(V){return V.g==1?(l=Gt,t==l.na||(f=xi(ri(e.G[t])),c=ji(e.G[t]),m=!1,v=Rn(n,o),S=e.C.forceTransmux,(!ve(v)||!e.u&&rr.includes(v)||o.includes(","))&&(S=!0),S&&(C=ir(n,o),T=_o(C))&&(p=T(),I=Sn(l.P,(o||"").split(",")),_=Sn(l.$,(o||"").split(",")),I&&_?(m=!0,N=_,t==l.P&&(N=I),v=p.convertCodecs(t,ir(n,N))):v=p.convertCodecs(t,C)),j=xi(ri(v)),O=ji(v),f===j&&c===O)?V.return(!1):(X=!0,(e.o||m&&p&&!e.m[t])&&(X=!1),X&&e.C.codecSwitchingStrategy==="smooth"&&Ot()?E(V,ES(e,t,v,p),3):(p&&p.destroy(),E(V,sg(e,a),3)))):V.return(!0)})}function IS(e,t,n){if(t==lt)var o=!1;else{o=xi(ri(e.G[t]));var a=ji(e.G[t]),l=Rn(n.mimeType,n.codecs),f=e.C.forceTransmux;(!ve(l)||!e.u&&rr.includes(l)||n.codecs.includes(","))&&(f=!0),n=ir(n.mimeType,n.codecs),f&&(f=_o(n))&&(f=f(),l=f.convertCodecs(t,n),f.destroy()),t=xi(ri(l)),l=ji(l),o=o!==t||a!==l}return o?e.C.codecSwitchingStrategy!=="smooth"||!Ot()||e.o:!1}var kl=d.URL.createObjectURL,kS="sequence";function Je(e,t,n){this.i=e,this.o=t,this.u=this.j=1/0,this.g=1,this.h=this.l=null,this.s=0,this.C=!0,this.F=0,this.A=n===void 0?!0:n,this.G=0,this.m=!1}s=Je.prototype,s.getDuration=function(){return this.j},s.$g=function(){return this.g},s.qf=function(e){this.i=e},s.Pa=function(e){this.j=e},s.eh=function(){return this.i},s.mg=function(e){this.s=e},s.pc=function(e){this.C=e},s.Xd=function(e){this.u=e},s.ng=function(e){this.o=e},s.Tg=function(){return this.o},s.dg=function(e,t){if(e.length!=0){var n=e[e.length-1].end+t;this.Sd(e[0].start+t),this.g=e.reduce(function(o,a){return Math.max(o,a.end-a.start)},this.g),this.h=Math.max(this.h,n),this.i!=null&&this.A&&!this.m&&(this.i=(Date.now()+this.s)/1e3-this.h-this.g)}},s.Xc=function(e){if(e.length!=0){var t=e[0].startTime,n=e[0].endTime,o=(Date.now()+this.s)/1e3;e=w(e);for(var a=e.next();!a.done;a=e.next())a=a.value,o<a.startTime||(t=Math.min(t,a.startTime),n=Math.max(n,a.endTime),this.g=Math.max(this.g,a.endTime-a.startTime));this.Sd(t),this.h=Math.max(this.h,n),this.i!=null&&this.A&&!this.m&&(this.i=o-this.h-this.g)}},s.Nd=function(){this.m=!0},s.yh=function(){return this.m},s.Sd=function(e){this.l=this.l==null?e:Math.min(this.l,e)},s.Ye=function(e){this.g=Math.max(this.g,e)},s.offset=function(e){this.l!=null&&(this.l+=e),this.h!=null&&(this.h+=e)},s.R=function(){return this.j==1/0&&!this.C},s.Rb=function(){return this.j!=1/0&&!this.C},s.eb=function(){return Math.max(this.F,this.Bb()-this.u)},s.qg=function(e){this.F=e},s.Bb=function(){return this.R()||this.Rb()?Math.min(Math.max(0,(Date.now()+this.s)/1e3-this.g-this.i)+this.G,this.j):this.h?Math.min(this.h,this.j):this.j},s.Rc=function(e){var t=Math.max(this.l,this.F);return this.u==1/0?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.Bb()-this.u+e,this.qb()))},s.hc=function(){return this.Rc(0)},s.qb=function(){return Math.max(0,this.Bb()-(this.R()||this.Rb()?this.o:0))},s.ug=function(){return!(this.i==null||this.h!=null&&this.A)},s.lg=function(e){this.G=e},ae("shaka.media.PresentationTimeline",Je),Je.prototype.setAvailabilityTimeOffset=Je.prototype.lg,Je.prototype.usingPresentationStartTime=Je.prototype.ug,Je.prototype.getSeekRangeEnd=Je.prototype.qb,Je.prototype.getSeekRangeStart=Je.prototype.hc,Je.prototype.getSafeSeekRangeStart=Je.prototype.Rc,Je.prototype.getSegmentAvailabilityEnd=Je.prototype.Bb,Je.prototype.setUserSeekStart=Je.prototype.qg,Je.prototype.getSegmentAvailabilityStart=Je.prototype.eb,Je.prototype.isInProgress=Je.prototype.Rb,Je.prototype.isLive=Je.prototype.R,Je.prototype.offset=Je.prototype.offset,Je.prototype.notifyMaxSegmentDuration=Je.prototype.Ye,Je.prototype.notifyMinSegmentStartTime=Je.prototype.Sd,Je.prototype.isStartTimeLocked=Je.prototype.yh,Je.prototype.lockStartTime=Je.prototype.Nd,Je.prototype.notifySegments=Je.prototype.Xc,Je.prototype.notifyTimeRange=Je.prototype.dg,Je.prototype.getDelay=Je.prototype.Tg,Je.prototype.setDelay=Je.prototype.ng,Je.prototype.setSegmentAvailabilityDuration=Je.prototype.Xd,Je.prototype.setStatic=Je.prototype.pc,Je.prototype.setClockOffset=Je.prototype.mg,Je.prototype.getPresentationStartTime=Je.prototype.eh,Je.prototype.setDuration=Je.prototype.Pa,Je.prototype.setPresentationStartTime=Je.prototype.qf,Je.prototype.getMaxSegmentDuration=Je.prototype.$g,Je.prototype.getDuration=Je.prototype.getDuration;function ag(e,t,n){this.j=n,this.l=e,this.s=lg(e),this.g=e.g.currentTime,this.m=Date.now()/1e3,this.h=!1,this.o=0,this.u=t,this.i=function(){}}ag.prototype.release=function(){this.j=this.l=null,this.i=function(){}};function MS(e,t){e.i=t}function _S(e){this.g=e}function lg(e){if(e.g.paused||e.g.buffered.length==0)var t=!1;else e:{t=e.g.currentTime,e=w(fo(e.g.buffered));for(var n=e.next();!n.done;n=e.next())if(n=n.value,!(t<n.start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function Pc(e,t,n,o,a){var l=this;this.u=a,this.g=e,this.A=t,this.s=n,this.l=new Ct,this.j=!1,this.F=e.readyState,this.C=this.i=0,this.h=o,this.o=!1,this.l.D(e,"waiting",function(){return Dc(l)}),this.m=new st(function(){Dc(l)}).$a(this.s.gapJumpTimerTime)}Pc.prototype.release=function(){this.l&&(this.l.release(),this.l=null),this.m!=null&&(this.m.stop(),this.m=null),this.h&&(this.h.release(),this.h=null),this.g=this.A=this.u=null},Pc.prototype.af=function(){this.o=!0,Dc(this)};function Dc(e){if(e.g.readyState!=0){if(e.g.seeking){if(!e.j)return}else e.j=!1;if(!e.g.paused||e.g.currentTime==e.i&&(e.g.autoplay||e.g.currentTime!=e.i)){e.g.readyState!=e.F&&(e.F=e.g.readyState);var t;if(!(t=!e.h)){t=e.h;var n=t.l,o=lg(n),a=n.g.currentTime,l=Date.now()/1e3;(t.g!=a||t.s!=o)&&(t.m=l,t.g=a,t.s=o,t.h=!1),a=l-t.m,(o=a>=t.u&&o&&!t.h)&&(t.i(t.g,a),t.h=!0,t.g=n.g.currentTime,t.o++,t.j(new We("stalldetected"))),t=!o}t&&(t=e.g.currentTime,n=e.g.buffered,o=iS(n,t,e.s.gapDetectionThreshold),o==null||o==0&&!e.o||(a=n.start(o),a>=e.A.qb()||.001>a-t||(o!=0&&n.end(o-1),e.g.currentTime=a,t==e.i&&(e.i=a),e.C++,e.u(new We("gapjumped")))))}}}function Ar(e,t,n,o){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?o():(t=RS.value().get(t),n.ja(e,t,o))}var RS=new mr(function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])});function ug(e,t,n,o){var a=this;this.g=e,this.m=t,this.s=n,this.l=null,this.j=function(){return a.l==null&&(a.l=o()),a.l},this.o=!1,this.h=new Ct,this.i=new dg(e),Ar(this.g,HTMLMediaElement.HAVE_METADATA,this.h,function(){cg(a,a.j())})}ug.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.i!=null&&(this.i.release(),this.i=null),this.m=function(){},this.g=null};function Nc(e){return e.o?e.g.currentTime:e.j()}function fg(e,t){0<e.g.readyState?pg(e.i,t):Ar(e.g,HTMLMediaElement.HAVE_METADATA,e.h,function(){cg(e,e.j())})}function cg(e,t){.001>Math.abs(e.g.currentTime-t)?hg(e):(e.h.ja(e.g,"seeking",function(){hg(e)}),pg(e.i,e.g.currentTime&&e.g.currentTime!=0?e.g.currentTime:t))}function hg(e){e.o=!0,e.h.D(e.g,"seeking",function(){return e.m()}),e.s(e.g.currentTime)}function dg(e){var t=this;this.h=e,this.m=10,this.l=this.j=this.i=0,this.g=new st(function(){0>=t.i||t.h.currentTime!=t.j?t.g.stop():(t.h.currentTime=t.l,t.i--)})}dg.prototype.release=function(){this.g&&(this.g.stop(),this.g=null),this.h=null};function pg(e,t){e.j=e.h.currentTime,e.l=t,e.i=e.m,e.h.currentTime=t,e.g.$a(.1)}function gg(e){this.g=e,this.j=!1,this.h=null,this.i=new Ct}s=gg.prototype,s.ie=function(){function e(){t.h==null||t.h==0?t.j=!0:(t.i.ja(t.g,"seeking",function(){t.j=!0}),t.g.currentTime=Math.max(0,t.g.currentTime+t.h))}var t=this;Ar(this.g,HTMLMediaElement.HAVE_CURRENT_DATA,this.i,function(){e()})},s.release=function(){this.i&&(this.i.release(),this.i=null),this.g=null},s.je=function(e){this.h=this.j?this.h:e},s.qd=function(){return(this.j?this.g.currentTime:this.h)||0},s.Bf=function(){return 0},s.Af=function(){return 0},s.cg=function(){};function mg(e,t,n,o,a,l){var f=this;this.i=e,this.g=t.presentationTimeline,this.A=t.minBufferTime||0,this.l=n,this.u=a,this.s=null,this.o=LS(e,n,l),this.j=new Pc(e,t.presentationTimeline,n,this.o,l),this.h=new ug(e,function(){e:{var c=f.j;c.j=!0,c.o=!1;var p=Nc(f.h);if(c=vg(f,p),.001<Math.abs(c-p)&&(p=Date.now()/1e3,!f.s||f.s<p-1)){f.s=p,fg(f.h,c),c=void 0;break e}f.u(),c=void 0}return c},function(c){var p=f.j;p.g.seeking&&!p.j&&(p.j=!0,p.i=c)},function(){var c=o;return c==null?c=1/0>f.g.getDuration()?f.g.hc():f.g.qb():0>c&&(c=f.g.qb()+c),yg(f,xg(f,c))}),this.m=new st(function(){if(f.i.readyState!=0&&!f.i.paused){var c=Nc(f.h),p=f.g.hc(),m=f.g.qb();3>m-p&&(p=m-3),c<p&&(c=vg(f,c),f.i.currentTime=c)}})}s=mg.prototype,s.ie=function(){this.m.$a(.25)},s.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.m&&(this.m.stop(),this.m=null),this.i=this.h=this.g=this.l=null,this.u=function(){}},s.je=function(e){fg(this.h,e)},s.qd=function(){var e=Nc(this.h);return 0<this.i.readyState&&!this.i.paused?xg(this,e):e},s.Bf=function(){return this.o?this.o.o:0},s.Af=function(){return this.j.C},s.cg=function(){this.j.af()};function yg(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function vg(e,t){var n=Math.max(e.A,e.l.rebufferingGoal),o=e.l.safeSeekOffset,a=e.g.hc(),l=e.g.qb(),f=e.g.getDuration();3>l-a&&(a=l-3);var c=e.g.Rc(n),p=e.g.Rc(o);return n=e.g.Rc(n+o),t>=f?yg(e,t):t>l?l:t<a?Tc(e.i.buffered,p)?p:n:t>=c||Tc(e.i.buffered,t)?t:n}function xg(e,t){var n=e.g.hc();return t<n?n:(e=e.g.qb(),t>e?e:t)}function LS(e,t,n){if(!t.stallEnabled)return null;var o=t.stallSkip;return t=new ag(new _S(e),t.stallThreshold,n),MS(t,function(){o?e.currentTime+=o:(e.pause(),e.play())}),t}function ft(e){this.g=e,this.m=null,this.j=0,this.o=!1}s=ft.prototype,s.Ab=function(){return this.g.length},s.release=function(){this.o||(this.g=[],this.m&&this.m.stop(),this.m=null)},s.Ch=function(){this.o=!0};function Oc(e,t){e=w(e.g);for(var n=e.next();!n.done;n=e.next())t(n.value)}s.find=function(e){for(var t=this.g.length-1,n=t;0<=n;--n){var o=this.g[n],a=n<t?this.g[n+1].startTime:o.endTime;if(e>=o.startTime&&e<a)return n+this.j}return this.g.length&&e<this.g[0].startTime?this.j:null},s.get=function(e){return this.g.length==0?null:(e-=this.j,0>e||e>=this.g.length?null:this.g[e])},s.offset=function(e){if(!this.o)for(var t=w(this.g),n=t.next();!n.done;n=t.next())n.value.offset(e)},s.Qd=function(e){if(!this.o&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.g=this.g.filter(function(n){return Math.round(1e3*n.startTime)/1e3<t}),this.g.push.apply(this.g,R(e))}},s.Wc=function(e,t){var n=this;e=e.filter(function(o){return o.endTime>t&&(n.g.length==0||o.endTime>n.g[0].startTime)}),this.Qd(e),this.bb(t)},s.bb=function(e){if(!this.o){var t=this.g.length;this.g=this.g.filter(function(n){return n.endTime>e}),this.j+=t-this.g.length}},s.bc=function(e,t,n){if(n=n===void 0?!1:n,!this.o){for(;this.g.length&&this.g[this.g.length-1].startTime>=t;)this.g.pop();for(;this.g.length&&this.g[0].endTime<=e;)this.g.shift(),n||this.j++;this.g.length!=0&&(e=this.g[this.g.length-1],this.g[this.g.length-1]=new Xe(e.startTime,t,e.A,e.Qa,e.wa,e.aa,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.g,e.tilesLayout,e.u,e.ca,e.status,e.aes128Key),this.g[this.g.length-1].i=e.i)}},s.Yd=function(e,t){var n=this;this.o||(this.m&&this.m.stop(),this.m=new st(function(){var o=t();o?n.g.push.apply(n.g,R(o)):(n.m.stop(),n.m=null)}),this.m.$a(e))},ft.prototype[Symbol.iterator]=function(){return this.Nb(0)},ft.prototype.Nb=function(e){var t=this.find(e);if(t==null)return null;t--;var n=this.get(t+1),o=-1;if(n&&0<n.g.length)for(var a=n.g.length-1;0<=a;--a){var l=n.g[a];if(e>=l.startTime&&e<l.endTime){for(;a&&!l.j;)a--,l=n.g[a];if(!l.j)return De("No independent partial segment found!"),null;t++,o=a-1;break}}return new Si(this,t,o)};function Uc(e,t,n){return e=new Xe(e,e+t,function(){return n},0,null,null,e,e,e+t),new ft([e])}ae("shaka.media.SegmentIndex",ft),ft.forSingleSegment=Uc,ft.prototype.getIteratorForTime=ft.prototype.Nb,ft.prototype.updateEvery=ft.prototype.Yd,ft.prototype.fit=ft.prototype.bc,ft.prototype.evict=ft.prototype.bb,ft.prototype.mergeAndEvict=ft.prototype.Wc,ft.prototype.offset=ft.prototype.offset,ft.prototype.get=ft.prototype.get,ft.prototype.find=ft.prototype.find,ft.prototype.markImmutable=ft.prototype.Ch,ft.prototype.release=ft.prototype.release;function Si(e,t,n){this.i=e,this.g=t,this.h=n}Si.prototype.Kg=function(){return this.g},Si.prototype.current=function(){var e=this.i.get(this.g);return e&&0<e.g.length&&e.o&&this.h>=e.g.length&&(this.g++,this.h=0,e=this.i.get(this.g)),e&&0<e.g.length?e.g[this.h]:e},Si.prototype.next=function(){var e=this.i.get(this.g);return e&&0<e.g.length?(this.h++,e.o&&this.h==e.g.length&&(this.g++,this.h=0)):(this.g++,this.h=0),e=this.current(),{value:e,done:!e}},ae("shaka.media.SegmentIterator",Si),Si.prototype.next=Si.prototype.next,Si.prototype.current=Si.prototype.current,Si.prototype.currentPosition=Si.prototype.Kg;function jt(){ft.call(this,[]),this.h=[]}Z(jt,ft),s=jt.prototype,s.clone=function(){var e=new jt;return e.h=this.h.slice(),e},s.release=function(){for(var e=w(this.h),t=e.next();!t.done;t=e.next())t.value.release();this.h=[]},s.find=function(e){for(var t=0,n=w(this.h),o=n.next();!o.done;o=n.next()){o=o.value;var a=o.find(e);if(a!=null)return a+t;t+=o.j+o.Ab()}return null},s.get=function(e){for(var t=0,n=w(this.h),o=n.next();!o.done;o=n.next()){o=o.value;var a=o.get(e-t);if(a)return a;t+=o.j+o.Ab()}return null},s.offset=function(){},s.Qd=function(){},s.bb=function(){},s.Wc=function(){},s.bc=function(){},s.Yd=function(){},ae("shaka.media.MetaSegmentIndex",jt),jt.prototype.updateEvery=jt.prototype.Yd,jt.prototype.fit=jt.prototype.bc,jt.prototype.mergeAndEvict=jt.prototype.Wc,jt.prototype.evict=jt.prototype.bb,jt.prototype.merge=jt.prototype.Qd,jt.prototype.offset=jt.prototype.offset,jt.prototype.get=jt.prototype.get,jt.prototype.find=jt.prototype.find,jt.prototype.release=jt.prototype.release;function Bs(e){var t=this;this.g=e,this.h=this.g.Ed(),this.i=new st(function(){t.g.bg(.25*t.h)})}Bs.prototype.release=function(){this.set(this.ec()),this.i&&(this.i.stop(),this.i=null),this.g=null},Bs.prototype.set=function(e){if(this.h!=e)e:{if(this.h=e,this.i.stop(),0<=this.h)try{var t=this.h;this.g.Ed()!=t&&this.g.rf(t);break e}catch{}this.i.$a(.25),this.g.Ed()!=0&&this.g.rf(0)}},Bs.prototype.ec=function(){return this.g.ec()};function wg(e){var t=this;this.h=e,this.g=new Set,this.i=new st(function(){Sg(t,!1)}).$a(.25)}wg.prototype.release=function(){this.i.stop();for(var e=w(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()};function Sg(e,t){for(var n=w(e.g),o=n.next();!o.done;o=n.next())o.value.j(e.h.currentTime,t)}function Ml(e){dt.call(this),this.g=new Map,this.h=e}Z(Ml,dt),Ml.prototype.release=function(){this.g.clear(),dt.prototype.release.call(this)};function PS(e,t){var n=e.g.get(t);return n||(n={$c:[],If:null,contentType:t},e.g.set(t,n)),n}function DS(e,t,n){var o=PS(e,t.contentType);NS(e,o),e={Ve:t,position:n},o=o.$c,t=o.findIndex(function(a){return a.position>=n}),0<=t?o.splice(t,o[t].position==n?1:0,e):o.push(e)}Ml.prototype.j=function(e){for(var t=w(this.g.values()),n=t.next();!n.done;n=t.next()){n=n.value;e:{for(var o=n.$c,a=o.length-1;0<=a;a--){var l=o[a];if(l.position<=e){o=l.Ve;break e}}o=null}if((a=o)&&(a=n.If,a=!(a===o||a&&o&&a.bandwidth==o.bandwidth&&a.audioSamplingRate==o.audioSamplingRate&&a.codecs==o.codecs&&a.contentType==o.contentType&&a.frameRate==o.frameRate&&a.height==o.height&&a.mimeType==o.mimeType&&a.channelsCount==o.channelsCount&&a.pixelAspectRatio==o.pixelAspectRatio&&a.width==o.width)),a)e:{if(a=e,l=o.contentType,(l=this.h()[l])&&0<l.length){var f=l[l.length-1].end;if(a>=l[0].start&&a<f){a=!0;break e}}a=!1}a&&(n.If=o,JSON.stringify(o),n=new We("qualitychange",new Map([["quality",o],["position",e]])),this.dispatchEvent(n))}};function NS(e,t){if((e=e.h()[t.contentType])&&0<e.length){var n=e[0].start,o=e[e.length-1].end,a=t.$c;t.$c=a.filter(function(l,f){return!(l.position<=n&&f+1<a.length&&a[f+1].position<=n||l.position>=o)})}else t.$c=[]}function Bc(e){dt.call(this);var t=this;this.g=new Set,this.i=e,this.h=new st(function(){for(var n=t.i(),o=w(t.g),a=o.next();!a.done;a=o.next())a=a.value,a.endTime<n.start&&(t.g.delete(a),a=new We("regionremove",new Map([["region",a]])),t.dispatchEvent(a))}).$a(2)}Z(Bc,dt),Bc.prototype.release=function(){this.g.clear(),this.h.stop(),dt.prototype.release.call(this)};function _l(e,t){dt.call(this);var n=this;this.i=e,this.l=t,this.g=new Map,this.m=[{Yb:null,Xb:br,Qb:function(o,a){return Vo(n,"enter",o,a)}},{Yb:js,Xb:br,Qb:function(o,a){return Vo(n,"enter",o,a)}},{Yb:Fs,Xb:br,Qb:function(o,a){return Vo(n,"enter",o,a)}},{Yb:br,Xb:js,Qb:function(o,a){return Vo(n,"exit",o,a)}},{Yb:br,Xb:Fs,Qb:function(o,a){return Vo(n,"exit",o,a)}},{Yb:js,Xb:Fs,Qb:function(o,a){return Vo(n,"skip",o,a)}},{Yb:Fs,Xb:js,Qb:function(o,a){return Vo(n,"skip",o,a)}}],this.h=new Ct,this.h.D(this.i,"regionremove",function(o){n.g.delete(o.region)})}Z(_l,dt),_l.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,dt.prototype.release.call(this)},_l.prototype.j=function(e,t){if(!this.l||e!=0){this.l=!1;for(var n=w(this.i.g),o=n.next();!o.done;o=n.next()){o=o.value;var a=this.g.get(o),l=e<o.startTime?js:e>o.endTime?Fs:br;this.g.set(o,l);for(var f=w(this.m),c=f.next();!c.done;c=f.next())c=c.value,c.Yb==a&&c.Xb==l&&c.Qb(o,t)}}};function Vo(e,t,n,o){t=new We(t,new Map([["region",n],["seeking",o]])),e.dispatchEvent(t)}var js=1,br=2,Fs=3;function OS(e,t,n){this.i=e,this.h=t,this.j=0,this.l=n,this.g=new Map}function jc(e,t,n){if(n=n===void 0?!1:n,e.h.segmentIndex){var o=e.h.segmentIndex.Nb(Math.max(t.startTime,e.j));if(o){var a=t;for(n&&(a=o.next().value)&&a.startTime==t.startTime&&a.endTime==t.endTime&&(a=null);e.g.size<e.i&&a!=null&&(t=!0,a.l&&a.wa!=null&&(t=!1),a.Pb()==2&&(t=!1),t&&!e.g.has(a)&&(t=new Fc(e.l),Eg(t,a,e.h),e.g.set(a,t)),e.j=a.startTime,!(e.h.fastSwitching&&a.Zc&&a.Md));)a=o.next().value}}}function US(e,t){if(e.h.segmentIndex&&e.g.size<e.i&&!e.g.has(t)){var n=new Fc(e.l);Eg(n,t,e.h),e.g.set(t,n)}}function Tg(e){if(e.g.size!==0){for(var t=w(e.g.keys()),n=t.next();!n.done;n=t.next())(n=n.value)&&Cg(e,n);e.j=0}}function BS(e,t){t&&t!==e.h&&(Tg(e),e.h=t)}function Cg(e,t){var n=e.g.get(t);e.g.delete(t),n&&n.abort()}function Fc(e){this.i=e,this.g=this.h=null}function Eg(e,t,n){var o=new Uint8Array(0);e.g=e.i(t,n,function(a){return z(function(l){if(l.g==1)return 0<o.byteLength?o=Lt(o,a):o=a,e.h?E(l,e.h(o),3):l.B(0);o=new Uint8Array(0),F(l)})})}Fc.prototype.abort=function(){this.g&&this.g.abort()};function Rl(e,t,n,o,a){return e=Yt(e,o,a),(t!=0||n!=null)&&(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function Ag(e,t){var n=this;this.g=t,this.m=e,this.h=null,this.u=1,this.o=this.j=null,this.F=0,this.C=!1,this.i=new Map,this.A=!1,this.G=null,this.s=!1,this.l=new gr(function(){return jS(n)}),this.H=Date.now()/1e3}s=Ag.prototype,s.destroy=function(){return this.l.destroy()};function jS(e){var t,n,o,a;return z(function(l){if(l.g==1){for(t=[],n=w(e.i.values()),o=n.next();!o.done;o=n.next())a=o.value,Vs(a),t.push(Hs(a));return E(l,Promise.all(t),2)}e.i.clear(),e.g=null,e.m=null,e.h=null,F(l)})}s.configure=function(e){this.h=e,this.G=new l0({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0);for(var t=w(this.i.keys()),n=t.next();!n.done;n=t.next())if(n=this.i.get(n.value),n.ra){var o=n.ra,a=e.segmentPrefetchLimit;o.i=a;for(var l=Array.from(o.g.keys());l.length>a;){var f=l.pop();f&&Cg(o,f)}0<e.segmentPrefetchLimit||(n.ra=null)}else 0<e.segmentPrefetchLimit&&(n.ra=Mg(this,n.stream))},s.start=function(){var e=this;return z(function(t){if(t.g==1)return E(t,HS(e),2);yt(e.l),e.A=!0,F(t)})};function FS(e,t){var n,o,a,l,f,c;z(function(p){switch(p.g){case 1:return n=Gt,e.F++,o=e.F,re(p,2),E(p,og(e.g.T,n.na),4);case 4:ie(p,3);break;case 2:a=se(p),e.g&&e.g.onError(a);case 3:l=Rn(t.mimeType,t.codecs),El(e.g.T,l,e.m.sequenceMode,t.external),f=e.g.T.F,(f.isTextVisible()||e.h.alwaysStreamText)&&e.F==o&&(c=kg(e,t),e.i.set(n.na,c),ci(e,c,0)),F(p)}})}function zS(e){var t=e.i.get(lt);t&&(Vs(t),Hs(t).catch(function(){}),e.i.delete(lt)),e.o=null}function bg(e,t){var n=e.i.get("video");if(n){var o=n.stream;o&&(t?(t=o.trickModeVideo)&&!n.Ub&&(Ir(e,t,!1,0,!1),n.Ub=o):(o=n.Ub)&&(n.Ub=null,Ir(e,o,!0,0,!1)))}}function Ig(e,t,n,o,a,l){n=n===void 0?!1:n,o=o===void 0?0:o,a=a===void 0?!1:a,l=l===void 0?!1:l,e.j=t,e.A&&(t.video&&Ir(e,t.video,n,o,a,l),t.audio&&Ir(e,t.audio,n,o,a,l))}function Ll(e,t){z(function(n){if(n.g==1)return e.o=t,e.A?t.segmentIndex?n.B(2):E(n,t.createSegmentIndex(),2):n.return();Ir(e,t,!0,0,!1),F(n)})}function Ir(e,t,n,o,a,l){var f=e.i.get(t.type);f||t.type!=lt?f&&(f.Ub&&(t.trickModeVideo?(f.Ub=t,t=t.trickModeVideo):f.Ub=null),f.stream!=t||a)&&(f.ra&&BS(f.ra,t),t.type==lt&&(a=Rn(t.mimeType,t.codecs),El(e.g.T,a,e.m.sequenceMode,t.external)),f.stream.closeSegmentIndex&&f.stream.closeSegmentIndex(),f.stream=t,f.X=null,f.Cf=!!l,n&&(f.Lc?f.Zd=!0:f.Da?(f.wb=!0,f.vd=o,f.Zd=!0):(Vs(f),$c(e,f,!0,o).catch(function(c){e.g&&e.g.onError(c)}))),VS(e,f).catch(function(c){e.g&&e.g.onError(c)})):FS(e,t)}function VS(e,t){var n,o;return z(function(a){if(a.g==1)return t.Na?(n=t.stream,o=t.Na,n.segmentIndex?a.B(2):E(a,n.createSegmentIndex(),2)):a.return();if(t.Na!=o||t.stream!=n)return a.return();var l=e.g.Dd(),f=Al(e.g.T,t.type),c=t.stream.segmentIndex.find(t.Ca?t.Ca.endTime:l),p=c==null?null:t.stream.segmentIndex.get(c);c=p&&p.wa?p.wa-p.Qa:null,p&&!c&&(c=(p.endTime-p.getStartTime())*(t.stream.bandwidth||0)/8),c?((p=p.aa)&&(c+=(p.wa?p.wa-p.Qa:null)||0),p=e.g.getBandwidthEstimate(),l=8*c/p<(f||0)-l-Math.max(e.m.minBufferTime||0,e.h.rebufferingGoal)||t.Na.h.g>c):l=!1,l&&t.Na.abort(),F(a)})}s.dd=function(){if(this.g)for(var e=this.g.Dd(),t=w(this.i.keys()),n=t.next();!n.done;n=t.next()){var o=n.value;n=this.i.get(o);var a=null;n.X&&(a=n.X.current()),(!a||a.startTime>e||a.endTime<e)&&(n.X=null),a=this.g.T,a.A?a=!1:o==lt?(a=a.h,a=a.g==null||a.h==null?!1:e>=a.g&&e<a.h):(a=Tr(a,o),a=Tc(a,e)),a||((Al(this.g.T,o)!=null||n.Da)&&zs(this,n),n.Na&&(n.Na.abort(),n.Na=null),o===lt&&(o=this.g.T,o.H&&o.H.h()),n.dd=!0)}};function zs(e,t){t.Lc||t.wb||(t.Da?(t.wb=!0,t.vd=0):ig(e.g.T,t.type)==null?t.ib==null&&ci(e,t,0):(Vs(t),$c(e,t,!1,0).catch(function(n){e.g&&e.g.onError(n)})))}function HS(e){var t,n,o,a,l,f,c,p,m;return z(function(v){if(v.g==1){if(t=Gt,!e.j)throw new K(2,5,5006);return n=new Map,o=new Set,e.j.audio&&(n.set(t.P,e.j.audio),o.add(e.j.audio)),e.j.video&&(n.set(t.$,e.j.video),o.add(e.j.video)),e.o&&(n.set(t.na,e.o),o.add(e.o)),a=e.g.T,E(v,a.init(n,e.m.sequenceMode,e.m.type,e.m.ignoreManifestTimestampsInSegmentsMode),2)}for(yt(e.l),e.updateDuration(),l=w(n.keys()),f=l.next();!f.done;f=l.next())c=f.value,p=n.get(c),e.i.has(c)||(m=kg(e,p),e.i.set(c,m),ci(e,m,0));F(v)})}function kg(e,t){return{stream:t,type:t.type,X:null,ra:Mg(e,t),Ca:null,Db:null,Re:null,Pe:null,Oe:null,Ub:null,endOfStream:!1,Da:!1,ib:null,wb:!1,vd:0,Zd:!1,Lc:!1,dd:!0,Xe:!1,ff:!1,Tc:!1,Na:null}}function Mg(e,t){return t.type!=="video"&&t.type!=="audio"?null:0<e.h.segmentPrefetchLimit?new OS(e.h.segmentPrefetchLimit,t,function(n,o,a){return _g(e,n,o,a)}):null}s.updateDuration=function(){var e=this.m.presentationTimeline.getDuration();1/0>e?this.g.T.Pa(e):this.g.T.Pa(Math.pow(2,32))};function $S(e,t){var n,o,a,l,f;return z(function(c){switch(c.g){case 1:if(yt(e.l),t.Da||t.ib==null||t.Lc)return c.return();if(t.ib=null,!t.wb){c.B(2);break}return E(c,$c(e,t,t.Zd,t.vd),3);case 3:return c.return();case 2:if(t.stream.segmentIndex){c.B(4);break}return n=t.stream,E(c,t.stream.createSegmentIndex(),5);case 5:if(n!=t.stream)return n.closeSegmentIndex&&n.closeSegmentIndex(),t.Da||t.ib||ci(e,t,0),c.return();case 4:re(c,6),o=GS(e,t),o!=null&&(ci(e,t,o),t.Tc=!1),ie(c,7);break;case 6:return a=se(c),E(c,Rg(e,t,a),8);case 8:return c.return();case 7:if(l=Array.from(e.i.values()),!e.A||!l.every(function(p){return p.endOfStream})){c.B(0);break}return E(c,e.g.T.endOfStream(),10);case 10:yt(e.l),f=e.g.T.getDuration(),f!=0&&f<e.m.presentationTimeline.getDuration()&&e.m.presentationTimeline.Pa(f),F(c)}})}function GS(e,t){if(Vc(t))return xS(e.g.T,t.stream.originalId||""),null;if(t.type==lt&&wS(e.g.T),!e.g.T.ea&&t.type!=lt)return e.h.updateIntervalSeconds/2;var n=e.g.Dd(),o=t.Ca?t.Ca.endTime:n,a=yS(e.g.T,t.type,n),l=Math.max(1,Math.max(e.m.minBufferTime||0,e.h.rebufferingGoal,e.h.bufferingGoal)*e.u),f=e.m.presentationTimeline.getDuration()-o,c=Al(e.g.T,t.type);if(1e-6>f&&c)return t.endOfStream=!0,t.type=="video"&&(e=e.i.get(lt))&&Vc(e)&&(e.endOfStream=!0),null;if(t.endOfStream=!1,a>=l)return e.h.updateIntervalSeconds/2;if(a=WS(e,t,n,c),!a)return e.h.updateIntervalSeconds;for(l=1/0,f=Array.from(e.i.values()),f=w(f),c=f.next();!c.done;c=f.next())c=c.value,Vc(c)||c.X&&!c.X.current()||(l=Math.min(l,c.Ca?c.Ca.endTime:n));return o>=l+e.m.presentationTimeline.g?e.h.updateIntervalSeconds:(t.ra&&t.X&&(o=a.aa,!o||t.Ca&&V0(o,t.Db)||US(t.ra,o),jc(t.ra,a)),XS(e,t,n,a).catch(function(){}),null)}function WS(e,t,n,o){if(t.X)return t.X.current();if(t.Ca||o)return n=t.Ca?t.Ca.endTime:o,t.Xe=!0,t.X=t.stream.segmentIndex.Nb(n),t.X&&t.X.next().value;e=e.h.inaccurateManifestTolerance,o=Math.max(n-e,0);var a=null;return e&&(t.X=t.stream.segmentIndex.Nb(o),a=t.X&&t.X.next().value),a||(t.X=t.stream.segmentIndex.Nb(n),a=t.X&&t.X.next().value),a}function XS(e,t,n,o){var a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X;return z(function(V){switch(V.g){case 1:if(a=Gt,l=t.stream,f=t.X,t.Da=!0,re(V,2),o.Pb()==2)throw new K(1,1,1011);return E(V,QS(e,t,o),4);case 4:return yt(e.l),e.s?V.return():(c=l.mimeType=="video/mp4"||l.mimeType=="audio/mp4",p=d.ReadableStream,e.h.lowLatencyMode&&p&&c&&(e.m.type!="HLS"||o.m)?(S=new Uint8Array(0),T=C=!1,_=function(q){var te,de,ce;return z(function(he){switch(he.g){case 1:if(C||(T=!0,yt(e.l),e.s))return he.return();if(re(he,2),S=YS(S,q),te=!1,de=0,new St().box("mdat",function(ge){de=ge.size+ge.start,te=!0}).parse(S,!1,!0),!te){he.B(4);break}return ce=S.subarray(0,de),S=S.subarray(de),E(he,zc(e,t,n,l,o,ce,!0),5);case 5:t.ra&&t.X&&jc(t.ra,o,!0);case 4:ie(he,0);break;case 2:I=se(he),F(he)}})},E(V,Hc(e,t,o,_),9)):(m=Hc(e,t,o),E(V,m,7)));case 7:return v=V.h,yt(e.l),e.s?V.return():(yt(e.l),t.wb?(t.Da=!1,ci(e,t,0),V.return()):E(V,zc(e,t,n,l,o,v),6));case 9:if(N=V.h,I)throw I;if(T){V.B(10);break}return C=!0,yt(e.l),e.s?V.return():t.wb?(t.Da=!1,ci(e,t,0),V.return()):E(V,zc(e,t,n,l,o,N),10);case 10:t.ra&&t.X&&jc(t.ra,o,!0);case 6:if(yt(e.l),e.s)return V.return();t.Ca=o,f.next(),t.Da=!1,t.ff=!1,j=e.g.T.pb(),O=j[t.type],JSON.stringify(O),t.wb||e.g.af(o,t.stream),ci(e,t,0),ie(V,0);break;case 2:if(X=se(V),yt(e.l,X),e.s)return V.return();if(t.Da=!1,X.code==7001)t.Da=!1,Vs(t),ci(e,t,0),V.B(0);else if(t.type==a.na&&e.h.ignoreTextStreamFailures)e.i.delete(a.na),V.B(0);else if(X.code==3017)qS(e,t,X),V.B(0);else return t.Tc=!0,X.severity=2,E(V,Rg(e,t,X),0)}})}function KS(e,t,n){var o,a,l,f;return z(function(c){if(c.g==1)return o=t,o.cryptoKey?c.B(2):E(c,o.fetchKey(),3);if(a=o.iv,!a)for(a=Ve(new ArrayBuffer(16)),l=o.firstMediaSequenceNumber+n,f=a.byteLength-1;0<=f;f--)a[f]=l&255,l>>=8;return c.return(d.crypto.subtle.decrypt({name:"AES-CBC",iv:a},o.cryptoKey,e))})}function YS(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function qS(e,t,n){if(!Array.from(e.i.values()).some(function(a){return a!=t&&a.ff})){if(0<e.h.maxDisabledTime&&e.g.wd(t.stream,e.h.maxDisabledTime))return;var o=Math.round(100*e.u);if(20<o)e.u-=.2;else if(4<o)e.u-=.04;else{t.Tc=!0,e.s=!0,e.g.onError(n);return}t.ff=!0}ci(e,t,4)}function QS(e,t,n){var o,a,l,f,c,p,m,v,S,C,T,I,_;return z(function(N){return N.g==1?(o=Gt,a=[],l=Math.max(0,n.appendWindowStart-.1),f=n.appendWindowEnd+.01,c=xi(t.stream.codecs),p=ji(t.stream.mimeType),m=n.timestampOffset,m==t.Re&&l==t.Pe&&f==t.Oe&&c==t.Qe&&p==t.Yf?N.B(2):((v=t.Qe&&t.Yf&&IS(e.g.T,t.type,t.stream))&&(S=null,t.type===o.$?S=e.i.get(o.P):t.type===o.P&&(S=e.i.get(o.$)),S&&(S.Db=null,zs(e,S),Hs(S).catch(function(){}))),C=function(){var j,O,X,V;return z(function(q){if(q.g==1)return j=new Map,e.j.audio&&j.set(o.P,e.j.audio),e.j.video&&j.set(o.$,e.j.video),re(q,2),t.Pe=l,t.Oe=f,t.Qe=c,t.Yf=p,t.Re=m,O=e.m.sequenceMode||e.m.type=="HLS",E(q,SS(e.g.T,t.type,m,l,f,O,n.mimeType||t.stream.mimeType,n.codecs||t.stream.codecs,j),4);if(q.g!=2)return v&&(X=null,t.type===o.$?X=e.i.get(o.P):t.type===o.P&&(X=e.i.get(o.$)),X&&(X.wb=!1,X.Da=!1,zs(e,X))),ie(q,0);throw V=se(q),t.Pe=null,t.Oe=null,t.Qe=null,t.Re=null,V})},E(N,C(),2))):(V0(n.aa,t.Db)||(t.Db=n.aa,n.j&&n.aa&&(T=Hc(e,t,n.aa),I=function(){var j,O,X,V,q,te;return z(function(de){switch(de.g){case 1:return re(de,2),E(de,T,4);case 4:return j=de.h,yt(e.l),O=null,X=new Map,V=new St,V.box("moov",pt).box("trak",pt).box("mdia",pt).O("mdhd",function(ce){O=Sl(ce.reader,ce.version).timescale}).box("hdlr",function(ce){ce=ce.reader,ce.skip(8),ce=ce.ub(4);var he=String.fromCharCode(ce[0]);switch(he+=String.fromCharCode(ce[1]),he+=String.fromCharCode(ce[2]),he+=String.fromCharCode(ce[3]),he){case"soun":X.set(o.P,O);break;case"vide":X.set(o.$,O)}O=null}).parse(j),X.has(t.type)?n.aa.timescale=X.get(t.type):O!=null&&(n.aa.timescale=O),q=t.stream.closedCaptions&&0<t.stream.closedCaptions.size,E(de,e.g.Ef(t.type,j),5);case 5:return E(de,bl(e.g.T,t.type,j,null,t.stream,q),6);case 6:ie(de,0);break;case 2:throw te=se(de),t.Db=null,te}})},e.g.Eh(n.startTime,n.aa),a.push(I()))),e.m.sequenceMode&&(_=t.Ca?t.Ca.i:null,n.i!=_||t.Xe)&&(t.Xe=!1,a.push(TS(e.g.T,t.type,n.startTime))),E(N,Promise.all(a),0))})}function zc(e,t,n,o,a,l,f){f=f===void 0?!1:f;var c,p,m,v,S,C;return z(function(T){switch(T.g){case 1:return c=o.closedCaptions&&0<o.closedCaptions.size,m=o.emsgSchemeIdUris!=null&&0<o.emsgSchemeIdUris.length||e.h.dispatchAllEmsgBoxes,v=e.h.parsePrftBox&&!e.C,(m||v)&&(p=new St),m&&p.O("emsg",function(I){var _=o.emsgSchemeIdUris;if(I.version===0)var N=I.reader.ad(),j=I.reader.ad(),O=I.reader.L(),X=I.reader.L(),V=I.reader.L(),q=I.reader.L(),te=a.startTime+X/O;else O=I.reader.L(),te=I.reader.oc()/O+a.timestampOffset,X=te-a.startTime,V=I.reader.L(),q=I.reader.L(),N=I.reader.ad(),j=I.reader.ad();I=I.reader.ub(I.reader.getLength()-I.reader.qa()),(_&&_.includes(N)||e.h.dispatchAllEmsgBoxes)&&(N=="urn:mpeg:dash:event:2012"?e.g.Fh():(_=new Map().set("detail",{startTime:te,endTime:te+V/O,schemeIdUri:N,value:j,timescale:O,presentationTimeDelta:X,eventDuration:V,id:q,messageData:I}),_=new We("emsg",_),_.cancelable=!0,e.g.onEvent(_),_.defaultPrevented||N!="https://aomedia.org/emsg/ID3"&&N!="https://developer.apple.com/streaming/emsg-id3"||(N=zo(I),N.length&&a&&e.g.Gh([{cueTime:a.startTime,data:I,frames:N,dts:a.startTime,pts:a.startTime}],0,a.endTime))))}),v&&p.O("prft",function(I){if(!e.C&&a.aa.timescale){var _=I.reader,N=I.version;_.L(),I=_.L();var j=_.L();I=1e3*I+j/Math.pow(2,32)*1e3,N===0?_=_.L():(N=_.L(),_=_.L(),_=N*Math.pow(2,32)+_),I=new Date(new Date(Date.UTC(1900,0,1,0,0,0)).getTime()+I).getTime(),_=new Map().set("detail",{wallClockTime:I,programStartDate:new Date(I-_/a.aa.timescale*1e3)}),_=new We("prft",_),e.g.onEvent(_),e.C=!0}}),(m||v)&&p.parse(l),E(T,ZS(e,t,n),2);case 2:return yt(e.l),S=t.dd,t.dd=!1,C=t.Cf,t.Cf=!1,E(T,e.g.Ef(t.type,l),3);case 3:return E(T,bl(e.g.T,t.type,l,a,o,c,S,C,f),4);case 4:yt(e.l),F(T)}})}function ZS(e,t,n){var o,a,l,f;return z(function(c){if(c.g==1)return o=Math.max(e.h.bufferBehind,e.m.presentationTimeline.g),a=ig(e.g.T,t.type),a==null?c.return():(l=n-a,f=l-o,1>=f?c.return():E(c,e.g.T.remove(t.type,a,a+f),2));yt(e.l),F(c)})}function Vc(e){return e&&e.type==lt&&(e.stream.mimeType=="application/cea-608"||e.stream.mimeType=="application/cea-708")}function Hc(e,t,n,o){var a,l,f,c,p;return z(function(m){switch(m.g){case 1:if(n instanceof $n&&(a=n.g))return m.return(a);if(l=null,t.ra){var v=t.ra;if(v.g.has(n)){var S=v.g.get(n);o&&(S.h=o),v.g.delete(n),l=S.g}else l=null}return l||(l=_g(e,n,t.stream,o)),f=0,t.X&&(f=t.X.g),t.Na=l,E(m,l.promise,2);case 2:if(c=m.h,t.Na=null,p=c.data,!n.aes128Key){m.B(3);break}return E(m,KS(p,n.aes128Key,f),4);case 4:p=m.h;case 3:return m.return(p)}})}function _g(e,t,n,o){var a=t instanceof Xe?t:void 0,l=a?1:0;return t=Rl(t.Z(),t.Qa,t.wa,e.h.retryParameters,o),e.g.Tb.request(Li,t,{type:l,stream:n,segment:a})}function $c(e,t,n,o){var a,l;return z(function(f){if(f.g==1)return t.wb=!1,t.Zd=!1,t.vd=0,t.Lc=!0,t.Ca=null,t.Db=null,t.X=null,t.ra&&Tg(t.ra),o?(a=e.g.Dd(),l=e.g.T.getDuration(),E(f,e.g.T.remove(t.type,a+o,l),3)):E(f,og(e.g.T,t.type),4);if(f.g!=3)return yt(e.l),n?E(f,e.g.T.flush(t.type),3):f.B(3);yt(e.l),t.Lc=!1,t.endOfStream=!1,t.Da||t.ib||ci(e,t,0),F(f)})}function ci(e,t,n){var o=t.type;(o!=lt||e.i.has(o))&&(t.ib=new Is(function(){var a;return z(function(l){if(l.g==1)return re(l,2),E(l,$S(e,t),4);if(l.g!=2)return ie(l,0);a=se(l),e.g&&e.g.onError(a),F(l)})}).U(n))}function Vs(e){e.ib!=null&&(e.ib.stop(),e.ib=null)}function Hs(e){return z(function(t){return e.Na?E(t,e.Na.abort(),0):t.B(0)})}function Rg(e,t,n){var o;return z(function(a){if(a.g==1)return E(a,u0(e.G),2);yt(e.l),o=e.h.maxDisabledTime===0&&n.code==1011?1:e.h.maxDisabledTime,n.category===1&&0<o&&(n.handled=e.g.wd(t.stream,o),n.handled&&(n.severity=1)),e.g.onError(n),n.handled||e.h.failureCallback(n),F(a)})}function JS(e){var t,n,o,a,l,f;return z(function(c){return c.g==1?(t=Date.now()/1e3,n=e.h.minTimeBetweenRecoveries,!e.h.allowMediaSourceRecoveries||t-e.H<n?c.return(!1):(e.H=t,o=Gt,(a=e.i.get(o.P))&&(a.Db=null,zs(e,a),Hs(a).catch(function(){})),(l=e.i.get(o.$))&&(l.Db=null,zs(e,l),Hs(l).catch(function(){})),f=new Map,e.j.audio&&f.set(o.P,e.j.audio),e.j.video&&f.set(o.$,e.j.video),E(c,sg(e.g.T,f),2))):c.return(!0)})}function Gc(e,t,n){var o,a,l,f,c,p,m;return z(function(v){switch(v.g){case 1:var S=new Bt(e).Ga.split("/").pop().split(".");return o=S.length==1?"":S.pop().toLowerCase(),(a=eT[o])?v.return(a):(l=0,f=Yt([e],n),re(v,2),f.method="HEAD",E(v,t.request(l,f).promise,4));case 4:c=v.h,a=c.headers["content-type"],ie(v,3);break;case 2:if(p=se(v),!p||p.code!=1002&&p.code!=1001){v.B(3);break}return f.method="GET",E(v,t.request(l,f).promise,6);case 6:m=v.h,a=m.headers["content-type"];case 3:return v.return(a?a.toLowerCase().split(";").shift():"")}})}var eT={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mpd:"application/dash+xml",ism:"application/vnd.ms-sstr+xml",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav",sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"};function Lg(e,t){if(e.lineBreak)return`
`;if(e.nestedCues.length)return e.nestedCues.map(function(f){return Lg(f,e)}).join("");var n=[],o=700<=e.fontWeight,a=e.fontStyle=="italic",l=e.textDecoration.includes("underline");return o&&n.push(["b"]),a&&n.push(["i"]),l&&n.push(["u"]),a=e.color,a==""&&t&&(a=t.color),o="",(a=Pg(a))&&(o+="."+a),a=e.backgroundColor,a==""&&t&&(a=t.backgroundColor),(t=Pg(a))&&(o+=".bg_"+t),o&&n.push(["c",o]),n.reduceRight(function(f,c){var p=w(c);return c=p.next().value,p=p.next().value,"<"+c+(p===void 0?"":p)+">"+f+"</"+c+">"},e.payload)}function Pg(e){e=e.toLowerCase();var t=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(parseInt(t[1],10)|256).toString(16).slice(1)+(parseInt(t[2],10)|256).toString(16).slice(1)+(parseInt(t[3],10)|256).toString(16).slice(1):e.startsWith("#")&&7<e.length&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function Wc(e,t){var n=[];e=w(e);for(var o=e.next();!o.done;o=e.next())if(o=o.value,o.isContainer)n.push.apply(n,R(Wc(o.nestedCues,o)));else{var a=o.clone();a.nestedCues=[],a.payload=Lg(o,t),n.push(a)}return n}function Gn(e,t){this.g=null;for(var n=w(Array.from(e.textTracks)),o=n.next();!o.done;o=n.next())o=o.value,o.mode="disabled",o.label==t&&(this.g=o);this.g||(this.g=e.addTextTrack("subtitles",t)),this.g.mode="hidden"}s=Gn.prototype,s.remove=function(e,t){return this.g?(Dg(this.g,function(n){return n.startTime<t&&n.endTime>e}),!0):!1},s.append=function(e){var t=Wc(e),n=[];e=this.g.cues?Array.from(this.g.cues):[];var o={};t=w(t);for(var a=t.next();!a.done;o={Zb:o.Zb},a=t.next())o.Zb=a.value,e.some(function(l){return function(f){return f.startTime==l.Zb.startTime&&f.endTime==l.Zb.endTime&&f.text==l.Zb.payload}}(o))||(a=tT(o.Zb))&&n.push(a);for(e=n.slice().sort(function(l,f){return l.startTime!=f.startTime?l.startTime-f.startTime:l.endTime!=f.endTime?l.endTime-f.startTime:"line"in VTTCue.prototype?n.indexOf(f)-n.indexOf(l):n.indexOf(l)-n.indexOf(f)}),e=w(e),o=e.next();!o.done;o=e.next())this.g.addCue(o.value)},s.destroy=function(){return this.g&&(Dg(this.g,function(){return!0}),this.g.mode="disabled"),this.g=null,Promise.resolve()},s.isTextVisible=function(){return this.g.mode=="showing"},s.setTextVisibility=function(e){this.g.mode=e?"showing":"hidden"};function tT(e){if(e.startTime>=e.endTime)return null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,e.size&&(t.size=e.size);try{t.align=e.textAlign}catch{}return e.textAlign=="center"&&t.align!="center"&&(t.align="middle"),e.writingMode=="vertical-lr"?t.vertical="lr":e.writingMode=="vertical-rl"&&(t.vertical="rl"),e.lineInterpretation==1&&(t.snapToLines=!1),e.line!=null&&(t.line=e.line),e.position!=null&&(t.position=e.position),t}function Dg(e,t){var n=e.mode;e.mode=n=="showing"?"showing":"hidden";for(var o=w(Array.from(e.cues)),a=o.next();!a.done;a=o.next())(a=a.value)&&t(a)&&e.removeCue(a);e.mode=n}ae("shaka.text.SimpleTextDisplayer",Gn),Gn.prototype.setTextVisibility=Gn.prototype.setTextVisibility,Gn.prototype.isTextVisible=Gn.prototype.isTextVisible,Gn.prototype.destroy=Gn.prototype.destroy,Gn.prototype.append=Gn.prototype.append,Gn.prototype.remove=Gn.prototype.remove;/*
 @license
 Shaka Player
 Copyright 2023 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function Wn(){}s=Wn.prototype,s.remove=function(){},s.append=function(){},s.destroy=function(){},s.isTextVisible=function(){return!1},s.setTextVisibility=function(){},ae("shaka.text.StubTextDisplayer",Wn),Wn.prototype.setTextVisibility=Wn.prototype.setTextVisibility,Wn.prototype.isTextVisible=Wn.prototype.isTextVisible,Wn.prototype.destroy=Wn.prototype.destroy,Wn.prototype.append=Wn.prototype.append,Wn.prototype.remove=Wn.prototype.remove;function Ng(){}function $s(e){for(;e.firstChild;)e.removeChild(e.firstChild)}ae("shaka.util.Dom",Ng),Ng.removeAllChildren=$s;function Xn(e,t){var n=this;this.m=!1,this.i=[],this.A=e,this.s=t,this.j=null,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.s.appendChild(this.g),this.C=new st(function(){Gs(n)}).$a(.25),this.h=new Map,this.l=new Ct,this.l.D(document,"fullscreenchange",function(){Gs(n,!0)}),this.l.D(this.A,"resize",function(){var o=n.A,a=o.videoWidth;o=o.videoHeight,a&&o?n.j=a/o:n.j=null}),this.o=null,"ResizeObserver"in d&&(this.o=new ResizeObserver(function(){Gs(n,!0)}),this.o.observe(this.g)),this.u=new Map}s=Xn.prototype,s.append=function(e){var t=[].concat(R(this.i)),n={};e=w(e);for(var o=e.next();!o.done;n={jd:n.jd},o=e.next())n.jd=o.value,t.some(function(a){return function(l){return zf(l,a.jd)}}(n))||this.i.push(n.jd);Gs(this)},s.destroy=function(){return this.g&&(this.s.removeChild(this.g),this.g=null,this.m=!1,this.i=[],this.C&&this.C.stop(),this.h.clear(),this.l&&(this.l.release(),this.l=null),this.o&&(this.o.disconnect(),this.o=null)),Promise.resolve()},s.remove=function(e,t){if(!this.g)return!1;var n=this.i.length;return this.i=this.i.filter(function(o){return o.startTime<e||o.endTime>=t}),Gs(this,n>this.i.length),!0},s.isTextVisible=function(){return this.m},s.setTextVisibility=function(e){this.m=e};function nT(e,t){for(;t!=null;){if(t==e.g)return!0;t=t.parentElement}return!1}function Og(e,t,n,o,a){var l=!1,f=[],c=[];t=w(t);for(var p=t.next();!p.done;p=t.next()){p=p.value,a.push(p);var m=e.h.get(p),v=p.startTime<=o&&p.endTime>o,S=m?m.wg:null;m&&(f.push(m.pe),m.bd&&f.push(m.bd),v||(l=!0,e.h.delete(p),m=null)),v&&(c.push(p),m?nT(e,S)||(l=!0):(iT(e,p,a),m=e.h.get(p),S=m.wg,l=!0)),0<p.nestedCues.length&&S&&Og(e,p.nestedCues,S,o,a),a.pop()}if(l){for(o=w(f),a=o.next();!a.done;a=o.next())a=a.value,a.parentElement&&a.parentElement.removeChild(a);for(c.sort(function(C,T){return C.startTime!=T.startTime?C.startTime-T.startTime:C.endTime-T.endTime}),c=w(c),p=c.next();!p.done;p=c.next())o=e.h.get(p.value),o.bd?(n.appendChild(o.bd),o.bd.appendChild(o.pe)):n.appendChild(o.pe)}}function Gs(e,t){if(e.g){var n=e.A.currentTime;if(!e.m||t!==void 0&&t){t=w(e.u.values());for(var o=t.next();!o.done;o=t.next())$s(o.value);$s(e.g),e.h.clear(),e.u.clear()}if(e.m){t=new Map,o=w(e.h.keys());for(var a=o.next();!a.done;a=o.next())a=a.value,t.set(a,e.h.get(a));Og(e,e.i,e.g,n,[])}}}function iT(e,t,n){var o=1<n.length,a=o?"span":"div";t.lineBreak&&(a="br"),t.rubyTag&&(a=t.rubyTag),o=!o&&0<t.nestedCues.length;var l=document.createElement(a);if(a!="br"&&rT(e,l,t,n,o),n=null,t.region&&t.region.id){n=t.region,a=e.j===4/3?2.5:1.9;var f=n.id+"_"+n.width+"x"+n.height+(n.heightUnits==Hn?"%":"px")+"-"+n.viewportAnchorX+"x"+n.viewportAnchorY+(n.viewportAnchorUnits==Hn?"%":"px");if(e.u.has(f))n=e.u.get(f);else{var c=document.createElement("span"),p=n.heightUnits==Hn?"%":"px",m=n.widthUnits==Hn?"%":"px",v=n.viewportAnchorUnits==Hn?"%":"px";c.id="shaka-text-region---"+f,c.classList.add("shaka-text-region"),c.style.position="absolute",n.heightUnits===2&&n.widthUnits===2?(c.style.height=5.33*n.height+"%",c.style.width=n.width*a+"%"):(c.style.height=n.height+p,c.style.width=n.width+m),n.viewportAnchorUnits===2?(p=n.viewportAnchorY/75*100,m=n.viewportAnchorX/(e.j===4/3?160:210)*100,p-=n.regionAnchorY*n.height*5.33/100,m-=n.regionAnchorX*n.width*a/100,c.style.top=p+"%",c.style.left=m+"%"):(c.style.top=n.viewportAnchorY-n.regionAnchorY*n.height/100+v,c.style.left=n.viewportAnchorX-n.regionAnchorX*n.width/100+v),c.style.display="flex",c.style.flexDirection="column",c.style.alignItems="center",c.style.justifyContent=t.displayAlign=="before"?"flex-start":t.displayAlign=="center"?"center":"flex-end",e.u.set(f,c),n=c}}a=l,o&&(a=document.createElement("span"),a.classList.add("shaka-text-wrapper"),a.style.backgroundColor=t.backgroundColor,a.style.lineHeight="normal",l.appendChild(a)),e.h.set(t,{pe:l,wg:a,bd:n})}function oT(e){var t=e.direction,n=e.positionAlign;return e=e.textAlign,n!==$a?n:e==="left"||e==="start"&&t===ws||e==="end"&&t==="rtl"?"line-left":e==="right"||e==="start"&&t==="rtl"||e==="end"&&t===ws?"line-right":"center"}function rT(e,t,n,o,a){var l=t.style,f=n.nestedCues.length==0,c=1<o.length;l.whiteSpace="pre-wrap";var p=n.payload.replace(/\s+$/g,function(v){return" ".repeat(v.length)});if(l.webkitTextStrokeColor=n.textStrokeColor,l.webkitTextStrokeWidth=n.textStrokeWidth,l.color=n.color,l.direction=n.direction,l.opacity=n.opacity,l.paddingLeft=Xc(n.linePadding,n,e.s),l.paddingRight=Xc(n.linePadding,n,e.s),l.textCombineUpright=n.textCombineUpright,l.textShadow=n.textShadow,n.backgroundImage)l.backgroundImage="url('"+n.backgroundImage+"')",l.backgroundRepeat="no-repeat",l.backgroundSize="contain",l.backgroundPosition="center",l.width="100%",l.height="100%";else{if(n.nestedCues.length)var m=t;else m=document.createElement("span"),t.appendChild(m);n.border&&(m.style.border=n.border),!a&&((t=Ug(o,function(v){return v.backgroundColor}))?m.style.backgroundColor=t:p&&(m.style.backgroundColor="rgba(0, 0, 0, 0.8)"),t=Ug(o,function(v){return v.fontFamily}))&&(m.style.fontFamily=t),p&&(m.textContent=p)}c&&!o[o.length-1].isContainer?l.display="inline":(l.display="flex",l.flexDirection="column",l.alignItems="center",l.justifyContent=n.displayAlign=="before"?"flex-start":n.displayAlign=="center"?"center":"flex-end"),f||(l.margin="0"),l.fontFamily=n.fontFamily,l.fontWeight=n.fontWeight.toString(),l.fontStyle=n.fontStyle,l.letterSpacing=n.letterSpacing,l.fontSize=Xc(n.fontSize,n,e.s),o=n.line,o!=null&&(f=n.lineInterpretation,f==Ga&&(f=1,c=16,e.j&&1>e.j&&(c=32),o=0>o?100+o/c*100:o/c*100),f==1&&(l.position="absolute",n.writingMode==Ss?(l.width="100%",n.lineAlign==ko?l.top=o+"%":n.lineAlign=="end"&&(l.bottom=100-o+"%")):n.writingMode=="vertical-lr"?(l.height="100%",n.lineAlign==ko?l.left=o+"%":n.lineAlign=="end"&&(l.right=100-o+"%")):(l.height="100%",n.lineAlign==ko?l.right=o+"%":n.lineAlign=="end"&&(l.left=100-o+"%")))),l.lineHeight=n.lineHeight,n.position!=null&&(n.writingMode==Ss?l.paddingLeft=n.position:l.paddingTop=n.position),e=oT(n),e=="line-left"?l.cssFloat="left":e=="line-right"&&(l.cssFloat="right"),l.textAlign=n.textAlign,l.textDecoration=n.textDecoration.join(" "),l.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&l.writingMode==n.writingMode||(l.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==Ss?l.width=n.size+"%":l.height=n.size+"%")}function Xc(e,t,n){var o=(o=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(o[1]),unit:o[2]}:null;if(!o)return e;var a=o.value;switch(o.unit){case"%":return a/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*a/t.cellResolution.rows+"px";default:return e}}function Ug(e,t){for(var n=e.length-1;0<=n;n--){var o=t(e[n]);if(o||o===0)return o}return null}ae("shaka.text.UITextDisplayer",Xn),Xn.prototype.setTextVisibility=Xn.prototype.setTextVisibility,Xn.prototype.isTextVisible=Xn.prototype.isTextVisible,Xn.prototype.remove=Xn.prototype.remove,Xn.prototype.destroy=Xn.prototype.destroy,Xn.prototype.append=Xn.prototype.append;function sT(e,t){function n(l){for(var f=l,c=w(t),p=c.next();!p.done;p=c.next())p=p.value,p.end&&p.start<l&&(f+=p.end-p.start);return l=Math.floor(f/3600),c=Math.floor(f/60%60),p=Math.floor(f%60),f=Math.floor(1e3*f%1e3),(10>l?"0":"")+l+":"+(10>c?"0":"")+c+":"+(10>p?"0":"")+p+"."+(100>f?10>f?"00":"0":"")+f}var o=Wc(e);e=`WEBVTT

`,o=w(o);for(var a=o.next();!a.done;a=o.next())a=a.value,e+=n(a.startTime)+" --> "+n(a.endTime)+function(l){var f=[];switch(l.textAlign){case"left":f.push("align:left");break;case"right":f.push("align:right");break;case Ui:f.push("align:middle");break;case"start":f.push("align:start");break;case"end":f.push("align:end")}switch(l.writingMode){case"vertical-lr":f.push("vertical:lr");break;case"vertical-rl":f.push("vertical:rl")}return f.length?" "+f.join(" "):""}(a)+`
`,e+=a.payload+`

`;return e}ae("shaka.text.WebVttGenerator",function(){});function Bg(e,t){this.h=e,this.g=t,this.m=void 0,this.i=!1,this.l=!0,this.j=!1}Bg.prototype.configure=function(e){this.g=e};function aT(e,t,n){try{if(!e.g.enabled)return t;var o=Kc(e);e:{switch(n.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":var a=Dl;break e;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":a=Ol;break e;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":a=jg;break e}a=void 0}o.ot=a,o.su=!0;var l=Pl(o);return Yc(t,l)}catch(f){return it("CMCD_SRC_ERROR","Could not generate src CMCD data.",f),t}}function Kc(e){return e.g.sessionId||(e.g.sessionId=d.crypto.randomUUID()),{v:1,sf:e.m,sid:e.g.sessionId,cid:e.g.contentId,mtp:e.h.getBandwidthEstimate()/1e3}}function kr(e,t,n){n=n===void 0?{}:n;var o=o===void 0?e.g.useHeaders:o;if(e.g.enabled){Object.assign(n,Kc(e)),n.pr=e.h.Cd();var a=n.ot===Nl||n.ot===Ol;if(e.j&&a&&(n.bs=!0,n.su=!0,e.j=!1),n.su==null&&(n.su=e.l),o)e=cT(n),Object.keys(e).length&&Object.assign(t.headers,e);else{var l=Pl(n);l&&(t.uris=t.uris.map(function(f){return Yc(f,l)}))}}}function lT(e){if(e.type===0)return hT;if(e=e.stream){var t=e.type;if(t=="video")return e.codecs&&e.codecs.includes(",")?Ol:Nl;if(t=="audio")return Dl;if(t=="text")return e.mimeType==="application/mp4"?Qc:qc}}function uT(e,t){if(t=e.h.pb()[t],!t.length)return NaN;var n=e.h.getCurrentTime();return(e=t.find(function(o){return o.start<=n&&o.end>=n}))?1e3*(e.end-n):NaN}function fT(e,t){var n=e.h.Cb();if(!n.length)return NaN;e=n[0],n=w(n);for(var o=n.next();!o.done;o=n.next())o=o.value,o.type==="variant"&&o.bandwidth>e.bandwidth&&(e=o);switch(t){case Nl:return e.videoBandwidth||NaN;case Dl:return e.audioBandwidth||NaN;default:return e.bandwidth}}function Pl(e){function t(S){return 100*n(S/100)}function n(S){return Math.round(S)}function o(S){return!Number.isNaN(S)&&S!=null&&S!==""&&S!==!1}var a=[],l={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(S){return encodeURIComponent(S)},rtp:t,tb:n},f=Object.keys(e||{}).sort();f=w(f);for(var c=f.next();!c.done;c=f.next()){c=c.value;var p=e[c];if(o(p)&&(c!=="v"||p!==1)&&(c!="pr"||p!==1)){var m=l[c];m&&(p=m(p)),m=typeof p;var v=void 0;v=m==="string"&&c!=="ot"&&c!=="sf"&&c!=="st"?c+"="+JSON.stringify(p):m==="boolean"?c:m==="symbol"?c+"="+p.description:c+"="+p,a.push(v)}}return a.join(",")}function cT(e){var t=Object.keys(e),n={},o=["Object","Request","Session","Status"],a=[{},{},{},{}],l={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};t=w(t);for(var f=t.next();!f.done;f=t.next())f=f.value,a[l[f]!=null?l[f]:1][f]=e[f];for(e=0;e<a.length;e++)(l=Pl(a[e]))&&(n["CMCD-"+o[e]]=l);return n}function Yc(e,t){return!t||e.includes("offline:")?e:(e=new Bt(e),e.g.set("CMCD",t),e.toString())}var jg="m",Dl="a",Nl="v",Ol="av",hT="i",qc="c",Qc="tt";ae("shaka.util.CmcdManager.StreamingFormat",{DASH:"d",HLS:"h",yg:"s",OTHER:"o"});function Kn(e){this.h=e,this.g=null}s=Kn.prototype,s.configure=function(e){this.h=e},s.Rf=function(){return this.h.enabled&&this.h.applyMaximumSuggestedBitrate&&this.g&&this.g.has(Vg)?1e3*this.g.get(Vg):null},s.Qf=function(){return this.h.enabled&&this.g&&this.g.has(zg)?1e3*this.g.get(zg):null},s.fh=function(){return this.h.enabled&&this.g&&this.g.has(Hg)?this.g.get(Hg):null},s.gh=function(){return this.h.enabled&&this.g&&this.g.has($g)?this.g.get($g):null},s.getBandwidthEstimate=function(e){var t=this.Qf();if(!t)return e;var n=this.h.estimatedThroughputWeightRatio;return 0<n&&1>=n?e*(1-n)+t*n:e};function Fg(e){return e?e.toLowerCase()==="false"?!1:/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""):!0}ae("shaka.util.CmsdManager",Kn),Kn.prototype.getBandwidthEstimate=Kn.prototype.getBandwidthEstimate,Kn.prototype.getRoundTripTime=Kn.prototype.gh,Kn.prototype.getResponseDelay=Kn.prototype.fh,Kn.prototype.getEstimatedThroughput=Kn.prototype.Qf,Kn.prototype.getMaxBitrate=Kn.prototype.Rf;var zg="etp",Vg="mb",Hg="rd",$g="rtt";function Zc(){}function Jc(e,t,n,o,a){var l=a in o,f=!0,c;for(c in t){var p=a+"."+c,m=l?o[a]:n[c];l||c in n?t[c]===void 0?m===void 0||l?delete e[c]:e[c]=Lo(m):m.constructor==Object&&t[c]&&t[c].constructor==Object?(e[c]||(e[c]=Lo(m)),p=Jc(e[c],t[c],m,o,p),f=f&&p):typeof t[c]!=typeof m||t[c]==null||typeof t[c]!="function"&&t[c].constructor!=m.constructor?(De("Invalid config, wrong type for "+p),f=!1):(typeof n[c]=="function"&&n[c].length!=t[c].length&&Le("Unexpected number of arguments for "+p),e[c]=t[c]):(De("Invalid config, unrecognized key "+p),f=!1)}return f}function eh(e,t){for(var n={},o=n,a=0,l=0;a=e.indexOf(".",a),!(0>a);)(a==0||e[a-1]!="\\")&&(l=e.substring(l,a).replace(/\\\./g,"."),o[l]={},o=o[l],l=a+1),a+=1;return o[e.substring(l).replace(/\\\./g,".")]=t,n}function Ul(e,t){return e&&t}ae("shaka.util.ConfigUtils",Zc),Zc.convertToConfigObject=eh,Zc.mergeConfigObjects=Jc;function Gg(){this.g=null,this.h=[]}function th(e,t){return z(function(n){if(n.g==1)return e.g?E(n,new Promise(function(o){return e.h.push(o)}),2):n.B(2);e.g=t,F(n)})}Gg.prototype.release=function(){0<this.h.length?this.h.shift()():this.g=null};function Yn(){}function Wg(e){return e=lo(e),new Bt(e).ob}function Ws(e,t,n){function o(c){Et(l).setUint32(f,c.byteLength,!0),f+=4,l.set(Ve(c),f),f+=c.byteLength}if(!n||!n.byteLength)throw new K(2,6,6015);var a;typeof t=="string"?a=hc(t,!0):a=t,e=lo(e),e=hc(e,!0);var l=new Uint8Array(12+e.byteLength+a.byteLength+n.byteLength),f=0;return o(e),o(a),o(n),l}function Xg(e,t,n){return t!=="skd"?e:(t=n.serverCertificate,n=lo(e).split("skd://").pop(),Ws(e,n,t))}function nh(e,t){e===2&&(t.headers["Content-Type"]="application/octet-stream")}ae("shaka.util.FairPlayUtils",Yn),Yn.commonFairPlayResponse=function(e,t){if(e===2){try{var n=It(t.data)}catch{return}e=!1,n=n.trim(),n.substr(0,5)==="<ckc>"&&n.substr(-6)==="</ckc>"&&(n=n.slice(5,-6),e=!0);try{var o=JSON.parse(n);o.ckc&&(n=o.ckc,e=!0),o.CkcMessage&&(n=o.CkcMessage,e=!0),o.License&&(n=o.License,e=!0)}catch{}e&&(t.data=Pt(li(n)))}},Yn.expressplayFairPlayRequest=function(e,t){nh(e,t)},Yn.conaxFairPlayRequest=function(e,t){nh(e,t)},Yn.ezdrmFairPlayRequest=function(e,t){nh(e,t)},Yn.verimatrixFairPlayRequest=function(e,t){e===2&&(e=Ve(t.body),e=Uo(e),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=Hi("spc="+e))},Yn.expressplayInitDataTransform=function(e,t,n){return Xg(e,t,n)},Yn.conaxInitDataTransform=function(e,t,n){if(t!=="skd")return e;t=n.serverCertificate,n=lo(e).split("skd://").pop().split("?").shift(),n=d.atob(n);var o=new ArrayBuffer(2*n.length);o=$t(o);for(var a=0,l=n.length;a<l;a++)o[a]=n.charCodeAt(a);return Ws(e,o,t)},Yn.ezdrmInitDataTransform=function(e,t,n){return t!=="skd"?e:(t=n.serverCertificate,n=lo(e).split(";").pop(),Ws(e,n,t))},Yn.verimatrixInitDataTransform=function(e,t,n){return Xg(e,t,n)},Yn.initDataTransform=Ws,Yn.defaultGetContentId=Wg,Yn.isFairPlaySupported=function(){var e;return z(function(t){return t.g==1?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},re(t,2),E(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):t.g!=2?t.return(!0):(se(t),t.return(!1))})};function ih(){}function Mr(){var e=1/0;navigator.connection&&navigator.connection.saveData&&(e=360);var t={retryParameters:Ri(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(c,p,m){return d.shakaMediaKeysPolyfill&&p=="skd"&&(p=m.serverCertificate,m=Wg(c),c=Ws(c,m,p)),c},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:Ms(),minHdcpVersion:"",ignoreDuplicateInitData:!el()},n="reload",o=!1;el()||Ja()||Rt("Tizen 4")||ec()||navigator.userAgent.match(/webOS\/4/i)||navigator.userAgent.match(/webOS\/5/i)||(n="smooth",o=!0),o={retryParameters:Ri(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},manifestPreprocessor:function(c){return Ul([c],c)},sequenceMode:!1,enableAudioGroups:!1,multiTypeVariantsAllowed:o},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',useSafariBehaviorForLive:!0,liveSegmentsDelay:3,sequenceMode:!(Ja()||el()||ec()||lr()),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,allowLowLatencyByteRangeOptimization:!0},mss:{manifestPreprocessor:function(c){return Ul([c],c)},sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}};var a={retryParameters:Ri(),failureCallback:function(c){return Ul([c])},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTPS:!1,preferNativeHls:!1,updateIntervalSeconds:1,dispatchAllEmsgBoxes:!1,observeQualityChanges:!1,maxDisabledTime:30,parsePrftBox:!1,segmentPrefetchLimit:0,liveSync:!1,liveSyncMaxLatency:1,liveSyncPlaybackRate:1.1,liveSyncMinLatency:0,liveSyncMinPlaybackRate:1,allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5};(Rt("Web0S")||Po()||ar()||Rt("Hisense")||Rt("VIDAA"))&&(a.stallSkip=0);var l={trackSelectionCallback:function(c){return z(function(p){return p.return(c)})},downloadSizeCallback:function(c){var p;return z(function(m){return m.g==1?navigator.storage&&navigator.storage.estimate?E(m,navigator.storage.estimate(),3):m.return(!0):(p=m.h,m.return(p.usage+c<.95*p.quota))})},progressCallback:function(c,p){return Ul([c,p])},usePersistentLicense:!0,numberOfParallelDownloads:5},f={drm:t,manifest:o,streaming:a,mediaSource:{codecSwitchingStrategy:n,sourceBufferExtraFeatures:"",forceTransmux:!1,insertFakeEncryptionInInit:!0},offline:l,abrFactory:function(){return new At},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0},autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",useHeaders:!1},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1},ads:{customPlayheadTracker:!1}};return l.trackSelectionCallback=function(c){return z(function(p){return p.return(dT(c,f.preferredAudioLanguage,f.preferredVideoHdrLevel))})},f}function _r(e,t,n){var o={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:""}};return Jc(e,t,n||Mr(),o,"")}function dT(e,t,n){var o=n;o=="AUTO"&&(o=d.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR");var a=e.filter(function(c){return!(c.type!="variant"||c.hdr&&c.hdr!=o)});n=[];var l=Qa(t,a.map(function(c){return c.language}));l&&(n=a.filter(function(c){return ht(c.language)==l})),n.length==0&&(n=a.filter(function(c){return c.primary})),n.length==0&&(a.map(function(c){return c.language}),n=a);var f=n.filter(function(c){return c.height&&480>=c.height});for(f.length&&(f.sort(function(c,p){return p.height-c.height}),n=f.filter(function(c){return c.height==f[0].height})),t=[],n.length&&(a=Math.floor(n.length/2),n.sort(function(c,p){return c.bandwidth-p.bandwidth}),t.push(n[a])),e=w(e),n=e.next();!n.done;n=e.next())n=n.value,n.type!=lt&&n.type!="image"||t.push(n);return t}ae("shaka.util.PlayerConfiguration",ih),ih.mergeConfigObjects=_r,ih.createDefault=Mr;function pT(){this.g=null,this.h=[]}function oh(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration),e=w(e.h);for(var o=e.next();!o.done;o=e.next())o=o.value,n+=o.state==t?o.duration:0;return n}function gT(e){function t(l){return{timestamp:l.timestamp,state:l.state,duration:l.duration}}for(var n=[],o=w(e.h),a=o.next();!a.done;a=o.next())n.push(t(a.value));return e.g&&n.push(t(e.g)),n}function mT(){this.i=this.h=null,this.g=[]}function rh(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function Kg(){this.u=this.A=this.G=this.C=this.s=this.j=this.F=this.m=this.i=this.K=this.N=this.H=this.I=this.J=this.l=this.o=NaN,this.g=new pT,this.h=new mT}function pe(e,t){dt.call(this);var n=this;this.l=gh,this.xd=this.h=null,this.da=!1,this.Gd=new Ct,this.sc=new Ct,this.o=new Ct,this.Ba=new Ct,this.C=this.G=this.m=this.H=null,this.Kd=0,this.W=new Gg,this.ma=this.ea=this.i=this.Ld=this.F=this.j=this.za=this.J=this.eg=this.Y=this.V=this.Aa=this.K=this.I=this.$b=null,this.mb=!1,this.Ne=this.s=null,this.We=1e9,this.Oc=[],this.N=NaN,this.g=Lr(this),this.Id={width:1/0,height:1/0},this.u=null,this.kb=new cr(this.g.preferredAudioLanguage,this.g.preferredVariantRole,this.g.preferredAudioChannelCount,this.g.preferredVideoHdrLevel,this.g.preferSpatialAudio,this.g.preferredVideoLayout,this.g.preferredAudioLabel,this.g.preferredVideoLabel,this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),this.lb=this.g.preferredTextLanguage,this.Kc=this.g.preferredTextRole,this.Jc=this.g.preferForcedSubs,this.Hc=[],t&&t(this),this.V=PT(this),this.Y=new Kn(this.g.cmsd),this.H=MT(this),this.H.nf(this.g.streaming.forceHTTPS),this.A=null,Hl&&(this.A=Hl(),this.A.configure(this.g.ads)),this.Gd.D(d,"online",function(){hh(n),n.gf()}),this.yd=new st(function(){return jT(n)}),e&&(ai("Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.Ic(e,!0))}Z(pe,dt);function Bl(e){e.J!=null&&(Z0(e.J),e.J.release(),e.J=null)}function yT(e,t){if(t.lcevc.enabled){var n=e.Cb();n&&n[0]&&n[0].videoMimeType=="video/mp2t"&&(Jf()||navigator.userAgent.match(/Edge\//))&&(t.mediaSource.forceTransmux||Le("LCEVC Warning: For MPEG-2 TS decoding the config.mediaSource.forceTransmux must be enabled.")),Bl(e),e.J==null&&(e.J=new Us(e.h,e.eg,t.lcevc),e.G&&(e.G.N=e.J))}else Bl(e)}function Mt(e,t){return new We(e,t)}s=pe.prototype,s.destroy=function(){var e=this,t;return z(function(n){switch(n.g){case 1:return e.l==Ti?n.return():(Bl(e),t=e.detach(),e.l=Ti,E(n,t,2));case 2:if(e.Gd&&(e.Gd.release(),e.Gd=null),e.sc&&(e.sc.release(),e.sc=null),e.o&&(e.o.release(),e.o=null),e.Ba&&(e.Ba.release(),e.Ba=null),e.Ne=null,e.g=null,e.u=null,e.xd=null,e.V=null,e.Y=null,!e.H){n.B(3);break}return E(n,e.H.destroy(),4);case 4:e.H=null;case 3:e.s&&(e.s.release(),e.s=null),dt.prototype.release.call(e),F(n)}})};function qi(e,t){e.dispatchEvent(Mt("onstatechange",new Map().set("state",t)))}s.Ic=function(e,t){t=t===void 0?!0:t;var n=this,o,a;return z(function(l){switch(l.g){case 1:if(n.l==Ti)throw new K(2,7,7e3);if(!n.h||n.h==e){l.B(2);break}return E(l,n.detach(),2);case 2:return E(l,sh(n,"attach"),4);case 4:if(l.h)return l.return();if(re(l,5,6),qi(n,"attach"),o=function(){var f=dh(n);f&&Ho(n,f)},n.sc.D(e,"error",o),n.h=e,!t||!wi()||n.G){l.B(6);break}return E(l,ah(n),6);case 6:ne(l),n.W.release(),le(l,0);break;case 5:return a=se(l),E(l,n.detach(),10);case 10:throw a}})},s.Eg=function(e){this.eg=e},s.detach=function(e){e=e===void 0?!1:e;var t=this;return z(function(n){if(n.g==1){if(t.l==Ti)throw new K(2,7,7e3);return E(n,t.rc(!1,e),2)}if(n.g!=3)return E(n,sh(t,"detach"),3);if(n.h)return n.return();try{t.h&&(t.sc.Za(),t.h=null),qi(t,"detach"),t.A&&!e&&t.A.release()}finally{t.W.release()}F(n)})};function sh(e,t){var n;return z(function(o){return o.g==1?(n=++e.Kd,E(o,th(e.W,t),2)):n!=e.Kd?(e.W.release(),o.return(!0)):o.return(!1)})}s.rc=function(e,t){e=e===void 0?!0:e,t=t===void 0?!1:t;var n=this,o,a,l,f,c,p,m,v,S;return z(function(C){switch(C.g){case 1:return n.l!=Ti&&(n.l=gh),E(C,sh(n,"unload"),2);case 2:return C.h?C.return():(ye(C,3),n.mb=!1,qi(n,"unload"),e&&!wi()&&(e=!1),Bl(n),o=n.Hc.map(function(T){return T()}),n.Hc=[],E(C,Promise.all(o),5));case 5:if(n.dispatchEvent(Mt("unloading")),n.Aa&&(n.Aa.release(),n.Aa=null),n.h&&(n.o.Za(),n.Ba.Za()),n.yd.stop(),n.$b&&(n.$b.release(),n.$b=null),!n.F){C.B(6);break}return E(C,n.F.stop(),7);case 7:n.F=null,n.Ld=null;case 6:if(!n.s){C.B(8);break}return E(C,n.s.stop(),8);case 8:if(!n.j){C.B(10);break}return E(C,n.j.destroy(),11);case 11:n.j=null;case 10:if(n.I&&(n.I.release(),n.I=null),n.C&&(n.C.release(),n.C=null),!n.G){C.B(12);break}return E(C,n.G.destroy(),13);case 13:n.G=null;case 12:if(n.A&&!t&&n.A.onAssetUnload(),n.Y&&(n.Y.g=null),n.h&&$s(n.h),!n.h||!n.h.src){C.B(14);break}return E(C,new Promise(function(T){return new st(T).U(.1)}),15);case 15:n.h.removeAttribute("src"),n.h.load();case 14:if(!n.m){C.B(16);break}return E(C,n.m.destroy(),17);case 17:n.m=null;case 16:if(n.ea=null,n.K=null,n.i){for(a=w(n.i.variants),l=a.next();!l.done;l=a.next())for(f=l.value,c=w([f.audio,f.video]),p=c.next();!p.done;p=c.next())(m=p.value)&&m.segmentIndex&&m.segmentIndex.release();for(v=w(n.i.textStreams),p=v.next();!p.done;p=v.next())S=p.value,S.segmentIndex&&S.segmentIndex.release()}n.i=null,n.u=new Kg,n.Te=null,n.Oc=[],n.N=NaN,ch(n);case 3:ne(C),n.W.release(),le(C,4);break;case 4:if(e&&wi()&&!n.G)return E(C,ah(n),0);C.B(0)}})},s.ei=function(e){this.ma=e},s.load=function(e,t,n){t=t===void 0?null:t;var o=this,a,l,f,c,p;return z(function(m){switch(m.g){case 1:if(o.l==Ti)throw new K(2,7,7e3);return E(m,th(o.W,"load"),2);case 2:if(o.W.release(),!o.h)throw new K(2,7,7002);if(!o.ea){m.B(3);break}return E(m,o.rc(!1),3);case 3:if(a=++o.Kd,l=function(){if(o.Kd!=a)throw new K(2,7,7e3)},f=function(v,S){return z(function(C){switch(C.g){case 1:return ye(C,2),E(C,th(o.W,S),4);case 4:return l(),E(C,v(),5);case 5:l();case 2:ne(C),o.W.release(),le(C,0)}})},re(m,5),o.ma=t,o.mb=!1,o.dispatchEvent(Mt("loading")),c=Date.now()/1e3,o.u=new Kg,o.ea=e,n){m.B(7);break}return E(m,f(function(){return z(function(v){if(v.g==1)return E(v,vT(o),2);n=v.h,F(v)})},"guessMimeType_"),7);case 7:if(xT(o,n))return E(m,f(function(){return z(function(v){return E(v,CT(o,n),0)})},"initializeSrcEqualsDrmInner_"),16);if(o.G){m.B(11);break}return E(m,f(function(){return z(function(v){return E(v,ah(o),0)})},"initializeMediaSourceEngineInner_"),11);case 11:return E(m,f(function(){return z(function(v){return E(v,wT(o,n),0)})},"parseManifestInner_"),13);case 13:return E(m,f(function(){return z(function(v){return E(v,ST(o),0)})},"initializeDrmInner_"),14);case 14:return E(m,f(function(){return z(function(v){return E(v,TT(o,c),0)})},"loadInner_"),10);case 16:return E(m,f(function(){return z(function(v){return E(v,ET(o,c,n),0)})},"srcEqualsInner_"),10);case 10:o.dispatchEvent(Mt("loaded")),ie(m,0);break;case 5:if(p=se(m),p.code==7e3){m.B(18);break}return E(m,o.rc(!1),18);case 18:throw p}})};function vT(e){var t,n;return z(function(o){return o.g==1?(t=e.g.manifest.retryParameters,E(o,Gc(e.ea,e.H,t),2)):(n=o.h,n=="application/x-mpegurl"&&tl()&&(n="application/vnd.apple.mpegurl"),o.return(n))})}function xT(e,t){if(!wi())return!0;if(t){if((e.h||Vp()).canPlayType(t)=="")return!1;if(!(wi()&&t in fi))return!0;if(t==="application/x-mpegurl"||t==="application/vnd.apple.mpegurl"){if(e.g.streaming.preferNativeHls)return!0;if(tl())return e.g.streaming.useNativeHlsOnSafari}}return!1}function ah(e){var t,n,o,a,l;return z(function(f){if(f.g==1)return qi(e,"media-source"),t=e.g.textDisplayFactory,n=t(),e.Te=t,o=LT(e.h,n,function(c,p,m){Yg(e,c,p,m)},e.J),o.configure(e.g.mediaSource),a=e.g.manifest,l=a.segmentRelativeVttTiming,o.Y=l,E(f,o.J,2);e.G=o,F(f)})}function wT(e,t){var n,o,a,l,f,c,p,m;return z(function(v){if(v.g==1)return n=e.H,qi(e,"manifest-parser"),e.Ld=F0(e.ea,t||null),e.F=e.Ld(),o=Lo(e.g.manifest),e.h&&e.h.nodeName==="AUDIO"&&(o.disableVideo=!0),e.F.configure(o),e.Aa=new Bc(function(){return e.Eb()}),e.Aa.addEventListener("regionadd",function(S){S=S.region,Ks(e,"timelineregionadded",S),e.A&&e.A.onDashTimedMetadata(S)}),e.za=null,e.g.streaming.observeQualityChanges&&(e.za=new Ml(function(){return e.pb()}),e.za.addEventListener("qualitychange",function(S){var C=S.quality;S=S.position,C=new Map().set("mediaQuality",{bandwidth:C.bandwidth,audioSamplingRate:C.audioSamplingRate,codecs:C.codecs,contentType:C.contentType,frameRate:C.frameRate,height:C.height,mimeType:C.mimeType,channelsCount:C.channelsCount,pixelAspectRatio:C.pixelAspectRatio,width:C.width}).set("position",S),e.dispatchEvent(Mt("mediaqualitychanged",C))})),a={networkingEngine:n,filter:function(S){return rm(e,S)},makeTextStreamsForClosedCaptions:function(S){return OT(e,S)},onTimelineRegionAdded:function(S){var C=e.Aa;e:{for(var T=w(C.g),I=T.next();!I.done;I=T.next())if(I=I.value,I.schemeIdUri==S.schemeIdUri&&I.id==S.id&&I.startTime==S.startTime&&I.endTime==S.endTime){T=I;break e}T=null}T==null&&(C.g.add(S),S=new We("regionadd",new Map([["region",S]])),C.dispatchEvent(S))},onEvent:function(S){return e.dispatchEvent(S)},onError:function(S){return Ho(e,S)},isLowLatencyMode:function(){return e.g.streaming.lowLatencyMode},isAutoLowLatencyMode:function(){return e.g.streaming.autoLowLatencyMode},enableLowLatencyMode:function(){e.configure("streaming.lowLatencyMode",!0)},updateDuration:function(){e.j&&e.j.updateDuration()},newDrmInfo:function(S){var C=e.m?e.m.g:null;C&&e.m.s&&fh(e,C.keySystem,S)},onManifestUpdated:function(){var S=new Map().set("isLive",e.R());e.dispatchEvent(Mt("manifestupdated",S)),e.A&&e.A.onManifestUpdated(e.R())},getBandwidthEstimate:function(){return e.s.getBandwidthEstimate()}},l=Date.now()/1e3,qi(e,"manifest"),f=e,E(v,e.F.start(e.ea,a),2);if(f.i=v.h,c=Mt("manifestparsed"),e.dispatchEvent(c),e.i.variants.length==0)throw new K(2,4,4036);kT(e.i),p=Date.now()/1e3,m=p-l,e.u.F=m,F(v)})}function ST(e){var t,n,o;return z(function(a){return a.g==1?(qi(e,"drm-engine"),t=Date.now()/1e3,n=!0,e.m=Zg(e,{Tb:e.H,onError:function(l){Ho(e,l)},Ud:function(l){pm(e,l)},onExpirationUpdated:function(l,f){gm(e,l,f)},onEvent:function(l){e.dispatchEvent(l),l.type=="drmsessionupdate"&&n&&(n=!1,e.u.j=Date.now()/1e3-t,e.J&&Z0(e.J))}}),e.m.configure(e.g.drm),Gp(e.i.variants,e.g.restrictions,e.Id)&&e.j&&Ln(e),o=rc(e.i.variants),E(a,b0(e.m,o,e.i.offlineSessionIds),2)):a.g!=3?E(a,e.m.Ic(e.h),3):E(a,rm(e,e.i),0)})}function TT(e,t){var n,o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X,V;return z(function(q){switch(q.g){case 1:for(qi(e,"load"),n=e.h,e.I=new Bs({Ed:function(){return n.playbackRate},ec:function(){return n.defaultPlaybackRate},rf:function(te){n.playbackRate=te},bg:function(te){n.currentTime+=te}}),o=function(){return jl(e)},a=function(){return am(e)},e.o.D(n,"playing",o),e.o.D(n,"pause",o),e.o.D(n,"ended",o),e.o.D(n,"ratechange",a),yT(e,e.g),l=e.g.abrFactory,e.s&&e.Ne==l||(e.Ne=l,e.s=l(),typeof e.s.setMediaElement!="function"&&(ai("AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),e.s.setMediaElement=function(){}),typeof e.s.setCmsdManager!="function"&&(ai("AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),e.s.setCmsdManager=function(){}),typeof e.s.trySuggestStreams!="function"&&(ai("AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),e.s.trySuggestStreams=function(){}),e.s.configure(e.g.abr)),e.kb=new cr(e.g.preferredAudioLanguage,e.g.preferredVariantRole,e.g.preferredAudioChannelCount,e.g.preferredVideoHdrLevel,e.g.preferSpatialAudio,e.g.preferredVideoLayout,e.g.preferredAudioLabel,e.g.preferredVideoLabel,e.g.mediaSource.codecSwitchingStrategy,e.g.manifest.dash.enableAudioGroups),e.lb=e.g.preferredTextLanguage,e.Kc=e.g.preferredTextRole,e.Jc=e.g.preferForcedSubs,ph(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.s.init(function(te,de,ce){e.j&&te!=e.j.j&&zl(e,te,!0,de===void 0?!1:de,ce===void 0?0:ce)}),e.s.setMediaElement(n),e.s.setCmsdManager(e.Y),$p(e.i,e.g.preferredVideoCodecs,e.g.preferredAudioCodecs,e.g.preferredDecodingAttributes),e.j=DT(e),e.j.configure(e.g.streaming),e.l=un,n.textTracks&&e.o.D(n.textTracks,"addtrack",function(te){if(te.track)switch(te=te.track,te.kind){case"chapters":Qg(e,te)}}),e.dispatchEvent(Mt("streaming")),f=null,(c=e.j.j)||(f=um(e,!0)),p=[],m=c||f,v=w([m.video,m.audio]),S=v.next();!S.done;S=v.next())(C=S.value)&&!C.segmentIndex&&p.push(C.createSegmentIndex());if(!(0<p.length)){q.B(2);break}return E(q,Promise.all(p),2);case 2:if(e.F&&e.F.onInitialVariantChosen&&e.F.onInitialVariantChosen(m),ph(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.C=_T(e,e.ma),e.$b=RT(e,t),T=Math.max(e.i.minBufferTime,e.g.streaming.rebufferingGoal),Jg(e,n,T),c){q.B(4);break}if(zl(e,f,!0,!1,0),!e.g.streaming.startAtSegmentBoundary){q.B(4);break}return I=e.C,_=I.je,E(q,BT(f,e.C.qd()),6);case 6:_.call(I,q.h);case 4:return e.C.ie(),N=e.jc().find(function(te){return te.active}),N||((j=_s(e.i.textStreams,e.lb,e.Kc,e.Jc)[0]||null)&&rh(e.u.h,j,!0),f&&(j?(f.audio&&FT(e,f.audio,j)&&(e.da=!0),e.da&&e.G.F.setTextVisibility(!0),hm(e)):e.da=!1),j&&(e.g.streaming.alwaysStreamText||e.Me())&&Ll(e.j,j)),E(q,e.j.start(),7);case 7:e.g.abr.enabled&&(e.s.enable(),dm(e)),Ln(e),Pr(e),e.i.variants.some(function(te){return te.primary}),(O=e.R())&&(e.g.streaming.liveSync||e.i.serviceDescription)?(X=function(){return lm(e)},e.o.D(n,"timeupdate",X)):O||(V=function(){return Fl(e)},e.o.D(n,"timeupdate",V),Fl(e)),e.A&&e.A.onManifestUpdated(O),e.mb=!0,e.o.ja(n,"loadedmetadata",function(){e.u.m=Date.now()/1e3-t}),F(q)}})}function CT(e,t){var n,o,a,l;return z(function(f){return f.g==1?(n=Gt,o=Date.now()/1e3,a=!0,e.m=Zg(e,{Tb:e.H,onError:function(c){Ho(e,c)},Ud:function(c){pm(e,c)},onExpirationUpdated:function(c,p){gm(e,c,p)},onEvent:function(c){e.dispatchEvent(c),c.type=="drmsessionupdate"&&a&&(a=!1,e.u.j=Date.now()/1e3-o)}}),e.m.configure(e.g.drm),l={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:{id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:t?ji(t):"",codecs:t?ri(t):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.$,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1},bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},e.m.Y=!0,E(f,b0(e.m,[l],[]),2)):E(f,e.m.Ic(e.h),0)})}function ET(e,t,n){var o,a,l,f,c,p,m,v,S,C;return z(function(T){if(T.g==1)return qi(e,"src-equals"),o=e.h,e.C=new gg(o),a=!1,e.Hc.push(function(){a=!0}),e.ma!=null&&e.C.je(e.ma),e.I=new Bs({Ed:function(){return o.playbackRate},ec:function(){return o.defaultPlaybackRate},rf:function(I){o.playbackRate=I},bg:function(I){o.currentTime+=I}}),l=e.g.streaming.rebufferingGoal,Jg(e,o,l),f=function(){return jl(e)},c=function(){return am(e)},e.o.D(o,"playing",f),e.o.D(o,"pause",f),e.o.D(o,"ended",f),e.o.D(o,"ratechange",c),o.preload!="none"&&e.o.ja(o,"loadedmetadata",function(){e.u.m=Date.now()/1e3-t}),o.audioTracks&&(e.o.D(o.audioTracks,"addtrack",function(){return Ln(e)}),e.o.D(o.audioTracks,"removetrack",function(){return Ln(e)}),e.o.D(o.audioTracks,"change",function(){return Ln(e)})),o.textTracks&&(e.o.D(o.textTracks,"addtrack",function(I){if(I.track)switch(I=I.track,I.kind){case"metadata":IT(e,I);break;case"chapters":Qg(e,I);break;default:Ln(e)}}),e.o.D(o.textTracks,"removetrack",function(){return Ln(e)}),e.o.D(o.textTracks,"change",function(){return Ln(e)})),o.src=aT(e.V,e.ea,n),(Po()||Rt("Web0S"))&&o.load(),e.l=Cn,e.dispatchEvent(Mt("streaming")),p=new bt,Ar(o,HTMLMediaElement.HAVE_METADATA,e.o,function(){e.C.ie(),p.resolve()}),Ar(o,HTMLMediaElement.HAVE_CURRENT_DATA,e.o,function(){var I;return z(function(_){if(_.g==1)return AT(e),I=Xs(e),I.find(function(N){return N.mode!="disabled"})?(0<I.length&&(e.da=!0),_.B(2)):E(_,new Promise(function(N){e.o.ja(o.textTracks,"change",N),new st(N).U(1)}),2);if(a)return _.return();bT(e),F(_)})}),o.error?p.reject(dh(e)):o.preload=="none"&&(Le('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),p.resolve()),e.o.ja(o,"error",function(){p.reject(dh(e))}),E(T,p,2);(m=e.R())&&e.g.streaming.liveSync?(v=function(){return lm(e)},e.o.D(o,"timeupdate",v)):m||(S=function(){return Fl(e)},e.o.D(o,"timeupdate",S),Fl(e)),e.A&&(e.A.onManifestUpdated(m),m&&(C=e.Eb().end,e.o.D(o,"progress",function(){var I=e.Eb().end;C!=I&&(e.A.onManifestUpdated(e.R()),C=I)}))),e.mb=!0,F(T)})}function AT(e){var t=e.g.preferredAudioLanguage;t!=""&&e.jg(t,e.g.preferredVariantRole)}function bT(e){var t=e.g.preferredTextLanguage;t!=""&&e.kf(t,e.g.preferredTextRole,e.g.preferForcedSubs)}function IT(e,t){if(t.kind=="metadata"){t.mode="hidden",e.o.D(t,"cuechange",function(){if(t.activeCues)for(var o=w(t.activeCues),a=o.next();!a.done;a=o.next())a=a.value,qg(e,a.startTime,a.endTime,a.type,a.value),e.A&&e.A.onCueMetadataChange(a.value)});var n=new st(function(){var o=NT(e);o=w(o);for(var a=o.next();!a.done;a=o.next())a.value.mode="hidden"}).qc().U(.5);e.Hc.push(function(){n.stop()})}}function Yg(e,t,n,o){t=w(t);for(var a=t.next();!a.done;a=t.next())if(a=a.value,a.data&&a.cueTime&&a.frames){var l=a.cueTime+n,f=o;f&&l>f&&(f=l);for(var c=w(a.frames),p=c.next();!p.done;p=c.next())qg(e,l,f,"org.id3",p.value);e.A&&e.A.onHlsTimedMetadata(a,l)}}function qg(e,t,n,o,a){t=new Map().set("startTime",t).set("endTime",n).set("metadataType",o).set("payload",a),e.dispatchEvent(Mt("metadata",t))}function Qg(e,t){if(t&&t.kind=="chapters"){t.mode="hidden";var n=new st(function(){t.mode="hidden"}).qc().U(.5);e.Hc.push(function(){n.stop()})}}function kT(e){function t(n){return n.video&&n.audio||n.video&&n.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}s.Mh=function(){for(var e=this.W;e.g;)e.release()};function Zg(e,t){return new xl(t,e.g.drm.updateExpirationTime)}function MT(e){return new Tt(function(t,n,o){e.s&&e.s.segmentDownloaded(t,n,o)},function(t,n,o){if(n=new Map().set("headers",t).set("request",n).set("requestType",o),e.dispatchEvent(Mt("downloadheadersreceived",n)),e.Y&&(n=e.Y,n.h.enabled)){if(o=t["cmsd-static"])try{var a=new Map,l=o.split(",");for(o=0;o<l.length;o++){var f=l[o].split("=");a.set(f[0],Fg(f[1]))}}catch{}if(t=t["cmsd-dynamic"]){try{var c=new Map,p=t.split(";");for(t=1;t<p.length;t++){var m=p[t].split("=");c.set(m[0],Fg(m[1]))}var v=c}catch{v=null}v&&(n.g=v)}}},function(t,n,o,a){t=new Map().set("request",t).set("error",n).set("httpResponseCode",o).set("aborted",a),e.dispatchEvent(Mt("downloadfailed",t))},function(t,n,o){var a=e.V;if(o=o===void 0?{}:o,a.g.enabled)if(n.method==="HEAD")kr(a,n);else switch(t){case 0:try{if(a.g.enabled){if(o.type){e:{switch(o.type){case 4:var l="d";break e;case 3:case 2:l="h";break e;case 5:l="s";break e}l=void 0}a.m=l}kr(a,n,{ot:jg,su:!a.i})}}catch(v){it("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",v)}break;case Li:t=o;try{if(a.g.enabled){var f=t.segment;l=0,f&&(l=f.endTime-f.startTime);var c={d:1e3*l,st:a.h.R()?"l":"v"};c.ot=lT(t);var p=c.ot===Nl||c.ot===Dl||c.ot===Ol||c.ot===Qc,m=t.stream;m&&(p&&(c.bl=uT(a,m.type)),m.bandwidth&&(c.br=m.bandwidth/1e3)),p&&c.ot!==Qc&&(c.tb=fT(a,c.ot)/1e3),kr(a,n,c)}}catch(v){it("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",v)}break;case 2:case 5:case 6:kr(a,n,{ot:"k"});break;case 4:kr(a,n,{ot:"o"})}},function(t,n,o,a){e.F&&e.F.banLocation&&e.F.banLocation(a)})}function _T(e,t){return new mg(e.h,e.i,e.g.streaming,t,function(){e.$b&&Sg(e.$b,!0),e.j&&e.j.dd(),e.K&&Rr(e)},function(n){return e.dispatchEvent(n)})}function RT(e,t){t=new _l(e.Aa,e.R()||0<t),t.addEventListener("enter",function(o){Ks(e,"timelineregionenter",o.region)}),t.addEventListener("exit",function(o){Ks(e,"timelineregionexit",o.region)}),t.addEventListener("skip",function(o){var a=o.region;o.seeking||(Ks(e,"timelineregionenter",a),Ks(e,"timelineregionexit",a))});var n=new wg(e.h);return n.g.add(t),e.za&&n.g.add(e.za),n}function Jg(e,t,n){e.K=new Cw,e.K.g=hr,a0(e.K,n,Math.min(.5,n/2)),ch(e),e.o.D(t,"waiting",function(){return Rr(e)}),e.o.D(t,"stalled",function(){return Rr(e)}),e.o.D(t,"canplaythrough",function(){return Rr(e)}),e.o.D(t,"progress",function(){return Rr(e)})}function Rr(e){switch(e.l){case Cn:if(e.h.ended)var t=!0;else{var n=Sc(e.h.buffered);t=n!=null&&n>=e.h.duration-1}break;case un:e:if(e.h.ended||ng(e.G))t=!0;else{if(e.i.presentationTimeline.R()){n=e.i.presentationTimeline.Bb();var o=Sc(e.h.buffered);if(o!=null&&o>=n){t=!0;break e}}t=!1}break;default:t=!1}o=$0(e.h.buffered,e.h.currentTime),n=e.K;var a=t,l=n.h.get(n.g);t=n.g,o=a||o>=l?fl:hr,n.g=o,t!=o&&ch(e)}function LT(e,t,n,o){return new eg(e,t,n,o)}function PT(e){return new Bg({getBandwidthEstimate:function(){return e.s?e.s.getBandwidthEstimate():NaN},pb:function(){return e.pb()},getCurrentTime:function(){return e.h?e.h.currentTime:0},Cd:function(){return e.Cd()},Ob:function(){return e.Ob()},Cb:function(){return e.Cb()},R:function(){return e.R()}},e.g.cmcd)}function DT(e){return new Ag(e.i,{Dd:function(){return e.C?e.C.qd():0},getBandwidthEstimate:function(){return e.s.getBandwidthEstimate()},T:e.G,Tb:e.H,onError:function(t){return Ho(e,t)},onEvent:function(t){return e.dispatchEvent(t)},Fh:function(){e.F&&e.F.update&&e.F.update()},af:function(t,n){var o=t.startTime,a=t.endTime,l=n.type;e.C&&e.C.cg(),Rr(e),o=new Map().set("start",o).set("end",a).set("contentType",l),e.dispatchEvent(Mt("segmentappended",o)),e.s&&n.fastSwitching&&t.Zc&&t.Md&&e.s.trySuggestStreams()},Eh:function(t,n){(n=n.Ve)&&e.za&&DS(e.za,n,t)},Ef:function(t,n){var o=e.m;if(o.h.parseInbandPsshEnabled&&!o.F&&["audio","video"].includes(t)){n=new C0(Ve(n));var a=0,l=w(n.data);for(t=l.next();!t.done;t=l.next())a+=t.value.length;if(a==0)o=Promise.resolve();else{for(a=new Uint8Array(a),l=0,n=w(n.data),t=n.next();!t.done;t=n.next())t=t.value,a.set(t,l),l+=t.length;Ds(o,"cenc",a),o=o.l}}else o=Promise.resolve();return o},Gh:function(t,n,o){Yg(e,t,n,o)},wd:function(t,n){return e.wd(t,n)}})}s.configure=function(e,t){arguments.length==2&&typeof e=="string"&&(e=eh(e,t)),e.streaming&&"forceTransmuxTS"in e.streaming&&(ai("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(ai("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&e.streaming.lowLatencyMode&&(e.streaming.inaccurateManifestTolerance==null&&(e.streaming.inaccurateManifestTolerance=0),e.streaming.rebufferingGoal==null&&(e.streaming.rebufferingGoal=.01),e.streaming.segmentPrefetchLimit==null&&(e.streaming.segmentPrefetchLimit=2),e.streaming.retryParameters==null&&(e.streaming.retryParameters={}),e.streaming.retryParameters.baseDelay==null&&(e.streaming.retryParameters.baseDelay=100),e.manifest==null&&(e.manifest={}),e.manifest.retryParameters==null&&(e.manifest.retryParameters={}),e.manifest.retryParameters.baseDelay==null&&(e.manifest.retryParameters.baseDelay=100),e.drm==null&&(e.drm={}),e.drm.retryParameters==null&&(e.drm.retryParameters={}),e.drm.retryParameters.baseDelay==null&&(e.drm.retryParameters.baseDelay=100));var n=_r(this.g,e,Lr(this));return em(this),n};function em(e){if(e.F){var t=Lo(e.g.manifest);e.h&&e.h.nodeName==="AUDIO"&&(t.disableVideo=!0),e.F.configure(t)}if(e.m&&e.m.configure(e.g.drm),e.j){e.j.configure(e.g.streaming);try{sm(e,e.i)}catch(l){Ho(e,l)}e.s&&Pr(e),t=e.j.j,!t||t.allowedByApplication&&t.allowedByKeySystem||Dr(e)}if(e.H&&e.H.nf(e.g.streaming.forceHTTPS),e.G&&(e.G.configure(e.g.mediaSource),e.G.Y=e.g.manifest.segmentRelativeVttTiming,t=e.g.textDisplayFactory,e.Te!=t)){var n=t(),o=e.G,a=o.F;o.F=n,a&&(n.setTextVisibility(a.isTextVisible()),a.destroy()),o.h&&(o.h.j=n),e.Te=t,e.j&&(t=e.j,(n=t.i.get(lt))&&Ir(t,n.stream,!0,0,!0))}e.s&&(e.s.configure(e.g.abr),e.g.abr.enabled?e.s.enable():e.s.disable(),dm(e)),e.K&&(t=e.g.streaming.rebufferingGoal,e.i&&(t=Math.max(t,e.i.minBufferTime)),a0(e.K,t,Math.min(.5,t/2))),e.i&&ph(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.A&&e.A.configure(e.g.ads),e.V&&e.V.configure(e.g.cmcd),e.Y&&e.Y.configure(e.g.cmsd)}s.getConfiguration=function(){var e=Lr(this);return _r(e,this.g,Lr(this)),e},s.Qg=function(){if(this.h){var e=this.h.buffered.length;e=e?this.h.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(t=Math.min(this.h.currentTime+t,this.Eb().end),e>=t)return 1;if(!(e<=this.h.currentTime)&&e<t)return(e-this.h.currentTime)/(t-this.h.currentTime)}return 0},s.Qh=function(){for(var e in this.g)delete this.g[e];_r(this.g,Lr(this),Lr(this)),em(this)},s.Xg=function(){return this.l},s.He=function(){return this.i?this.i.type:null},s.ah=function(){return this.h},s.Ob=function(){return this.H},s.Ge=function(){return this.ea},s.Of=function(){return this.A?this.A:null},s.R=function(){return this.i?this.i.presentationTimeline.R():this.h&&this.h.src?this.h.duration==1/0:!1},s.Rb=function(){return this.i?this.i.presentationTimeline.Rb():!1},s.sh=function(){if(this.i){var e=this.i.variants;return e.length?!e[0].video:!1}return this.h&&this.h.src?this.h.videoTracks?this.h.videoTracks.length==0:this.h.videoHeight==0:!1},s.Eb=function(){if(this.i){if(!this.mb&&this.i.type=="HLS")return{start:0,end:0};var e=this.i.presentationTimeline;return{start:e.hc(),end:e.qb()}}return this.h&&this.h.src&&(e=this.h.seekable,e.length)?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},s.ph=function(){this.R()&&(this.h.currentTime=this.Eb().end)},s.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},s.drmInfo=function(){return this.m?this.m.g:null},s.Qc=function(){return this.m?this.m.Qc():1/0},s.Fe=function(){return this.m?this.m.Fe():[]},s.Bd=function(){return this.m?this.m.Bd():{}},s.Ke=function(){return this.K?this.K.g==hr:!1},s.Cd=function(){return this.h?this.I?this.I.h:1:0},s.xf=function(e){var t=this;e==0?Le("A trick play rate of 0 is unsupported!"):(this.Ba.Za(),this.h.paused&&this.h.play(),this.I.set(e),this.l==un&&(this.s.playbackRateChanged(e),bg(this.j,1<Math.abs(e))),this.R()&&this.Ba.D(this.h,"timeupdate",function(){var n=t.h.currentTime,o=t.Eb(),a=t.g.streaming.safeSeekOffset;0<e?n>=o.end&&t.ud():n<=o.start+a&&t.ud()}))},s.ud=function(){var e=this.I.ec();this.l==Cn&&this.I.set(e),this.l==un&&(this.I.set(e),this.s.playbackRateChanged(e),bg(this.j,!1)),this.Ba.Za()},s.Cb=function(){if(this.i){for(var e=this.j?this.j.j:null,t=[],n=0,o=w(this.i.variants),a=o.next();!a.done;a=o.next())if(a=a.value,al(a)){var l=fr(a);l.active=a==e,l.active||n==1||e==null||a.video!=e.video||a.audio!=e.audio||(l.active=!0),l.active&&n++,t.push(l)}return t}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map(function(f){return oc(f)}):[]},s.jc=function(){if(this.i){for(var e=this.j?this.j.o:null,t=[],n=w(this.i.textStreams),o=n.next();!o.done;o=n.next()){o=o.value;var a=sl(o);a.active=o==e,t.push(a)}return t}return this.h&&this.h.src&&this.h.textTracks?Xs(this).map(function(l){return Qp(l)}):[]},s.Wg=function(){var e=this.Oc;return this.i&&(e=this.i.imageStreams),e.map(function(t){return nc(t)})},s.Ng=function(e){var t=this,n,o,a,l;return z(function(f){return f.g==1?t.l!=un&&t.l!=Cn?f.return(null):(n=t.Oc,t.i&&(n=t.i.imageStreams),(o=n.find(function(c){return c.id==e}))?o.segmentIndex?f.B(2):E(f,o.createSegmentIndex(),2):f.return(null)):f.g!=4?(a=[],Oc(o.segmentIndex,function(c){var p=tm(c.tilesLayout||o.tilesLayout);if(p){p=p.rows*p.Kb;for(var m=c.h-c.startTime,v=0;v<p;v++)a.push(t.Tf(e,c.startTime+m*v/p))}}),E(f,Promise.all(a),4)):(l=f.h,f.return(l.filter(function(c){return c})))})};function tm(e){return e&&(e=/(\d+)x(\d+)/.exec(e))?{Kb:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}s.Tf=function(e,t){var n=this,o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X,V;return z(function(q){return q.g==1?n.l!=un&&n.l!=Cn?q.return(null):(o=n.Oc,n.i&&(o=n.i.imageStreams),(a=o.find(function(te){return te.id==e}))?a.segmentIndex?q.B(2):E(q,a.createSegmentIndex(),2):q.return(null)):(l=a.segmentIndex.find(t),l==null||(f=a.segmentIndex.get(l),c=tm(f.tilesLayout||a.tilesLayout),!c)?q.return(null):(p=a.width||0,m=a.height||0,v=p/c.Kb,S=m/c.rows,C=c.Kb*c.rows,T=f.h-f.startTime,I=f.u||T/C,_=f.startTime,j=N=0,1<C&&(O=Math.floor((t-f.startTime)/I),_=f.startTime+O*I,N=O%c.Kb*v,j=Math.floor(O/c.Kb)*S),X=!1,(V=f.s)&&(X=!0,S=V.height,N=V.positionX,j=V.positionY,v=V.width),q.return({segment:f,imageHeight:m,imageWidth:p,height:S,positionX:N,positionY:j,startTime:_,duration:I,uris:f.Z(),width:v,sprite:X})))})},s.kg=function(e){if(this.i&&this.j){var t=this.i.textStreams.find(function(o){return o.id==e.id});t&&t!=this.j.o&&(rh(this.u.h,t,!1),Ll(this.j,t),Vl(this),this.lb=t.language)}else if(this.h&&this.h.src&&this.h.textTracks){t=Xs(this),t=w(t);for(var n=t.next();!n.done;n=t.next())n=n.value,ic(n)==e.id?n.mode=this.da?"showing":"hidden":n.mode="disabled";Vl(this)}},s.lf=function(e,t,n){if(t=t===void 0?!1:t,n=n===void 0?0:n,this.i&&this.j){this.g.abr.enabled&&Le("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var o=this.i.variants.find(function(a){return a.id==e.id});o&&al(o)&&(zl(this,o,!1,t,n),this.kb=new s0(o,this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),Pr(this))}else if(this.h&&this.h.audioTracks){for(t=Array.from(this.h.audioTracks),t=w(t),n=t.next();!n.done;n=t.next())if(n=n.value,ic(n)==e.id){fm(this,n);break}}},s.Pg=function(){return vm(this.Cb())},s.ih=function(){return vm(this.jc())},s.Og=function(){return Array.from(ym(this.Cb()))},s.hh=function(){return Array.from(ym(this.jc()))},s.jg=function(e,t,n,o){if(n=n===void 0?0:n,o=o===void 0?0:o,this.i&&this.C){this.kb=new cr(e,t||"",n,"",!1,"","","",this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),e=function(f,c){return f.video||c.video?f.video&&c.video?Math.abs((f.video.height||0)-(c.video.height||0))+Math.abs((f.video.width||0)-(c.video.width||0)):1/0:0},t=this.j.j;var a=this.kb.create(this.i.variants);n=null,a=w(a.values());for(var l=a.next();!l.done;l=a.next())l=l.value,(!n||e(n,t)>e(l,t))&&(n=l);n?(e=fr(n),this.lf(e,!0,o)):Dr(this)}else this.h&&this.h.audioTracks&&(o=_s(this.Cb(),e,t||"",!1)[0])&&this.lf(o)},s.kf=function(e,t,n){n=n===void 0?!1:n,this.i&&this.C?(this.lb=e,this.Kc=t||"",this.Jc=n,(e=_s(this.i.textStreams,this.lb,this.Kc,this.Jc)[0]||null)&&e!=this.j.o&&(rh(this.u.h,e,!1),this.g.streaming.alwaysStreamText||this.Me())&&(Ll(this.j,e),Vl(this))):(e=_s(this.jc(),e,t||"",n)[0])&&this.kg(e)},s.Wh=function(e,t,n){if(t=t===void 0?!0:t,n=n===void 0?0:n,this.i&&this.C){for(var o=null,a=w(this.i.variants),l=a.next();!l.done;l=a.next())if(l=l.value,l.audio.label==e){o=l;break}o!=null&&(this.kb=new cr(o.language,"",0,"",!1,"",e,"",this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),Dr(this,t,n))}else if(this.h&&this.h.audioTracks){for(n=Array.from(this.h.audioTracks),t=null,n=w(n),o=n.next();!o.done;o=n.next())o=o.value,o.label==e&&(t=o);t&&fm(this,t)}},s.Me=function(){var e=this.da;return this.G&&this.l==un?this.G.F.isTextVisible():this.h&&this.h.src&&this.h.textTracks?Xs(this).some(function(t){return t.mode=="showing"}):e},s.Pf=function(){return this.h&&this.h.src&&this.h.textTracks?nm(this).map(function(e){return Qp(e)}):[]},s.Rg=function(e){if(!this.h||!this.h.src||!this.h.textTracks)return[];var t=ht(e),n=nm(this).filter(function(c){return ht(c.language)==t});if(!n||!n.length)return[];e=[];var o=new Set;n=w(n);for(var a=n.next();!a.done;a=n.next())if((a=a.value)&&a.cues){a=w(a.cues);for(var l=a.next();!l.done;l=a.next()){var f=l.value;(l=f.id)&&l!=""||(l=f.startTime+"-"+f.endTime+"-"+f.text),f={id:l,title:f.text,startTime:f.startTime,endTime:f.endTime},o.has(l)||(e.push(f),o.add(l))}}return e};function Xs(e){return Array.from(e.h.textTracks).filter(function(t){return t.kind!="metadata"&&t.kind!="chapters"&&t.label!="Shaka Player TextTrack"})}function NT(e){return Array.from(e.h.textTracks).filter(function(t){return t.kind=="metadata"})}function nm(e){return Array.from(e.h.textTracks).filter(function(t){return t.kind=="chapters"})}s.og=function(e){if(e=!!e,this.da!=e){if(this.da=e,this.l==un)this.G.F.setTextVisibility(e),this.g.streaming.alwaysStreamText||(e?this.j.o||(e=_s(this.i.textStreams,this.lb,this.Kc,this.Jc),0<e.length&&(Ll(this.j,e[0]),Vl(this))):zS(this.j));else if(this.h&&this.h.src&&this.h.textTracks){var t=Xs(this);t=w(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n.mode!="disabled"&&(n.mode=e?"showing":"hidden")}hm(this)}},s.dh=function(){if(!this.R())return null;if(this.C)var e=this.C.qd();else{if(this.ma==null)return new Date;e=this.ma}if(this.i)return new Date(1e3*(this.i.presentationTimeline.i+e));if(this.h&&this.h.getStartDate){var t=this.h.getStartDate();return isNaN(t.getTime())?null:new Date(t.getTime()+1e3*e)}return null},s.Sf=function(){if(!this.R())return null;if(this.i)return new Date(1e3*this.i.presentationTimeline.i);if(this.h&&this.h.getStartDate){var e=this.h.getStartDate();return isNaN(e.getTime())?null:e}return null},s.pb=function(){if(this.l==un)return this.G.pb();var e={total:[],audio:[],video:[],text:[]};return this.l==Cn&&(e.total=fo(this.h.buffered)),e},s.getStats=function(){if(this.l!=un&&this.l!=Cn)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,switchHistory:[],stateHistory:[]};jl(this);var e=this.h,t=e.currentTime/e.duration;if(!isNaN(t)){var n=this.u;t=Math.round(100*t),n.i=isNaN(n.i)?t:Math.max(n.i,t)}if(this.C&&(this.u.K=this.C.Af(),this.u.N=this.C.Bf()),e.getVideoPlaybackQuality){n=e.getVideoPlaybackQuality(),t=this.u;var o=Number(n.totalVideoFrames);t.J=Number(n.droppedVideoFrames),t.I=o,this.u.H=Number(n.corruptedVideoFrames)}if(this.m?(n=this.m,n=n.I?n.I:NaN):n=NaN,this.u.s=n,this.l==un){if(n=this.j.j,t=this.j.o,n){o=this.I?this.I.h:1;var a=o*n.bandwidth;t&&t.bandwidth&&(a+=o*t.bandwidth),this.u.A=a}n&&n.video&&(t=this.u,o=n.video.height||NaN,t.o=n.video.width||NaN,t.l=o),this.R()&&(n=this.Sf().valueOf()+1e3*e.currentTime,this.u.C=(Date.now()-n)/1e3),this.i&&this.i.presentationTimeline&&(this.u.G=this.i.presentationTimeline.g),n=this.s.getBandwidthEstimate(),this.u.u=n}this.l==Cn&&(n=this.u,t=e.videoHeight||NaN,n.o=e.videoWidth||NaN,n.l=t);var l=this.u;e=l.o,n=l.l,t=l.A,o=l.I,a=l.J;var f=l.H,c=l.N,p=l.K,m=l.u,v=l.i,S=l.m,C=l.F,T=l.j,I=oh(l.g,"playing"),_=oh(l.g,"paused"),N=oh(l.g,"buffering"),j=l.s,O=l.C,X=l.G,V=gT(l.g),q=[];l=w(l.h.g);for(var te=l.next();!te.done;te=l.next())te=te.value,q.push({timestamp:te.timestamp,id:te.id,type:te.type,fromAdaptation:te.fromAdaptation,bandwidth:te.bandwidth});return{width:e,height:n,streamBandwidth:t,decodedFrames:o,droppedFrames:a,corruptedFrames:f,stallsDetected:c,gapsJumped:p,estimatedBandwidth:m,completionPercent:v,loadLatency:S,manifestTimeSeconds:C,drmTimeSeconds:T,playTime:I,pauseTime:_,bufferingTime:N,licenseTime:j,liveLatency:O,maxSegmentDuration:X,stateHistory:V,switchHistory:q}},s.Bg=function(e,t,n,o,a,l,f){f=f===void 0?!1:f;var c=this,p,m,v,S,C,T,I,_,N,j,O,X;return z(function(V){switch(V.g){case 1:if(c.l!=un&&c.l!=Cn)throw new K(1,7,7004);if(n!="subtitles"&&n!="captions"&&Le("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),o){V.B(2);break}return E(V,lh(c,e),3);case 3:o=V.h;case 2:if(p=[],c.A&&(p=c.A.getCuePoints()),c.l!=Cn){V.B(4);break}return f&&(n="forced"),E(V,im(c,e,t,n,o,l||"",p),5);case 5:if(m=ht(t),v=c.jc(),S=v.find(function(q){return ht(q.language)==m&&q.label==(l||"")&&q.kind==n}))return Ln(c),V.return(S);throw new K(1,2,2012);case 4:if(C=Gt,T=c.h.duration,c.i&&(T=c.i.presentationTimeline.getDuration()),T==1/0)throw new K(1,4,4033);if(!p.length){V.B(6);break}return E(V,uh(c,e,c.H,c.g.streaming.retryParameters),7);case 7:I=V.h,_=om(c,I,o,p),N=new Blob([_],{type:"text/vtt"}),e=kl(N),o="text/vtt";case 6:if(j={id:c.We++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:Uc(0,T,[e]),mimeType:o||"",codecs:a||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:l||null,type:C.na,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!f,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1},O=Rn(j.mimeType,j.codecs),X=Ya(O),!X)throw new K(2,2,2014,o);return c.i.textStreams.push(j),Ln(c),V.return(sl(j))}})},s.Cg=function(e,t){var n=this,o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O;return z(function(X){switch(X.g){case 1:if(n.l!=un&&n.l!=Cn)throw new K(1,7,7004);if(t){X.B(2);break}return E(X,lh(n,e),3);case 3:t=X.h;case 2:if(t!="text/vtt")throw new K(1,2,2017,e);if(o=Gt,a=n.h.duration,n.i&&(a=n.i.presentationTimeline.getDuration()),a==1/0)throw new K(1,4,4045);return E(X,uh(n,e,n.H,n.g.streaming.retryParameters),4);case 4:if(l=X.h,f=Kt[t],!f)throw new K(2,2,2014,t);for(c=f(),p={periodStart:0,segmentStart:0,segmentEnd:a,vttOffset:0},m=Ve(l),v=c.parseMedia(m,p,e),S=[],C={},T=w(v),I=T.next();!I.done;C={Dc:C.Dc,Hb:C.Hb},I=T.next())C.Hb=I.value,C.Dc=null,_=function(V){return function(){return V.Dc==null&&(V.Dc=on([e],[V.Hb.payload])),V.Dc||[]}}(C),N=new Xe(C.Hb.startTime,C.Hb.endTime,_,0,null,null,0,0,1/0),C.Hb.payload.includes("#xywh")&&(j=C.Hb.payload.split("#xywh=")[1].split(","),j.length===4&&N.pg({height:parseInt(j[3],10),positionX:parseInt(j[0],10),positionY:parseInt(j[1],10),width:parseInt(j[2],10)})),S.push(N);return O={id:n.We++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new ft(S),mimeType:t||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:o.he,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1},n.l==Cn?n.Oc.push(O):n.i.imageStreams.push(O),Ln(n),X.return(nc(O))}})},s.Ag=function(e,t,n){var o=this,a,l,f,c;return z(function(p){switch(p.g){case 1:if(o.l!=un&&o.l!=Cn)throw new K(1,7,7004);if(n){p.B(2);break}return E(p,lh(o,e),3);case 3:n=p.h;case 2:return a=[],o.A&&(a=o.A.getCuePoints()),E(p,im(o,e,t,"chapters",n,"",a),4);case 4:if(l=p.h,f=o.Pf(),c=f.find(function(m){return m.language==t}),!c){p.B(5);break}return E(p,new Promise(function(m,v){o.o.ja(l,"load",m),o.o.ja(l,"error",function(){v(new K(1,2,2015))})}),6);case 6:return Ln(o),p.return(c);case 5:throw new K(1,2,2012)}})};function lh(e,t){var n;return z(function(o){switch(o.g){case 1:return re(o,2),E(o,Gc(t,e.H,e.g.streaming.retryParameters),4);case 4:n=o.h,ie(o,3);break;case 2:se(o);case 3:if(n)return o.return(n);throw new K(1,2,2011,t)}})}function im(e,t,n,o,a,l,f){var c,p,m,v;return z(function(S){if(S.g==1)return a!="text/vtt"||f.length?E(S,uh(e,t,e.H,e.g.streaming.retryParameters),3):S.B(2);S.g!=2&&(c=S.h,p=om(e,c,a,f),m=new Blob([p],{type:"text/vtt"}),t=kl(m),a="text/vtt"),v=document.createElement("track");var C=e.V,T=t;try{if(C.g.enabled){var I=Kc(C);I.ot=qc,I.su=!0;var _=Pl(I),N=Yc(T,_)}else N=T}catch(j){it("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",j),N=T}return v.src=N,v.label=l,v.kind=o,v.srclang=n,e.h.getAttribute("crossorigin")||e.h.setAttribute("crossorigin","anonymous"),e.h.appendChild(v),S.return(v)})}function uh(e,t,n,o){var a,l,f;return z(function(c){if(c.g==1){a=Li,l=Yt([t],o),l.method="GET";var p=e.V;try{p.g.enabled&&kr(p,l,{ot:qc,su:!0})}catch(m){it("CMCD_TEXT_ERROR","Could not generate text CMCD data.",m)}return E(c,n.request(a,l).promise,2)}return f=c.h,c.return(f.data)})}function om(e,t,n,o){var a=Kt[n];if(a)return n=a(),e={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},t=Ve(t),t=n.parseMedia(t,e,null),sT(t,o);throw new K(2,2,2014,n)}s.pf=function(e,t){this.Id.width=e,this.Id.height=t},s.gf=function(e){if(this.l==un){var t=this.j;if(e=e===void 0?.1:e,t.l.g)t=!1;else if(t.s)t=!1;else{for(var n=w(t.i.values()),o=n.next();!o.done;o=n.next())o=o.value,!o.Tc||o.Da||o.ib||(o.Tc=!1,ci(t,o,e));t=!0}}else t=!1;return t},s.Yg=function(){return Le("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},s.Zg=function(){return this.Ld};function Lr(e){var t=Mr();return t.streaming.failureCallback=function(n){if(e.R()){var o=null;n.code==1001||n.code==1002?o=1:n.code==1003&&(o=.1),o!=null&&(n.severity=1,e.gf(o))}},t.textDisplayFactory=function(){return e.xd?new Xn(e.h,e.xd):HTMLMediaElement.prototype.addTextTrack?new Gn(e.h,"Shaka Player TextTrack"):new Wn},t}s.rg=function(e){this.xd=e};function OT(e,t){for(var n=new Set,o=w(t.textStreams),a=o.next();!a.done;a=o.next())a=a.value,a.mimeType!="application/cea-608"&&a.mimeType!="application/cea-708"||n.add(a.originalId);for(o=w(t.variants),a=o.next();!a.done;a=o.next())if((a=a.value.video)&&a.closedCaptions){for(var l=w(a.closedCaptions.keys()),f=l.next();!f.done;f=l.next())if(f=f.value,!n.has(f)){var c=f.startsWith("CC")?"application/cea-608":"application/cea-708",p=new jt,m=a.closedCaptions.get(f);c={id:e.We++,originalId:f,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:p,mimeType:c,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:m,originalLanguage:m,label:null,type:lt,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:a.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1},t.textStreams.push(c),n.add(f)}}}function rm(e,t){return z(function(n){if(n.g==1)return E(n,UT(e,t),2);sm(e,t),F(n)})}function UT(e,t){return z(function(n){if(n.g==1)return E(n,iw(e.m,t),2);if(!t.variants.some(al))throw new K(2,4,4032);F(n)})}function sm(e,t){if(e.l!=Ti){Gp(t.variants,e.g.restrictions,e.Id)&&e.j&&Ln(e);var n=e.m?e.m.g:null;if(n&&e.m.s)for(var o=w(t.variants),a=o.next();!a.done;a=o.next())a=a.value,fh(e,n.keySystem,a.video),fh(e,n.keySystem,a.audio);mm(e,t)}}function fh(e,t,n){if(n){n=w(n.drmInfos);for(var o=n.next();!o.done;o=n.next())if(o=o.value,o.keySystem==t){o=w(o.initData||[]);for(var a=o.next();!a.done;a=o.next())a=a.value,Ds(e.m,a.initDataType,a.initData)}}}function BT(e,t){var n,o,a,l,f;return z(function(c){return c.g==1?(n=e.audio,o=e.video,a=function(p,m){var v,S,C;return z(function(T){return T.g==1?p?E(T,p.createSegmentIndex(),2):T.return(null):(S=(v=p.segmentIndex.Nb(m))?v.next().value:null,S?(C=S.startTime,T.return(C)):T.return(null))})},E(c,a(n,t),2)):c.g!=3?(l=c.h,E(c,a(o,t),3)):(f=c.h,f!=null&&l!=null?c.return(Math.max(f,l)):f!=null?c.return(f):l!=null?c.return(l):c.return(t))})}function ch(e){var t=e.Ke();if(e.u&&e.K&&e.C){if(e.V){var n=e.V;t||n.i||(n.i=!0),n.i&&t&&(n.j=!0),n.l=t}jl(e)}t=new Map().set("buffering",t),e.dispatchEvent(Mt("buffering",t))}function am(e){var t=e.h.playbackRate;t!=0&&(e.I&&e.I.set(t),t=Mt("ratechange"),e.dispatchEvent(t))}function jl(e){if(e.u&&e.K){var t=e.u.g,n="playing";e.K.g==hr?n="buffering":e.h.paused?n="paused":e.h.ended&&(n="ended");var o=n;if(t.g==null)t.g={timestamp:Date.now()/1e3,state:o,duration:0},t=!0;else{var a=Date.now()/1e3;t.g.duration=a-t.g.timestamp,t.g.state==o?t=!1:(t.h.push(t.g),t.g={timestamp:a,state:o,duration:0},t=!0)}t&&(n=new Map().set("newstate",n),e.dispatchEvent(Mt("statechanged",n)))}}function lm(e){if(e.R()){var t=e.Eb();if(Number.isFinite(t.end)&&!(e.h.currentTime<t.start)){if(e.g.streaming.liveSync)var n=e.g.streaming.liveSyncMaxLatency,o=e.g.streaming.liveSyncPlaybackRate;else e.i&&e.i.serviceDescription&&(n=e.i.serviceDescription.maxLatency||e.g.streaming.liveSyncMaxLatency,o=e.i.serviceDescription.maxPlaybackRate||e.g.streaming.liveSyncPlaybackRate);if(e.g.streaming.liveSync)var a=e.g.streaming.liveSyncMinLatency,l=e.g.streaming.liveSyncMinPlaybackRate;else e.i&&e.i.serviceDescription&&(a=e.i.serviceDescription.minLatency||e.g.streaming.liveSyncMinLatency,l=e.i.serviceDescription.minPlaybackRate||e.g.streaming.liveSyncMinPlaybackRate);var f=e.h.playbackRate,c=t.end-e.h.currentTime,p=0;if(e.l==Cn){var m=e.h.buffered;0<m.length&&(p=m.end(m.length-1),p=Math.max(o,p-t.end))}n&&o&&c-p>n?f!=o&&e.xf(o):a&&l&&c-p<a?f!=l&&e.xf(l):f!==e.I.ec()&&e.ud()}}}function Fl(e){if(e.h){var t=!1,n=e.h.currentTime/e.h.duration;if(isNaN(n)||(n=Math.round(100*n),isNaN(e.N)?(e.N=n,t=!0):(n=Math.max(e.N,n),e.N!=n&&(e.N=n,t=!0))),t){var o;e.N==0?o=Mt("started"):e.N==25?o=Mt("firstquartile"):e.N==50?o=Mt("midpoint"):e.N==75?o=Mt("thirdquartile"):e.N==100&&(o=Mt("complete")),o&&e.dispatchEvent(o)}}}function Pr(e){try{mm(e,e.i)}catch(n){return Ho(e,n),!1}var t=rc(e.i.variants);return t=e.kb.create(t),e.s.setVariants(Array.from(t.values())),!0}function um(e,t){return t=t===void 0?!1:t,Pr(e)?e.s.chooseVariant(t):null}function jT(e){function t(f){var c="";return f.video&&(c+="video:"+f.video.id),f.audio&&(c=c+(c?"&":"")+("audio:"+f.audio.id)),c}for(var n=Date.now()/1e3,o=!1,a=w(e.i.variants),l=a.next();!l.done;l=a.next())l=l.value,0<l.disabledUntilTime&&l.disabledUntilTime<=n&&(l.disabledUntilTime=0,o=!0,""+t(l),void 0);e.i.variants.every(function(f){return f.disabledUntilTime===0})&&e.yd.stop(),o&&Dr(e,!0,void 0,!1,!1)}function Dr(e,t,n,o,a){t=t===void 0?!0:t,n=n===void 0?0:n,o=o===void 0?!1:o,a=a===void 0?!0:a;var l=um(e);l&&zl(e,l,a,t,n,o)}function zl(e,t,n,o,a,l){l=l===void 0?!1:l;var f=e.j.j;if(t==f)o&&Ig(e.j,t,o,a,!0);else{var c=e.u.h;c.h!=t&&(c.h=t,c.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),Ig(e.j,t,o,a,l,n),o=null,f&&(o=fr(f)),t=fr(t),n?(n=new Map().set("oldTrack",o).set("newTrack",t),e.J&&J0(e.J,t,e.He()),n=Mt("adaptation",n),Nr(e,n)):cm(e,o,t)}}function fm(e,t){var n=Array.from(e.h.audioTracks).find(function(o){return o.enabled});t.enabled=!0,t.id!==n.id&&(n.enabled=!1),n=oc(n),t=oc(t),cm(e,n,t)}function FT(e,t,n){if(e.g.autoShowText==0)return!1;if(e.g.autoShowText==1)return!0;var o=ht(e.g.preferredTextLanguage);return n=ht(n.language),e.g.autoShowText==2?qa(n,o):e.g.autoShowText==3?(e=ht(t.language),qa(n,o)&&!qa(e,n)):(Le("Invalid autoShowText setting!"),!1)}function Ln(e){var t=Mt("trackschanged");Nr(e,t)}function cm(e,t,n){t=new Map().set("oldTrack",t).set("newTrack",n),e.J&&J0(e.J,n,e.He()),n=Mt("variantchanged",t),Nr(e,n)}function Vl(e){var t=Mt("textchanged");Nr(e,t)}function hm(e){var t=Mt("texttrackvisibility");Nr(e,t)}function dm(e){e.g.abr.enabled||hh(e);var t=new Map().set("newStatus",e.g.abr.enabled);Nr(e,Mt("abrstatuschanged",t))}function hh(e,t){if(t=t===void 0?!0:t,e.l==un){e.yd.stop();for(var n=w(e.i.variants),o=n.next();!o.done;o=n.next())o.value.disabledUntilTime=0;t&&Pr(e)}}s.wd=function(e,t){if(!this.g.abr.enabled||this.l===Ti||!navigator.onLine)return!1;if(this.i.variants.some(function(l){return(l=l[e.type])&&l.id!==e.id?e.type=="audio"?e.language===l.language:!0:!1})){for(var n=w(this.i.variants),o=n.next();!o.done;o=n.next()){o=o.value;var a=o[e.type];a&&a.id===e.id&&(o.disabledUntilTime=Date.now()/1e3+t)}return this.yd.$a(1),t=this.pb().video.reduce(function(l,f){return l+f.end-f.start},0),Dr(this,!0,t,!0,!1),!0}return!1};function Ho(e,t){var n,o,a;return z(function(l){switch(l.g){case 1:if(e.l==Ti)return l.return();if(n=!0,!(e.mb&&e.i&&e.j)||t.code!=3016&&t.code!=3014&&t.code!=3015&&t.code!=3018){l.B(2);break}return re(l,3),E(l,JS(e.j),5);case 5:o=l.h,n=!o,ie(l,2);break;case 3:se(l),n=!0;case 2:if(!n)return l.return();t.severity===2&&hh(e,!1),a=Mt("error",new Map().set("detail",t)),e.dispatchEvent(a),a.defaultPrevented&&(t.handled=!0),F(l)}})}function Ks(e,t,n){n=new Map().set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}),e.dispatchEvent(Mt(t,n))}function dh(e){if(!e.h.error)return null;var t=e.h.error.code;if(t==1)return null;var n=e.h.error.msExtendedCode;return n&&(0>n&&(n+=Math.pow(2,32)),n=n.toString(16)),new K(2,3,3016,t,n,e.h.error.message)}function pm(e,t){if(e.j){var n=Mt("keystatuschanged");e.dispatchEvent(n);var o=Object.keys(t);n=o.length==1&&o[0]=="00";var a=!1;if(o.length){o=w(e.i.variants);for(var l=o.next();!l.done;l=o.next()){l=l.value;var f=[];l.audio&&f.push(l.audio),l.video&&f.push(l.video),f=w(f);for(var c=f.next();!c.done;c=f.next()){var p=c.value;if(c=l.allowedByKeySystem,p.keyIds.size){l.allowedByKeySystem=!0,p=w(p.keyIds);for(var m=p.next();!m.done;m=p.next())m=m.value,((m=t[n?"00":m])||e.m.F)&&(l.allowedByKeySystem=l.allowedByKeySystem&&!!m&&!wm.includes(m))}c!=l.allowedByKeySystem&&(a=!0)}}}if(a&&(Ln(e),!Pr(e)))return;(t=e.j.j)&&!t.allowedByKeySystem&&Dr(e)}}function gm(e,t,n){e.F&&e.F.onExpirationUpdated&&e.F.onExpirationUpdated(t,n),t=Mt("expirationupdated"),e.dispatchEvent(t)}function ph(e,t,n){0<t&&(e.R()||e.qg(t)),t=e.getDuration(),n<t&&(e.R()||e.Pa(n))}function mm(e,t){e=e.m?e.m.Bd():{};var n=Object.keys(e);n=n.length&&n[0]=="00";var o=!1,a=!1,l=new Set,f=new Set;t=w(t.variants);for(var c=t.next();!c.done;c=t.next()){c=c.value;var p=[];c.audio&&p.push(c.audio),c.video&&p.push(c.video),p=w(p);for(var m=p.next();!m.done;m=p.next())if(m=m.value,m.keyIds.size){m=w(m.keyIds);for(var v=m.next();!v.done;v=m.next()){v=v.value;var S=e[n?"00":v];S?wm.includes(S)&&f.add(S):l.add(v)}}c.allowedByApplication?c.allowedByKeySystem&&(o=!0):a=!0}if(!o)throw e={hasAppRestrictions:a,missingKeys:Array.from(l),restrictedKeyStatuses:Array.from(f)},new K(2,4,4012,e)}function Nr(e,t){z(function(n){if(n.g==1)return E(n,Promise.resolve(),2);e.l!=Ti&&e.dispatchEvent(t),F(n)})}function ym(e){var t=new Set;e=w(e);for(var n=e.next();!n.done;n=e.next())n=n.value,n.language?t.add(ht(n.language)):t.add("und");return t}function vm(e){var t=new Map,n=new Map;e=w(e);for(var o=e.next();!o.done;o=e.next()){o=o.value;var a="und",l=[];o.language&&(a=ht(o.language)),o.type=="variant"?l=o.audioRoles:l=o.roles,l&&l.length||(l=[""]),t.has(a)||t.set(a,new Set),l=w(l);for(var f=l.next();!f.done;f=l.next())f=f.value,t.get(a).add(f),o.label&&(n.has(a)||n.set(a,new Map),n.get(a).set(f,o.label))}var c=[];return t.forEach(function(p,m){p=w(p);for(var v=p.next();!v.done;v=p.next()){v=v.value;var S=null;n.has(m)&&n.get(m).has(v)&&(S=n.get(m).get(v)),c.push({language:m,role:v,label:S})}}),c}ae("shaka.Player",pe),pe.prototype.setVideoContainer=pe.prototype.rg,pe.prototype.getManifestParserFactory=pe.prototype.Zg,pe.prototype.getManifest=pe.prototype.Yg,pe.prototype.retryStreaming=pe.prototype.gf,pe.prototype.setMaxHardwareResolution=pe.prototype.pf,pe.prototype.addChaptersTrack=pe.prototype.Ag,pe.prototype.addThumbnailsTrack=pe.prototype.Cg,pe.prototype.addTextTrackAsync=pe.prototype.Bg,pe.prototype.getStats=pe.prototype.getStats,pe.prototype.getBufferedInfo=pe.prototype.pb,pe.prototype.getPresentationStartTimeAsDate=pe.prototype.Sf,pe.prototype.getPlayheadTimeAsDate=pe.prototype.dh,pe.prototype.setTextTrackVisibility=pe.prototype.og,pe.prototype.getChapters=pe.prototype.Rg,pe.prototype.getChaptersTracks=pe.prototype.Pf,pe.prototype.isTextTrackVisible=pe.prototype.Me,pe.prototype.selectVariantsByLabel=pe.prototype.Wh,pe.prototype.selectTextLanguage=pe.prototype.kf,pe.prototype.selectAudioLanguage=pe.prototype.jg,pe.prototype.getTextLanguages=pe.prototype.hh,pe.prototype.getAudioLanguages=pe.prototype.Og,pe.prototype.getTextLanguagesAndRoles=pe.prototype.ih,pe.prototype.getAudioLanguagesAndRoles=pe.prototype.Pg,pe.prototype.selectVariantTrack=pe.prototype.lf,pe.prototype.selectTextTrack=pe.prototype.kg,pe.prototype.getThumbnails=pe.prototype.Tf,pe.prototype.getAllThumbnails=pe.prototype.Ng,pe.prototype.getImageTracks=pe.prototype.Wg,pe.prototype.getTextTracks=pe.prototype.jc,pe.prototype.getVariantTracks=pe.prototype.Cb,pe.prototype.cancelTrickPlay=pe.prototype.ud,pe.prototype.trickPlay=pe.prototype.xf,pe.prototype.getPlaybackRate=pe.prototype.Cd,pe.prototype.isBuffering=pe.prototype.Ke,pe.prototype.getKeyStatuses=pe.prototype.Bd,pe.prototype.getActiveSessionsMetadata=pe.prototype.Fe,pe.prototype.getExpiration=pe.prototype.Qc,pe.prototype.drmInfo=pe.prototype.drmInfo,pe.prototype.keySystem=pe.prototype.keySystem,pe.prototype.goToLive=pe.prototype.ph,pe.prototype.seekRange=pe.prototype.Eb,pe.prototype.isAudioOnly=pe.prototype.sh,pe.prototype.isInProgress=pe.prototype.Rb,pe.prototype.isLive=pe.prototype.R,pe.prototype.getAdManager=pe.prototype.Of,pe.prototype.getAssetUri=pe.prototype.Ge,pe.prototype.getNetworkingEngine=pe.prototype.Ob,pe.prototype.getMediaElement=pe.prototype.ah,pe.prototype.getManifestType=pe.prototype.He,pe.prototype.getLoadMode=pe.prototype.Xg,pe.prototype.resetConfiguration=pe.prototype.Qh,pe.prototype.getBufferFullness=pe.prototype.Qg,pe.prototype.getConfiguration=pe.prototype.getConfiguration,pe.prototype.configure=pe.prototype.configure,pe.prototype.releaseAllMutexes=pe.prototype.Mh,pe.prototype.load=pe.prototype.load,pe.prototype.updateStartTime=pe.prototype.ei,pe.prototype.unload=pe.prototype.rc,pe.prototype.detach=pe.prototype.detach,pe.prototype.attachCanvas=pe.prototype.Eg,pe.prototype.attach=pe.prototype.Ic,pe.probeSupport=function(e){e=e===void 0?!0:e;var t,n,o,a,l,f;return z(function(c){if(c.g==1)return t={},e?E(c,Gw(),3):c.B(2);c.g!=2&&(t=c.h);var p={};if(wi())for(var m in fi)p[m]=!0;m=w(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var v=m.next();!v.done;v=m.next())v=v.value,p[v]=wi()?!!fi[v]:ks(v);for(n=p,m='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(R(rr)),p={},m=w(m),v=m.next();!v.done;v=m.next()){v=v.value,p[v]=wi()?Ya(v)?!0:ve(v)||!!_o(v):ks(v);var S=v.split(";")[0];p[S]=p[S]||p[v]}o=p,a={manifest:n,media:o,drm:t},l=mh;for(f in l)a[f]=l[f]();return c.return(a)})},pe.isBrowserSupported=function(){if(d.Promise||Le("A Promise implementation or polyfill is required"),!(d.Promise&&d.Uint8Array&&Array.prototype.forEach)||Rt("Trident/"))return!1;var e=nl();return e&&9>e||!(d.MediaKeys&&d.navigator&&d.navigator.requestMediaKeySystemAccess&&d.MediaKeySystemAccess&&d.MediaKeySystemAccess.prototype.getConfiguration)?!1:wi()?!0:ks("application/x-mpegurl")},pe.setAdManagerFactory=function(e){Hl=e},pe.registerSupportPlugin=function(e,t){mh[e]=t},pe.prototype.destroy=pe.prototype.destroy;var Ti=0,gh=1,un=2,Cn=3;pe.LoadMode={DESTROYED:Ti,NOT_LOADED:gh,MEDIA_SOURCE:un,SRC_EQUALS:Cn},pe.version="v4.7.11";var xm=["4","7"];n0=new function(e){this.g=e,this.i=dw,this.h=pw}(new lc(Number(xm[0]),Number(xm[1])));var wm=["output-restricted","internal-error"],mh={},Hl=null;function Sm(){this.h=[],this.j=this.i=this.g=0}function qe(e,t,n){var o=this;this.g=e,this.h=t,this.j=n,this.i=!1,this.l=this.h.getVolume(),this.m=new Ct,this.m.D(this.h,google.ima.AdEvent.Type.PAUSED,function(){o.i=!0}),this.m.D(this.h,google.ima.AdEvent.Type.RESUMED,function(){o.i=!1})}s=qe.prototype,s.getDuration=function(){return this.g.getDuration()},s.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},s.getRemainingTime=function(){return this.h.getRemainingTime()},s.isPaused=function(){return this.i},s.isSkippable=function(){return 0<=this.g.getSkipTimeOffset()},s.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},s.canSkipNow=function(){return this.h.getAdSkippableState()},s.skip=function(){return this.h.skip()},s.pause=function(){return this.h.pause()},s.play=function(){return this.h.resume()},s.getVolume=function(){return this.h.getVolume()},s.setVolume=function(e){return this.j.volume=e,this.h.setVolume(e)},s.isMuted=function(){return this.h.getVolume()==0},s.isLinear=function(){return this.g.isLinear()},s.resize=function(e,t){var n=!1,o=this.j;document.fullscreenEnabled?n=!!document.fullscreenElement:o.webkitSupportsFullscreen&&(n=o.webkitDisplayingFullscreen),this.h.resize(e,t,n?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},s.setMuted=function(e){(this.j.muted=e)?(this.l=this.getVolume(),this.h.setVolume(0)):this.h.setVolume(this.l)},s.getSequenceLength=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getTotalAds()},s.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getAdPosition()},s.getTitle=function(){return this.g.getTitle()},s.getDescription=function(){return this.g.getDescription()},s.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},s.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},s.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},s.getAdId=function(){return this.g.getAdId()},s.getCreativeAdId=function(){return this.g.getCreativeAdId()},s.getAdvertiserName=function(){return this.g.getAdvertiserName()},s.getMediaUrl=function(){return this.g.getMediaUrl()},s.getTimeOffset=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getTimeOffset()},s.getPodIndex=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getPodIndex()},s.release=function(){this.h=this.g=null},ae("shaka.ads.ClientSideAd",qe),qe.prototype.release=qe.prototype.release,qe.prototype.getPodIndex=qe.prototype.getPodIndex,qe.prototype.getTimeOffset=qe.prototype.getTimeOffset,qe.prototype.getMediaUrl=qe.prototype.getMediaUrl,qe.prototype.getAdvertiserName=qe.prototype.getAdvertiserName,qe.prototype.getCreativeAdId=qe.prototype.getCreativeAdId,qe.prototype.getAdId=qe.prototype.getAdId,qe.prototype.getVastMediaWidth=qe.prototype.getVastMediaWidth,qe.prototype.getVastMediaHeight=qe.prototype.getVastMediaHeight,qe.prototype.getVastMediaBitrate=qe.prototype.getVastMediaBitrate,qe.prototype.getDescription=qe.prototype.getDescription,qe.prototype.getTitle=qe.prototype.getTitle,qe.prototype.getPositionInSequence=qe.prototype.getPositionInSequence,qe.prototype.getSequenceLength=qe.prototype.getSequenceLength,qe.prototype.setMuted=qe.prototype.setMuted,qe.prototype.resize=qe.prototype.resize,qe.prototype.isLinear=qe.prototype.isLinear,qe.prototype.isMuted=qe.prototype.isMuted,qe.prototype.setVolume=qe.prototype.setVolume,qe.prototype.getVolume=qe.prototype.getVolume,qe.prototype.play=qe.prototype.play,qe.prototype.pause=qe.prototype.pause,qe.prototype.skip=qe.prototype.skip,qe.prototype.canSkipNow=qe.prototype.canSkipNow,qe.prototype.getTimeUntilSkippable=qe.prototype.getTimeUntilSkippable,qe.prototype.isSkippable=qe.prototype.isSkippable,qe.prototype.isPaused=qe.prototype.isPaused,qe.prototype.getRemainingTime=qe.prototype.getRemainingTime,qe.prototype.getMinSuggestedDuration=qe.prototype.getMinSuggestedDuration,qe.prototype.getDuration=qe.prototype.getDuration;function $l(e,t,n,o,a){var l=this;this.o=e,this.i=t,this.A=!1,this.s=this.C=null,this.F=NaN,this.m=a,this.j=null,this.h=new Ct,google.ima.settings.setLocale(n),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),e=new google.ima.AdDisplayContainer(this.o,this.i),e.initialize(),this.l=new google.ima.AdsLoader(e),this.l.getSettings().setPlayerType("shaka-player"),this.l.getSettings().setPlayerVersion("v4.7.11"),this.g=null,this.u=o||new google.ima.AdsRenderingSettings,this.h.D(this.l,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(f){zT(l,f)}),this.h.D(this.l,google.ima.AdErrorEvent.Type.AD_ERROR,function(f){Tm(l,f)}),this.h.D(this.i,"ended",function(){l.l.contentComplete()}),this.h.ja(this.i,"play",function(){l.A=!0})}$l.prototype.configure=function(e){this.C=e},$l.prototype.stop=function(){this.g&&this.g.stop(),this.o&&$s(this.o)},$l.prototype.release=function(){this.stop(),this.s&&this.s.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.l.destroy()};function Tm(e,t){t.getError(),t=new Map().set("originalEvent",t),e.m(new We("ad-error",t)),Wl(e,null),e.m(new We("ad-cue-points-changed",new Map().set("cuepoints",[])))}function zT(e,t){if(e.m(new We("ads-loaded",new Map().set("loadTime",Date.now()/1e3-e.F))),e.C.customPlayheadTracker){var n={currentTime:e.i.currentTime};e.g=t.getAdsManager(n,e.u),e.i.muted?e.g.setVolume(0):e.g.setVolume(e.i.volume),e.h.D(e.i,"timeupdate",function(){e.i.duration&&(n.currentTime=e.i.currentTime)}),e.h.D(e.i,"volumechange",function(){e.j&&(e.j.setVolume(e.i.volume),e.i.muted&&e.j.setMuted(!0))})}else e.g=t.getAdsManager(e.i,e.u);e.m(new We("ima-ad-manager-loaded",new Map().set("imaAdManager",e.g)));var o=e.g.getCuePoints();if(o.length){t=[],o=w(o);for(var a=o.next();!a.done;a=o.next())t.push({start:a.value,end:null});e.m(new We("ad-cue-points-changed",new Map().set("cuepoints",t)))}VT(e);try{e.g.init(e.i.offsetWidth,e.i.offsetHeight,Gl(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),e.h.D(e.i,"loadeddata",function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight,Gl(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),"ResizeObserver"in d?(e.s=new ResizeObserver(function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight,Gl(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),e.s.observe(e.i)):e.h.D(document,"fullscreenchange",function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight,Gl(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),e.A?e.g.start():e.h.ja(e.i,"play",function(){e.A=!0,e.g.start()})}catch{Wl(e,null)}}function Gl(e){return document.fullscreenEnabled?!!document.fullscreenElement:(e=e.i,e.webkitSupportsFullscreen?e.webkitDisplayingFullscreen:!1)}function VT(e){function t(n,o){n=new Map().set("originalEvent",n),e.m(new We(o,n))}e.h.D(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,function(n){Tm(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(n){Cm(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.STARTED,function(n){Cm(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,function(n){t(n,"ad-first-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.MIDPOINT,function(n){t(n,"ad-midpoint")}),e.h.D(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,function(n){t(n,"ad-third-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.COMPLETE,function(n){t(n,"ad-complete")}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(n){Wl(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(n){Wl(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPED,function(n){t(n,"ad-skipped")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,function(n){t(n,"ad-volume-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,function(n){t(n,"ad-muted")}),e.h.D(e.g,google.ima.AdEvent.Type.PAUSED,function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))}),e.h.D(e.g,google.ima.AdEvent.Type.RESUMED,function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,function(n){e.j&&t(n,"ad-skip-state-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.CLICK,function(n){t(n,"ad-clicked")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_PROGRESS,function(n){t(n,"ad-progress")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BUFFERING,function(n){t(n,"ad-buffering")}),e.h.D(e.g,google.ima.AdEvent.Type.IMPRESSION,function(n){t(n,"ad-impression")}),e.h.D(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,function(n){t(n,"ad-duration-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.USER_CLOSE,function(n){t(n,"ad-closed")}),e.h.D(e.g,google.ima.AdEvent.Type.LOADED,function(n){t(n,"ad-loaded")}),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(n){t(n,"all-ads-completed")}),e.h.D(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,function(n){t(n,"ad-linear-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_METADATA,function(n){t(n,"ad-metadata")}),e.h.D(e.g,google.ima.AdEvent.Type.LOG,function(n){t(n,"ad-recoverable-error")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,function(n){t(n,"ad-break-ready")}),e.h.D(e.g,google.ima.AdEvent.Type.INTERACTION,function(n){t(n,"ad-interaction")})}function Cm(e,t){var n=t.getAd();n?(e.j=new qe(n,e.g,e.i),t=new Map().set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.m(new We("ad-started",t)),e.j.isLinear()&&(e.o.setAttribute("ad-active","true"),e.i.pause(),e.i.muted?(t=e.j,t.l=e.i.volume,t.h.setVolume(0)):e.j.setVolume(e.i.volume))):Le("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function Wl(e,t){e.m(new We("ad-stopped",new Map().set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.o.removeAttribute("ad-active"),e.i.ended||e.i.play())}function Ke(e,t,n,o,a){this.h=e,this.g=a,this.i=t,this.j=n,this.l=o}s=Ke.prototype,s.getDuration=function(){return this.h.durationInSeconds},s.getMinSuggestedDuration=function(){return this.getDuration()},s.getRemainingTime=function(){return this.h.startTimeInSeconds+this.h.durationInSeconds-this.g.currentTime},s.isPaused=function(){return this.g.paused},s.isSkippable=function(){return!!this.h.skipOffset},s.getTimeUntilSkippable=function(){if(!this.h.skipOffset)return this.getRemainingTime();var e=this.getRemainingTime()-this.h.skipOffset;return Math.max(e,0)},s.canSkipNow=function(){return this.getTimeUntilSkippable()==0},s.skip=function(){this.g.currentTime+=this.getRemainingTime()},s.pause=function(){return this.g.pause()},s.play=function(){return this.g.play()},s.getVolume=function(){return this.g.volume},s.setVolume=function(e){this.g.volume=e},s.isMuted=function(){return this.g.muted},s.isLinear=function(){return this.l},s.resize=function(){},s.setMuted=function(e){this.g.muted=e},s.getSequenceLength=function(){return this.j?this.j:1},s.getPositionInSequence=function(){return this.i?this.i:1},s.getTitle=function(){return this.h.adTitle},s.getDescription=function(){return""},s.getVastMediaBitrate=function(){return 0},s.getVastMediaHeight=function(){return 0},s.getVastMediaWidth=function(){return 0},s.getAdId=function(){return this.h.adId},s.getCreativeAdId=function(){return this.h.creativeId},s.getAdvertiserName=function(){return""},s.getMediaUrl=function(){return null},s.getTimeOffset=function(){return 0},s.getPodIndex=function(){return 0},s.release=function(){this.j=this.i=this.g=this.h=null},ae("shaka.ads.MediaTailorAd",Ke),Ke.prototype.release=Ke.prototype.release,Ke.prototype.getPodIndex=Ke.prototype.getPodIndex,Ke.prototype.getTimeOffset=Ke.prototype.getTimeOffset,Ke.prototype.getMediaUrl=Ke.prototype.getMediaUrl,Ke.prototype.getAdvertiserName=Ke.prototype.getAdvertiserName,Ke.prototype.getCreativeAdId=Ke.prototype.getCreativeAdId,Ke.prototype.getAdId=Ke.prototype.getAdId,Ke.prototype.getVastMediaWidth=Ke.prototype.getVastMediaWidth,Ke.prototype.getVastMediaHeight=Ke.prototype.getVastMediaHeight,Ke.prototype.getVastMediaBitrate=Ke.prototype.getVastMediaBitrate,Ke.prototype.getDescription=Ke.prototype.getDescription,Ke.prototype.getTitle=Ke.prototype.getTitle,Ke.prototype.getPositionInSequence=Ke.prototype.getPositionInSequence,Ke.prototype.getSequenceLength=Ke.prototype.getSequenceLength,Ke.prototype.setMuted=Ke.prototype.setMuted,Ke.prototype.resize=Ke.prototype.resize,Ke.prototype.isLinear=Ke.prototype.isLinear,Ke.prototype.isMuted=Ke.prototype.isMuted,Ke.prototype.setVolume=Ke.prototype.setVolume,Ke.prototype.getVolume=Ke.prototype.getVolume,Ke.prototype.play=Ke.prototype.play,Ke.prototype.pause=Ke.prototype.pause,Ke.prototype.skip=Ke.prototype.skip,Ke.prototype.canSkipNow=Ke.prototype.canSkipNow,Ke.prototype.getTimeUntilSkippable=Ke.prototype.getTimeUntilSkippable,Ke.prototype.isSkippable=Ke.prototype.isSkippable,Ke.prototype.isPaused=Ke.prototype.isPaused,Ke.prototype.getRemainingTime=Ke.prototype.getRemainingTime,Ke.prototype.getMinSuggestedDuration=Ke.prototype.getMinSuggestedDuration,Ke.prototype.getDuration=Ke.prototype.getDuration;function Ys(e,t,n,o){this.A=e,this.I=t,this.g=n,this.l=null,this.W=NaN,this.i=o,this.H=!1,this.u=null,this.j=[],this.K=[],this.J=this.C=this.h=null,this.F=new Map,this.m=[],this.s=[],this.N="",this.V=!0,this.G="",this.o=new Ct}Ys.prototype.stop=function(){for(var e=w(this.m),t=e.next();!t.done;t=e.next())t=t.value,this.o.Vb(t.target,t.type,t.listener);Or(this),this.m=[],this.s=[],this.N="",this.V=!0,this.G="",this.u=null,this.j=[],this.K=[],this.F.clear()},Ys.prototype.release=function(){this.stop(),this.o&&this.o.release()},Ys.prototype.onManifestUpdated=function(e){this.H=e,this.N!=""&&($T(this,this.N,this.V),this.V=!1)},Ys.prototype.getCuePoints=function(){for(var e=[],t=w(this.j),n=t.next();!n.done;n=t.next()){n=w(n.value.ads);for(var o=n.next();!o.done;o=n.next())o=o.value,e.push({start:o.startTimeInSeconds,end:o.startTimeInSeconds+o.durationInSeconds})}return e};function HT(e,t,n){var o,a,l,f,c,p,m,v,S,C,T;z(function(I){if(I.g==1)return o=Yt([t],Ri()),o.method="POST",n&&(a=JSON.stringify(n),o.body=Hi(a)),l=e.I.request(7,o),re(I,2),E(I,l.promise,4);if(I.g!=2){if(f=I.h,c=It(f.data),p=JSON.parse(c),p.manifestUrl&&p.trackingUrl)m=new Bt(t),v=new Bt(p.trackingUrl),e.N=m.resolve(v).toString(),S=Date.now()/1e3,C=S-e.W,e.i(new We("ads-loaded",new Map().set("loadTime",C))),T=new Bt(p.manifestUrl),e.l.resolve(m.resolve(T).toString()),e.l=null;else throw Error("Insufficient data from MediaTailor.");return ie(I,0)}if(se(I),!e.G.length)return e.l.reject("MediaTailor request returned an error and there was no backup asset uri provided."),e.l=null,I.return();e.l.resolve(e.G),e.l=null,F(I)})}function $T(e,t,n){var o,a,l,f,c,p,m,v,S,C,T,I,_,N,j;z(function(O){if(O.g==1)return o=Yt([t],Ri()),a=e.I.request(7,o),re(O,2),E(O,a.promise,4);if(O.g!=2){if(l=O.h,f=[],c=It(l.data),p=JSON.parse(c),0<p.avails.length){if(JSON.stringify(e.j)!=JSON.stringify(p.avails)){for(e.j=p.avails,m=w(e.j),v=m.next();!v.done;v=m.next())for(S=v.value,C=w(S.nonLinearAdsList),T=C.next();!T.done;T=C.next())for(I=T.value,_=w(I.nonLinearAdList),N=_.next();!N.done;N=_.next())j=N.value,GT(e,j);f=e.getCuePoints(),e.i(new We("ad-cue-points-changed",new Map().set("cuepoints",f)))}}else e.j.length&&e.i(new We("ad-cue-points-changed",new Map().set("cuepoints",f))),Or(e),e.j=[];return n&&(e.H||0<f.length)&&WT(e),ie(O,0)}se(O),F(O)})}function GT(e,t){var n,o,a,l,f,c,p;z(function(m){if(m.g==1)return!t.staticResource||(n=Em(t),e.F.get(n))?m.return():(o=Yt([t.staticResource],Ri()),a=e.I.request(7,o),re(m,2),e.F.set(n,[]),E(m,a.promise,4));if(m.g!=2)return l=m.h,f=It(l.data),c=JSON.parse(f),p=c.apps,e.F.set(n,p),ie(m,0);se(m),e.F.delete(n),F(m)})}function Em(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")}function WT(e){bm(e),e.H||(Am(e),e.o.D(e.g,"seeked",function(){Am(e)}),e.o.D(e.g,"ended",function(){Or(e)})),e.o.D(e.g,"timeupdate",function(){bm(e)})}function Am(e){var t=e.g.currentTime;if(t!=0&&e.u==null){for(var n,o,a=w(e.j),l=a.next();!l.done;l=a.next()){l=l.value;for(var f=w(l.ads),c=f.next();!c.done;c=f.next())if(c=c.value,!o)c.startTimeInSeconds<t&&(o=c,n=l);else if(c.startTimeInSeconds<t&&c.startTimeInSeconds>o.startTimeInSeconds+o.durationInSeconds){o=c,n=l;break}}n&&o&&!e.K.includes(o.adId)&&(e.u=t,e.g.currentTime=n.startTimeInSeconds)}}function bm(e){if(e.g.duration&&(e.h||e.j.length)){var t=e.g.currentTime,n=!1;if(e.h){n=!0;var o=e.C,a=o.startTimeInSeconds+.5*o.durationInSeconds,l=o.startTimeInSeconds+.75*o.durationInSeconds;t>=o.startTimeInSeconds+.25*o.durationInSeconds&&!e.s.includes("firstQuartile")?(e.s.push("firstQuartile"),En(e,"firstQuartile")):t>=a&&!e.s.includes("midpoint")?(e.s.push("midpoint"),En(e,"midpoint")):t>=l&&!e.s.includes("thirdQuartile")&&(e.s.push("thirdQuartile"),En(e,"thirdQuartile")),o=e.h.getRemainingTime(),a=e.h.getDuration(),0<a&&(0>=o||o>a)&&Or(e)}if(!e.h||!e.h.isLinear()){e:for(o=w(e.j),a=o.next();!a.done&&(a=a.value,!(e.h&&e.h.isLinear()));a=o.next())for(l=0;l<a.ads.length;l++){var f=a.ads[l],c=f.startTimeInSeconds+f.durationInSeconds;if(f.startTimeInSeconds<=t&&c>t){if(e.K.includes(f.adId)){if(e.g.ended)continue;e.g.currentTime=c;break e}Or(e),e.J=a,e.h=new Ke(f,l+1,a.ads.length,!0,e.g),e.C=f,l===0&&En(e,"breakStart"),Im(e);break}}if(!e.h){for(o=w(e.j),a=o.next();!a.done&&(a=a.value,!e.h);a=o.next())for(l=0;l<a.nonLinearAdsList.length;l++)if(f=a.nonLinearAdsList[l],f.nonLinearAdList.length){c=a.startTimeInSeconds;var p=e.F.get(Em(f.nonLinearAdList[0]));if(c<=t&&p&&p.length){Or(e),c=e,p=w(p);for(var m=p.next();!m.done;m=p.next())if(m=m.value,m.data.source.length){var v=document.createElement("img");v.src=m.data.source[0].url,v.style.top=(m.placeholder.top||0)+"%",v.style.height=100-(m.placeholder.top||0)+"%",v.style.left=(m.placeholder.left||0)+"%",v.style.maxWidth=100-(m.placeholder.left||0)+"%",v.style.objectFit="contain",v.style.position="absolute",c.A.appendChild(v)}e.J=a,e.h=new Ke(f,l+1,a.ads.length,!1,e.g),e.C=f,l===0&&En(e,"breakStart"),Im(e);break}}}n&&!e.h&&(t=e.g.currentTime,e.u&&e.u>t&&(e.g.currentTime=e.u),e.u=null)}}}function Or(e){if(e.h){for(;e.A.lastChild;)e.A.removeChild(e.A.firstChild);e.H||e.K.push(e.C.adId),En(e,"complete");for(var t=w(e.m),n=t.next();!n.done;n=t.next())n=n.value,e.o.Vb(n.target,n.type,n.listener);e.m=[],e.s=[],t=e.h.getPositionInSequence(),n=e.h.getSequenceLength(),t===n&&En(e,"breakEnd"),e.h=null,e.C=null,e.J=null}}function Im(e){var t=!1;e.g.paused?t=!0:(En(e,"impression"),En(e,"start")),e.m.push({target:e.g,type:"volumechange",listener:function(){e.g.muted&&En(e,"mute")}}),e.m.push({target:e.g,type:"volumechange",listener:function(){e.g.muted||En(e,"unmute")}}),e.m.push({target:e.g,type:"play",listener:function(){t?(En(e,"impression"),En(e,"start"),t=!1):En(e,"resume")}}),e.m.push({target:e.g,type:"pause",listener:function(){En(e,"pause")}});for(var n=w(e.m),o=n.next();!o.done;o=n.next())o=o.value,e.o.D(o.target,o.type,o.listener)}function En(e,t){var n=e.C.trackingEvents.find(function(a){return a.eventType==t});if(n||(n=e.J.adBreakTrackingEvents.find(function(a){return a.eventType==t})),n){n=w(n.beaconUrls);for(var o=n.next();!o.done;o=n.next())(o=o.value)&&o!=""&&(o=Yt([o],Ri()),o.method="POST",e.I.request(7,o))}switch(t){case"impression":e.i(new We("ad-impression"));break;case"start":e.i(new We("ad-started",new Map().set("ad",e.h)));break;case"mute":e.i(new We("ad-muted"));break;case"unmute":e.i(new We("ad-volume-changed"));break;case"resume":e.i(new We("ad-resumed"));break;case"pause":e.i(new We("ad-paused"));break;case"firstQuartile":e.i(new We("ad-first-quartile"));break;case"midpoint":e.i(new We("ad-midpoint"));break;case"thirdQuartile":e.i(new We("ad-third-quartile"));break;case"complete":e.i(new We("ad-complete")),e.i(new We("ad-stopped"));break;case"breakStart":e.A.setAttribute("ad-active","true");break;case"breakEnd":e.A.removeAttribute("ad-active")}}function Qe(e,t){this.g=e,this.i=null,this.h=t}s=Qe.prototype,s.getDuration=function(){return this.i?this.i.duration:-1},s.getMinSuggestedDuration=function(){return this.getDuration()},s.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},s.isPaused=function(){return this.h.paused},s.isSkippable=function(){return this.g.isSkippable()},s.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},s.canSkipNow=function(){return this.getTimeUntilSkippable()==0},s.skip=function(){this.h.currentTime+=this.getRemainingTime()},s.pause=function(){return this.h.pause()},s.play=function(){return this.h.play()},s.getVolume=function(){return this.h.volume},s.setVolume=function(e){this.h.volume=e},s.isMuted=function(){return this.h.muted},s.isLinear=function(){return!0},s.resize=function(){},s.setMuted=function(e){this.h.muted=e},s.getSequenceLength=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getTotalAds()},s.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getAdPosition()},s.getTitle=function(){return this.g.getTitle()},s.getDescription=function(){return this.g.getDescription()},s.getVastMediaBitrate=function(){return 0},s.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},s.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},s.getAdId=function(){return this.g.getAdId()},s.getCreativeAdId=function(){return this.g.getCreativeAdId()},s.getAdvertiserName=function(){return this.g.getAdvertiserName()},s.getMediaUrl=function(){return null},s.getTimeOffset=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getTimeOffset()},s.getPodIndex=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getPodIndex()},s.release=function(){this.h=this.i=this.g=null},ae("shaka.ads.ServerSideAd",Qe),Qe.prototype.release=Qe.prototype.release,Qe.prototype.getPodIndex=Qe.prototype.getPodIndex,Qe.prototype.getTimeOffset=Qe.prototype.getTimeOffset,Qe.prototype.getMediaUrl=Qe.prototype.getMediaUrl,Qe.prototype.getAdvertiserName=Qe.prototype.getAdvertiserName,Qe.prototype.getCreativeAdId=Qe.prototype.getCreativeAdId,Qe.prototype.getAdId=Qe.prototype.getAdId,Qe.prototype.getVastMediaWidth=Qe.prototype.getVastMediaWidth,Qe.prototype.getVastMediaHeight=Qe.prototype.getVastMediaHeight,Qe.prototype.getVastMediaBitrate=Qe.prototype.getVastMediaBitrate,Qe.prototype.getDescription=Qe.prototype.getDescription,Qe.prototype.getTitle=Qe.prototype.getTitle,Qe.prototype.getPositionInSequence=Qe.prototype.getPositionInSequence,Qe.prototype.getSequenceLength=Qe.prototype.getSequenceLength,Qe.prototype.setMuted=Qe.prototype.setMuted,Qe.prototype.resize=Qe.prototype.resize,Qe.prototype.isLinear=Qe.prototype.isLinear,Qe.prototype.isMuted=Qe.prototype.isMuted,Qe.prototype.setVolume=Qe.prototype.setVolume,Qe.prototype.getVolume=Qe.prototype.getVolume,Qe.prototype.play=Qe.prototype.play,Qe.prototype.pause=Qe.prototype.pause,Qe.prototype.skip=Qe.prototype.skip,Qe.prototype.canSkipNow=Qe.prototype.canSkipNow,Qe.prototype.getTimeUntilSkippable=Qe.prototype.getTimeUntilSkippable,Qe.prototype.isSkippable=Qe.prototype.isSkippable,Qe.prototype.isPaused=Qe.prototype.isPaused,Qe.prototype.getRemainingTime=Qe.prototype.getRemainingTime,Qe.prototype.getMinSuggestedDuration=Qe.prototype.getMinSuggestedDuration,Qe.prototype.getDuration=Qe.prototype.getDuration;function km(e,t,n,o){var a=this;this.s=e,this.l=t,this.j=null,this.F=NaN,this.i=o,this.G=!1,this.u=this.m=this.o=null,this.A="",this.C=[],this.h=new Ct,e=new google.ima.dai.api.UiSettings,e.setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.s,e),this.i(new We("ima-stream-manager-loaded",new Map().set("imaStreamManager",this.g))),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,function(l){XT(a,l)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,function(){a.A.length?a.j.resolve(a.A):a.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),a.j=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,function(){}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,function(l){l=l.getAd(),a.m=new Qe(l,a.l),a.u&&(a.m.i=a.u),a.i(new We("ad-started",new Map().set("ad",a.m))),a.s.setAttribute("ad-active","true")}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,function(){a.s.removeAttribute("ad-active");var l=a.l.currentTime;a.o&&a.o>l&&(a.l.currentTime=a.o,a.o=null)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,function(l){a.u=l.getStreamData().adProgressData,a.m&&(a.m.i=a.u)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,function(){a.i(new We("ad-first-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,function(){a.i(new We("ad-midpoint"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,function(){a.i(new We("ad-third-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,function(){a.i(new We("ad-complete")),a.i(new We("ad-stopped")),a.s.removeAttribute("ad-active"),a.m=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,function(){a.i(new We("ad-skipped")),a.i(new We("ad-stopped"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,function(l){var f=l.getStreamData();l=[],f=w(f.cuepoints);for(var c=f.next();!c.done;c=f.next())c=c.value,l.push({start:c.start,end:c.end});a.C=l,a.i(new We("ad-cue-points-changed",new Map().set("cuepoints",l)))})}s=km.prototype,s.configure=function(){},s.stop=function(){this.A="",this.o=null,this.C=[]},s.release=function(){this.stop(),this.h&&this.h.release()},s.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},s.getCuePoints=function(){return this.C};function XT(e,t){e.i(new We("ads-loaded",new Map().set("loadTime",Date.now()/1e3-e.F))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.G||e.h.D(e.l,"seeked",function(){var n=e.l.currentTime;if(n!=0){e.g.streamTimeForContentTime(n);var o=e.g.previousCuePointForStreamTime(n);o&&!o.played&&(e.o=n,e.l.currentTime=o.start)}})}function $e(){dt.call(this),this.g=this.i=this.h=null,this.j=new Sm,this.m=navigator.language,this.l=null}Z($e,dt),s=$e.prototype,s.setLocale=function(e){this.m=e},s.configure=function(e){this.l=e,this.h&&this.h.configure(this.l),this.g&&this.g.configure(this.l)},s.initClientSide=function(e,t,n){var o=this;if(!d.google||!google.ima||!google.ima.AdsLoader)throw new K(2,10,1e4);this.h&&this.h.release(),this.h=new $l(e,t,this.m,n,function(a){return yh(o,a)}),this.h.configure(this.l)},s.release=function(){this.h&&(this.h.release(),this.h=null),this.i&&(this.i.release(),this.i=null),this.g&&(this.g.release(),this.g=null),dt.prototype.release.call(this)},s.onAssetUnload=function(){this.h&&this.h.stop(),this.i&&this.i.stop(),this.g&&this.g.stop(),this.dispatchEvent(new We("ad-stopped")),this.j=new Sm},s.requestClientSideAds=function(e){if(!this.h)throw new K(1,10,10001);var t=this.h;t.g&&t.g.destroy(),t.l&&t.l.contentComplete(),t.F=Date.now()/1e3,t.l.requestAds(e)},s.updateClientSideAdsRenderingSettings=function(e){if(!this.h)throw new K(1,10,10001);var t=this.h;t.u=e,t.g&&t.g.updateAdsRenderingSettings(t.u)},s.initMediaTailor=function(e,t,n){var o=this;this.i&&this.i.release(),this.i=new Ys(e,t,n,function(a){return yh(o,a)})},s.requestMediaTailorStream=function(e,t,n){if(!this.i)throw new K(1,10,10005);var o=this.i;return n=n===void 0?"":n,o.l?e=Promise.reject(new K(1,10,10004)):(o.l=new bt,HT(o,e,t),o.G=n||"",o.W=Date.now()/1e3,e=o.l),e},s.initServerSide=function(e,t){var n=this;if(!d.google||!google.ima||!google.ima.dai)throw new K(2,10,10002);this.g&&this.g.release(),this.g=new km(e,t,this.m,function(o){return yh(n,o)}),this.g.configure(this.l)},s.requestServerSideStream=function(e,t){if(t=t===void 0?"":t,!this.g)throw new K(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&Le('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.7.11",n=this.g,n.j?e=Promise.reject(new K(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.G=!0),n.j=new bt,n.g.requestStream(e),n.A=t||"",n.F=Date.now()/1e3,e=n.j),e},s.replaceServerSideAdTagParameters=function(e){if(!this.g)throw new K(1,10,10003);(e.mpt||e.mpv)&&Le('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.mpt="Shaka Player",e.mpv="v4.7.11",this.g.g.replaceAdTagParameters(e)},s.getServerSideCuePoints=function(){return ai("AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},s.getCuePoints=function(){var e=[];return this.g&&(e=e.concat(this.g.getCuePoints())),this.i&&(e=e.concat(this.i.getCuePoints())),e},s.getStats=function(){var e=this.j;return{loadTimes:e.h,started:e.g,playedCompletely:e.i,skipped:e.j}},s.onManifestUpdated=function(e){this.i&&this.i.onManifestUpdated(e)},s.onDashTimedMetadata=function(e){if(this.g&&e.schemeIdUri=="urn:google:dai:2018"){var t=e.schemeIdUri,n=e.eventElement?e.eventElement.getAttribute("messageData"):null;this.g.g.processMetadata(t,n,e.startTime)}},s.onHlsTimedMetadata=function(e,t){this.g&&this.g.g.processMetadata("ID3",e.data,t)},s.onCueMetadataChange=function(e){this.g&&this.g.onCueMetadataChange(e)};function yh(e,t){if(t&&t.type)switch(t.type){case"ads-loaded":e.j.h.push(t.loadTime);break;case"ad-started":e.j.g++;break;case"ad-complete":e.j.i++;break;case"ad-skipped":e.j.j++}e.dispatchEvent(t)}ae("shaka.ads.AdManager",$e),$e.prototype.onCueMetadataChange=$e.prototype.onCueMetadataChange,$e.prototype.onHlsTimedMetadata=$e.prototype.onHlsTimedMetadata,$e.prototype.onDashTimedMetadata=$e.prototype.onDashTimedMetadata,$e.prototype.onManifestUpdated=$e.prototype.onManifestUpdated,$e.prototype.getStats=$e.prototype.getStats,$e.prototype.getCuePoints=$e.prototype.getCuePoints,$e.prototype.getServerSideCuePoints=$e.prototype.getServerSideCuePoints,$e.prototype.replaceServerSideAdTagParameters=$e.prototype.replaceServerSideAdTagParameters,$e.prototype.requestServerSideStream=$e.prototype.requestServerSideStream,$e.prototype.initServerSide=$e.prototype.initServerSide,$e.prototype.requestMediaTailorStream=$e.prototype.requestMediaTailorStream,$e.prototype.initMediaTailor=$e.prototype.initMediaTailor,$e.prototype.updateClientSideAdsRenderingSettings=$e.prototype.updateClientSideAdsRenderingSettings,$e.prototype.requestClientSideAds=$e.prototype.requestClientSideAds,$e.prototype.onAssetUnload=$e.prototype.onAssetUnload,$e.prototype.release=$e.prototype.release,$e.prototype.initClientSide=$e.prototype.initClientSide,$e.prototype.configure=$e.prototype.configure,$e.prototype.setLocale=$e.prototype.setLocale,$e.ADS_LOADED="ads-loaded",$e.AD_STARTED="ad-started",$e.AD_FIRST_QUARTILE="ad-first-quartile",$e.AD_MIDPOINT="ad-midpoint",$e.AD_THIRD_QUARTILE="ad-third-quartile",$e.AD_COMPLETE="ad-complete",$e.AD_STOPPED="ad-stopped",$e.AD_SKIPPED="ad-skipped",$e.AD_VOLUME_CHANGED="ad-volume-changed",$e.AD_MUTED="ad-muted",$e.AD_PAUSED="ad-paused",$e.AD_RESUMED="ad-resumed",$e.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",$e.CUEPOINTS_CHANGED="ad-cue-points-changed",$e.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",$e.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",$e.AD_CLICKED="ad-clicked",$e.AD_PROGRESS="ad-progress",$e.AD_BUFFERING="ad-buffering",$e.AD_IMPRESSION="ad-impression",$e.AD_DURATION_CHANGED="ad-duration-changed",$e.AD_CLOSED="ad-closed",$e.AD_LOADED="ad-loaded",$e.ALL_ADS_COMPLETED="all-ads-completed",$e.AD_LINEAR_CHANGED="ad-linear-changed",$e.AD_METADATA="ad-metadata",$e.AD_RECOVERABLE_ERROR="ad-recoverable-error",$e.AD_ERROR="ad-error",$e.AD_BREAK_READY="ad-break-ready",$e.AD_INTERACTION="ad-interaction",Hl=function(){return new $e};function Mm(e){return JSON.stringify(e,function(t,n){if(typeof n!="function"){if(n instanceof Event||n instanceof We){var o={};for(a in n)(t=n[a])&&typeof t=="object"?a=="detail"&&(o[a]=t):a in Event||(o[a]=t);return o}if(n instanceof Error){var a=new Set(["name","message","stack"]);for(o in n)a.add(o);for(t=w(Object.getOwnPropertyNames(n)),o=t.next();!o.done;o=t.next())a.add(o.value);for(t={},a=w(a),o=a.next();!o.done;o=a.next())o=o.value,t[o]=n[o];n={__type__:"Error",contents:t}}else if(n instanceof TimeRanges){for(a={__type__:"TimeRanges",length:n.length,start:[],end:[]},n=w(fo(n)),o=n.next();!o.done;o=n.next())o=o.value,t=o.end,a.start.push(o.start),a.end.push(t);n=a}else n=n instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(n)}:typeof n=="number"?isNaN(n)?"NaN":isFinite(n)?n:0>n?"-Infinity":"Infinity":n;return n}})}function vh(e){return JSON.parse(e,function(t,n){if(n=="NaN")var o=NaN;else if(n=="-Infinity")o=-1/0;else if(n=="Infinity")o=1/0;else if(n&&typeof n=="object"&&n.__type__=="TimeRanges")o=KT(n);else if(n&&typeof n=="object"&&n.__type__=="Uint8Array")o=new Uint8Array(n.entries);else if(n&&typeof n=="object"&&n.__type__=="Error"){t=n.contents,n=Error(t.message);for(o in t)n[o]=t[o];o=n}else o=n;return o})}function KT(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}var _m="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),YT="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),xh=["loop","playbackRate"],qT=["pause","play"],Xl={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferFullness:1,getBufferedInfo:2,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10,getManifestType:10},Kl={getConfiguration:4,getStats:5,getTextTracks:2,getVariantTracks:2},wh={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},Rm=[["getConfiguration","configure"]],Lm=[["isTextTrackVisible","setTextTrackVisibility"]],QT="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),ZT=["attach","attachCanvas","detach","load","unload"];function Sh(e,t,n,o,a,l,f){var c=this;this.G=e,this.K=f,this.j=new st(t),this.N=n,this.u=!1,this.s=o,this.F=a,this.I=l,this.h=this.m=!1,this.J="",this.o=null,this.A=function(){return Ch(c)},this.C=function(p,m){switch(p=vh(m),p.type){case"event":var v=p.targetName,S=h0(p.event);c.s(v,S);break;case"update":v=p.update;for(S in v){p=c.g[S]||{};for(var C in v[S])p[C]=v[S][C]}c.u&&(c.N(),c.u=!1);break;case"asyncComplete":if(S=p.id,C=p.error,p=c.i[S],delete c.i[S],p)if(C){S=new K(C.severity,C.category,C.code);for(v in C)S[v]=C[v];p.reject(S)}else p.resolve()}},this.g={video:{},player:{}},this.H=0,this.i={},this.l=null,Qs.add(this)}s=Sh.prototype,s.destroy=function(){return Qs.delete(this),Eh(this),hi&&Nm(this),this.j&&(this.j.stop(),this.j=null),this.F=this.s=null,this.h=this.m=!1,this.C=this.A=this.l=this.i=this.g=this.o=null,Promise.resolve()},s.Ka=function(){return this.h},s.ef=function(){return this.J},s.init=function(){if(this.G.length)if(d.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.j.qc();var e=new chrome.cast.SessionRequest(this.G,[],null,this.K,null);e=new chrome.cast.ApiConfig(e,function(t){for(var n=w(Qs),o=n.next();!o.done;o=n.next())Dm(o.value,t)},function(t){for(var n=w(Qs),o=n.next();!o.done;o=n.next())o=o.value,Yl=t=="available",o.j.qc()},"origin_scoped"),chrome.cast.initialize(e,function(){},function(){}),Yl&&this.j.U(eC),(e=hi)&&e.status!=chrome.cast.SessionStatus.STOPPED?Dm(this,e):hi=null}else d.__onGCastApiAvailable!==Om&&(ql=d.__onGCastApiAvailable||null,d.__onGCastApiAvailable=Om)},s.mf=function(e){this.o=e,this.h&&qs(this,{type:"appData",appData:this.o})},s.cast=function(e){var t=this;return z(function(n){if(!t.m)throw new K(1,8,8e3);if(!Yl)throw new K(1,8,8001);if(t.h)throw new K(1,8,8002);return t.l=new bt,chrome.cast.requestSession(function(o){return Th(t,e,o)},function(o){return Pm(t,o)}),E(n,t.l,0)})};function JT(e){if(e.h){var t=e.I();chrome.cast.requestSession(function(n){return Th(e,t,n)},function(n){return Pm(e,n)})}}s.cc=function(){if(this.h){if(Eh(this),hi){Nm(this);try{hi.stop(function(){},function(){})}catch{}hi=null}Ch(this)}},s.get=function(e,t){var n=this;if(e=="video"){if(qT.includes(t))return function(){return n.hg.apply(n,[e,t].concat(R(Re.apply(0,arguments))))}}else if(e=="player"){if(wh[t]&&!this.get("player","isLive")())return function(){};if(QT.includes(t))return function(){return n.hg.apply(n,[e,t].concat(R(Re.apply(0,arguments))))};if(ZT.includes(t))return function(){return n.Nh.apply(n,[e,t].concat(R(Re.apply(0,arguments))))};if(Xl[t]||Kl[t])return function(){return n.g[e][t]}}return this.g[e][t]},s.set=function(e,t,n){this.g[e][t]=n,qs(this,{type:"set",targetName:e,property:t,value:n})};function Th(e,t,n){hi=n,n.addUpdateListener(e.A),n.addMessageListener("urn:x-cast:com.google.shaka.v2",e.C),Ch(e),qs(e,{type:"init",initState:t,appData:e.o}),e.l.resolve()}function Pm(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.l.reject(new K(2,8,n,t))}s.hg=function(e,t){qs(this,{type:"call",targetName:e,methodName:t,args:Re.apply(2,arguments)})},s.Nh=function(e,t){var n=Re.apply(2,arguments),o=new bt,a=this.H.toString();this.H++,this.i[a]=o;try{qs(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:a})}catch(l){o.reject(l)}return o};function Dm(e,t){var n=e.I();e.l=new bt,e.u=!0,Th(e,n,t)}function Nm(e){var t=hi;t.removeUpdateListener(e.A),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.C)}function Ch(e){var t=hi?hi.status=="connected":!1;if(e.h&&!t){e.F();for(var n in e.g)e.g[n]={};Eh(e)}e.h=t,e.J=t?hi.receiver.friendlyName:"",e.j.qc()}function Eh(e){for(var t in e.i){var n=e.i[t];delete e.i[t],n.reject(new K(1,7,7e3))}}function qs(e,t){t=Mm(t);var n=hi;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,function(){},zn)}catch(o){throw t=new K(2,8,8005,o),n=new We("error",new Map().set("detail",t)),e.s("player",n),e.cc(),t}}var eC=.02,Yl=!1,hi=null,ql=null,Qs=new Set;function Om(e){if(ql?d.__onGCastApiAvailable=ql:delete d.__onGCastApiAvailable,ql=null,e)for(var t=w(Qs),n=t.next();!n.done;n=t.next())n.value.init();typeof d.__onGCastApiAvailable=="function"&&d.__onGCastApiAvailable(e)}function Ft(e,t,n,o){o=o===void 0?!1:o,dt.call(this);var a=this;this.i=e,this.h=t,this.m=this.o=this.j=this.s=this.l=null,this.C=n,this.A=o,this.u=new Map,this.g=new Sh(n,function(){return Bm(a)},function(){return jm(a)},function(l,f){return zm(a,l,f)},function(){return Fm(a)},function(){return Ah(a)},o),tC(this)}Z(Ft,dt),s=Ft.prototype,s.destroy=function(e){return e&&this.g.cc(),this.m&&(this.m.release(),this.m=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.s=this.l=this.i=null,dt.prototype.release.call(this),Promise.all(e)},s.nh=function(){return this.l},s.bh=function(){return this.s},s.Fg=function(){return this.g.m&&Yl},s.Ka=function(){return this.g.Ka()},s.ef=function(){return this.g.ef()},s.cast=function(){var e=this,t;return z(function(n){return n.g==1?(t=Ah(e),E(n,e.g.cast(t),2)):e.h?E(n,e.h.rc(),0):n.return()})},s.mf=function(e){this.g.mf(e)},s.ai=function(){JT(this.g)},s.cc=function(){this.g.cc()},s.Gg=function(e,t){t=t===void 0?!1:t;var n=this;return z(function(o){if(o.g==1)return e==n.C&&t==n.A?o.return():(n.C=e,n.A=t,n.g.cc(),E(o,n.g.destroy(),2));n.g=null,n.g=new Sh(e,function(){return Bm(n)},function(){return jm(n)},function(a,l){return zm(n,a,l)},function(){return Fm(n)},function(){return Ah(n)},t),n.g.init(),F(o)})};function tC(e){e.g.init(),e.m=new Ct;for(var t=w(_m),n=t.next();!n.done;n=t.next())e.m.D(e.i,n.value,function(l){e.g.Ka()||(l=h0(l),e.j.dispatchEvent(l))});for(var o in cl)e.m.D(e.h,cl[o],function(l){e.g.Ka()||e.o.dispatchEvent(l)});e.l={},t={};for(var a in e.i)t.wc=a,Object.defineProperty(e.l,t.wc,{configurable:!1,enumerable:!0,get:function(l){return function(){return iC(e,l.wc)}}(t),set:function(l){return function(f){var c=l.wc;e.g.Ka()?e.g.set("video",c,f):e.i[c]=f}}(t)}),t={wc:t.wc};e.s={},Um(e,function(l){Object.defineProperty(e.s,l,{configurable:!1,enumerable:!0,get:function(){return oC(e,l)}})}),nC(e),e.j=new dt,e.j.zd=e.l,e.o=new dt,e.o.zd=e.s}function nC(e){var t=new Map;Um(e,function(n,o){t.has(o)?(o=t.get(o),n.length<o.length?e.u.set(n,o):e.u.set(o,n)):t.set(o,n)})}function Um(e,t){function n(p){return p=="constructor"||typeof o[p]!="function"?!1:!a.has(p)}var o=e.h,a=new Set,l;for(l in o)n(l)&&(a.add(l),t(l,o[l]));for(e=Object.getPrototypeOf(o),l=Object.getPrototypeOf({});e&&e!=l;){for(var f=w(Object.getOwnPropertyNames(e)),c=f.next();!c.done;c=f.next())c=c.value,n(c)&&(a.add(c),t(c,o[c]));e=Object.getPrototypeOf(e)}}function Ah(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.Ge(),startTime:null};e.i.pause();for(var n=w(xh),o=n.next();!o.done;o=n.next())o=o.value,t.video[o]=e.i[o];for(e.i.ended||(t.startTime=e.i.currentTime),n=w(Rm),o=n.next();!o.done;o=n.next()){var a=o.value;o=a[1],a=e.h[a[0]](),t.player[o]=a}for(n=w(Lm),o=n.next();!o.done;o=n.next())a=o.value,o=a[1],a=e.h[a[0]](),t.playerAfterLoad[o]=a;return t}function Bm(e){var t=new We("caststatuschanged");e.dispatchEvent(t)}function jm(e){var t=new We(e.l.paused?"pause":"play");e.j.dispatchEvent(t)}function Fm(e){for(var t=w(Rm),n=t.next();!n.done;n=t.next()){var o=n.value;n=o[1],o=e.g.get("player",o[0])(),e.h[n](o)}var a=e.g.get("player","getAssetUri")();o=e.g.get("video","ended"),t=Promise.resolve();var l=e.i.autoplay;n=null,o||(n=e.g.get("video","currentTime"));var f;(o=e.g.get("player","getTextTracks")())&&o.length&&(f=o.find(function(m){return m.active}));var c=e.g.get("player","isTextTrackVisible")();a&&(e.i.autoplay=!1,t=e.h.load(a,n));var p={};for(n=w(xh),o=n.next();!o.done;o=n.next())o=o.value,p[o]=e.g.get("video",o);t.then(function(){if(e.i){for(var m=w(xh),v=m.next();!v.done;v=m.next())v=v.value,e.i[v]=p[v];for(m=w(Lm),v=m.next();!v.done;v=m.next()){var S=v.value;v=S[1],S=e.g.get("player",S[0])(),e.h[v](S)}e.h.og(c),f&&e.h.kf(f.language,f.roles,f.forced),e.i.autoplay=l,a&&e.i.play()}},function(m){m=new Map().set("detail",m),m=new We("error",m),e.h.dispatchEvent(m)})}function iC(e,t){if(t=="addEventListener")return function(o,a,l){return e.j.addEventListener(o,a,l)};if(t=="removeEventListener")return function(o,a,l){return e.j.removeEventListener(o,a,l)};if(e.g.Ka()&&Object.keys(e.g.g.video).length==0){var n=e.i[t];if(typeof n!="function")return n}return e.g.Ka()?e.g.get("video",t):(t=e.i[t],typeof t=="function"&&(t=t.bind(e.i)),t)}function oC(e,t){if(e.u.has(t)&&(t=e.u.get(t)),t=="addEventListener")return function(n,o,a){return e.o.addEventListener(n,o,a)};if(t=="removeEventListener")return function(n,o,a){return e.o.removeEventListener(n,o,a)};if(t=="getMediaElement")return function(){return e.l};if(t=="getSharedConfiguration")return e.g.get("player","getConfiguration");if(t=="getNetworkingEngine")return function(){return e.h.Ob()};if(t=="getDrmEngine")return function(){return e.h.m};if(t=="getAdManager")return function(){return e.h.Of()};if(t=="setVideoContainer")return function(n){return e.h.rg(n)};if(e.g.Ka()){if(t=="getManifest"||t=="drmInfo")return function(){return Le(t+"() does not work while casting!"),null};if(t=="attach"||t=="detach")return function(){return Le(t+"() does not work while casting!"),Promise.resolve()}}return e.g.Ka()&&Object.keys(e.g.g.video).length==0&&(Xl[t]||Kl[t])||!e.g.Ka()?e.h[t].bind(e.h):e.g.get("player",t)}function zm(e,t,n){e.g.Ka()&&(t=="video"?e.j.dispatchEvent(n):t=="player"&&e.o.dispatchEvent(n))}ae("shaka.cast.CastProxy",Ft),Ft.prototype.changeReceiverId=Ft.prototype.Gg,Ft.prototype.forceDisconnect=Ft.prototype.cc,Ft.prototype.suggestDisconnect=Ft.prototype.ai,Ft.prototype.setAppData=Ft.prototype.mf,Ft.prototype.cast=Ft.prototype.cast,Ft.prototype.receiverName=Ft.prototype.ef,Ft.prototype.isCasting=Ft.prototype.Ka,Ft.prototype.canCast=Ft.prototype.Fg,Ft.prototype.getPlayer=Ft.prototype.bh,Ft.prototype.getVideo=Ft.prototype.nh,Ft.prototype.destroy=Ft.prototype.destroy;function Jt(e,t,n,o){dt.call(this);var a=this;this.g=e,this.h=t,this.j=new Ct,this.H={video:e,player:t},this.C=n||function(){},this.I=o||function(l){return l},this.i=null,this.F=!1,this.o=!0,this.m=0,this.A=!1,this.u=!0,this.s=this.l=null,this.G=new st(function(){bh(a)}),rC(this)}Z(Jt,dt),s=Jt.prototype,s.isConnected=function(){return this.F},s.th=function(){return this.o},s.Zh=function(e){this.i=e},s.Jg=function(){this.i=null},s.$h=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},s.Yh=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},s.Xh=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},s.destroy=function(){var e=this,t,n;return z(function(o){if(o.g==1)return e.j&&(e.j.release(),e.j=null),t=[],e.h&&(t.push(e.h.destroy()),e.h=null),e.G&&(e.G.stop(),e.G=null),e.g=null,e.H=null,e.C=null,e.F=!1,e.o=!0,e.l=null,e.s=null,dt.prototype.release.call(e),E(o,Promise.all(t),2);n=cast.receiver.CastReceiverManager.getInstance(),n.stop(),F(o)})};function rC(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return Vm(e)},t.onSenderDisconnected=function(){return Vm(e)},t.onSystemVolumeChanged=function(){var a=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();a&&Qi(e,{type:"update",update:{video:{volume:a.level,muted:a.muted}}},e.l),Qi(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.s=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.s.onMessage=function(a){return lC(e,a)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(a){return aC(e,a)},t.start(),t=w(_m);for(var n=t.next();!n.done;n=t.next())e.j.D(e.g,n.value,function(a){return Hm(e,"video",a)});for(var o in cl)e.j.D(e.h,cl[o],function(a){return Hm(e,"player",a)});cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.h.pf(3840,2160):e.h.pf(1920,1080),e.j.D(e.g,"loadeddata",function(){e.A=!0}),e.j.D(e.h,"loading",function(){e.o=!1,Ur(e)}),e.j.D(e.g,"playing",function(){e.o=!1,Ur(e)}),e.j.D(e.g,"pause",function(){Ur(e)}),e.j.D(e.h,"unloading",function(){e.o=!0,Ur(e)}),e.j.D(e.g,"ended",function(){new st(function(){e.g&&e.g.ended&&(e.o=!0,Ur(e))}).U(fC)})}function Vm(e){e.m=0,e.u=!0,e.F=cast.receiver.CastReceiverManager.getInstance().getSenders().length!=0,Ur(e)}function Ur(e){var t;z(function(n){if(n.g==1)return E(n,Promise.resolve(),2);if(!e.h)return n.return();t=new We("caststatuschanged"),e.dispatchEvent(t),$m(e)||Zi(e),F(n)})}function sC(e,t,n){var o,a,l,f,c,p,m,v,S,C;z(function(T){switch(T.g){case 1:for(o in t.player)a=t.player[o],e.h[o](a);return e.C(n),l=e.g.autoplay,t.manifest?(e.g.autoplay=!1,re(T,5),E(T,e.h.load(t.manifest,t.startTime),7)):E(T,Promise.resolve(),3);case 7:ie(T,3);break;case 5:return f=se(T),c=new Map().set("detail",f),p=new We("error",c),e.h&&e.h.dispatchEvent(p),T.return();case 3:if(!e.h)return T.return();for(m in t.video)v=t.video[m],e.g[m]=v;for(S in t.playerAfterLoad)C=t.playerAfterLoad[S],e.h[S](C);e.g.autoplay=l,t.manifest&&(e.g.play(),Zi(e)),F(T)}})}function Hm(e,t,n){e.h&&(bh(e),Qi(e,{type:"event",targetName:t,event:n},e.l))}function bh(e){e.G.U(uC);for(var t={video:{},player:{}},n=w(YT),o=n.next();!o.done;o=n.next())o=o.value,t.video[o]=e.g[o];if(e.h.R())for(var a in wh)e.m%wh[a]==0&&(t.player[a]=e.h[a]());for(var l in Xl)e.m%Xl[l]==0&&(t.player[l]=e.h[l]());(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),Qi(e,{type:"update",update:t},e.l);for(var f in Kl)e.m%Kl[f]==0&&(t={player:{}},t.player[f]=e.h[f](),Qi(e,{type:"update",update:t},e.l));e.A&&(e.m+=1),$m(e)}function $m(e){return e.u&&(e.g.duration||e.h.R())?(Ih(e),e.u=!1,!0):!1}function Ih(e,t){var n={contentId:e.h.Ge(),streamType:e.h.R()?"LIVE":"BUFFERED",contentType:""};e.h.R()||(n.duration=e.g.duration),e.i&&(n.metadata=e.i),Zi(e,t===void 0?0:t,n)}function aC(e,t){var n=vh(t.data);switch(n.type){case"init":e.m=0,e.A=!1,e.u=!0,sC(e,n.initState,n.appData),bh(e);break;case"appData":e.C(n.appData);break;case"set":var o=n.targetName,a=n.property;if(n=n.value,o=="video"){if(t=cast.receiver.CastReceiverManager.getInstance(),a=="volume"){t.setSystemVolumeLevel(n);break}else if(a=="muted"){t.setSystemVolumeMuted(n);break}}e.H[o][a]=n;break;case"call":o=e.H[n.targetName],o[n.methodName].apply(o,n.args);break;case"asyncCall":o=n.targetName,a=n.methodName,o=="player"&&a=="load"&&(e.m=0,e.A=!1);var l=n.id,f=t.senderId;t=e.H[o],n=t[a].apply(t,n.args),o=="player"&&a=="load"&&(n=n.then(function(){e.u=!0})),n.then(function(){return Gm(e,f,l,null)},function(c){return Gm(e,f,l,c)})}}function lC(e,t){var n=vh(t.data);switch(n.type){case"PLAY":e.g.play(),Zi(e);break;case"PAUSE":e.g.pause(),Zi(e);break;case"SEEK":t=n.currentTime;var o=n.resumeState;t!=null&&(e.g.currentTime=Number(t)),o&&o=="PLAYBACK_START"?(e.g.play(),Zi(e)):o&&o=="PLAYBACK_PAUSE"&&(e.g.pause(),Zi(e));break;case"STOP":e.h.rc().then(function(){e.h&&Zi(e)});break;case"GET_STATUS":Ih(e,Number(n.requestId));break;case"VOLUME":o=n.volume,t=o.level,o=o.muted;var a=e.g.volume,l=e.g.muted;t!=null&&(e.g.volume=Number(t)),o!=null&&(e.g.muted=o),a==e.g.volume&&l==e.g.muted||Zi(e);break;case"LOAD":e.m=0,e.A=!1,e.u=!1,t=n.media,o=n.currentTime,a=e.I(t.contentId),l=n.autoplay||!0,e.C(t.customData),l&&(e.g.autoplay=!0),e.h.load(a,o).then(function(){e.h&&Ih(e)}).catch(function(f){var c="LOAD_FAILED";f.category==7&&f.code==7e3&&(c="LOAD_CANCELLED"),Qi(e,{requestId:Number(n.requestId),type:c},e.s)});break;default:Qi(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.s)}}function Gm(e,t,n,o){e.h&&Qi(e,{type:"asyncComplete",id:n,error:o},e.l,t)}function Qi(e,t,n,o){e.F&&(e=Mm(t),o?n.getCastChannel(o).send(e):n.broadcast(e))}function Zi(e,t,n){n=n===void 0?null:n;var o={mediaSessionId:0,playbackRate:e.g.playbackRate,playerState:e.o?cC:e.h.Ke()?dC:e.g.paused?pC:hC,currentTime:e.g.currentTime,supportedMediaCommands:63,volume:{level:e.g.volume,muted:e.g.muted}};n&&(o.media=n),Qi(e,{requestId:t===void 0?0:t,type:"MEDIA_STATUS",status:[o]},e.s)}ae("shaka.cast.CastReceiver",Jt),Jt.prototype.destroy=Jt.prototype.destroy,Jt.prototype.setContentArtist=Jt.prototype.Xh,Jt.prototype.setContentImage=Jt.prototype.Yh,Jt.prototype.setContentTitle=Jt.prototype.$h,Jt.prototype.clearContentMetadata=Jt.prototype.Jg,Jt.prototype.setContentMetadata=Jt.prototype.Zh,Jt.prototype.isIdle=Jt.prototype.th,Jt.prototype.isConnected=Jt.prototype.isConnected;var uC=.5,fC=5,cC="IDLE",hC="PLAYING",dC="BUFFERING",pC="PAUSED";function Wm(e,t,n,o,a){if(o>=a)return null;for(var l=-1,f=-1,c=0;c<n.length;c++)if(n[c].some(function(V){return V!=null&&V.g.trim()!=""})){l=c;break}for(c=n.length-1;0<=c;c--)if(n[c].some(function(V){return V!=null&&V.g.trim()!=""})){f=c;break}if(l===-1||f===-1)return null;for(var p=c=!1,m="white",v="black",S=kh(o,a,c,p,m,v);l<=f;l++){for(var C=n[l],T=-1,I=-1,_=0;_<C.length;_++)if(C[_]!=null&&C[_].g.trim()!==""){T=_;break}for(_=C.length-1;0<=_;_--)if(C[_]!=null&&C[_].g.trim()!==""){I=_;break}if(T===-1||I===-1)C=Xm(o,a),e.nestedCues.push(C);else{for(;T<=I;T++)if(_=C[T]){var N=_.l,j=_.i,O=_.j,X=_.h;(N!=c||j!=p||O!=m||X!=v)&&(S.payload&&e.nestedCues.push(S),S=kh(o,a,N,j,O,X),c=N,p=j,m=O,v=X),S.payload+=_.g}else S.payload+=" ";S.payload&&e.nestedCues.push(S),l!==f&&(S=Xm(o,a),e.nestedCues.push(S)),S=kh(o,a,c,p,m,v)}}return e.nestedCues.length?{cue:e,stream:t}:null}function kh(e,t,n,o,a,l){return e=new ct(e,t,""),n&&e.textDecoration.push("underline"),o&&(e.fontStyle="italic"),e.color=a,e.backgroundColor=l,e}function Xm(e,t){return e=new ct(e,t,""),e.lineBreak=!0,e}function Km(e,t,n,o,a){this.g=e,this.l=t,this.i=n,this.h=o,this.j=a}function Mh(e,t){this.i=[],this.g=1,this.h=0,this.u=e,this.s=t,this.j=this.m=!1,this.l="white",this.o="black",Zs(this)}function Ql(e,t,n){var o="CC"+((e.u<<1|e.s)+1),a=new ct(t,n,"");a.lineInterpretation=1;var l=vC.get(e.g);return l&&(a.line=l),Wm(a,o,e.i,t,n)}function Zs(e){Ji(e,0,15),e.g=1}function Br(e,t,n){if(!(32>n||127<n)){var o="";switch(t){case Js:o=Jm.has(n)?Jm.get(n):String.fromCharCode(n);break;case qm:o=gC.get(n);break;case Qm:e.i[e.g].pop(),o=mC.get(n);break;case Zm:e.i[e.g].pop(),o=yC.get(n)}o&&e.i[e.g].push(new Km(o,e.m,e.j,e.o,e.l))}}function Ym(e,t,n,o){if(!(0>n||0>t))if(t>=n)for(--o;0<=o;o--)e.i[t+o]=e.i[n+o].map(function(l){return l});else for(var a=0;a<o;a++)e.i[t+a]=e.i[n+a].map(function(l){return l})}function Ji(e,t,n){for(var o=0;o<=n;o++)e.i[t+o]=[]}var Js=0,qm=1,Qm=2,Zm=3,Jm=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),gC=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57,"⠀"],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),mC=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),yC=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]),vC=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]);function Zl(e,t){this.h=ny,this.o=new Mh(e,t),this.i=new Mh(e,t),this.g=this.j=new Mh(e,t),this.l=0,this.m=null}function _h(e,t,n){e.g=e.i;var o=e.g,a=null;return e.h!==Jl&&e.h!==ea&&(a=Ql(o,e.l,n),n=e.i,n.g=0<n.h?n.h:0,Ji(n,0,15),n=e.j,n.g=0<n.h?n.h:0,Ji(n,0,15),o.g=15),e.h=Jl,o.h=t,a}function ey(e){e.h=xC,e.g=e.j,e.g.h=0}function ty(e){it("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=ea}var ny=0,xC=1,Jl=3,ea=4,wC="black green blue cyan red yellow magenta black".split(" "),iy="white green blue cyan red yellow magenta white_italics".split(" ");function oy(e,t){this.I=t,this.N=e,this.J=this.l=!1,this.m=this.o=this.G=this.K=this.H=0,this.F=CC,this.i=[],this.g=this.h=this.j=0,this.C=this.u=!1,this.A="white",this.s="black",Rh(this)}function Rh(e){e.i=[];for(var t=0;16>t;t++)e.i.push(Lh())}function Lh(){for(var e=[],t=0;42>t;t++)e.push(null);return e}function $o(e,t){ry(e)&&(e.i[e.h][e.g]=new Km(t,e.C,e.u,e.s,e.A),e.g++)}function ry(e){var t=e.g<e.m&&0<=e.g;return e.h<e.o&&0<=e.h&&t}oy.prototype.isVisible=function(){return this.l};function Go(e,t,n){var o=new ct(e.j,t,"");o.textAlign=e.F===SC?"left":e.F===TC?"right":Ui;var a=o.region;switch(e.I&&(a.id+="svc"+e.I),a.id+="win"+e.N,a.height=e.o,a.width=e.m,a.heightUnits=2,a.widthUnits=2,a.viewportAnchorX=e.H,a.viewportAnchorY=e.K,a.viewportAnchorUnits=e.J?Hn:2,e.G){case EC:a.regionAnchorX=0,a.regionAnchorY=0;break;case AC:a.regionAnchorX=50,a.regionAnchorY=0;break;case bC:a.regionAnchorX=100,a.regionAnchorY=0;break;case IC:a.regionAnchorX=0,a.regionAnchorY=50;break;case kC:a.regionAnchorX=50,a.regionAnchorY=50;break;case MC:a.regionAnchorX=100,a.regionAnchorY=50;break;case _C:a.regionAnchorX=0,a.regionAnchorY=100;break;case RC:a.regionAnchorX=50,a.regionAnchorY=100;break;case LC:a.regionAnchorX=100,a.regionAnchorY=100}return(n=Wm(o,"svc"+n,e.i,e.j,t))&&(e.j=t),n}var SC=0,TC=1,CC=2,EC=0,AC=1,bC=2,IC=3,kC=4,MC=5,_C=6,RC=7,LC=8;function PC(){this.i=[],this.h=null,this.g=0}function DC(e,t){t.type===3?(e.g=2*(t.value&63)-1,e.h=[]):e.h&&(0<e.g&&(e.h.push(t),e.g--),e.g===0&&(e.i.push(new eu(e.h)),e.h=null,e.g=0))}function eu(e){this.g=0,this.h=e}eu.prototype.ia=function(){return this.g<this.h.length},eu.prototype.qa=function(){return this.g};function Wt(e){if(!e.ia())throw new K(2,2,3e3);return e.h[e.g++]}eu.prototype.skip=function(e){if(this.g+e>this.h.length)throw new K(2,2,3e3);this.g+=e};function NC(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function OC(e,t,n,o){if(128<=n&&135>=n)o=n&7,e.h[o]&&(e.g=e.h[o]);else{if(n===136){n=Wt(t).value,t=null,n=w(ta(e,n));for(var a=n.next();!a.done;a=n.next())a=e.h[a.value],a.isVisible()&&(t=Go(a,o,e.i)),Rh(a);return t}if(n===137)for(t=Wt(t).value,t=w(ta(e,t)),n=t.next();!n.done;n=t.next())n=e.h[n.value],n.isVisible()||(n.j=o),n.l=!0;else{if(n===138){for(n=Wt(t).value,t=null,n=w(ta(e,n)),a=n.next();!a.done;a=n.next())a=e.h[a.value],a.isVisible()&&(t=Go(a,o,e.i)),a.l=!1;return t}if(n===139){for(n=Wt(t).value,t=null,n=w(ta(e,n)),a=n.next();!a.done;a=n.next())a=e.h[a.value],a.isVisible()?t=Go(a,o,e.i):a.j=o,a.l=!a.l;return t}if(n===140)return t=Wt(t).value,sy(e,t,o);if(n===143)return o=sy(e,255,o),ay(e),o;if(n===144)t.skip(1),o=Wt(t).value,e.g&&(e.g.u=0<(o&128),e.g.C=0<(o&64));else if(n===145)o=Wt(t).value,n=Wt(t).value,t.skip(1),e.g&&(t=ly((n&48)>>4,(n&12)>>2,n&3),e.g.A=ly((o&48)>>4,(o&12)>>2,o&3),e.g.s=t);else if(n===146)o=Wt(t).value,t=Wt(t).value,e.g&&(e=e.g,e.h=o&15,e.g=t&63);else if(n===151)t.skip(1),t.skip(1),o=Wt(t).value,t.skip(1),e.g&&(e.g.F=o&3);else if(152<=n&&159>=n){if(n=(n&15)-8,a=e.h[n]!==null,!a){var l=new oy(n,e.i);l.j=o,e.h[n]=l}o=Wt(t).value,l=Wt(t).value;var f=Wt(t).value,c=Wt(t).value,p=Wt(t).value;t=Wt(t).value,a&&!(t&7)||(t=e.h[n],t.h=0,t.g=0,t.C=!1,t.u=!1,t.A="white",t.s="black"),t=e.h[n],t.l=0<(o&32),t.K=l&127,t.H=f,t.G=(c&240)>>4,t.J=0<(l&128),t.o=(c&15)+1,t.m=(p&63)+1,e.g=e.h[n]}}}return null}function ta(e,t){for(var n=[],o=0;8>o;o++)(t&1)===1&&e.h[o]&&n.push(o),t>>=1;return n}function sy(e,t,n){var o=null;t=w(ta(e,t));for(var a=t.next();!a.done;a=t.next()){a=a.value;var l=e.h[a];l.isVisible()&&(o=Go(l,n,e.i)),e.h[a]=null}return o}function ay(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function ly(e,t,n){var o={0:0,1:0,2:1,3:1};return e=o[e],t=o[t],n=o[n],UC[e<<2|t<<1|n]}var uy=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),UC="black blue green cyan red magenta yellow white".split(" ");function jr(){this.h=[],this.g=[],this.i=new PC,this.l=0,this.m=new Map([["CC1",new Zl(0,0)],["CC2",new Zl(0,1)],["CC3",new Zl(1,0)],["CC4",new Zl(1,1)]]),this.s=this.o=0,this.j=new Map,this.A=!0,this.u=new Set,Ph(this)}jr.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var e=this.i;e.i=[],e.h=[],e.g=0,Ph(this),e=w(this.j.values());for(var t=e.next();!t.done;t=e.next())ay(t.value)};function Ph(e){e.o=0,e.s=0;for(var t=w(e.m.values()),n=t.next();!n.done;n=t.next())n=n.value,n.h=ny,n.g=n.j,n.m=null,Zs(n.i),Zs(n.j),Zs(n.o);e.A=!0}jr.prototype.extract=function(e,t){if(this.A){for(var n=w(this.m.values()),o=n.next();!o.done;o=n.next())o.value.l=t;this.A=!1}if(e=new vt(e,0),!(8>e.getLength())&&e.ga()===181&&e.Ea()===49&&e.L()===1195456820&&e.ga()===3&&(n=e.ga(),(n&64)!==0))for(n&=31,e.skip(1),o=0;o<n;o++){var a=e.ga(),l=(a&4)>>2,f=e.ga(),c=e.ga();l&&(a&=3,a===0||a===1?this.h.push({pts:t,type:a,Sa:f,nb:c,order:this.h.length}):(this.g.push({pts:t,type:a,value:f,order:this.g.length}),this.g.push({pts:t,type:2,value:c,order:this.g.length})))}},jr.prototype.decode=function(){function e(a,l){return a.pts-l.pts||a.order-l.order}var t=[];this.h.sort(e),this.g.sort(e);for(var n=w(this.h),o=n.next();!o.done;o=n.next())(o=BC(this,o.value))&&t.push(o);for(n=w(this.g),o=n.next();!o.done;o=n.next())DC(this.i,o.value);for(n=w(this.i.i),o=n.next();!o.done;o=n.next())o=jC(this,o.value),t.push.apply(t,R(o));return this.i.i=[],this.h=[],this.g=[],t};function BC(e,t){var n=t.type;if((t.Sa&112)===16){var o=t.Sa>>3&1;n===0?e.o=o:e.s=o}if(o="CC"+((n<<1|(n?e.s:e.o))+1),n=e.m.get(o),t.Sa===255&&t.nb===255||!t.Sa&&!t.nb||!fy(t.Sa)||!fy(t.nb))return 45<=++e.l&&Ph(e),null;if(e.l=0,t.Sa&=127,t.nb&=127,!t.Sa&&!t.nb)return null;if(e.u.add(o),e=null,(t.Sa&112)===16)e:{if(o=t.Sa,e=t.nb,n.m===(o<<8|e))n.m=null;else if(n.m=o<<8|e,(o&240)===16&&(e&192)===64){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(o&7)<<1|e>>5&1];var a=(e&30)>>1;o="white";var l=!1;7>a?o=iy[a]:a===7&&(l=!0),e=(e&1)===1,n.h!==ea&&(a=n.g,n.h===Jl&&t!==a.g&&(n=1+t-a.h,Ym(a,n,1+a.g-a.h,a.h),Ji(a,0,n-1),Ji(a,t+1,15-t)),a.g=t,a.m=e,a.j=l,a.l=o,a.o="black")}else if((o&247)===17&&(e&240)===32)n.g.m=!1,n.g.j=!1,n.g.l="white",Br(n.g,Js,32),o=!1,t=iy[(e&14)>>1],t==="white_italics"&&(t="white",o=!0),n.g.m=(e&1)===1,n.g.j=o,n.g.l=t;else if((o&247)===16&&(e&240)===32||(o&247)===23&&(e&255)===45)t="black",!(o&7)&&(t=wC[(e&14)>>1]),n.g.o=t;else if((o&247)===17&&(e&240)===48)Br(n.g,qm,e);else if((o&246)===18&&(e&224)===32)Br(n.g,o&1?Zm:Qm,e);else if((o&246)===20&&(e&240)===32){switch(e=t.pts,o=null,t.nb){case 32:ey(n);break;case 33:n=n.g,n.i[n.g].pop();break;case 37:o=_h(n,2,e);break;case 38:o=_h(n,3,e);break;case 39:o=_h(n,4,e);break;case 40:Br(n.g,Js,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.l=e;break;case 42:Zs(n.o),ty(n);break;case 43:ty(n);break;case 44:t=n.i,o=null,n.h!==ea&&(o=Ql(t,n.l,e)),Ji(t,0,15);break;case 45:t=n.g,n.h!==Jl?o=null:(o=Ql(t,n.l,e),l=t.g-t.h+1,Ym(t,l-1,l,t.h),Ji(t,0,l-1),Ji(t,t.g,15-t.g),n.l=e);break;case 46:Ji(n.j,0,15);break;case 47:t=null,n.h!==ea&&(t=Ql(n.i,n.l,e)),o=n.j,n.j=n.i,n.i=o,ey(n),n.l=e,o=t}e=o;break e}e=null}else o=t.nb,Br(n.g,Js,t.Sa),Br(n.g,Js,o);return e}function jC(e,t){var n=[];try{for(;t.ia();){var o=Wt(t).value,a=(o&224)>>5,l=o&31;if(a===7&&l!=0&&(a=Wt(t).value&63),a!=0){e.u.add("svc"+a),e.j.has(a)||e.j.set(a,new NC(a));for(var f=e.j.get(a),c=t.qa();t.qa()-c<l;){a=t;var p=Wt(a),m=p.value,v=p.pts;if(m===16){var S=Wt(a);m=m<<16|S.value}if(0<=m&&31>=m){var C=v;if(f.g){var T=f.g;switch(a=null,m){case 8:!ry(T)||0>=T.g&&0>=T.h||(0>=T.g?(T.g=T.m-1,T.h--):T.g--,T.i[T.h][T.g]=null);break;case 13:if(T.isVisible()&&(a=Go(T,C,f.i)),T.h+1>=T.o){C=T;for(var I=0,_=1;16>_;_++,I++)C.i[I]=C.i[_];for(_=0;1>_;_++,I++)C.i[I]=Lh()}else T.h++;T.g=0;break;case 14:T.isVisible()&&(a=Go(T,C,f.i)),T.i[T.h]=Lh(),T.g=0;break;case 12:T.isVisible()&&(a=Go(T,C,f.i)),Rh(T),C=T,C.h=0,C.g=0}var N=a}else N=null}else if(128<=m&&159>=m)N=OC(f,a,m,v);else{if(4096<=m&&4127>=m)C=m&255,8<=C&&15>=C?a.skip(1):16<=C&&23>=C?a.skip(2):24<=C&&31>=C&&a.skip(3);else if(4224<=m&&4255>=m)C=m&255,128<=C&&135>=C?a.skip(4):136<=C&&143>=C&&a.skip(5);else if(32<=m&&127>=m)a=m,f.g&&(a===127?$o(f.g,"♪"):$o(f.g,String.fromCharCode(a)));else if(160<=m&&255>=m)f.g&&$o(f.g,String.fromCharCode(m));else if(4128<=m&&4223>=m){if(a=m&255,f.g)if(uy.has(a)){var j=uy.get(a);$o(f.g,j)}else $o(f.g,"_")}else 4256<=m&&4351>=m&&f.g&&((m&255)!=160?$o(f.g,"_"):$o(f.g,"[CC]"));N=null}(a=N)&&n.push(a)}}}}catch(O){if(O instanceof K&&O.code===3e3)it("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.");else throw O}return n}function fy(e){for(var t=0;e;)t^=e&1,e>>=1;return t===1}jr.prototype.getStreams=function(){return Array.from(this.u)},ae("shaka.cea.CeaDecoder",jr),xn=function(){return new jr};function cy(e){for(var t=[],n=e,o=e=0;o<n.length;)e==2&&n[o]==3?(e=0,n=[].concat(R(n)),n.splice(o,1),n=new Uint8Array(n)):n[o]==0?e++:e=0,o++;for(e=n,o=0;o<e.length;){for(n=0;e[o]==255;)n+=255,o++;n+=e[o++];for(var a=0;e[o]==255;)a+=255,o++;a+=e[o++],n==4&&t.push(e.subarray(o,o+a)),o+=a}return t}function tu(){this.j=new Map,this.i=this.h=0,this.g=Dh}tu.prototype.init=function(e){function t(l){l=l.name,l in nu&&(n.g=nu[l])}var n=this,o=[],a=[];if(new St().box("moov",pt).box("mvex",pt).O("trex",function(l){var f=l.reader;f.skip(4),f.skip(4),l=f.L(),f=f.L(),n.h=l,n.i=f}).box("trak",pt).O("tkhd",function(l){l=Y0(l.reader,l.version),o.push(l.trackId)}).box("mdia",pt).O("mdhd",function(l){l=Sl(l.reader,l.version),a.push(l.timescale)}).box("minf",pt).box("stbl",pt).O("stsd",yr).box("avc1",t).box("avc3",t).box("hev1",t).box("hvc1",t).box("dvh1",t).box("dvhe",t).box("encv",pl).box("sinf",pt).box("frma",function(l){l=Q0(l.reader).ha,l in nu&&(n.g=nu[l])}).parse(e,!0),!o.length||!a.length||o.length!=a.length)throw new K(2,2,2010);this.g==Dh&&Le("Unable to determine bitstream format for CEA parsing!"),o.forEach(function(l,f){n.j.set(l,a[f])})},tu.prototype.parse=function(e){var t=this;if(this.g==Dh)return[];var n=[],o=this.h,a=this.i,l=0,f=[],c=null,p=9e4;return new St().box("moof",function(m){l=m.start,f=[],pt(m)}).box("traf",pt).O("trun",function(m){m=K0(m.reader,m.version,m.flags),f.push(m)}).O("tfhd",function(m){m=X0(m.reader,m.flags),o=m.Kf||t.h,a=m.Mg||t.i,m=m.trackId,t.j.has(m)&&(p=t.j.get(m))}).O("tfdt",function(m){c=Ac(m.reader,m.version).baseMediaDecodeTime}).box("mdat",function(m){if(c===null)throw Le("Unable to find base media decode time for CEA captions!"),new K(2,2,2010);FC(t,m.reader,c,p,o,a,l-m.start-8,f,n)}).parse(e,!1),n};function FC(e,t,n,o,a,l,f,c,p){var m=0,v=l,S=c.map(function(I){return I.ig});for(S=[].concat.apply([],R(S)),S.length&&(v=S[0].sampleSize||l),t.skip(f+c[0].Lg);t.ia();){f=t.L();var C=t.ga(),T=null;switch(T=!1,c=1,e.g){case Nh:T=C&31,T=T==6;break;case na:c=2,t.skip(1),T=C>>1&63,T=T==39||T==40;break;default:return}if(T)for(C=0,m<S.length&&(C=S[m].Wd||0),C=(n+C)/o,c=w(cy(t.ub(f-c))),T=c.next();!T.done;T=c.next())p.push({packet:T.value,pts:C});else try{t.skip(f-c)}catch{break}v-=f+4,v==0&&(n=m<S.length?n+(S[m].hf||a):n+a,m++,m<S.length?v=S[m].sampleSize||l:v=l)}}ae("shaka.cea.Mp4CeaParser",tu);var Dh=0,Nh=1,na=2,nu={avc1:Nh,avc3:Nh,hev1:na,hvc1:na,dvh1:na,dvhe:na};vn["video/mp4"]=function(){return new tu};function iu(){}iu.prototype.init=function(){},iu.prototype.parse=function(e){var t=[];if(e=Ve(e),!Mc(e))return t;e=new wt().parse(e);var n=e.Pc(),o=e.Fd();switch(e=[],n.video){case"avc":e.push(6);break;case"hvc":e.push(39),e.push(40)}if(!e.length)return t;for(n=w(o),o=n.next();!o.done;o=n.next())if(o=o.value,e.includes(o.type)&&o.time!=null)for(var a=w(cy(o.data)),l=a.next();!l.done;l=a.next())t.push({packet:l.value,pts:o.time});return t},ae("shaka.cea.TsCeaParser",iu),vn["video/mp2t"]=function(){return new iu};function hy(e,t,n){var o=GC(e),a=null;e=[];var l=[],f=null,c=new Set(o.map(function(p){return p.keyId}));if(c.delete(null),1<c.size)throw new K(2,4,4010);if(!t){if(l=o.filter(function(p){return p.cd=="urn:mpeg:dash:sea:2012"}),1<l.length)throw new K(2,4,4050);l.length&&(f=XC(l[0])),l=o.filter(function(p){return p.cd=="urn:mpeg:dash:mp4protection:2011"?(a=p.init||a,!1):p.cd!="urn:mpeg:dash:sea:2012"}),l.length&&(e=$C(a,l,n,c),e.length==0&&(e=[ao("",a)]))}if(o.length&&!f&&(t||!l.length))for(e=[],t=w(Object.values(n)),n=t.next();!n.done;n=t.next())n=n.value,n!="org.w3.clearkey"&&e.push(ao(n,a));if(c=Array.from(c)[0]||null)for(t=w(e),n=t.next();!n.done;n=t.next())for(n=w(n.value.initData),o=n.next();!o.done;o=n.next())o.value.keyId=c;return{Jf:c,aj:a,drmInfos:e,ke:f,Nf:!0}}function zC(e,t,n,o){var a=hy(e,n,o);if(t.Nf)e=t.drmInfos.length==1&&!t.drmInfos[0].keySystem,n=a.drmInfos.length==0,(t.drmInfos.length==0||e&&!n)&&(t.drmInfos=a.drmInfos),t.Nf=!1;else if(0<a.drmInfos.length&&(t.drmInfos=t.drmInfos.filter(function(l){return a.drmInfos.some(function(f){return f.keySystem==l.keySystem})}),t.drmInfos.length==0))throw new K(2,4,4008);return a.Jf||t.Jf}function VC(e){var t=0,n=Et(e),o=n.getUint32(t,!0);if(o!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){o=n.getUint16(e,!0),e+=2;var a=n.getUint16(e,!0);if(e+=2,a&1||a+e>n.byteLength){n=[];break e}var l=Ve(n,e,a);t.push({type:o,value:l}),e+=a}n=t}return n}function HC(e){e=w(e.getElementsByTagName("DATA"));for(var t=e.next();!t.done;t=e.next()){t=w(t.value.childNodes);for(var n=t.next();!n.done;n=t.next())if(n=n.value,n instanceof Element&&n.tagName=="LA_URL")return n.textContent}return""}function ou(e){var t=Gi(e.node,"https://dashif.org/CPS","Laurl");return t&&t.textContent?t.textContent:(e=Gi(e.node,"urn:microsoft:playready","pro"),!e||(e=li(e.textContent),e=VC(e).filter(function(n){return n.type===KC})[0],!e)?"":(e=Vi(e.value,!0),(e=wr(e,"WRMHEADER"))?HC(e):""))}function $C(e,t,n,o){var a=[];t=w(t);for(var l=t.next();!l.done;l=t.next()){l=l.value;var f=n[l.cd];if(f){var c;if(c=Gi(l.node,"urn:microsoft:playready","pro")){c=li(c.textContent);var p=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);c=[{initData:ml(c,p,new Set,0),initDataType:"cenc",keyId:l.keyId}]}else c=null;if(p=null,l.cd==="urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e")if(p=o,p.size==0)p=null;else{var m=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),v=new Uint8Array([]);p=[{initData:ml(v,m,p,1),initDataType:"cenc",keyId:l.keyId}]}c=ao(f,l.init||e||c||p),(f=YC.get(f))&&(c.licenseServerUri=f(l)),a.push(c)}}return a}function GC(e){var t=[];e=w(e);for(var n=e.next();!n.done;n=e.next())(n=WC(n.value))&&t.push(n);return t}function WC(e){var t=e.getAttribute("schemeIdUri"),n=jo(e,"urn:mpeg:cenc:2013","default_KID"),o=E0(e,"urn:mpeg:cenc:2013","pssh").map(Fo);if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase(),n.includes(" ")))throw new K(2,4,4009);var a=[];try{a=o.map(function(l){return{initDataType:"cenc",initData:li(l),keyId:null}})}catch{throw new K(2,4,4007)}return{node:e,cd:t,keyId:n,init:0<a.length?a:null}}function XC(e){if(!d.crypto||!d.crypto.subtle)throw Le("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new K(2,4,4042);var t=Gi(e.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!t)throw new K(2,4,4051);if(t.getAttribute("schemeIdUri")!="urn:mpeg:dash:sea:aes128-cbc:2013")throw new K(2,4,4051);if(t=Gi(e.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod"),!t)throw new K(2,4,4051);if(e=t.getAttribute("IV"),t=t.getAttribute("keyUriTemplate"),!e||!t)throw new K(2,4,4051);if(e=Bo(e.substr(2)),e.byteLength!=16)throw new K(2,4,4048);return{zh:t,iv:e}}var KC=1,YC=new Map().set("com.widevine.alpha",function(e){var t=Gi(e.node,"https://dashif.org/CPS","Laurl");return t&&t.textContent?t.textContent:(e=Gi(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""}).set("com.microsoft.playready",ou).set("com.microsoft.playready.recommendation",ou).set("com.microsoft.playready.software",ou).set("com.microsoft.playready.hardware",ou).set("org.w3.clearkey",function(e){var t=Gi(e.node,"https://dashif.org/CPS","Laurl");return t&&t.textContent?t.textContent:(e=Gi(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&e.getAttribute("Lic_type")==="EME-1.0"&&e.textContent?e.textContent:""});function ru(e,t,n,o,a,l){var f={RepresentationID:t,Number:n,SubNumber:o,Bandwidth:a,Time:l};return e.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(c,p,m,v){if(c=="$$")return"$";var S=f[p];if(S==null)return c;switch(p=="RepresentationID"&&m&&(m=void 0),p=="Time"&&typeof S!="bigint"&&(.2<=Math.abs(S-Math.round(S))&&Le("Calculated $Time$ values must be close to integers"),S=Math.round(S)),v){case void 0:case"d":case"i":case"u":c=S.toString();break;case"o":c=S.toString(8);break;case"x":c=S.toString(16);break;case"X":c=S.toString(16).toUpperCase();break;default:c=S.toString()}return m=d.parseInt(m,10)||1,Array(Math.max(0,m-c.length)+1).join("0")+c})}function dy(e,t){var n=Di(e,t,"timescale"),o=1;n&&(o=Xi(n)||1);var a=Di(e,t,"duration");n=Xi(a||""),e.M.contentType=="image"&&(n=Ps(a||"")),n&&(n/=o);var l=Di(e,t,"startNumber");a=Number(Di(e,t,"presentationTimeOffset"))||0;var f=dn(l||"");(l==null||f==null)&&(f=1);var c=su(e,t,"SegmentTimeline");if(t=null,c){t=o,e=e.ba.duration||1/0,l=f,c=kt(c,"S");for(var p=[],m=-a,v=0;v<c.length;++v){var S=c[v],C=c[v+1],T=at(S,"t",dn),I=at(S,"d",dn),_=at(S,"r",vl);if(S=at(S,"k",vl)||0,T!=null&&(T-=a),!I)break;if(T=T??m,_=_||0,0>_)if(C){if(C=at(C,"t",dn),C==null)break;if(T>=C)break;_=Math.ceil((C-T)/I)-1}else{if(e==1/0)break;if(T/t>=e)break;_=Math.ceil((e*t-T)/I)-1}for(0<p.length&&T!=m&&(p[p.length-1].end=T/t),C=0;C<=_;++C)m=T+I,p.push({start:T/t,end:m/t,zf:T,fb:S,Vh:p.length+l}),T=m}t=p}return{timescale:o,ya:n,gd:f,vb:a/o||0,yf:a,timeline:t}}function py(e,t){return[t(e.M),t(e.oa),t(e.ta)].filter(sr)}function Di(e,t,n){t=py(e,t),e=null,t=w(t);for(var o=t.next();!o.done&&!(e=o.value.getAttribute(n));o=t.next());return e}function su(e,t,n){t=py(e,t),e=null,t=w(t);for(var o=t.next();!o.done&&!(e=ui(o.value,n));o=t.next());return e}function qC(e,t,n,o,a,l){for(var f=jo(e,"http://www.w3.org/1999/xlink","href"),c=jo(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",p=w(Array.from(e.attributes)),m=p.next();!m.done;m=p.next())m=m.value,m.namespaceURI=="http://www.w3.org/1999/xlink"&&e.removeAttributeNS(m.namespaceURI,m.localName);if(5<=l)return Do(new K(2,4,4028));if(c!="onLoad")return Do(new K(2,4,4027));var v=on([o],[f]);return a.request(0,Yt(v,t)).pa(function(S){if(S=mc(S.data,e.tagName),!S)return Do(new K(2,4,4001,f));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;S.childNodes.length;){var C=S.childNodes[0];S.removeChild(C),e.appendChild(C)}for(S=w(Array.from(S.attributes)),C=S.next();!C.done;C=S.next())e.setAttributeNode(C.value.cloneNode(!1));return au(e,t,n,v[0],a,l+1)})}function au(e,t,n,o,a,l){if(l=l===void 0?0:l,jo(e,"http://www.w3.org/1999/xlink","href")){var f=qC(e,t,n,o,a,l);return n&&(f=f.pa(void 0,function(){return au(e,t,n,o,a,l)})),f}f=[];for(var c=w(Array.from(e.childNodes)),p=c.next();!p.done;p=c.next())p=p.value,p instanceof Element&&(jo(p,"http://www.w3.org/1999/xlink","href")=="urn:mpeg:dash:resolve-to-zero:2013"?e.removeChild(p):p.tagName!="SegmentTimeline"&&f.push(au(p,t,n,o,a,l)));return c0(f).pa(function(){return e})}function QC(e,t,n,o,a,l,f){var c,p=new St().O("sidx",function(m){c=ZC(t,o,a,l,f,n,m)});if(e&&p.parse(e),c)return c;throw new K(2,3,3004)}function ZC(e,t,n,o,a,l,f){var c=[];f.reader.skip(4);var p=f.reader.L();if(p==0)throw new K(2,3,3005);if(f.version==0)var m=f.reader.L(),v=f.reader.L();else m=f.reader.oc(),v=f.reader.oc();f.reader.skip(2);var S=f.reader.Ea();for(e=e+f.size+v,v=0;v<S;v++){var C=f.reader.L(),T=(C&2147483648)>>>31;C&=2147483647;var I=f.reader.L();if(f.reader.skip(4),T==1)throw new K(2,3,3006);c.push(new Xe(m/p+n,(m+I)/p+n,function(){return l},e,e+C-1,t,n,o,a)),m+=I,e+=C}return f.parser.stop(),c}function co(e){this.h=Et(e),this.g=new vt(this.h,0)}co.prototype.ia=function(){return this.g.ia()};function eo(e){var t=gy(e);if(7<t.length)throw new K(2,3,3002);var n=0;t=w(t);for(var o=t.next();!o.done;o=t.next())n=256*n+o.value;t=gy(e);e:{o=w(JC);for(var a=o.next();!a.done;a=o.next())if(nt(t,new Uint8Array(a.value))){o=!0;break e}o=!1}if(o)t=e.h.byteLength-e.g.qa();else{if(t.length==8&&t[1]&224)throw new K(2,3,3001);for(a=o=0;a<t.length;a++){var l=t[a];o=a==0?l&(1<<8-t.length)-1:256*o+l}t=o}return t=e.g.qa()+t<=e.h.byteLength?t:e.h.byteLength-e.g.qa(),o=Et(e.h,e.g.qa(),t),e.g.skip(t),new eE(n,o)}function gy(e){var t=e.g.qa(),n=e.g.ga();if(n==0)throw new K(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),Ve(e.h,t,n)}var JC=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function eE(e,t){this.id=e,this.g=t}function Oh(e){if(8<e.g.byteLength)throw new K(2,3,3002);if(e.g.byteLength==8&&e.g.getUint8(0)&224)throw new K(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++){var o=e.g.getUint8(n);t=256*t+o}return t}function tE(e,t,n,o,a,l,f,c,p){function m(){return a}var v=[];e=new co(e.g);for(var S=null,C=null;e.ia();){var T=eo(e);if(T.id==187){var I=nE(T);I&&(T=n*I.di,I=t+I.Lh,S!=null&&v.push(new Xe(S+f,T+f,m,C,I-1,l,f,c,p)),S=T,C=I)}}return S!=null&&v.push(new Xe(S+f,o+f,m,C,null,l,f,c,p)),v}function nE(e){var t=new co(e.g);if(e=eo(t),e.id!=179)throw new K(2,3,3013);if(e=Oh(e),t=eo(t),t.id!=183)throw new K(2,3,3012);t=new co(t.g);for(var n=0;t.ia();){var o=eo(t);if(o.id==241){n=Oh(o);break}}return{di:e,Lh:n}}function my(e,t,n){if(t=su(e,t,"Initialization"),!t)return null;var o=e.M.cb(),a=t.getAttribute("sourceURL");a&&(o=on(o,[a])),a=0;var l=null;return(t=at(t,"range",yl))&&(a=t.start,l=t.end),new $n(function(){return o},a,l,wy(e),null,null,n)}function iE(e,t,n){var o=Number(Di(e,Fr,"presentationTimeOffset"))||0,a=Di(e,Fr,"timescale"),l=1;a&&(l=Xi(a)||1);var f=o/l||0,c=my(e,Fr,n);oE(e,c);var p=zp(e);return{dc:function(){var m=su(p,Fr,"RepresentationIndex"),v=p.M.cb();return m&&(m=m.getAttribute("sourceURL"))&&(v=on(v,[m])),m=vy(p),yy(p,t,c,v,m.start,m.end,f)}}}function yy(e,t,n,o,a,l,f){var c,p,m,v,S,C,T,I,_,N,j,O,X,V,q;return z(function(te){if(te.g==1)return c=e.presentationTimeline,p=!e.zb||!e.ba.Le,m=e.ba.start,v=e.ba.duration,S=e.M.mimeType.split("/")[1],C=t,T=null,I=[C(o,a,l,!1),S=="webm"?C(n.Z(),n.Qa,n.wa,!0):null],C=null,E(te,Promise.all(I),2);if(_=te.h,N=_[0],j=_[1]||null,O=null,X=m-f,V=m,q=v?m+v:1/0,S=="mp4")var de=QC(N,a,o,n,X,V,q);else{if(de=new co(j),eo(de).id!=440786851)throw new K(2,3,3008);var ce=eo(de);if(ce.id!=408125543)throw new K(2,3,3009);de=ce.g.byteOffset,ce=new co(ce.g);for(var he=null;ce.ia();){var ge=eo(ce);if(ge.id==357149030){he=ge;break}}if(!he)throw new K(2,3,3010);for(he=new co(he.g),ge=1e6,ce=null;he.ia();){var Se=eo(he);if(Se.id==2807729)ge=Oh(Se);else if(Se.id==17545)if(Se.g.byteLength==4)ce=Se.g.getFloat32(0);else if(Se.g.byteLength==8)ce=Se.g.getFloat64(0);else throw new K(2,3,3003)}if(ce==null)throw new K(2,3,3011);if(he=ge/1e9,ce*=he,ge=eo(new co(N)),ge.id!=475249515)throw new K(2,3,3007);de=tE(ge,de,he,ce,o,n,X,V,q)}return O=de,c.Xc(O),T=new ft(O),p&&T.bc(V,q,!0),te.return(T)})}function Fr(e){return e.ed}function vy(e){var t=su(e,Fr,"RepresentationIndex");return e=Di(e,Fr,"indexRange"),e=yl(e||""),t&&(e=at(t,"range",yl,e)),e}function oE(e,t){if(xy(e,t),!vy(e))throw new K(2,4,4002)}function xy(e,t){var n=e.M.mimeType.split("/")[1];if(e.M.contentType!=lt&&n!="mp4"&&n!="webm")throw new K(2,4,4006);if(n=="webm"&&!t)throw new K(2,4,4005)}function wy(e){var t=e.M;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.Td,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null}}function rE(e,t,n){var o=my(e,Sy,n),a=sE(e);if(!a.ya&&!a.timeline&&1<a.lc.length)throw new K(2,4,4002);if(!a.ya&&!e.ba.duration&&!a.timeline&&a.lc.length==1)throw new K(2,4,4002);if(a.timeline&&a.timeline.length==0)throw new K(2,4,4002);var l=null,f=null;e.ta.id&&e.M.id&&(f=t[e.ta.id+","+e.M.id])&&(l=f.segmentIndex);var c=aE(e.ba.start,e.ba.duration,e.M.cb,a,o,n);return t=!l,l?l.Wc(c,e.presentationTimeline.eb()):l=new ft(c),e.presentationTimeline.Xc(c),e.zb&&e.ba.Le||l.bc(e.ba.start,e.ba.duration?e.ba.start+e.ba.duration:1/0,t),f&&(f.segmentIndex=l),{dc:function(){return l&&l.Ab()!=0||l.Qd(c),Promise.resolve(l)}}}function Sy(e){return e.Fb}function sE(e){var t=lE(e);e=dy(e,Sy);var n=e.gd;n==0&&(n=1);var o=0;return e.ya?o=e.ya*(n-1):e.timeline&&0<e.timeline.length&&(o=e.timeline[0].start),{ya:e.ya,startTime:o,gd:n,vb:e.vb,timeline:e.timeline,lc:t}}function aE(e,t,n,o,a,l){var f=o.lc.length;o.timeline&&o.timeline.length!=o.lc.length&&(f=Math.min(o.timeline.length,o.lc.length));for(var c=e-o.vb,p=t?e+t:1/0,m=[],v=o.startTime,S={},C=0;C<f;S={Ec:S.Ec,Ac:S.Ac},C++){S.Ac=o.lc[C];var T=void 0;T=o.ya!=null?v+o.ya:o.timeline?o.timeline[C].end:v+t,S.Ec=null,m.push(new Xe(e+v,e+T,function(I){return function(){return I.Ec==null&&(I.Ec=on(n(),[I.Ac.Dh])),I.Ec}}(S),S.Ac.start,S.Ac.end,a,c,e,p,[],"",null,null,uo,l)),v=T}return m}function lE(e){return[e.M.Fb,e.oa.Fb,e.ta.Fb].filter(sr).map(function(t){return kt(t,"SegmentURL")}).reduce(function(t,n){return 0<t.length?t:n}).map(function(t){t.getAttribute("indexRange")&&!e.Wf&&(e.Wf=!0);var n=t.getAttribute("media");return t=at(t,"mediaRange",yl,{start:0,end:null}),{Dh:n,start:t.start,end:t.end}})}function uE(e,t,n,o,a,l,f){var c=dE(e,f),p=fE(e);cE(p);var m=zp(e);if(p.Uc)return xy(e,c),{dc:function(){var I=ru(p.Uc,m.M.id,null,null,m.bandwidth||null,null);return I=on(m.M.cb(),[I]),yy(m,t,c,I,0,null,p.vb)}};if(p.ya)return o||e.oa.contentType==="image"||(e.presentationTimeline.Ye(p.ya),e.presentationTimeline.Sd(e.ba.start)),{dc:function(){return hE(m,p,a,c,l,f)}};var v=null;o=o=null,e.ta.id&&e.M.id&&(o=e.ta.id+","+e.M.id,o=n[o])&&(v=o.segmentIndex);var S=e.ba.start,C=e.ba.duration?S+e.ba.duration:1/0,T=!(e.zb&&e.ba.Le);return v?(n=v,Ty(n,p,S,C,T,c),n.bb(e.presentationTimeline.eb())):v=new uu(p,e.M.id,e.bandwidth,e.M.cb,S,C,c,T,f,e.M.jf),p.timeline&&e.oa.contentType!=="image"&&e.presentationTimeline.dg(p.timeline,S),o&&e.zb&&(o.segmentIndex=v),{dc:function(){return v instanceof uu&&v.Ab()==0&&Ty(v,p,S,C,T,c),Promise.resolve(v)}}}function lu(e){return e.fd}function fE(e){var t=dy(e,lu),n=Di(e,lu,"media");return e=Di(e,lu,"index"),{ya:t.ya,timescale:t.timescale,gd:t.gd,vb:t.vb,yf:t.yf,timeline:t.timeline,mc:n,Uc:e}}function cE(e){var t=e.Uc?1:0;if(t+=e.timeline?1:0,t+=e.ya?1:0,t==0)throw new K(2,4,4002);if(t!=1&&(e.Uc&&(e.timeline=null),e.ya=null),!e.Uc&&!e.mc)throw new K(2,4,4002)}function hE(e,t,n,o,a,l){function f(ge){var Se=(ge-I)*T,ke=Se+t.vb,Ne=Se+v;Se=Ne+T;var He=Math.min(Se,p());return Ne=new Xe(Ne,He,function(){var Ge=ke*_;return"BigInt"in d&&Ge>Number.MAX_SAFE_INTEGER&&(Ge=BigInt(ke)*BigInt(_)),Ge=ru(N,O,ge,null,j,Ge),on(X(),[Ge])},0,null,o,V,v,p(),[],"",null,null,uo,l),Ne.h=Se,Ne}function c(){var ge=[Math.max(m.eb(),v),Math.min(m.Bb(),p())].map(function(Se){return Se-v});return[Math.ceil(ge[0]/T),Math.ceil(ge[1]/T)-1].map(function(Se){return Se+I})}function p(){var ge=S!=null&&a[S]||C;return ge?v+ge:1/0}var m=e.presentationTimeline,v=e.ba.start,S=e.ta.id,C=e.ba.duration,T=t.ya,I=t.gd,_=t.timescale,N=t.mc,j=e.bandwidth||null,O=e.M.id,X=e.M.cb,V=v-t.vb,q=c();e=e.zb?Math.max(q[0],q[1]-n+1):q[0],q=q[1],n=[];for(var te=e;te<=q;++te){var de=f(te);n.push(de)}var ce=new ft(n);if(n=m.Bb()<p(),te=m.R(),n||te){var he=Math.max(e,q+1);ce.Yd(T,function(){var ge=m.eb();ce.bb(ge);var Se=w(c());Se.next(),Se=Se.next().value;for(var ke=[];he<=Se;){var Ne=f(he);ke.push(Ne),he++}return ge>p()&&!ke.length?null:ke})}return Promise.resolve(ce)}function dE(e,t){var n=Di(e,lu,"initialization");if(!n)return null;var o=e.M.id,a=e.bandwidth||null,l=e.M.cb;return new $n(function(){var f=ru(n,o,null,null,a,null);return on(l(),[f])},0,null,wy(e),null,null,t)}function uu(e,t,n,o,a,l,f,c,p,m){ft.call(this,[]),this.h=e,this.F=t,this.A=n,this.C=o,this.i=a,this.l=l,this.s=f,this.u=p,this.G=m,c&&Cy(this)}Z(uu,ft),s=uu.prototype,s.Ab=function(){return this.h?this.h.timeline.length:0},s.release=function(){ft.prototype.release.call(this),this.h=null},s.bb=function(e){if(this.h){for(var t=0,n=this.h.timeline,o=0;o<n.length&&n[o].end+this.i<=e;o+=1)t+=1;0<t&&(this.h.timeline=n.slice(t),this.g.length>=t&&(this.g=this.g.slice(t)),this.j+=t,this.Ab()===0&&this.release())}};function Ty(e,t,n,o,a,l){if(e.s=l,e.h){n=e.h.timeline,e.h.mc=t.mc;var f=n[n.length-1];t=t.timeline.filter(function(c){return c.start>=f.end}),0<t.length&&e.h.timeline.push.apply(e.h.timeline,R(t)),e.l!==o&&(e.l=o)}else e.h=t,e.i=n,e.l=o;a&&Cy(e)}function Cy(e){if(!e.o){for(var t=e.h.timeline;t.length&&t[t.length-1].start>=e.l;)t.pop();e.bb(e.i)}}s.find=function(e){if(this.h&&this.h.timeline&&this.h.timeline.length&&e<this.h.timeline[0].start+this.i)return this.j;if(!this.h)return null;var t=this.h.timeline;if(e<this.i||e>=this.l)return null;for(var n=t.length-1,o=0;o<t.length;o++){var a=t[o],l=a.start+this.i;if(a=o<n?t[o+1].start+this.i:this.l===1/0?a.end+this.i:this.l,e>=l&&e<a)return o+this.j}return null},s.get=function(e){var t=this;if(e-=this.j,0>e||e>=this.Ab()||!this.h)return null;var n=this.g[e];if(!n){var o=this.h.mc,a=this.h.timeline[e],l=a.Vh,f=this.h.yf+a.zf;n=this.i-this.h.vb;var c=this.i+a.end,p=c;e===this.Ab()-1&&this.l!==1/0&&(p=this.l);for(var m=[],v=(a.end-a.start)/a.fb,S={},C=0;C<a.fb;S={Fc:S.Fc,fe:S.fe},C++){var T=a.start+v*C,I=T+v;S.fe=C+1,S.Fc=null,T=new Xe(this.i+T,this.i+I,function(_){return function(){return t.h?(_.Fc==null&&(_.Fc=Ey(t.h.mc,t.F,l,t.A,f,_.fe,t.C)),_.Fc):[]}}(S),0,null,this.s,n,this.i,this.l,[],"",null,null,uo,this.u),this.G==0?0<C&&T.Od():C%this.G!=0&&T.Od(),m.push(T)}n=new Xe(this.i+a.start,p,function(){return 0<a.fb?[]:Ey(o,t.F,l,t.A,f,null,t.C)},0,null,this.s,n,this.i,this.l,m,"",null,null,uo,this.u,0<a.fb),n.h=c,this.g[e]=n}return n};function Ey(e,t,n,o,a,l,f){return e=ru(e,t,n,l,o||null,a),on(f(),[e]).map(function(c){return c.toString()})}function ia(e){this.o=null,this.u=e,this.G=new pr,this.j=[],this.h=null,this.m=[],this.A=null,this.F=[],this.C=300,this.l=new Map,this.i=new Map,this.g=null,this.s="UNKNOWN"}ia.prototype.configure=function(e){this.o=e},ia.prototype.destroy=function(){return this.u=this.o=null,this.j=[],this.h=null,this.m=[],this.F=[],this.l.clear(),this.g!=null&&(this.g.stop(),this.g=null),this.G.destroy()},ia.prototype.setManifestType=function(e){this.s=e};function oa(e,t){var n,o,a,l,f,c,p;return z(function(m){if(m.g==1)return n=on(e.j,[pE(e,t)]),o=Yt(n,e.o.retryParameters),a=e.u.networkingEngine.request(8,o),No(e.G,a),re(m,2),E(m,a.promise,4);if(m.g!=2)return l=m.h,f=It(l.data),c=JSON.parse(f),c.VERSION==1&&gE(e,c,l.uri),ie(m,0);if((p=se(m))&&p.code==7001)return m.return();e.g!=null&&(e.g.stop(),e.g=null),e.g=new st(function(){oa(e,t)}),e.g.U(e.C),F(m)})}function pE(e,t){if(!e.m.length)return t;t=new Bt(t);var n=e.A||e.m[0],o=Math.round(e.u.getBandwidthEstimate()),a=t.g;return e.s=="DASH"?(a.add("_DASH_pathway",n),a.add("_DASH_throughput",String(o))):e.s=="HLS"&&(a.add("_HLS_pathway",n),a.add("_HLS_throughput",String(o))),Np(a)&&Ts(t,a),t.toString()}function gE(e,t,n){e.g!=null&&(e.g.stop(),e.g=null);var o=t["RELOAD-URI"]||n;e.g=new st(function(){oa(e,o)}),(n=t.TTL)&&(e.C=n),e.g.U(e.C),e.m=t["PATHWAY-PRIORITY"]||[],e.F=t["PATHWAY-CLONES"]||[]}function zr(e,t,n,o){var a=e.l.get(t);a||(a=new Map),a.set(n,o),e.l.set(t,a)}function ra(e,t,n){n=n===void 0?!1:n,t=e.l.get(t)||new Map;for(var o=[],a={},l=w(e.m),f=l.next();!f.done;a={Jb:a.Jb},f=l.next())if(a.Jb=f.value,f=t.get(a.Jb))o.push({df:a.Jb,location:f});else if(f=e.F.find(function(p){return function(m){return m.vi==p.Jb}}(a))){var c=t.get(f["BASE-ID"]);c&&(f["URI-REPLACEMENT"].xg?(c=new Bt(c),Xa(c,f["URI-REPLACEMENT"].xg),o.push({df:a.Jb,location:c.toString()})):o.push({df:a.Jb,location:c}))}for(a=Date.now(),l=w(e.i.keys()),f=l.next();!f.done;f=l.next())f=f.value,c=e.i.get(f),a>c&&e.i.delete(f);if(o=o.filter(function(p){for(var m=w(e.i.keys()),v=m.next();!v.done;v=m.next())if(v.value.includes(new Bt(p.location).ob))return!1;return!0}),o.length&&(e.A=o[0].df),o=o.map(function(p){return p.location}),!o.length&&e.h)for(a=w(e.h.split(",")),f=a.next();!f.done;f=a.next())(l=t.get(f.value))&&(e.A=e.h,o.push(l));if(!o.length)for(t=w(t.values()),a=t.next();!a.done;a=t.next())o.push(a.value);return n?o:on(e.j,o)}function di(){this.j=[],this.h=[],this.g=[],this.l=[],this.i=[],this.m=!1,this.o=new Set}s=di.prototype,s.release=function(){for(var e=w(this.h.concat(this.g,this.l,this.i)),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();this.h=[],this.g=[],this.l=[],this.i=[],this.j=[]},s.mh=function(){return this.j},s.Ie=function(){return this.l.slice()},s.Vg=function(){return this.i};function Ay(e,t){var n=[],o=[],a=[],l=[];e=w(e);for(var f=e.next();!f.done;f=e.next()){var c=f.value;f=new Map(c.audioStreams.map(function(S){return[jh(S),S]}));var p=new Map(c.videoStreams.map(function(S){return[Bh(S),S]})),m=new Map(c.textStreams.map(function(S){return[ua(S),S]}));if(c=new Map(c.imageStreams.map(function(S){return[fa(S),S]})),t){var v=Ry(lt);m.set(ua(v),v),v=Ry("image"),c.set(fa(v),v)}n.push(f),o.push(p),a.push(m),l.push(c)}return{Df:n,vg:o,sg:a,Vf:l}}s.Gf=function(e,t){var n=this,o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X,V,q,te,de,ce,he,ge,Se,ke,Ne,He,Ge;return z(function(Ze){if(Ze.g==1){if(o=Gt,!t&&e.length==1)return a=Ay(e,!1),l=a.Df,f=a.vg,c=a.sg,p=a.Vf,n.h=Array.from(l[0].values()),n.g=Array.from(f[0].values()),n.l=Array.from(c[0].values()),n.i=Array.from(p[0].values()),Ze.B(2);for(m=-1,v=0;v<e.length;v++)S=e[v],n.o.has(S.id)||(n.o.add(S.id),m==-1&&(m=v));return m==-1?Ze.return():(C=Ay(e,!0),T=C.Df,I=C.vg,_=C.sg,N=C.Vf,E(Ze,Promise.all([ho(n,n.h,T,m,sa,Vr),ho(n,n.g,I,m,sa,Vr),ho(n,n.l,_,m,sa,Vr),ho(n,n.i,N,m,sa,Vr)]),2))}if(j=0,O=[],n.g.length&&n.h.length)for(ce=w(n.h),he=ce.next();!he.done;he=ce.next())for(ge=he.value,Se=w(n.g),ke=Se.next();!ke.done;ke=Se.next())Ne=ke.value,He=xc(ge.drmInfos,Ne.drmInfos),ge.drmInfos.length&&Ne.drmInfos.length&&!He.length||(Ge=j++,O.push({id:Ge,language:ge.language,disabledUntilTime:0,primary:ge.primary,audio:ge,video:Ne,bandwidth:(ge.bandwidth||0)+(Ne.bandwidth||0),drmInfos:He,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(X=n.g.length?n.g:n.h,V=w(X),q=V.next();!q.done;q=V.next())te=q.value,de=j++,O.push({id:de,language:te.language,disabledUntilTime:0,primary:te.primary,audio:te.type==o.P?te:null,video:te.type==o.$?te:null,bandwidth:te.bandwidth||0,drmInfos:te.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});n.j=O,F(Ze)})};function by(e){var t,n,o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X,V,q,te,de,ce,he,ge,Se,ke,Ne,He;return z(function(Ge){switch(Ge.g){case 1:if(t=Gt,e.length==1)return Ge.return(e[0]);for(n=e.map(function(Ze){return new Map(Ze.filter(function(Oe){return Oe.type===t.P}).map(function(Oe){return[jh(Oe),Oe]}))}),o=e.map(function(Ze){return new Map(Ze.filter(function(Oe){return Oe.type===t.$}).map(function(Oe){return[Bh(Oe),Oe]}))}),a=e.map(function(Ze){return new Map(Ze.filter(function(Oe){return Oe.type===t.na}).map(function(Oe){return[ua(Oe),Oe]}))}),l=e.map(function(Ze){return new Map(Ze.filter(function(Oe){return Oe.type===t.he}).map(function(Oe){return[fa(Oe),Oe]}))}),f=w(a),c=f.next();!c.done;c=f.next())p=c.value,m=_y(t.na),p.set(ua(m),m);for(v=w(l),S=v.next();!S.done;S=v.next())C=S.value,T=_y(t.he),C.set(fa(T),T);return I=new di,E(Ge,ho(I,[],n,0,fu,cu),2);case 2:return _=Ge.h,E(Ge,ho(I,[],o,0,fu,cu),3);case 3:return N=Ge.h,E(Ge,ho(I,[],a,0,fu,cu),4);case 4:return j=Ge.h,E(Ge,ho(I,[],l,0,fu,cu),5);case 5:if(O=Ge.h,X=0,N.length&&_.length)for(ce=w(_),he=ce.next();!he.done;he=ce.next())for(ge=he.value,Se=w(N),ke=Se.next();!ke.done;ke=Se.next())Ne=ke.value,He=X++,Ne.variantIds.push(He),ge.variantIds.push(He);else for(V=N.concat(_),q=w(V),te=q.next();!te.done;te=q.next())de=te.value,de.variantIds=[X++];return Ge.return(N.concat(_).concat(j).concat(O))}})}function ho(e,t,n,o,a,l){var f,c,p,m,v,S,C,T,I,_,N,j,O,X,V,q,te,de;return z(function(ce){switch(ce.g){case 1:for(f=[],c=0;c<o;c++)f.push(new Set);for(p=o;p<n.length;p++)f.push(new Set(n[p].values()));m=w(t),v=m.next();case 2:if(v.done){ce.B(4);break}return S=v.value,E(ce,mE(e,S,n,o,l,f),5);case 5:if(C=ce.h,!C)throw new K(2,4,4037);v=m.next(),ce.B(2);break;case 4:for(T=w(f),I=T.next();!I.done;I=T.next())for(_=I.value,N=w(_),j=N.next();!j.done;j=N.next())O=j.value,(X=yE(e,O,n,a,l,f))&&t.push(X);for(V=w(f),I=V.next();!I.done;I=V.next())for(q=I.value,te={},de=w(q),j=de.next();!j.done;te={od:te.od},j=de.next())if(te.od=j.value,!Py(te.od)&&t.some(function(he){return function(ge){return Uh(e,he.od,ge)}}(te)))throw new K(2,4,4037);return ce.return(t)}})}function mE(e,t,n,o,a,l){return z(function(f){return f.g==1?(My(e,n,t),t.matchedStreams?t.segmentIndex?E(f,Iy(t,o),2):f.B(2):f.return(!1)):(ky(t,o,a,l),f.return(!0))})}function Iy(e,t){var n,o,a,l,f,c,p;return z(function(m){if(m.g==1){for(n=[],o=e.matchedStreams,a=w(o),l=a.next();!l.done;l=a.next())f=l.value,n.push(f.createSegmentIndex()),f.trickModeVideo&&!f.trickModeVideo.segmentIndex&&n.push(f.trickModeVideo.createSegmentIndex());return E(m,Promise.all(n),2)}if(e.segmentIndex instanceof jt)for(c={},p=t;p<o.length;c={jb:c.jb},p++)c.jb=o[p],c.jb.segmentIndex&&(Oc(c.jb.segmentIndex,function(v){return function(S){S.codecs=v.jb.codecs,S.mimeType=v.jb.mimeType,S.aa&&(S.aa.codecs=v.jb.codecs,S.aa.mimeType=v.jb.mimeType)}}(c)),e.segmentIndex.h.push(c.jb.segmentIndex));F(m)})}function yE(e,t,n,o,a,l){if(Py(t))return null;var f=o(t);return My(e,n,f),f.createSegmentIndex&&(f.createSegmentIndex=function(){return z(function(c){return f.segmentIndex?c.B(0):(f.segmentIndex=new jt,E(c,Iy(f,0),0))})}),!f.matchedStreams||!f.matchedStreams.length?null:(ky(f,0,a,l),f)}function ky(e,t,n,o){for(var a=e.matchedStreams;t<a.length;t++){var l=a[t];n(e,l);var f=!0;if(e.type=="audio"&&Ro(e.language,l.language)==0&&(f=!1),f){o[t].delete(l),f=new Set(e.codecs.split(",")),l=w(l.codecs.split(","));for(var c=l.next();!c.done;c=l.next())(c=c.value)&&f.add(c);c=Array.from(f),f=new Set,l=[],c=w(c);for(var p=c.next();!p.done;p=c.next()){p=p.value;var m=xi(p);f.has(m)||(l.push(p),f.add(m))}e.codecs=l.join(",")}}}function sa(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var n=w(t.matchedStreams),o=n.next();!o.done;o=n.next())o=o.value,o.segmentIndex&&(o.segmentIndex.release(),o.segmentIndex=null)},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set,t.closedCaptions=null,t.trickModeVideo=null,t}function fu(e){return e=Object.assign({},e),e.roles=e.roles.slice(),e.keyIds=new Set,e.segments=[],e.variantIds=[],e.closedCaptions=null,e}function Vr(e,t){function n(f,c){f||(f=[]),c=w(c);for(var p=c.next();!p.done;p=c.next())p=p.value,f.includes(p)||f.push(p);return f}e.roles=n(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=n(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var o=w(t.keyIds),a=o.next();!a.done;a=o.next())e.keyIds.add(a.value);if(e.originalId==null?e.originalId=t.originalId:e.originalId+=","+(t.originalId||""),o=xc(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!o.length)throw new K(2,4,4038);if(e.drmInfos=o,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),o=w(t.closedCaptions),a=o.next();!a.done;a=o.next()){var l=w(a.value);a=l.next().value,l=l.next().value,e.closedCaptions.set(a,l)}t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=sa(t.trickModeVideo),e.trickModeVideo.createSegmentIndex=function(){return e.trickModeVideo.segmentIndex=e.segmentIndex.clone(),Promise.resolve()}),Vr(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&Vr(e.trickModeVideo,t)}function cu(e,t){var n=e.roles;n||(n=[]);for(var o=w(t.roles),a=o.next();!a.done;a=o.next())a=a.value,n.includes(a)||n.push(a);for(e.roles=n,n=w(t.keyIds),o=n.next();!o.done;o=n.next())e.keyIds.add(o.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,R(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),t=w(t.closedCaptions),n=t.next();!n.done;n=t.next())o=w(n.value),n=o.next().value,o=o.next().value,e.closedCaptions.set(n,o)}function My(e,t,n){var o=[];t=w(t);for(var a=t.next();!a.done;a=t.next()){if(a=vE(e,a.value,n),!a)return;o.push(a)}n.matchedStreams=o}function vE(e,t,n){var o=null,a=(0,{audio:jh,video:Bh,text:ua,image:fa}[n.type])(n);if(t.has(a))o=t.get(a);else{a={audio:function(c,p){return Uh(e,c,p)},video:function(c,p){return Uh(e,c,p)},text:xE,image:wE}[n.type];var l={audio:SE,video:TE,text:CE,image:EE}[n.type];t=w(t.values());for(var f=t.next();!f.done;f=t.next())f=f.value,!a(n,f)||n.fastSwitching!=f.fastSwitching||o&&!l(n,o,f)||(o=f)}return o}function aa(e,t){function n(o){if(!Fh.has(o)){var a=oi(o);Fh.set(o,a)}return Fh.get(o)}return e.mimeType!=t.mimeType?!1:n(e.codecs)==n(t.codecs)}function Uh(e,t,n){return!(!aa(t,n)&&!e.m||t.drmInfos&&!U0(t.drmInfos,n.drmInfos))}function xE(e,t){return t.language?!(e.forced!==t.forced||Ro(e.language,t.language)==0||t.kind!=e.kind):!0}function wE(){return!0}function SE(e,t,n){var o=aa(e,t),a=aa(e,n);if(o&&!a)return!1;if(!o&&a||(o=Ro(e.language,t.language),a=Ro(e.language,n.language),a>o))return!0;if(a<o)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}return e.roles.length?(o=t.roles.filter(function(l){return e.roles.includes(l)}),a=n.roles.filter(function(l){return e.roles.includes(l)}),a.length>o.length?!0:a.length<o.length?!1:n.roles.length<t.roles.length):!n.roles.length&&t.roles.length?!0:n.roles.length&&!t.roles.length?!1:!t.primary&&n.primary?!0:t.primary&&!n.primary?!1:(o=la(e.channelsCount,t.channelsCount,n.channelsCount),o==Ci?!0:o==to?!1:(o=la(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate),o==Ci?!0:o==to?!1:!!(e.bandwidth&&Ly(e.bandwidth,t.bandwidth,n.bandwidth)==Ci)))}function TE(e,t,n){var o=aa(e,t),a=aa(e,n);if(o&&!a)return!1;if(!o&&a||(o=la(e.width*e.height,t.width*t.height,n.width*n.height),o==Ci))return!0;if(o==to)return!1;if(e.frameRate){if(o=la(e.frameRate,t.frameRate,n.frameRate),o==Ci)return!0;if(o==to)return!1}return!!(e.bandwidth&&Ly(e.bandwidth,t.bandwidth,n.bandwidth)==Ci)}function CE(e,t,n){var o=Ro(e.language,t.language),a=Ro(e.language,n.language);if(a>o)return!0;if(a<o)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(o=t.roles.filter(function(l){return e.roles.includes(l)}),a=n.roles.filter(function(l){return e.roles.includes(l)}),a.length>o.length)return!0;if(a.length<o.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!(n.mimeType!=e.mimeType||n.codecs!=e.codecs||t.mimeType==e.mimeType&&t.codecs==e.codecs)}function EE(e,t,n){return la(e.width*e.height,t.width*t.height,n.width*n.height)==Ci}function _y(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1}}function Ry(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new ft([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1}}function la(e,t,n){if(t==e&&e!=n)return to;if(n==e&&e!=t)return Ci;if(t>e){if(n<=e||n-e<t-e)return Ci;if(n-e>t-e)return to}else{if(n>e)return to;if(e-n<e-t)return Ci;if(e-n>e-t)return to}return Dy}function Ly(e,t,n){return t=Math.abs(e-t),e=Math.abs(e-n),e<t?Ci:t<e?to:Dy}function Py(e){switch(e.type){case lt:return!e.language;case"image":return!e.tilesLayout;default:return!1}}function Bh(e){return JSON.stringify([e.fastSwitching,e.width,e.frameRate,e.codecs,e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth])}function jh(e){return JSON.stringify([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,e.codecs,e.mimeType,e.roles,e.audioSamplingRate,e.primary])}function ua(e){return JSON.stringify([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])}function fa(e){return JSON.stringify([e.width,e.codecs,e.mimeType])}ae("shaka.util.PeriodCombiner",di),di.prototype.combinePeriods=di.prototype.Gf,di.prototype.getImageStreams=di.prototype.Vg,di.prototype.getTextStreams=di.prototype.Ie,di.prototype.getVariants=di.prototype.mh;var Ci=1,Dy=0,to=-1,Fh=new Map;function hu(){var e=this;this.i=this.h=null,this.o=[],this.j=null,this.I=1,this.m={},this.K={},this.l=new di,this.F=0,this.H=new Be(5),this.G=new st(function(){RE(e)}),this.C=new pr,this.u=null,this.J=[],this.A=1/0,this.s=!1,this.g=null}s=hu.prototype,s.configure=function(e){this.h=e,this.g&&this.g.configure(this.h),this.l&&(this.l.m=this.h.dash.multiTypeVariantsAllowed&&Ot())},s.start=function(e,t){var n=this,o;return z(function(a){if(a.g==1)return n.s=t.isLowLatencyMode(),n.o=[e],n.i=t,E(a,zh(n),2);if(o=a.h,n.i&&Vh(n,o),!n.i)throw new K(2,7,7001);return a.return(n.j)})},s.stop=function(){for(var e=w(Object.values(this.m)),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();return this.l&&this.l.release(),this.h=this.i=null,this.o=[],this.j=null,this.m={},this.l=null,this.G!=null&&(this.G.stop(),this.G=null),this.g&&this.g.destroy(),this.C.destroy()},s.update=function(){var e=this,t;return z(function(n){if(n.g==1)return re(n,2),E(n,zh(e),4);if(n.g!=2)return ie(n,0);if(t=se(n),!e.i||!t)return n.return();e.i.onError(t),F(n)})},s.onExpirationUpdated=function(){},s.onInitialVariantChosen=function(e){if(this.j&&this.j.presentationTimeline.R()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.j.presentationTimeline.Bb();var n=t.segmentIndex.find(e);n!=null&&(t=t.segmentIndex.get(n))&&(this.F=t.endTime-e,Vh(this,0))}}},s.banLocation=function(e){this.g&&this.g.i.set(e,Date.now()+6e4)};function zh(e){var t,n,o,a,l,f,c;return z(function(p){return p.g==1?(t=e.o,1<e.o.length&&e.g&&(n=ra(e.g,"Location",!0),n.length&&(t=n)),o=Yt(t,e.h.retryParameters),a=Date.now(),E(p,$h(e,o,0,{type:4}),2)):p.g!=3?(l=p.h,e.i?(l.uri&&l.uri!=l.originalUri&&!e.o.includes(l.uri)&&e.o.unshift(l.uri),E(p,AE(e,l.data,l.uri),3)):p.return(0)):(f=Date.now(),c=(f-a)/1e3,e.H.sample(1,c),p.return(c))})}function AE(e,t,n){var o,a,l,f;return z(function(c){if(c.g==1){if(o=mc(t,"MPD"),!o)throw new K(2,4,4001,n);return e.h.dash.disableXlinkProcessing?c.return(Ny(e,o,n)):(a=e.h.dash.xlinkFailGracefully,l=au(o,e.h.retryParameters,a,n,e.i.networkingEngine),No(e.C,l),E(c,l.promise,2))}return f=c.h,c.return(Ny(e,f,n))})}function Ny(e,t,n){var o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X,V,q,te,de,ce,he,ge,Se,ke,Ne,He,Ge,Ze,Oe,zt,Qt,pi,mn,Ai,gt,In,yn,jn,Vt,qr,mo,Qo,Qr,bi,Zo,Zr,yo,Jr,vo,Oi,Ea,es;return z(function(no){switch(no.g){case 1:for((o=e.h.dash.manifestPreprocessor)&&o(t),e.g&&e.g.l.clear(),a=[n],l=[],f=new Map,c=kt(t,"Location"),p=w(c),m=p.next();!m.done;m=p.next())v=m.value,S=v.getAttribute("serviceLocation"),(C=Fo(v))&&(T=on(a,[C])[0],S&&(e.g?zr(e.g,"Location",S,T):f.set(S,T)),l.push(T));if(e.g?(I=ra(e.g,"Location",!0),0<I.length&&(a=e.o=I)):l.length&&(a=e.o=l),_=Promise.resolve(),(N=ui(t,"ContentSteering"))&&e.i)for(j=N.getAttribute("defaultServiceLocation"),e.g?(e.g.j=a,e.g.h=j):(e.g=new ia(e.i),e.g.configure(e.h),e.g.setManifestType("DASH"),e.g.j=a,e.g.h=j,(O=Fo(N))&&(at(N,"queryBeforeStart",gc,!1)?_=oa(e.g,O):oa(e.g,O))),X=w(f.keys()),V=X.next();!V.done;V=X.next())q=V.value,te=f.get(q),zr(e.g,"Location",q,te);if(de=kt(t,"BaseURL"),he=!1,e.g)for(ge=w(de),Se=ge.next();!Se.done;Se=ge.next())ke=Se.value,Ne=ke.getAttribute("serviceLocation"),He=Fo(ke),Ne&&He&&(zr(e.g,"BaseURL",Ne,He),he=!0);if(he&&e.g||(Ge=de.map(Fo),ce=on(a,Ge)),Ze=function(){return e.g&&he?ra(e.g,"BaseURL"):ce||[]},Oe=0,de&&de.length&&(Oe=at(de[0],"availabilityTimeOffset",Ps)||0),zt=e.h.dash.ignoreMinBufferTime,Qt=0,zt||(Qt=at(t,"minBufferTime",Wi)||0),e.F=at(t,"minimumUpdatePeriod",Wi,-1),pi=at(t,"availabilityStartTime",A0),mn=at(t,"timeShiftBufferDepth",Wi),Ai=e.h.dash.ignoreSuggestedPresentationDelay,gt=null,Ai||(gt=at(t,"suggestedPresentationDelay",Wi)),In=e.h.dash.ignoreMaxSegmentDuration,yn=null,In||(yn=at(t,"maxSegmentDuration",Wi)),jn=t.getAttribute("type")||"static",e.j)for(Vt=e.j.presentationTimeline,qr=w(Object.values(e.m)),mo=qr.next();!mo.done;mo=qr.next())Qo=mo.value,Qo.segmentIndex&&Qo.segmentIndex.bb(Vt.eb());else Qr=e.h.defaultPresentationDelay||1.5*Qt,bi=gt??Qr,Vt=new Je(pi,bi,e.h.dash.autoCorrectDrift);return Vt.pc(jn=="static"),Vt.R()&&!isNaN(e.h.availabilityWindowOverride)&&(mn=e.h.availabilityWindowOverride),mn==null&&(mn=1/0),Vt.Xd(mn),Zo=t.getAttribute("profiles")||"",Zr={zb:jn!="static",presentationTimeline:Vt,ta:null,ba:null,oa:null,M:null,bandwidth:0,Wf:!1,ac:Oe,profiles:Zo.split(",")},yo=IE(e,Zr,Ze,t),Jr=yo.duration,vo=yo.periods,jn!="static"&&yo.Lf||Vt.Pa(Jr||1/0),e.A&&!e.s&&e.i.isAutoLowLatencyMode()&&(e.i.enableLowLatencyMode(),e.s=e.i.isLowLatencyMode()),e.s?Vt.lg(e.A):e.A&&Le("Low-latency DASH live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),Vt.Ye(yn||1),E(no,e.l.Gf(vo,Zr.zb),2);case 2:return E(no,_,3);case 3:if(e.s&&(Qt=0),e.j){e.j.variants=e.l.j,Oi=e.l.Ie(),0<Oi.length&&(e.j.textStreams=Oi),e.j.imageStreams=e.l.i,e.i.filter(e.j),no.B(4);break}if(e.j={presentationTimeline:Vt,variants:e.l.j,textStreams:e.l.Ie(),imageStreams:e.l.i,offlineSessionIds:[],minBufferTime:Qt||0,sequenceMode:e.h.dash.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:bE(t)},!Vt.ug()){no.B(5);break}return Ea=kt(t,"UTCTiming"),E(no,NE(e,Ze,Ea),6);case 6:if(es=no.h,!e.i)return no.return();Vt.mg(es);case 5:Vt.Nd();case 4:e.i.makeTextStreamsForClosedCaptions(e.j),F(no)}})}function bE(e){if(e=ui(e,"ServiceDescription"),!e)return null;var t=ui(e,"Latency"),n=ui(e,"PlaybackRate");if(t&&t.getAttribute("max")||n){e=t&&t.getAttribute("max")?parseInt(t.getAttribute("max"),10)/1e3:null;var o=n?parseFloat(n.getAttribute("max")):null;return t=t&&t.getAttribute("min")?parseInt(t.getAttribute("min"),10)/1e3:null,n=n?parseFloat(n.getAttribute("min")):null,{maxLatency:e,maxPlaybackRate:o,minLatency:t,minPlaybackRate:n}}return null}function IE(e,t,n,o){var a=at(o,"mediaPresentationDuration",Wi),l=[],f=0;o=kt(o,"Period");for(var c=0;c<o.length;c++){var p=o[c],m=o[c+1],v=at(p,"start",Wi,f),S=p.id,C=at(p,"duration",Wi),T=null;if(m){var I=at(m,"start",Wi);I!=null&&(T=I-v)}else a!=null&&(T=a-v);if(T==null&&(T=C),!(e.u!==null&&S!==null&&v!==null&&v<e.u)||e.J.includes(S)||c+1==o.length){if(v!==null&&(e.u===null||v>e.u)&&(e.u=v),f=kE(e,t,n,{start:v,duration:T,node:p,Le:T==null||!m}),l.push(f),t.ta.id&&T&&(e.K[t.ta.id]=T),T==null){f=null;break}f=v+T}}return e.J=l.map(function(_){return _.id}),a!=null?{periods:l,duration:a,Lf:!1}:{periods:l,duration:f,Lf:!0}}function kE(e,t,n,o){t.ta=Hh(e,o.node,null,n),t.ba=o,t.ta.ac=t.ac,t.ta.id||(t.ta.id="__shaka_period_"+o.start);var a=kt(o.node,"EventStream");n=t.presentationTimeline.eb(),a=w(a);for(var l=a.next();!l.done;l=a.next())OE(e,o.start,o.duration,l.value,n);if(n=kt(o.node,"AdaptationSet").map(function(v){return ME(e,t,v)}).filter(sr),t.zb){for(o=[],a=w(n),l=a.next();!l.done;l=a.next()){l=w(l.value.Ph);for(var f=l.next();!f.done;f=l.next())o.push(f.value)}if(o.length!=new Set(o).size)throw new K(2,4,4018)}for(o=n.filter(function(v){return!v.wf}),n=n.filter(function(v){return v.wf}),n=w(n),a=n.next();!a.done;a=n.next()){a=a.value,l=a.wf.split(" "),f=w(o);for(var c=f.next();!c.done;c=f.next()){var p=c.value;if(l.includes(p.id)){c={},p=w(p.streams);for(var m=p.next();!m.done;c={pd:c.pd},m=p.next())c.pd=m.value,c.pd.trickModeVideo=a.streams.find(function(v){return function(S){return oi(v.pd.codecs)==oi(S.codecs)}}(c))}}}if(n=du(e.h.disableAudio,o,"audio"),a=du(e.h.disableVideo,o,"video"),l=du(e.h.disableText,o,lt),o=du(e.h.disableThumbnails,o,"image"),a.length===0&&n.length===0)throw new K(2,4,4004);return{id:t.ta.id,audioStreams:n,videoStreams:a,textStreams:l,imageStreams:o}}function du(e,t,n){return e||!t.length?[]:t.reduce(function(o,a){return a.contentType!=n||o.push.apply(o,R(a.streams)),o},[])}function ME(e,t,n){function o(ce){switch(ce){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}t.oa=Hh(e,n,t.ta,null);var a=!1,l=kt(n,"Role"),f=l.map(function(ce){return ce.getAttribute("value")}).filter(sr),c=void 0,p=t.oa.contentType==lt;p&&(c="subtitle"),l=w(l);for(var m=l.next();!m.done;m=l.next()){m=m.value;var v=m.getAttribute("schemeIdUri");if(v==null||v=="urn:mpeg:dash:role:2011")switch(m=m.getAttribute("value"),m){case"main":a=!0;break;case"caption":case"subtitle":c=m}}var S;v=kt(n,"EssentialProperty"),l=null;var C=!1;m=!1,v=w(v);for(var T=v.next();!T.done;T=v.next()){T=T.value;var I=T.getAttribute("schemeIdUri");I=="http://dashif.org/guidelines/trickmode"?l=T.getAttribute("value"):I=="urn:mpeg:mpegB:cicp:TransferCharacteristics"?S=o(parseInt(T.getAttribute("value"),10)):I!="urn:mpeg:mpegB:cicp:ColourPrimaries"&&I!="urn:mpeg:mpegB:cicp:MatrixCoefficients"&&(I=="urn:mpeg:dash:ssr:2023"?C=!0:m=!0)}for(v=kt(n,"SupplementalProperty"),v=w(v),T=v.next();!T.done;T=v.next())T=T.value,T.getAttribute("schemeIdUri")=="urn:mpeg:mpegB:cicp:TransferCharacteristics"&&(S=o(parseInt(T.getAttribute("value"),10)));v=kt(n,"Accessibility");var _=new Map,N;for(v=w(v),T=v.next();!T.done;T=v.next())if(I=T.value,T=I.getAttribute("schemeIdUri"),I=I.getAttribute("value"),T=="urn:scte:dash:cc:cea-608:2015")if(T=1,I!=null){I=I.split(";");for(var j=w(I),O=j.next();!O.done;O=j.next()){var X=O.value,V=O=void 0;X.includes("=")?(X=X.split("="),O=X[0].startsWith("CC")?X[0]:"CC"+X[0],V=X[1]||"und"):(O="CC"+T,I.length==2?T+=2:T++,V=X),_.set(O,ht(V))}}else _.set("CC1","und");else if(T=="urn:scte:dash:cc:cea-708:2015")if(T=1,I!=null)for(I=w(I.split(";")),O=I.next();!O.done;O=I.next())O=O.value,X=j=void 0,O.includes("=")?(O=O.split("="),j="svc"+O[0],X=O[1].split(",")[0].split(":").pop()):(j="svc"+T,T++,X=O),_.set(j,ht(X));else _.set("svc1","und");else T=="urn:mpeg:dash:role:2011"?I!=null&&(f.push(I),I=="captions"&&(c="caption")):T=="urn:tva:metadata:cs:AudioPurposeCS:2007"&&(I=="1"?N="visually impaired":I=="2"&&(N="hard of hearing"));if(m)return null;m=kt(n,"ContentProtection");var q=hy(m,e.h.dash.ignoreDrmInfo,e.h.dash.keySystemsByURI),te=ht(t.oa.language||"und"),de=n.getAttribute("label");if((m=kt(n,"Label"))&&m.length&&(m=m[0],m.textContent&&(de=m.textContent)),m=kt(n,"Representation"),n=m.map(function(ce){return(ce=_E(e,t,q,c,te,de,a,f,_,ce,N))&&(ce.hdr=ce.hdr||S,ce.fastSwitching=C),ce}).filter(function(ce){return!!ce}),n.length==0){if(l=t.oa.contentType=="image",e.h.dash.ignoreEmptyAdaptationSet||p||l)return null;throw new K(2,4,4003)}if(!t.oa.contentType||t.oa.contentType=="application")for(t.oa.contentType=Uy(n[0].mimeType,n[0].codecs),p=w(n),T=p.next();!T.done;T=p.next())T.value.type=t.oa.contentType;for(p=t.oa.id||"__fake__"+e.I++,v=w(n),T=v.next();!T.done;T=v.next()){for(T=T.value,I=w(q.drmInfos),j=I.next();!j.done;j=I.next())j=j.value,j.keyIds=j.keyIds&&T.keyIds?new Set([].concat(R(j.keyIds),R(T.keyIds))):j.keyIds||T.keyIds;e.h.dash.enableAudioGroups&&(T.groupId=p)}return m=m.map(function(ce){return ce.getAttribute("id")}).filter(sr),{id:p,contentType:t.oa.contentType,language:te,bj:a,streams:n,drmInfos:q.drmInfos,wf:l,Ph:m}}function _E(e,t,n,o,a,l,f,c,p,m,v){if(t.M=Hh(e,m,t.oa,null),e.A=Math.min(e.A,t.M.ac),!DE(t.M))return null;var S=t.ba.start;t.bandwidth=at(m,"bandwidth",Xi)||0;var C=t.M.contentType,T=C==lt||C=="application";C=C=="image";try{var I=void 0;if(n.ke){var _=t.M.cb,N=on(_(),[n.ke.zh]),j=Yt(N,e.h.retryParameters);I={method:"AES-128",iv:n.ke.iv,firstMediaSequenceNumber:0,fetchKey:function(){var he,ge,Se;return z(function(ke){if(ke.g==1)return E(ke,$h(e,j,6),2);if(ke.g!=3){if(he=ke.h,!he.data||he.data.byteLength!=16)throw new K(2,4,4049);return ge={name:"AES-CBC"},Se=I,E(ke,d.crypto.subtle.importKey("raw",he.data,ge,!0,["decrypt"]),3)}Se.cryptoKey=ke.h,I.fetchKey=void 0,F(ke)})}}}if(_=function(he,ge,Se,ke){return UE(e,he,ge,Se,ke)},t.M.ed)var O=iE(t,_,I);else if(t.M.Fb)O=rE(t,e.m,I);else if(t.M.fd)O=uE(t,_,e.m,!!e.j,e.h.dash.initialSegmentLimit,e.K,I);else{var X=t.ba.duration||0,V=t.M.cb;O={dc:function(){return Promise.resolve(Uc(S,X,V()))}}}}catch(he){if((T||C)&&he.code==4002)return null;throw he}_=kt(m,"ContentProtection"),_=zC(_,n,e.h.dash.ignoreDrmInfo,e.h.dash.keySystemsByURI),_=new Set(_?[_]:[]),N=!1,kt(m,"SupplementalProperty").some(function(he){return he.getAttribute("schemeIdUri")=="tag:dolby.com,2018:dash:EC3_ExtensionType:2018"&&he.getAttribute("value")=="JOC"})&&(N=!0);var q=!1;T&&(q=c.includes("forced_subtitle")||c.includes("forced-subtitle"));var te;if(C&&((m=kt(m,"EssentialProperty").find(function(he){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(he.getAttribute("schemeIdUri"))}))&&(te=m.getAttribute("value")),!te))return null;var de;m=t.M.codecs,t.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(m.includes("hvc1.2.4.L153.B0")||m.includes("hev1.2.4.L153.B0"))&&(de="PQ"),m=t.M.id?t.ta.id+","+t.M.id:"";var ce=m&&e.m[m]?e.m[m]:{id:e.I++,originalId:t.M.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){ce.segmentIndex&&(ce.segmentIndex.release(),ce.segmentIndex=null)},segmentIndex:null,mimeType:t.M.mimeType,codecs:t.M.codecs,frameRate:t.M.frameRate,pixelAspectRatio:t.M.pixelAspectRatio,bandwidth:t.bandwidth,width:t.M.width,height:t.M.height,kind:o,encrypted:0<n.drmInfos.length,drmInfos:n.drmInfos,keyIds:_,language:a,originalLanguage:t.oa.language,label:l,type:t.oa.contentType,primary:f,trickModeVideo:null,emsgSchemeIdUris:t.M.emsgSchemeIdUris,roles:c,forced:q,channelsCount:t.M.Td,audioSamplingRate:t.M.audioSamplingRate,spatialAudio:N,closedCaptions:p,hdr:de,videoLayout:void 0,tilesLayout:te,accessibilityPurpose:v,external:!1,fastSwitching:!1};return ce.createSegmentIndex=function(){var he;return z(function(ge){if(ge.g==1)return ce.segmentIndex?ge.B(0):(he=ce,E(ge,O.dc(),3));he.segmentIndex=ge.h,F(ge)})},m&&t.zb&&!e.m[m]&&(e.m[m]=ce),ce}function RE(e){var t,n;z(function(o){switch(o.g){case 1:return t=0,re(o,2),E(o,zh(e),4);case 4:t=o.h,ie(o,3);break;case 2:if(n=se(o),e.i){if(e.h.raiseFatalErrorOnManifestUpdateRequestFailure)return e.i.onError(n),o.return();n.severity=1,e.i.onError(n)}case 3:if(!e.i)return o.return();e.i.onManifestUpdated(),Vh(e,t),F(o)}})}function Vh(e,t){0>e.F||e.G.U(Math.max(e.F-t,Y(e.H)))}function Hh(e,t,n,o){n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,Td:null,audioSamplingRate:null,ac:0,jf:0},o=o||n.cb;var a=t.getAttribute("id"),l=kt(t,"BaseURL"),f,c=!1;if(e.g)for(var p=w(l),m=p.next();!m.done;m=p.next()){var v=m.value;m=v.getAttribute("serviceLocation"),v=Fo(v),m&&v&&(zr(e.g,a,m,v),c=!0)}c&&e.g||(f=l.map(Fo)),p=t.getAttribute("contentType")||n.contentType,m=t.getAttribute("mimeType")||n.mimeType,v=t.getAttribute("codecs")||n.codecs;var S=at(t,"frameRate",Lw)||n.frameRate,C=t.getAttribute("sar")||n.pixelAspectRatio,T=LE(kt(t,"InbandEventStream"),n.emsgSchemeIdUris),I=kt(t,"AudioChannelConfiguration");I=PE(I)||n.Td;var _=at(t,"audioSamplingRate",dn)||n.audioSamplingRate;p||(p=Uy(m,v));var N=ui(t,"SegmentBase"),j=ui(t,"SegmentTemplate"),O=N&&at(N,"availabilityTimeOffset",Ps)||0,X=j&&at(j,"availabilityTimeOffset",Ps)||0,V=l&&l.length&&at(l[0],"availabilityTimeOffset",Ps)||0;return O=n.ac+V+O+X,X=null,(V=ui(t,"SegmentSequenceProperties"))&&(V=ui(V,"SAP"))&&(X=at(V,"cadence",vl)),{cb:function(){return on(o(),l.length?e.g&&c?ra(e.g,a):f||[]:[])},ed:N||n.ed,Fb:ui(t,"SegmentList")||n.Fb,fd:j||n.fd,width:at(t,"width",dn)||n.width,height:at(t,"height",dn)||n.height,contentType:p,mimeType:m,codecs:v,frameRate:S,pixelAspectRatio:C,emsgSchemeIdUris:T,id:a,language:t.getAttribute("lang"),Td:I,audioSamplingRate:_,ac:O,jf:X||n.jf}}function LE(e,t){t=t.slice(),e=w(e);for(var n=e.next();!n.done;n=e.next())n=n.value.getAttribute("schemeIdUri"),t.includes(n)||t.push(n);return t}function PE(e){e=w(e);for(var t=e.next();!t.done;t=e.next()){var n=t.value;if((t=n.getAttribute("schemeIdUri"))&&(n=n.getAttribute("value")))switch(t){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(t=parseInt(n,10),!t)continue;return t;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(t=parseInt(n,16),!t)continue;for(e=0;t;)t&1&&++e,t>>=1;return e;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(t=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(n=parseInt(n,10))&&0<n&&n<t.length)return t[n]}}return null}function DE(e){var t=e.ed?1:0;return t+=e.Fb?1:0,t+=e.fd?1:0,t==0?e.contentType==lt||e.contentType=="application":(t!=1&&(e.ed&&(e.Fb=null),e.fd=null),!0)}function Oy(e,t,n,o){var a,l,f,c,p,m;return z(function(v){if(v.g==1)return a=on(t(),[n]),l=Yt(a,e.h.retryParameters),l.method=o,f=e.i.networkingEngine.request(4,l),No(e.C,f),E(v,f.promise,2);if(c=v.h,o=="HEAD"){if(!c.headers||!c.headers.date)return v.return(0);p=c.headers.date}else p=It(c.data);return m=Date.parse(p),isNaN(m)?v.return(0):v.return(m-Date.now())})}function NE(e,t,n){var o,a,l,f,c,p,m,v;return z(function(S){switch(S.g){case 1:o=n.map(function(C){return{scheme:C.getAttribute("schemeIdUri"),value:C.getAttribute("value")}}),a=e.h.dash.clockSyncUri,!o.length&&a&&o.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:a}),l=w(o),f=l.next();case 2:if(f.done){S.B(4);break}switch(c=f.value,re(S,5),p=c.scheme,m=c.value,p){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return S.B(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return S.B(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return v=Date.parse(m),S.return(isNaN(v)?0:v-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":Le("NTP UTCTiming scheme is not supported");break;default:Le("Unrecognized scheme in UTCTiming element",p)}S.B(9);break;case 7:return E(S,Oy(e,t,m,"HEAD"),10);case 10:return S.return(S.h);case 8:return E(S,Oy(e,t,m,"GET"),11);case 11:return S.return(S.h);case 9:ie(S,3);break;case 5:se(S);case 3:f=l.next(),S.B(2);break;case 4:return Le("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),S.return(0)}})}function OE(e,t,n,o,a){var l=o.getAttribute("schemeIdUri")||"",f=o.getAttribute("value")||"",c=at(o,"timescale",dn)||1;o=w(kt(o,"Event"));for(var p=o.next();!p.done;p=o.next()){p=p.value;var m=at(p,"presentationTime",dn)||0,v=at(p,"duration",dn)||0;m=m/c+t,v=m+v/c,n!=null&&(m=Math.min(m,t+n),v=Math.min(v,t+n)),v<a||(p={schemeIdUri:l,value:f,startTime:m,endTime:v,id:p.getAttribute("id")||"",eventElement:p},e.i.onTimelineRegionAdded(p))}}function UE(e,t,n,o,a){var l,f,c,p;return z(function(m){return m.g==1?(l=Li,f=a?0:1,c=Rl(t,n,o,e.h.retryParameters),E(m,$h(e,c,l,{type:f}),2)):(p=m.h,m.return(p.data))})}function Uy(e,t){return t=Rn(e,t),Ya(t)?lt:e.split("/")[0]}function $h(e,t,n,o){return t=e.i.networkingEngine.request(n,t,o),No(e.C,t),t.promise}ae("shaka.dash.DashParser",hu),fi["application/dash+xml"]=function(){return new hu},fi["video/vnd.mpeg.dash.mpd"]=function(){return new hu};function pu(){}ae("shaka.dependencies",pu),pu.has=function(e){return Gh.has(e)},pu.add=function(e,t){if(!jy[e])throw Error(e+" is not supported");e==By?ai("mux.js","mux.js is no longer used in Shaka Player."):Gh.set(e,function(){return t})};var By="muxjs",jy={cj:By,ISOBoxer:"ISOBoxer"};pu.Allowed=jy;var Gh=new Map([["ISOBoxer",function(){return d.ISOBoxer}]]);function Fy(e,t,n){this.type=e,this.g=t,this.segments=n||null}function Wh(e,t,n,o){this.id=e,this.name=t,this.g=n,this.value=o===void 0?null:o}Wh.prototype.toString=function(e){function t(a){return a.name+"="+(isNaN(Number(a.value))?'"'+a.value+'"':a.value)}var n="#"+this.name,o=this.g?this.g.filter(function(a){return e?!e.has(a.name):!0}).map(t):[];return this.value&&o.unshift(this.value),0<o.length&&(n+=":"+o.join(",")),n};function zy(e){var t=new Set().add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI");return e.toString(t)}Wh.prototype.getAttribute=function(e){var t=this.g.filter(function(n){return n.name==e});return t.length?t[0]:null};function Fe(e,t,n){return(e=e.getAttribute(t))?e.value:n||null}function Dt(e,t){if(e=e.getAttribute(t),!e)throw new K(2,4,4023,t);return e.value}function Vy(e,t,n){n=n===void 0?[]:n,this.g=t,this.h=e,this.fb=n}function Hy(e,t){this.name=e,this.value=t}function Ei(e,t){return e.filter(function(n){return n.name==t})}function $y(e,t){return e.filter(function(n){return Dt(n,"TYPE")==t})}function rn(e,t){e=w(e);for(var n=e.next();!n.done;n=e.next())if(n=n.value,n.name===t)return n;return null}function Hr(e,t,n){return n=n===void 0?0:n,(e=rn(e,t))?Number(e.value):n}function Wo(e,t,n){return t?Gy(e,[t],n):[]}function Gy(e,t,n){if(!t.length)return[];t=on(e,t),e=[],t=w(t);for(var o=t.next();!o.done;o=t.next()){var a=e,l=a.push,f=o.value;if((o=n)&&o.size){f=String(f).replace(/%7B/g,"{").replace(/%7D/g,"}");var c=f.match(/{\$\w*}/g);if(c){c=w(c);for(var p=c.next();!p.done;p=c.next()){p=p.value;var m=p.slice(2,p.length-1),v=o.get(m);if(v)f=f.replace(p,v);else throw new K(2,4,4039,m)}}o=f}else o=f;l.call(a,o)}return e}function Xo(e){this.h=e||"",this.g=0}function $r(e){po(e,/[ \t]+/gm)}function po(e,t){return t.lastIndex=e.g,t=t.exec(e.h),t=t==null?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||t==null||t.position!=e.g?null:(e.g+=t.length,t.results)}function Ko(e){return e.g==e.h.length?null:(e=po(e,/[^ \t\n]*/gm))?e[0]:null}function BE(){this.g=0}function Xh(e,t){t=It(t),t=t.replace(/\r\n|\r(?=[^\n]|$)/gm,`
`).trim();var n=t.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new K(2,4,4015);t=0;for(var o=!0,a=w(n),l=a.next();!l.done;l=a.next())if(l=l.value,/^#(?!EXT)/m.test(l)||o)o=!1;else if(l=Kh(e,l),--e.g,Wy.includes(l.name)){t=1;break}else l.name=="EXT-X-STREAM-INF"&&(o=!0);for(a=[],o=!0,l=0;l<n.length;l++){var f=n[l],c=n[l+1];if(/^#(?!EXT)/m.test(f)||o)o=!1;else{if(f=Kh(e,f),jE.includes(f.name)){if(t!=1)throw new K(2,4,4017);f=n.splice(l,n.length-l),n=[],o=[],l=[],c=null,f=w(f);for(var p=f.next();!p.done;p=f.next())p=p.value,/^(#EXT)/.test(p)?(p=Kh(e,p),Wy.includes(p.name)?a.push(p):p.name=="EXT-X-MAP"?c=p:p.name=="EXT-X-PART"?l.push(p):p.name=="EXT-X-PRELOAD-HINT"?Fe(p,"TYPE")=="PART"?l.push(p):Fe(p,"TYPE")=="MAP"&&(p.name="EXT-X-MAP",c=p):o.push(p)):/^#(?!EXT)/m.test(p)||(p=p.trim(),c&&o.push(c),n.push(new Vy(p,o,l)),o=[],l=[]);return l.length&&(c&&o.push(c),n.push(new Vy("",o,l))),new Fy(t,a,n)}a.push(f),f.name=="EXT-X-STREAM-INF"&&(f.g.push(new Hy("URI",c)),o=!0)}}return new Fy(t,a)}function Kh(e,t){e=e.g++;var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new K(2,4,4016,t);t=n[1];var o=n[2];n=[];var a;if(o){o=new Xo(o);var l;(l=po(o,/^([^,=]+)(?:,|$)/g))&&(a=l[1]);for(var f=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;l=po(o,f);)n.push(new Hy(l[1],l[2]||l[3])),$r(o)}return new Wh(e,t,n,a)}var Wy="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF".split(" "),jE="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP".split(" ");function Xy(){}function Ky(e){try{var t=Yh(e);return dr({uri:e,originalUri:e,data:t.data,headers:{"content-type":t.contentType}})}catch(n){return Do(n)}}function Yh(e){var t=e.split(":");if(2>t.length||t[0]!="data")throw new K(2,1,1004,e);if(t=t.slice(1).join(":").split(","),2>t.length)throw new K(2,1,1004,e);var n=t[0];e=d.decodeURIComponent(t.slice(1).join(",")),t=n.split(";"),n=t[0];var o=!1;1<t.length&&t[t.length-1]=="base64"&&(o=!0,t.pop());var a;return o?a=li(e):a=Hi(e),{data:a,contentType:n}}ae("shaka.net.DataUriPlugin",Xy),Xy.parse=Ky,zi("data",Ky);function Yy(e){var t=ji(e),n=t.split("/")[0];return e=ri(e),{type:n,mimeType:t,codecs:e,language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map}}function FE(e,t){function n(_){return o(_.name)}function o(_){switch(_=_.toLowerCase(),_){case"avc1":case"avc3":a.push(_+".42E01E"),f=!0;break;case"hev1":case"hvc1":a.push(_+".1.6.L93.90"),f=!0;break;case"dvh1":case"dvhe":a.push(_+".05.04"),f=!0;break;case"vp09":a.push(_+".00.10.08"),f=!0;break;case"av01":a.push(_+".0.01M.08"),f=!0;break;case"mp4a":a.push("mp4a.40.2"),l=!0;break;case"ac-3":case"ec-3":case"opus":case"flac":a.push(_),l=!0}}var a=[],l=!1,f=!1,c=null,p=null,m=null,v=null,S=null;if(new St().box("moov",pt).box("trak",pt).O("tkhd",function(_){_=Y0(_.reader,_.version),p=String(_.height),m=String(_.width)}).box("mdia",pt).O("mdhd",function(_){c=Sl(_.reader,_.version).language}).box("minf",pt).box("stbl",pt).O("stsd",yr).box("mp4a",function(_){var N=_.reader;N.skip(6),N.skip(2),N.skip(8);var j=N.Ea();N.skip(2),N.skip(2),N.skip(2),N=N.Ea()+N.Ea()/65536,v=j,S=N,_.reader.ia()?pt(_):n(_)}).box("esds",function(_){_=rS(_.reader),a.push(_.ha),l=!0}).box("ac-3",n).box("ec-3",n).box("opus",n).box("Opus",n).box("fLaC",n).box("avc1",function(_){_=q0(_.reader,_.name),a.push(_.ha),f=!0}).box("avc3",function(_){_=q0(_.reader,_.name),a.push(_.ha),f=!0}).box("hev1",n).box("hvc1",n).box("dvh1",n).box("dvhe",n).box("vp09",n).box("av01",n).box("enca",pl).box("encv",pl).box("sinf",pt).box("frma",function(_){_=Q0(_.reader).ha,o(_)}).parse(e||t,!0),!a.length)return null;var C=l&&!f,T=new Map;if(f){var I=new nn("video/mp4");for(e&&I.init(e),I.i(t),e=w(I.j()),t=e.next();!t.done;t=e.next())t=t.value,T.set(t,t);I.h()}return{type:C?"audio":"video",mimeType:C?"audio/mp4":"video/mp4",codecs:zE(a).join(", "),language:c,height:p,width:m,channelCount:v,sampleRate:S,closedCaptions:T}}function zE(e){var t=new Set,n=[];e=w(e);for(var o=e.next();!o.done;o=e.next()){o=o.value;var a=xi(o);t.has(a)||(n.push(o),t.add(a))}return n}function gu(){var e=this;this.g=this.i=null,this.u=1,this.o=new Map,this.H=new Map,this.J=new Map,this.J.set("video",new Map),this.J.set("audio",new Map),this.J.set(lt,new Map),this.J.set("image",new Map),this.Ba=new Set,this.h=new Map,this.l=null,this.Y="",this.za=new BE,this.I=-1,this.V=1/0,this.da=this.mb=!1,this.s=new st(function(){fA(e)}),this.ea=vu,this.C=null,this.Aa=0,this.m=1/0,this.ma=this.ka=this.K=0,this.N=new pr,this.F=new Map,this.G=new Map,this.W=new Map,this.lb=this.A=!1,this.kb=new Be(5),this.j=null}s=gu.prototype,s.configure=function(e){this.g=e,this.j&&this.j.configure(this.g)},s.start=function(e,t){var n=this,o;return z(function(a){return a.g==1?(n.i=t,n.A=t.isLowLatencyMode(),E(a,nd(n,[e]),2)):a.g!=3?(o=a.h,n.Y=o.uri,E(a,GE(n,o.data,e),3)):a.return(n.C)})},s.stop=function(){this.s&&(this.s.stop(),this.s=null);var e=[];return this.N&&(e.push(this.N.destroy()),this.N=null),this.g=this.i=null,this.Ba.clear(),this.C=null,this.h.clear(),this.H.clear(),this.G.clear(),this.o.clear(),this.W.clear(),this.j&&this.j.destroy(),Promise.all(e)},s.update=function(){var e=this,t,n,o,a,l,f,c,p,m;return z(function(v){if(v.g==1){if(!Pn(e))return v.return();for(t=[],n=Array.from(e.h.values()),e.m=1/0,o=n.filter(function(S){return S.stream.segmentIndex}),a=w(o),l=a.next();!l.done;l=a.next())f=l.value,t.push(VE(e,f));return E(v,Promise.all(t),2)}r1(e,o.map(function(S){return S.stream})),c=o.some(function(S){return S.Sc==0}),o.length&&!c&&(p=cA,yu(e,p.zg),m=o.map(function(S){return S.rb}),e.l.Pa(Math.min.apply(Math,R(m))),e.i.updateDuration()),c&&Qh(e),F(v)})};function qh(e,t){return Pn(e)?e.J.get(t.type):t.Pd}function VE(e,t){var n,o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X,V,q,te,de,ce,he,ge,Se,ke,Ne,He;return z(function(Ge){if(Ge.g==1){for(n=[],o=w(t.Z()),a=o.next();!a.done;a=o.next())l=a.value,f=new Bt(l),c=f.g,t.sd&&(0<=t.Xa&&c.add("_HLS_msn",String(t.Xa)),0<=t.Ya&&c.add("_HLS_part",String(t.Ya))),t.td&&c.add("_HLS_skip","YES"),Np(c)&&Ts(f,c),n.push(f.toString());return E(Ge,nd(e,n,!0),2)}if(p=Ge.h,!t.stream.segmentIndex)return Ge.return();if(m=Xh(e.za,p.data),m.type!=1)throw new K(2,4,4017);v=p.uri,v==p.originalUri||t.Z().includes(v)||t.gg.push(v),S=Ei(m.g,"EXT-X-DEFINE"),C=Zy(e,S,v),T=t.stream,I=qh(e,t),_=u1(m,T.mimeType),N=_.keyIds,j=_.drmInfos,O=function(Ze,Oe){return Ze.size===Oe.size&&[].concat(R(Ze)).every(function(zt){return Oe.has(zt)})},O(T.keyIds,N)||(T.keyIds=N,T.drmInfos=j,e.i.newDrmInfo(T)),X=p1(e,m,T,I,C,t.Z),V=X.segments,(q=X.bandwidth)&&(T.bandwidth=q),T.segmentIndex.Wc(V,e.l.eb()),V.length&&(te=Hr(m.g,"EXT-X-MEDIA-SEQUENCE",0),ce=(de=rn(m.g,"EXT-X-SKIP"))?Number(Fe(de,"SKIPPED-SEGMENTS")):0,he=a1(te,V),ge=he.Xa,Se=he.Ya,t.Xa=ge+ce,t.Ya=Se,ke=I.get(te),T.segmentIndex.bb(ke)),Ne=V[0],t.Sb=Ne.startTime,He=V[V.length-1],t.rb=He.endTime,rn(m.g,"EXT-X-ENDLIST")&&(t.Sc=!0),Jh(e,m),F(Ge)})}s.onExpirationUpdated=function(){},s.onInitialVariantChosen=function(){},s.banLocation=function(e){this.j&&this.j.i.set(e,Date.now()+6e4)};function HE(e,t){for(var n=e.I==-1,o=w(t),a=o.next();!a.done;a=o.next()){a=a.value;var l=a.stream.segmentIndex,f=qh(e,a);if(l=l.g[0]||null){f=w(f);for(var c=f.next();!c.done;c=f.next()){c=w(c.value);var p=c.next().value;if(c.next().value==l.startTime){n&&(e.I=Math.max(e.I,p)),a.qe=p;break}}}}if(!(0>e.I))for(t=w(t),a=t.next();!a.done;a=t.next())n=a.value,(o=n.stream.segmentIndex)&&(o.g.splice(0,e.I-n.qe),(o=o.g[0]||null)&&(o=-o.startTime,n.stream.segmentIndex.offset(o),qy(e,n,o)))}function $E(e,t){if(e.V==1/0){t=w(t);for(var n=t.next();!n.done;n=t.next()){var o=n.value.stream.segmentIndex.g[0]||null;o!=null&&o.ca!=null&&(e.V=Math.min(e.V,o.ca))}}if(t=e.V,t!=1/0)for(o=w(e.h.values()),n=o.next();!n.done;n=o.next()){n=n.value;var a=n.stream.segmentIndex;if(a!=null){var l=a.g[0]||null;if(l.ca==null)De("Missing EXT-X-PROGRAM-DATE-TIME for stream",n.Z(),"Expect AV sync issues!");else for(qy(e,n,l.ca-t-l.startTime),n=w(a),a=n.next();!a.done;a=n.next())a.value.tf(t)}}}function qy(e,t,n){t.Sb+=n,t.rb+=n,e=qh(e,t);for(var o=w(e),a=o.next();!a.done;a=o.next()){var l=w(a.value);a=l.next().value,l=l.next().value,e.set(a,l+n)}t.Z()}function GE(e,t,n){var o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X,V,q,te,de,ce,he,ge,Se,ke,Ne,He,Ge,Ze;return z(function(Oe){switch(Oe.g){case 1:return o=Xh(e.za,t),a=Ei(o.g,"EXT-X-DEFINE"),l=[],f=[],c=[],o.type==1?(_=function(){return[n]},E(Oe,Qy(e,o,_),6)):(WE(e,a),p=Ei(o.g,"EXT-X-MEDIA"),m=Ei(o.g,"EXT-X-STREAM-INF"),v=Ei(o.g,"EXT-X-IMAGE-STREAM-INF"),S=Ei(o.g,"EXT-X-I-FRAME-STREAM-INF"),C=Ei(o.g,"EXT-X-SESSION-KEY"),T=Ei(o.g,"EXT-X-SESSION-DATA"),I=Ei(o.g,"EXT-X-CONTENT-STEERING"),KE(e,T),E(Oe,YE(e,I),4));case 4:return XE(e,m),nA(e,p),l=JE(e,m,C,p),f=qE(e,p),E(Oe,QE(e,v,S),5);case 5:c=Oe.h,Oe.B(3);break;case 6:return N=Oe.h,j=N.type,O=N.mimeType,X=N.codecs,V=N.language,q=N.height,te=N.width,de=N.channelCount,ce=N.sampleRate,he=N.closedCaptions,E(Oe,s1(e,e.u++,o,_,n,X,j,V,!0,"Media Playlist",de,he,null,!1,ce,!1,O),7);case 7:ge=Oe.h,e.h.set(n,ge),j=="video"&&g1(ge.stream,te,q,null,null,null),l.push({id:0,language:ht(V||"und"),disabledUntilTime:0,primary:!0,audio:j=="audio"?ge.stream:null,video:j=="video"?ge.stream:null,bandwidth:ge.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.i)throw new K(2,7,7001);if(e.l=new Je(null,0),e.l.pc(!0),o.type==1&&(Pn(e)&&(c1(e,o),Se=e.m,e.s.U(Se)),ke=Array.from(e.h.values()),Zh(e,ke),Qh(e)),e.C={presentationTimeline:e.l,variants:l,textStreams:f,imageStreams:c,offlineSessionIds:[],minBufferTime:0,sequenceMode:e.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:e.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null},e.da||!e.g.hls.disableCodecGuessing){Oe.B(8);break}for(Ne=[],He=w(e.C.variants),Ge=He.next();!Ge.done;Ge=He.next())Ze=Ge.value,Ze.audio&&Ze.audio.codecs===""&&Ne.push(Ze.audio.createSegmentIndex()),Ze.video&&Ze.video.codecs===""&&Ne.push(Ze.video.createSegmentIndex());return E(Oe,Promise.all(Ne),8);case 8:e.i.makeTextStreamsForClosedCaptions(e.C),F(Oe)}})}function Qy(e,t,n){var o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X,V;return z(function(q){switch(q.g){case 1:if(o=Yy(e.g.hls.mediaPlaylistFullMimeType),!t.segments.length)return q.return(o);if(a=Math.trunc((t.segments.length-1)/2),l=t.segments[a],f=Wo(n(),t.segments[0].h),c=f[0],p=new Bt(c),m=p.Ga.split(".").pop(),v=m1[m])return q.return(Yy(v));if(S=Li,C=null,T=h1(e,t,l.g,n),e.W.clear(),!T){q.B(2);break}return I=Rl(T.Z(),T.ic(),T.fc(),e.g.retryParameters),E(q,Gr(e,I,S,{type:0}),3);case 3:_=q.h,C=_.data;case 2:return N=Yt(f,e.g.retryParameters),E(q,Gr(e,N,S,{type:1}),4);case 4:if(j=q.h,(O=j.headers["content-type"])&&(O=O.split(";")[0].toLowerCase()),m=="ts"||O=="video/mp2t"){var te=j.data,de=Ve(te);de=new wt().parse(de);var ce=de.Pc();de=de.Je();var he=[],ge=!1,Se=!1;switch(ce.audio){case"aac":he.push("mp4a.40.2"),ge=!0;break;case"mp3":he.push("mp4a.40.34"),ge=!0;break;case"ac3":he.push("ac-3"),ge=!0;break;case"ec3":he.push("ec-3"),ge=!0}switch(ce.video){case"avc":de.ha?he.push(de.ha):he.push("avc1.42E01E"),Se=!0;break;case"hvc":de.ha?he.push(de.ha):he.push("hvc1.1.6.L93.90"),Se=!0}if(he.length){if(ce=ge&&!Se,ge=new Map,Se){Se=new nn("video/mp2t"),Se.i(te),te=w(Se.j());for(var ke=te.next();!ke.done;ke=te.next())ke=ke.value,ge.set(ke,ke);Se.h()}de={type:ce?"audio":"video",mimeType:"video/mp2t",codecs:he.join(", "),language:null,height:de.height,width:de.width,channelCount:null,sampleRate:null,closedCaptions:ge}}else de=null;if(X=de)return q.return(X)}else if((m=="mp4"||m=="cmfv"||m=="m4s"||O=="video/mp4"||O=="audio/mp4"||O=="video/iso.segment")&&(V=FE(C,j.data)))return q.return(V);return q.return(o)}})}function Qh(e){if(Pn(e)){if(e.ea==xu){var t=rA(e);e.g.hls.useSafariBehaviorForLive&&(t=e.l.o),isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.l.Xd(t)}if(!e.l.m){t=Array.from(e.h.values()).filter(function(o){return o.stream.segmentIndex}),t=w(t);for(var n=t.next();!n.done;n=t.next())n=n.value,(n.type=="audio"||n.type=="video")&&(n=n.stream.segmentIndex.get(0))&&n.ca&&e.l.qf(n.ca)}}else e.l.Pa(o1(e));e.l.Nd()}function WE(e,t){var n=new Bt(e.Y).g;t=w(t);for(var o=t.next();!o.done;o=t.next()){var a=o.value;o=Fe(a,"NAME");var l=Fe(a,"VALUE");a=Fe(a,"QUERYPARAM"),o&&l&&(e.o.has(o)||e.o.set(o,l)),a&&(o=n.get(a)[0])&&!e.o.has(o)&&e.o.set(a,o)}}function Zy(e,t,n){n=new Bt(n).g;var o=new Map;t=w(t);for(var a=t.next();!a.done;a=t.next()){var l=a.value,f=Fe(l,"NAME"),c=Fe(l,"VALUE");a=Fe(l,"QUERYPARAM"),l=Fe(l,"IMPORT"),f&&c&&(o.has(f)||o.set(f,c)),a&&(f=n.get(a)[0])&&!o.has(f)&&o.set(a,f),l&&(a=e.o.get(l))&&o.set(l,a)}return o}function XE(e,t){t=w(t);for(var n=t.next();!n.done;n=t.next()){var o=n.value,a=Fe(o,"AUDIO");n=Fe(o,"VIDEO");var l=Fe(o,"SUBTITLES");if(o=Jy(e,o),l){var f=Sn(lt,o);e.G.set(l,f),wn(o,f)}a&&(l=Sn("audio",o),l||(l=e.g.hls.defaultAudioCodec),e.G.set(a,l)),n&&(a=Sn("video",o),a||(a=e.g.hls.defaultVideoCodec),e.G.set(n,a))}}function KE(e,t){t=w(t);for(var n=t.next();!n.done;n=t.next()){var o=n.value,a=Fe(o,"DATA-ID");n=Fe(o,"URI");var l=Fe(o,"LANGUAGE");o=Fe(o,"VALUE"),a=new Map().set("id",a),n&&a.set("uri",Wo([e.Y],n,e.o)[0]),l&&a.set("language",l),o&&a.set("value",o),n=new We("sessiondata",a),e.i&&e.i.onEvent(n)}}function YE(e,t){var n,o,a,l,f,c;return z(function(p){if(!e.i||!e.g)return p.return();for(o=w(t),a=o.next();!a.done;a=o.next())if(l=a.value,f=Fe(l,"PATHWAY-ID"),c=Fe(l,"SERVER-URI"),f&&c){e.j=new ia(e.i),e.j.configure(e.g),e.j.j=[e.Y],e.j.setManifestType("HLS"),e.j.h=f,n=oa(e.j,c);break}return E(p,n,0)})}function qE(e,t){var n=$y(t,"SUBTITLES");t=n.map(function(f){if(e.g.disableText)return null;try{return i1(e,[f],new Map).stream}catch(c){if(e.g.hls.ignoreTextStreamFailures)return null;throw c}}),n=w(n);for(var o=n.next();!o.done;o=n.next()){var a=Dt(o.value,"GROUP-ID");if((o=e.G.get(a))&&(a=e.H.get(a))){a=w(a);for(var l=a.next();!l.done;l=a.next())l=l.value,l.stream.codecs=o,l.stream.mimeType=ed(lt,o)||td(lt)}}return t.filter(function(f){return f})}function QE(e,t,n){var o,a;return z(function(l){return l.g==1?(o=t.map(function(f){var c,p;return z(function(m){if(m.g==1)return e.g.disableThumbnails?m.return(null):(re(m,2),E(m,iA(e,f),4));if(m.g!=2)return c=m.h,m.return(c.stream);if(p=se(m),e.g.hls.ignoreImageStreamFailures)return m.return(null);throw p})}).concat(n.map(function(f){if(e.g.disableThumbnails)return null;try{var c=Dt(f,"URI"),p=Fe(f,"CODECS")||"";if(e.h.has(c))var m=e.h.get(c);else{var v=Fe(f,"LANGUAGE"),S=Fe(f,"NAME"),C=Fe(f,"CHARACTERISTICS"),T=mu(e,e.u++,[c],p,"image",v,!1,S,null,null,C,!1,null,!1),I=Fe(f,"RESOLUTION"),_=w(I?I.split("x"):[null,null]),N=_.next().value,j=_.next().value;T.stream.width=Number(N)||void 0,T.stream.height=Number(j)||void 0;var O=Fe(f,"BANDWIDTH");O&&(T.stream.bandwidth=Number(O)),e.h.set(c,T),m=T}return f=m,f.stream.codecs!=="mjpg"?null:f.stream}catch(X){if(e.g.hls.ignoreImageStreamFailures)return null;throw X}})),E(l,Promise.all(o),2)):(a=l.h,l.return(a.filter(function(f){return f})))})}function ZE(e,t,n){t=t.filter(function(c){var p=Fe(c,"URI")||"";return Fe(c,"TYPE")!="SUBTITLES"&&p!=""});var o={};t=w(t);for(var a=t.next();!a.done;a=t.next()){a=a.value;var l=zy(a);o[l]?o[l].push(a):o[l]=[a]}for(var f in o)i1(e,o[f],n)}function JE(e,t,n,o){var a=[],l=new Set;if(0<n.length){n=w(n);for(var f=n.next();!f.done;f=n.next()){f=f.value;var c=Dt(f,"METHOD");if(c!="NONE"&&c!="AES-128"&&(c=Fe(f,"KEYFORMAT")||"identity",f=(c=v1[c])?c(f,""):null)){if(f.keyIds){c=w(f.keyIds);for(var p=c.next();!p.done;p=c.next())l.add(p.value)}a.push(f)}}}for(n={},t=w(t),f=t.next();!f.done;f=t.next())f=f.value,c=zy(f),n[c]?n[c].push(f):n[c]=[f];t=[];for(var m in n){p=n[m];var v=p[0];f=Fe(v,"FRAME-RATE"),c=Number(Fe(v,"AVERAGE-BANDWIDTH"))||Number(Dt(v,"BANDWIDTH"));var S=Fe(v,"RESOLUTION"),C=w(S?S.split("x"):[null,null]);S=C.next().value,C=C.next().value;var T=Fe(v,"VIDEO-RANGE");(v=Fe(v,"REQ-VIDEO-LAYOUT"))&&v.includes(",")&&(v=v.split(",").filter(function(I){return I=="CH-STEREO"||I=="CH-MONO"})[0]),v=v||"CH-MONO",p=eA(e,p,o,c),t.push.apply(t,R(tA(e,p.audio,p.video,c,S,C,f,T,v,a,l)))}return t.filter(function(I){return I!=null})}function eA(e,t,n,o){for(var a={audio:[],video:[]},l=new Map,f=[],c=!1,p=!1,m=w(t),v=m.next();!v.done;v=m.next()){var S=v.value;v=Fe(S,"AUDIO");var C=Fe(S,"VIDEO"),T=v||C;T&&(f.includes(T)||f.push(T),(S=Fe(S,"PATHWAY-ID"))&&l.set(T,S),v?c=!0:C&&(p=!0))}f.length&&n.length&&(m=n.filter(function(N){return f.includes(Dt(N,"GROUP-ID"))}),ZE(e,m,l)),m=(l=f.sort().join(","))&&e.H.has(l)?e.H.get(l):[],c?a.audio.push.apply(a.audio,R(m)):p&&a.video.push.apply(a.video,R(m)),v=!1;var I=t.map(function(N){return Dt(N,"URI")});if(p=a.audio.find(function(N){return N&&N.Z().find(function(j){return I.includes(j)})}),c=Jy(e,t[0]),C=Sn("video",c),(T=Sn("audio",c))&&!C?(p="audio",v=0<a.audio.length):!a.audio.length&&!a.video.length&&T&&C?(p="video",c=[[C,T].join()]):a.audio.length&&p?(p="audio",v=!0):p=a.video.length&&!a.audio.length?"audio":"video",!v){var _=S=T=C=v=null;!m.length&&(n=n.find(function(N){var j=Fe(N,"URI")||"",O=Fe(N,"TYPE");return N=Dt(N,"GROUP-ID"),O!="SUBTITLES"&&j==""&&f.includes(N)}))&&(v=Fe(n,"LANGUAGE"),C=Fe(n,"NAME"),T=e1(n),n1(n),S=Fe(n,"CHARACTERISTICS"),_=t1(n)),e=oA(e,t,c,p,v,C,T,S,_),l&&(e.stream.groupId=l),m.length||(e.stream.bandwidth=o),a[e.stream.type]=[e]}return a}function Jy(e,t){var n=Fe(t,"CODECS")||"";e.da=0<n.length,e.da||e.g.hls.disableCodecGuessing||(t=[],e.g.disableVideo||t.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||t.push(e.g.hls.defaultAudioCodec),n=t.join(",")),e=new Set,t=[],n=w(n.split(/\s*,\s*/));for(var o=n.next();!o.done;o=n.next()){o=o.value;var a=xi(o);e.has(a)||(t.push(o),e.add(a))}return t}function e1(e){return(e=Fe(e,"CHANNELS"))?parseInt(e.split("/")[0],10):null}function t1(e){return(e=Fe(e,"SAMPLE-RATE"))?parseInt(e,10):null}function n1(e){return(e=Fe(e,"CHANNELS"))?e.includes("/JOC"):!1}function tA(e,t,n,o,a,l,f,c,p,m,v){for(var S=w(n),C=S.next();!C.done;C=S.next())g1(C.value.stream,a,l,f,c,p);for(a=e.g.disableAudio,(!t.length||a)&&(t=[null]),a=e.g.disableVideo,(!n.length||a)&&(n=[null]),a=[],t=w(t),l=t.next();!l.done;l=t.next())for(l=l.value,f=w(n),c=f.next();!c.done;c=f.next()){var T=c.value;(c=l?l.stream:null)&&(c.drmInfos=m,c.keyIds=v),(p=T?T.stream:null)&&(p.drmInfos=m,p.keyIds=v),S=l?l.stream.drmInfos:null,C=T?T.stream.drmInfos:null,T=T?T.Z().sort().join(","):"";var I=l?l.Z().sort().join(","):"";T=T+" - "+I,c&&p&&!U0(S,C)||e.Ba.has(T)||(c={id:e.u++,language:c?c.language:"und",disabledUntilTime:0,primary:!!c&&c.primary||!!p&&p.primary,audio:c,video:p,bandwidth:o,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},a.push(c),e.Ba.add(T))}return a}function nA(e,t){t=$y(t,"CLOSED-CAPTIONS"),t=w(t);for(var n=t.next();!n.done;n=t.next()){var o=n.value,a=Fe(o,"LANGUAGE");n=ht(a||"und"),a||(a=Fe(o,"NAME"))&&(n=a),a=Dt(o,"GROUP-ID"),o=Dt(o,"INSTREAM-ID").replace("SERVICE","svc"),e.F.get(a)||e.F.set(a,new Map),e.F.get(a).set(o,n)}}function i1(e,t,n){for(var o=[],a=[],l=new Map,f=w(t),c=f.next();!c.done;c=f.next()){var p=c.value;c=Dt(p,"URI"),p=Dt(p,"GROUP-ID"),o.push(c),a.push(p),l.set(p,c)}if(f=a.sort().join(","),c=t[0],t="",p=Dt(c,"TYPE").toLowerCase(),p=="subtitles"&&(p=lt),p==lt)t=Fe(c,"CODECS")||"";else{a=w(a);for(var m=a.next();!m.done;m=a.next())if(m=m.value,e.G.has(m)){t=e.G.get(m);break}}if(a=o.sort().join(","),e.h.has(a))return e.h.get(a);if(m=e.u++,e.j){l=w(l);for(var v=l.next();!v.done;v=l.next()){var S=w(v.value);v=S.next().value,S=S.next().value,(v=n.get(v))&&zr(e.j,m,v,S)}}n=Fe(c,"LANGUAGE"),l=Fe(c,"NAME"),v=Fe(c,"DEFAULT")=="YES",S=p=="audio"?e1(c):null;var C=p=="audio"?n1(c):!1,T=Fe(c,"CHARACTERISTICS"),I=Fe(c,"FORCED")=="YES";return c=p=="audio"?t1(c):null,o=mu(e,m,o,t,p,n,v,l,S,null,T,I,c,C),o.stream&&(o.stream.groupId=f),e.H.has(f)?e.H.get(f).push(o):e.H.set(f,[o]),e.h.set(a,o),o}function iA(e,t){var n,o,a,l,f,c,p,m,v,S;return z(function(C){return C.g==1?(n=Dt(t,"URI"),o=Fe(t,"CODECS","jpeg")||"",e.h.has(n)?C.return(e.h.get(n)):(a=Fe(t,"LANGUAGE"),l=Fe(t,"NAME"),f=Fe(t,"CHARACTERISTICS"),c=mu(e,e.u++,[n],o,"image",a,!1,l,null,null,f,!1,null,!1),(p=Fe(t,"RESOLUTION"))?E(C,c.stream.createSegmentIndex(),3):C.B(2))):(C.g!=2&&(m=c.stream.segmentIndex.get(0),v=m.tilesLayout)&&(c.stream.width=Number(p.split("x")[0])*Number(v.split("x")[0]),c.stream.height=Number(p.split("x")[1])*Number(v.split("x")[1])),(S=Fe(t,"BANDWIDTH"))&&(c.stream.bandwidth=Number(S)),e.h.set(n,c),C.return(c))})}function oA(e,t,n,o,a,l,f,c,p){for(var m=e.u++,v=[],S=w(t),C=S.next();!C.done;C=S.next()){var T=C.value;C=Dt(T,"URI"),T=Fe(T,"PATHWAY-ID"),e.j&&T&&zr(e.j,m,T,C),v.push(C)}if(S=v.sort().join(","),e.h.has(S))return e.h.get(S);e:{if(t=Fe(t[0],"CLOSED-CAPTIONS"),o=="video"){if(t&&t!="NONE"){t=e.F.get(t);break e}if(!t&&e.F.size)for(t=w(e.F.keys()).next();!t.done;){t=e.F.get(t.value);break e}}t=null}return n=nr(o,n),o=mu(e,m,v,n,o,a,!1,l,f,t,c,!1,p,!1),e.h.set(S,o),o}function mu(e,t,n,o,a,l,f,c,p,m,v,S,C,T){function I(q){var te,de,ce,he,ge,Se,ke,Ne,He,Ge,Ze,Oe,zt,Qt,pi,mn,Ai;return z(function(gt){switch(gt.g){case 1:return te=O.Z(),E(gt,nd(e,O.Z(),!0),2);case 2:if(de=gt.h,q.aborted)return gt.return();if(ce=de.uri,ce==de.originalUri||te.includes(ce)||j.push(ce),he=Xh(e.za,de.data),ge=void 0,e.da||!e.g.hls.disableCodecGuessing){gt.B(3);break}return E(gt,Qy(e,he,_),4);case 4:Se=gt.h,ge=Se.mimeType,o=Se.codecs;case 3:return ke=Pn(e),E(gt,s1(e,0,he,_,ce,o,a,l,f,c,p,m,v,S,C,T,ge),5);case 5:if(Ne=gt.h,q.aborted)return gt.return();if(He=Ne.stream,Pn(e)&&!ke&&c1(e,he),O.Sb=Ne.Sb,O.rb=Ne.rb,O.td=Ne.td,O.sd=Ne.sd,O.Sc=Ne.Sc,O.Pd=Ne.Pd,O.Xa=Ne.Xa,O.Ya=Ne.Ya,O.Se=!0,N.segmentIndex=He.segmentIndex,N.encrypted=He.encrypted,N.drmInfos=He.drmInfos,N.keyIds=He.keyIds,N.mimeType=He.mimeType,N.bandwidth=N.bandwidth||He.bandwidth,N.codecs=N.codecs||He.codecs,N.drmInfos.length&&e.i.newDrmInfo(N),Ge=Gt,a==Ge.$||a==Ge.P)for(Ze=w(e.h.values()),Oe=Ze.next();!Oe.done;Oe=Ze.next())zt=Oe.value,zt.Se||zt.type!=a||(zt.stream.mimeType=He.mimeType);a==Ge.na&&(Qt=He.segmentIndex.get(0))&&Qt.aa&&(N.mimeType="application/mp4"),sA(e)&&(e.mb?Zh(e,[O]):(e.mb=!0,pi=Array.from(e.h.values()),mn=pi.filter(function(In){return In.stream.segmentIndex}),Zh(e,mn),Qh(e),Ai=e.m,0<Ai&&e.s.U(Ai))),F(gt)}})}function _(){return e.j&&1<n.length?ra(e.j,t):j.concat(Gy([e.Y],n,e.o))}var N=l1(e,o,a,l,f,c,p,m,v,S,C,T),j=[],O={stream:N,type:a,gg:j,Z:_,Sb:0,rb:0,Pd:new Map,td:!1,sd:!1,Sc:!1,qe:-1,Xa:-1,Ya:-1,Se:!1},X=null,V=new AbortController;return N.createSegmentIndex=function(){return X||(V=new AbortController,X=new Promise(function(q){q(I(V.signal))}))},N.closeSegmentIndex=function(){X&&!N.segmentIndex&&V.abort(),N.segmentIndex&&(N.segmentIndex.release(),N.segmentIndex=null),X=null},O}function o1(e){var t=1/0;e=w(e.h.values());for(var n=e.next();!n.done;n=e.next())n=n.value,n.stream.segmentIndex&&n.stream.type!="text"&&(t=Math.min(t,n.rb));return t}function rA(e){var t=1/0,n=1/0;e=w(e.h.values());for(var o=e.next();!o.done;o=e.next())o=o.value,o.stream.segmentIndex&&o.stream.type!="text"&&(t=Math.min(t,o.rb),n=Math.min(n,o.Sb));return t-n}function r1(e,t){var n=[];t=w(t);for(var o=t.next();!o.done;o=t.next())o=o.value,o.segmentIndex&&Oc(o.segmentIndex,function(a){n.push(a)});e.l.Xc(n)}function Zh(e,t){if(!Pn(e))for(var n=o1(e),o=w(t),a=o.next();!a.done;a=o.next())a.value.stream.segmentIndex.bc(0,n);r1(e,t.map(function(l){return l.stream})),e.g.hls.ignoreManifestProgramDateTime?HE(e,t):$E(e,t)}function sA(e){if(!e.C)return!1;var t=[],n=[];e=w(e.C.variants);for(var o=e.next();!o.done;o=e.next())o=o.value,o.video&&t.push(o.video),o.audio&&n.push(o.audio);return!(0<t.length&&!t.some(function(a){return a.segmentIndex})||0<n.length&&!n.some(function(a){return a.segmentIndex}))}function s1(e,t,n,o,a,l,f,c,p,m,v,S,C,T,I,_,N){var j,O,X,V,q,te,de,ce,he,ge,Se,ke,Ne,He,Ge,Ze,Oe,zt,Qt,pi,mn,Ai,gt;return z(function(In){if(In.g==1){if(n.type!=1)throw new K(2,4,4017);j=Ei(n.g,"EXT-X-DEFINE"),O=Zy(e,j,a);var yn=rn(n.g,"EXT-X-PLAYLIST-TYPE"),jn=rn(n.g,"EXT-X-ENDLIST");return jn=yn&&yn.value=="VOD"||jn,yn=yn&&yn.value=="EVENT"&&!jn,yn=!jn&&!yn,jn?yu(e,vu):yn?yu(e,xu):yu(e,x1),Pn(e)&&Jh(e,n),N?In.B(2):E(In,uA(e,f,l,n,O,o),3)}if(In.g!=2&&(N=In.h),X=u1(n,N),V=X.drmInfos,q=X.keyIds,te=X.encrypted,de=X.Dg,te&&!V.length&&!de)throw new K(2,4,4026);return ce=l1(e,l,f,c,p,m,v,S,C,T,I,_),ce.encrypted=te,ce.drmInfos=V,ce.keyIds=q,ce.mimeType=N,he=Pn(e)?e.J.get(f):new Map,ge=p1(e,n,ce,he,O,o),Se=ge.segments,(ke=ge.bandwidth)&&(ce.bandwidth=ke),Pn(e)&&Jh(e,n),Ne=Se[0].startTime,He=Se[Se.length-1],Ge=He.endTime,Ze=new ft(Se),ce.segmentIndex=Ze,zt=(Oe=rn(n.g,"EXT-X-SERVER-CONTROL"))?Oe.getAttribute("CAN-SKIP-UNTIL")!=null:!1,Qt=Oe?Oe.getAttribute("CAN-BLOCK-RELOAD")!=null:!1,pi=Hr(n.g,"EXT-X-MEDIA-SEQUENCE",0),mn=a1(pi,Se),Ai=mn.Xa,gt=mn.Ya,In.return({stream:ce,type:f,gg:[],Z:o,Sb:Ne,rb:Ge,td:zt,sd:Qt,Sc:!1,qe:-1,Xa:Ai,Ya:gt,Pd:he,Se:!1})})}function a1(e,t){e=e+t.length-1;var n=-1;if(!t.length)return e++,{Xa:e,Ya:n};t=t[t.length-1];var o=t.g;return t.g.length?(n=o.length-1,o[o.length-1].l||(e++,n=0),{Xa:e,Ya:n}):(e++,t.m&&(n=0),{Xa:e,Ya:n})}function l1(e,t,n,o,a,l,f,c,p,m,v,S){var C=ed(n,t)||td(n),T=[];if(p){p=w(p.split(","));for(var I=p.next();!I.done;I=p.next())T.push(I.value)}return p=void 0,I=null,n==lt?p=T.includes("public.accessibility.transcribes-spoken-dialog")&&T.includes("public.accessibility.describes-music-and-sound")?"caption":"subtitle":T.includes("public.accessibility.describes-video")&&(I="visually impaired"),T.length||p!=="subtitle"||T.push("subtitle"),{id:e.u++,originalId:l,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:C,codecs:t,kind:n==lt?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:ht(o||"und"),originalLanguage:o,label:l,type:n,primary:a,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:T,forced:m,channelsCount:f,audioSamplingRate:v,spatialAudio:S,closedCaptions:c,hdr:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:I,external:!1,fastSwitching:!1}}function u1(e,t){var n=[];if(e.segments){e=w(e.segments);for(var o=e.next();!o.done;o=e.next())o=Ei(o.value.g,"EXT-X-KEY"),n.push.apply(n,R(o))}o=e=!1;var a=[],l=new Set;n=w(n);for(var f=n.next();!f.done;f=n.next()){f=f.value;var c=Dt(f,"METHOD");if(c!="NONE"){if(e=!0,c=="AES-128")o=!0;else if(c=Fe(f,"KEYFORMAT")||"identity",f=(c=v1[c])?c(f,t):null){if(f.keyIds){c=w(f.keyIds);for(var p=c.next();!p.done;p=c.next())l.add(p.value)}a.push(f)}}}return{drmInfos:a,keyIds:l,encrypted:e,Dg:o}}function f1(e,t,n,o,a){if(!d.crypto||!d.crypto.subtle)throw Le("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new K(2,4,4042);var l=0,f=Fe(t,"IV","");if(f){var c=Bo(f.substr(2));if(c.byteLength!=16)throw new K(2,4,4048)}else l=Hr(n.g,"EXT-X-MEDIA-SEQUENCE",0);var p={method:"AES-128",iv:c,firstMediaSequenceNumber:l,fetchKey:function(){var m,v,S,C,T;return z(function(I){if(I.g==1)return m=Wo(o(),Dt(t,"URI"),a),v=Yt(m,e.g.retryParameters),E(I,Gr(e,v,6),2);if(I.g!=3){if(S=I.h,!S.data||S.data.byteLength!=16)throw new K(2,4,4049);return C={name:"AES-CBC"},T=p,E(I,d.crypto.subtle.importKey("raw",S.data,C,!0,["decrypt"]),3)}T.cryptoKey=I.h,p.fetchKey=void 0,F(I)})}};return p}function Jh(e,t){var n=1/0,o=t.segments;if(o.length)for(var a=o.length-1;0<=a;){var l=rn(o[a].g,"EXTINF");if(l){n=Number(l.value.split(",")[0]);break}a--}if(o=rn(t.g,"EXT-X-TARGETDURATION"),!o)throw new K(2,4,4024,"EXT-X-TARGETDURATION");o=Number(o.value),(a=rn(t.g,"EXT-X-PART-INF"))&&(e.K=Number(Dt(a,"PART-TARGET"))),t=rn(t.g,"EXT-X-SERVER-CONTROL"),e.A&&e.K?(e.m=e.lb?5*e.K<=n?Math.min(e.K,e.m):Math.min(n,e.m):Math.min(e.K,e.m),e.ma=t?Number(Dt(t,"PART-HOLD-BACK")):0):(e.m=Math.min(n,e.m),n=t?t.getAttribute("HOLD-BACK"):null,e.ka=n?Number(n.value):0),e.Aa=Math.max(o,e.Aa)}function c1(e,t){if(e.g.defaultPresentationDelay)t=e.g.defaultPresentationDelay;else if(e.ma)t=e.ma;else if(e.ka)t=e.ka;else{t=t.segments.length;var n=e.g.hls.liveSegmentsDelay;n>t-2&&(n=Math.max(1,t-2)),t=e.Aa*n}e.l.qf(0),e.l.ng(t),e.l.pc(!1)}function h1(e,t,n,o,a){var l=rn(n,"EXT-X-MAP");if(!l)return null;var f=Dt(l,"URI"),c=Wo(o(),f,a);if(f=[c.toString(),Fe(l,"BYTERANGE","")].join("-"),!e.W.has(f)){var p=void 0,m=null;n=w(n);for(var v=n.next();!v.done;v=n.next())v=v.value,v.name=="EXT-X-KEY"?Dt(v,"METHOD")=="AES-128"&&v.id<l.id&&(p=f1(e,v,t,o,a)):v.name=="EXT-X-BYTERANGE"&&v.id<l.id&&(m=v);t=aA(c,l,m,p),e.W.set(f,t)}return e.W.get(f)}function aA(e,t,n,o){var a=0,l=null;return t=Fe(t,"BYTERANGE"),!t&&n&&(t=n.value),t&&(a=t.split("@"),l=Number(a[0]),a=Number(a[1]),l=a+l-1,o&&(n=l+1-a,n%16&&(l+=16-n%16))),new $n(function(){return e},a,l,null,null,null,o)}function lA(e,t,n,o,a,l,f,c,p){var m=o.g,v=rn(m,"EXTINF"),S=0,C=0,T=null;o.fb.length&&!e.A&&Le("Low-latency HLS live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.");var I=null;if(!e.g.hls.ignoreManifestProgramDateTime){var _=rn(m,"EXT-X-PROGRAM-DATE-TIME");_&&_.value&&(I=A0(_.value))}var N=uo;if(rn(m,"EXT-X-GAP")&&(N=2),!v){if(o.fb.length==0)throw new K(2,4,4024,"EXTINF");if(!e.A)return null}var j=[];_=!1;var O=null,X=!1,V=!1;if(e.A&&o.fb.length){S=(f.mimeType=="video/mp4"||f.mimeType=="audio/mp4")&&d.ReadableStream&&e.g.hls.allowLowLatencyByteRangeOptimization;for(var q=I,te={},de=0;de<o.fb.length;te={Cc:te.Cc,md:te.md},de++){var ce=o.fb[de],he=de==0?n:j[j.length-1],ge=de==0?a:he.endTime,Se=Number(Fe(ce,"DURATION"))||e.K;if(Se){var ke=ge+Se,Ne=0,He=null;if(ce.name=="EXT-X-PRELOAD-HINT"?(Ne=(Ne=Fe(ce,"BYTERANGE-START"))?Number(Ne):0,(he=Fe(ce,"BYTERANGE-LENGTH"))?He=Ne+Number(he)-1:Ne&&(He=Number.MAX_SAFE_INTEGER)):(Ne=Fe(ce,"BYTERANGE"),He=w(d1(he,Ne)),Ne=He.next().value,He=He.next().value),te.md=Fe(ce,"URI"),te.md){he=uo,Fe(ce,"GAP")=="YES"&&(he=2,X=!0),te.Cc=null;var Ge=function(Oe){return function(){return Oe.Cc==null&&(Oe.Cc=Wo(c(),Oe.md,l)),Oe.Cc}}(te);S&&0<=Ne&&He!=null&&(O=Ge,_=!0),ge=new Xe(ge,ke,Ge,Ne,He,t,0,0,1/0,[],"",null,q,he,p),ce.name=="EXT-X-PRELOAD-HINT"&&(ge.Ue(),V=!0),Fe(ce,"INDEPENDENT")!="YES"&&0<de&&ge.Od(),j.push(ge),q&&(q+=Se)}}}}if(v){if(v=Number(v.value.split(",")[0]),v==0)return null;S=a+v}else if(j.length)S=j[j.length-1].endTime;else return null;_&&(X||j[0].Qa!=0?(_=!1,O=null):j=[]),(v=rn(m,"EXT-X-BYTERANGE"))?(T=w(d1(n,v.value)),C=T.next().value,T=T.next().value):j.length&&(C=j[0].Qa,T=j[j.length-1].wa),n="",v=null,f.type=="image"&&(n="1x1",f=rn(m,"EXT-X-TILES"))&&(n=Dt(f,"LAYOUT"),(f=Fe(f,"DURATION"))&&(v=Number(f)));var Ze=null;return t=new Xe(a,S,function(){return O?O():(Ze==null&&(Ze=Wo(c(),o.h,l)),Ze||[])},C,T,t,0,0,1/0,j,n,v,I,N,p,0<j.length&&!!o.h),_&&(e.lb=!0,t.Zf(),V&&t.Ue()),t}function d1(e,t){var n=0,o=null;return t&&(n=t.split("@"),t=Number(n[0]),n=n[1]?Number(n[1]):e.wa+1,o=n+t-1),[n,o]}function p1(e,t,n,o,a,l){var f=t.segments,c=void 0,p=Hr(t.g,"EXT-X-DISCONTINUITY-SEQUENCE",0),m=Hr(t.g,"EXT-X-MEDIA-SEQUENCE",0),v=rn(t.g,"EXT-X-SKIP"),S=v?Number(Fe(v,"SKIPPED-SEGMENTS")):0,C=m+S,T=0;Pn(e)&&o.has(C)&&(T=o.get(C)),T===0&&e.ea==xu&&0<o.size&&!o.has(C)&&(T=e.l.eb());var I=[],_=null;v=[];for(var N=0;N<f.length;N++){var j=f[N],O=N==0?T:_.endTime;C=m+S+N,rn(j.g,"EXT-X-DISCONTINUITY")&&p++;for(var X=w(j.g),V=X.next();!V.done;V=X.next())V=V.value,V.name=="EXT-X-KEY"&&(Dt(V,"METHOD")=="AES-128"?c=f1(e,V,t,l,a):c=void 0);o.set(C,O),X=h1(e,t,j.g,l,a),!e.A&&e.i.isAutoLowLatencyMode()&&(e.i.enableLowLatencyMode(),e.A=e.i.isLowLatencyMode()),(O=lA(e,X,_,j,O,a,n,l,c))&&((_=Hr(j.g,"EXT-X-BITRATE"))?v.push({bitrate:_,duration:O.endTime-O.startTime}):v.length&&(_=v.pop(),_.duration+=O.endTime-O.startTime,v.push(_)),_=O,O.i=p,e.g.hls.ignoreManifestProgramDateTime&&e.I!=null&&C<e.I||I.push(O))}if(t=void 0,v.length&&(t=v.reduce(function(q,te){return q+te.duration},0),t=Math.round(v.reduce(function(q,te){return q+te.bitrate*te.duration},0)/t*1e3)),v=I.some(function(q){return q.ca!=null})){for(n={},o=0;o<I.length;n={vc:n.vc,uc:n.uc,hd:n.hd,xb:n.xb,tc:n.tc},o++)if(n.xb=I[o],n.xb.ca==null)for(n.uc=0,n.vc=o,a=function(q){return function(){var te=I[q.vc];if(te){if(te.ca!=null)return te.ca+q.uc;q.uc-=te.endTime-te.startTime,q.vc+=1}return null}}(n),n.tc=0,n.hd=o,l=function(q){return function(){var te=I[q.hd];if(te){if(te!=q.xb&&(q.tc+=te.endTime-te.startTime),te.ca!=null)return te.ca+q.tc;--q.hd}return null}}(n);n.xb.ca==null;)n.xb.ca=l(),n.xb.ca==null&&(n.xb.ca=a())}if(v)for(n=w(I),o=n.next();!o.done;o=n.next())for(a=o.value,o=a.ca,a=w(a.g),l=a.next();!l.done;l=a.next())l=l.value,l.ca=o,o+=l.endTime-l.startTime;if(e=e.V,v&&e!=1/0)for(v=w(I),o=v.next();!o.done;o=v.next())o.value.tf(e);return{segments:I,bandwidth:t}}function ed(e,t){if(e==lt){if(t=="vtt"||t=="wvtt")return"text/vtt";if(t&&t!=="")return"application/mp4"}return e!="image"||t&&t!="jpeg"?e=="audio"&&t=="mp4a.40.34"?"audio/mpeg":t=="mjpg"?"application/mp4":null:"image/jpeg"}function td(e){return e==lt?"text/vtt":y1[e].mp4}function uA(e,t,n,o,a,l){var f,c,p,m,v,S,C,T,I,_,N,j,O;return z(function(X){switch(X.g){case 1:return f=Li,c=Math.trunc((o.segments.length-1)/2),p=Wo(l(),o.segments[c].h,a),m=new Bt(p[0]),v=m.Ga.split(".").pop(),S=y1[t],(C=S[v])||(C=m1[v])||(C=ed(t,n))?X.return(C):(I=1,_=Yt(p,e.g.retryParameters),re(X,2),_.method="HEAD",E(X,Gr(e,_,f,{type:I}),4));case 4:N=X.h,T=N.headers["content-type"],ie(X,3);break;case 2:if(j=se(X),!j||j.code!=1002&&j.code!=1001){X.B(3);break}return _.method="GET",E(X,Gr(e,_,f,{type:I}),6);case 6:O=X.h,T=O.headers["content-type"];case 3:return T?X.return(T.split(";")[0]):X.return(td(t))}})}function g1(e,t,n,o,a,l){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(o)||void 0,e.hdr=a||void 0,e.videoLayout=l||void 0)}function nd(e,t,n){return Gr(e,Yt(t,e.g.retryParameters),0,{type:n?2:3})}function fA(e){var t,n,o,a,l,f;z(function(c){switch(c.g){case 1:return e.i?(re(c,2),t=Date.now(),E(c,e.update(),4)):c.return();case 4:n=Date.now(),Pn(e)&&(o=(n-t)/1e3,e.kb.sample(1,o),a=e.m,l=Math.max(0,a-Y(e.kb)),e.s.U(l)),ie(c,3);break;case 2:if(f=se(c),!e.i)return c.return();if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.i.onError(f),c.return();f.severity=1,e.i.onError(f),e.s.U(.1);case 3:if(!e.i)return c.return();e.i.onManifestUpdated(),F(c)}})}function Pn(e){return e.ea!=vu}function yu(e,t){e.ea=t,e.l&&e.l.pc(!Pn(e)),Pn(e)||e.s.stop()}function Gr(e,t,n,o){if(!e.N)throw new K(2,7,7001);return t=e.i.networkingEngine.request(n,t,o),No(e.N,t),t.promise}ae("shaka.hls.HlsParser",gu);var m1={aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},y1={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",tsa:"video/mp2t"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t",tsv:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml"},image:{jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif"}},v1={"com.apple.streamingkeydelivery":function(e,t){if(t=="video/mp2t")throw new K(2,4,4040);if(d.shakaMediaKeysPolyfill)throw new K(2,4,4041);return ao("com.apple.fps",[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}])},"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=Dt(e,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)?(t=Dt(e,"URI"),t=Yh(t),t=Ve(t.data),t=ao("com.widevine.alpha",[{initDataType:"cenc",initData:t}]),(e=Fe(e,"KEYID"))&&(t.keyIds=new Set([e.toLowerCase().substr(2)])),t):null},"com.microsoft.playready":function(e){var t=Dt(e,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)?(e=Dt(e,"URI"),e=Yh(e),e=Ve(e.data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),e=ml(e,t,new Set,0),ao("com.microsoft.playready",[{initDataType:"cenc",initData:e}])):null},identity:function(e,t){if(t=="video/mp2t")throw new K(2,4,4040);if(d.shakaMediaKeysPolyfill)throw new K(2,4,4041);return e=Dt(e,"METHOD"),["SAMPLE-AES","SAMPLE-AES-CTR"].includes(e)?ao("org.w3.clearkey",null):null}},vu="VOD",x1="EVENT",xu="LIVE",cA={zg:vu,oi:x1,xi:xu};fi["application/x-mpegurl"]=function(){return new gu},fi["application/vnd.apple.mpegurl"]=function(){return new gu};function hA(e){var t=0,n=Et(e),o=n.getUint32(t,!0);if(o!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){o=n.getUint16(e,!0),e+=2;var a=n.getUint16(e,!0);if(e+=2,a&1||a+e>n.byteLength){n=[];break e}var l=Ve(n,e,a);t.push({type:o,value:l}),e+=a}n=t}return n}function wu(e){if(e=w1(e))e:{e=w(e.getElementsByTagName("DATA"));for(var t=e.next();!t.done;t=e.next())if(t=ui(t.value,"LA_URL")){e=t.textContent;break e}e=""}else e="";return e}function w1(e){return e=li(e.textContent),e=hA(e).filter(function(t){return t.type===dA})[0],e?(e=Vi(e.value,!0),(e=wr(e,"WRMHEADER"))?e:null):null}var dA=1,pA=new Map().set("com.microsoft.playready",wu).set("com.microsoft.playready.recommendation",wu).set("com.microsoft.playready.software",wu).set("com.microsoft.playready.hardware",wu);function Wr(e){if(!E1){E1=!0;var t=new Uint8Array([105,115,111,109]),n=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);Tu=ot("ftyp",t,o,t,n),t=ot("dref",AA),id=ot("dinf",t)}this.g=e}function Xr(e){for(var t=[],n=w(e.g),o=n.next();!o.done;o=n.next()){var a=t,l=a.push,f=o.value;o=ot;var c=f.id+1,p=f.stream.width||0,m=f.stream.height||0;f.type=="audio"&&(m=p=0);var v=f.duration*f.timescale,S=Math.floor(v/(go+1));switch(v=Math.floor(v%(go+1)),c=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(R(_t(c,4)),[0,0,0,0],R(_t(S,4)),R(_t(v,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],R(_t(p,2)),[0,0],R(_t(m,2)),[0,0])),c=ot("tkhd",c),p=ot,S=f.duration*f.timescale,m=Math.floor(S/(go+1)),S=Math.floor(S%(go+1)),v=f.stream.language,v=v.charCodeAt(0)-96<<10|v.charCodeAt(1)-96<<5|v.charCodeAt(2)-96,m=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(R(_t(f.timescale,4)),R(_t(m,4)),R(_t(S,4)),R(_t(v,2)),[0,0])),m=ot("mdhd",m),S=f,v=new Uint8Array([]),S.type){case"video":v=mA;break;case"audio":v=yA}S=ot("hdlr",v);e:{switch(f.type){case"video":f=ot("minf",ot("vmhd",TA),id,S1(f));break e;case"audio":f=ot("minf",ot("smhd",CA),id,S1(f));break e}f=new Uint8Array([])}f=p("mdia",m,S,f),o=o("trak",c,f),l.call(a,o)}for(t=Lt.apply(ln,R(t)),l=e.g[0],n=ot,o=l.duration*l.timescale,a=Math.floor(o/(go+1)),o=Math.floor(o%(go+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(R(_t(l.timescale,4)),R(_t(a,4)),R(_t(o,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255])),a=ot("mvhd",a),o=[],e=w(e.g),p=e.next();!p.done;p=e.next())f=o,c=f.push,p=new Uint8Array([0,0,0,0].concat(R(_t(p.value.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1])),p=ot("trex",p),c.call(f,p);if(e=Lt.apply(ln,R(o)),e=ot("mvex",e),o=[],l.encrypted){for(l=w(l.stream.drmInfos),f=l.next();!f.done;f=l.next())if(f=f.value,f.initData)for(f=w(f.initData),c=f.next();!c.done;c=f.next())o.push(c.value.initData);l=Lt.apply(ln,R(o))}else l=new Uint8Array([]);return e=n("moov",a,t,e,l),t=new Uint8Array(Tu.byteLength+e.byteLength),t.set(Tu),t.set(e,Tu.byteLength),t}function S1(e){var t=ot,n=new Uint8Array([]);switch(e.type){case"video":if(e.codecs.includes("avc1")){n=e.stream.width||0;var o=e.stream.height||0;if(0<e.la.byteLength)var a=ot("avcC",e.la);else{a=ot;for(var l=7,f=[],c=[],p=0,m=0,v=0,S=0;S<e.Ra.length;S++){var C=C1(e.Ra[S]);switch(C[0]&31){case 7:f.push(C),l+=C.length+2;break;case 8:c.push(C),l+=C.length+2}}for(0<f.length&&(p=f[0][1],v=f[0][2],m=f[0][3]),l=new Uint8Array(l),S=0,l[S++]=1,l[S++]=p,l[S++]=v,l[S++]=m,l[S++]=255,l[S++]=224|f.length,p=0;p<f.length;p++)l[S++]=(f[p].length&65280)>>8,l[S++]=f[p].length&255,l.set(f[p],S),S+=f[p].length;for(l[S++]=c.length,f=0;f<c.length;f++)l[S++]=(c[f].length&65280)>>8,l[S++]=c[f].length&255,l.set(c[f],S),S+=c[f].length;a=a("avcC",l)}n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(R(_t(n,2)),R(_t(o,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),o="avc1",c=T1(e),f=new Uint8Array([]),e.encrypted&&(f=ca(e),o="encv"),n=ot(o,n,a,c,f)}else e.codecs.includes("hvc1")&&(o=e.stream.width||0,a=e.stream.height||0,n=new Uint8Array([]),0<e.la.byteLength&&(n=ot("hvcC",e.la)),o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(R(_t(o,2)),R(_t(a,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),a="hvc1",c=T1(e),f=new Uint8Array([]),e.encrypted&&(f=ca(e),a="encv"),n=ot(a,o,n,c,f));break;case"audio":e.codecs.includes("mp3")?e=ot(".mp3",Su(e)):e.codecs.includes("ac-3")?(n=ot("dac3",e.fa),o="ac-3",a=new Uint8Array([]),e.encrypted&&(a=ca(e),o="enca"),e=ot(o,Su(e),n,a)):e.codecs.includes("ec-3")?(n=ot("dec3",e.fa),o="ec-3",a=new Uint8Array([]),e.encrypted&&(a=ca(e),o="enca"),e=ot(o,Su(e),n,a)):(0<e.fa.byteLength?n=ot("esds",e.fa):(n=ot,o=e.id+1,a=e.stream.channelsCount||2,f=e.stream.audioSamplingRate||44100,p=nr("audio",e.codecs.split(",")),m={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},c=m[f],(p==="mp4a.40.5"||p==="mp4a.40.29")&&(c=m[2*f]),f=parseInt(p.split(".").pop(),10),o=new Uint8Array([0,0,0,0,3,25].concat(R(_t(o,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,f<<3|c>>>1,c<<7|a<<3,6,1,2])),n=n("esds",o)),o="mp4a",a=new Uint8Array([]),e.encrypted&&(a=ca(e),o="enca"),e=ot(o,Su(e),n,a)),n=e}return e=ot("stsd",EA,n),t("stbl",e,ot("stts",vA),ot("stsc",xA),ot("stsz",SA),ot("stco",wA))}function T1(e){if(!e.sa&&!e.ua)return new Uint8Array([]);var t=e.ua;return e=new Uint8Array([].concat(R(_t(e.sa,4)),R(_t(t,4)))),ot("pasp",e)}function Su(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat(R(_t(e.stream.audioSamplingRate||44100,2)),[0,0]))}function ca(e){for(var t=ot,n=e.codecs.substring(0,e.codecs.indexOf(".")),o=0,a=0;a<n.length;a+=1)o|=n.charCodeAt(a)<<8*(n.length-a-1);n=new Uint8Array([].concat(R(_t(o,4)))),n=ot("frma",n),o=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),o=ot("schm",o),a=ot;var l=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);e=w(e.stream.drmInfos);for(var f=e.next();!f.done;f=e.next())if((f=f.value)&&f.keyIds&&f.keyIds.size){f=w(f.keyIds);for(var c=f.next();!c.done;c=f.next())l=C1(c.value)}return e=new Uint8Array([0,0,0,0,0,0,1,8]),l=ot("tenc",e,l),t("sinf",n,o,a("schi",l))}function ha(e){var t=[];e=w(e.g);for(var n=e.next();!n.done;n=e.next()){n=n.value;var o=t.push,a=o.apply,l=ot,f=new Uint8Array([0,0,0,0].concat(R(_t(n.data?n.data.gb:0,4))));f=ot("mfhd",f);var c,p=n.data?n.data.Oa:[],m=new Uint8Array(4+p.length);for(c=0;c<p.length;c++){var v=p[c].flags;m[c+4]=v.Ia<<4|v.La<<2|v.Ja}p=ot("sdtp",m);var S=p.length+92;m=ot,c=new Uint8Array([0,0,0,58].concat(R(_t(n.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),c=ot("tfhd",c),v=n.data?n.data.baseMediaDecodeTime:0;var C=Math.floor(v%(go+1));v=new Uint8Array([1,0,0,0].concat(R(_t(Math.floor(v/(go+1)),4)),R(_t(C,4)))),v=ot("tfdt",v);var T=S;S=n.data?n.data.Oa:[],C=S.length;var I=12+16*C,_=new Uint8Array(I);for(T+=8+I,_.set([n.type==="video"?1:0,0,15,1].concat(R(_t(C,4)),R(_t(T,4))),0),T=0;T<C;T++){var N=S[T];I=_t(N.duration,4);var j=_t(N.size,4),O=N.flags;N=_t(N.Ta,4),_.set([].concat(R(I),R(j),[O.Ua<<2|O.Ia,O.La<<6|O.Ja<<4|O.Va,O.Ha&61440,O.Ha&15],R(N)),12+16*T)}S=ot("trun",_),p=m("traf",c,v,S,p),l=l("moof",f,p),a.call(o,t,[l,gA(n)])}return Lt.apply(ln,R(t))}function gA(e){return e=(e.data?e.data.Oa:[]).map(function(t){return t.data}),e=Lt.apply(ln,R(e)),ot("mdat",e)}function _t(e,t){var n=[];for(--t;0<=t;t--)n.push(e>>8*t&255);return n}function C1(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length/2;n+=1)t[n]=parseInt(String(e[2*n]+e[2*n+1]),16);return t}function ot(e){var t=Re.apply(1,arguments),n=A1[e];n||(n=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],A1[e]=n);for(var o=8,a=t.length-1;0<=a;a--)o+=t[a].byteLength;for(a=new Uint8Array(o),a[0]=o>>24&255,a[1]=o>>16&255,a[2]=o>>8&255,a[3]=o&255,a.set(n,4),n=0,o=8;n<t.length;n++)a.set(t[n],o),o+=t[n].byteLength;return a}var E1=!1,go=Math.pow(2,32)-1,A1={},mA=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),yA=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),vA=new Uint8Array([0,0,0,0,0,0,0,0]),xA=new Uint8Array([0,0,0,0,0,0,0,0]),wA=new Uint8Array([0,0,0,0,0,0,0,0]),SA=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),TA=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),CA=new Uint8Array([0,0,0,0,0,0,0,0]),EA=new Uint8Array([0,0,0,0,0,0,0,1]),Tu=new Uint8Array([]),AA=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),id=new Uint8Array([]);function od(){var e=this;this.h=this.g=null,this.l=[],this.j=null,this.s=1,this.i=null,this.A=new Be(5),this.o=new st(function(){bA(e)}),this.u=new pr,this.m=new Map}s=od.prototype,s.configure=function(e){this.g=e},s.start=function(e,t){var n=this;return z(function(o){if(o.g==1)return n.l=[e],n.h=t,E(o,rd(n),2);if(!n.h)throw new K(2,7,7001);return o.return(n.j)})};function bA(e){var t;z(function(n){switch(n.g){case 1:return re(n,2),E(n,rd(e),4);case 4:ie(n,3);break;case 2:t=se(n),e.h&&(t.severity=1,e.h.onError(t));case 3:if(!e.h)return n.return();F(n)}})}s.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,this.o!=null&&(this.o.stop(),this.o=null),this.m.clear(),this.u.destroy()},s.update=function(){var e=this,t;return z(function(n){if(n.g==1)return re(n,2),E(n,rd(e),4);if(n.g!=2)return ie(n,0);if(t=se(n),!e.h||!t)return n.return();e.h.onError(t),F(n)})},s.onExpirationUpdated=function(){},s.onInitialVariantChosen=function(){},s.banLocation=function(){};function rd(e){var t,n,o,a,l,f,c;return z(function(p){if(p.g==1)return t=Yt(e.l,e.g.retryParameters),n=e.h.networkingEngine,o=Date.now(),a=n.request(0,t,{type:5}),No(e.u,a),E(p,a.promise,2);if(l=p.h,!e.h)return p.return();l.uri&&!e.l.includes(l.uri)&&e.l.unshift(l.uri);var m=l.uri,v=mc(l.data,"SmoothStreamingMedia");if(!v)throw new K(2,4,4046,m);if((m=e.g.mss.manifestPreprocessor)&&m(v),e.i||(e.i=new Je(null,0)),m=at(v,"IsLive",gc,!1))throw new K(2,4,4047);e.i.pc(!m);var S=at(v,"TimeScale",dn,1e7),C=at(v,"DVRWindowLength",dn);m&&(C===0||isNaN(C))&&(C=1/0);var T=at(v,"CanSeek",gc,!1);C===0&&T&&(C=1/0),T=null,C&&0<C&&(T=C/S),m&&!isNaN(e.g.availabilityWindowOverride)&&(T=e.g.availabilityWindowOverride),T==null&&(T=1/0),e.i.Xd(T),C=at(v,"Duration",dn,1/0),m||e.i.Pa(C/S),m={variants:[],textStreams:[],timescale:S,duration:C/S},T=kt(v,"Protection");var I;for(S=e.g.mss.keySystemsBySystemId,C=[],T=w(T),I=T.next();!I.done;I=T.next())C=C.concat(kt(I.value,"ProtectionHeader"));if(C.length){for(T=[],I=0;I<C.length;I++){var _=C[I],N=_.getAttribute("SystemID").toLowerCase(),j=S[N];if(j){var O=w1(_);if(O)e:{O=w(O.getElementsByTagName("DATA"));for(var X=O.next();!X.done;X=O.next())if(X=ui(X.value,"KID")){O=li(X.textContent),O=new Uint8Array([O[3],O[2],O[1],O[0],O[5],O[4],O[7],O[6]].concat(R(O.slice(8)))),O=xr(O);break e}O=null}else O=null;X=li(_.textContent),N=Bo(N.replace(/-/g,"")),N=[{initData:ml(X,N,new Set,0),initDataType:"cenc",keyId:O}],N=ao(j,N),O&&N.keyIds.add(O),(j=pA.get(j))&&(N.licenseServerUri=j(_)),T.push(N)}}S=T}else S=[];for(I=S,T=[],S=[],C=[],v=kt(v,"StreamIndex"),v=w(v),_=v.next();!_.done;_=v.next()){_=_.value,j=kt(_,"QualityLevel"),N=m.timescale,O=m.duration,X=kt(_,"c");for(var V=[],q=0,te=0;te<X.length;++te){var de=X[te],ce=X[te+1],he=at(de,"t",dn),ge=at(de,"d",dn);if(de=at(de,"r",vl),!ge)break;if(he=he??q,de=de||0,0>de)if(ce){if(ce=at(ce,"t",dn),ce==null)break;if(he>=ce)break;de=Math.ceil((ce-he)/ge)-1}else{if(O==1/0)break;if(he/N>=O)break;de=Math.ceil((O*N-he)/ge)-1}for(ce=0;ce<=de;++ce)q=he+ge,V.push({start:he/N,end:q/N,zf:he}),he=q}for(N=V,j=w(j),O=j.next();!O.done;O=j.next())(O=IA(e,_,O.value,N,I,m))&&(O.type!="audio"||e.g.disableAudio?O.type!="video"||e.g.disableVideo?O.type!=lt||e.g.disableText||C.push(O):S.push(O):T.push(O))}for(v=[],T=w(0<T.length?T:[null]),I=T.next();!I.done;I=T.next())for(I=I.value,_=w(0<S.length?S:[null]),O=_.next();!O.done;O=_.next())j=v,N=j.push,O=O.value,X=0,I&&I.bandwidth&&0<I.bandwidth&&(X+=I.bandwidth),O&&O.bandwidth&&0<O.bandwidth&&(X+=O.bandwidth),O={id:e.s++,language:I?I.language:"und",disabledUntilTime:0,primary:!!I&&I.primary||!!O&&O.primary,audio:I,video:O,bandwidth:X,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},N.call(j,O);m.variants=v,m.textStreams=C,e.j?(e.j.variants=m.variants,e.j.textStreams=m.textStreams,e.h.filter(e.j)):(e.j={presentationTimeline:e.i,variants:m.variants,textStreams:m.textStreams,imageStreams:[],offlineSessionIds:[],minBufferTime:0,sequenceMode:e.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null},e.i.Nd()),Promise.resolve(),f=Date.now(),c=(f-o)/1e3,e.A.sample(1,c),F(p)})}function IA(e,t,n,o,a,l){var f=t.getAttribute("Type");if(f!=="audio"&&f!=="video"&&f!=="text")return Le("Ignoring unrecognized type:",f),null;var c=t.getAttribute("Language"),p=e.s++,m=at(n,"Bitrate",Xi),v=at(n,"MaxWidth",Xi),S=at(n,"MaxHeight",Xi),C=at(n,"Channels",Xi),T=at(n,"SamplingRate",Xi),I=l.duration;o.length&&(I=o[o.length-1].end-o[0].start);var _=e.i.getDuration();e.i.Pa(Math.min(I,_));var N={id:p,originalId:t.getAttribute("Name")||String(p),groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:m||0,width:v||void 0,height:S||void 0,kind:"",encrypted:0<a.length,drmInfos:a,keyIds:new Set,language:ht(c||"und"),originalLanguage:c,label:"",type:"",primary:!1,trickModeVideo:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:C,audioSamplingRate:T,spatialAudio:!1,closedCaptions:null,hdr:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:I,timescale:l.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1};if((a=t.getAttribute("Subtype"))&&((a=PA[a])&&N.roles.push(a),a==="main"&&(N.primary=!0)),a=n.getAttribute("FourCC"),(a===null||a==="")&&(a=t.getAttribute("FourCC")),!a){if(f==="audio")a="AAC";else if(f==="video")return Le('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null}if(!LA.includes(a.toUpperCase()))return Le("Codec not supported:",a),null;switch(n=kA(n,f,a,N),N.mssPrivateData.codecPrivateData=n,f){case"audio":if(!n)return Le("Quality unsupported without CodecPrivateData",f),null;N.type="audio",N.mimeType="mss/audio/mp4",N.codecs=MA(a,n);break;case"video":if(!n)return Le("Quality unsupported without CodecPrivateData",f),null;N.type="video",N.mimeType="mss/video/mp4",N.codecs=_A(n);break;case"text":N.type=lt,N.mimeType="application/mp4",(a==="TTML"||a==="DFXP")&&(N.codecs="stpp")}return N.createSegmentIndex=function(){if(N.segmentIndex)return Promise.resolve();if(e.m.has(N.id))var j=e.m.get(N.id);else j=[],N.type=="video"&&(j=N.mssPrivateData.codecPrivateData.split("00000001").slice(1)),j={id:N.id,type:N.type,codecs:N.codecs,encrypted:N.encrypted,timescale:N.mssPrivateData.timescale,duration:N.mssPrivateData.duration,Ra:j,fa:new Uint8Array([]),la:new Uint8Array([]),sa:0,ua:0,data:null,stream:N},j=Xr(new Wr([j])),e.m.set(N.id,j);return j=RA(e,new $n(function(){return[]},0,null,null,void 0,j),N,t,o),N.segmentIndex=new ft(j),Promise.resolve()},N.closeSegmentIndex=function(){N.segmentIndex&&(N.segmentIndex.release(),N.segmentIndex=null)},N}function kA(e,t,n,o){if(e=e.getAttribute("CodecPrivateData"))return e;if(t!=="audio")return null;t=o.channelsCount||2,e=o.audioSamplingRate||44100;var a={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return o=a[e],n==="AACH"?(n=new Uint8Array(4),e=a[2*e],n[0]=40|o>>1,n[1]=o<<7|t<<3|e>>1,n[2]=e<<7|8,n[3]=0,t=new Uint16Array(2),t[0]=(n[0]<<8)+n[1],t[1]=(n[2]<<8)+n[3],t[0].toString(16)+t[1].toString(16)):(n=new Uint8Array(2),n[0]=16|o>>1,n[1]=o<<7|t<<3,t=new Uint16Array(1),t[0]=(n[0]<<8)+n[1],t[0].toString(16))}function MA(e,t){var n=0;return e==="AACH"&&(n=5),t?n===0&&(n=(parseInt(t.substr(0,2),16)&248)>>3):(n=2,e==="AACH"&&(n=5)),"mp4a.40."+n}function _A(e){var t=/00000001[0-9]7/.exec(e);return t.length&&e?"avc1."+e.substr(e.indexOf(t[0])+10,6):""}function RA(e,t,n,o,a){var l=o.getAttribute("Url").replace("{bitrate}",String(n.bandwidth));o=[];var f={};a=w(a);for(var c=a.next();!c.done;f={Bc:f.Bc},c=a.next())f.Bc=c.value,o.push(new Xe(f.Bc.start,f.Bc.end,function(p){return function(){return on(e.l,[l.replace("{start time}",String(p.Bc.zf))])}}(f),0,null,t,0,0,n.mssPrivateData.duration));return o}ae("shaka.mss.MssParser",od);var LA="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),PA={CAPT:"main",SUBT:"alternate",DESC:"main"};fi["application/vnd.ms-sstr+xml"]=function(){return new od};function b1(e,t,n,o,a,l){if(200<=n&&299>=n&&n!=202)return{uri:a||o,originalUri:o,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"]};a=null;try{a=lo(t)}catch{}throw new K(n==401||n==403?2:1,1,1001,o,n,a,e,l)}function sd(){}function Cu(e,t,n,o,a){var l=new BA;Rs(t.headers).forEach(function(m,v){l.append(v,m)});var f=new OA,c={Ff:!1,tg:!1};if(e=DA(e,n,{body:t.body||void 0,headers:l,method:t.method,signal:f.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},c,o,a,t.streamDataCallback),e=new Ut(e,function(){return c.Ff=!0,f.abort(),Promise.resolve()}),t=t.retryParameters.timeout){var p=new st(function(){c.tg=!0,f.abort()});p.U(t/1e3),e.finally(function(){p.stop()})}return e}function DA(e,t,n,o,a,l,f){var c,p,m,v,S,C,T,I,_,N,j,O,X;return z(function(V){switch(V.g){case 1:return c=NA,p=UA,C=S=0,T=Date.now(),re(V,2),E(V,c(e,n),4);case 4:if(m=V.h,l(I1(m.headers)),n.method=="HEAD"){V.B(5);break}return I=m.clone().body.getReader(),N=(_=m.headers.get("Content-Length"))?parseInt(_,10):0,j=function(q){function te(){var de,ce;return z(function(he){switch(he.g){case 1:return re(he,2),E(he,I.read(),4);case 4:de=he.h,ie(he,3);break;case 2:return se(he),he.return();case 3:if(de.done){he.B(5);break}if(S+=de.value.byteLength,!f){he.B(5);break}return E(he,f(de.value),5);case 5:ce=Date.now(),(100<ce-T||de.done)&&(a(ce-T,S-C,N-S),C=S,T=ce),de.done?q.close():(q.enqueue(de.value),te()),F(he)}})}te()},new p({start:j}),E(V,m.arrayBuffer(),6);case 6:v=V.h;case 5:ie(V,3);break;case 2:throw O=se(V),o.Ff?new K(1,1,7001,e,t):o.tg?new K(1,1,1003,e,t):new K(1,1,1002,e,O,t);case 3:return X=I1(m.headers),V.return(b1(X,v,m.status,e,m.url,t))}})}function I1(e){var t={};return e.forEach(function(n,o){t[o.trim()]=n}),t}function k1(){if(d.ReadableStream)try{new ReadableStream({})}catch{return!1}else return!1;if(d.Response){if(!new Response("").body)return!1}else return!1;return!(!d.fetch||!d.AbortController)}ae("shaka.net.HttpFetchPlugin",sd),sd.isSupported=k1,sd.parse=Cu;var NA=d.fetch,OA=d.AbortController,UA=d.ReadableStream,BA=d.Headers;k1()&&(zi("http",Cu,2,!0),zi("https",Cu,2,!0),zi("blob",Cu,2,!0));function M1(){}function Eu(e,t,n,o,a){var l=new jA,f=Date.now(),c=0,p=new Promise(function(m,v){l.open(t.method,e,!0),l.responseType="arraybuffer",l.timeout=t.retryParameters.timeout,l.withCredentials=t.allowCrossSiteCredentials,l.onabort=function(){v(new K(1,1,7001,e,n))};var S=!1;l.onreadystatechange=function(){if(l.readyState==2&&!S){var T=_1(l);a(T),S=!0}},l.onload=function(){var T=_1(l),I=l.response;try{var _=b1(T,I,l.status,e,l.responseURL,n);m(_)}catch(N){v(N)}},l.onerror=function(T){v(new K(1,1,1002,e,T,n))},l.ontimeout=function(){v(new K(1,1,1003,e,n))},l.onprogress=function(T){var I=Date.now();(100<I-f||T.lengthComputable&&T.loaded==T.total)&&(o(I-f,T.loaded-c,T.total-T.loaded),c=T.loaded,f=I)};for(var C in t.headers)l.setRequestHeader(C.toLowerCase(),t.headers[C]);l.send(t.body)});return new Ut(p,function(){return l.abort(),Promise.resolve()})}function _1(e){var t=e.getAllResponseHeaders().trim().split(`\r
`);e={},t=w(t);for(var n=t.next();!n.done;n=t.next())n=n.value.split(": "),e[n[0].toLowerCase()]=n.slice(1).join(": ");return e}ae("shaka.net.HttpXHRPlugin",M1),M1.parse=Eu;var jA=d.XMLHttpRequest;zi("http",Eu,1,!0),zi("https",Eu,1,!0),zi("blob",Eu,1,!0);function R1(e,t,n,o){this.g=e,this.i=t,this.groupId=n,this.h=o}function ad(e){return e.Z().map(function(t){return"{"+encodeURI(t)+"}"}).join("")+":"+e.Qa+":"+e.wa}function FA(e,t){return Rl(e.g.Z(),e.g.Qa,e.g.wa,t.streaming.retryParameters)}function L1(){this.h=this.j=this.i=0,this.g=new Map,this.l=0}function P1(e,t){e.i+=t;var n=e.l;return e.l++,e.g.set(n,t),n}L1.prototype.close=function(e,t){if(this.g.has(e)){var n=this.g.get(e);this.g.delete(e),this.j+=n,this.h+=t}};function D1(e){var t=this;this.o=e,this.j=new Map,this.i=new gr(function(){return ld(t).catch(function(){})}),this.h=[],this.m=function(){},this.l=function(){},this.g=new L1}D1.prototype.destroy=function(){return this.i.destroy()};function zA(e,t,n){e.m=t,e.l=n}function ld(e){var t=e.h.map(function(n){return n()});return e.h=[],Promise.all(t)}function VA(e,t,n,o,a,l){yt(e.i);var f=(e.j.get(t)||Promise.resolve()).then(function(){var c,p,m,v,S,C,T;return z(function(I){if(I.g==1)return E(I,$A(e,n),2);if(c=I.h,e.i.g)throw new K(2,9,7001);if(a)for(v in p=Ve(c),m=new C0(p),m.data)S=Number(v),C=m.data[S],T=m.g[S],e.l(C,T);e.g.close(o,c.byteLength);var _=e.g;return e.m(_.i==0?0:_.j/_.i,e.g.h),I.return(l(c))})});e.j.set(t,f)}function HA(e){return z(function(t){return t.g==1?E(t,Promise.all(e.j.values()),2):t.return(e.g.h)})}function $A(e,t){var n,o,a,l;return z(function(f){return f.g==1?(n=Li,o=e.o.request(n,t),a=function(){return o.abort()},e.h.push(a),E(f,o.promise,2)):(l=f.h,wn(e.h,a),f.return(l.data))})}function Au(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new bt,e.onabort=function(o){o.preventDefault(),n.g.reject()},e.onerror=function(o){o.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}Au.prototype.abort=function(){var e=this;return z(function(t){if(t.g==1){try{e.i.abort()}catch{}return re(t,2),E(t,e.g,4)}if(t.g!=2)return ie(t,0);se(t),F(t)})};function ud(e,t){return new Promise(function(n,o){var a=e.h.openCursor();a.onerror=o,a.onsuccess=function(){var l;return z(function(f){if(f.g==1)return a.result==null?(n(),f.return()):(l=a.result,E(f,t(l.key,l.value,l),2));l.continue(),F(f)})}})}Au.prototype.store=function(){return this.h},Au.prototype.promise=function(){return this.g};function fd(e){this.h=e,this.g=[]}fd.prototype.destroy=function(){return Promise.all(this.g.map(function(e){return e.abort()}))};function Yo(e,t){return bu(e,t,"readwrite")}function bu(e,t,n){n=e.h.transaction([t],n);var o=new Au(n,t);return e.g.push(o),o.promise().then(function(){wn(e.g,o)},function(){wn(e.g,o)}),o}function qo(e,t,n){this.h=new fd(e),this.i=t,this.g=n}s=qo.prototype,s.destroy=function(){return this.h.destroy()},s.hasFixedKeySpace=function(){return!0},s.addSegments=function(){return N1(this.i)},s.removeSegments=function(e,t){return O1(this,this.i,e,t)},s.getSegments=function(e){var t=this,n;return z(function(o){return o.g==1?E(o,U1(t,t.i,e),2):(n=o.h,o.return(n.map(function(a){return t.Hf(a)})))})},s.addManifests=function(){return N1(this.g)},s.updateManifest=function(){return Promise.reject(new K(2,9,9016,"Cannot modify values in "+this.g))};function GA(e,t,n){e=Yo(e.h,e.g);var o=e.store();return o.get(t).onsuccess=function(){o.put(n,t)},e.promise()}s.updateManifestExpiration=function(e,t){var n=Yo(this.h,this.g),o=n.store();return o.get(e).onsuccess=function(a){(a=a.target.result)&&(a.expiration=t,o.put(a,e))},n.promise()},s.removeManifests=function(e,t){return O1(this,this.g,e,t)},s.getManifests=function(e){var t=this,n;return z(function(o){return o.g==1?E(o,U1(t,t.g,e),2):(n=o.h,o.return(Promise.all(n.map(function(a){return t.Mc(a)}))))})},s.getAllManifests=function(){var e=this,t,n;return z(function(o){return o.g==1?(t=bu(e.h,e.g,"readonly"),n=new Map,E(o,ud(t,function(a,l){var f;return z(function(c){if(c.g==1)return E(c,e.Mc(l),2);f=c.h,n.set(a,f),F(c)})}),2)):o.g!=3?E(o,t.promise(),3):o.return(n)})},s.Hf=function(e){return e},s.Mc=function(e){return Promise.resolve(e)};function N1(e){return Promise.reject(new K(2,9,9011,"Cannot add new value to "+e))}s.add=function(e,t){var n=this,o,a,l,f,c,p,m;return z(function(v){if(v.g==1){for(o=Yo(n.h,e),a=o.store(),l=[],f={},c=w(t),p=c.next();!p.done;f={nd:f.nd},p=c.next())m=p.value,f.nd=a.add(m),f.nd.onsuccess=function(S){return function(){l.push(S.nd.result)}}(f);return E(v,o.promise(),2)}return v.return(l)})};function O1(e,t,n,o){e=Yo(e.h,t),t=e.store();var a={};n=w(n);for(var l=n.next();!l.done;a={ld:a.ld},l=n.next())a.ld=l.value,t.delete(a.ld).onsuccess=function(f){return function(){return o(f.ld)}}(a);return e.promise()}function U1(e,t,n){var o,a,l,f,c,p,m;return z(function(v){if(v.g==1){for(o=bu(e.h,t,"readonly"),a=o.store(),l={},f=[],c={},p=w(n),m=p.next();!m.done;c={zc:c.zc,xc:c.xc},m=p.next())c.xc=m.value,c.zc=a.get(c.xc),c.zc.onsuccess=function(S){return function(){S.zc.result==null&&f.push(S.xc),l[S.xc]=S.zc.result}}(c);return E(v,o.promise(),2)}if(f.length)throw new K(2,9,9012,"Could not find values for "+f);return v.return(n.map(function(S){return l[S]}))})}function da(e){this.g=new fd(e)}da.prototype.destroy=function(){return this.g.destroy()},da.prototype.getAll=function(){var e=this,t,n;return z(function(o){return o.g==1?(t=bu(e.g,"session-ids","readonly"),n=[],E(o,ud(t,function(a,l){n.push(l)}),2)):o.g!=3?E(o,t.promise(),3):o.return(n)})},da.prototype.add=function(e){var t=Yo(this.g,"session-ids"),n=t.store();e=w(e);for(var o=e.next();!o.done;o=e.next())n.add(o.value);return t.promise()},da.prototype.remove=function(e){var t=this,n;return z(function(o){return o.g==1?(n=Yo(t.g,"session-ids"),E(o,ud(n,function(a,l,f){e.includes(l.sessionId)&&f.delete()}),2)):E(o,n.promise(),0)})};function gn(){this.g=new Map}gn.prototype.destroy=function(){for(var e=[],t=w(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},gn.prototype.init=function(){var e=this;pa.forEach(function(a,l){(a=a())&&e.g.set(l,a)});for(var t=[],n=w(this.g.values()),o=n.next();!o.done;o=n.next())t.push(o.value.init());return Promise.all(t)};function B1(e){var t=null;if(e.g.forEach(function(n,o){n.getCells().forEach(function(a,l){a.hasFixedKeySpace()||t||(t={path:{Wa:o,va:l},va:a})})}),t)return t;throw new K(2,9,9013,"Could not find a cell that supports add-operations")}function WA(e,t){e.g.forEach(function(n,o){n.getCells().forEach(function(a,l){t({Wa:o,va:l},a)})})}function Iu(e,t,n){if(e=e.g.get(t),!e)throw new K(2,9,9013,"Could not find mechanism with name "+t);if(t=e.getCells().get(n),!t)throw new K(2,9,9013,"Could not find cell with name "+n);return t}function XA(e,t){e.g.forEach(function(n){t(n.getEmeSessionCell())})}function KA(e){var t=Array.from(e.g.keys());if(!t.length)throw new K(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}function YA(e){var t,n,o;return z(function(a){return a.g==1?(t=Array.from(e.g.values()),n=0<t.length,n||(o=pa,o.forEach(function(l){(l=l())&&t.push(l)})),E(a,Promise.all(t.map(function(l){return l.erase()})),2)):n?a.B(0):E(a,Promise.all(t.map(function(l){return l.destroy()})),0)})}function j1(e,t){pa.set(e,t)}ae("shaka.offline.StorageMuxer",gn),gn.unregister=function(e){pa.delete(e)},gn.register=j1,gn.prototype.destroy=gn.prototype.destroy;var pa=new Map;function ga(){qo.apply(this,arguments)}Z(ga,qo),ga.prototype.updateManifestExpiration=function(e,t){var n=this,o,a,l;return z(function(f){return o=Yo(n.h,n.g),a=o.store(),l=new bt,a.get(e).onsuccess=function(c){(c=c.target.result)?(c.expiration=t,a.put(c),l.resolve()):l.reject(new K(2,9,9012,"Could not find values for "+e))},E(f,Promise.all([o.promise(),l]),0)})},ga.prototype.Mc=function(e){var t,n,o,a,l,f;return z(function(c){if(c.g==1){for(t=[],n=0;n<e.periods.length;++n)o=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,a=o-e.periods[n].startTime,l=qA(e.periods[n],a),t.push(l);return E(c,by(t),2)}return f=c.h,c.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:e.expiration==null?1/0:e.expiration,streams:f,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})})};function qA(e,t){ZA(e);for(var n=w(e.streams),o=n.next();!o.done;o=n.next());return e.streams.map(function(a){return QA(a,e.startTime,t)})}function QA(e,t,n){var o=e.initSegmentUri?F1(e.initSegmentUri):null,a=t+e.presentationTimeOffset,l=t+n;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:o,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(f){var c=F1(f.uri);return{startTime:t+f.startTime,endTime:t+f.endTime,dataKey:c,initSegmentKey:o,appendWindowStart:t,appendWindowEnd:l,timestampOffset:a,tilesLayout:""}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1}}ga.prototype.Hf=function(e){return{data:e.data}};function F1(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new K(2,9,9004,"Could not parse uri "+e)}function ZA(e){var t=e.streams.filter(function(c){return c.contentType=="audio"});if(e=e.streams.filter(function(c){return c.contentType=="video"}),!t.every(function(c){return c.variantIds})||!e.every(function(c){return c.variantIds})){for(var n=w(t),o=n.next();!o.done;o=n.next())o.value.variantIds=[];for(n=w(e),o=n.next();!o.done;o=n.next())o.value.variantIds=[];if(n=0,e.length&&!t.length){var a=n++,l=w(e);for(o=l.next();!o.done;o=l.next())o.value.variantIds.push(a)}if(!e.length&&t.length)for(a=n++,l=w(t),o=l.next();!o.done;o=l.next())o.value.variantIds.push(a);if(e.length&&t.length)for(t=w(t),o=t.next();!o.done;o=t.next())for(o=o.value,a=w(e),l=a.next();!l.done;l=a.next()){l=l.value;var f=n++;o.variantIds.push(f),l.variantIds.push(f)}}}function ku(){qo.apply(this,arguments)}Z(ku,qo),ku.prototype.Mc=function(e){var t,n,o,a,l,f;return z(function(c){if(c.g==1){for(t=[],n=0;n<e.periods.length;++n){o=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,a=o-e.periods[n].startTime;for(var p=e.periods[n],m=[],v=w(p.streams),S=v.next();!S.done;S=v.next())S=S.value,S.variantIds.length!=0&&m.push(JA(S,p.startTime,p.startTime+a));l=m,t.push(l)}return E(c,by(t),2)}return f=c.h,c.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:e.expiration==null?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:f,sequenceMode:!1})})};function JA(e,t,n){return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(o){return{startTime:t+o.startTime,endTime:t+o.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:o.dataKey,tilesLayout:""}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1}}function cd(){qo.apply(this,arguments)}Z(cd,qo),s=cd.prototype,s.hasFixedKeySpace=function(){return!1},s.addSegments=function(e){return this.add(this.i,e)},s.addManifests=function(e){return this.add(this.g,e)},s.updateManifest=function(e,t){return GA(this,e,t)},s.Mc=function(e){return e.expiration==null&&(e.expiration=1/0),Promise.resolve(e)};function z1(){this.m=this.j=this.i=this.h=this.g=this.l=null}s=z1.prototype,s.init=function(){var e=this,t=new bt,n=!1,o=new st(function(){n=!0,t.reject(new K(2,9,9017))});o.U(5);var a=d.indexedDB.open("shaka_offline_db",5);return a.onsuccess=function(){if(!n){var l=a.result;e.l=l;var f=l.objectStoreNames;f=f.contains("manifest")&&f.contains("segment")?new ga(l,"segment","manifest"):null,e.g=f,f=l.objectStoreNames,f=f.contains("manifest-v2")&&f.contains("segment-v2")?new ku(l,"segment-v2","manifest-v2"):null,e.h=f,f=l.objectStoreNames,f=f.contains("manifest-v3")&&f.contains("segment-v3")?new ku(l,"segment-v3","manifest-v3"):null,e.i=f,f=l.objectStoreNames,f=f.contains("manifest-v5")&&f.contains("segment-v5")?new cd(l,"segment-v5","manifest-v5"):null,e.j=f,l=l.objectStoreNames.contains("session-ids")?new da(l):null,e.m=l,o.stop(),t.resolve()}},a.onupgradeneeded=function(){for(var l=a.result,f=w(["segment-v5","manifest-v5","session-ids"]),c=f.next();!c.done;c=f.next())c=c.value,l.objectStoreNames.contains(c)||l.createObjectStore(c,{autoIncrement:!0})},a.onerror=function(l){n||(t.reject(new K(2,9,9001,a.error)),o.stop(),l.preventDefault())},t},s.destroy=function(){var e=this;return z(function(t){switch(t.g){case 1:if(!e.g){t.B(2);break}return E(t,e.g.destroy(),2);case 2:if(!e.h){t.B(4);break}return E(t,e.h.destroy(),4);case 4:if(!e.i){t.B(6);break}return E(t,e.i.destroy(),6);case 6:if(!e.j){t.B(8);break}return E(t,e.j.destroy(),8);case 8:if(!e.m){t.B(10);break}return E(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),F(t)}})},s.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},s.getEmeSessionCell=function(){return this.m},s.erase=function(){var e=this;return z(function(t){switch(t.g){case 1:if(!e.g){t.B(2);break}return E(t,e.g.destroy(),2);case 2:if(!e.h){t.B(4);break}return E(t,e.h.destroy(),4);case 4:if(!e.i){t.B(6);break}return E(t,e.i.destroy(),6);case 6:if(!e.j){t.B(8);break}return E(t,e.j.destroy(),8);case 8:return e.l&&e.l.close(),E(t,e4(),10);case 10:return e.l=null,e.g=null,e.h=null,e.i=null,e.j=null,E(t,e.init(),0)}})};function e4(){var e=new bt,t=d.indexedDB.deleteDatabase("shaka_offline_db");return t.onblocked=function(){},t.onsuccess=function(){e.resolve()},t.onerror=function(n){e.reject(new K(2,9,9001,t.error)),n.preventDefault()},e}j1("idb",function(){return ar()||Ms()||!d.indexedDB?null:new z1});function Ni(e,t,n,o){this.g=e,this.i=t,this.h=n,this.l=o,this.j=["offline:",e,"/",t,"/",n,"/",o].join("")}Ni.prototype.Wa=function(){return this.i},Ni.prototype.va=function(){return this.h},Ni.prototype.key=function(){return this.l},Ni.prototype.toString=function(){return this.j};function hd(e){if(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e),e==null)return null;var t=e[1];if(t!="manifest"&&t!="segment")return null;var n=e[2];if(!n)return null;var o=e[3];return o&&t!=null?new Ni(t,n,o,Number(e[4])):null}function V1(e,t){this.h=e,this.g=t}function H1(e,t){var n=new Je(null,0);n.Pa(t.duration);var o=t.streams.filter(function(m){return m.type=="audio"}),a=t.streams.filter(function(m){return m.type=="video"});o=t4(e,o,a,n),a=t.streams.filter(function(m){return m.type==lt}).map(function(m){return Mu(e,m,n)});var l=t.streams.filter(function(m){return m.type=="image"}).map(function(m){return Mu(e,m,n)}),f=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var c=w(o.values()),p=c.next();!p.done;p=c.next())p=p.value,p.audio&&p.audio.encrypted&&(p.audio.drmInfos=f),p.video&&p.video.encrypted&&(p.video.drmInfos=f);return{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,variants:Array.from(o.values()),textStreams:a,imageStreams:l,sequenceMode:t.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:t.type||"UNKNOWN",serviceDescription:null}}function t4(e,t,n,o){for(var a=new Set,l=w(t),f=l.next();!f.done;f=l.next()){var c=w(f.value.variantIds);for(f=c.next();!f.done;f=c.next())a.add(f.value)}for(l=w(n),f=l.next();!f.done;f=l.next())for(c=w(f.value.variantIds),f=c.next();!f.done;f=c.next())a.add(f.value);for(l=new Map,a=w(a),f=a.next();!f.done;f=a.next())f=f.value,l.set(f,{id:f,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(t=w(t),a=t.next();!a.done;a=t.next())for(a=a.value,f=Mu(e,a,o),c=w(a.variantIds),a=c.next();!a.done;a=c.next())a=l.get(a.value),a.language=f.language,a.primary=a.primary||f.primary,a.audio=f;for(n=w(n),t=n.next();!t.done;t=n.next())for(a=t.value,t=Mu(e,a,o),f=w(a.variantIds),a=f.next();!a.done;a=f.next())a=l.get(a.value),a.primary=a.primary||t.primary,a.video=t;return l}function Mu(e,t,n){var o=t.segments.map(function(a){return n4(e,a)});return n.Xc(o),{id:t.id,originalId:t.originalId,groupId:t.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new ft(o),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,videoLayout:t.videoLayout,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,originalLanguage:t.originalLanguage||null,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout,accessibilityPurpose:null,external:t.external,fastSwitching:t.fastSwitching}}function n4(e,t){var n=new Ni("segment",e.h,e.g,t.dataKey);return new Xe(t.startTime,t.endTime,function(){return[n.toString()]},0,null,t.initSegmentKey!=null?i4(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||"")}function i4(e,t){var n=new Ni("segment",e.h,e.g,t);return new $n(function(){return[n.toString()]},0,null)}function $1(){this.g=null}s=$1.prototype,s.configure=function(){},s.start=function(e,t){var n=this,o,a,l,f,c,p,m;return z(function(v){switch(v.g){case 1:if(o=hd(e),n.g=o,o==null||o.g!="manifest")throw new K(2,1,9004,e);return a=new gn,ye(v,2),E(v,a.init(),4);case 4:return E(v,Iu(a,o.Wa(),o.va()),5);case 5:return l=v.h,E(v,l.getManifests([o.key()]),6);case 6:return f=v.h,c=f[0],p=new V1(o.Wa(),o.va()),m=H1(p,c),t.makeTextStreamsForClosedCaptions(m),v.return(m);case 2:return ne(v),E(v,a.destroy(),7);case 7:le(v,0)}})},s.stop=function(){return Promise.resolve()},s.update=function(){},s.onExpirationUpdated=function(e,t){var n=this,o,a,l,f,c,p,m;return z(function(v){switch(v.g){case 1:return o=n.g,a=new gn,re(v,2,3),E(v,a.init(),5);case 5:return E(v,Iu(a,o.Wa(),o.va()),6);case 6:return l=v.h,E(v,l.getManifests([o.key()]),7);case 7:if(f=v.h,c=f[0],p=c.sessionIds.includes(e),m=c.expiration==null||c.expiration>t,!p||!m){v.B(3);break}return E(v,l.updateManifestExpiration(o.key(),t),3);case 3:return ne(v),E(v,a.destroy(),10);case 10:le(v,0);break;case 2:se(v),v.B(3)}})},s.onInitialVariantChosen=function(){},s.banLocation=function(){},fi["application/x-offline-manifest"]=function(){return new $1};function G1(){}function W1(e){var t=hd(e);return t&&t.g=="manifest"?(e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}},e=dr(e)):e=t&&t.g=="segment"?o4(t.key(),t):Do(new K(2,1,9004,e)),e}function o4(e,t){var n=new gn;return dr(void 0).pa(function(){return n.init()}).pa(function(){return Iu(n,t.Wa(),t.va())}).pa(function(o){return o.getSegments([t.key()])}).pa(function(o){return{uri:t,data:o[0].data,headers:{}}}).finally(function(){return n.destroy()})}ae("shaka.offline.OfflineScheme",G1),G1.plugin=W1,zi("offline",W1);function X1(e,t,n){var o,a,l,f,c,p;return z(function(m){switch(m.g){case 1:o=[];for(var v=[],S=w(n),C=S.next();!C.done;C=S.next()){C=C.value;for(var T=!1,I=w(v),_=I.next();!_.done;_=I.next())if(_=_.value,s4(_.info,C)){_.sessionIds.push(C.sessionId),T=!0;break}T||v.push({info:C,sessionIds:[C.sessionId]})}a=w(v),l=a.next();case 2:if(l.done){m.B(4);break}return f=l.value,c=r4(e,t,f),E(m,c,5);case 5:p=m.h,o=o.concat(p),l=a.next(),m.B(2);break;case 4:return m.return(o)}})}function r4(e,t,n){var o,a;return z(function(l){switch(l.g){case 1:return o=new xl({Tb:t,onError:function(){},Ud:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),re(l,2),o.configure(e),E(l,Ow(o,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:ie(l,3);break;case 2:return se(l),E(l,o.destroy(),5);case 5:return l.return([]);case 3:return a=[],E(l,Promise.all(n.sessionIds.map(function(f){return z(function(c){if(c.g==1)return re(c,2),E(c,jw(o,f),4);if(c.g!=2)return a.push(f),ie(c,0);se(c),F(c)})})),6);case 6:return E(l,o.destroy(),7);case 7:return l.return(a)}})}function s4(e,t){function n(o,a){return o.robustness==a.robustness&&o.contentType==a.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&vi(e.audioCapabilities,t.audioCapabilities,n)&&vi(e.videoCapabilities,t.videoCapabilities,n)}function a4(e,t,n){var o=t.presentationTimeline.getDuration();return t=K1(t),{offlineUri:null,originalManifestUri:e,duration:o,size:0,expiration:1/0,tracks:t,appMetadata:n,isIncomplete:!1}}function dd(e,t){var n=H1(new V1(e.Wa(),e.va()),t),o=t.appMetadata||{};return n=K1(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:o,isIncomplete:t.isIncomplete||!1}}function K1(e){var t=[],n=rc(e.variants);n=w(n);for(var o=n.next();!o.done;o=n.next())t.push(fr(o.value));for(e=w(e.textStreams),n=e.next();!n.done;n=e.next())t.push(sl(n.value));return t}function l4(){this.g={}}function u4(e,t){var n=t.audio,o=t.video;if(n&&!o&&(e.g[n.id]=n.bandwidth||t.bandwidth),!n&&o&&(e.g[o.id]=o.bandwidth||t.bandwidth),n&&o){var a=n.bandwidth||393216,l=o.bandwidth||t.bandwidth-a;0>=l&&(l=t.bandwidth),e.g[n.id]=a,e.g[o.id]=l}}function f4(e,t){e.g[t.id]=t.bandwidth||2048}function Y1(e,t){return e=e.g[t],e==null&&(e=0),e}function Xt(e){var t=this;if(e&&e.constructor!=pe)throw new K(2,9,9008);this.g=this.h=null,e?(this.h=e.g,this.g=e.Ob()):(this.h=Mr(),this.g=new Tt),this.i=[],this.j=[];var n=!e;this.l=new gr(function(){var o,a,l,f,c;return z(function(p){switch(p.g){case 1:return E(p,Promise.all(t.j.map(function(m){return ld(m)})),2);case 2:for(o=function(){},a=[],l=w(t.i),f=l.next();!f.done;f=l.next())c=f.value,a.push(c.then(o,o));return E(p,Promise.all(a),3);case 3:if(!n){p.B(4);break}return E(p,t.g.destroy(),4);case 4:t.h=null,t.g=null,F(p)}})})}function pd(){if(wi())e:{for(var e=w(pa.values()),t=e.next();!t.done;t=e.next())if(t=t.value,t=t()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}s=Xt.prototype,s.destroy=function(){return this.l.destroy()},s.configure=function(e,t){return arguments.length==2&&typeof e=="string"&&(e=eh(e,t)),_r(this.h,e)},s.getConfiguration=function(){var e=Mr();return _r(e,this.h,Mr()),e},s.Ob=function(){return this.g},s.store=function(e,t,n){var o=this,a=this.getConfiguration(),l=new D1(this.g);return this.j.push(l),t=c4(this,e,t||{},function(){var f;return z(function(c){return c.g==1?n?c.B(2):E(c,Gc(e,o.g,a.manifest.retryParameters),3):(c.g!=2&&(n=c.h),f=F0(e,n||null),c.return(f()))})},a,l),t=new Ut(t,function(){return ld(l)}),t.finally(function(){wn(o.j,l)}),A4(this,t)};function c4(e,t,n,o,a,l){var f,c,p,m,v,S,C,T,I,_,N,j,O,X;return z(function(V){switch(V.g){case 1:return _u(),c=f=null,p=new gn,S=v=m=null,re(V,2,3),E(V,o(),5);case 5:return f=V.h,E(V,w4(e,t,f,a),6);case 6:if(C=V.h,en(e),T=!C.presentationTimeline.R()&&!C.presentationTimeline.Rb(),!T)throw new K(2,9,9005,t);return E(V,S4(e,C,function(q){S=S||q},a),7);case 7:if(c=V.h,en(e),S)throw S;return E(V,d4(C,c,a),8);case 8:return E(V,p.init(),9);case 9:return en(e),E(V,B1(p),10);case 10:return m=V.h,en(e),I=p4(c,C,t,n,a,l),_=I.Ah,N=I.vf,E(V,m.va.addManifests([_]),11);case 11:if(j=V.h,en(e),v=j[0],en(e),S)throw S;return E(V,h4(e,N,v,_,l,a,m.va,C,c),12);case 12:return en(e),J1(C,_,c,a),E(V,m.va.updateManifest(v,_),13);case 13:return en(e),O=new Ni("manifest",m.path.Wa,m.path.va,v),V.return(dd(O,_));case 3:return ne(V),E(V,p.destroy(),14);case 14:if(!f){V.B(15);break}return E(V,f.stop(),15);case 15:if(!c){V.B(17);break}return E(V,c.destroy(),17);case 17:le(V,0);break;case 2:if(X=se(V),v==null){V.B(19);break}return E(V,q1(v),19);case 19:throw S||X}})}function h4(e,t,n,o,a,l,f,c,p){var m,v,S,C,T,I,_,N,j,O;return z(function(X){switch(X.g){case 1:if(m={},v=0,S=function(V,q){var te,de,ce,he,ge,Se,ke;return z(function(Ne){if(Ne.g==1){for(te={},de=w(V),ce=de.next();!ce.done;te={Ib:te.Ib},ce=de.next())te.Ib=ce.value,he=FA(te.Ib,l),ge=te.Ib.i,Se=te.Ib.h,ke=function(He){return function(Ge){var Ze,Oe,zt;return z(function(Qt){if(Qt.g==1)return E(Qt,f.addSegments([{data:Ge}]),2);Ze=Qt.h,en(e),Oe=He.Ib.g,zt=ad(Oe),m[zt]=Ze[0],v+=Ge.byteLength,F(Qt)})}}(te),VA(a,te.Ib.groupId,he,ge,Se,ke);return E(Ne,HA(a),2)}return q?(en(e),J1(c,o,p,l),E(Ne,f.updateManifest(n,o),0)):Ne.B(0)})},C=!1,re(X,2),!gd(c)||!C||Z1(c)){X.B(4);break}return E(X,S(t.filter(function(V){return V.h}),!0),5);case 5:return en(e),t=t.filter(function(V){return!V.h}),T=m,I=v,m={},v=0,E(X,Q1(f,n,o,T,I,function(){return en(e)}),6);case 6:en(e);case 4:if(C){X.B(7);break}return E(X,S(t,!1),8);case 8:return en(e),_=m,N=v,m={},v=0,E(X,Q1(f,n,o,_,N,function(){return en(e)}),9);case 9:en(e);case 7:ie(X,0);break;case 2:return j=se(X),O=Object.values(m),E(X,f.removeSegments(O,function(){}),10);case 10:throw j}})}function q1(e){var t,n,o,a;return z(function(l){switch(l.g){case 1:return t=new gn,E(l,t.init(),2);case 2:return E(l,B1(t),3);case 3:return n=l.h,o=new Ni("manifest",n.path.Wa,n.path.va,e),E(l,t.destroy(),4);case 4:return a=new Xt,E(l,a.remove(o.toString()),0)}})}function Q1(e,t,n,o,a,l){var f,c,p,m,v,S,C,T,I,_,N;return z(function(j){switch(j.g){case 1:for(f=!1,re(j,2),c=!0,p=w(n.streams),m=p.next();!m.done;m=p.next())for(v=m.value,S=w(v.segments),C=S.next();!C.done;C=S.next())T=C.value,I=T.pendingSegmentRefId?o[T.pendingSegmentRefId]:null,I!=null&&(T.dataKey=I,T.pendingSegmentRefId=void 0),I=T.pendingInitSegmentRefId?o[T.pendingInitSegmentRefId]:null,I!=null&&(T.initSegmentKey=I,T.pendingInitSegmentRefId=void 0),T.pendingSegmentRefId&&(c=!1),T.pendingInitSegmentRefId&&(c=!1);return n.size+=a,c&&(n.isIncomplete=!1),E(j,e.updateManifest(t,n),4);case 4:f=!0,l(),ie(j,0);break;case 2:return _=se(j),E(j,q1(t),5);case 5:if(f){j.B(6);break}return N=Object.values(o),E(j,e.removeSegments(N,function(){}),6);case 6:throw _}})}function d4(e,t,n){var o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X,V,q,te,de,ce,he,ge,Se,ke,Ne,He;return z(function(Ge){switch(Ge.g){case 1:return o={width:1/0,height:1/0},nw(e,n.restrictions,o),E(Ge,Wp(t,e,n.offline.usePersistentLicense),2);case 2:for(a=[],l=n.preferredDecodingAttributes,f=n.preferredVideoCodecs,c=n.preferredAudioCodecs,$p(e,f,c,l),p=w(e.variants),m=p.next();!m.done;m=p.next())v=m.value,a.push(fr(v));for(S=w(e.textStreams),C=S.next();!C.done;C=S.next())T=C.value,a.push(sl(T));for(I=w(e.imageStreams),_=I.next();!_.done;_=I.next())N=_.value,a.push(nc(N));return E(Ge,n.offline.trackSelectionCallback(a),3);case 3:for(j=Ge.h,O=e.presentationTimeline.getDuration(),X=0,V=w(j),q=V.next();!q.done;q=V.next())te=q.value,de=te.bandwidth*O/8,X+=de;return re(Ge,4),E(Ge,n.offline.downloadSizeCallback(X),6);case 6:if(ce=Ge.h,!ce)throw new K(2,9,9014);ie(Ge,5);break;case 4:throw he=se(Ge),he instanceof K?he:new K(2,9,9015);case 5:for(ge=new Set,Se=new Set,ke=new Set,Ne=w(j),q=Ne.next();!q.done;q=Ne.next())He=q.value,He.type=="variant"&&ge.add(He.id),He.type=="text"&&Se.add(He.id),He.type=="image"&&ke.add(He.id);e.variants=e.variants.filter(function(Ze){return ge.has(Ze.id)}),e.textStreams=e.textStreams.filter(function(Ze){return Se.has(Ze.id)}),e.imageStreams=e.imageStreams.filter(function(Ze){return ke.has(Ze.id)}),k4(e),F(Ge)}})}function p4(e,t,n,o,a,l){var f=a4(n,t,o),c=a.offline.progressCallback;zA(l,function(T,I){f.size=I,c(f,T)},function(T,I){p&&a.offline.usePersistentLicense&&m==I&&Ds(e,"cenc",T)});var p=gd(t)&&!Z1(t),m=null;p&&(m=M4.get(e.g.keySystem));for(var v=new l4,S=w(t.textStreams),C=S.next();!C.done;C=S.next())v.g[C.value.id]=52;for(S=w(t.imageStreams),C=S.next();!C.done;C=S.next())f4(v,C.value);for(C=w(t.variants),S=C.next();!S.done;S=C.next())u4(v,S.value);return v=T4(l,v,t,a),l=v.streams,v=v.vf,C=e.g,S=a.offline.usePersistentLicense,C&&S&&(C.initData=[]),{Ah:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.Qc(),streams:l,sessionIds:S?R0(e):[],drmInfo:C,appMetadata:o,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},vf:v}}function gd(e){return e.variants.some(function(t){var n=t.audio&&t.audio.encrypted;return t.video&&t.video.encrypted||n})}function Z1(e){return e.variants.some(function(t){return(t.video?t.video.drmInfos:[]).concat(t.audio?t.audio.drmInfos:[]).some(function(n){return n.initData&&n.initData.length})})}function J1(e,t,n,o){if(t.expiration=n.Qc(),n=R0(n),t.sessionIds=o.offline.usePersistentLicense?n:[],gd(e)&&o.offline.usePersistentLicense&&!n.length)throw new K(2,9,9007)}s.remove=function(e){return md(this,g4(this,e))};function g4(e,t){var n,o,a,l,f,c;return z(function(p){switch(p.g){case 1:if(_u(),n=hd(t),n==null||n.g!="manifest")throw new K(2,9,9004,t);return o=n,a=new gn,ye(p,2),E(p,a.init(),4);case 4:return E(p,Iu(a,o.Wa(),o.va()),5);case 5:return l=p.h,E(p,l.getManifests([o.key()]),6);case 6:return f=p.h,c=f[0],E(p,Promise.all([m4(e,c,a),y4(l,o,c)]),2);case 2:return ne(p),E(p,a.destroy(),8);case 8:le(p,0)}})}function ev(e,t){for(var n=[],o=w(e.streams),a=o.next();!a.done;a=o.next())a=a.value,t&&a.type=="video"?n.push({contentType:Rn(a.mimeType,a.codecs),robustness:e.drmInfo.videoRobustness}):t||a.type!="audio"||n.push({contentType:Rn(a.mimeType,a.codecs),robustness:e.drmInfo.audioRobustness});return n}function m4(e,t,n){return z(function(o){return E(o,I4(e.g,e.h.drm,n,t),0)})}function y4(e,t,n){function o(){}var a=b4(n);return dd(t,n),Promise.all([e.removeSegments(a,o),e.removeManifests([t.key()],o)])}s.Oh=function(){return md(this,v4(this))};function v4(e){var t,n,o,a,l,f,c,p,m,v;return z(function(S){switch(S.g){case 1:return _u(),t=e.g,n=e.h.drm,o=new gn,a=!1,ye(S,2),E(S,o.init(),4);case 4:l=[],XA(o,function(C){return l.push(C)}),f=w(l),c=f.next();case 5:if(c.done){S.B(2);break}return p=c.value,E(S,p.getAll(),8);case 8:return m=S.h,E(S,X1(n,t,m),9);case 9:return v=S.h,E(S,p.remove(v),10);case 10:v.length!=m.length&&(a=!0),c=f.next(),S.B(5);break;case 2:return ne(S),E(S,o.destroy(),11);case 11:le(S,3);break;case 3:return S.return(!a)}})}s.list=function(){return md(this,x4())};function x4(){var e,t,n;return z(function(o){switch(o.g){case 1:return _u(),e=[],t=new gn,ye(o,2),E(o,t.init(),4);case 4:return n=Promise.resolve(),WA(t,function(a,l){n=n.then(function(){var f;return z(function(c){if(c.g==1)return E(c,l.getAllManifests(),2);f=c.h,f.forEach(function(p,m){p=dd(new Ni("manifest",a.Wa,a.va,m),p),e.push(p)}),F(c)})})}),E(o,n,2);case 2:return ne(o),E(o,t.destroy(),6);case 6:le(o,3);break;case 3:return o.return(e)}})}function w4(e,t,n,o){var a,l,f,c,p;return z(function(m){if(m.g==1)return a=null,l=e.g,f={networkingEngine:l,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(v){a=v},isLowLatencyMode:function(){return!1},isAutoLowLatencyMode:function(){return!1},enableLowLatencyMode:function(){},updateDuration:function(){},newDrmInfo:function(){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return o.abr.defaultBandwidthEstimate}},n.configure(o.manifest),en(e),E(m,n.start(t,f),2);if(m.g!=3)return c=m.h,en(e),p=tv(c),E(m,Promise.all(fc(p,function(v){return v.createSegmentIndex()})),3);if(en(e),a)throw a;return m.return(c)})}function S4(e,t,n,o){var a;return z(function(l){return l.g==1?(a=new xl({Tb:e.g,onError:n,Ud:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),a.configure(o.drm),E(l,Nw(a,t.variants,o.offline.usePersistentLicense),2)):l.g!=3?E(l,M0(a),3):l.return(a)})}function T4(e,t,n,o){var a=new Map,l=tv(n),f=new Map;l=w(l);for(var c=l.next();!c.done;c=l.next()){c=c.value;var p=C4(e,t,n,c,o,a);f.set(c.id,p)}for(e=w(n.variants),t=e.next();!t.done;t=e.next())t=t.value,t.audio&&f.get(t.audio.id).variantIds.push(t.id),t.video&&f.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(f.values()),vf:Array.from(a.values())}}function C4(e,t,n,o,a,l){var f={id:o.id,originalId:o.originalId,groupId:o.groupId,primary:o.primary,type:o.type,mimeType:o.mimeType,codecs:o.codecs,frameRate:o.frameRate,pixelAspectRatio:o.pixelAspectRatio,hdr:o.hdr,videoLayout:o.videoLayout,kind:o.kind,language:o.language,originalLanguage:o.originalLanguage,label:o.label,width:o.width||null,height:o.height||null,encrypted:o.encrypted,keyIds:o.keyIds,segments:[],variantIds:[],roles:o.roles,forced:o.forced,channelsCount:o.channelsCount,audioSamplingRate:o.audioSamplingRate,spatialAudio:o.spatialAudio,closedCaptions:o.closedCaptions,tilesLayout:o.tilesLayout,external:o.external,fastSwitching:o.fastSwitching},c=a.offline.numberOfParallelDownloads,p=0;return E4(o,n.presentationTimeline.eb(),function(m){var v=ad(m),S=void 0;if(!l.has(v)){var C=m.endTime-m.startTime;C=Y1(t,o.id)*C,C=P1(e.g,C),l.set(v,new R1(m,C,p,!1))}m.aa&&(S=ad(m.aa),l.has(S)||(C=.5*Y1(t,o.id),C=P1(e.g,C),l.set(S,new R1(m.aa,C,p,!0)))),f.segments.push({pendingInitSegmentRefId:S,initSegmentKey:S?0:null,startTime:m.startTime,endTime:m.endTime,appendWindowStart:m.appendWindowStart,appendWindowEnd:m.appendWindowEnd,timestampOffset:m.timestampOffset,tilesLayout:m.tilesLayout,pendingSegmentRefId:v,dataKey:0}),p=(p+1)%c}),f}function E4(e,t,n){if(t=e.segmentIndex.find(t),t!=null)for(var o=e.segmentIndex.get(t);o;)n(o),o=e.segmentIndex.get(++t)}function en(e){if(e.l.g)throw new K(2,9,7001)}function _u(){if(!pd())throw new K(2,9,9e3)}function md(e,t){return z(function(n){return n.g==1?(e.i.push(t),ye(n,2),E(n,t,4)):n.g!=2?n.return(n.h):(ne(n),wn(e.i,t),le(n,0))})}function A4(e,t){var n=t.promise;return e.i.push(n),t.finally(function(){wn(e.i,n)})}function b4(e){var t=new Set;e=w(e.streams);for(var n=e.next();!n.done;n=e.next()){n=w(n.value.segments);for(var o=n.next();!o.done;o=n.next())o=o.value,o.initSegmentKey!=null&&t.add(o.initSegmentKey),t.add(o.dataKey)}return Array.from(t)}function I4(e,t,n,o){var a,l,f;return z(function(c){return c.g==1?o.drmInfo?(a=KA(n),l=o.sessionIds.map(function(p){return{sessionId:p,keySystem:o.drmInfo.keySystem,licenseUri:o.drmInfo.licenseServerUri,serverCertificate:o.drmInfo.serverCertificate,audioCapabilities:ev(o,!1),videoCapabilities:ev(o,!0)}}),E(c,X1(t,e,l),2)):c.return():c.g!=3?(f=c.h,E(c,a.remove(f),3)):E(c,a.add(l.filter(function(p){return!f.includes(p.sessionId)})),0)})}function tv(e){for(var t=new Set,n=w(e.textStreams),o=n.next();!o.done;o=n.next())t.add(o.value);for(n=w(e.imageStreams),o=n.next();!o.done;o=n.next())t.add(o.value);for(e=w(e.variants),n=e.next();!n.done;n=e.next())n=n.value,n.audio&&t.add(n.audio),n.video&&t.add(n.video);return t}function k4(e){e.variants.map(function(l){return l.video});var t=new Set(e.variants.map(function(l){return l.audio}));e=e.textStreams;for(var n=w(t),o=n.next();!o.done;o=n.next()){o=w(t);for(var a=o.next();!a.done;a=o.next());}for(t=w(e),n=t.next();!n.done;n=t.next())for(n=w(e),o=n.next();!o.done;o=n.next());}ae("shaka.offline.Storage",Xt),Xt.deleteAll=function(){var e;return z(function(t){return t.g==1?(e=new gn,ye(t,2),E(t,YA(e),2)):t.g!=5?(ne(t),E(t,e.destroy(),5)):le(t,0)})},Xt.prototype.list=Xt.prototype.list,Xt.prototype.removeEmeSessions=Xt.prototype.Oh,Xt.prototype.remove=Xt.prototype.remove,Xt.prototype.store=Xt.prototype.store,Xt.prototype.getNetworkingEngine=Xt.prototype.Ob,Xt.prototype.getConfiguration=Xt.prototype.getConfiguration,Xt.prototype.configure=Xt.prototype.configure,Xt.prototype.destroy=Xt.prototype.destroy,Xt.support=pd;var M4=new Map().set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");mh.offline=pd;function qt(){}function fn(e,t){for(e={priority:t||0,callback:e},t=0;t<ma.length;t++)if(ma[t].priority<e.priority){ma.splice(t,0,e);return}ma.push(e)}ae("shaka.polyfill",qt),qt.register=fn,qt.installAll=function(){for(var e=w(ma),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(n){Le("Error installing polyfill!",n)}}};var ma=[];function ya(){this.g=new Ru}function nv(){d.AbortController||(d.AbortController=ya,d.AbortSignal=Ru)}ya.prototype.abort=function(e){var t=this.g;t.h||(t.h=!0,t.g=e,t.g===void 0&&(t.g=new DOMException("signal is aborted without reason","AbortError")),e=new We("abort"),t.onabort&&t.onabort(e),t.dispatchEvent(e))},k.Object.defineProperties(ya.prototype,{signal:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),qt.AbortController=ya,ya.install=nv;function Ru(){dt.call(this),this.h=!1,this.g=void 0,this.onabort=null}Z(Ru,dt),k.Object.defineProperties(Ru.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return this.h}},reason:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),fn(nv);function iv(){}function ov(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var e=w(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())_4(t.value)}function _4(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(n){n==null||n==null?this.removeAttribute(t):this.setAttribute(t,n)}})}qt.Aria=iv,iv.install=ov,fn(ov);function rv(){}function sv(){Cx()}qt.EncryptionScheme=rv,rv.install=sv,fn(sv,-2);function av(){}function lv(){if(d.Document){var e=Element.prototype;e.requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,e=Document.prototype,e.exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Kr),document.addEventListener("webkitfullscreenerror",Kr),document.addEventListener("mozfullscreenchange",Kr),document.addEventListener("mozfullscreenerror",Kr),document.addEventListener("MSFullscreenChange",Kr),document.addEventListener("MSFullscreenError",Kr)}}function Kr(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),n=document.createEvent("Event");n.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(n)}qt.Fullscreen=av,av.install=lv,fn(lv);function Lu(){}function uv(){var e=!0;(tl()||Rt("PlayStation 5")||lr()||Rt("Web0S")||Po()||ar()||Rt("PC=EOS")||Rt("Hisense")||Rt("VIDAA"))&&(e=!1),e&&navigator.mediaCapabilities||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),fv=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=R4)}function R4(e){var t,n,o,a,l,f,c,p,m,v,S,C,T,I,_,N,j,O,X;return z(function(V){switch(V.g){case 1:if(t={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},!e)return V.return(t);if(n=e.video,o=e.audio,e.type=="media-source"){if(!wi())return V.return(t);if(n){if(ar())if(d.cast&&cast.__platform__&&cast.__platform__.canDisplayType){var q=n.contentType;n.width&&n.height&&(q+="; width="+n.width+"; height="+n.height),n.framerate&&(q+="; framerate="+n.framerate),n.transferFunction==="pq"&&(q+="; eotf=smpte2084"),a=cast.__platform__.canDisplayType(q)}else a=ve(n.contentType);else Po()?(l=n.contentType,n.width&&n.height&&(l+="; width="+n.width,l+="; height="+n.height),n.framerate&&(l+="; framerate="+n.framerate),n.bitrate&&(l+="; bitrate="+n.bitrate),a=ve(l)):a=ve(n.contentType);if(!a)return V.return(t)}if(o&&(ar()&&o.spatialRendering?(c=o.contentType+"; spatialRendering=true",f=ve(c)):f=ve(o.contentType),!f))return V.return(t)}else if(e.type=="file"){if(n&&(p=n.contentType,m=ks(p),!m)||o&&(v=o.contentType,S=ks(v),!S))return V.return(t)}else return V.return(t);if(!e.keySystemConfiguration)return t.supported=!0,V.return(Promise.resolve(t));if(C=e.keySystemConfiguration,T=[],I=[],C.audio&&(_={robustness:C.audio.robustness||"",contentType:e.audio.contentType},Po()&&e.audio.contentType.includes('codecs="ac-3"')&&(_={robustness:_.robustness,contentType:'audio/mp4; codecs="ec-3"'}),T.push(_)),C.video&&(N={robustness:C.video.robustness||"",contentType:e.video.contentType},I.push(N)),j={initDataTypes:[C.initDataType],distinctiveIdentifier:C.distinctiveIdentifier,persistentState:C.persistentState,sessionTypes:C.sessionTypes},T.length&&(j.audioCapabilities=T),I.length&&(j.videoCapabilities=I),O=(e.video?e.video.contentType:"")+"#"+(e.audio?e.audio.contentType:"")+"#"+e.keySystemConfiguration.keySystem,re(V,3),O in Pu){X=Pu[O],V.B(5);break}return E(V,navigator.requestMediaKeySystemAccess(C.keySystem,[j]),6);case 6:X=V.h,Pu[O]=X;case 5:ie(V,4);break;case 3:se(V);case 4:X&&(t.supported=!0,t.keySystemAccess=X);case 2:return V.return(t)}})}qt.MediaCapabilities=Lu,Lu.install=uv;var fv=null;Lu.originalMcap=fv;var Pu={};Lu.memoizedMediaKeySystemAccessRequests_=Pu,fn(uv,-1);function cv(){}function hv(){var e=nl();d.MediaSource&&(ar()?pv():e?10>=e?d.MediaSource=null:12>=e?(dv(),L4()):15>=e&&dv():Jf()?pv():(el()||Ja()||Rt("Tizen 4"))&&P4()),d.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&D4()}function dv(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,Re.apply(0,arguments));return t.abort=function(){},t}}function L4(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}function pv(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return t.split(";")[0].split("/")[1]!="mp2t"&&e(t)}}function P4(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return xi(t)!="opus"&&e(t)}}function D4(){var e=MediaSource.isTypeSupported;Rt("Web0S")||(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),o=n.findIndex(function(f){return f.startsWith("codecs=")});if(0>o)return e(t);var a=n[o].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),l=a.findIndex(function(f){return f.startsWith("vp09")});return 0<=l&&(a[l]="vp9",n[o]='codecs="'+a.join(",")+'"',t=n.join("; ")),e(t)})}qt.MediaSource=cv,cv.install=hv,fn(hv);function gv(){}function mv(){screen.orientation&&screen.orientation.unlock||(screen.orientation!=null?N4():d.orientation!=null&&O4())}function N4(){screen.orientation.lock===void 0&&(screen.orientation.lock=function(){return Promise.resolve()}),screen.orientation.unlock===void 0&&(screen.orientation.unlock=function(){})}function O4(){function e(){switch(d.orientation){case-90:t.type="landscape-secondary",t.angle=270;break;case 0:t.type="portrait-primary",t.angle=0;break;case 90:t.type="landscape-primary",t.angle=90;break;case 180:t.type="portrait-secondary",t.angle=180}}var t=new Du;screen.orientation=t,e(),d.addEventListener("orientationchange",function(){e();var n=new We("change");t.dispatchEvent(n)})}qt.Orientation=gv,gv.install=mv;function Du(){dt.call(this),this.type="",this.angle=0}Z(Du,dt),Du.prototype.lock=function(e){function t(o){return screen.lockOrientation?screen.lockOrientation(o):screen.mozLockOrientation?screen.mozLockOrientation(o):screen.msLockOrientation?screen.msLockOrientation(o):!1}var n=!1;switch(e){case"natural":n=t("default");break;case"any":n=!0,this.unlock();break;default:n=t(e)}return n?Promise.resolve():(e=Error("screen.orientation.lock() is not available on this device"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},Du.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},fn(mv);function yd(){}var vd,xd,wd,Sd,Td,Cd;function U4(e,t){try{var n=new Nu(e,t);return Promise.resolve(n)}catch(o){return Promise.reject(o)}}function B4(e){var t=this.mediaKeys;return t&&t!=e&&yv(t,null),delete this.mediaKeys,(this.mediaKeys=e)?yv(e,this):Promise.resolve()}function j4(e){if(e=Ve(e.initData),Et(e).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=Vi(e.subarray(4),!0),e=Hi(e);var t=new Event("encrypted");t.initDataType="skd",t.initData=Pt(e),this.dispatchEvent(t)}qt.PatchedMediaKeysApple=yd,yd.uninstall=function(){vd&&(vd=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",xd),HTMLMediaElement.prototype.setMediaKeys=wd,d.MediaKeys=Sd,d.MediaKeySystemAccess=Td,navigator.requestMediaKeySystemAccess=Cd,xd=Cd=wd=Td=Sd=null,d.shakaMediaKeysPolyfill=!1)},yd.install=function(e){d.HTMLVideoElement&&d.WebKitMediaKeys&&(e!==void 0&&e&&(vd=!0,xd=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),wd=HTMLMediaElement.prototype.setMediaKeys,Sd=d.MediaKeys,Td=d.MediaKeySystemAccess,Cd=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=B4,d.MediaKeys=va,d.MediaKeySystemAccess=Nu,navigator.requestMediaKeySystemAccess=U4,d.shakaMediaKeysPolyfill=!0)};function Nu(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(e=w(t),t=e.next();!t.done;t=e.next()){var n=t.value;if(n.persistentState=="required")t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var o=!1,a=!1;if(n.audioCapabilities)for(var l=w(n.audioCapabilities),f=l.next();!f.done;f=l.next())f=f.value,f.contentType&&(o=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,f.contentType.split(";")[0])&&(t.audioCapabilities.push(f),a=!0));if(n.videoCapabilities)for(n=w(n.videoCapabilities),f=n.next();!f.done;f=n.next())l=f.value,l.contentType&&(o=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,l.contentType.split(";")[0])&&(t.videoCapabilities.push(l),a=!0));o||(a=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=a?t:null}if(t){this.g=t;return}}throw e=Error("Unsupported keySystem"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}Nu.prototype.createMediaKeys=function(){var e=new va(this.keySystem);return Promise.resolve(e)},Nu.prototype.getConfiguration=function(){return this.g};function va(e){this.h=new WebKitMediaKeys(e),this.g=new Ct}va.prototype.createSession=function(e){if(e=e||"temporary",e!="temporary")throw new TypeError("Session type "+e+" is unsupported on this platform.");return new Ed(this.h)},va.prototype.setServerCertificate=function(){return Promise.resolve(!1)};function yv(e,t){if(e.g.Za(),!t)return Promise.resolve();e.g.D(t,"webkitneedkey",j4);try{return Ar(t,HTMLMediaElement.HAVE_METADATA,e.g,function(){t.webkitSetMediaKeys(e.h)}),Promise.resolve()}catch(n){return Promise.reject(n)}}va.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")};function Ed(e){dt.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new Ct,this.sessionId="",this.expiration=NaN,this.closed=new bt,this.keyStatuses=new vv}Z(Ed,dt),s=Ed.prototype,s.generateRequest=function(e,t){var n=this;this.h=new bt;try{var o=this.l.createSession("video/mp4",Ve(t));this.i=o,this.sessionId=o.sessionId||"",this.j.D(this.i,"webkitkeymessage",function(a){n.h&&(n.h.resolve(),n.h=null),a=new Map().set("messageType",n.keyStatuses.Pb()==null?"license-request":"license-renewal").set("message",Pt(a.message)),a=new We("message",a),n.dispatchEvent(a)}),this.j.D(o,"webkitkeyadded",function(){n.g&&(Ou(n,"usable"),n.g.resolve(),n.g=null)}),this.j.D(o,"webkitkeyerror",function(){var a=Error("EME PatchedMediaKeysApple key error");if(a.errorCode=n.i.error,n.h!=null)n.h.reject(a),n.h=null;else if(n.g!=null)n.g.reject(a),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:Ou(n,"output-not-allowed");break;default:Ou(n,"internal-error")}}),Ou(this,"status-pending")}catch(a){this.h.reject(a)}return this.h},s.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},s.update=function(e){this.g=new bt;try{this.i.update(Ve(e))}catch(t){this.g.reject(t)}return this.g},s.close=function(){try{this.i.close(),this.closed.resolve(),this.j.Za()}catch(e){this.closed.reject(e)}return this.closed},s.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};function Ou(e,t){var n=e.keyStatuses;n.size=t==null?0:1,n.g=t,t=new We("keystatuseschange"),e.dispatchEvent(t)}function vv(){this.size=0,this.g=void 0}s=vv.prototype,s.Pb=function(){return this.g},s.forEach=function(e){this.g&&e(this.g,wl.value())},s.get=function(e){if(this.has(e))return this.g},s.has=function(e){var t=wl.value();return!!(this.g&&nt(e,t))},s.entries=function(){},s.keys=function(){},s.values=function(){};function xv(){}function wv(){!d.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=F4,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=z4,d.MediaKeys=Uu,d.MediaKeySystemAccess=Ad,d.shakaMediaKeysPolyfill=!0)}function F4(){return Promise.reject(Error("The key system specified is not supported."))}function z4(e){return e==null?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}qt.PatchedMediaKeysNop=xv,xv.install=wv;function Uu(){throw new TypeError("Illegal constructor.")}Uu.prototype.createSession=function(){},Uu.prototype.setServerCertificate=function(){},Uu.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")};function Ad(){throw this.keySystem="",new TypeError("Illegal constructor.")}Ad.prototype.getConfiguration=function(){},Ad.prototype.createMediaKeys=function(){},fn(wv,-10);function Sv(){}function Tv(){if(!(!d.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)_d="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=V4,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=H4,d.MediaKeys=xa,d.MediaKeySystemAccess=Bu,d.shakaMediaKeysPolyfill=!0}}function bd(e){var t=_d;return t?t+e.charAt(0).toUpperCase()+e.slice(1):e}function V4(e,t){try{var n=new Bu(e,t);return Promise.resolve(n)}catch(o){return Promise.reject(o)}}function H4(e){var t=this.mediaKeys;return t&&t!=e&&Cv(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Cv(e,this),Promise.resolve()}qt.PatchedMediaKeysWebkit=Sv,Sv.install=Tv;function Bu(e,t){this.g=this.keySystem=e;var n=!1;e=="org.w3.clearkey"&&(this.g="webkit-org.w3.clearkey",n=!1);var o=!1,a=document.getElementsByTagName("video");a=a.length?a[0]:document.createElement("video"),t=w(t);for(var l=t.next();!l.done;l=t.next()){l=l.value;var f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:l.initDataTypes,sessionTypes:["temporary"],label:l.label},c=!1;if(l.audioCapabilities)for(var p=w(l.audioCapabilities),m=p.next();!m.done;m=p.next())m=m.value,m.contentType&&(c=!0,a.canPlayType(m.contentType.split(";")[0],this.g)&&(f.audioCapabilities.push(m),o=!0));if(l.videoCapabilities)for(p=w(l.videoCapabilities),m=p.next();!m.done;m=p.next())m=m.value,m.contentType&&(c=!0,a.canPlayType(m.contentType,this.g)&&(f.videoCapabilities.push(m),o=!0));if(c||(o=a.canPlayType("video/mp4",this.g)||a.canPlayType("video/webm",this.g)),l.persistentState=="required"&&(n?(f.persistentState="required",f.sessionTypes=["persistent-license"]):o=!1),o){this.h=f;return}}throw n="Unsupported keySystem",(e=="org.w3.clearkey"||e=="com.widevine.alpha")&&(n="None of the requested configurations were supported."),e=Error(n),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}Bu.prototype.createMediaKeys=function(){var e=new xa(this.g);return Promise.resolve(e)},Bu.prototype.getConfiguration=function(){return this.h};function xa(e){this.l=e,this.h=null,this.g=new Ct,this.i=[],this.j=new Map}function Cv(e,t){e.h=t,e.g.Za();var n=_d;t&&(e.g.D(t,n+"needkey",function(o){var a=new CustomEvent("encrypted");a.initDataType="cenc",a.initData=Pt(o.initData),e.h.dispatchEvent(a)}),e.g.D(t,n+"keymessage",function(o){var a=Id(e,o.sessionId);a&&(o=new Map().set("messageType",a.keyStatuses.Pb()==null?"licenserequest":"licenserenewal").set("message",o.message),o=new We("message",o),a.h&&(a.h.resolve(),a.h=null),a.dispatchEvent(o))}),e.g.D(t,n+"keyadded",function(o){(o=Id(e,o.sessionId))&&(ju(o,"usable"),o.g&&o.g.resolve(),o.g=null)}),e.g.D(t,n+"keyerror",function(o){var a=Id(e,o.sessionId);if(a){var l=Error("EME v0.1b key error"),f=o.errorCode;f.systemCode=o.systemCode,l.errorCode=f,!o.sessionId&&a.h?(o.systemCode==45&&(l.message="Unsupported session type."),a.h.reject(l),a.h=null):o.sessionId&&a.g?(a.g.reject(l),a.g=null):(l=o.systemCode,o.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?ju(a,"output-restricted"):l==1?ju(a,"expired"):ju(a,"internal-error"))}}))}xa.prototype.createSession=function(e){if(e=e||"temporary",e!="temporary"&&e!="persistent-license")throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new kd(t,this.l,e),this.i.push(e),e},xa.prototype.setServerCertificate=function(){return Promise.resolve(!1)},xa.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")};function Id(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function kd(e,t,n){dt.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new bt,this.keyStatuses=new Av}Z(kd,dt);function Ev(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if(e.l=="persistent-license")if(n)var o=Ve(Hi("LOAD_SESSION|"+n));else{var a=Hi("PERSISTENT|");o=Lt(a,t)}else o=Ve(t)}catch(f){return Promise.reject(f)}e.h=new bt;var l=bd("generateKeyRequest");try{e.j[l](e.i,o)}catch(f){if(f.name!="InvalidStateError")return e.h=null,Promise.reject(f);new st(function(){try{e.j[l](e.i,o)}catch(c){e.h.reject(c),e.h=null}}).U(.01)}return e.h}function Md(e,t,n){if(e.g)e.g.then(function(){return Md(e,t,n)}).catch(function(){return Md(e,t,n)});else{if(e.g=t,e.i=="webkit-org.w3.clearkey"){var o=It(n),a=JSON.parse(o);a.keys[0].kty!="oct"&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),o=li(a.keys[0].k),a=li(a.keys[0].kid)}else o=Ve(n),a=null;var l=bd("addKey");try{e.j[l](e.i,o,a,e.sessionId)}catch(f){e.g.reject(f),e.g=null}}}function ju(e,t){var n=e.keyStatuses;n.size=t==null?0:1,n.g=t,t=new We("keystatuseschange"),e.dispatchEvent(t)}s=kd.prototype,s.generateRequest=function(e,t){return Ev(this,t,null)},s.load=function(e){return this.l=="persistent-license"?Ev(this,null,e):Promise.reject(Error("Not a persistent session."))},s.update=function(e){var t=new bt;return Md(this,t,e),t},s.close=function(){if(this.l!="persistent-license"){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=bd("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch{}}return this.closed.resolve(),this.closed},s.remove=function(){return this.l!="persistent-license"?Promise.reject(Error("Not a persistent session.")):this.close()};function Av(){this.size=0,this.g=void 0}s=Av.prototype,s.Pb=function(){return this.g},s.forEach=function(e){this.g&&e(this.g,wl.value())},s.get=function(e){if(this.has(e))return this.g},s.has=function(e){var t=wl.value();return!!(this.g&&nt(e,t))},s.entries=function(){},s.keys=function(){},s.values=function(){};var _d="";fn(Tv);function bv(){}function Iv(){if(d.HTMLVideoElement){var e=HTMLVideoElement.prototype;e.requestPictureInPicture&&document.exitPictureInPicture||!e.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=G4,Object.defineProperty(e,"disablePictureInPicture",{get:X4,set:K4,enumerable:!0,configurable:!0}),document.exitPictureInPicture=W4,document.addEventListener("webkitpresentationmodechanged",$4,!0))}}function $4(e){if(e=e.target,e.webkitPresentationMode=="picture-in-picture"){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function G4(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function W4(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function X4(){return this.hasAttribute("disablePictureInPicture")?!0:!this.webkitSupportsPresentationMode("picture-in-picture")}function K4(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}qt.PiPWebkit=bv,bv.install=Iv,fn(Iv);function kv(){}function Mv(){d.crypto&&("randomUUID"in d.crypto||(d.crypto.randomUUID=Y4))}function Y4(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}qt.RandomUUID=kv,kv.install=Mv,fn(Mv);function _v(){}function Rv(){navigator.storage&&navigator.storage.estimate||!navigator.webkitTemporaryStorage||!navigator.webkitTemporaryStorage.queryUsageAndQuota||("storage"in navigator||(navigator.storage={}),navigator.storage.estimate=q4)}function q4(){return new Promise(function(e,t){navigator.webkitTemporaryStorage.queryUsageAndQuota(function(n,o){e({usage:n,quota:o})},t)})}qt.StorageEstimate=_v,_v.install=Rv,fn(Rv);function Lv(){}function Pv(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:Q4})}function Q4(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}qt.Symbol=Lv,Lv.install=Pv,fn(Pv);function Dv(){}function Nv(){if(d.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var t=e.apply(this);return t&&t.catch(function(){}),t}}}qt.VideoPlayPromise=Dv,Dv.install=Nv,fn(Nv);function Ov(){}function Uv(){if(d.HTMLVideoElement){var e=HTMLVideoElement.prototype;!e.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in e||ec())&&(e.getVideoPlaybackQuality=Z4)}}function Z4(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}qt.VideoPlaybackQuality=Ov,Ov.install=Uv,fn(Uv);function Bv(){}function jv(){if(!d.VTTCue&&d.TextTrackCue){var e=null,t=TextTrackCue.length;if(t==3)e=Rd;else if(t==6)e=J4;else{try{var n=!!Rd(1,2,"")}catch{n=!1}n&&(e=Rd)}e&&(d.VTTCue=function(o,a,l){return e(o,a,l)})}}function Rd(e,t,n){return new d.TextTrackCue(e,t,n)}function J4(e,t,n){return new d.TextTrackCue(e+"-"+t+"-"+n,e,t,n)}qt.VTTCue=Bv,Bv.install=jv,fn(jv);function Dn(){}Dn.prototype.parseInit=function(){},Dn.prototype.setSequenceMode=function(){},Dn.prototype.setManifestType=function(){},Dn.prototype.parseMedia=function(e,t){var n=null,o=[];e=It(e).split(/\r?\n/),e=w(e);for(var a=e.next();!a.done;a=e.next())if((a=a.value)&&!/^\s+$/.test(a)&&(a=eb.exec(a))){var l=tb.exec(a[1]);l=60*parseInt(l[1],10)+parseFloat(l[2].replace(",",".")),a=new ct(l,t.segmentEnd?t.segmentEnd:l+2,a[2]),n&&(n.endTime=l,o.push(n)),n=a}return n&&o.push(n),o},ae("shaka.text.LrcTextParser",Dn),Dn.prototype.parseMedia=Dn.prototype.parseMedia,Dn.prototype.setManifestType=Dn.prototype.setManifestType,Dn.prototype.setSequenceMode=Dn.prototype.setSequenceMode,Dn.prototype.parseInit=Dn.prototype.parseInit;var eb=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,tb=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;Kt["application/x-subtitle-lrc"]=function(){return new Dn};function An(){}An.prototype.parseInit=function(){},An.prototype.setSequenceMode=function(){},An.prototype.setManifestType=function(){},An.prototype.parseMedia=function(e,t,n){var o=It(e);if(e=[],o=="")return e;var a=wr(o,"tt");if(!a)throw new K(2,2,2005,"Failed to parse TTML.");if(o=a.getElementsByTagName("body")[0],!o)return[];var l=Pi(a,wa,"frameRate"),f=Pi(a,wa,"subFrameRate"),c=Pi(a,wa,"frameRateMultiplier"),p=Pi(a,wa,"tickRate"),m=Pi(a,wa,"cellResolution"),v=a.getAttribute("xml:space")||"default",S=Pi(a,Vu,"extent");if(v!="default"&&v!="preserve")throw new K(2,2,2005,"Invalid xml:space value: "+v);v=v=="default",l=new ob(l,f,c,p),m=m&&(m=/^(\d+) (\d+)$/.exec(m))?{Kb:parseInt(m[1],10),rows:parseInt(m[2],10)}:null,f=(f=a.getElementsByTagName("metadata")[0])?Rw(f):[],c=Array.from(a.getElementsByTagName("style")),a=Array.from(a.getElementsByTagName("region")),p=[];for(var C=w(a),T=C.next();!T.done;T=C.next()){var I=T.value;T=new Mo;var _=I.getAttribute("xml:id");if(_){T.id=_;var N=null;S&&(N=Nd.exec(S)||Od.exec(S)),_=N?Number(N[1]):null,N=N?Number(N[2]):null;var j,O=Fu(I,c,"extent");if(O){var X=(j=Nd.exec(O))||Od.exec(O);X!=null&&(T.width=Number(X[1]),T.height=Number(X[2]),j||(_!=null&&(T.width=100*T.width/_),N!=null&&(T.height=100*T.height/N)),T.widthUnits=j||_!=null?Hn:0,T.heightUnits=j||N!=null?Hn:0)}(I=Fu(I,c,"origin"))&&(X=(j=Nd.exec(I))||Od.exec(I),X!=null&&(T.viewportAnchorX=Number(X[1]),T.viewportAnchorY=Number(X[2]),j?O||(T.width=100-T.viewportAnchorX,T.widthUnits=Hn,T.height=100-T.viewportAnchorY,T.heightUnits=Hn):(N!=null&&(T.viewportAnchorY=100*T.viewportAnchorY/N),_!=null&&(T.viewportAnchorX=100*T.viewportAnchorX/_)),T.viewportAnchorUnits=j||_!=null?Hn:0))}else T=null;T&&p.push(T)}if(kt(o,"p").length)throw new K(2,2,2001,"<p> can only be inside <div> in TTML");for(S=w(kt(o,"div")),C=S.next();!C.done;C=S.next())if(kt(C.value,"span").length)throw new K(2,2,2001,"<span> can only be inside <p> in TTML");return(t=Fv(o,t,l,f,c,a,p,v,m,null,!1,n))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e};function Fv(e,t,n,o,a,l,f,c,p,m,v,S){var C=e.parentNode;if(e.nodeType==Node.COMMENT_NODE)return null;if(e.nodeType==Node.TEXT_NODE){if(!v)return null;var T=document.createElement("span");T.textContent=e.textContent}else T=e;for(var I=null,_=w(qv),N=_.next();!N.done&&!(I=zu(T,"backgroundImage",o,"#",N.value)[0]);N=_.next());_=null;var j=Pi(T,qv,"backgroundImage");if(S&&j&&!j.startsWith("#")&&(N=new Bt(S),j=new Bt(j),(N=N.resolve(j).toString())&&(_=N)),(e.nodeName=="p"||I||_)&&(v=!0),e=v,N=(T.getAttribute("xml:space")||(c?"default":"preserve"))=="default",j=Array.from(T.childNodes).every(function(q){return q.nodeType==Node.TEXT_NODE}),c=[],!j)for(var O=w(T.childNodes),X=O.next();!X.done;X=O.next())(X=Fv(X.value,t,n,o,a,l,f,N,p,T,v,S))&&c.push(X);if(o=m!=null,S=/\S/.test(T.textContent),X=T.hasAttribute("begin")||T.hasAttribute("end")||T.hasAttribute("dur"),!(X||S||T.tagName=="br"||c.length!=0||o&&!N))return null;for(O=Hv(T,n),S=O.start,O=O.end;C&&C.nodeType==Node.ELEMENT_NODE&&C.tagName!="tt";)O=ib(C,n,S,O),S=O.start,O=O.end,C=C.parentNode;if(S==null&&(S=0),S+=t.periodStart,O=O==null?1/0:O+t.periodStart,S=Math.max(S,t.segmentStart),O=Math.min(O,t.segmentEnd),!X&&0<c.length)for(S=1/0,O=0,t=w(c),n=t.next();!n.done;n=t.next())n=n.value,S=Math.min(S,n.startTime),O=Math.max(O,n.endTime);if(T.tagName=="br")return a=new ct(S,O,""),a.lineBreak=!0,a;if(t="",j&&(t=T.textContent,N&&(t=t.trim(),t=t.replace(/\s+/g," "))),t=new ct(S,O,t),t.nestedCues=c,v||(t.isContainer=!0),p&&(t.cellResolution=p),p=zu(T,"region",l,"")[0],T.hasAttribute("region")&&p&&p.getAttribute("xml:id")){var V=p.getAttribute("xml:id");t.region=f.filter(function(q){return q.id==V})[0]}return f=p,m&&o&&!T.getAttribute("region")&&!T.getAttribute("style")&&(f=zu(m,"region",l,"")[0]),nb(t,T,f,I,_,a,e,c.length==0),t}function nb(e,t,n,o,a,l,f,c){if(f=f||c,tn(t,n,l,"direction",f)=="rtl"&&(e.direction="rtl"),c=tn(t,n,l,"writingMode",f),c=="tb"||c=="tblr"?e.writingMode="vertical-lr":c=="tbrl"?e.writingMode="vertical-rl":c=="rltb"||c=="rl"?e.direction="rtl":c&&(e.direction=ws),(c=tn(t,n,l,"textAlign",!0))?(e.positionAlign=ab[c],e.lineAlign=sb[c],e.textAlign=Vf[c.toUpperCase()]):e.textAlign=Ui,(c=tn(t,n,l,"displayAlign",!0))&&(e.displayAlign=Ip[c.toUpperCase()]),(c=tn(t,n,l,"color",f))&&(e.color=c),(c=tn(t,n,l,"backgroundColor",f))&&(e.backgroundColor=c),(c=tn(t,n,l,"border",f))&&(e.border=c),c=tn(t,n,l,"fontFamily",f))switch(c){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=c}switch((c=tn(t,n,l,"fontWeight",f))&&c=="bold"&&(e.fontWeight=700),c=tn(t,n,l,"wrapOption",f),e.wrapLine=!(c&&c=="noWrap"),(c=tn(t,n,l,"lineHeight",f))&&c.match(Yr)&&(e.lineHeight=c),(c=tn(t,n,l,"fontSize",f))&&(c.match(Yr)||c.match(rb))&&(e.fontSize=c),(c=tn(t,n,l,"fontStyle",f))&&(e.fontStyle=Rp[c.toUpperCase()]),o?(a=o.getAttribute("imageType")||o.getAttribute("imagetype"),c=o.getAttribute("encoding"),o=o.textContent.trim(),a=="PNG"&&c=="Base64"&&o&&(e.backgroundImage="data:image/png;base64,"+o)):a&&(e.backgroundImage=a),(o=tn(t,n,l,"textOutline",f))&&(o=o.split(" "),o[0].match(Yr)?e.textStrokeColor=e.color:(e.textStrokeColor=o[0],o.shift()),o[0]&&o[0].match(Yr)?e.textStrokeWidth=o[0]:e.textStrokeColor=""),(o=tn(t,n,l,"letterSpacing",f))&&o.match(Yr)&&(e.letterSpacing=o),(o=tn(t,n,l,"linePadding",f))&&o.match(Yr)&&(e.linePadding=o),(o=tn(t,n,l,"opacity",f))&&(e.opacity=parseFloat(o)),(o=Fu(n,l,"textDecoration"))&&zv(e,o),(o=Ld(t,l,"textDecoration"))&&zv(e,o),(o=tn(t,n,l,"textCombine",f))&&(e.textCombineUpright=o),tn(t,n,l,"ruby",f)){case"container":e.rubyTag="ruby";break;case"text":e.rubyTag="rt"}}function zv(e,t){t=w(t.split(" "));for(var n=t.next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&wn(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&wn(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&wn(e.textDecoration,"overline")}}function tn(e,t,n,o,a){return a=a===void 0?!0:a,(e=Ld(e,n,o))?e:a?Fu(t,n,o):null}function Fu(e,t,n){if(!e)return null;var o=Pi(e,Vu,n);return o||Vv(e,t,n)}function Ld(e,t,n){var o=Pi(e,Vu,n);return o||Vv(e,t,n)}function Vv(e,t,n){e=zu(e,"style",t,"");for(var o=null,a=0;a<e.length;a++){var l=jo(e[a],"urn:ebu:tt:style",n);l||(l=Pi(e[a],Vu,n)),l||(l=Ld(e[a],t,n)),l&&(o=l)}return o}function zu(e,t,n,o,a){var l=[];if(!e||1>n.length)return l;var f=e;for(e=null;f&&!(e=a?jo(f,a,t):f.getAttribute(t))&&(f=f.parentNode,f instanceof Element););if(t=e){for(t=w(t.split(" ")),a=t.next();!a.done;a=t.next())for(a=a.value,e=w(n),f=e.next();!f.done;f=e.next())if(f=f.value,o+f.getAttribute("xml:id")==a){l.push(f);break}}return l}function ib(e,t,n,o){return e=Hv(e,t),n==null?n=e.start:e.start!=null&&(n+=e.start),o==null?o=e.end:e.start!=null&&(o+=e.start),{start:n,end:o}}function Hv(e,t){var n=Pd(e.getAttribute("begin"),t),o=Pd(e.getAttribute("end"),t);return e=Pd(e.getAttribute("dur"),t),o==null&&e!=null&&(o=n+e),{start:n,end:o}}function Pd(e,t){var n=null;if($v.test(e)){e=$v.exec(e),n=Number(e[1]);var o=Number(e[2]),a=Number(e[3]),l=Number(e[4]);l+=(Number(e[5])||0)/t.h,a+=l/t.frameRate,n=a+60*o+3600*n}else if(Gv.test(e))n=Dd(Gv,e);else if(Wv.test(e))n=Dd(Wv,e);else if(Xv.test(e))e=Xv.exec(e),n=Number(e[1])/t.frameRate;else if(Kv.test(e))e=Kv.exec(e),n=Number(e[1])/t.g;else if(Yv.test(e))n=Dd(Yv,e);else if(e)throw new K(2,2,2001,"Could not parse cue time range in TTML");return n}function Dd(e,t){return e=e.exec(t),e==null||e[0]==""?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}ae("shaka.text.TtmlTextParser",An),An.prototype.parseMedia=An.prototype.parseMedia,An.prototype.setManifestType=An.prototype.setManifestType,An.prototype.setSequenceMode=An.prototype.setSequenceMode,An.prototype.parseInit=An.prototype.parseInit;function ob(e,t,n,o){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(o),this.g==0&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}var Nd=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,rb=/^(\d{1,2}(?:\.\d+)?|100)%$/,Yr=/^(\d+px|\d+em|\d*\.?\d+c)$/,Od=/^(\d+)px (\d+)px$/,$v=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Gv=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Wv=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Xv=/^(\d*(?:\.\d*)?)f$/,Kv=/^(\d*(?:\.\d*)?)t$/,Yv=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),sb={left:ko,center:"center",right:"end",start:ko,end:"end"},ab={left:"line-left",center:"center",right:"line-right"},wa=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],Vu=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],qv=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];Kt["application/ttml+xml"]=function(){return new An};function cn(){this.g=new An}cn.prototype.parseInit=function(e){var t=!1;if(new St().box("moov",pt).box("trak",pt).box("mdia",pt).box("minf",pt).box("stbl",pt).O("stsd",yr).box("stpp",function(n){t=!0,n.parser.stop()}).parse(e),!t)throw new K(2,2,2007)},cn.prototype.setSequenceMode=function(){},cn.prototype.setManifestType=function(){},cn.prototype.parseMedia=function(e,t,n){var o=this,a=!1,l=[];if(new St().box("mdat",vr(function(f){a=!0,l=l.concat(o.g.parseMedia(f,t,n))})).parse(e,!1),!a)throw new K(2,2,2007);return l},ae("shaka.text.Mp4TtmlParser",cn),cn.prototype.parseMedia=cn.prototype.parseMedia,cn.prototype.setManifestType=cn.prototype.setManifestType,cn.prototype.setSequenceMode=cn.prototype.setSequenceMode,cn.prototype.parseInit=cn.prototype.parseInit,Kt['application/mp4; codecs="stpp"']=function(){return new cn},Kt['application/mp4; codecs="stpp.ttml"']=function(){return new cn},Kt['application/mp4; codecs="stpp.ttml.im1t"']=function(){return new cn},Kt['application/mp4; codecs="stpp.TTML.im1t"']=function(){return new cn};function hn(){this.h=!1,this.g="UNKNOWN"}hn.prototype.parseInit=function(){},hn.prototype.setSequenceMode=function(e){this.h=e},hn.prototype.setManifestType=function(e){this.g=e},hn.prototype.parseMedia=function(e,t){e=It(e),e=e.replace(/\r\n|\r(?=[^\n]|$)/gm,`
`);var n=e.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new K(2,2,2e3);if(e=t.vttOffset,n[0].includes("X-TIMESTAMP-MAP")&&this.h){var o=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),a=n[0].match(/MPEGTS:(\d+)/m);if(o&&a){if(e=Hu(new Xo(o[1])),e==null)throw new K(2,2,2e3);for(a=Number(a[1]),o=t.segmentStart-t.periodStart;95443.7176888889<=o;)o-=95443.7176888889,a+=8589934592;e=t.periodStart+a/9e4-e}}else n[0].includes("X-TIMESTAMP-MAP")&&this.g=="HLS"&&(e=t.segmentStart);for(t=[],a=w(n[0].split(`
`)),o=a.next();!o.done;o=a.next())if(o=o.value,/^Region:/.test(o)){o=new Xo(o);var l=new Mo;Ko(o),$r(o);for(var f=Ko(o);f;){var c=l,p=f;(f=/^id=(.*)$/.exec(p))?c.id=f[1]:(f=/^width=(\d{1,2}|100)%$/.exec(p))?c.width=Number(f[1]):(f=/^lines=(\d+)$/.exec(p))?(c.height=Number(f[1]),c.heightUnits=2):(f=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(p))?(c.regionAnchorX=Number(f[1]),c.regionAnchorY=Number(f[2])):(f=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(p))?(c.viewportAnchorX=Number(f[1]),c.viewportAnchorY=Number(f[2])):/^scroll=up$/.exec(p)&&(c.scroll="up"),$r(o),f=Ko(o)}t.push(l)}for(a=new Map,Qv(a),o=[],n=w(n.slice(1)),l=n.next();!l.done;l=n.next()){if(l=l.value.split(`
`),(l.length!=1||l[0])&&!/^NOTE($|[ \t])/.test(l[0])&&l[0]=="STYLE"){for(c=[],f=-1,p=1;p<l.length;p++)l[p].includes("::cue")&&(c.push([]),f=c.length-1),f!=-1&&(c[f].push(l[p]),l[p].includes("}")&&(f=-1));for(c=w(c),f=c.next();!f.done;f=c.next()){var m=f.value;f="global",(p=m[0].match(/\((.*)\)/))&&(f=p.pop()),p=m.slice(1,-1),m[0].includes("}")&&(m=/\{(.*?)\}/.exec(m[0]))&&(p=m[1].split(";")),(m=a.get(f))||(m=new ct(0,0,""));for(var v=!1,S=0;S<p.length;S++){var C=/^\s*([^:]+):\s*(.*)/.exec(p[S]);if(C){var T=C[2].trim().replace(";","");switch(C[1].trim()){case"background-color":case"background":v=!0,m.backgroundColor=T;break;case"color":v=!0,m.color=T;break;case"font-family":v=!0,m.fontFamily=T;break;case"font-size":v=!0,m.fontSize=T;break;case"font-weight":(700<=parseInt(T,10)||T=="bold")&&(v=!0,m.fontWeight=700);break;case"font-style":switch(T){case"normal":v=!0,m.fontStyle=$f;break;case"italic":v=!0,m.fontStyle="italic";break;case"oblique":v=!0,m.fontStyle="oblique"}break;case"opacity":v=!0,m.opacity=parseFloat(T);break;case"text-combine-upright":v=!0,m.textCombineUpright=T;break;case"text-shadow":v=!0,m.textShadow=T;break;case"white-space":v=!0,m.wrapLine=T!="noWrap"}}}v&&a.set(f,m)}}if(v=e,l.length==1&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||l[0]=="STYLE"||l[0]=="REGION")l=null;else if(c=null,l[0].includes("-->")||(c=l[0],l.splice(0,1)),f=new Xo(l[0]),p=Hu(f),S=po(f,/[ \t]+--\x3e[ \t]+/g),m=Hu(f),p==null||S==null||m==null)Le("Failed to parse VTT time code. Cue skipped:",c,l),l=null;else{for(p+=v,m+=v,l=l.slice(1).join(`
`).trim(),a.has("global")?(v=a.get("global").clone(),v.startTime=p,v.endTime=m,v.payload=""):v=new ct(p,m,""),$r(f),p=Ko(f);p;)ex(v,p,t),$r(f),p=Ko(f);Zv(l,v,a),c!=null&&(v.id=c),l=v}l&&o.push(l)}return o};function Qv(e){for(var t=w(Object.entries(kp)),n=t.next();!n.done;n=t.next()){var o=w(n.value);n=o.next().value,o=o.next().value;var a=new ct(0,0,"");a.color=o,e.set("."+n,a)}for(t=w(Object.entries(Mp)),n=t.next();!n.done;n=t.next())o=w(n.value),n=o.next().value,o=o.next().value,a=new ct(0,0,""),a.backgroundColor=o,e.set("."+n,a)}function Zv(e,t,n){if(e.includes("<")){n.size===0&&Qv(n);e:{for(var o=[],a=-1,l="",f=0;f<e.length;f++)if(e[f]==="/"&&0<f&&e[f-1]==="<"){var c=e.indexOf(">",f);if(c<=f)break e;if((c=e.substring(f+1,c))&&c==="c"){var p=o.pop();p?p===c?(l+="/"+c+">",f+=c.length+1):p.startsWith("c.")?(f+=c.length+1,l+="/"+p+">"):l+=e[f]:l+=e[f]}else l+=e[f]}else e[f]==="<"?(a=f+1,e[a]!="c"&&(a=-1)):e[f]===">"&&0<a&&(o.push(e.substr(a,f-a)),a=-1),l+=e[f];e=l}for(o=e,e=[],l=-1,a=0;a<o.length;a++)o[a]==="<"?l=a+1:o[a]===">"&&0<l&&(l=o.substr(l,a-l),l.match(tx)&&e.push(l),l=-1);for(e=w(e),a=e.next();!a.done;a=e.next())a=a.value,o=o.replace("<"+a+">",'<div time="'+a+'">'),o+="</div>";e=o;e:{for(a=e,l=[],f=-1,e="",o=!1,c=0;c<a.length;c++)if(a[c]==="/"){if(p=a.indexOf(">",c),p===-1){e=a;break e}if((p=a.substring(c+1,p))&&p=="v"){o=!0;var m=null;if(l.length&&(m=l[l.length-1]),m){if(m===p)e+="/"+p+">";else{if(!m.startsWith("v")){e+=a[c];continue}e+="/"+m+">"}c+=p.length+1}else e+=a[c]}else e+=a[c]}else a[c]==="<"?(f=c+1,a[f]!="v"&&(f=-1)):a[c]===">"&&0<f&&(l.push(a.substr(f,c-f)),f=-1),e+=a[c];for(a=w(l),l=a.next();!l.done;l=a.next())l=l.value,f=l.replace(" ",".voice-"),e=e.replace("<"+l+">","<"+f+">"),e=e.replace("</"+l+">","</"+f+">"),o||(e+="</"+f+">")}if(o=wr("<span>"+e+"</span>","span")){if(o=o.childNodes,o.length==1&&(a=o[0],a.nodeType==Node.TEXT_NODE||a.nodeType==Node.CDATA_SECTION_NODE)){t.payload=$u(e);return}for(e=w(o),o=e.next();!o.done;o=e.next())Jv(o.value,t,n)}else t.payload=$u(e)}else t.payload=$u(e)}function Sa(e,t){return e&&0<e.length?e:t}function Jv(e,t,n){var o=t.clone();if(o.nestedCues=[],o.payload="",o.rubyTag="",o.line=null,o.region=new Mo,o.position=null,o.size=0,e.nodeType===Node.ELEMENT_NODE&&e.nodeName)for(var a=w(e.nodeName.split(/(?=[ .])+/g)),l=a.next();!l.done;l=a.next()){var f=l=l.value;if(f.startsWith(".voice-")){var c=f.split("-").pop();f='v[voice="'+c+'"]',n.has(f)||(f="v[voice="+c+"]")}switch(n.has(f)&&(f=n.get(f))&&(o.backgroundColor=Sa(f.backgroundColor,o.backgroundColor),o.color=Sa(f.color,o.color),o.fontFamily=Sa(f.fontFamily,o.fontFamily),o.fontSize=Sa(f.fontSize,o.fontSize),o.textShadow=Sa(f.textShadow,o.textShadow),o.fontWeight=f.fontWeight,o.fontStyle=f.fontStyle,o.opacity=f.opacity,o.rubyTag=f.rubyTag,o.textCombineUpright=f.textCombineUpright,o.wrapLine=f.wrapLine),l){case"br":o=xt(o.startTime,o.endTime),t.nestedCues.push(o);return;case"b":o.fontWeight=700;break;case"i":o.fontStyle="italic";break;case"u":o.textDecoration.push("underline");break;case"font":(l=e.getAttribute("color"))&&(o.color=l);break;case"div":if(l=e.getAttribute("time"),!l)break;(l=Hu(new Xo(l)))&&(o.startTime=l);break;case"ruby":case"rp":case"rt":o.rubyTag=l}}if(a=e.childNodes,pc(e)||a.length==1&&pc(a[0]))for(a=!0,n=w(e.textContent.split(`
`)),e=n.next();!e.done;e=n.next())e=e.value,a||(a=xt(o.startTime,o.endTime),t.nestedCues.push(a)),0<e.length&&(a=o.clone(),a.payload=$u(e),t.nestedCues.push(a)),a=!1;else for(t.nestedCues.push(o),t=w(a),e=t.next();!e.done;e=t.next())Jv(e.value,o,n)}function ex(e,t,n){var o;(o=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=o[1],t=="middle"?e.textAlign=Ui:e.textAlign=Vf[t.toUpperCase()]):(o=/^vertical:(lr|rl)$/.exec(t))?e.writingMode=o[1]=="lr"?"vertical-lr":"vertical-rl":(o=/^size:([\d.]+)%$/.exec(t))?e.size=Number(o[1]):(o=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))?(e.position=Number(o[1]),o[2]&&(t=o[2],e.positionAlign=t=="line-left"||t=="start"?"line-left":t=="line-right"||t=="end"?"line-right":t=="center"||t=="middle"?"center":$a)):(o=/^region:(.*)$/.exec(t))?(t=lb(n,o[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=Hf[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=Ga,e.line=Number(n[1]),n[2]&&(e.lineAlign=Hf[n[2].toUpperCase()]))}function lb(e,t){return e=e.filter(function(n){return n.id==t}),e.length?e[0]:null}function Hu(e){if(e=po(e,tx),e==null)return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function $u(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&nbsp;":" ","&lrm;":"‎","&rlm;":"‏"},n=/&(?:amp|lt|gt|quot|#(0+)?39|nbsp|lrm|rlm);/g,o=RegExp(n.source);return e&&o.test(e)?e.replace(n,function(a){return t[a]||"'"}):e||""}ae("shaka.text.VttTextParser",hn),hn.prototype.parseMedia=hn.prototype.parseMedia,hn.prototype.setManifestType=hn.prototype.setManifestType,hn.prototype.setSequenceMode=hn.prototype.setSequenceMode,hn.prototype.parseInit=hn.prototype.parseInit;var tx=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;Kt["text/vtt"]=function(){return new hn},Kt['text/vtt; codecs="vtt"']=function(){return new hn},Kt['text/vtt; codecs="wvtt"']=function(){return new hn};function Nn(){this.g=null}Nn.prototype.parseInit=function(e){var t=this,n=!1;if(new St().box("moov",pt).box("trak",pt).box("mdia",pt).O("mdhd",function(o){o=Sl(o.reader,o.version),t.g=o.timescale}).box("minf",pt).box("stbl",pt).O("stsd",yr).box("wvtt",function(){n=!0}).parse(e),!this.g)throw new K(2,2,2008);if(!n)throw new K(2,2,2008)},Nn.prototype.setSequenceMode=function(){},Nn.prototype.setManifestType=function(){},Nn.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.g)throw new K(2,2,2008);var n=0,o=[],a,l=[],f=!1,c=!1,p=!1,m=null;if(new St().box("moof",pt).box("traf",pt).O("tfdt",function(X){f=!0,n=Ac(X.reader,X.version).baseMediaDecodeTime}).O("tfhd",function(X){m=X0(X.reader,X.flags).Kf}).O("trun",function(X){c=!0,o=K0(X.reader,X.version,X.flags).ig}).box("mdat",vr(function(X){p=!0,a=X})).parse(e,!1),!p&&!f&&!c)throw new K(2,2,2008);e=n;for(var v=new vt(a,0),S=w(o),C=S.next();!C.done;C=S.next()){C=C.value;var T=C.hf||m,I=C.Wd?n+C.Wd:e;e=I+(T||0);var _=0;do{var N=v.L();_+=N;var j=v.L(),O=null;gl(j)=="vttc"?8<N&&(O=v.ub(N-8)):v.skip(N-8),T&&O&&(N=ub(O,t.periodStart+I/this.g,t.periodStart+e/this.g),l.push(N))}while(C.sampleSize&&_<C.sampleSize)}return l.filter(sr)};function ub(e,t,n){var o,a,l;return new St().box("payl",vr(function(f){o=It(f)})).box("iden",vr(function(f){a=It(f)})).box("sttg",vr(function(f){l=It(f)})).parse(e),o?fb(o,a,l,t,n):null}function fb(e,t,n,o,a){if(o=new ct(o,a,""),Zv(e,o,new Map),t&&(o.id=t),n)for(e=new Xo(n),t=Ko(e);t;)ex(o,t,[]),$r(e),t=Ko(e);return o}ae("shaka.text.Mp4VttParser",Nn),Nn.prototype.parseMedia=Nn.prototype.parseMedia,Nn.prototype.setManifestType=Nn.prototype.setManifestType,Nn.prototype.setSequenceMode=Nn.prototype.setSequenceMode,Nn.prototype.parseInit=Nn.prototype.parseInit,Kt['application/mp4; codecs="wvtt"']=function(){return new Nn};function On(){}On.prototype.parseInit=function(){},On.prototype.setSequenceMode=function(){},On.prototype.setManifestType=function(){},On.prototype.parseMedia=function(e){var t=It(e).replace(/\r+/g,"");if(t=t.trim(),e=[],t=="")return e;t=w(t.split(`

`));for(var n=t.next();!n.done;n=t.next()){n=n.value.split(`
`);var o=new Xo(n[0]),a=nx(o),l=po(o,/,/g);if(o=nx(o),a==null||l==null||o==null)throw new K(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new ct(a,o,n.slice(1).join(`
`).trim()))}return e};function nx(e){if(e=po(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g),e==null)return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}ae("shaka.text.SbvTextParser",On),On.prototype.parseMedia=On.prototype.parseMedia,On.prototype.setManifestType=On.prototype.setManifestType,On.prototype.setSequenceMode=On.prototype.setSequenceMode,On.prototype.parseInit=On.prototype.parseInit,Kt["text/x-subviewer"]=function(){return new On};function bn(){this.g=new hn}bn.prototype.parseInit=function(){},bn.prototype.setSequenceMode=function(){},bn.prototype.setManifestType=function(){},bn.prototype.parseMedia=function(e,t,n){return e=It(e),e=ix(e),e=Ve(Hi(e)),this.g.parseMedia(e,t,n)};function ix(e){var t=`WEBVTT

`;if(e=="")return t;e=e.replace(/\r+/g,""),e=e.trim(),e=w(e.split(`

`));for(var n=e.next();!n.done;n=e.next())n=n.value.split(/\n/),n[0].match(/\d+/)&&n.shift(),n[0]=n[0].replace(/,/g,"."),t+=n.join(`
`).replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+`

`;return t}ae("shaka.text.SrtTextParser",bn),bn.srt2webvtt=ix,bn.prototype.parseMedia=bn.prototype.parseMedia,bn.prototype.setManifestType=bn.prototype.setManifestType,bn.prototype.setSequenceMode=bn.prototype.setSequenceMode,bn.prototype.parseInit=bn.prototype.parseInit,Kt["text/srt"]=function(){return new bn};function Un(){}Un.prototype.parseInit=function(){},Un.prototype.setSequenceMode=function(){},Un.prototype.setManifestType=function(){},Un.prototype.parseMedia=function(e){var t="",n="";e=It(e).split(/\r?\n\s*\r?\n/),e=w(e);for(var o=e.next();!o.done;o=e.next()){var a=hb.exec(o.value);a&&(o=a[1],a=a[2],o=="V4 Styles"||o=="V4+ Styles"?t=a:o=="Events"&&(n=a))}e=[],o=null,t=w(t.split(/\r?\n/));for(var l=t.next();!l.done;l=t.next())if(a=l.value,!/^\s*;/.test(a)&&(l=sx.exec(a))){if(a=l[1].trim(),l=l[2].trim(),a=="Format")o=l.split(Gu);else if(a=="Style"){a=l.split(Gu),l={};for(var f=0;f<o.length&&f<a.length;f++)l[o[f]]=a[f];e.push(l)}}for(o=[],t=null,a={},n=w(n.split(/\r?\n/)),l=n.next();!l.done;a={ee:a.ee},l=n.next())if(l=l.value,!/^\s*;/.test(l)&&(f=sx.exec(l))){if(l=f[1].trim(),f=f[2].trim(),l=="Format")t=f.split(Gu);else if(l=="Dialogue"){f=f.split(Gu),l={};for(var c=0;c<t.length&&c<f.length;c++)l[t[c]]=f[c];c=rx(l.Start);var p=rx(l.End);f=new ct(c,p,f.slice(t.length-1).join(",").replace(/\\N/g,`
`).replace(/\{[^}]+\}/g,"")),a.ee=l.Style,(l=e.find(function(m){return function(v){return v.Name==m.ee}}(a)))&&cb(f,l),o.push(f)}}return o};function cb(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=ox(n))&&(e.color=n),(n=t.BackColour)&&(n=ox(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=700),t.Italic&&(e.fontStyle="italic"),t.Underline&&e.textDecoration.push("underline"),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=xs,e.textAlign="start";break;case 2:e.displayAlign=xs,e.textAlign=Ui;break;case 3:e.displayAlign=xs,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=Ui;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=Ui;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function ox(e){return e=parseInt(e.replace("&H",""),16),0<=e?"rgba("+(e&255)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function rx(e){return e=db.exec(e),3600*(e[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}ae("shaka.text.SsaTextParser",Un),Un.prototype.parseMedia=Un.prototype.parseMedia,Un.prototype.setManifestType=Un.prototype.setManifestType,Un.prototype.setSequenceMode=Un.prototype.setSequenceMode,Un.prototype.parseInit=Un.prototype.parseInit;var hb=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,sx=/^\s*([^:]+):\s*(.*)/,Gu=/\s*,\s*/,db=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;Kt["text/x-ssa"]=function(){return new Un};function ax(e,t){var n=e[t+1]&1?7:9;return t+n<=e.length&&(e=((e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5)-n,0<e)?{Hd:n,S:e}:null}function lx(e,t){var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],o=(e[t+2]&60)>>>2;if(o>n.length-1)return null;var a=((e[t+2]&192)>>>6)+1,l=(e[t+2]&1)<<2;return l|=(e[t+3]&192)>>>6,{sampleRate:n[o],channelCount:l,ha:"mp4a.40."+a}}function pb(e,t){if(t+1<e.length&&e[t]===255&&(e[t+1]&246)===240){var n=e[t+1]&1?7:9;if(t+n>=e.length)return!1;var o=(e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5;return o<=n?!1:(t+=o,t===e.length||t+1<e.length&&e[t]===255&&(e[t+1]&246)===240)}return!1}function gb(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2||t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}function qn(e){this.i=e,this.h=0,this.g=new Map}s=qn.prototype,s.destroy=function(){this.g.clear()},s.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/aac"?ve(this.convertCodecs("audio",e)):!1},s.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/aac"?'audio/mp4; codecs="'+(ri(t)||"mp4a.40.2")+'"':t},s.getOriginalMimeType=function(){return this.i},s.transmux=function(e,t,n,o){for(var a=Ve(e),l=Os(a),f=l.length;f<a.length&&!pb(a,f);f++);if(e=1e3*n.endTime,l=zo(l),l.length&&n&&(n=l.find(function(m){return m.description==="com.apple.streaming.transportStreamTimestamp"}))&&(e=n.data),n=lx(a,f),!n)return Promise.reject(new K(2,3,3018));for(t.audioSamplingRate=n.sampleRate,t.channelsCount=n.channelCount,l=[];f<a.length;){var c=ax(a,f);if(!c)return Promise.reject(new K(2,3,3018));var p=c.Hd+c.S;f+p<=a.length&&l.push({data:a.subarray(f+c.Hd,f+p),size:c.S,duration:1024,Ta:0,flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:2,Va:0}}),f+=p}return a=n.sampleRate,e=Math.floor(e*a/1e3),o={id:t.id,type:"audio",codecs:n.ha,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:a,duration:o,Ra:[],fa:new Uint8Array([]),la:new Uint8Array([]),sa:0,ua:0,data:{gb:this.h,baseMediaDecodeTime:e,Oa:l},stream:t},e=new Wr([o]),this.g.has(t.id)?o=this.g.get(t.id):(o=Xr(e),this.g.set(t.id,o)),t=ha(e),this.h++,t=Lt(o,t),Promise.resolve(t)},ae("shaka.transmuxer.AacTransmuxer",qn),qn.prototype.transmux=qn.prototype.transmux,qn.prototype.getOriginalMimeType=qn.prototype.getOriginalMimeType,qn.prototype.convertCodecs=qn.prototype.convertCodecs,qn.prototype.isSupported=qn.prototype.isSupported,qn.prototype.destroy=qn.prototype.destroy,Bi("audio/aac",function(){return new qn("audio/aac")},so);function ux(e,t){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return null;var n=e[t+4]>>6;if(3<=n)return null;var o=e[t+4]&63,a=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+n];if(t+a>e.length)return null;var l=e[t+6]>>5,f=0;l===2?f+=2:(l&1&&l!==1&&(f+=2),l&4&&(f+=2)),f=(e[t+6]<<8|e[t+7])>>12-f&1;var c=e[t+5]&7;return e=new Uint8Array([n<<6|e[t+5]>>3<<1|c>>2,(c&3)<<6|l<<3|f<<2|o>>4,o<<4&224]),{sampleRate:[48e3,44100,32e3][n],channelCount:[2,1,2,3,3,4,4,5][l]+f,fa:e,S:a}}function mb(e,t){if(e[t]===11&&e[t+1]===119){var n=0,o=5;t+=o;for(var a,l;0<o;){l=e[t];var f=Math.min(o,8),c=8-f;a=4278190080>>>24+c<<c,a=(l&a)>>c,n=n?n<<f|a:a,t+=1,o-=f}if(16>n)return!0}return!1}function Qn(e){this.i=e,this.h=0,this.g=new Map}s=Qn.prototype,s.destroy=function(){this.g.clear()},s.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/ac3"?ve(this.convertCodecs("audio",e)):!1},s.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/ac3"?'audio/mp4; codecs="ac-3"':t},s.getOriginalMimeType=function(){return this.i},s.transmux=function(e,t,n,o){e=Ve(e);for(var a=Os(e),l=a.length;l<e.length&&!mb(e,l);l++);var f=1e3*n.endTime;a=zo(a),a.length&&n&&(n=a.find(function(m){return m.description==="com.apple.streaming.transportStreamTimestamp"}))&&(f=n.data),n=0,a=new Uint8Array([]);for(var c=[];l<e.length;){var p=ux(e,l);if(!p)return Promise.reject(new K(2,3,3018));t.audioSamplingRate=p.sampleRate,t.channelsCount=p.channelCount,n=p.sampleRate,a=p.fa,c.push({data:e.subarray(l,l+p.S),size:p.S,duration:1536,Ta:0,flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:2,Va:0}}),l+=p.S}return e=Math.floor(f*n/1e3),o={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:n,duration:o,Ra:[],fa:a,la:new Uint8Array([]),sa:0,ua:0,data:{gb:this.h,baseMediaDecodeTime:e,Oa:c},stream:t},e=new Wr([o]),this.g.has(t.id)?o=this.g.get(t.id):(o=Xr(e),this.g.set(t.id,o)),t=ha(e),this.h++,t=Lt(o,t),Promise.resolve(t)},ae("shaka.transmuxer.Ac3Transmuxer",Qn),Qn.prototype.transmux=Qn.prototype.transmux,Qn.prototype.getOriginalMimeType=Qn.prototype.getOriginalMimeType,Qn.prototype.convertCodecs=Qn.prototype.convertCodecs,Qn.prototype.isSupported=Qn.prototype.isSupported,Qn.prototype.destroy=Qn.prototype.destroy,Bi("audio/ac3",function(){return new Qn("audio/ac3")},so);function fx(e,t){if(t+8>e.length||(e[t]<<8|e[t+1]<<0)!==2935)return null;var n=new Ki(e.subarray(t+2));Tn(n,2),Tn(n,3);var o=tt(n,11)+1<<1,a=tt(n,2);if(a==3){a=tt(n,2),a=[24e3,22060,16e3][a];var l=3}else a=[48e3,44100,32e3][a],l=tt(n,2);var f=tt(n,3),c=tt(n,1);return n=tt(n,5),t+o>e.byteLength?null:(e=Math.floor(o*a/(16*[1,2,3,6][l])),e=new Uint8Array([(e&8160)>>5,(e&31)<<3,a<<6|n<<1|0,0|f<<1|c<<0,0]),{sampleRate:a,channelCount:[2,1,2,3,3,4,4,5][f]+c,fa:e,S:o})}function Zn(e){this.i=e,this.h=0,this.g=new Map}s=Zn.prototype,s.destroy=function(){this.g.clear()},s.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/ec3"?ve(this.convertCodecs("audio",e)):!1},s.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/ec3"?'audio/mp4; codecs="ec-3"':t},s.getOriginalMimeType=function(){return this.i},s.transmux=function(e,t,n,o){e=Ve(e);for(var a=Os(e),l=a.length;l<e.length&&(e[l]<<8|e[l+1]<<0)!==2935;l++);var f=1e3*n.endTime;a=zo(a),a.length&&n&&(n=a.find(function(m){return m.description==="com.apple.streaming.transportStreamTimestamp"}))&&(f=n.data),n=0,a=new Uint8Array([]);for(var c=[];l<e.length;){var p=fx(e,l);if(!p)return Promise.reject(new K(2,3,3018));t.audioSamplingRate=p.sampleRate,t.channelsCount=p.channelCount,n=p.sampleRate,a=p.fa,c.push({data:e.subarray(l,l+p.S),size:p.S,duration:1536,Ta:0,flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:2,Va:0}}),l+=p.S}return e=Math.floor(f*n/1e3),o={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:n,duration:o,Ra:[],fa:a,la:new Uint8Array([]),sa:0,ua:0,data:{gb:this.h,baseMediaDecodeTime:e,Oa:c},stream:t},e=new Wr([o]),this.g.has(t.id)?o=this.g.get(t.id):(o=Xr(e),this.g.set(t.id,o)),t=ha(e),this.h++,t=Lt(o,t),Promise.resolve(t)},ae("shaka.transmuxer.Ec3Transmuxer",Zn),Zn.prototype.transmux=Zn.prototype.transmux,Zn.prototype.getOriginalMimeType=Zn.prototype.getOriginalMimeType,Zn.prototype.convertCodecs=Zn.prototype.convertCodecs,Zn.prototype.isSupported=Zn.prototype.isSupported,Zn.prototype.destroy=Zn.prototype.destroy,Bi("audio/ec3",function(){return new Zn("audio/ec3")},so);function yb(e){if(!e.length)return null;var t=e.find(function(_){return _.type==7});if(e=e.find(function(_){return _.type==8}),!t||!e)return null;var n=new Ki(t.data),o=ut(n);if(ut(n),ut(n),pn(n),xb.includes(o)&&(o=Me(n),o===3&&Tn(n,1),pn(n),pn(n),Tn(n,1),je(n))){o=o!==3?8:12;for(var a=0;a<o;a++)je(n)&&(6>a?Tl(n,16):Tl(n,64))}if(pn(n),o=Me(n),o===0)Me(n);else if(o===1)for(Tn(n,1),pn(n),pn(n),o=Me(n),a=0;a<o;a++)pn(n);pn(n),Tn(n,1);var l=Me(n),f=Me(n),c=tt(n,1);c===0&&Tn(n,1),Tn(n,1);var p=0,m=0,v=0,S=0;if(je(n)&&(p=Me(n),m=Me(n),v=Me(n),S=Me(n)),a=o=1,je(n)&&je(n)){var C=ut(n),T=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],I=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<C&&16>C?(o=T[C-1],a=I[C-1]):C===255&&(o=tt(n,16),a=tt(n,16))}return n=(2-c)*(f+1)*16-2*v-2*S,l=16*(l+1)-2*p-2*m,p=[],t=t.fullData,p.push(t.byteLength>>>8&255),p.push(t.byteLength&255),p=p.concat.apply(p,R(t)),t=[],e=e.fullData,t.push(e.byteLength>>>8&255),t.push(e.byteLength&255),t=t.concat.apply(t,R(e)),e=new Uint8Array([1,p[3],p[4],p[5],255,225].concat(p,[1],t)),{height:n,width:l,la:e,sa:o,ua:a}}function vb(e){var t=!1,n=[],o=e.find(function(p){return p.type==7}),a=!1;e=w(e);for(var l=e.next();!l.done;l=e.next()){l=l.value;var f=!1;switch(l.type){case 1:f=a=!0;var c=l.data;o&&4<c.length&&(c=sS(new Ki(c)),c===2||c===4||c===7||c===9)&&(t=!0);break;case 5:t=f=a=!0;break;case 6:f=!0;break;case 7:f=!0;break;case 8:f=!0;break;case 9:a=f=!0;break;case 12:f=!0;break;default:f=!1}a&&f&&(f=l.fullData.byteLength,c=new Uint8Array(4),c[0]=f>>24&255,c[1]=f>>16&255,c[2]=f>>8&255,c[3]=f&255,n.push(Lt(c,l.fullData)))}return n.length?{data:Lt.apply(ln,R(n)),Vc:t}:null}var xb=[100,110,122,244,44,83,86,118,128,138,139,134];function wb(e){if(!e.length)return null;var t=e.find(function(f){return f.type==32}),n=e.find(function(f){return f.type==33}),o=e.find(function(f){return f.type==34});if(!t||!n||!o)return null;var a=Sb(t.fullData);e=Tb(n.fullData);var l=Cb(o.fullData);return t=Eb(t.fullData,n.fullData,o.fullData,{Ze:a.Ze,uf:a.uf,De:e.De,Ee:e.Ee,xe:e.xe,Ce:e.Ce,ye:e.ye,ze:e.ze,Ae:e.Ae,Be:e.Be,re:e.re,se:e.se,te:e.te,ue:e.ue,ve:e.ve,we:e.we,oe:e.oe,Rd:e.Rd,ne:e.ne,me:e.me,le:e.le,bf:l.bf}),{height:e.height,width:e.width,la:t,sa:e.Uh,ua:e.Th}}function Sb(e){var t=new Ki(e,!0);return ut(t),ut(t),tt(t,4),tt(t,2),tt(t,6),e=tt(t,3),t=je(t),{Ze:e+1,uf:t}}function Tb(e){e=new Ki(e,!0),ut(e),ut(e);var t=0,n=0,o=0,a=0;tt(e,4);var l=tt(e,3);je(e);for(var f=tt(e,2),c=tt(e,1),p=tt(e,5),m=ut(e),v=ut(e),S=ut(e),C=ut(e),T=ut(e),I=ut(e),_=ut(e),N=ut(e),j=ut(e),O=ut(e),X=ut(e),V=[],q=[],te=0;te<l;te++)V.push(je(e)),q.push(je(e));if(0<l)for(te=l;8>te;te++)tt(e,2);for(te=0;te<l;te++)V[te]&&tt(e,88),q[te]&&ut(e);Me(e),V=Me(e),V==3&&tt(e,1),q=Me(e),te=Me(e),je(e)&&(t+=Me(e),n+=Me(e),o+=Me(e),a+=Me(e));var de=Me(e),ce=Me(e),he=Me(e);if(je(e))for(var ge=0;ge<=l;ge++)Me(e),Me(e),Me(e);else Me(e),Me(e),Me(e);if(Me(e),Me(e),Me(e),Me(e),Me(e),Me(e),je(e)&&je(e))for(ge=0;4>ge;ge++)for(var Se=0;Se<(ge===3?2:6);Se++)if(je(e)){var ke=Math.min(64,1<<4+(ge<<1));1<ge&&Sr(e);for(var Ne=0;Ne<ke;Ne++)Sr(e)}else Me(e);for(je(e),je(e),je(e)&&(ut(e),Me(e),Me(e),je(e)),ge=Me(e),ke=Se=0;ke<ge;ke++)if(Ne=!1,ke!==0&&(Ne=je(e)),Ne){ke===ge&&Me(e),je(e),Me(e);for(var He=Ne=0;He<=Se;He++){var Ge=je(e),Ze=!1;Ge||(Ze=je(e)),(Ge||Ze)&&Ne++}Se=Ne}else{for(He=Me(e),Ne=Me(e),Se=He+Ne,Ge=0;Ge<He;Ge++)Me(e),je(e);for(He=0;He<Ne;He++)Me(e),je(e)}if(je(e))for(ge=Me(e),Se=0;Se<ge;Se++){for(ke=0;ke<he+4;ke++)tt(e,1);tt(e,1)}if(ge=he=1,Se=0,je(e),je(e),je(e)){if(je(e)&&(ke=ut(e),Ne=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],He=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1],0<ke&&16>ke?(he=Ne[ke-1],ge=He[ke-1]):ke===255&&(he=tt(e,16),ge=tt(e,16))),je(e)&&je(e),je(e)&&(tt(e,3),je(e),je(e)&&(ut(e),ut(e),ut(e))),je(e)&&(Me(e),Me(e)),je(e),je(e),je(e),(ke=je(e))&&(Me(e),Me(e),Me(e),Me(e)),je(e)&&(tt(e,32),tt(e,32),je(e)&&Me(e),je(e)))for(He=!1,ke=je(e),Ne=je(e),(ke||Ne)&&((He=je(e))&&(ut(e),tt(e,5),je(e),tt(e,5)),tt(e,4),tt(e,4),He&&tt(e,4),tt(e,5),tt(e,5),tt(e,5)),Ge=0;Ge<=l;Ge++){var Oe=!0;Ze=1,je(e)||(Oe=je(e));var zt=!1;if(Oe?Me(e):zt=je(e),zt||(Ze=Me(e)+1),ke){for(Oe=0;Oe<Ze;Oe++)Me(e),Me(e),He&&(Me(e),Me(e));je(e)}if(Ne){for(Oe=0;Oe<Ze;Oe++)Me(e),Me(e),He&&(Me(e),Me(e));je(e)}}je(e)&&(je(e),je(e),je(e),Se=Me(e),Me(e),Me(e),Me(e),Me(e))}return{xe:X,De:f,Ee:c,Ce:p,ye:m,ze:v,Ae:S,Be:C,re:T,se:I,te:_,ue:N,ve:j,we:O,Rd:Se,oe:0,ne:V,me:de,le:ce,width:q-(t+n)*(V===1||V===2?2:1),height:te-(o+a)*(V===1?2:1),Uh:he,Th:ge}}function Cb(e){var t=new Ki(e,!0);ut(t),ut(t),Me(t),Me(t),je(t),je(t),tt(t,3),je(t),je(t),Me(t),Me(t),Sr(t),je(t),je(t),je(t)&&Me(t),Sr(t),Sr(t),je(t),je(t),je(t),je(t),e=je(t),t=je(t);var n=1;return t&&e?n=0:t?n=3:e&&(n=2),{bf:n}}function Eb(e,t,n,o){var a=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength));return a[0]=1,a[1]=(o.De&3)<<6|(o.Ee?1:0)<<5|o.Ce&31,a[2]=o.ye,a[3]=o.ze,a[4]=o.Ae,a[5]=o.Be,a[6]=o.re,a[7]=o.se,a[8]=o.te,a[9]=o.ue,a[10]=o.ve,a[11]=o.we,a[12]=o.xe,a[13]=240|(o.Rd&3840)>>8,a[14]=o.Rd&255,a[15]=252|o.bf&3,a[16]=252|o.ne&3,a[17]=248|o.me&7,a[18]=248|o.le&7,a[19]=0,a[20]=0,a[21]=(o.oe&3)<<6|(o.Ze&7)<<3|(o.uf?1:0)<<2|3,a[22]=3,a[23]=160,a[24]=0,a[25]=1,a[26]=(e.byteLength&65280)>>8,a[27]=(e.byteLength&255)>>0,a.set(e,28),a[23+(5+e.byteLength)]=161,a[e.byteLength+29]=0,a[e.byteLength+30]=1,a[e.byteLength+31]=(t.byteLength&65280)>>8,a[e.byteLength+32]=(t.byteLength&255)>>0,a.set(t,e.byteLength+33),a[23+(e.byteLength+10+t.byteLength)]=162,a[e.byteLength+10+t.byteLength+24]=0,a[e.byteLength+10+t.byteLength+25]=1,a[e.byteLength+10+t.byteLength+26]=(n.byteLength&65280)>>8,a[e.byteLength+10+t.byteLength+27]=(n.byteLength&255)>>0,a.set(n,e.byteLength+10+t.byteLength+28),a}function Wu(e,t){var n=e[t+1]>>3&3,o=e[t+1]>>1&3,a=e[t+2]>>4&15,l=e[t+2]>>2&3;if(n!==1&&a!==0&&a!==15&&l!==3){var f=e[t+3]>>6;a=1e3*Ab[14*(n===3?3-o:o===3?3:4)+a-1],l=bb[3*(n===3?0:n===2?1:2)+l],n=Ib[n][o];var c=kb[o],p=Math.floor(n*a/l+(e[t+2]>>1&1))*c,m=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(m=m?parseInt(m[1],10):0)&&87>=m&&o===2&&224e3<=a&&f===0&&(e[t+3]|=128),{sampleRate:l,channelCount:f===3?1:2,S:p,Sh:8*n*c}}return null}function cx(e,t){return e[t]===255&&(e[t+1]&224)===224&&(e[t+1]&6)!==0}var Ab=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],bb=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Ib=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],kb=[0,1,1,4];function Jn(e){this.i=e,this.h=0,this.g=new Map}s=Jn.prototype,s.destroy=function(){this.g.clear()},s.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/mpeg"?ve(this.convertCodecs("audio",e)):!1},s.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/mpeg"?'audio/mp4; codecs="mp3"':t},s.getOriginalMimeType=function(){return this.i},s.transmux=function(e,t,n,o){for(e=Ve(e),n=Os(e).length;n<e.length;n++){var a=n;if(a+1<e.length&&cx(e,a)){var l=Wu(e,a),f=4;l&&l.S&&(f=l.S),a+=f,a=a===e.length||a+1<e.length&&cx(e,a)}else a=!1;if(a)break}var c;for(a=[];n<e.length;){if(l=Wu(e,n),!l)return Promise.reject(new K(2,3,3018));c||(c=l),n+l.S<=e.length&&a.push({data:e.subarray(n,n+l.S),size:l.S,duration:1152,Ta:0,flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:2,Va:0}}),n+=l.S}return c?(e=9e4*c.Sh/c.sampleRate*this.h,o={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:c.sampleRate,duration:o,Ra:[],fa:new Uint8Array([]),la:new Uint8Array([]),sa:0,ua:0,data:{gb:this.h,baseMediaDecodeTime:e,Oa:a},stream:t},c=new Wr([o]),this.g.has(t.id)?o=this.g.get(t.id):(o=Xr(c),this.g.set(t.id,o)),t=ha(c),this.h++,t=Lt(o,t),Promise.resolve(t)):Promise.reject(new K(2,3,3018))},ae("shaka.transmuxer.Mp3Transmuxer",Jn),Jn.prototype.transmux=Jn.prototype.transmux,Jn.prototype.getOriginalMimeType=Jn.prototype.getOriginalMimeType,Jn.prototype.convertCodecs=Jn.prototype.convertCodecs,Jn.prototype.isSupported=Jn.prototype.isSupported,Jn.prototype.destroy=Jn.prototype.destroy,Bi("audio/mpeg",function(){return new Jn("audio/mpeg")},so);function ei(e){this.h=e,this.g=null}s=ei.prototype,s.destroy=function(){},s.isSupported=function(e){if(e.toLowerCase().split(";")[0]!="video/mp2t")return!1;var t=ri(e).split(","),n=Sn("audio",t);return t=Sn("video",t),!n||t||oi(n)!="mp3"?!1:ve(this.convertCodecs("audio",e))},s.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="video/mp2t"?"audio/mpeg":t},s.getOriginalMimeType=function(){return this.h},s.transmux=function(e,t,n,o,a){if(this.g?this.g.clearData():this.g=new wt,e=Ve(e),e=this.g.parse(e),e.Pc().audio!="mp3"||a!="audio")return Promise.reject(new K(2,3,3018));for(a=new Uint8Array([]),e=w(e.Mb()),t=e.next();!t.done;t=e.next())if(t=t.value.data)for(n=0;n<t.length;)(o=Wu(t,n))?(n+o.S<=t.length&&(a=Lt(a,t.subarray(n,n+o.S))),n+=o.S):n++;return Promise.resolve(a)},ae("shaka.transmuxer.MpegTsTransmuxer",ei),ei.prototype.transmux=ei.prototype.transmux,ei.prototype.getOriginalMimeType=ei.prototype.getOriginalMimeType,ei.prototype.convertCodecs=ei.prototype.convertCodecs,ei.prototype.isSupported=ei.prototype.isSupported,ei.prototype.destroy=ei.prototype.destroy,Bi("video/mp2t",function(){return new ei("video/mp2t")},Wf);/*
 @license
 MSS Transmuxer
 Copyright 2015 Dash Industry Forum
 SPDX-License-Identifier: BSD-3-Clause
*/function Bn(e){this.h=e,(this.g=Gh.get("ISOBoxer")())&&Mb(this)}function Mb(e){function t(){this._procFullBox(),this.flags&1&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,function(n){this._procEntryField(n,"InitializationVector","data",8),this.flags&2&&(this._procEntryField(n,"NumberOfEntries","uint",16),this._procSubEntries(n,"clearAndCryptedData",n.NumberOfEntries,function(o){this._procEntryField(o,"BytesOfClearData","uint",16),this._procEntryField(o,"BytesOfEncryptedData","uint",32)}))})}e.g.addBoxProcessor("saio",function(){this._procFullBox(),this.flags&1&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",this.version===1?64:32)}),e.g.addBoxProcessor("saiz",function(){this._procFullBox(),this.flags&1&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),this.default_sample_info_size===0&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}),e.g.addBoxProcessor("senc",t),e.g.addBoxProcessor("uuid",function(){for(var n=!0,o=0;16>o;o++)this.usertype[o]!==_b[o]&&(n=!1);n&&(this._parsing&&(this.type="sepiff"),t.call(this))})}s=Bn.prototype,s.destroy=function(){},s.isSupported=function(e,t){var n=e.startsWith("mss/");return!this.g||!n?!1:t?ve(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),ve(t)||ve(e))},s.convertCodecs=function(e,t){return t.replace("mss/","")},s.getOriginalMimeType=function(){return this.h},s.transmux=function(e,t,n){if(!n)return Promise.resolve(Ve(e));if(!t.mssPrivateData)return Promise.reject(new K(2,3,3020));try{var o,a=this.g.parseBuffer(e),l=a.fetch("tfhd");l.track_ID=t.id+1;var f=a.fetch("tfdt"),c=a.fetch("traf");f===null&&(f=this.g.createFullBox("tfdt",c,l),f.version=1,f.flags=0,f.baseMediaDecodeTime=Math.floor(n.startTime*t.mssPrivateData.timescale));var p=a.fetch("trun"),m=a.fetch("tfxd");m&&m._parent.boxes.splice(m._parent.boxes.indexOf(m),1);var v=a.fetch("tfrf");v&&v._parent.boxes.splice(v._parent.boxes.indexOf(v),1);var S=a.fetch("sepiff");if(S!==null){S.type="senc",S.usertype=void 0;var C=a.fetch("saio");if(C===null){C=this.g.createFullBox("saio",c),C.version=0,C.flags=0,C.entry_count=1,C.offset=[0];var T=this.g.createFullBox("saiz",c);if(T.version=0,T.flags=0,T.sample_count=S.sample_count,T.default_sample_info_size=0,T.sample_info_size=[],S.flags&2)for(o=0;o<S.sample_count;o+=1)T.sample_info_size[o]=10+6*S.entry[o].NumberOfEntries;else T.default_sample_info_size=8}}l.flags&=16777214,l.flags|=131072,p.flags|=1;var I=a.fetch("moof");p.data_offset=I.getLength()+8;var _=a.fetch("saio");_!==null&&(_.offset[0]=hx(I,"traf")+hx(c,"senc")+16);var N=Ve(a.write());return Promise.resolve(N)}catch(j){return j instanceof K?Promise.reject(j):Promise.reject(new K(2,3,3022))}};function hx(e,t){for(var n=8,o=0;o<e.boxes.length&&e.boxes[o].type!==t;o++)n+=e.boxes[o].size;return n}ae("shaka.transmuxer.MssTransmuxer",Bn),Bn.prototype.transmux=Bn.prototype.transmux,Bn.prototype.getOriginalMimeType=Bn.prototype.getOriginalMimeType,Bn.prototype.convertCodecs=Bn.prototype.convertCodecs,Bn.prototype.isSupported=Bn.prototype.isSupported,Bn.prototype.destroy=Bn.prototype.destroy;var _b=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);Bi("mss/audio/mp4",function(){return new Bn("mss/audio/mp4")},so),Bi("mss/video/mp4",function(){return new Bn("mss/video/mp4")},so);function ti(e){this.j=e,this.g=0,this.h=new Map,this.i=null}s=ti.prototype,s.destroy=function(){this.h.clear()},s.isSupported=function(e,t){if(e.toLowerCase().split(";")[0]!="video/mp2t")return!1;var n=e;t&&(n=this.convertCodecs(t,e));var o=ri(n).split(",");return n=Sn("audio",o),o=Sn("video",o),n&&(n=oi(n),!Rb.includes(n))||o&&(n=oi(o),!Lb.includes(n))?!1:t?ve(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),ve(t)||ve(e))},s.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="video/mp2t"?(t=ri(t).replace("mp4a.40.34","mp3").split(",").map(this.Sg).join(","),e=="audio"?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'):t},s.Sg=function(e){if(e.includes("avc1")){var t=e.split(".");if(t.length==3)return e=t.shift()+".",e+=parseInt(t.shift(),10).toString(16),e+=("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}return e},s.getOriginalMimeType=function(){return this.j},s.transmux=function(e,t,n,o,a){this.i?this.i.clearData():this.i=new wt,e=Ve(e);var l=this.i.parse(e);e=[];var f=l.Pc();try{var c=null;if(a=="video"){switch(f.video){case"avc":var p=[],m=null,v=[],S=l.kc();if(!S.length)throw new K(2,3,3023);for(var C=0;C<S.length;C++){var T=S[C],I=T.nalus;v.push.apply(v,R(I));var _=vb(I);if(_){m==null&&(m=T.dts);var N=void 0;N=C+1<S.length?(S[C+1].dts||0)-(T.dts||0):1<S.length?(T.dts||0)-(S[C-1].dts||0):9e4*(n.endTime-n.startTime),p.push({data:_.data,size:_.data.byteLength,duration:N,Ta:Math.round((T.pts||0)-(T.dts||0)),flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:_.Vc?2:1,Va:_.Vc?0:1}})}}var j=yb(v);if(!j||m==null)throw new K(2,3,3018);t.height=j.height,t.width=j.width,c={id:t.id,type:"video",codecs:"avc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:o,Ra:[],fa:new Uint8Array([]),la:j.la,sa:j.sa,ua:j.ua,data:{gb:this.g,baseMediaDecodeTime:m,Oa:p},stream:t};break;case"hvc":if(S=[],T=null,I=[],p=l.kc(),!p.length)throw new K(2,3,3023);for(_=0;_<p.length;_++){m=p[_],v=m.nalus,I.push.apply(I,R(v)),j=!1;var O=[],X=!1;for(C=w(v),N=C.next();!N.done;N=C.next()){var V=N.value;switch(V.type){case 1:case 0:var q=X=!0;break;case 19:case 20:case 21:j=q=X=!0;break;case 32:q=!0;break;case 33:q=!0;break;case 34:q=!0;break;case 35:X=q=!0;break;case 39:case 40:q=!0;break;default:q=!1}if(X&&q){var te=V.fullData.byteLength,de=new Uint8Array(4);de[0]=te>>24&255,de[1]=te>>16&255,de[2]=te>>8&255,de[3]=te&255,O.push(Lt(de,V.fullData))}}var ce=O.length?{data:Lt.apply(ln,R(O)),Vc:j}:null;ce&&(T==null&&m.dts!=null&&(T=m.dts),j=void 0,j=_+1<p.length?(p[_+1].dts||0)-(m.dts||0):1<p.length?(m.dts||0)-(p[_-1].dts||0):9e4*(n.endTime-n.startTime),S.push({data:ce.data,size:ce.data.byteLength,duration:j,Ta:Math.round((m.pts||0)-(m.dts||0)),flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:ce.Vc?2:1,Va:ce.Vc?0:1}}))}var he=wb(I);if(!he||T==null)throw new K(2,3,3018);t.height=he.height,t.width=he.width,c={id:t.id,type:"video",codecs:"hvc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:o,Ra:[],fa:new Uint8Array([]),la:he.la,sa:he.sa,ua:he.ua,data:{gb:this.g,baseMediaDecodeTime:T,Oa:S},stream:t}}c&&(e.push(c),c=null)}if(a=="audio"){switch(f.audio){case"aac":for(var ge=[],Se,ke=null,Ne=w(l.Mb()),He=Ne.next();!He.done;He=Ne.next()){var Ge=He.value,Ze=Ge.data;if(Ze){var Oe=0;if(Se=lx(Ze,Oe),!Se)throw new K(2,3,3018);for(t.audioSamplingRate=Se.sampleRate,t.channelsCount=Se.channelCount,ke==null&&Ge.pts!==null&&(ke=Ge.pts);Oe<Ze.length;){var zt=ax(Ze,Oe);if(zt){var Qt=zt.Hd+zt.S;Oe+Qt<=Ze.length&&ge.push({data:Ze.subarray(Oe+zt.Hd,Oe+Qt),size:zt.S,duration:1024,Ta:0,flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:2,Va:0}}),Oe+=Qt}else Oe++}}}if(!Se||ke==null){if(!l.kc().length)throw new K(2,3,3018);ke=9e4*n.startTime;var pi=Sn("audio",t.codecs.split(","));if(!pi||!t.channelsCount||!t.audioSamplingRate)throw new K(2,3,3018);Se={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,ha:pi};var mn=gb(pi,t.channelsCount);if(!mn)throw new K(2,3,3018);var Ai=ke+9e4*(n.endTime-n.startTime);for(l=ke;l<Ai;)ge.push({data:mn,size:mn.byteLength,duration:1024,Ta:0,flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:2,Va:0}}),l+=1024/Se.sampleRate*9e4}var gt=Se.sampleRate;l=ke/9e4*gt,c={id:t.id,type:"audio",codecs:Se.ha,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:gt,duration:o,Ra:[],fa:new Uint8Array([]),la:new Uint8Array([]),sa:0,ua:0,data:{gb:this.g,baseMediaDecodeTime:l,Oa:ge},stream:t};break;case"ac3":Se=[],gt=0,ge=new Uint8Array([]),ke=null,Oe=w(l.Mb());for(var In=Oe.next();!In.done;In=Oe.next()){var yn=In.value,jn=yn.data;for(ke==null&&yn.pts!==null&&(ke=yn.pts),l=0;l<jn.length;){var Vt=ux(jn,l);Vt?(t.audioSamplingRate=Vt.sampleRate,t.channelsCount=Vt.channelCount,gt=Vt.sampleRate,ge=Vt.fa,Se.push({data:jn.subarray(l,l+Vt.S),size:Vt.S,duration:1536,Ta:0,flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:2,Va:0}}),l+=Vt.S):l++}}if(gt==0||ge.byteLength==0||ke==null)throw new K(2,3,3018);l=ke/9e4*gt,c={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:gt,duration:o,Ra:[],fa:ge,la:new Uint8Array([]),sa:0,ua:0,data:{gb:this.g,baseMediaDecodeTime:l,Oa:Se},stream:t};break;case"ec3":Se=[],gt=0,ke=new Uint8Array([]),ge=null;for(var qr=w(l.Mb()),mo=qr.next();!mo.done;mo=qr.next()){var Qo=mo.value,Qr=Qo.data;for(ge==null&&Qo.pts!==null&&(ge=Qo.pts),l=0;l<Qr.length;){var bi=fx(Qr,l);bi?(t.audioSamplingRate=bi.sampleRate,t.channelsCount=bi.channelCount,gt=bi.sampleRate,ke=bi.fa,Se.push({data:Qr.subarray(l,l+bi.S),size:bi.S,duration:1536,Ta:0,flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:2,Va:0}}),l+=bi.S):l++}}if(gt==0||ke.byteLength==0||ge==null)throw new K(2,3,3018);l=ge/9e4*gt,c={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:gt,duration:o,Ra:[],fa:ke,la:new Uint8Array([]),sa:0,ua:0,data:{gb:this.g,baseMediaDecodeTime:l,Oa:Se},stream:t};break;case"mp3":Se=[];var Zo;gt=null;for(var Zr=w(l.Mb()),yo=Zr.next();!yo.done;yo=Zr.next()){var Jr=yo.value,vo=Jr.data;if(vo)for(gt==null&&Jr.pts!==null&&(gt=Jr.pts),l=0;l<vo.length;){var Oi=Wu(vo,l);Oi?(Zo||(Zo=Oi),l+Oi.S<=vo.length&&Se.push({data:vo.subarray(l,l+Oi.S),size:Oi.S,duration:1152,Ta:0,flags:{Ua:0,La:0,Ja:0,Ha:0,Ia:2,Va:0}}),l+=Oi.S):l++}}if(!Zo||gt==null)throw new K(2,3,3018);var Ea=Zo.sampleRate;l=gt/9e4*Ea,c={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Ea,duration:o,Ra:[],fa:new Uint8Array([]),la:new Uint8Array([]),sa:0,ua:0,data:{gb:this.g,baseMediaDecodeTime:l,Oa:Se},stream:t}}c&&e.push(c)}}catch(es){return es&&es.code==3023?Promise.resolve(new Uint8Array([])):Promise.reject(es)}return e.length?(e=new Wr(e),this.h.has(t.id)?o=this.h.get(t.id):(o=Xr(e),this.h.set(t.id,o)),t=ha(e),this.g++,t=Lt(o,t),Promise.resolve(t)):Promise.reject(new K(2,3,3018))},ae("shaka.transmuxer.TsTransmuxer",ti),ti.prototype.transmux=ti.prototype.transmux,ti.prototype.getOriginalMimeType=ti.prototype.getOriginalMimeType,ti.prototype.convertCodecs=ti.prototype.convertCodecs,ti.prototype.isSupported=ti.prototype.isSupported,ti.prototype.destroy=ti.prototype.destroy;var Rb=["aac","ac-3","ec-3","mp3"],Lb=["avc","hevc"];Bi("video/mp2t",function(){return new ti("video/mp2t")},Xf);/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function dx(){}var Ta;function px(){Ta?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Ta=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=Pb):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function Pb(e,t){var n=this,o;return z(function(a){return a.g==1?(console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),E(a,Ta.call(n,e,t),2)):(o=a.h,Tx(o)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Ta,a.return(o)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=gx,a.return(gx.call(n,e,t))))})}function gx(e,t){var n=this,o,a,l,f,c,p,m,v,S,C;return z(function(T){if(T.g==1){for(console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),o=Sx(e),a=[],l=w(t),f=l.next();!f.done;f=l.next())c=f.value,p=mx(c.videoCapabilities,o),m=mx(c.audioCapabilities,o),c.videoCapabilities&&c.videoCapabilities.length&&!p.length||c.audioCapabilities&&c.audioCapabilities.length&&!m.length||(v=Object.assign({},c),v.videoCapabilities=p,v.audioCapabilities=m,a.push(v));if(!a.length)throw S=Error("Unsupported keySystem or supportedConfigurations."),S.name="NotSupportedError",S.code=DOMException.NOT_SUPPORTED_ERR,S;return E(T,Ta.call(n,e,a),2)}return C=T.h,T.return(new Xu(C,o))})}function mx(e,t){return e&&e.filter(function(n){return!n.encryptionScheme||n.encryptionScheme==t})}ae("EmeEncryptionSchemePolyfill",dx),dx.install=px;function yx(){}var Ca;function vx(){Ca?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(Ca=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Db):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function Db(e){var t=this,n,o,a;return z(function(l){switch(l.g){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),E(l,Ca.call(t,e),2);case 2:if(n=l.h,!e.keySystemConfiguration)return l.return(n);if((o=n.keySystemAccess)&&Tx(o))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Ca,l.return(n);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=xx,o){l.B(3);break}return a=n,E(l,wx(e),4);case 4:return a.keySystemAccess=l.h,l.return(n);case 3:return l.return(xx.call(t,e))}})}function xx(e){var t=this,n,o,a,l,f,c,p,m;return z(function(v){switch(v.g){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),n=null,e.keySystemConfiguration&&(o=e.keySystemConfiguration,a=o.keySystem,l=o.audio&&o.audio.encryptionScheme,f=o.video&&o.video.encryptionScheme,n=Sx(a),c={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},l&&l!=n||f&&f!=n)?v.return(c):E(v,Ca.call(t,e),2);case 2:if(p=v.h,p.keySystemAccess){p.keySystemAccess=new Xu(p.keySystemAccess,n),v.B(3);break}if(!e.keySystemConfiguration){v.B(3);break}return m=p,E(v,wx(e),5);case 5:m.keySystemAccess=v.h;case 3:return v.return(p)}})}function wx(e){var t,n;return z(function(o){if(o.g==1){var a=e.keySystemConfiguration,l=[],f=[];return a.audio&&l.push({robustness:a.audio.robustness||"",contentType:e.audio.contentType}),a.video&&f.push({robustness:a.video.robustness||"",contentType:e.video.contentType}),a={initDataTypes:a.initDataType?[a.initDataType]:[],distinctiveIdentifier:a.distinctiveIdentifier,persistentState:a.persistentState,sessionTypes:a.sessionTypes},l.length&&(a.audioCapabilities=l),f.length&&(a.videoCapabilities=f),t=a,E(o,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=o.h,o.return(n)})}ae("McEncryptionSchemePolyfill",yx),yx.install=vx;function Xu(e,t){this.h=e,this.g=t,this.keySystem=e.keySystem}Xu.prototype.getConfiguration=function(){var e=this.h.getConfiguration();if(e.videoCapabilities)for(var t=w(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.g;if(e.audioCapabilities)for(t=w(e.audioCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.g;return e},Xu.prototype.createMediaKeys=function(){return this.h.createMediaKeys()};function Sx(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function Tx(e){e=e.getConfiguration();var t=e.audioCapabilities&&e.audioCapabilities[0];return!!((e=e.videoCapabilities&&e.videoCapabilities[0]||t)&&e.encryptionScheme!==void 0)}function Ud(){}function Cx(){px(),vx()}ae("EncryptionSchemePolyfills",Ud),Ud.install=Cx,typeof x<"u"&&x.exports&&(x.exports=Ud)}).call(i,r,r,void 0);for(var u in i.shaka)h[u]=i.shaka[u]})()})(z2);const qx=lM(z2);let er,sn;const bp={playingState:!1},uM=async h=>{qx.polyfill.installAll(),sn=h,sn||(sn=document.createElement("video"),sn.style.cssText="position: absolute; top: 0; left: 0; z-index: -1",sn.width=1920,sn.height=1080,er=new qx.Player,await er.attach(sn),sn.autoplay=!1,er.addEventListener("error",r=>{console.error(r)}),document.body.insertBefore(sn,document.body.firstChild))},fM=async h=>{if(!er||!sn)throw"Player not initialized yet";await er.load(h.streamUrl)},cM=()=>{sn.play().then(()=>{bp.playingState=!0})},hM=()=>{sn.pause(),bp.playingState=!1},dM=async()=>{await er.destroy(),er=null,sn.remove(),sn=null},pM=()=>sn.currentTime,gM=()=>sn.duration,mM=()=>{let h=r=>new Date(r*1e3).toISOString().substr(14,5);return`${h(sn.currentTime)} : ${h(Math.floor(sn.duration))}`},wo={init:uM,load:fM,play:cM,pause:hM,getCurrentTime:pM,getVideoDuration:gM,getTimeFormat:mM,state:bp,destroy:dM},yM=et.Component("Player",{code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.y=1080,A.mount="{y:1}",A.w=1920,A.h=150,A.color={top:"0x00000000",bottom:"0x444444ff"},A.alpha={transition:i.controlsVisibility},s[1].populate(A),r=s[1];const k={};s[2]=this.element({parent:r||"root"},i),k.x=60,k.y=50,s[2].populate(k),r=s[2];const b={};s[3]=this.element({parent:r||"root"},i),b.w=60,b.h=60,b.color="0x0087ceeb",b.effects=[i.shader("radius",{radius:16})],s[3].populate(b),r=s[3];const P={};s[4]=this.element({parent:r||"root"},i),P.y=14,P.x=14,P.w=32,P.h=32,P.src=i.playing?"assets/player/pause.png":"assets/player/play.png",s[4].populate(P),r=s[2];const w={};s[5]=this.element({parent:r||"root"},i),w.y=22,w.x=100,w.w=i.progressLength,w.h=16,w.color="0xffffff80",w.effects=[i.shader("radius",{radius:8})],s[5].populate(w),r=s[5];const R={};s[6]=this.element({parent:r||"root"},i),R.h=16,R.w={transition:{value:i.progress,d:100,f:"ease-in-out"}},R.effects=[i.shader("radius",{radius:8})],R.color="0x0087ceeb",s[6].populate(R);const B=u.components&&u.components.Circle||d.Circle;r=s[5];const U={};if(s[7]=this.element({parent:r||"root"},i),U.size=28,U.color="0xffffffff",U.y=-6,U.x={transition:{value:i.progress-8,d:100,f:"ease-in-out"}},typeof B<"u")for(let J in B.config.props)delete U[B.config.props[J]];s[7].populate(U),r=s[7];const W={};W.size=28,W.color="0xffffffff",W.y=-6,W.x={transition:{value:i.progress-8,d:100,f:"ease-in-out"}},g=W.is||"Circle";let G;if(typeof g=="string"){if(G=u.components&&u.components[g]||d[g],!G)throw new Error('Component "Circle" not found')}else typeof g=="function"&&g.name==="factory"&&(G=g);s[8]=G.call(null,{props:W},s[7],i),s[8][Symbol.for("slots")][0]?(r=s[8][Symbol.for("slots")][0],i=s[8]):r=s[8][Symbol.for("children")][0],r=s[2];const Q={};s[9]=this.element({parent:r||"root"},i),Q.x=1660,Q.y=16,s[9].populate(Q),r=s[9];const ee={};s[10]=this.element({parent:r||"root"},i),ee.content=i.currentTime,ee.size=25,ee.__textnode=!0,s[10].populate(ee),r=s[9];const Z={};s[11]=this.element({parent:r||"root"},i),Z.x=70,Z.size=25,Z.content="/",Z.__textnode=!0,s[11].populate(Z),r=s[9];const H={};return s[12]=this.element({parent:r||"root"},i),H.x=85,H.size=25,H.content=i.duration,H.__textnode=!0,s[12].populate(H),s},effects:[function(r,i,u,d,y,x){i[1].set("color",{top:"0x00000000",bottom:"0x444444ff"})},function(r,i,u,d,y,x){i[1].set("alpha",{transition:r.controlsVisibility})},function(r,i,u,d,y,x){i[3].set("effects",[r.shader("radius",{radius:16})])},function(r,i,u,d,y,x){i[4].set("src",r.playing?"assets/player/pause.png":"assets/player/play.png")},function(r,i,u,d,y,x){i[5].set("effects",[r.shader("radius",{radius:8})])},function(r,i,u,d,y,x){i[6].set("w",{transition:{value:r.progress,d:100,f:"ease-in-out"}})},function(r,i,u,d,y,x){i[6].set("effects",[r.shader("radius",{radius:8})])},function(r,i,u,d,y,x){i[7].set("x",{transition:{value:r.progress-8,d:100,f:"ease-in-out"}})},function(r,i,u,d,y,x){i[8][Symbol.for("props")].x={transition:{value:r.progress-8,d:100,f:"ease-in-out"}}},function(r,i,u,d,y,x){i[10].set("content",r.currentTime)},function(r,i,u,d,y,x){i[12].set("content",r.duration)}],context:{}},state(){return{controlsVisibility:0,progressLength:1520,progress:0,currentTime:"00:00",duration:"00:00",playing:!1,hideTimeout:null}},hooks:{focus(){this.$emit("clearBackground")},unfocus(){this.$emit("changeBackground")},async init(){await wo.init()},async ready(){await wo.load({streamUrl:"https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"});const h=i=>new Date(i*1e3).toISOString().substr(14,5),r=wo.getVideoDuration();r&&(this.duration=h(r),this.progressChunkSize=Math.round(this.progressLength/r*100)/100),this.$setInterval(()=>{const i=wo.getCurrentTime();this.currentTime=h(i),this.progress=Math.round(i*this.progressChunkSize)},1e3),this.play()},async destroy(){await wo.destroy()}},input:{space(){this.play()},up(){this.showControls(1)},down(){this.showControls(0)}},methods:{play(){this.showControls(1),this.hideTimeout=this.$setTimeout(()=>this.showControls(0),3e3),wo.state.playingState==!0?(wo.pause(),this.playing=!1):(console.log("play!"),wo.play(),this.playing=!0)},showControls(h){this.$clearTimeout(this.hideTimeout),this.controlsVisibility=h}}}),vM=et.Component("Colors",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.w=1920,g.h=1080,g.color={transition:i.bg},s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.x=20,M.y=20,s[1].populate(M),r=s[1];const A={};s[2]=this.element({parent:r||"root"},i),A.w=100,A.h=100,A.x=0,A.color="0xecfeffff",s[2].populate(A),r=s[1];const k={};s[3]=this.element({parent:r||"root"},i),k.w=100,k.h=100,k.x=120,k.color="0xa5f3fcff",s[3].populate(k),r=s[1];const b={};s[4]=this.element({parent:r||"root"},i),b.w=100,b.h=100,b.x=240,b.color="0x22d3eeff",s[4].populate(b),r=s[1];const P={};s[5]=this.element({parent:r||"root"},i),P.w=100,P.h=100,P.x=360,P.color="0x0891b2ff",s[5].populate(P),r=s[0];const w={};s[6]=this.element({parent:r||"root"},i),w.x=20,w.y=140,s[6].populate(w),r=s[6];const R={};s[7]=this.element({parent:r||"root"},i),R.w=100,R.h=100,R.x=0,R.color="0xecfeffff",s[7].populate(R),r=s[6];const B={};s[8]=this.element({parent:r||"root"},i),B.w=100,B.h=100,B.x=120,B.color="0xa5f3fcff",s[8].populate(B),r=s[6];const U={};s[9]=this.element({parent:r||"root"},i),U.w=100,U.h=100,U.x=240,U.color="0x22d3eeff",s[9].populate(U),r=s[6];const W={};s[10]=this.element({parent:r||"root"},i),W.w=100,W.h=100,W.x=360,W.color="0x0891b2ff",s[10].populate(W),r=s[0];const G={};s[11]=this.element({parent:r||"root"},i),G.x=20,G.y=260,s[11].populate(G),r=s[11];const Q={};s[12]=this.element({parent:r||"root"},i),Q.w=100,Q.h=100,Q.x=0,Q.color="0xecfeffaa",s[12].populate(Q),r=s[11];const ee={};s[13]=this.element({parent:r||"root"},i),ee.w=100,ee.h=100,ee.x=120,ee.color="0xa5f3fc33",s[13].populate(ee),r=s[11];const Z={};s[14]=this.element({parent:r||"root"},i),Z.w=100,Z.h=100,Z.x=240,Z.color="0x22d3ee20",s[14].populate(Z),r=s[11];const H={};s[15]=this.element({parent:r||"root"},i),H.w=100,H.h=100,H.x=360,H.color="0x0891b2ff",s[15].populate(H),r=s[0];const J={};s[16]=this.element({parent:r||"root"},i),J.x=20,J.y=380,s[16].populate(J),r=s[16];const fe={};s[17]=this.element({parent:r||"root"},i),fe.w=100,fe.h=100,fe.x=0,fe.color="0xecfeffff",s[17].populate(fe),r=s[16];const E={};s[18]=this.element({parent:r||"root"},i),E.w=100,E.h=100,E.x=120,E.color="0xa5f3fcff",s[18].populate(E),r=s[16];const F={};s[19]=this.element({parent:r||"root"},i),F.w=100,F.h=100,F.x=240,F.color="0x22d3eeff",s[19].populate(F),r=s[16];const re={};s[20]=this.element({parent:r||"root"},i),re.w=100,re.h=100,re.x=360,re.color="0x0891b2ff",s[20].populate(re),r=s[0];const ye={};s[21]=this.element({parent:r||"root"},i),ye.x=20,ye.y=500,s[21].populate(ye),r=s[21];const ie={};s[22]=this.element({parent:r||"root"},i),ie.w=100,ie.h=100,ie.x=0,ie.color="0xecfeffab",s[22].populate(ie),r=s[21];const se={};s[23]=this.element({parent:r||"root"},i),se.w=100,se.h=100,se.x=120,se.color="0xa5f3fc33",s[23].populate(se),r=s[21];const ne={};s[24]=this.element({parent:r||"root"},i),ne.w=100,ne.h=100,ne.x=240,ne.color="0x22d3ee21",s[24].populate(ne),r=s[21];const le={};s[25]=this.element({parent:r||"root"},i),le.w=100,le.h=100,le.x=360,le.color="0x0891b2ff",s[25].populate(le),r=s[0];const xe={};s[26]=this.element({parent:r||"root"},i),xe.x=20,xe.y=620,s[26].populate(xe),r=s[26];const we={};s[27]=this.element({parent:r||"root"},i),we.w=100,we.h=100,we.x=0,we.color="0x000000ff",s[27].populate(we),r=s[26];const Te={};s[28]=this.element({parent:r||"root"},i),Te.w=100,Te.h=100,Te.x=120,Te.color="0xccccccff",s[28].populate(Te),r=s[26];const Ie={};s[29]=this.element({parent:r||"root"},i),Ie.w=100,Ie.h=100,Ie.x=240,Ie.color="0x889900ff",s[29].populate(Ie),r=s[26];const Ee={};s[30]=this.element({parent:r||"root"},i),Ee.w=100,Ee.h=100,Ee.x=360,Ee.color="0x00ff00ff",s[30].populate(Ee),r=s[0];const _e={};s[31]=this.element({parent:r||"root"},i),_e.x=20,_e.y=740,s[31].populate(_e),r=s[31];const z={};s[32]=this.element({parent:r||"root"},i),z.w=100,z.h=100,z.x=0,z.color="0x000000ff",s[32].populate(z),r=s[31];const Re={};s[33]=this.element({parent:r||"root"},i),Re.w=100,Re.h=100,Re.x=120,Re.color="0xccccccff",s[33].populate(Re),r=s[31];const Ae={};s[34]=this.element({parent:r||"root"},i),Ae.w=100,Ae.h=100,Ae.x=240,Ae.color="0x889900ff",s[34].populate(Ae),r=s[31];const oe={};s[35]=this.element({parent:r||"root"},i),oe.w=100,oe.h=100,oe.x=360,oe.color="0x00ff00ff",s[35].populate(oe),r=s[0];const D={};s[36]=this.element({parent:r||"root"},i),D.x=620,D.y=20,s[36].populate(D),r=s[36];const me={};s[37]=this.element({parent:r||"root"},i),me.w=300,me.h=200,me.x=0,me.color={transition:i.color1},s[37].populate(me),r=s[36];const Ce={};s[38]=this.element({parent:r||"root"},i),Ce.w=300,Ce.h=200,Ce.x=0,Ce.y=250,Ce.color={transition:i.color2},s[38].populate(Ce),r=s[36];const ze={};s[39]=this.element({parent:r||"root"},i),ze.w=300,ze.h=200,ze.x=100,ze.y=400,ze.color={transition:i.color3},s[39].populate(ze),r=s[36];const ae={};return s[40]=this.element({parent:r||"root"},i),ae.w=300,ae.h=200,ae.x=0,ae.y=650,ae.color={transition:{value:i.color4,d:1e3,f:"ease-in-out"}},s[40].populate(ae),s},effects:[function(r,i,u,d,y,x){i[0].set("color",{transition:r.bg})},function(r,i,u,d,y,x){i[37].set("color",{transition:r.color1})},function(r,i,u,d,y,x){i[38].set("color",{transition:r.color2})},function(r,i,u,d,y,x){i[39].set("color",{transition:r.color3})},function(r,i,u,d,y,x){i[40].set("color",{transition:{value:r.color4,d:1e3,f:"ease-in-out"}})}],context:{}},state(){return{bg:"#fff",color1:"#22d3ee",color2:"#dc2626",color3:"rgba(251, 191, 36)",color4:"#bfdbfe"}},input:{enter(){this.color1=this.color1==="#0891b2"?"#22d3ee":"#0891b2",this.color2=this.color2==="#dc2626"?"#0f0":"#dc2626",this.color3=this.color3==="rgba(251, 191, 36)"?"rgba(30, 64, 175, 0.5)":"rgba(251, 191, 36)",this.color4=this.color4==="#1e3a8a"?"#bfdbfe":"#1e3a8a"}},hooks:{ready(){let h=0;const r=["#fff","#333","#c0ff33","#546aaa","#000","tomato"];this.$setInterval(()=>{h=h+1,h===r.length-1&&(h=0),this.bg=r[h]},2e3)}}}),xM=et.Component("Gradients",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.w=1920/4,M.h=1080,M.color="{top: '0x0891b2ff', bottom: '0xa5f3fcff'}",s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.w=1920/4,A.h=1080,A.x=1920/4,A.color="{left: '0xdc2626ff',  right: '0xf87171ff'}",s[2].populate(A),r=s[0];const k={};s[3]=this.element({parent:r||"root"},i),k.w=1920/4,k.h=1080,k.x=1920/4*2,k.color="{top: '0x0891b2ff', right: '0xf87171ff'}",s[3].populate(k),r=s[0];const b={};return s[4]=this.element({parent:r||"root"},i),b.w=1920/4,b.h=1080,b.x=1920/4*3,b.color="{right: '0x008000ff', bottom: '0xffd700ff'}",s[4].populate(b),s},effects:[function(r,i,u,d,y,x){i[1].set("w",1920/4)},function(r,i,u,d,y,x){i[2].set("w",1920/4)},function(r,i,u,d,y,x){i[2].set("x",1920/4)},function(r,i,u,d,y,x){i[3].set("w",1920/4)},function(r,i,u,d,y,x){i[3].set("x",1920/4*2)},function(r,i,u,d,y,x){i[4].set("w",1920/4)},function(r,i,u,d,y,x){i[4].set("x",1920/4*3)}],context:{}}}),wM=et.Component("Transitions",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.w=200,M.h=200,M.x=50,M.y={transition:i.y},M.color="0xc4b5fdff",s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.w=200,A.h=200,A.x=300,A.y={transition:{value:i.y}},A.color="0xa78bfaff",s[2].populate(A),r=s[0];const k={};s[3]=this.element({parent:r||"root"},i),k.w=200,k.h=200,k.x=550,k.y={transition:{value:i.y,duration:1e3,start:i.start,end:i.doneTransition3}},k.color="0x8b5cf6ff",k.ref="bla",s[3].populate(k),r=s[0];const b={};s[4]=this.element({parent:r||"root"},i),b.w=200,b.h=200,b.x=800,b.y={transition:{value:i.y,duration:500,delay:1e3,start:i.start,end:i.finished}},b.color="0x7c3aedff",s[4].populate(b),r=s[0];const P={};s[5]=this.element({parent:r||"root"},i),P.w=200,P.h=200,P.x=1050,P.y={transition:{value:i.y,easing:"ease-in-out",end:i.finished}},P.color="0x6d28d9ff",s[5].populate(P),r=s[0];const w={};s[6]=this.element({parent:r||"root"},i),w.w=200,w.h=200,w.x=1300,w.y={transition:{value:i.y,duration:3e3,easing:"ease-in-out-back",end:i.finished}},w.color="0x5b21b6ff",s[6].populate(w),r=s[0];const R={};return s[7]=this.element({parent:r||"root"},i),R.w=200,R.h=200,R.x=1550,R.y={transition:{value:i.y,duration:800,easing:"cubic-bezier(1,-0.64,.39,1.44)"}},R.color="0x4c1d95ff",s[7].populate(R),s},effects:[function(r,i,u,d,y,x){i[1].set("y",{transition:r.y})},function(r,i,u,d,y,x){i[2].set("y",{transition:{value:r.y}})},function(r,i,u,d,y,x){i[3].set("y",{transition:{value:r.y,duration:1e3,start:r.start,end:r.doneTransition3}})},function(r,i,u,d,y,x){i[4].set("y",{transition:{value:r.y,duration:500,delay:1e3,start:r.start,end:r.finished}})},function(r,i,u,d,y,x){i[5].set("y",{transition:{value:r.y,easing:"ease-in-out",end:r.finished}})},function(r,i,u,d,y,x){i[6].set("y",{transition:{value:r.y,duration:3e3,easing:"ease-in-out-back",end:r.finished}})},function(r,i,u,d,y,x){i[7].set("y",{transition:{value:r.y,duration:800,easing:"cubic-bezier(1,-0.64,.39,1.44)"}})}],context:{}},state(){return{y:50}},hooks:{ready(){this.$setTimeout(()=>{this.y=1080-50-200},500)}},methods:{doneTransition3(){this.$log.info("Transition 3 is done!")},start(h,r,i){this.$log.info("Start transition",h.nodeId,r,i)},finished(h,r,i){this.$log.info("Finished transition",h.nodeId,r,i)}}}),SM=et.Component("Alpha",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.y=100,s[1].populate(M),r=s[1];const A={};s[2]=this.element({parent:r||"root"},i),A.w=200,A.h=200,A.x=100,A.color="0xffffffff",A.alpha=.2,s[2].populate(A),r=s[1];const k={};s[3]=this.element({parent:r||"root"},i),k.w=200,k.h=200,k.x=320,k.color="0xffffffff",k.alpha=.4,s[3].populate(k),r=s[1];const b={};s[4]=this.element({parent:r||"root"},i),b.w=200,b.h=200,b.x=540,b.color="0xffffffff",b.alpha=.6,s[4].populate(b),r=s[1];const P={};s[5]=this.element({parent:r||"root"},i),P.w=200,P.h=200,P.x=760,P.color="0xffffffff",P.alpha=.8,s[5].populate(P),r=s[1];const w={};s[6]=this.element({parent:r||"root"},i),w.w=200,w.h=200,w.x=980,w.color="0xffffffff",w.alpha=1,s[6].populate(w),r=s[0];const R={};s[7]=this.element({parent:r||"root"},i),R.w=200,R.h=200,R.x=100,R.y=320,R.color="0xffffffff",R.alpha=i.alpha,s[7].populate(R),r=s[0];const B={};s[8]=this.element({parent:r||"root"},i),B.w=200,B.h=200,B.x=100,B.y=540,B.color="0xffffffff",B.alpha=i.alpha,s[8].populate(B),r=s[0];const U={};s[9]=this.element({parent:r||"root"},i),U.w=200,U.h=200,U.x=100,U.y=760,U.color="0xffffffff",U.alpha={transition:{value:i.alpha,duration:1e3,easing:"ease-in-out-circ"}},s[9].populate(U),r=s[0];const W={};s[10]=this.element({parent:r||"root"},i),W.w=428,W.h=234,W.x=1200,W.y=100,W.src=i.image,W.alpha=1,s[10].populate(W),r=s[0];const G={};s[11]=this.element({parent:r||"root"},i),G.w=428,G.h=234,G.x=1300,G.y=100+234-40,G.src=i.image,G.alpha=.4,s[11].populate(G),r=s[0];const Q={};s[12]=this.element({parent:r||"root"},i),Q.w=428,Q.h=234,Q.x=1200,Q.y=100+234*2-40*2,Q.src=i.image,Q.alpha=.1,s[12].populate(Q),r=s[0];const ee={};s[13]=this.element({parent:r||"root"},i),ee.x=400,ee.y=400,ee.alpha=.2,ee.content="Text with alpha applied directly",ee.__textnode=!0,s[13].populate(ee),r=s[0];const Z={};s[14]=this.element({parent:r||"root"},i),Z.alpha=.5,Z.x=400,Z.y=500,s[14].populate(Z),r=s[14];const H={};return s[15]=this.element({parent:r||"root"},i),H.content="Text with alpha applied on parent element",H.__textnode=!0,s[15].populate(H),s},effects:[function(r,i,u,d,y,x){i[8].set("alpha",r.alpha)},function(r,i,u,d,y,x){i[9].set("alpha",{transition:{value:r.alpha,duration:1e3,easing:"ease-in-out-circ"}})},function(r,i,u,d,y,x){i[10].set("src",r.image)},function(r,i,u,d,y,x){i[11].set("y",100+234-40)},function(r,i,u,d,y,x){i[11].set("src",r.image)},function(r,i,u,d,y,x){i[12].set("y",100+234*2-40*2)},function(r,i,u,d,y,x){i[12].set("src",r.image)}],context:{}},state(){return{alpha:.5,direction:"up",image:"assets/lightningbolt.png"}},hooks:{ready(){this.$setInterval(()=>{const h=this.direction==="up"?this.alpha+.2:this.alpha-.2;this.alpha=Math.max(Math.min(h,1),.1),this.alpha===1&&(this.direction="down"),this.alpha===.1&&(this.direction="up")},1400)}}}),TM=et.Component("Scaling",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.x=100,M.y=100,M.w=150,M.h=150,M.color="0x64748bff",s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.x=300,A.y=100,A.w=100,A.h=100,A.color="0x64748bff",A.scale=1.5,s[2].populate(A),r=s[0];const k={};s[3]=this.element({parent:r||"root"},i),k.x=100,k.y=400,k.w=100,k.h=100,k.color="0xb45309ff",k.scale=i.scale,s[3].populate(k),r=s[0];const b={};s[4]=this.element({parent:r||"root"},i),b.x=900,b.y=400,b.w=100,b.h=100,b.src=i.balloon,b.scale={transition:{value:i.scale,easing:"ease-in-out"}},s[4].populate(b),r=s[0];const P={};s[5]=this.element({parent:r||"root"},i),P.x=300,P.y=600,P.w=100,P.h=100,P.color="0x059669ff",P.scale=i.scale2,s[5].populate(P),r=s[5];const w={};s[6]=this.element({parent:r||"root"},i),w.x=10,w.y=10,w.h=60,w.w=80,w.color="0x0369a1ff",s[6].populate(w),r=s[0];const R={};s[7]=this.element({parent:r||"root"},i),R.x=1500,R.y=600,R.w=100,R.h=100,R.color="0x059669ff",R.scale=i.scale2,s[7].populate(R),r=s[7];const B={};return s[8]=this.element({parent:r||"root"},i),B.x=10,B.y=10,B.h=60,B.w=80,B.color="0x0369a1ff",B.scale=i.scale2/2,s[8].populate(B),s},effects:[function(r,i,u,d,y,x){i[4].set("src",r.balloon)},function(r,i,u,d,y,x){i[4].set("scale",{transition:{value:r.scale,easing:"ease-in-out"}})},function(r,i,u,d,y,x){i[5].set("scale",r.scale2)},function(r,i,u,d,y,x){i[7].set("scale",r.scale2)},function(r,i,u,d,y,x){i[8].set("scale",r.scale2/2)}],context:{}},state(){return{scale:2,direction:"up",balloon:"assets/balloon.png",scale2:1}},hooks:{ready(){this.$setInterval(()=>{const i=this.direction==="up"?this.scale+.5:0;this.scale=Math.max(Math.min(i,8),0),this.scale===8&&(this.direction="down"),this.scale===0&&(this.direction="up")},500),this.$setInterval(()=>{this.scale2=this.scale2===1?3:1},2e3)}}}),CM=et.Component("Rotation",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.y=70,s[1].populate(M),r=s[1];const A={};s[2]=this.element({parent:r||"root"},i),A.x=100,A.y=0,A.w=200,A.h=100,A.color="0xfee2e2ff",A.rotation=0,s[2].populate(A),r=s[1];const k={};s[3]=this.element({parent:r||"root"},i),k.x=100,k.y=150,k.w=200,k.h=100,k.color="0xfecacaff",k.rotation=10,s[3].populate(k),r=s[1];const b={};s[4]=this.element({parent:r||"root"},i),b.x=100,b.y=300,b.w=200,b.h=100,b.color="0xfca5a5ff",b.rotation=20,s[4].populate(b),r=s[1];const P={};s[5]=this.element({parent:r||"root"},i),P.x=100,P.y=450,P.w=200,P.h=100,P.color="0xf87171ff",P.rotation=30,s[5].populate(P),r=s[1];const w={};s[6]=this.element({parent:r||"root"},i),w.x=100,w.y=610,w.w=200,w.h=100,w.color="0xef4444ff",w.rotation=40,s[6].populate(w),r=s[1];const R={};s[7]=this.element({parent:r||"root"},i),R.x=100,R.y=800,R.w=200,R.h=100,R.color="0xdc2626ff",R.rotation=50,s[7].populate(R),r=s[0];const B={};s[8]=this.element({parent:r||"root"},i),B.y=70,B.x=300,s[8].populate(B),r=s[8];const U={};s[9]=this.element({parent:r||"root"},i),U.x=100,U.y=0,U.w=200,U.h=100,U.color="0xfee2e2ff",U.rotation=60,s[9].populate(U),r=s[8];const W={};s[10]=this.element({parent:r||"root"},i),W.x=100,W.y=150,W.w=200,W.h=100,W.color="0xfecacaff",W.rotation=70,s[10].populate(W),r=s[8];const G={};s[11]=this.element({parent:r||"root"},i),G.x=100,G.y=300,G.w=200,G.h=100,G.color="0xfca5a5ff",G.rotation=80,s[11].populate(G),r=s[8];const Q={};s[12]=this.element({parent:r||"root"},i),Q.x=100,Q.y=450,Q.w=200,Q.h=100,Q.color="0xf87171ff",Q.rotation=90,s[12].populate(Q),r=s[8];const ee={};s[13]=this.element({parent:r||"root"},i),ee.x=100,ee.y=610,ee.w=200,ee.h=100,ee.color="0xef4444ff",ee.rotation=100,s[13].populate(ee),r=s[8];const Z={};s[14]=this.element({parent:r||"root"},i),Z.x=100,Z.y=800,Z.w=200,Z.h=100,Z.color="0xdc2626ff",Z.rotation=100,s[14].populate(Z),r=s[0];const H={};s[15]=this.element({parent:r||"root"},i),H.y=70,H.x=600,s[15].populate(H),r=s[15];const J={};s[16]=this.element({parent:r||"root"},i),J.x=100,J.y=0,J.w=200,J.h=100,J.color="0xfee2e2ff",J.rotation=110,s[16].populate(J),r=s[15];const fe={};s[17]=this.element({parent:r||"root"},i),fe.x=100,fe.y=150,fe.w=200,fe.h=100,fe.color="0xfecacaff",fe.rotation=120,s[17].populate(fe),r=s[15];const E={};s[18]=this.element({parent:r||"root"},i),E.x=100,E.y=300,E.w=200,E.h=100,E.color="0xfca5a5ff",E.rotation=130,s[18].populate(E),r=s[15];const F={};s[19]=this.element({parent:r||"root"},i),F.x=100,F.y=450,F.w=200,F.h=100,F.color="0xf87171ff",F.rotation=140,s[19].populate(F),r=s[15];const re={};s[20]=this.element({parent:r||"root"},i),re.x=100,re.y=610,re.w=200,re.h=100,re.color="0xef4444ff",re.rotation=150,s[20].populate(re),r=s[15];const ye={};s[21]=this.element({parent:r||"root"},i),ye.x=100,ye.y=800,ye.w=200,ye.h=100,ye.color="0xdc2626ff",ye.rotation=160,s[21].populate(ye),r=s[0];const ie={};s[22]=this.element({parent:r||"root"},i),ie.y=70,ie.x=900,s[22].populate(ie),r=s[22];const se={};s[23]=this.element({parent:r||"root"},i),se.x=100,se.y=0,se.w=200,se.h=100,se.color="0xfee2e2ff",se.rotation=170,s[23].populate(se),r=s[22];const ne={};s[24]=this.element({parent:r||"root"},i),ne.x=100,ne.y=150,ne.w=200,ne.h=100,ne.color="0xfecacaff",ne.rotation=180,s[24].populate(ne),r=s[22];const le={};s[25]=this.element({parent:r||"root"},i),le.x=100,le.y=300,le.w=200,le.h=100,le.color="0xfca5a5ff",le.rotation=190,s[25].populate(le),r=s[22];const xe={};s[26]=this.element({parent:r||"root"},i),xe.x=100,xe.y=450,xe.w=200,xe.h=100,xe.color="0xf87171ff",xe.rotation=200,s[26].populate(xe),r=s[22];const we={};s[27]=this.element({parent:r||"root"},i),we.x=100,we.y=610,we.w=200,we.h=100,we.color="0xef4444ff",we.rotation=210,s[27].populate(we),r=s[22];const Te={};s[28]=this.element({parent:r||"root"},i),Te.x=100,Te.y=800,Te.w=200,Te.h=100,Te.color="0xdc2626ff",Te.rotation=220,s[28].populate(Te),r=s[0];const Ie={};s[29]=this.element({parent:r||"root"},i),Ie.y=70,Ie.x=1200,s[29].populate(Ie),r=s[29];const Ee={};s[30]=this.element({parent:r||"root"},i),Ee.x=100,Ee.y=0,Ee.w=200,Ee.h=100,Ee.color="0xfee2e2ff",Ee.rotation=230,s[30].populate(Ee),r=s[29];const _e={};s[31]=this.element({parent:r||"root"},i),_e.x=100,_e.y=150,_e.w=200,_e.h=100,_e.color="0xfecacaff",_e.rotation=240,s[31].populate(_e),r=s[29];const z={};s[32]=this.element({parent:r||"root"},i),z.x=100,z.y=300,z.w=200,z.h=100,z.color="0xfca5a5ff",z.rotation=250,s[32].populate(z),r=s[29];const Re={};s[33]=this.element({parent:r||"root"},i),Re.x=100,Re.y=450,Re.w=200,Re.h=100,Re.color="0xf87171ff",Re.rotation=260,s[33].populate(Re),r=s[29];const Ae={};s[34]=this.element({parent:r||"root"},i),Ae.x=100,Ae.y=610,Ae.w=200,Ae.h=100,Ae.color="0xef4444ff",Ae.rotation=270,s[34].populate(Ae),r=s[29];const oe={};s[35]=this.element({parent:r||"root"},i),oe.x=100,oe.y=800,oe.w=200,oe.h=100,oe.color="0xdc2626ff",oe.rotation=280,s[35].populate(oe),r=s[0];const D={};s[36]=this.element({parent:r||"root"},i),D.y=70,D.x=1500,s[36].populate(D),r=s[36];const me={};s[37]=this.element({parent:r||"root"},i),me.x=100,me.y=0,me.w=200,me.h=100,me.color="0xfee2e2ff",me.rotation=290,s[37].populate(me),r=s[36];const Ce={};s[38]=this.element({parent:r||"root"},i),Ce.x=100,Ce.y=150,Ce.w=200,Ce.h=100,Ce.color="0xfecacaff",Ce.rotation=300,s[38].populate(Ce),r=s[36];const ze={};s[39]=this.element({parent:r||"root"},i),ze.x=100,ze.y=300,ze.w=200,ze.h=100,ze.color="0xfca5a5ff",ze.rotation=310,s[39].populate(ze),r=s[36];const ae={};s[40]=this.element({parent:r||"root"},i),ae.x=100,ae.y=450,ae.w=200,ae.h=100,ae.color="0xf87171ff",ae.rotation=320,s[40].populate(ae),r=s[36];const Be={};s[41]=this.element({parent:r||"root"},i),Be.x=100,Be.y=610,Be.w=200,Be.h=100,Be.color="0xef4444ff",Be.rotation=330,s[41].populate(Be),r=s[36];const Y={};s[42]=this.element({parent:r||"root"},i),Y.x=100,Y.y=800,Y.w=200,Y.h=100,Y.color="0xdc2626ff",Y.rotation=340,s[42].populate(Y),r=s[0];const $={};s[43]=this.element({parent:r||"root"},i),$.x=200,$.y=200,$.w=400,$.h=400,$.color="0x0891b2ff",$.rotation=i.rotation1,s[43].populate($),r=s[0];const be={};s[44]=this.element({parent:r||"root"},i),be.x=800,be.y=200,be.w=400,be.h=400,be.color="0x0891b2ff",be.rotation=i.rotation2,s[44].populate(be),r=s[0];const De={};return s[45]=this.element({parent:r||"root"},i),De.x=1400,De.y=200,De.w=400,De.h=400,De.color="0x0891b2ff",De.rotation={transition:i.rotation3},s[45].populate(De),s},effects:[function(r,i,u,d,y,x){i[44].set("rotation",r.rotation2)},function(r,i,u,d,y,x){i[45].set("rotation",{transition:r.rotation3})}],context:{}},state(){return{rotation1:38,rotation2:0,rotation3:0}},hooks:{ready(){let h=800,r=2e3;this.$setInterval(()=>{const i=this.rotation2+10;this.rotation2=i<=360?i:0},h),this.$setInterval(()=>{this.rotation3=Math.max(10,Math.min(720,this.rotation3*2)),this.rotation3===720&&(this.rotation3=0)},r)}}}),EM=et.Component("KeyInput",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.x=525,g.y=130,s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.w=200,M.h=200,M.color=i.focusColor,M.x=i.focusedX*220,M.y=i.focusedY*210,s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.w=180,A.h=180,A.x=10,A.y=10,A.color=i.blockColor,s[2].populate(A),r=s[0];const k={};s[3]=this.element({parent:r||"root"},i),k.w=180,k.h=180,k.x=230,k.y=10,k.color=i.blockColor,s[3].populate(k),r=s[0];const b={};s[4]=this.element({parent:r||"root"},i),b.w=180,b.h=180,b.x=450,b.y=10,b.color=i.blockColor,s[4].populate(b),r=s[0];const P={};s[5]=this.element({parent:r||"root"},i),P.w=180,P.h=180,P.x=670,P.y=10,P.color=i.blockColor,s[5].populate(P),r=s[0];const w={};s[6]=this.element({parent:r||"root"},i),w.w=180,w.h=180,w.x=10,w.y=220,w.color=i.blockColor,s[6].populate(w),r=s[0];const R={};s[7]=this.element({parent:r||"root"},i),R.w=180,R.h=180,R.x=230,R.y=220,R.color=i.blockColor,s[7].populate(R),r=s[0];const B={};s[8]=this.element({parent:r||"root"},i),B.w=180,B.h=180,B.x=450,B.y=220,B.color=i.blockColor,s[8].populate(B),r=s[0];const U={};s[9]=this.element({parent:r||"root"},i),U.w=180,U.h=180,U.x=670,U.y=220,U.color=i.blockColor,s[9].populate(U),r=s[0];const W={};s[10]=this.element({parent:r||"root"},i),W.w=180,W.h=180,W.x=10,W.y=430,W.color=i.blockColor,s[10].populate(W),r=s[0];const G={};s[11]=this.element({parent:r||"root"},i),G.w=180,G.h=180,G.x=230,G.y=430,G.color=i.blockColor,s[11].populate(G),r=s[0];const Q={};s[12]=this.element({parent:r||"root"},i),Q.w=180,Q.h=180,Q.x=450,Q.y=430,Q.color=i.blockColor,s[12].populate(Q),r=s[0];const ee={};s[13]=this.element({parent:r||"root"},i),ee.w=180,ee.h=180,ee.x=670,ee.y=430,ee.color=i.blockColor,s[13].populate(ee),r=s[0];const Z={};s[14]=this.element({parent:r||"root"},i),Z.w=180,Z.h=180,Z.x=10,Z.y=640,Z.color=i.blockColor,s[14].populate(Z),r=s[0];const H={};s[15]=this.element({parent:r||"root"},i),H.w=180,H.h=180,H.x=230,H.y=640,H.color=i.blockColor,s[15].populate(H),r=s[0];const J={};s[16]=this.element({parent:r||"root"},i),J.w=180,J.h=180,J.x=450,J.y=640,J.color=i.blockColor,s[16].populate(J),r=s[0];const fe={};return s[17]=this.element({parent:r||"root"},i),fe.w=180,fe.h=180,fe.x=670,fe.y=640,fe.color=i.blockColor,s[17].populate(fe),s},effects:[function(r,i,u,d,y,x){i[1].set("color",r.focusColor)},function(r,i,u,d,y,x){i[1].set("x",r.focusedX*220)},function(r,i,u,d,y,x){i[1].set("y",r.focusedY*210)},function(r,i,u,d,y,x){i[2].set("color",r.blockColor)},function(r,i,u,d,y,x){i[3].set("color",r.blockColor)},function(r,i,u,d,y,x){i[4].set("color",r.blockColor)},function(r,i,u,d,y,x){i[5].set("color",r.blockColor)},function(r,i,u,d,y,x){i[6].set("color",r.blockColor)},function(r,i,u,d,y,x){i[7].set("color",r.blockColor)},function(r,i,u,d,y,x){i[8].set("color",r.blockColor)},function(r,i,u,d,y,x){i[9].set("color",r.blockColor)},function(r,i,u,d,y,x){i[10].set("color",r.blockColor)},function(r,i,u,d,y,x){i[11].set("color",r.blockColor)},function(r,i,u,d,y,x){i[12].set("color",r.blockColor)},function(r,i,u,d,y,x){i[13].set("color",r.blockColor)},function(r,i,u,d,y,x){i[14].set("color",r.blockColor)},function(r,i,u,d,y,x){i[15].set("color",r.blockColor)},function(r,i,u,d,y,x){i[16].set("color",r.blockColor)},function(r,i,u,d,y,x){i[17].set("color",r.blockColor)}],context:{}},state(){return{focusedX:0,focusedY:0,colorscheme:"yellow"}},computed:{blockColor(){return this.colorscheme==="yellow"?"#fef08a":"#bae6fd"},focusColor(){return this.colorscheme==="yellow"?"#facc15":"#38bdf8"}},input:{left(){const h=this.focusedX-1;this.focusedX=Math.max(h,0)},right(){const h=this.focusedX+1;this.focusedX=Math.min(h,3)},up(){this.focusedY=Math.max(this.focusedY-1,0)},down(){this.focusedY=Math.min(this.focusedY+1,3)},enter(){this.colorscheme=this.colorscheme==="yellow"?"blue":"yellow"},any(h){const r=parseInt(h.key);isNaN(r)?this.parent.focus(h):(this.focusedX=Math.max(0,(r-1)%4),this.focusedY=Math.max(0,Math.ceil(r/4)-1))}}}),Kd=["#64748b","#ef4444","#f97316","#84cc16","#14b8a6","#3b82f6"],Yd=["Iron Man","Captain America","Thor","Hulk","Black Widow","Hawkeye","Scarlet Witch","Vision","Black Panther","Doctor Strange","Spider-Man","Ant-Man","Wasp","Captain Marvel","Falcon","Winter Soldier","War Machine","Quicksilver","Star-Lord","Gamora"],AM=et.Component("Texts",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.x=100,g.y=100,s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.content="Default text",M["@loaded"]=i.textLoaded&&i.textLoaded.bind(i),M.__textnode=!0,s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.content="123456",A.x=400,A.__textnode=!0,s[2].populate(A),r=s[0];const k={};s[3]=this.element({parent:r||"root"},i),k.content="Text with a different fontsize",k.size=i.size,k.y=120,k.font="raleway",k.__textnode=!0,s[3].populate(k),r=s[0];const b={};s[4]=this.element({parent:r||"root"},i),b.content="Text with a different color",b.size=50,b.color=i.color,b.y=250,b.__textnode=!0,s[4].populate(b),r=s[0];const P={};s[5]=this.element({parent:r||"root"},i),P.content="Letterspacing",P.size=50,P.color="0x38bdf8ff",P.y=450,P.letterspacing=40,P.__textnode=!0,s[5].populate(P),r=s[0];const w={};s[6]=this.element({parent:r||"root"},i),w.w=800,w.h=100,w.y=550,w.color="0x94a3b8ff",s[6].populate(w),r=s[6];const R={};s[7]=this.element({parent:r||"root"},i),R.content="Text align center",R.size=50,R.y=15,R.color="0xbae6fdff",R.align="center",R.wordwrap=800,R.__textnode=!0,s[7].populate(R),r=s[0];const B={};s[8]=this.element({parent:r||"root"},i),B.w=800,B.h=200,B.x=900,B.y=550,B.color="0x94a3b8ff",s[8].populate(B),r=s[8];const U={};s[9]=this.element({parent:r||"root"},i),U.content=i.longText,U.size=40,U.color="0xbae6fdff",U.wordwrap=800,U.maxlines=5,U.textoverflow="!!!",U.__textnode=!0,s[9].populate(U),r=s[0];const W={};s[10]=this.element({parent:r||"root"},i),W.w=800,W.h=120,W.x=900,W.y=800,W.color="0x94a3b8ff",s[10].populate(W),r=s[10];const G={};s[11]=this.element({parent:r||"root"},i),G.content=i.longText,G.size=40,G.color="0xbae6fdff",G.wordwrap=800,G.maxlines=2,G.lineheight=60,G.textoverflow=!1,G.__textnode=!0,s[11].populate(G),r=s[0];const Q={};s[12]=this.element({parent:r||"root"},i),Q.content=i.character,Q.size=50,Q.color=i.color,Q.y=750,Q.font="opensans",Q.__textnode=!0,s[12].populate(Q),r=s[0];const ee={};s[13]=this.element({parent:r||"root"},i),ee.x=1200,ee.y=300,s[13].populate(ee),r=s[13];const Z={};s[14]=this.element({parent:r||"root"},i),Z.rotation={transition:i.rotation},Z.pivot=0,Z.content="Hello",Z.__textnode=!0,s[14].populate(Z),r=s[13];const H={};s[15]=this.element({parent:r||"root"},i),H.x=150,H.rotation={transition:i.rotation},H.pivot=.5,H.content="World",H.__textnode=!0,s[15].populate(H),r=s[13];const J={};return s[16]=this.element({parent:r||"root"},i),J.x=300,J.rotation={transition:i.rotation},J.pivot=1,J.content="!!",J.__textnode=!0,s[16].populate(J),s},effects:[function(r,i,u,d,y,x){i[3].set("size",r.size)},function(r,i,u,d,y,x){i[4].set("color",r.color)},function(r,i,u,d,y,x){i[12].set("content",r.character)},function(r,i,u,d,y,x){i[12].set("color",r.color)},function(r,i,u,d,y,x){i[14].set("rotation",{transition:r.rotation})},function(r,i,u,d,y,x){i[15].set("rotation",{transition:r.rotation})},function(r,i,u,d,y,x){i[16].set("rotation",{transition:r.rotation})}],context:{}},state(){return{color:Kd[0],size:10,character:Yd[0],myText:"This is my test yeah",longText:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at ante non mauris commodo tristique. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Ut quis mattis mi. Aliquam ultricies mi vel lobortis luctus. Ut non feugiat urna. Duis sed blandit dui. Donec venenatis, mauris at blandit malesuada, elit nibh scelerisque lacus, non tempus arcu mi at justo.",rotation:0}},hooks:{ready(){let h=0;this.$setInterval(()=>{h++,h>Kd.length-1&&(h=0),this.color=Kd[h],this.size=10*(h*2+1),this.rotation+=30},1e3);let r=0;this.$setInterval(()=>{r++,r>Yd.length-1&&(r=0),this.character=Yd[r]},1400)}},methods:{textLoaded(h){this.$log.info(`Text loaded with w: ${h.w} and h: ${h.h}`)}}}),gf=["https://images.unsplash.com/photo-1690360994204-3d10cc73a08d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=428&q=80","https://images.unsplash.com/photo-1582971103098-bfc707d2ad92?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=428&q=80"],bM=et.Component("Images",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.src="assets/lightningbolt.png",M.w=428,M.h=234,M.x=100,M.y=100,s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.src="https://images.unsplash.com/photo-1611148799269-63df34f63f6c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=428&q=80",A.w=428,A.h=234,A.x=100,A.y=400,s[2].populate(A),r=s[0];const k={};s[3]=this.element({parent:r||"root"},i),k.src=i.image,k.w=428,k.h=234,k.x=100,k.y=700,k["@loaded"]=i.imageLoaded&&i.imageLoaded.bind(i),s[3].populate(k),r=s[0];const b={};s[4]=this.element({parent:r||"root"},i),b.color="{top: '0xff0000ff', bottom: '0xffd700ff'}",b.src="assets/lightningbolt.png",b.w=428,b.h=234,b.x=600,b.y=100,s[4].populate(b),r=s[0];const P={};s[5]=this.element({parent:r||"root"},i),P.x=600,P.y=400,P.w=428,P.h=234,P.clipping=i.clipping,s[5].populate(P),r=s[5];const w={};s[6]=this.element({parent:r||"root"},i),w.src="assets/lightningbolt.png",w.w=856,w.h=468,s[6].populate(w),r=s[0];const R={};return s[7]=this.element({parent:r||"root"},i),R.color=i.color,R.src="assets/lightningbolt.png",R.w=428,R.h=234,R.x=1100,R.y=100,s[7].populate(R),s},effects:[function(r,i,u,d,y,x){i[3].set("src",r.image)},function(r,i,u,d,y,x){i[5].set("clipping",r.clipping)},function(r,i,u,d,y,x){i[7].set("color",r.color)}],context:{}},state(){return{image:gf[0],clipping:!0,color:"red"}},hooks:{ready(){this.$setInterval(()=>{this.image=this.image===gf[0]?gf[1]:gf[0],this.clipping=!this.clipping,this.color=this.color==="red"?"blue":"red"},2e3)}},methods:{imageLoaded(h){console.log("backstopjs:ready"),this.$log.info(`Image loaded with w: ${h.w} and h: ${h.h}`)}}}),vs=et.Component("Square",{code:{render:function(r,i,u,d,y,x){const s=[],g={};return s[0]=this.element({parent:r||"root"},i),g.w={transition:i.size},g.h={transition:i.size},g.color={transition:i.color},s[0].populate(g),s},effects:[function(r,i,u,d,y,x){i[0].set("w",{transition:r.size})},function(r,i,u,d,y,x){i[0].set("h",{transition:r.size})},function(r,i,u,d,y,x){i[0].set("color",{transition:r.color})}],context:{}},props:[{key:"size",default:80}],state(){return{color:"#86198f"}},watch:{size(h,r){this.$log.info(`Size changed from ${r} to ${h}`),this.color=this.color==="#86198f"?"#9d174d":"#86198f"}}}),V2=et.Component("Card",{components:{Square:vs},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),M.w=i.w,M.h=i.h,M.color="0x0891b2ff",s[0].populate(M);const A=u.components&&u.components.Square||d.Square;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),k.x=80,k.y=80,typeof A<"u")for(let W in A.config.props)delete k[A.config.props[W]];s[1].populate(k),r=s[1];const b={};b.x=80,b.y=80,g=b.is||"Square";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0];const w=u.components&&u.components.Square||d.Square;r=s[0];const R={};if(s[3]=this.element({parent:r||"root"},i),R.x=20,R.y=20,R.size=40,typeof w<"u")for(let W in w.config.props)delete R[w.config.props[W]];s[3].populate(R),r=s[3];const B={};B.x=20,B.y=20,B.size=40,g=B.is||"Square";let U;if(typeof g=="string"){if(U=u.components&&u.components[g]||d[g],!U)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(U=g);return s[4]=U.call(null,{props:B},s[3],i),s[4][Symbol.for("slots")][0]?(r=s[4][Symbol.for("slots")][0],i=s[4]):r=s[4][Symbol.for("children")][0],s},effects:[],context:{}},props:["size"],computed:{w(){return this.size==="large"?400:200},h(){return this.size==="large"?500:300}}}),IM=et.Component("Components",{components:{Square:vs,Card:V2},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M);const A=u.components&&u.components.Square||d.Square;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),k.x=100,k.y=100,k.size=50,typeof A<"u")for(let Ae in A.config.props)delete k[A.config.props[Ae]];s[1].populate(k),r=s[1];const b={};b.x=100,b.y=100,b.size=50,g=b.is||"Square";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0];const w=u.components&&u.components.Square||d.Square;r=s[0];const R={};if(s[3]=this.element({parent:r||"root"},i),R.x=100,R.y=200,R.size=100,typeof w<"u")for(let Ae in w.config.props)delete R[w.config.props[Ae]];s[3].populate(R),r=s[3];const B={};B.x=100,B.y=200,B.size=100,g=B.is||"Square";let U;if(typeof g=="string"){if(U=u.components&&u.components[g]||d[g],!U)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(U=g);s[4]=U.call(null,{props:B},s[3],i),s[4][Symbol.for("slots")][0]?(r=s[4][Symbol.for("slots")][0],i=s[4]):r=s[4][Symbol.for("children")][0];const W=u.components&&u.components.Square||d.Square;r=s[0];const G={};if(s[5]=this.element({parent:r||"root"},i),G.x=100,G.y=350,G.size=200,typeof W<"u")for(let Ae in W.config.props)delete G[W.config.props[Ae]];s[5].populate(G),r=s[5];const Q={};Q.x=100,Q.y=350,Q.size=200,g=Q.is||"Square";let ee;if(typeof g=="string"){if(ee=u.components&&u.components[g]||d[g],!ee)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(ee=g);s[6]=ee.call(null,{props:Q},s[5],i),s[6][Symbol.for("slots")][0]?(r=s[6][Symbol.for("slots")][0],i=s[6]):r=s[6][Symbol.for("children")][0];const Z=u.components&&u.components.Square||d.Square;r=s[0];const H={};if(s[7]=this.element({parent:r||"root"},i),H.x={transition:i.x},H.y=600,H.size=50,typeof Z<"u")for(let Ae in Z.config.props)delete H[Z.config.props[Ae]];s[7].populate(H),r=s[7];const J={};J.x={transition:i.x},J.y=600,J.size=50,g=J.is||"Square";let fe;if(typeof g=="string"){if(fe=u.components&&u.components[g]||d[g],!fe)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(fe=g);s[8]=fe.call(null,{props:J},s[7],i),s[8][Symbol.for("slots")][0]?(r=s[8][Symbol.for("slots")][0],i=s[8]):r=s[8][Symbol.for("children")][0];const E=u.components&&u.components.Card||d.Card;r=s[0];const F={};if(s[9]=this.element({parent:r||"root"},i),F.x=500,F.y=100,typeof E<"u")for(let Ae in E.config.props)delete F[E.config.props[Ae]];s[9].populate(F),r=s[9];const re={};re.x=500,re.y=100,g=re.is||"Card";let ye;if(typeof g=="string"){if(ye=u.components&&u.components[g]||d[g],!ye)throw new Error('Component "Card" not found')}else typeof g=="function"&&g.name==="factory"&&(ye=g);s[10]=ye.call(null,{props:re},s[9],i),s[10][Symbol.for("slots")][0]?(r=s[10][Symbol.for("slots")][0],i=s[10]):r=s[10][Symbol.for("children")][0];const ie=u.components&&u.components.Card||d.Card;r=s[0];const se={};if(s[11]=this.element({parent:r||"root"},i),se.x=500,se.y=500,se.size="large",typeof ie<"u")for(let Ae in ie.config.props)delete se[ie.config.props[Ae]];s[11].populate(se),r=s[11];const ne={};ne.x=500,ne.y=500,ne.size="large",g=ne.is||"Card";let le;if(typeof g=="string"){if(le=u.components&&u.components[g]||d[g],!le)throw new Error('Component "Card" not found')}else typeof g=="function"&&g.name==="factory"&&(le=g);s[12]=le.call(null,{props:ne},s[11],i),s[12][Symbol.for("slots")][0]?(r=s[12][Symbol.for("slots")][0],i=s[12]):r=s[12][Symbol.for("children")][0],r=s[0];const xe={};s[13]=this.element({parent:r||"root"},i),xe.x=1e3,xe.y=100,s[13].populate(xe),r=s[13];const we={};s[14]=this.element({parent:r||"root"},i),we.content="Dynamic components",we.__textnode=!0,s[14].populate(we);const Te=u.components&&u.components.Component||d.Component;r=s[13];const Ie={};if(s[15]=this.element({parent:r||"root"},i),Ie.is=i.dynamicComponent,Ie.y=100,Ie.color="0x0000ffff",typeof Te<"u")for(let Ae in Te.config.props)delete Ie[Te.config.props[Ae]];s[15].populate(Ie),r=s[15];const Ee={};Ee.is=i.dynamicComponent,Ee.y=100,Ee.color="0x0000ffff",g=Ee.is||"Component";let _e;if(typeof g=="string"){if(_e=u.components&&u.components[g]||d[g],!_e)throw new Error('Component "Component" not found')}else typeof g=="function"&&g.name==="factory"&&(_e=g);s[16]=_e.call(null,{props:Ee},s[15],i),s[16][Symbol.for("slots")][0]?(r=s[16][Symbol.for("slots")][0],i=s[16]):r=s[16][Symbol.for("children")][0],r=s[13];const z=[],Re=(Ae=[],oe,D)=>{const me=x(Ae),Ce=new Set(me.map(Be=>""+void 0));let ze=D.length;for(;ze--;){const Be=D[ze];Ce.has(Be)||(oe[17][Be]&&oe[17][Be].destroy(),delete oe[17][Be],oe[18][Be]&&oe[18][Be].destroy(),delete oe[18][Be])}D.length=0;const ae=Ae.length;for(let Be=0;Be<ae;Be++){const Y=Object.create(i);r=oe[13],Y.index=Be,Y.bla=me[Be],Y.key=Be,D.push(Y.key);const $=u.components&&u.components.Component||d.Component;oe[17]===void 0&&(oe[17]={});const be={};if(oe[17][Y.key]||(oe[17][Y.key]=this.element({parent:r||"root"},i)),be.is=Y.bla,be.x=205*Y.index,be.y=300,typeof $<"u")for(let Le in $.config.props)delete be[$.config.props[Le]];oe[17][Y.key].nodeId||oe[17][Y.key].populate(be),oe[18]===void 0&&(oe[18]={}),r=oe[17][Y.key];const De={};if(De.is=Y.bla,De.x=205*Y.index,De.y=300,!oe[18][Y.key]){g=De.is||"Component";let Le;if(typeof g=="string"){if(Le=u.components&&u.components[g]||d[g],!Le)throw new Error('Component "Component" not found')}else typeof g=="function"&&g.name==="factory"&&(Le=g);oe[18][Y.key]=Le.call(null,{props:De},oe[17][Y.key],i),oe[18][Y.key][Symbol.for("slots")][0]?(r=oe[18][Y.key][Symbol.for("slots")][0],i=oe[18][Y.key]):r=oe[18][Y.key][Symbol.for("children")][0]}Y.bla=Ae[Be],y(()=>{oe[17][Y.key].set("x",205*Y.index)},"dynamicComponents"),y(()=>{oe[18][Y.key][Symbol.for("props")].x=205*Y.index},"dynamicComponents"),oe[17][0]&&oe[17][0].forComponent&&oe[17][0].forComponent.___layout&&oe[17][0].forComponent.___layout()}};return y(()=>{Re(i.dynamicComponents,s,z)},"dynamicComponents"),s},effects:[function(r,i,u,d,y,x){i[7].set("x",{transition:r.x})},function(r,i,u,d,y,x){i[8][Symbol.for("props")].x={transition:r.x}}],context:{}},state(){return{x:100,dynamicComponent:Nf,dynamicComponents:["Square","Card","Square",Nf],toggle:!1,size:50}},hooks:{ready(){this.$setInterval(()=>{this.x=this.x===100?250:100,this.size=this.size===50?200:50},2e3)}}}),Fn=["#bbf7d0","#86efac","#4ade80","#22c55e","#16a34a","#15803d"],kM=et.Component("ForLoop",{components:{Square:vs},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.y=20,s[1].populate(A),r=s[1];const k=[],b=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+void 0));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[2][Y]&&D[2][Y].destroy(),delete D[2][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[1],$.index=Y,$.item=Ce[Y],$.key=Y,me.push($.key),r=D[1],D[2]===void 0&&(D[2]={});const be={};D[2][$.key]||(D[2][$.key]=this.element({parent:r||"root"},i)),be.w=80,be.h=80,be.x=$.item,be.color="0x4d7c0fff",D[2][$.key].nodeId||D[2][$.key].populate(be),$.item=oe[Y],D[2][0]&&D[2][0].forComponent&&D[2][0].forComponent.___layout&&D[2][0].forComponent.___layout()}};y(()=>{b(i.collection1,s,k)},"collection1"),r=s[0];const P={};s[3]=this.element({parent:r||"root"},i),P.y=120,s[3].populate(P),r=s[3];const w=[],R=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+Y.id));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[4][Y]&&D[4][Y].destroy(),delete D[4][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[3],$.index=Y,$.item=Ce[Y],$.key=$.item.id,me.push($.key),r=D[3],D[4]===void 0&&(D[4]={});const be={};D[4][$.key]||(D[4][$.key]=this.element({parent:r||"root"},i)),be.w=80,be.h=80,be.x=$.item.x*$.index,be.color=$.item.color,D[4][$.key].nodeId||D[4][$.key].populate(be),$.item=oe[Y],y(()=>{D[4][$.key].set("x",$.item.x*$.index)},"collection2"),D[4][0]&&D[4][0].forComponent&&D[4][0].forComponent.___layout&&D[4][0].forComponent.___layout()}};y(()=>{R(i.collection2,s,w)},"collection2"),r=s[0];const B={};s[5]=this.element({parent:r||"root"},i),B.y=220,s[5].populate(B),r=s[5];const U=[],W=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+void 0));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[6][Y]&&D[6][Y].destroy(),delete D[6][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[5],$.index=Y,$.item=Ce[Y],$.key=Y,me.push($.key),r=D[5],D[6]===void 0&&(D[6]={});const be={};D[6][$.key]||(D[6][$.key]=this.element({parent:r||"root"},i)),be.w=80,be.h=80,be.x=$.item.x,be.color=$.item.color,D[6][$.key].nodeId||D[6][$.key].populate(be),$.item=oe[Y],y(()=>{D[6][$.key].set("x",$.item.x)},null),D[6][0]&&D[6][0].forComponent&&D[6][0].forComponent.___layout&&D[6][0].forComponent.___layout()}};y(()=>{W(i.collection3,s,U)},"collection3"),r=s[0];const G={};s[7]=this.element({parent:r||"root"},i),G.y=320,s[7].populate(G),r=s[7];const Q=[],ee=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+void 0));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[8][Y]&&D[8][Y].destroy(),delete D[8][Y],D[9][Y]&&D[9][Y].destroy(),delete D[9][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[7],$.index=Y,$.item=Ce[Y],$.key=Y,me.push($.key);const be=u.components&&u.components.Square||d.Square;D[8]===void 0&&(D[8]={});const De={};if(D[8][$.key]||(D[8][$.key]=this.element({parent:r||"root"},i)),De.x=$.item.x*$.index,De.ref="square"+$.index,De.alpha=$.alpha,typeof be<"u")for(let it in be.config.props)delete De[be.config.props[it]];D[8][$.key].nodeId||D[8][$.key].populate(De),D[9]===void 0&&(D[9]={}),r=D[8][$.key];const Le={};if(Le.x=$.item.x*$.index,Le.ref="square"+$.index,Le.alpha=$.alpha,!D[9][$.key]){g=Le.is||"Square";let it;if(typeof g=="string"){if(it=u.components&&u.components[g]||d[g],!it)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(it=g);D[9][$.key]=it.call(null,{props:Le},D[8][$.key],i),D[9][$.key][Symbol.for("slots")][0]?(r=D[9][$.key][Symbol.for("slots")][0],i=D[9][$.key]):r=D[9][$.key][Symbol.for("children")][0]}$.item=oe[Y],y(()=>{D[8][$.key].set("x",$.item.x*$.index)},"collection2"),y(()=>{D[8][$.key].set("ref","square"+$.index)},"collection2"),y(()=>{D[9][$.key][Symbol.for("props")].x=$.item.x*$.index},"collection2"),y(()=>{D[9][$.key][Symbol.for("props")].ref="square"+$.index},"collection2"),D[8][0]&&D[8][0].forComponent&&D[8][0].forComponent.___layout&&D[8][0].forComponent.___layout()}};y(()=>{ee(i.collection2,s,Q)},"collection2"),y(()=>{i.alpha;for(let oe=0;oe<i.collection2.length;oe++){const D={};D.index=oe,D.item=i.collection2[oe],D.key=oe,s[8][D.key].set("alpha",i.alpha)}}),y(()=>{i.alpha;for(let oe=0;oe<i.collection2.length;oe++){const D={};D.index=oe,D.item=i.collection2[oe],D.key=oe,s[9][D.key][Symbol.for("props")].alpha=i.alpha}}),r=s[0];const Z={};s[10]=this.element({parent:r||"root"},i),Z.y=420,s[10].populate(Z),r=s[10];const H=[],J=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+Y.color));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[11][Y]&&D[11][Y].destroy(),delete D[11][Y],D[12][Y]&&D[12][Y].destroy(),delete D[12][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[10],$.index=Y,$.item=Ce[Y],$.key=$.item.color,me.push($.key);const be=u.components&&u.components.Square||d.Square;D[11]===void 0&&(D[11]={});const De={};if(D[11][$.key]||(D[11][$.key]=this.element({parent:r||"root"},i)),De.x=$.item.x,De.alpha=$.alpha,typeof be<"u")for(let it in be.config.props)delete De[be.config.props[it]];D[11][$.key].nodeId||D[11][$.key].populate(De),D[12]===void 0&&(D[12]={}),r=D[11][$.key];const Le={};if(Le.x=$.item.x,Le.alpha=$.alpha,!D[12][$.key]){g=Le.is||"Square";let it;if(typeof g=="string"){if(it=u.components&&u.components[g]||d[g],!it)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(it=g);D[12][$.key]=it.call(null,{props:Le},D[11][$.key],i),D[12][$.key][Symbol.for("slots")][0]?(r=D[12][$.key][Symbol.for("slots")][0],i=D[12][$.key]):r=D[12][$.key][Symbol.for("children")][0]}$.item=oe[Y],y(()=>{D[11][$.key].set("x",$.item.x)},null),y(()=>{D[12][$.key][Symbol.for("props")].x=$.item.x},null),D[11][0]&&D[11][0].forComponent&&D[11][0].forComponent.___layout&&D[11][0].forComponent.___layout()}};y(()=>{J(i.collection3,s,H)},"collection3"),y(()=>{i.alpha;for(let oe=0;oe<i.collection3.length;oe++){const D={};D.index=oe,D.item=i.collection3[oe],D.key=D.item.color,s[11][D.key].set("alpha",i.alpha)}}),y(()=>{i.alpha;for(let oe=0;oe<i.collection3.length;oe++){const D={};D.index=oe,D.item=i.collection3[oe],D.key=D.item.color,s[12][D.key][Symbol.for("props")].alpha=i.alpha}}),r=s[0];const fe={};s[13]=this.element({parent:r||"root"},i),fe.y=520,s[13].populate(fe),r=s[13];const E=[],F=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+void 0));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[14][Y]&&D[14][Y].destroy(),delete D[14][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[13],$.index=Y,$.item=Ce[Y],$.key=Y,me.push($.key),r=D[13],D[14]===void 0&&(D[14]={});const be={};D[14][$.key]||(D[14][$.key]=this.element({parent:r||"root"},i)),be.w=80,be.h=80,be.x=$.item,be.color="0xeab308ff",be.alpha=$.alpha,D[14][$.key].nodeId||D[14][$.key].populate(be),$.item=oe[Y],D[14][0]&&D[14][0].forComponent&&D[14][0].forComponent.___layout&&D[14][0].forComponent.___layout()}};y(()=>{F(i.collection1,s,E)},"collection1"),y(()=>{i.item;for(let oe=0;oe<i.collection1.length;oe++){const D={};D.index=oe,D.item=i.collection1[oe],D.key=oe,s[14][D.key].set("x",i.item)}}),y(()=>{i.alpha;for(let oe=0;oe<i.collection1.length;oe++){const D={};D.index=oe,D.item=i.collection1[oe],D.key=oe,s[14][D.key].set("alpha",i.alpha)}}),r=s[0];const re={};s[15]=this.element({parent:r||"root"},i),re.y=620,s[15].populate(re),r=s[15];const ye=[],ie=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+Y.id));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[16][Y]&&D[16][Y].destroy(),delete D[16][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[15],$.index=Y,$.item=Ce[Y],$.key=$.item.id,me.push($.key),r=D[15],D[16]===void 0&&(D[16]={});const be={};D[16][$.key]||(D[16][$.key]=this.element({parent:r||"root"},i)),be.w=80,be.h=80,be.x=$.item.x,be.color=$.item.color,be.alpha=$.alpha,D[16][$.key].nodeId||D[16][$.key].populate(be),$.item=oe[Y],y(()=>{D[16][$.key].set("x",$.item.x)},null),D[16][0]&&D[16][0].forComponent&&D[16][0].forComponent.___layout&&D[16][0].forComponent.___layout()}};y(()=>{ie(i.collection2,s,ye)},"collection2"),y(()=>{i.alpha;for(let oe=0;oe<i.collection2.length;oe++){const D={};D.index=oe,D.item=i.collection2[oe],D.key=D.item.id,s[16][D.key].set("alpha",i.alpha)}}),r=s[0];const se={};s[17]=this.element({parent:r||"root"},i),se.y=720,s[17].populate(se),r=s[17];const ne=[],le=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+Y.id));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[18][Y]&&D[18][Y].destroy(),delete D[18][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[17],$.index=Y,$.item=Ce[Y],$.key=$.item.id,me.push($.key),r=D[17],D[18]===void 0&&(D[18]={});const be={};D[18][$.key]||(D[18][$.key]=this.element({parent:r||"root"},i)),be.w=80,be.h=80,be.x=$.item.x,be.color="0x06b6d4ff",D[18][$.key].nodeId||D[18][$.key].populate(be),$.item=oe[Y],y(()=>{D[18][$.key].set("x",$.item.x)},null),D[18][0]&&D[18][0].forComponent&&D[18][0].forComponent.___layout&&D[18][0].forComponent.___layout()}};y(()=>{le(i.collection4,s,ne)},"collection4"),r=s[0];const xe={};s[19]=this.element({parent:r||"root"},i),xe.y=720,xe.x=700,s[19].populate(xe),r=s[19];const we=[],Te=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+void 0));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[20][Y]&&D[20][Y].destroy(),delete D[20][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[19],$.index=Y,$.item=Ce[Y],$.key=Y,me.push($.key),r=D[19],D[20]===void 0&&(D[20]={});const be={};D[20][$.key]||(D[20][$.key]=this.element({parent:r||"root"},i)),be.w=80,be.h=80,be.x=$.item.x,be.color="0x8b5cf6ff",D[20][$.key].nodeId||D[20][$.key].populate(be),$.item=oe[Y],y(()=>{D[20][$.key].set("x",$.item.x)},null),D[20][0]&&D[20][0].forComponent&&D[20][0].forComponent.___layout&&D[20][0].forComponent.___layout()}};y(()=>{Te(i.collection4,s,we)},"collection4"),r=s[0];const Ie={};s[21]=this.element({parent:r||"root"},i),Ie.y=920,s[21].populate(Ie),r=s[21];const Ee=[],_e=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+Y.id));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[22][Y]&&D[22][Y].destroy(),delete D[22][Y],D[23][Y]&&D[23][Y].destroy(),delete D[23][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[21],$.index=Y,$.item=Ce[Y],$.key=$.item.id,me.push($.key);const be=u.components&&u.components.Square||d.Square;D[22]===void 0&&(D[22]={});const De={};if(D[22][$.key]||(D[22][$.key]=this.element({parent:r||"root"},i)),De.w=80,De.h=80,De.x=$.item.x,typeof be<"u")for(let it in be.config.props)delete De[be.config.props[it]];D[22][$.key].nodeId||D[22][$.key].populate(De),D[23]===void 0&&(D[23]={}),r=D[22][$.key];const Le={};if(Le.w=80,Le.h=80,Le.x=$.item.x,!D[23][$.key]){g=Le.is||"Square";let it;if(typeof g=="string"){if(it=u.components&&u.components[g]||d[g],!it)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(it=g);D[23][$.key]=it.call(null,{props:Le},D[22][$.key],i),D[23][$.key][Symbol.for("slots")][0]?(r=D[23][$.key][Symbol.for("slots")][0],i=D[23][$.key]):r=D[23][$.key][Symbol.for("children")][0]}$.item=oe[Y],y(()=>{D[22][$.key].set("x",$.item.x)},null),y(()=>{D[23][$.key][Symbol.for("props")].x=$.item.x},null),D[22][0]&&D[22][0].forComponent&&D[22][0].forComponent.___layout&&D[22][0].forComponent.___layout()}};y(()=>{_e(i.collection4,s,Ee)},"collection4"),r=s[0];const z={};s[24]=this.element({parent:r||"root"},i),z.y=920,z.x=700,s[24].populate(z),r=s[24];const Re=[],Ae=(oe=[],D,me)=>{const Ce=x(oe),ze=new Set(Ce.map(Y=>""+void 0));let ae=me.length;for(;ae--;){const Y=me[ae];ze.has(Y)||(D[25][Y]&&D[25][Y].destroy(),delete D[25][Y],D[26][Y]&&D[26][Y].destroy(),delete D[26][Y])}me.length=0;const Be=oe.length;for(let Y=0;Y<Be;Y++){const $=Object.create(i);r=D[24],$.index=Y,$.item=Ce[Y],$.key=Y,me.push($.key);const be=u.components&&u.components.Square||d.Square;D[25]===void 0&&(D[25]={});const De={};if(D[25][$.key]||(D[25][$.key]=this.element({parent:r||"root"},i)),De.w=80,De.h=80,De.x=$.item.x,typeof be<"u")for(let it in be.config.props)delete De[be.config.props[it]];D[25][$.key].nodeId||D[25][$.key].populate(De),D[26]===void 0&&(D[26]={}),r=D[25][$.key];const Le={};if(Le.w=80,Le.h=80,Le.x=$.item.x,!D[26][$.key]){g=Le.is||"Square";let it;if(typeof g=="string"){if(it=u.components&&u.components[g]||d[g],!it)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(it=g);D[26][$.key]=it.call(null,{props:Le},D[25][$.key],i),D[26][$.key][Symbol.for("slots")][0]?(r=D[26][$.key][Symbol.for("slots")][0],i=D[26][$.key]):r=D[26][$.key][Symbol.for("children")][0]}$.item=oe[Y],y(()=>{D[25][$.key].set("x",$.item.x)},null),y(()=>{D[26][$.key][Symbol.for("props")].x=$.item.x},null),D[25][0]&&D[25][0].forComponent&&D[25][0].forComponent.___layout&&D[25][0].forComponent.___layout()}};return y(()=>{Ae(i.collection4,s,Re)},"collection4"),s},effects:[],context:{}},state(){return{collection1:[0,100,200,300,400,500],collection2:[{id:"block1",x:0,color:Fn[0]},{id:"block2",x:100,color:Fn[1]},{id:"block3",x:200,color:Fn[2]},{id:"block4",x:300,color:Fn[3]},{id:"block5",x:400,color:Fn[4]},{id:"block6",x:500,color:Fn[5]}],collection3:[],collection4:[{x:0,id:"one"},{x:200,id:"two"},{x:400,id:"three"}],alpha:.5}},hooks:{ready(){this.$setTimeout(()=>{this.collection2[0].color=Fn[5],this.collection2[1].color=Fn[4],this.collection2[2].color=Fn[3],this.collection2[3].color=Fn[2],this.collection2[4].color=Fn[1],this.collection2[5].color=Fn[0]},4e3);let h=0;const r=this.$setInterval(()=>{this.collection3.push({x:h*100,color:Fn[h]}),h++,h===Fn.length&&clearInterval(r)},1e3);this.$setInterval(()=>{this.alpha=this.alpha===.5?1:.5},800),this.$setTimeout(()=>{this.collection4=[{x:100,id:4},{x:500,id:5}]},2e3)}}}),Qx=["pretty","large","big","small","tall","short","long","handsome","plain","quaint","clean","elegant","easy","angry","crazy","helpful","mushy","odd","unsightly","adorable","important","inexpensive","cheap","expensive","fancy"],Zx=["red","yellow","blue","green","pink","brown","purple","brown","white","black","orange"],Jx=["table","chair","house","bbq","desk","car","pony","cookie","sandwich","burger","pizza","mouse","keyboard"],qd=h=>Math.round(Math.random()*1e3)%h;let MM=0;const Na=()=>({id:MM++,text:`${Qx[qd(Qx.length)]} ${Zx[qd(Zx.length)]} ${Jx[qd(Jx.length)]}`}),_M=(h=1)=>{const r=[];for(let i=0;i<h;i++)r.push(Na());return r},RM=et.Component("LegendItem",{code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M);const A=u.components&&u.components.Circle||d.Circle;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),k.color="0xfb923cff",k.size=60,typeof A<"u")for(let B in A.config.props)delete k[A.config.props[B]];s[1].populate(k),r=s[1];const b={};b.color="0xfb923cff",b.size=60,g=b.is||"Circle";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "Circle" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0],r=s[0];const w={};s[3]=this.element({parent:r||"root"},i),w.color="0xe5e5e5ff",w.size=32,w.y=10,w.wordwrap=57,w.align="center",w.content=""+i.id,w.__textnode=!0,s[3].populate(w),r=s[0];const R={};return s[4]=this.element({parent:r||"root"},i),R.color="0xe5e5e5ff",R.x=80,R.y=14,R.size=28,R.content=""+i.text,R.__textnode=!0,s[4].populate(R),s},effects:[],context:{}},props:["id","text"]}),H2=et.Component("Row",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.w=500,g.h=60,g.y=i.index*80,g.color="0xfff7edff",s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.w=10,M.h=60,M.color="0x06b6d4ff",s[1].populate(M),r=s[0];const A={};return s[2]=this.element({parent:r||"root"},i),A.content=i.text,A.x=30,A.y=10,A.font="opensans",A.color=i.activeRow==i.index?"0x06b6d4ff":"0x1e293bff",A.__textnode=!0,s[2].populate(A),s},effects:[function(r,i,u,d,y,x){i[0].set("y",r.index*80)},function(r,i,u,d,y,x){i[2].set("content",r.text)},function(r,i,u,d,y,x){i[2].set("color",r.activeRow==r.index?"0x06b6d4ff":"0x1e293bff")}],context:{}},props:["index","text","activeRow"]}),LM=et.Component("Row",{components:{Row:H2},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M=[],A=(k=[],b,P)=>{const w=x(k),R=new Set(w.map(W=>""+W.id+"key2"));let B=P.length;for(;B--;){const W=P[B];R.has(W)||(b[0][W]&&b[0][W].destroy(),delete b[0][W],b[1][W]&&b[1][W].destroy(),delete b[1][W])}P.length=0;const U=k.length;for(let W=0;W<U;W++){const G=Object.create(i);r=!1,G.index=W,G.item=w[W],G.key=G.item.id+"key2",P.push(G.key);const Q=u.components&&u.components.Row||d.Row;b[0]===void 0&&(b[0]={});const ee={};if(b[0][G.key]||(b[0][G.key]=this.element({parent:r||"root"},i)),ee.i=G.index,ee.text=G.item.text,ee.y=50,typeof Q<"u")for(let H in Q.config.props)delete ee[Q.config.props[H]];b[0][G.key].nodeId||b[0][G.key].populate(ee),b[1]===void 0&&(b[1]={}),r=b[0][G.key];const Z={};if(Z.i=G.index,Z.text=G.item.text,Z.y=50,!b[1][G.key]){g=Z.is||"Row";let H;if(typeof g=="string"){if(H=u.components&&u.components[g]||d[g],!H)throw new Error('Component "Row" not found')}else typeof g=="function"&&g.name==="factory"&&(H=g);b[1][G.key]=H.call(null,{props:Z},b[0][G.key],i),b[1][G.key][Symbol.for("slots")][0]?(r=b[1][G.key][Symbol.for("slots")][0],i=b[1][G.key]):r=b[1][G.key][Symbol.for("children")][0]}G.item=k[W],y(()=>{b[0][G.key].set("i",G.index)},"data"),y(()=>{b[1][G.key][Symbol.for("props")].i=G.index},"data"),b[0][0]&&b[0][0].forComponent&&b[0][0].forComponent.___layout&&b[0][0].forComponent.___layout()}};return y(()=>{A(i.data,s,M)},"data"),s},effects:[],context:{}},props:["data"]}),PM=et.Component("ForLoop",{components:{Square:vs,LegendItem:RM,Row:H2,Rows:LM},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.x=100,A.y=60,A.size=48,A.content="Array operations test",A.__textnode=!0,s[1].populate(A),r=s[0];const k={};s[2]=this.element({parent:r||"root"},i),k.y=170,k.x=140,s[2].populate(k),r=s[2];const b={};s[3]=this.element({parent:r||"root"},i),b.x=-10,b.w=500,b.h=80,b.color="0x64748bff",b.y={transition:i.y},b.alpha={transition:!i.hide},s[3].populate(b);const P=u.components&&u.components.LegendItem||d.LegendItem;r=s[2];const w={};if(s[4]=this.element({parent:r||"root"},i),w.y=0,w.id="a",w.text="Fill array by assignment",typeof P<"u")for(let rt in P.config.props)delete w[P.config.props[rt]];s[4].populate(w),r=s[4];const R={};R.y=0,R.id="a",R.text="Fill array by assignment",g=R.is||"LegendItem";let B;if(typeof g=="string"){if(B=u.components&&u.components[g]||d[g],!B)throw new Error('Component "LegendItem" not found')}else typeof g=="function"&&g.name==="factory"&&(B=g);s[5]=B.call(null,{props:R},s[4],i),s[5][Symbol.for("slots")][0]?(r=s[5][Symbol.for("slots")][0],i=s[5]):r=s[5][Symbol.for("children")][0];const U=u.components&&u.components.LegendItem||d.LegendItem;r=s[2];const W={};if(s[6]=this.element({parent:r||"root"},i),W.y=90,W.id="b",W.text="Push new item to array",typeof U<"u")for(let rt in U.config.props)delete W[U.config.props[rt]];s[6].populate(W),r=s[6];const G={};G.y=90,G.id="b",G.text="Push new item to array",g=G.is||"LegendItem";let Q;if(typeof g=="string"){if(Q=u.components&&u.components[g]||d[g],!Q)throw new Error('Component "LegendItem" not found')}else typeof g=="function"&&g.name==="factory"&&(Q=g);s[7]=Q.call(null,{props:G},s[6],i),s[7][Symbol.for("slots")][0]?(r=s[7][Symbol.for("slots")][0],i=s[7]):r=s[7][Symbol.for("children")][0];const ee=u.components&&u.components.LegendItem||d.LegendItem;r=s[2];const Z={};if(s[8]=this.element({parent:r||"root"},i),Z.y=180,Z.id="c",Z.text="Pop item from array",typeof ee<"u")for(let rt in ee.config.props)delete Z[ee.config.props[rt]];s[8].populate(Z),r=s[8];const H={};H.y=180,H.id="c",H.text="Pop item from array",g=H.is||"LegendItem";let J;if(typeof g=="string"){if(J=u.components&&u.components[g]||d[g],!J)throw new Error('Component "LegendItem" not found')}else typeof g=="function"&&g.name==="factory"&&(J=g);s[9]=J.call(null,{props:H},s[8],i),s[9][Symbol.for("slots")][0]?(r=s[9][Symbol.for("slots")][0],i=s[9]):r=s[9][Symbol.for("children")][0];const fe=u.components&&u.components.LegendItem||d.LegendItem;r=s[2];const E={};if(s[10]=this.element({parent:r||"root"},i),E.y=270,E.id="d",E.text="Shift item from array",typeof fe<"u")for(let rt in fe.config.props)delete E[fe.config.props[rt]];s[10].populate(E),r=s[10];const F={};F.y=270,F.id="d",F.text="Shift item from array",g=F.is||"LegendItem";let re;if(typeof g=="string"){if(re=u.components&&u.components[g]||d[g],!re)throw new Error('Component "LegendItem" not found')}else typeof g=="function"&&g.name==="factory"&&(re=g);s[11]=re.call(null,{props:F},s[10],i),s[11][Symbol.for("slots")][0]?(r=s[11][Symbol.for("slots")][0],i=s[11]):r=s[11][Symbol.for("children")][0];const ye=u.components&&u.components.LegendItem||d.LegendItem;r=s[2];const ie={};if(s[12]=this.element({parent:r||"root"},i),ie.y=360,ie.id="e",ie.text="Splice 2 items from array",typeof ye<"u")for(let rt in ye.config.props)delete ie[ye.config.props[rt]];s[12].populate(ie),r=s[12];const se={};se.y=360,se.id="e",se.text="Splice 2 items from array",g=se.is||"LegendItem";let ne;if(typeof g=="string"){if(ne=u.components&&u.components[g]||d[g],!ne)throw new Error('Component "LegendItem" not found')}else typeof g=="function"&&g.name==="factory"&&(ne=g);s[13]=ne.call(null,{props:se},s[12],i),s[13][Symbol.for("slots")][0]?(r=s[13][Symbol.for("slots")][0],i=s[13]):r=s[13][Symbol.for("children")][0];const le=u.components&&u.components.LegendItem||d.LegendItem;r=s[2];const xe={};if(s[14]=this.element({parent:r||"root"},i),xe.y=450,xe.id="f",xe.text="Unshift 2 items into array",typeof le<"u")for(let rt in le.config.props)delete xe[le.config.props[rt]];s[14].populate(xe),r=s[14];const we={};we.y=450,we.id="f",we.text="Unshift 2 items into array",g=we.is||"LegendItem";let Te;if(typeof g=="string"){if(Te=u.components&&u.components[g]||d[g],!Te)throw new Error('Component "LegendItem" not found')}else typeof g=="function"&&g.name==="factory"&&(Te=g);s[15]=Te.call(null,{props:we},s[14],i),s[15][Symbol.for("slots")][0]?(r=s[15][Symbol.for("slots")][0],i=s[15]):r=s[15][Symbol.for("children")][0];const Ie=u.components&&u.components.LegendItem||d.LegendItem;r=s[2];const Ee={};if(s[16]=this.element({parent:r||"root"},i),Ee.y=540,Ee.id="g",Ee.text="Empty array by assignment",typeof Ie<"u")for(let rt in Ie.config.props)delete Ee[Ie.config.props[rt]];s[16].populate(Ee),r=s[16];const _e={};_e.y=540,_e.id="g",_e.text="Empty array by assignment",g=_e.is||"LegendItem";let z;if(typeof g=="string"){if(z=u.components&&u.components[g]||d[g],!z)throw new Error('Component "LegendItem" not found')}else typeof g=="function"&&g.name==="factory"&&(z=g);s[17]=z.call(null,{props:_e},s[16],i),s[17][Symbol.for("slots")][0]?(r=s[17][Symbol.for("slots")][0],i=s[17]):r=s[17][Symbol.for("children")][0];const Re=u.components&&u.components.LegendItem||d.LegendItem;r=s[2];const Ae={};if(s[18]=this.element({parent:r||"root"},i),Ae.y=630,Ae.id="h",Ae.text="Concat an array with items",typeof Re<"u")for(let rt in Re.config.props)delete Ae[Re.config.props[rt]];s[18].populate(Ae),r=s[18];const oe={};oe.y=630,oe.id="h",oe.text="Concat an array with items",g=oe.is||"LegendItem";let D;if(typeof g=="string"){if(D=u.components&&u.components[g]||d[g],!D)throw new Error('Component "LegendItem" not found')}else typeof g=="function"&&g.name==="factory"&&(D=g);s[19]=D.call(null,{props:oe},s[18],i),s[19][Symbol.for("slots")][0]?(r=s[19][Symbol.for("slots")][0],i=s[19]):r=s[19][Symbol.for("children")][0];const me=u.components&&u.components.LegendItem||d.LegendItem;r=s[2];const Ce={};if(s[20]=this.element({parent:r||"root"},i),Ce.y=720,Ce.id="i",Ce.text="Sort array alphabetically",typeof me<"u")for(let rt in me.config.props)delete Ce[me.config.props[rt]];s[20].populate(Ce),r=s[20];const ze={};ze.y=720,ze.id="i",ze.text="Sort array alphabetically",g=ze.is||"LegendItem";let ae;if(typeof g=="string"){if(ae=u.components&&u.components[g]||d[g],!ae)throw new Error('Component "LegendItem" not found')}else typeof g=="function"&&g.name==="factory"&&(ae=g);s[21]=ae.call(null,{props:ze},s[20],i),s[21][Symbol.for("slots")][0]?(r=s[21][Symbol.for("slots")][0],i=s[21]):r=s[21][Symbol.for("children")][0],r=s[2];const Be={};s[22]=this.element({parent:r||"root"},i),Be.y=840,s[22].populate(Be),r=s[22];const Y={};s[23]=this.element({parent:r||"root"},i),Y.size=26,Y.y=10,Y.content="Array length:",Y.__textnode=!0,s[23].populate(Y),r=s[22];const $={};s[24]=this.element({parent:r||"root"},i),$.content=i.data.length,$.size=40,$.x=180,$.color="0xfb923cff",$.__textnode=!0,s[24].populate($),r=s[0];const be={};s[25]=this.element({parent:r||"root"},i),be.x=740,be.y=100,s[25].populate(be),r=s[25];const De={};s[26]=this.element({parent:r||"root"},i),De.content="For loop on Element",De.__textnode=!0,s[26].populate(De),r=s[25];const Le=[],it=(rt=[],ve,Ot)=>{const Zt=x(rt),Mn=new Set(Zt.map(nt=>""+nt.id+"key"));let Vn=Ot.length;for(;Vn--;){const nt=Ot[Vn];Mn.has(nt)||(ve[27][nt]&&ve[27][nt].destroy(),delete ve[27][nt],ve[28][nt]&&ve[28][nt].destroy(),delete ve[28][nt],ve[29][nt]&&ve[29][nt].destroy(),delete ve[29][nt])}Ot.length=0;const _n=rt.length;for(let nt=0;nt<_n;nt++){const Ue=Object.create(i);r=ve[25],Ue.index=nt,Ue.item=Zt[nt],Ue.key=Ue.item.id+"key",Ot.push(Ue.key),r=ve[25],ve[27]===void 0&&(ve[27]={});const Pt={};ve[27][Ue.key]||(ve[27][Ue.key]=this.element({parent:r||"root"},i)),Pt.w=500,Pt.h=60,Pt.y=Ue.index*80+50,Pt.color="0xfff7edff",ve[27][Ue.key].nodeId||ve[27][Ue.key].populate(Pt),r=ve[27][Ue.key],ve[28]===void 0&&(ve[28]={});const Ve={};ve[28][Ue.key]||(ve[28][Ue.key]=this.element({parent:r||"root"},i)),Ve.w=10,Ve.h=60,Ve.color="0xfb923cff",ve[28][Ue.key].nodeId||ve[28][Ue.key].populate(Ve),r=ve[27][Ue.key],ve[29]===void 0&&(ve[29]={});const $t={};ve[29][Ue.key]||(ve[29][Ue.key]=this.element({parent:r||"root"},i)),$t.content=Ue.item.text,$t.x=30,$t.y=10,$t.font="opensans",$t.color=Ue.activeRowIndex===Ue.index?"0x06b6d4ff":"0x1e293bff",$t.__textnode=!0,ve[29][Ue.key].nodeId||ve[29][Ue.key].populate($t),Ue.item=rt[nt],y(()=>{ve[27][Ue.key].set("y",Ue.index*80+50)},"data"),y(()=>{ve[29][Ue.key].set("content",Ue.item.text)},null),ve[27][0]&&ve[27][0].forComponent&&ve[27][0].forComponent.___layout&&ve[27][0].forComponent.___layout()}};y(()=>{it(i.data,s,Le)},"data"),y(()=>{i.activeRowIndex;for(let rt=0;rt<i.data.length;rt++){const ve={};ve.index=rt,ve.item=i.data[rt],ve.key=ve.item.id+"key",s[29][ve.key].set("color",i.activeRowIndex===ve.index?"0x06b6d4ff":"0x1e293bff")}}),r=s[0];const zn={};s[30]=this.element({parent:r||"root"},i),zn.x=1280,zn.y=100,s[30].populate(zn),r=s[30];const oo={};s[31]=this.element({parent:r||"root"},i),oo.content="For loop on Component",oo.__textnode=!0,s[31].populate(oo),r=s[30];const mi=[],yi=(rt=[],ve,Ot)=>{const Zt=x(rt),Mn=new Set(Zt.map(nt=>""+nt.id+"key2"));let Vn=Ot.length;for(;Vn--;){const nt=Ot[Vn];Mn.has(nt)||(ve[32][nt]&&ve[32][nt].destroy(),delete ve[32][nt],ve[33][nt]&&ve[33][nt].destroy(),delete ve[33][nt])}Ot.length=0;const _n=rt.length;for(let nt=0;nt<_n;nt++){const Ue=Object.create(i);r=ve[30],Ue.index=nt,Ue.item=Zt[nt],Ue.key=Ue.item.id+"key2",Ot.push(Ue.key);const Pt=u.components&&u.components.Row||d.Row;ve[32]===void 0&&(ve[32]={});const Ve={};if(ve[32][Ue.key]||(ve[32][Ue.key]=this.element({parent:r||"root"},i)),Ve.activeRow=(Ue.count>0,Ue.activeRowIndex),Ve.index=Ue.index,Ve.text=Ue.item.text,Ve.y=50,typeof Pt<"u")for(let Et in Pt.config.props)delete Ve[Pt.config.props[Et]];ve[32][Ue.key].nodeId||ve[32][Ue.key].populate(Ve),ve[33]===void 0&&(ve[33]={}),r=ve[32][Ue.key];const $t={};if($t.activeRow=(Ue.count>0,Ue.activeRowIndex),$t.index=Ue.index,$t.text=Ue.item.text,$t.y=50,!ve[33][Ue.key]){g=$t.is||"Row";let Et;if(typeof g=="string"){if(Et=u.components&&u.components[g]||d[g],!Et)throw new Error('Component "Row" not found')}else typeof g=="function"&&g.name==="factory"&&(Et=g);ve[33][Ue.key]=Et.call(null,{props:$t},ve[32][Ue.key],i),ve[33][Ue.key][Symbol.for("slots")][0]?(r=ve[33][Ue.key][Symbol.for("slots")][0],i=ve[33][Ue.key]):r=ve[33][Ue.key][Symbol.for("children")][0]}Ue.item=rt[nt],y(()=>{ve[32][Ue.key].set("index",Ue.index)},"data"),y(()=>{ve[32][Ue.key].set("text",Ue.item.text)},null),y(()=>{ve[33][Ue.key][Symbol.for("props")].index=Ue.index},"data"),y(()=>{ve[33][Ue.key][Symbol.for("props")].text=Ue.item.text},null),ve[32][0]&&ve[32][0].forComponent&&ve[32][0].forComponent.___layout&&ve[32][0].forComponent.___layout()}};return y(()=>{yi(i.data,s,mi)},"data"),y(()=>{i.activeRowIndex,i.count;for(let rt=0;rt<i.data.length;rt++){const ve={};ve.index=rt,ve.item=i.data[rt],ve.key=ve.item.id+"key2",s[32][ve.key].set("activeRow",(i.count>0,i.activeRowIndex))}}),y(()=>{i.activeRowIndex,i.count;for(let rt=0;rt<i.data.length;rt++){const ve={};ve.index=rt,ve.item=i.data[rt],ve.key=ve.item.id+"key2",s[33][ve.key][Symbol.for("props")].activeRow=(i.count>0,i.activeRowIndex)}}),s},effects:[function(r,i,u,d,y,x){i[3].set("y",{transition:r.y})},function(r,i,u,d,y,x){i[3].set("alpha",{transition:!r.hide})},function(r,i,u,d,y,x){i[24].set("content",r.data.length)}],context:{}},state(){return{count:0,data:[],x:0,y:0,timeout:null,hide:!0,sortDirection:1,activeRowIndex:0}},computed:{show(){return this.hide===!0},data2(){return this.data}},watch:{y(){this.hide=!1,this.$clearTimeout(this.timeout),this.timeout=this.$setTimeout(()=>{this.hide=!0},600)}},input:{a(){this.y=-10,this.trigger("y");const h=[];for(let r=0;r<6;r++)h.push(Na());this.data=h},b(){this.y=80,this.trigger("y"),this.data.push(Na())},c(){this.y=170,this.trigger("y"),this.data.pop()},d(){this.y=260,this.trigger("y"),this.data.shift()},e(){this.y=350,this.trigger("y"),this.data.splice(2,4)},f(){this.y=440,this.data.unshift(Na(),Na())},g(){this.y=530,this.trigger("y"),this.data=[]},h(){this.y=620,this.trigger("y"),this.data=this.data.concat(_M(3))},i(){this.y=710,this.trigger("y"),this.data=this.data.sort((h,r)=>{const i=h.text.toLowerCase(),u=r.text.toLowerCase();return this.sortDirection=this.sortDirection===1?0:1,this.sortDirection===1?i<u?-1:i>u?1:0:i>u?-1:i<u?1:0})},up(){this.activeRowIndex>0&&(this.activeRowIndex-=1)},down(){this.activeRowIndex<this.data.length-1&&(this.activeRowIndex+=1)}}}),DM=et.Component("Effects",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.w=160,M.h=160,M.x=40,M.y=40,M.color="0xfb923cff",M.effects=[i.shader("radius",{radius:44})],s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.w=160,A.h=160,A.x=240,A.y=40,A.color="0xd97706ff",A.effects=[i.shader("radius",{radius:25})],s[2].populate(A),r=s[0];const k={};s[3]=this.element({parent:r||"root"},i),k.w=160,k.h=160,k.x=440,k.y=40,k.color="0xb45309ff",k.effects=[i.shader("radius",{radius:80})],s[3].populate(k),r=s[0];const b={};s[4]=this.element({parent:r||"root"},i),b.w=160,b.h=160,b.x=640,b.y=40,b.color="0x78350fff",b.effects=[i.shader("radius",{radius:10})],s[4].populate(b),r=s[0];const P={};s[5]=this.element({parent:r||"root"},i),P.w=160,P.h=160,P.x=40,P.y=240,P.color="0x65a30dff",P.effects=[i.shader("radius",{radius:i.radius})],s[5].populate(P),r=s[0];const w={};s[6]=this.element({parent:r||"root"},i),w.w=300,w.h=300,w.x=40,w.y=440,w.color="0x0c4a6eff",w.effects=[i.shader("radius",{radius:30})],s[6].populate(w),r=s[6];const R={};s[7]=this.element({parent:r||"root"},i),R.w=200,R.h=200,R.x=50,R.y=50,R.color="0x0284c7ff",R.effects=[i.shader("radius",{radius:40})],s[7].populate(R),r=s[7];const B={};s[8]=this.element({parent:r||"root"},i),B.w=100,B.h=100,B.x=50,B.y=50,B.color="0x38bdf8ff",B.effects=[i.shader("radius",{radius:50})],s[8].populate(B),r=s[8];const U={};s[9]=this.element({parent:r||"root"},i),U.w=40,U.h=40,U.x=30,U.y=30,U.color="0xbae6fdff",U.effects=[i.shader("radius",{radius:20})],s[9].populate(U),r=s[0];const W={};s[10]=this.element({parent:r||"root"},i),W.w=160,W.h=160,W.x=840,W.y=40,W.color="0x3b82f6ff",W.effects=[i.shader("radius",{radius:10}),i.shader("border",{width:20,color:"0x60a5faff"})],s[10].populate(W),r=s[0];const G={};return s[11]=this.element({parent:r||"root"},i),G.w=160,G.h=160,G.x=1040,G.y=40,G.color="0x500724ff",G.effects=i.effects,s[11].populate(G),s},effects:[function(r,i,u,d,y,x){i[1].set("effects",[r.shader("radius",{radius:44})])},function(r,i,u,d,y,x){i[2].set("effects",[r.shader("radius",{radius:25})])},function(r,i,u,d,y,x){i[3].set("effects",[r.shader("radius",{radius:80})])},function(r,i,u,d,y,x){i[4].set("effects",[r.shader("radius",{radius:10})])},function(r,i,u,d,y,x){i[5].set("effects",[r.shader("radius",{radius:r.radius})])},function(r,i,u,d,y,x){i[6].set("effects",[r.shader("radius",{radius:30})])},function(r,i,u,d,y,x){i[7].set("effects",[r.shader("radius",{radius:40})])},function(r,i,u,d,y,x){i[8].set("effects",[r.shader("radius",{radius:50})])},function(r,i,u,d,y,x){i[9].set("effects",[r.shader("radius",{radius:20})])},function(r,i,u,d,y,x){i[10].set("effects",[r.shader("radius",{radius:10}),r.shader("border",{width:20,color:"0x60a5faff"})])},function(r,i,u,d,y,x){i[11].set("effects",r.effects)}],context:{}},state(){return{direction:"up",radius:0,effects:[this.shader("borderTop",{width:20,color:"#be123c"}),this.shader("borderBottom",{width:20,color:"#f43f5e"})]}},hooks:{ready(){this.$setInterval(()=>{const r=this.direction==="up"?this.radius+10:this.radius-10;this.radius=Math.max(Math.min(r,80),0),this.radius===80&&(this.direction="down"),this.radius===0&&(this.direction="up")},500);let h=0;this.$setInterval(()=>{h++,h%2?this.effects=[this.shader("borderLeft",{width:20,color:"#be123c"}),this.shader("borderRight",{width:20,color:"#f43f5e"})]:this.effects=[this.shader("borderTop",{width:20,color:"#be123c"}),this.shader("borderBottom",{width:20,color:"#f43f5e"})]},2e3)}}}),NM=et.Component("ShowIf",{components:{Square:vs},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.y=40,s[1].populate(A),r=s[1];const k={};s[2]=this.element({parent:r||"root"},i),k.x=50,k.w=200,k.h=300,k.color="0xbef264ff",k.show=!0,s[2].populate(k),r=s[1];const b={};s[3]=this.element({parent:r||"root"},i),b.x=350,b.w=200,b.h=300,b.color="0xff0000ff",b.show=!1,s[3].populate(b),r=s[1];const P={};s[4]=this.element({parent:r||"root"},i),P.x=650,P.w=200,P.h=300,P.color="0x84cc16ff",P.show=1,s[4].populate(P),r=s[1];const w={};s[5]=this.element({parent:r||"root"},i),w.x=950,w.w=200,w.h=300,w.color="0xff0000ff",w.show=0,s[5].populate(w),r=s[0];const R={};s[6]=this.element({parent:r||"root"},i),R.y=380,s[6].populate(R),r=s[6];const B={};s[7]=this.element({parent:r||"root"},i),B.x=50,B.w=200,B.h=300,B.color="0xfde047ff",B.show=i.showNr,s[7].populate(B),r=s[6];const U={};s[8]=this.element({parent:r||"root"},i),U.x=350,U.w=200,U.h=300,U.color="0x0000ffff",U.show=i.hideNr,s[8].populate(U),r=s[6];const W={};s[9]=this.element({parent:r||"root"},i),W.x=650,W.w=200,W.h=300,W.color="0x84cc16ff",W.show=i.showBool,s[9].populate(W),r=s[6];const G={};s[10]=this.element({parent:r||"root"},i),G.x=950,G.w=200,G.h=300,G.color="0xff0000ff",G.show=i.hideBool,s[10].populate(G),r=s[0];const Q={};s[11]=this.element({parent:r||"root"},i),Q.y=720,s[11].populate(Q),r=s[11];const ee={};s[12]=this.element({parent:r||"root"},i),ee.x=50,ee.w=200,ee.h=300,ee.color="0x5eead4ff",ee.show=i.showHideToggle,s[12].populate(ee),r=s[0];const Z={};s[13]=this.element({parent:r||"root"},i),Z.y=40,Z.x=1e3,s[13].populate(Z);const H=u.components&&u.components.Square||d.Square;r=s[13];const J={};if(s[14]=this.element({parent:r||"root"},i),J.show=!0,typeof H<"u")for(let we in H.config.props)delete J[H.config.props[we]];s[14].populate(J),r=s[14];const fe={};fe.show=!0,g=fe.is||"Square";let E;if(typeof g=="string"){if(E=u.components&&u.components[g]||d[g],!E)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(E=g);s[15]=E.call(null,{props:fe},s[14],i),s[15][Symbol.for("slots")][0]?(r=s[15][Symbol.for("slots")][0],i=s[15]):r=s[15][Symbol.for("children")][0];const F=u.components&&u.components.Square||d.Square;r=s[13];const re={};if(s[16]=this.element({parent:r||"root"},i),re.y=100,re.show=!1,typeof F<"u")for(let we in F.config.props)delete re[F.config.props[we]];s[16].populate(re),r=s[16];const ye={};ye.y=100,ye.show=!1,g=ye.is||"Square";let ie;if(typeof g=="string"){if(ie=u.components&&u.components[g]||d[g],!ie)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(ie=g);s[17]=ie.call(null,{props:ye},s[16],i),s[17][Symbol.for("slots")][0]?(r=s[17][Symbol.for("slots")][0],i=s[17]):r=s[17][Symbol.for("children")][0];const se=u.components&&u.components.Square||d.Square;r=s[13];const ne={};if(s[18]=this.element({parent:r||"root"},i),ne.y=200,ne.show=i.showHideToggle,typeof se<"u")for(let we in se.config.props)delete ne[se.config.props[we]];s[18].populate(ne),r=s[18];const le={};le.y=200,le.show=i.showHideToggle,g=le.is||"Square";let xe;if(typeof g=="string"){if(xe=u.components&&u.components[g]||d[g],!xe)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(xe=g);return s[19]=xe.call(null,{props:le},s[18],i),s[19][Symbol.for("slots")][0]?(r=s[19][Symbol.for("slots")][0],i=s[19]):r=s[19][Symbol.for("children")][0],s},effects:[function(r,i,u,d,y,x){i[12].set("show",r.showHideToggle)},function(r,i,u,d,y,x){i[18].set("show",r.showHideToggle)},function(r,i,u,d,y,x){i[19][Symbol.for("props")].show=r.showHideToggle}],context:{}},state(){return{showNr:1,hideNr:0,showBool:!0,hideBool:!1,showHideToggle:!0}},hooks:{ready(){this.$setInterval(()=>{console.log("backstopjs:ready"),this.showHideToggle=!this.showHideToggle},2e3),this.$setTimeout(()=>{this.showNr=0,this.hideNr=1,this.showBool=!1,this.hideBool=!0},4e3)}}}),OM=et.Component("Events",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.x=400,g.y=360,s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.w=280,M.h=280,M.color="0xe5e7ebff",M.x=i.x,M.y=-5,s[1].populate(M),r=s[0];const A={};s[2]=this.element({parent:r||"root"},i),A.w=250,A.h=250,A.x=10,A.y=10,A.color=i.colors[0],s[2].populate(A),r=s[0];const k={};s[3]=this.element({parent:r||"root"},i),k.w=250,k.h=250,k.x=290,k.y=10,k.color=i.colors[1],s[3].populate(k),r=s[0];const b={};s[4]=this.element({parent:r||"root"},i),b.w=250,b.h=250,b.x=570,b.y=10,b.color=i.colors[2],s[4].populate(b),r=s[0];const P={};return s[5]=this.element({parent:r||"root"},i),P.w=250,P.h=250,P.x=850,P.y=10,P.color=i.colors[3],s[5].populate(P),s},effects:[function(r,i,u,d,y,x){i[1].set("x",r.x)}],context:{}},state(){return{count:0,colors:["#fbbf24","#a3e635","#22d3ee","#f472b6"]}},computed:{x(){return this.count*280-5}},hooks:{unfocus(){this.$emit("changeBackground")}},input:{left(h){const r=this.count-1;r===-1?this.parent.focus(h):this.count=Math.max(r,0)},right(h){const r=this.count+1;r===4?this.parent.focus(h):this.count=Math.min(r,3)},enter(){this.$emit("changeBackground",this.colors[this.count])}}}),UM=et.Component("SlotCard",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.w=300,g.h=500,g.effects=[i.shader("radius",{radius:20}),i.shader("border",{width:6,color:"0xe2e8f0ff"})],g.color="{top: '0x94a3b8ff', bottom: '0x475569ff'}",s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M[Symbol.for("isSlot")]=!0,M.x=20,M.y=20,s[1].populate(M),r=s[0];const A={};return s[2]=this.element({parent:r||"root"},i),A.content=i.label,A.wordwrap=260,A.x=20,A.y=400,A.align="center",A.__textnode=!0,s[2].populate(A),s},effects:[function(r,i,u,d,y,x){i[0].set("effects",[r.shader("radius",{radius:20}),r.shader("border",{width:6,color:"0xe2e8f0ff"})])}],context:{}},props:[{key:"label"}]}),BM=et.Component("NamedSlotCard",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.w=700,g.h=300,g.effects=[i.shader("radius",{radius:20}),i.shader("border",{width:6,color:"0xe2e8f0ff"})],g.color="{top: '0x94a3b8ff', bottom: '0x475569ff'}",s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.x=20,M.y=20,s[1].populate(M),r=s[1];const A={};s[2]=this.element({parent:r||"root"},i),A.content="First slot",A.__textnode=!0,s[2].populate(A),r=s[1];const k={};s[3]=this.element({parent:r||"root"},i),k[Symbol.for("isSlot")]=!0,k.y=40,k.ref="first",s[3].populate(k),r=s[0];const b={};s[4]=this.element({parent:r||"root"},i),b.x=200,b.y=20,s[4].populate(b),r=s[4];const P={};s[5]=this.element({parent:r||"root"},i),P.content="Second slot",P.__textnode=!0,s[5].populate(P),r=s[4];const w={};s[6]=this.element({parent:r||"root"},i),w[Symbol.for("isSlot")]=!0,w.y=40,w.ref="second",s[6].populate(w),r=s[0];const R={};s[7]=this.element({parent:r||"root"},i),R.x=480,R.y=20,s[7].populate(R),r=s[7];const B={};s[8]=this.element({parent:r||"root"},i),B.content="Third slot",B.__textnode=!0,s[8].populate(B),r=s[7];const U={};return s[9]=this.element({parent:r||"root"},i),U[Symbol.for("isSlot")]=!0,U.y=40,U.ref="third",s[9].populate(U),s},effects:[function(r,i,u,d,y,x){i[0].set("effects",[r.shader("radius",{radius:20}),r.shader("border",{width:6,color:"0xe2e8f0ff"})])}],context:{}}}),Ma=["#fff7ed","#fdba74","#f97316","#ea580c","#9a3412","#431407"],jM=et.Component("Components",{components:{SlotCard:UM,NamedSlotCard:BM,Card:V2,Square:vs},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M);const A=u.components&&u.components.SlotCard||d.SlotCard;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),k.x=400,k.y=100,k.label="Element",typeof A<"u")for(let De in A.config.props)delete k[A.config.props[De]];s[1].populate(k),r=s[1];const b={};b.x=400,b.y=100,b.label="Element",g=b.is||"SlotCard";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "SlotCard" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0];const w={};s[3]=this.element({parent:r||"root"},i),s[3].populate(w),r=s[3];const R={};s[4]=this.element({parent:r||"root"},i),R.color=i.color,R.w=100,R.h=100,s[4].populate(R);const B=u.components&&u.components.SlotCard||d.SlotCard;r=s[0];const U={};if(s[5]=this.element({parent:r||"root"},i),U.x=800,U.y=100,U.label="Component",typeof B<"u")for(let De in B.config.props)delete U[B.config.props[De]];s[5].populate(U),r=s[5];const W={};W.x=800,W.y=100,W.label="Component",g=W.is||"SlotCard";let G;if(typeof g=="string"){if(G=u.components&&u.components[g]||d[g],!G)throw new Error('Component "SlotCard" not found')}else typeof g=="function"&&g.name==="factory"&&(G=g);s[6]=G.call(null,{props:W},s[5],i),s[6][Symbol.for("slots")][0]?(r=s[6][Symbol.for("slots")][0],i=s[6]):r=s[6][Symbol.for("children")][0];const Q={};s[7]=this.element({parent:r||"root"},i),s[7].populate(Q);const ee=u.components&&u.components.Square||d.Square;r=s[7];const Z={};if(s[8]=this.element({parent:r||"root"},i),Z.size=200,Z.y=50,typeof ee<"u")for(let De in ee.config.props)delete Z[ee.config.props[De]];s[8].populate(Z),r=s[8];const H={};H.size=200,H.y=50,g=H.is||"Square";let J;if(typeof g=="string"){if(J=u.components&&u.components[g]||d[g],!J)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(J=g);s[9]=J.call(null,{props:H},s[8],i),s[9][Symbol.for("slots")][0]?(r=s[9][Symbol.for("slots")][0],i=s[9]):r=s[9][Symbol.for("children")][0];const fe=u.components&&u.components.SlotCard||d.SlotCard;r=s[0];const E={};if(s[10]=this.element({parent:r||"root"},i),E.x=1200,E.y=100,E.label="Element & Component",typeof fe<"u")for(let De in fe.config.props)delete E[fe.config.props[De]];s[10].populate(E),r=s[10];const F={};F.x=1200,F.y=100,F.label="Element & Component",g=F.is||"SlotCard";let re;if(typeof g=="string"){if(re=u.components&&u.components[g]||d[g],!re)throw new Error('Component "SlotCard" not found')}else typeof g=="function"&&g.name==="factory"&&(re=g);s[11]=re.call(null,{props:F},s[10],i),s[11][Symbol.for("slots")][0]?(r=s[11][Symbol.for("slots")][0],i=s[11]):r=s[11][Symbol.for("children")][0];const ye={};s[12]=this.element({parent:r||"root"},i),s[12].populate(ye),r=s[12];const ie={};s[13]=this.element({parent:r||"root"},i),ie.color=i.color,ie.w=100,ie.h=100,s[13].populate(ie);const se=u.components&&u.components.Square||d.Square;r=s[12];const ne={};if(s[14]=this.element({parent:r||"root"},i),ne.size=200,ne.y=150,typeof se<"u")for(let De in se.config.props)delete ne[se.config.props[De]];s[14].populate(ne),r=s[14];const le={};le.size=200,le.y=150,g=le.is||"Square";let xe;if(typeof g=="string"){if(xe=u.components&&u.components[g]||d[g],!xe)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&(xe=g);s[15]=xe.call(null,{props:le},s[14],i),s[15][Symbol.for("slots")][0]?(r=s[15][Symbol.for("slots")][0],i=s[15]):r=s[15][Symbol.for("children")][0];const we=u.components&&u.components.Card||d.Card;r=s[0];const Te={};if(s[16]=this.element({parent:r||"root"},i),Te.x=400,Te.y=700,Te.size="small",typeof we<"u")for(let De in we.config.props)delete Te[we.config.props[De]];s[16].populate(Te),r=s[16];const Ie={};Ie.x=400,Ie.y=700,Ie.size="small",g=Ie.is||"Card";let Ee;if(typeof g=="string"){if(Ee=u.components&&u.components[g]||d[g],!Ee)throw new Error('Component "Card" not found')}else typeof g=="function"&&g.name==="factory"&&(Ee=g);s[17]=Ee.call(null,{props:Ie},s[16],i),s[17][Symbol.for("slots")][0]?(r=s[17][Symbol.for("slots")][0],i=s[17]):r=s[17][Symbol.for("children")][0];const _e={};s[18]=this.element({parent:r||"root"},i),s[18].populate(_e),r=s[18];const z={};s[19]=this.element({parent:r||"root"},i),z.color=i.color,z.w=100,z.h=100,s[19].populate(z);const Re=u.components&&u.components.NamedSlotCard||d.NamedSlotCard;r=s[0];const Ae={};if(s[20]=this.element({parent:r||"root"},i),Ae.x=800,Ae.y=700,typeof Re<"u")for(let De in Re.config.props)delete Ae[Re.config.props[De]];s[20].populate(Ae),r=s[20];const oe={};oe.x=800,oe.y=700,g=oe.is||"NamedSlotCard";let D;if(typeof g=="string"){if(D=u.components&&u.components[g]||d[g],!D)throw new Error('Component "NamedSlotCard" not found')}else typeof g=="function"&&g.name==="factory"&&(D=g);s[21]=D.call(null,{props:oe},s[20],i),s[21][Symbol.for("slots")][0]?(r=s[21][Symbol.for("slots")][0],i=s[21]):r=s[21][Symbol.for("children")][0];const me={};s[22]=this.element({parent:r||"root"},i),s[22].populate(me),r=s[22];const Ce={};s[23]=this.element({parent:r||"root"},i),Ce.color="0x0891b2ff",Ce.x=10,Ce.y=140,Ce.w=80,Ce.h=60,Ce.parent=i[Symbol.for("slots")].filter(De=>De.ref==="second").shift()||i[Symbol.for("slots")][0]||r,Ce.slot="second",s[23].populate(Ce),r=s[22];const ze={};s[24]=this.element({parent:r||"root"},i),ze.color=i.color,ze.w=100,ze.h=100,ze.parent=i[Symbol.for("slots")].filter(De=>De.ref==="third").shift()||i[Symbol.for("slots")][0]||r,ze.slot="third",s[24].populate(ze);const ae=u.components&&u.components.Square||d.Square;r=s[22];const Be={};if(s[25]=this.element({parent:r||"root"},i),Be.size=100,Be.parent=i[Symbol.for("slots")].filter(De=>De.ref==="first").shift()||i[Symbol.for("slots")][0]||r,Be.slot="first",typeof ae<"u")for(let De in ae.config.props)delete Be[ae.config.props[De]];s[25].populate(Be),r=s[25];const Y={};Y.size=100,Y.slot="first",g=Y.is||"Square";let $;if(typeof g=="string"){if($=u.components&&u.components[g]||d[g],!$)throw new Error('Component "Square" not found')}else typeof g=="function"&&g.name==="factory"&&($=g);s[26]=$.call(null,{props:Y},s[25],i),s[26][Symbol.for("slots")][0]?(r=s[26][Symbol.for("slots")][0],i=s[26]):r=s[26][Symbol.for("children")][0],r=s[22];const be={};return s[27]=this.element({parent:r||"root"},i),be.color="0x4d7c0fff",be.x=40,be.y=40,be.w=40,be.h=60,be.parent=i[Symbol.for("slots")].filter(De=>De.ref==="second").shift()||i[Symbol.for("slots")][0]||r,be.slot="second",s[27].populate(be),s},effects:[function(r,i,u,d,y,x){i[4].set("color",r.color)},function(r,i,u,d,y,x){i[13].set("color",r.color)},function(r,i,u,d,y,x){i[19].set("color",r.color)},function(r,i,u,d,y,x){i[24].set("color",r.color)}],context:{}},state(){return{color:Ma[0]}},hooks:{ready(){this.$setInterval(()=>{const h=Ma.indexOf(this.color)+1;this.color=h<=Ma.length?Ma[h]:Ma[0]},600)}}}),FM=et.Component("MemoryCard",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),g.w=320,g.h=200,g.x=i.col*360,g.y=i.row*250,g.scale={transition:i.scale},g.rotation={transition:i.disabled?-2:0},s[0].populate(g),r=s[0];const M={};s[1]=this.element({parent:r||"root"},i),M.h={transition:i.h},M.w=320,M.y=125,M.mount="{y: 0.5}",M.color={transition:i.disabled?"#ccc":"#fff"},M.src=i.image+"&w=320&h=200",M.effects=[i.shader("radius",{radius:6})],M.show=i.open,s[1].populate(M),r=s[0];const A={};return s[2]=this.element({parent:r||"root"},i),A.h={transition:i.h},A.w=320,A.y=125,A.mount="{y: 0.5}",A.color=i.open?"0x00000000":{top:"0xefefefff",bottom:"0xaaaaaaff"},A.effects=[i.shader("radius",{radius:6})],s[2].populate(A),s},effects:[function(r,i,u,d,y,x){i[0].set("scale",{transition:r.scale})},function(r,i,u,d,y,x){i[0].set("rotation",{transition:r.disabled?-2:0})},function(r,i,u,d,y,x){i[1].set("h",{transition:r.h})},function(r,i,u,d,y,x){i[1].set("color",{transition:r.disabled?"#ccc":"#fff"})},function(r,i,u,d,y,x){i[1].set("src",r.image+"&w=320&h=200")},function(r,i,u,d,y,x){i[1].set("effects",[r.shader("radius",{radius:6})])},function(r,i,u,d,y,x){i[1].set("show",r.open)},function(r,i,u,d,y,x){i[2].set("h",{transition:r.h})},function(r,i,u,d,y,x){i[2].set("color",r.open?"0x00000000":{top:"0xefefefff",bottom:"0xaaaaaaff"})},function(r,i,u,d,y,x){i[2].set("effects",[r.shader("radius",{radius:6})])}],context:{}},props:["row","col","image","description","index"],state(){return{disabled:!1,open:!1,h:200,scale:1}},hooks:{init(){this.$listen("closeMemoryCard",h=>{h===this.index&&this.$setTimeout(()=>this.flip(),1e3)}),this.$listen("deactivateMemoryCard",h=>{h===this.index&&(this.$setTimeout(()=>{this.scale=1.16},500),this.$setTimeout(()=>{this.disabled=!0,this.scale=1},800))})},focus(h){this.scale=1.08;const r="Card "+(this.index+1)+(this.disabled?" (disabled)":"");this.$announcer.speak(r)},unfocus(){this.scale=1}},input:{enter(){if(!this.disabled){if(this.open){this.$announcer.speak("Card already open. Choose another");return}this.flip(),this.$announcer.speak(`Image of a ${this.description}`),this.$emit("selectMemoryCard",this.index)}}},methods:{flip(){this.h=0,this.$setTimeout(()=>{this.open=!this.open,this.h=200},250)}}}),e2=[{image:"https://images.pexels.com/photos/106399/pexels-photo-106399.jpeg?auto=compress&cs=tinysrgb",description:"House"},{image:"https://images.pexels.com/photos/2902440/pexels-photo-2902440.jpeg?auto=compress&cs=tinysrgb",description:"Tree"},{image:"https://images.pexels.com/photos/686094/pexels-photo-686094.jpeg?auto=compress&cs=tinysrgb",description:"Dog"},{image:"https://images.pexels.com/photos/1302290/pexels-photo-1302290.jpeg?auto=compress&cs=tinysrgb",description:"Cat"},{image:"https://images.pexels.com/photos/627678/pexels-photo-627678.jpeg?auto=compress&cs=tinysrgb",description:"Car"},{image:"https://images.pexels.com/photos/1616566/pexels-photo-1616566.jpeg?auto=compress&cs=tinysrgb",description:"Bicycle"}],zM=et.Component("Announcer",{components:{MemoryCard:FM},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.font="raleway",A.size=80,A.color="0xffffffff",A.content="Let's play memory!",A.x=580,A.y=60,A.__textnode=!0,s[1].populate(A),r=s[0];const k={};s[2]=this.element({parent:r||"root"},i),k.font="kalam",k.size=40,k.color="0xb91c1cff",k.content="the Accessible edition :)",k.x=1200,k.y=170,k.rotation=-6,k.__textnode=!0,s[2].populate(k),r=s[0];const b={};s[3]=this.element({parent:r||"root"},i),b.x=260,b.y=260,s[3].populate(b),r=s[3];const P=[],w=(R=[],B,U)=>{const W=x(R),G=new Set(W.map(Z=>""+Z.id));let Q=U.length;for(;Q--;){const Z=U[Q];G.has(Z)||(B[4][Z]&&B[4][Z].destroy(),delete B[4][Z],B[5][Z]&&B[5][Z].destroy(),delete B[5][Z])}U.length=0;const ee=R.length;for(let Z=0;Z<ee;Z++){const H=Object.create(i);r=B[3],H.index=Z,H.card=W[Z],H.key=H.card.id,U.push(H.key);const J=u.components&&u.components.MemoryCard||d.MemoryCard;B[4]===void 0&&(B[4]={});const fe={};if(B[4][H.key]||(B[4][H.key]=this.element({parent:r||"root"},i)),fe.col=H.index%4,fe.row=Math.floor(H.index/4)%3,fe.image=H.card.image,fe.description=H.card.description,fe.ref="card"+H.index,fe.index=H.index,typeof J<"u")for(let F in J.config.props)delete fe[J.config.props[F]];B[4][H.key].nodeId||B[4][H.key].populate(fe),B[5]===void 0&&(B[5]={}),r=B[4][H.key];const E={};if(E.col=H.index%4,E.row=Math.floor(H.index/4)%3,E.image=H.card.image,E.description=H.card.description,E.ref="card"+H.index,E.index=H.index,!B[5][H.key]){g=E.is||"MemoryCard";let F;if(typeof g=="string"){if(F=u.components&&u.components[g]||d[g],!F)throw new Error('Component "MemoryCard" not found')}else typeof g=="function"&&g.name==="factory"&&(F=g);B[5][H.key]=F.call(null,{props:E},B[4][H.key],i),B[5][H.key][Symbol.for("slots")][0]?(r=B[5][H.key][Symbol.for("slots")][0],i=B[5][H.key]):r=B[5][H.key][Symbol.for("children")][0]}H.card=R[Z],y(()=>{B[4][H.key].set("col",H.index%4)},"cards"),y(()=>{B[4][H.key].set("row",Math.floor(H.index/4)%3)},"cards"),y(()=>{B[4][H.key].set("ref","card"+H.index)},"cards"),y(()=>{B[4][H.key].set("index",H.index)},"cards"),y(()=>{B[5][H.key][Symbol.for("props")].col=H.index%4},"cards"),y(()=>{B[5][H.key][Symbol.for("props")].row=Math.floor(H.index/4)%3},"cards"),y(()=>{B[5][H.key][Symbol.for("props")].ref="card"+H.index},"cards"),y(()=>{B[5][H.key][Symbol.for("props")].index=H.index},"cards"),B[4][0]&&B[4][0].forComponent&&B[4][0].forComponent.___layout&&B[4][0].forComponent.___layout()}};return y(()=>{w(i.cards,s,P)},"cards"),s},effects:[],context:{}},state(){return{cards:e2.concat(e2).map((h,r)=>({...h,id:`card${r}`})),focusedRow:-1,focusedCol:-1,openCards:[],pairs:0}},hooks:{init(){this.shuffle(),this.$listen("selectMemoryCard",h=>{this.openCards.length<2&&this.openCards.push(h),this.openCards.length===2&&(this.cards[this.openCards[0]].description===this.cards[this.openCards[1]].description?(this.$emit("deactivateMemoryCard",this.openCards[0]),this.$emit("deactivateMemoryCard",this.openCards[1]),this.pairs++,this.$setTimeout(()=>{this.$announcer.speak(this.pairs===this.cards.length/2?"Congratulations, you found all pairs!":`You found a pair! ${this.cards.length/2-this.pairs} more to go.`)},1500)):(this.$emit("closeMemoryCard",this.openCards[0]),this.$emit("closeMemoryCard",this.openCards[1]),this.$setTimeout(()=>{this.$announcer.speak("No match. Try again")},1500)),this.openCards.length=0)})},destroy(){this.$announcer.speak("Thanks for playing Memory")}},watch:{focusedCol(h){if(this.focusedRow===-1){this.focusedRow=0;return}h=h+this.focusedRow*4,this.select("card"+h).focus()},focusedRow(h){if(this.focusedCol===-1){this.focusedCol=0;return}h=this.focusedCol+h*4,this.select("card"+h).focus()}},methods:{shuffle(){this.cards.sort(()=>.5-Math.random())}},input:{left(){this.focusedCol===0?this.focusedRow===0?this.$announcer.speak("You are already at the first card"):(this.focusedCol=3,this.focusedRow--):this.focusedCol=Math.max(0,this.focusedCol-1)},right(){this.focusedCol===3?this.focusedRow===2?this.$announcer.speak("You are already at the last card"):(this.focusedCol=0,this.focusedRow++):this.focusedCol=Math.min(3,this.focusedCol+1)},up(){this.focusedCol===0&&this.$announcer.speak("You are already at the first card"),this.focusedRow=Math.max(0,this.focusedRow-1)},down(){this.focusedRow===2&&this.$announcer.speak("You are already at the last card"),this.focusedRow=Math.min(2,this.focusedRow+1)}}}),_a=(h,r)=>Math.floor(Math.random()*(r-h+1)+h),VM=et.Component("Item",{code:{render:function(r,i,u,d,y,x){const s=[],g={};return s[0]=this.element({parent:r||"root"},i),g.src="assets/blits-b-small.png",g.w=96,g.h=168,g.x={transition:{value:i.x,duration:2900}},g.y={transition:{value:i.y,duration:2900}},g.rotation={transition:{value:i.rotation,duration:2900}},g.scale={transition:{value:i.scale,duration:1e3}},s[0].populate(g),s},effects:[function(r,i,u,d,y,x){i[0].set("x",{transition:{value:r.x,duration:2900}})},function(r,i,u,d,y,x){i[0].set("y",{transition:{value:r.y,duration:2900}})},function(r,i,u,d,y,x){i[0].set("rotation",{transition:{value:r.rotation,duration:2900}})},function(r,i,u,d,y,x){i[0].set("scale",{transition:{value:r.scale,duration:1e3}})}],context:{}},state(){return{x:_a(20,1560),y:_a(20,720),rotation:0,scale:.1}},hooks:{ready(){this.scale=1,this.$setInterval(()=>{this.scale=1,this.x=_a(20,1740),this.y=_a(20,900),this.rotation=_a(10,360)},3e3)}}}),HM=et.Component("Exponential",{components:{Item:VM},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A=[],k=(b=[],P,w)=>{const R=x(b),B=new Set(R.map(G=>""+G));let U=w.length;for(;U--;){const G=w[U];B.has(G)||(P[1][G]&&P[1][G].destroy(),delete P[1][G],P[2][G]&&P[2][G].destroy(),delete P[2][G])}w.length=0;const W=b.length;for(let G=0;G<W;G++){const Q=Object.create(i);r=P[0],Q.index=G,Q.item=R[G],Q.key=Q.item,w.push(Q.key);const ee=u.components&&u.components.Item||d.Item;P[1]===void 0&&(P[1]={});const Z={};if(P[1][Q.key]||(P[1][Q.key]=this.element({parent:r||"root"},i)),typeof ee<"u")for(let J in ee.config.props)delete Z[ee.config.props[J]];P[1][Q.key].nodeId||P[1][Q.key].populate(Z),P[2]===void 0&&(P[2]={}),r=P[1][Q.key];const H={};if(!P[2][Q.key]){g=H.is||"Item";let J;if(typeof g=="string"){if(J=u.components&&u.components[g]||d[g],!J)throw new Error('Component "Item" not found')}else typeof g=="function"&&g.name==="factory"&&(J=g);P[2][Q.key]=J.call(null,{props:H},P[1][Q.key],i),P[2][Q.key][Symbol.for("slots")][0]?(r=P[2][Q.key][Symbol.for("slots")][0],i=P[2][Q.key]):r=P[2][Q.key][Symbol.for("children")][0]}Q.item=b[G],P[1][0]&&P[1][0].forComponent&&P[1][0].forComponent.___layout&&P[1][0].forComponent.___layout()}};return y(()=>{k(i.items,s,A)},"items"),s},effects:[],context:{}},state(){return{items:[]}},hooks:{ready(){const h=this.$setInterval(()=>{for(let r=0;r<=Math.floor(this.items.length/10);r++)this.items.push(`item${this.items.length}`);this.$log.info("# items",this.items.length),this.items.length>100&&clearInterval(h)},2e3)}}}),$M=et.Component("Ball",{code:{render:function(r,i,u,d,y,x){const s=[],g={};return s[0]=this.element({parent:r||"root"},i),g.w=100,g.h=100,g.src="/assets/basketball.png",s[0].populate(g),s},effects:[],context:{}},hooks:{attach(){this.$emit("ballUpdate","Attached to render tree")},detach(){this.$emit("ballUpdate","Detached from render tree")},enter(){this.$emit("ballUpdate","Entered viewport")},exit(){this.$emit("ballUpdate","Exited viewport")}}}),mf=(h,r)=>Math.floor(Math.random()*(r-h+1)+h),GM=et.Component("Viewport",{components:{Ball:$M},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M),r=s[0];const A={};s[1]=this.element({parent:r||"root"},i),A.size=32,A.x=960,A.y=540,A.mount=.5,A.content=i.status.join(`
`),A.lineheight=52,A.wordwrap=500,A.__textnode=!0,s[1].populate(A);const k=u.components&&u.components.Ball||d.Ball;r=s[0];const b={};if(s[2]=this.element({parent:r||"root"},i),b.x={transition:{value:i.x,duration:1250}},b.y={transition:{value:i.y,duration:1250}},b.rotation={transition:{value:i.rotation,duration:1400,easing:"ease-in-out"}},b.w=100,b.h=100,typeof k<"u")for(let R in k.config.props)delete b[k.config.props[R]];s[2].populate(b),r=s[2];const P={};P.x={transition:{value:i.x,duration:1250}},P.y={transition:{value:i.y,duration:1250}},P.rotation={transition:{value:i.rotation,duration:1400,easing:"ease-in-out"}},P.w=100,P.h=100,g=P.is||"Ball";let w;if(typeof g=="string"){if(w=u.components&&u.components[g]||d[g],!w)throw new Error('Component "Ball" not found')}else typeof g=="function"&&g.name==="factory"&&(w=g);return s[3]=w.call(null,{props:P},s[2],i),s[3][Symbol.for("slots")][0]?(r=s[3][Symbol.for("slots")][0],i=s[3]):r=s[3][Symbol.for("children")][0],s},effects:[function(r,i,u,d,y,x){i[1].set("content",r.status.join(`
`))},function(r,i,u,d,y,x){i[2].set("x",{transition:{value:r.x,duration:1250}})},function(r,i,u,d,y,x){i[2].set("y",{transition:{value:r.y,duration:1250}})},function(r,i,u,d,y,x){i[2].set("rotation",{transition:{value:r.rotation,duration:1400,easing:"ease-in-out"}})},function(r,i,u,d,y,x){i[3][Symbol.for("props")].x={transition:{value:r.x,duration:1250}}},function(r,i,u,d,y,x){i[3][Symbol.for("props")].y={transition:{value:r.y,duration:1250}}},function(r,i,u,d,y,x){i[3][Symbol.for("props")].rotation={transition:{value:r.rotation,duration:1400,easing:"ease-in-out"}}}],context:{}},state(){return{x:-400,y:-400,rotation:0,status:[],count:1}},hooks:{ready(){this.$listen("ballUpdate",h=>{this.status.unshift(`${this.count++} -  ${h}`),this.status.length=Math.min(this.status.length,8)}),this.rotation=mf(-90,90),this.x=(1920-100)/2,this.y=(1080-100)/2,this.$setInterval(()=>{this.x=mf(-300,2220),this.y=mf(-300,1380),this.rotation=mf(-90,90)},2500)}}}),WM=et.Component("Flags",{code:{render:function(r,i,u,d,y,x){const s=[],g={};s[0]=this.element({parent:r||"root"},i),s[0].populate(g),r=s[0];const M=[],A=(k=[],b,P)=>{const w=x(k),R=new Set(w.map(W=>""+void 0));let B=P.length;for(;B--;){const W=P[B];R.has(W)||(b[1][W]&&b[1][W].destroy(),delete b[1][W],b[2][W]&&b[2][W].destroy(),delete b[2][W],b[3][W]&&b[3][W].destroy(),delete b[3][W])}P.length=0;const U=k.length;for(let W=0;W<U;W++){const G=Object.create(i);r=b[0],G.index=W,G.language=w[W],G.key=W,P.push(G.key),r=b[0],b[1]===void 0&&(b[1]={});const Q={};b[1][G.key]||(b[1][G.key]=this.element({parent:r||"root"},i)),Q.x=G.index*250,b[1][G.key].nodeId||b[1][G.key].populate(Q),r=b[1][G.key],b[2]===void 0&&(b[2]={});const ee={};b[2][G.key]||(b[2][G.key]=this.element({parent:r||"root"},i)),ee.src=G.language.flag,ee.w=150,ee.h=150,ee.alpha=G.index===G.activeIndex?1:.6,b[2][G.key].nodeId||b[2][G.key].populate(ee),r=b[1][G.key],b[3]===void 0&&(b[3]={});const Z={};b[3][G.key]||(b[3][G.key]=this.element({parent:r||"root"},i)),Z.content=G.language.name,Z.y=150,Z.wordwrap=150,Z.align="center",Z.color=G.index===G.activeIndex?"0xffffffff":"0xaaaaaaff",Z.__textnode=!0,b[3][G.key].nodeId||b[3][G.key].populate(Z),G.language=k[W],b[1][0]&&b[1][0].forComponent&&b[1][0].forComponent.___layout&&b[1][0].forComponent.___layout()}};return y(()=>{A(i.languages,s,M)},"languages"),y(()=>{i.activeIndex;for(let k=0;k<i.languages.length;k++){const b={};b.index=k,b.language=i.languages[k],b.key=k,s[2][b.key].set("alpha",b.index===i.activeIndex?1:.6)}}),y(()=>{i.activeIndex;for(let k=0;k<i.languages.length;k++){const b={};b.index=k,b.language=i.languages[k],b.key=k,s[3][b.key].set("color",b.index===i.activeIndex?"0xffffffff":"0xaaaaaaff")}}),s},effects:[],context:{}},props:["languages"],state(){return{activeIndex:0}},watch:{activeIndex(h){const r=this.languages[h];r&&r.code&&this.$language.set(r.code)}},input:{right(){this.activeIndex=Math.min(this.activeIndex+1,this.languages.length-1)},left(){this.activeIndex=Math.max(this.activeIndex-1,0)}}}),XM=et.Component("LanguagePlugin",{components:{Flags:WM},code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),s[0].populate(M);const A=u.components&&u.components.Flags||d.Flags;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),k.languages=i.languages,k.ref="flags",k.x=500,k.y=150,typeof A<"u")for(let W in A.config.props)delete k[A.config.props[W]];s[1].populate(k),r=s[1];const b={};b.languages=i.languages,b.ref="flags",b.x=500,b.y=150,g=b.is||"Flags";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "Flags" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0],r=s[0];const w={};s[3]=this.element({parent:r||"root"},i),w.x=960,w.y=540,w.mount=.5,w.content=i.$language.translate("hello"),w.size=80,w.__textnode=!0,s[3].populate(w),r=s[0];const R={};s[4]=this.element({parent:r||"root"},i),R.x=960,R.y=640,R.mount=.5,R.content=i.$language.translate("bye"),R.size=50,R.__textnode=!0,s[4].populate(R),r=s[0];const B={};s[5]=this.element({parent:r||"root"},i),B.x=960,B.y=720,B.mount=.5,B.content=i.$language.translate("replacement",{first:"John",last:"Doe",age:18}),B.size=36,B.__textnode=!0,s[5].populate(B),r=s[0];const U={};return s[6]=this.element({parent:r||"root"},i),U.size=32,U.x=960,U.y=940,U.mount=.5,U.align="center",U.content="Current language: "+i.$language.language+`
 Language file: `+(i.loaded===!0?"Loaded":"loading ..."),U.__textnode=!0,s[6].populate(U),s},effects:[function(r,i,u,d,y,x){i[3].set("content",r.$language.translate("hello"))},function(r,i,u,d,y,x){i[4].set("content",r.$language.translate("bye"))},function(r,i,u,d,y,x){i[5].set("content",r.$language.translate("replacement",{first:"John",last:"Doe",age:18}))},function(r,i,u,d,y,x){i[6].set("content","Current language: "+r.$language.language+`
 Language file: `+(r.loaded===!0?"Loaded":"loading ..."))}],context:{}},state(){return{loaded:!1,languages:[{flag:"/assets/flags/united-states.png",code:"en-US",name:"English"},{flag:"/assets/flags/netherlands.png",code:"nl-NL",name:"Dutch"},{flag:"/assets/flags/france.png",code:"fr-FR",name:"French"},{flag:"/assets/flags/germany.png",code:"de-DE",name:"German"}]}},hooks:{init(){this.$language.set("en-US"),setTimeout(()=>{this.$language.load("/assets/translations.json").then(()=>{this.loaded=!0})},2e3)},focus(){this.select("flags").focus()}}}),KM=et.Application({code:{render:function(r,i,u,d,y,x){const s=[];let g;const M={};s[0]=this.element({parent:r||"root"},i),M.w=1920,M.h=1080,M.color=i.backgroundColor,s[0].populate(M);const A=u.components&&u.components.RouterView||d.RouterView;r=s[0];const k={};if(s[1]=this.element({parent:r||"root"},i),typeof A<"u")for(let w in A.config.props)delete k[A.config.props[w]];s[1].populate(k),r=s[1];const b={};g=b.is||"RouterView";let P;if(typeof g=="string"){if(P=u.components&&u.components[g]||d[g],!P)throw new Error('Component "RouterView" not found')}else typeof g=="function"&&g.name==="factory"&&(P=g);return s[2]=P.call(null,{props:b},s[1],i),s[2][Symbol.for("slots")][0]?(r=s[2][Symbol.for("slots")][0],i=s[2]):r=s[2][Symbol.for("children")][0],s},effects:[function(r,i,u,d,y,x){i[0].set("color",r.backgroundColor)}],context:{}},state(){return{backgroundColor:"#1e293b",showFPS:!0}},routes:[{path:"/",component:Ok,options:{keepAlive:!0}},{path:"/demos/loading",component:()=>Sk(()=>import("./Loading-0823d6cf.js"),[])},{path:"/demos/intro",component:()=>new Promise(h=>{h(Bk)})},{path:"/demos/theming",component:Hk},{path:"/demos/tmdb",component:tM},{path:"/demos/sprites",component:iM},{path:"/demos/focushandling",component:rM},{path:"/demos/memory-game",component:zM,announce:"Let's play Memory"},{path:"/demos/player",component:yM},{path:"/examples/positioning",component:sM},{path:"/examples/colors",component:vM},{path:"/examples/gradients",component:xM},{path:"/examples/transitions",component:wM},{path:"/examples/alpha",component:SM},{path:"/examples/scaling",component:TM},{path:"/examples/rotation",component:CM},{path:"/examples/keyinput",component:EM},{path:"/examples/texts",component:AM},{path:"/examples/images",component:bM},{path:"/examples/components",component:IM},{path:"/examples/forloop",component:kM},{path:"/examples/forloop-advanced",component:PM},{path:"/examples/effects",component:DM},{path:"/examples/showif",component:NM},{path:"/examples/events",component:OM},{path:"/examples/slots",component:jM},{path:"/examples/viewport",component:GM},{path:"/examples/languageplugin",component:XM},{path:"/benchmarks/exponential",component:HM}],hooks:{ready(){this.$listen("changeBackground",h=>{this.backgroundColor=h?h+80:"#1e293b"}),this.$listen("clearBackground",()=>{this.backgroundColor="transparent"})}},input:{escape(){this.quit()},back(){this.$router.to("/")}}});et.Plugin(yk);et.Launch(KM,"app",{w:1920,h:1080,multithreaded:!1,debugLevel:1,reactivityMode:"Proxy",keymap:vk(),fonts:[{family:"lato",type:"msdf",file:"fonts/Lato-Regular.ttf"},{family:"raleway",type:"msdf",file:"fonts/Raleway-ExtraBold.ttf"},{family:"opensans",type:"web",file:"fonts/OpenSans-Medium.ttf"},{family:"kalam",type:"msdf",file:"fonts/Kalam-Regular.ttf"}],canvasColor:"transparent",viewportMargin:100});export{et as B,vs as S};
