var gI=Object.defineProperty;var mI=(h,r,o)=>r in h?gI(h,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):h[r]=o;var N=(h,r,o)=>(mI(h,typeof r!="symbol"?r+"":r,o),o);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))f(p);new MutationObserver(p=>{for(const v of p)if(v.type==="childList")for(const S of v.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&f(S)}).observe(document,{childList:!0,subtree:!0});function o(p){const v={};return p.integrity&&(v.integrity=p.integrity),p.referrerPolicy&&(v.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?v.credentials="include":p.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function f(p){if(p.ep)return;p.ep=!0;const v=o(p);fetch(p.href,v)}})();const me={currentView:Symbol("currentView"),cursorTagStart:Symbol("cursorTagStart"),computedKeys:Symbol("computedKeys"),destroy:Symbol("destroy"),getChildren:Symbol("getChildren"),holder:Symbol("holder"),id:Symbol("id"),identifier:Symbol("identifier"),index:Symbol("index"),init:Symbol("init"),inputEvents:Symbol("inputEvents"),intervals:Symbol("intervals"),launched:Symbol("launched"),level:Symbol("level"),methodKeys:Symbol("methodKeys"),originalState:Symbol("originalState"),propKeys:Symbol("propKeys"),raw:Symbol("raw"),ready:Symbol("ready"),renderer:Symbol("renderer"),routes:Symbol("routes"),settings:Symbol("settings"),state:Symbol("state"),stateKeys:Symbol("stateKeys"),textnode:Symbol("textnode"),timeouts:Symbol("timeouts"),type:Symbol("type"),watchers:Symbol("watchers"),watchKeys:Symbol("watchKeys"),wrapper:Symbol("wrapper"),children:Symbol.for("children"),components:Symbol.for("components"),isSlot:Symbol.for("isSlot"),props:Symbol.for("props"),slots:Symbol.for("slots"),componentType:Symbol.for("componentType")},io={[me.settings]:{},get(h,r=null){return h in this[me.settings]?this[me.settings][h]:r},set(h,r){typeof h=="object"?Object.keys(h).forEach(o=>{this.set(o,h[o])}):this[me.settings][h]=r}},Tc=()=>{},M0=()=>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),MS=h=>{const r=io.get("debugLevel"),o={};return Object.defineProperty(o,"info",{get(){return(r>=1||Array.isArray(r)&&r.indexOf("info")>-1)&&console.info.bind(window.console,`%c ⚡️ ${h} %c ${M0()}`,"background-color: #0284c7; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Tc}}),Object.defineProperty(o,"warn",{get(){return(r>=1||Array.isArray(r)&&r.indexOf("warn")>-1)&&console.warn.bind(window.console,`%c ⚡️ ${h} %c ${M0()}`,"background-color: #fbbf24; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Tc}}),Object.defineProperty(o,"error",{get(){return(r>=1||Array.isArray(r)&&r.indexOf("error")>-1)&&console.error.bind(window.console,`%c ⚡️ ${h} %c ${M0()}`,"background-color: #dc2626; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Tc}}),Object.defineProperty(o,"debug",{get(){return(r>=2||Array.isArray(r)&&r.indexOf("debug")>-1)&&console.debug.bind(window.console,`%c ⚡️ ${h} %c (${new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})`,"background-color: #e2e8f0; color: #334155; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Tc}}),o};let Kt;const yI=()=>{Kt=MS("Blits")},Cc={aliceblue:"0xf0f8ffff",antiquewhite:"0xfaebd7ff",aqua:"0xffffff00",aquamarine:"0x7fffd4ff",azure:"0xf0ffffff",beige:"0xf5f5dcff",bisque:"0xffe4c4ff",black:"0x000000ff",blanchedalmond:"0xffebcdff",blue:"0x0000ffff",blueviolet:"0x8a2be2ff",brown:"0xa52a2aff",burlywood:"0xdeb887ff",cadetblue:"0x5f9ea0ff",chartreuse:"0x7fff00ff",chocolate:"0xd2691eff",coral:"0xff7f50ff",cornflowerblue:"0x6495edff",cornsilk:"0xfff8dcff",crimson:"0xdc143cff",cyan:"0x00ffffff",darkblue:"0x00008bff",darkcyan:"0x008b8bff",darkgoldenrod:"0xb8860bff",darkgray:"0xa9a9a9ff",darkgreen:"0x006400ff",darkgrey:"0xa9a9a9ff",darkkhaki:"0xbdb76bff",darkmagenta:"0x8b008bff",darkolivegreen:"0x556b2fff",darkorange:"0xff8c00ff",darkorchid:"0x9932ccff",darkred:"0x8b0000ff",darksalmon:"0xe9967aff",darkseagreen:"0x8fbc8fff",darkslateblue:"0x483d8bff",darkslategray:"0x2f4f4fff",darkslategrey:"0x2f4f4fff",darkturquoise:"0x00ced1ff",darkviolet:"0x9400d3ff",deeppink:"0xff1493ff",deepskyblue:"0x00bfffff",dimgray:"0x696969ff",dimgrey:"0x696969ff",dodgerblue:"0x1e90ffff",firebrick:"0xb22222ff",floralwhite:"0xfffaf0ff",forestgreen:"0x228b22ff",fuchsia:"0xff00ffff",gainsboro:"0xdcdcdcff",ghostwhite:"0xf8f8ffff",gold:"0xffd700ff",goldenrod:"0xdaa520ff",gray:"0x808080ff",green:"0x008000ff",greenyellow:"0xadff2fff",grey:"0x808080ff",honeydew:"0xf0fff0ff",hotpink:"0xff69b4ff",indianred:"0xcd5c5cff",indigo:"0x4b0082ff",ivory:"0xfffff0ff",khaki:"0xf0e68cff",lavender:"0xe6e6faff",lavenderblush:"0xfff0f5ff",lawngreen:"0x7cfc00ff",lemonchiffon:"0xfffacdff",lightblue:"0xadd8e6ff",lightcoral:"0xf08080ff",lightcyan:"0xe0ffffff",lightgoldenrodyellow:"0xfafad2ff",lightgray:"0xd3d3d3ff",lightgreen:"0x90ee90ff",lightgrey:"0xd3d3d3ff",lightpink:"0xffb6c1ff",lightsalmon:"0xffa07aff",lightseagreen:"0x20b2aaff",lightskyblue:"0x87cefaff",lightslategray:"0x778899ff",lightslategrey:"0x778899ff",lightsteelblue:"0xb0c4deff",lightyellow:"0xffffe0ff",lime:"0x00ff00ff",limegreen:"0x32cd32ff",linen:"0xfaf0e6ff",magenta:"0xff00ffff",maroon:"0x800000ff",mediumaquamarine:"0x66cdaaff",mediumblue:"0x0000cdff",mediumorchid:"0xba55d3ff",mediumpurple:"0x9370dbff",mediumseagreen:"0x3cb371ff",mediumslateblue:"0x7b68eeff",mediumspringgreen:"0x00fa9aff",mediumturquoise:"0x48d1ccff",mediumvioletred:"0xc71585ff",midnightblue:"0x191970ff",mintcream:"0xf5fffaff",mistyrose:"0xffe4e1ff",moccasin:"0xffe4b5ff",navajowhite:"0xffdeadff",navy:"0x000080ff",oldlace:"0xfdf5e6ff",olive:"0x808000ff",olivedrab:"0x6b8e23ff",orange:"0xffa500ff",orangered:"0xff4500ff",orchid:"0xda70d6ff",palegoldenrod:"0xeee8aaff",palegreen:"0x98fb98ff",paleturquoise:"0xafeeeeff",palevioletred:"0xdb7093ff",papayawhip:"0xffefd5ff",peachpuff:"0xffdab9ff",peru:"0xcd853fff",pink:"0xffc0cbff",plum:"0xdda0ddff",powderblue:"0xb0e0e6ff",purple:"0x800080ff",rebeccapurple:"0x663399ff",red:"0xff0000ff",rosybrown:"0xbc8f8fff",royalblue:"0x4169e1ff",saddlebrown:"0x8b4513ff",salmon:"0xfa8072ff",sandybrown:"0xf4a460ff",seagreen:"0x2e8b57ff",seashell:"0xfff5eeff",sienna:"0xa0522dff",silver:"0xc0c0c0ff",skyblue:"0x87ceebff",slateblue:"0x6a5acdff",slategray:"0x708090ff",slategrey:"0x708090ff",snow:"0xfffafaff",springgreen:"0x00ff7fff",steelblue:"0x4682b4ff",tan:"0xd2b48cff",teal:"0x008080ff",thistle:"0xd8bfd8ff",tomato:"0xff6347ff",transparent:"0x00000000",turquoise:"0x40e0d0ff",violet:"0xee82eeff",wheat:"0xf5deb3ff",white:"0xffffffff",whitesmoke:"0xf5f5f5ff",yellow:"0xffff00ff",yellowgreen:"0x9acd32ff"},vI=/^#?([0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i,xI=/^(rgba?)\((\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*)(,(\s*(-?\d+(?:\.\d+)?)\s*))?\)$/,wI=/^(hsla?)\((\s*(360|3[0-5][0-9]|[12]?[0-9]{1,2})\s*),(\s*(100|[1-9]?[0-9])\s*)%,(\s*(100|[1-9]?[0-9])\s*)%(,(\s*(1|0(?:\.\d+)?)\s*))?\)$/,R0={},Ec=h=>{if(R0[h]!==void 0)return R0[h];const r=parseInt(h).toString(16).padStart(2,"0");return R0[h]=r,r},aa={normalize:(h="",r="0xffffffff")=>{if(h=h.toString(),h.startsWith("0x")&&h.length===10)return h;if(Cc[h]!==void 0)return Cc[h];if(vI.test(h)){h=h.replace("#","").toLowerCase(),h.length===3&&(h=h.split("").map(p=>p+p).join(""));const f="0x"+h.padEnd(8,"f");return Cc[h]=f,f}const o=xI.exec(h);if(o){const f=Ec(o[3]),p=Ec(o[5]),v=Ec(o[7]);let S="ff";if(o[10]&&o[1]==="rgba"){const m=Math.min(Math.max(Math.round(parseFloat(o[10])*255),0),255);S=Ec(m)}const a="0x"+f+p+v+S;return Cc[h]=a,a}return wI.test(h)?(console.warn("HSL(A) color format is not supported yet"),"0xffffffff"):r}},SI=(h="",r,o,f=null)=>{let p=0,v=0,S=[],a=null,m=0;const _=/^<\/?([a-zA-Z0-9_\-.]+)\s*/,I=/^\s*(\/?>)\s*/,M=/^([A-Za-z0-9:.\-_@$]+)=\s*(["'])/,R=/^<>\s*/,U=/^\s*(<\/>)\s*/,x=()=>{h=j(h);try{return L(Y),ce(S)}catch(ee){throw(ee.name=="TemplateParseError"||ee.name=="TemplateStructureError")&&(ee.message=`${ee.message}
${ee.context}`),ee}},L=ee=>{p>=h.length||ee()},j=ee=>ee.replace(/<!--.*?-->/gms,"").replace(/\r?\n\s*\r\n/gm," ").replace(/\r?\n\s*(\S)/gm," $1").replace(/\r?\n/g,"").trim(),H=ee=>{const de=h.slice(p).match(ee);return de&&(v=p,p+=de[0].length),de},Y=()=>{H(R)?(S.push({[Symbol.for("componentType")]:null,[me.type]:"opening",[me.level]:m,[me.cursorTagStart]:v}),m++,L(Y)):L(Z)},Z=()=>{H(U)?(m--,S.push({[Symbol.for("componentType")]:null,[me.type]:"closing",[me.level]:m}),L(Y)):L(X)},X=()=>{const ee=H(_);if(ee)a={[Symbol.for("componentType")]:ee[1],[me.level]:m,[me.cursorTagStart]:v},ee[0].startsWith("</")?(m--,a[me.type]="closing",a[me.level]=m):(a[me.type]="opening",m++),L(re);else throw ue("InvalidTag")},re=()=>{const ee=H(I);if(ee){if(ee[1]==="/>"){if(a[me.type]==="closing")throw ue("InvalidClosingTag");a[me.type]="self-closing",m--}if(a[me.type]==="opening"){const de=h.slice(p,h.indexOf("<",p));de&&(a.content=de,p+=de.length)}S.push(a),L(Y)}else L(le)},le=()=>{const ee=H(M);if(ee){if(a[me.type]==="closing")throw ue("AttributesInClosingTag");const de=ee[2],Ee=new RegExp(`^(.*?)${de}\\s*`),Ie=H(Ee);if(Ie){const ke=se(ee[1],Ie[1]);a[ke.name]=ke.value,L(re)}else throw ue("MissingOrInvalidAttributeValue")}else throw ue("InvalidAttribute")},se=(ee,de)=>{if(ee.includes(".")){const[Ee,Ie]=ee.split(".");return{name:Ee,value:`{${Ie}: ${de}}`}}return["color",":color",":effects","effects"].includes(ee)?W(ee,de):{name:ee,value:de}},W=(ee,de)=>{let Ee=de,Ie=aa.normalize(Ee,null);if(Ie===null){const ke=/'([^']+)'/g;let Le,_e=0,De="";for(;(Le=ke.exec(de))!==null;){const $=Le[1],Pe=Le.index,He=Le[0].length;De+=de.slice(_e,Pe),Ie=aa.normalize($,null),Ie===null?De+=de.slice(Pe,Pe+He):De+=`'${Ie}'`,_e=Pe+He}De+=de.slice(_e),Ee=De}else Ee=Ie;return{name:ee,value:Ee}},ce=ee=>{let de=[],Ee=!1,Ie={children:[]},ke=Ie;for(let Le=0;Le<ee.length;Le++){let _e=ee[Le];if(_e[me.level]===0&&_e[me.type]!=="closing"){if(Ee)throw ye("MultipleTopLevelTags",_e);Ee=!0}if(_e[me.type]==="opening")de.push({[me.level]:_e[me.level],[me.type]:_e[me.type],[me.cursorTagStart]:_e[me.cursorTagStart],[Symbol.for("componentType")]:_e[Symbol.for("componentType")],parent:ke});else if(_e[me.type]==="closing"){const $=de.length===0;let Pe=!1,He=!1;if($||(Pe=de[de.length-1][me.level]!==_e[me.level],He=de[de.length-1][Symbol.for("componentType")]!==_e[Symbol.for("componentType")]),$||Pe||He)throw ye("MismatchedClosingTag",_e);ke=de.pop().parent}const De={..._e};delete De[me.type],delete De[me.level],delete De[me.cursorTagStart],_e[me.type]==="opening"?(Le+1<ee.length&&ee[Le+1][me.type]!=="closing"&&(De.children=[]),ke.children.push(De),ke=De):_e[me.type]==="self-closing"&&ke.children.push(De)}if(de.length>0)throw ye("UnclosedTags",de);return Ie},E=10,F=50,ue=ee=>{const de=ie();ee=`${ee} in ${de}`;const Ee=new Error(ee);Ee.name="TemplateParseError";const Ie=Math.max(0,v-E),ke=Math.min(h.length,p+F),Le=h.slice(Ie,ke),_e=p-Ie;return Ee.context=ge(_e,Le),Ee},ye=(ee,de)=>{const Ee=ie();ee=`${ee} in ${Ee}`;const Ie=new Error(ee);Ie.name="TemplateStructureError",Array.isArray(de)?Ie.context=de.map(Le=>ke(Le)).join(`
`):Ie.context=ke(de);function ke(Le){const _e=Math.max(0,Le[me.cursorTagStart]-E),De=h.slice(_e,_e+F);return ge(E,De)}return Ie},ge=(ee,de)=>{const Ee=" ".repeat(ee)+"^";return`
${de}
${Ee}
`},ie=()=>{if(o){let ee=r||"",de=o;for(;de;)ee=`${de[Symbol.for("componentType")]}/${ee}`,de=de.parent;return ee}return f||"Blits.Application"};return x()};let Ct;function TI(h={children:[]}){const r={renderCode:["const elms = []","let componentType","const rootComponent = component"],effectsCode:[],context:{props:[],components:this.components}};return Ct=-1,_S.call(r,h),r.renderCode.push("return elms"),{render:new Function("parent","component","context","components","effect","getRaw",r.renderCode.join(`
`)),effects:r.effectsCode.map(o=>new Function("component","elms","context","components","rootComponent","effect",o)),context:r.context}}const Wc=function(h,r=!1,o={key:!1,component:"component.",forceEffect:!1,forloop:!1}){const f=o.forceEffect?this.effectsCode:this.renderCode;r&&f.push(`parent = ${r}`),"key"in h&&(o.key=Pi(h.key,o.component));const p=o.key?`elms[${Ct}][${o.key}]`:`elms[${Ct}]`;o.key&&f.push(`
      if(elms[${Ct}] === undefined) {
        elms[${Ct}] = {}
      }
    `),f.push(`const elementConfig${Ct} = {}`),o.forloop&&f.push(`if(${p} === undefined) {`),f.push(`
    ${p} = this.element({parent: parent || 'root'}, component)
  `),o.forloop&&f.push("}");const v=h.children;delete h.children,h[Symbol.for("componentType")]==="Slot"&&f.push(`elementConfig${Ct}[Symbol.for('isSlot')] = true`),Object.keys(h).forEach(S=>{if(S==="slot"&&f.push(`
        elementConfig${Ct}['parent'] = component[Symbol.for('slots')].filter(slot => slot.ref === '${h.slot}').shift() || component[Symbol.for('slots')][0] || parent
      `),S!=="key")if(LS(S)){if(o.holder&&S===":color")return;o.holder?this.effectsCode.push(`
        if(typeof skip${Ct} === 'undefined' ||
          skip${Ct}.indexOf('${S.substring(1)}') === -1)
          ${p}.set('${S.substring(1)}', ${Pi(h[S],o.component)})
        `):this.effectsCode.push(`
            ${p}.set('${S.substring(1)}', ${Pi(h[S],o.component)})
          `),f.push(`elementConfig${Ct}['${S.substring(1)}'] = ${Pi(h[S],o.component)}`)}else f.push(`elementConfig${Ct}['${S}'] = ${lg(h[S],S,o.component)}`)}),o.holder===!0&&f.push(`
    const skip${Ct} = []
    if(typeof cmp${Ct} !== 'undefined') {
      for(let key in cmp${Ct}.config.props) {
        delete elementConfig${Ct}[cmp${Ct}.config.props[key]]
        skip${Ct}.push(cmp${Ct}.config.props[key])
      }
    }
    `),o.forloop&&f.push(`if(${p}.nodeId === undefined) {`),f.push(`${p}.populate(elementConfig${Ct})`),o.forloop&&f.push("}"),v&&_S.call(this,{children:v},`${p}`,o)},RS=function(h,r=!1,o={key:!1,component:"component.",forceEffect:!1,holder:!1,forloop:!1}){const f=o.forceEffect?this.effectsCode:this.renderCode;f.push(`
    const cmp${Ct} =
      (context.components && context.components['${h[Symbol.for("componentType")]}']) || components['${h[Symbol.for("componentType")]}']
  `),"key"in h&&(o.key=Pi(h.key,o.component));const p=h.children;delete h.children,Wc.call(this,h,r,{...o,holder:!0}),r=o.key?`elms[${Ct}][${o.key}]`:`elms[${Ct}]`,Ct++;const v=o.key?`elms[${Ct}][${o.key}]`:`elms[${Ct}]`;o.key&&f.push(`
      if(elms[${Ct}] === undefined) {
        elms[${Ct}] = {}
      }
    `),r&&f.push(`parent = ${r}`),f.push(`const props${Ct} = {}`),o.forloop&&f.push(`if(${v} === undefined) {`),Object.keys(h).forEach(S=>{LS(S)?(this.effectsCode.push(`
        ${v}[Symbol.for('props')]['${S.substring(1)}'] = ${Pi(h[S],o.component)}`),f.push(`props${Ct}['${S.substring(1)}'] = ${Pi(h[S],o.component)}`)):f.push(`props${Ct}['${S}'] = ${lg(h[S],S,o.component)}`)}),f.push(`
    componentType = props${Ct}['is'] || '${h[Symbol.for("componentType")]}'

    let component${Ct}
    if(typeof componentType === 'string') {
      component${Ct} = context.components && context.components[componentType] || components[componentType]
      if(!component${Ct}) {
        throw new Error('Component "${h[Symbol.for("componentType")]}" not found')
      }
    } else if(typeof componentType === 'function' && componentType.name === 'factory') {
      component${Ct} = componentType
    }

    ${v} = component${Ct}.call(null, {props: props${Ct}}, ${r}, component)

    if (${v}[Symbol.for('slots')][0]) {
      parent = ${v}[Symbol.for('slots')][0]
      component = ${v}
    } else {
      parent = ${v}[Symbol.for('children')][0]
    }
  `),o.forloop&&f.push("}"),p&&(Ct++,Wc.call(this,{children:p},!1,{...o}))},CI=function(h,r){const o=h[":for"];delete h[":for"];const f=h.key,p=Pi(f,"scope."),v=!(h.$shallow&&h.$shallow.toLowerCase()==="false");delete h.$shallow,delete h.key;const a=/(.+)\s+in\s+(.+)/gi.exec(o),[m,_="index"]=a[1].replace("(","").replace(")","").split(/\s*,\s*/),I=new RegExp(`(scope\\.(?!${m}\\.|${_}|key)(\\w+))`,"gi"),M={renderCode:[],effectsCode:[],context:{props:[],components:this.components}};r&&M.renderCode.push(`parent = ${r}`);const U=new RegExp(`\\$${_}(?!['\\w])`).exec(f);Array.isArray(U)&&M.renderCode.push(`console.warn(" Using '${_}' in the key, like key=${f},  is not recommended")`);const x=Ct;M.renderCode.push(`
    const created${x} = []
    const forloop${x} = (collection = [], elms, created) => {
      const rawCollection = getRaw(collection)
      const keys = new Set()
      let l = rawCollection.length
      while(l--) {
        const ${m} = rawCollection[l]
        const ${_} = l
        keys.add('' +  ${Pi(f,"")||"l"})
      }
  `);const L=M.renderCode.length;M.renderCode.push(`
      created.length = 0
      const length = rawCollection.length
      for(let __index = 0; __index < length; __index++) {
        const scope = Object.create(component)
        parent = ${r}
        scope['${_}'] = __index
        scope['${m}'] = rawCollection[__index]
        scope['key'] = '' + ${p||"__index"}
  `),"ref"in h&&h.ref.indexOf("$")===-1&&(M.renderCode.push(`
        scope['__ref'] = '${h.ref}' + __index
    `),h.ref="$__ref"),M.renderCode.push(`
        created.push(scope.key)
  `),h[Symbol.for("componentType")]==="Element"||h[Symbol.for("componentType")]==="Slot"||h[Symbol.for("componentType")]==="Text"?Wc.call(M,h,r,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0}):RS.call(M,h,!1,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0});const j=M.effectsCode.filter(X=>[...X.matchAll(I)].length===0),H=M.effectsCode.filter(X=>[...X.matchAll(I)].length!==0);v===!1&&M.renderCode.push(`
      scope['${m}'] = null
      scope['${m}'] = collection[__index]
  `),j.forEach(X=>{const re=X.indexOf(`scope.${_}`)>-1?`'${Pi(a[2],"")}'`:null;X.indexOf("Symbol.for('props')")===-1?M.renderCode.push(`
        effect(() => {
          ${X}
        }, ${re})
      `):M.renderCode.push(`
        ${X}
      `)}),M.renderCode.push(`
    }
  }`);const Y=[];Y.push(`
      let i = created.length

      while (i--) {
        if (keys.has(created[i]) === false) {
          const key = created[i]
  `);const Z=Ct;for(let X=x;X<=Z;X++)Y.push(`
          elms[${X}][key] && elms[${X}][key].destroy()
          delete elms[${X}][key]
      `);Y.push(`
       }
    }
  `),M.renderCode.splice(L,0,...Y),M.renderCode.push(`
    effect(() => {
      forloop${x}(${lg(a[2],":for")}, elms, created${x})
    }, '${Pi(a[2],"")}')
  `),H.forEach(X=>{const re=[...X.matchAll(I)];let le=re.length;const se=[];for(;le--;){const W=re[le],ce=`component.${W[2]}`;se.indexOf(ce)===-1&&se.push(ce),X=X.substring(0,W.index)+ce+X.substring(W.index+W[1].length)}M.renderCode.push(`
      effect(() => {
        void ${se.join(", ")}
        for(let __index = 0; __index < ${Pi(a[2])}.length; __index++) {
          const scope = {}
          scope['${_}'] = __index
          scope['${m}'] = ${Pi(a[2])}[__index]
          scope['key'] = ${p||"__index"}
    `),M.renderCode.push(`
          ${X}
        }
      })
    `)}),this.renderCode.push(M.renderCode.join(`
`))},_S=function(h,r=!1,o={}){h.children&&h.children.forEach(f=>{Ct++,Object.keys(f).indexOf(":for")>-1?CI.call(this,f,r):f[Symbol.for("componentType")]==="Element"||f[Symbol.for("componentType")]==="Slot"||f[Symbol.for("componentType")]==="Text"?(f[Symbol.for("componentType")]==="Text"&&(f.__textnode="true"),Wc.call(this,f,r,o)):RS.call(this,f,r,o)})},Pi=(h,r="component.")=>{if(h===void 0)return h;const o=/('.*?')+/gi,f=/\$(\$(?=\$)|\$?)/g,p=h.matchAll(o),v=[];let S=0;for(const a of p)v.push(a[0]),h=h.replace(a[0],`[@@REPLACEMENT${S}@@]`),S++;return h=h.replace(f,(a,m)=>{if(m==="")return r;if(m==="$")return r+"$"}),v.forEach((a,m)=>{h=h.replace(`[@@REPLACEMENT${m}@@]`,a)}),h},lg=(h="",r=!1,o="component.")=>{const f=/\$\w+/gi;let p;if(r==="content")if(h.startsWith("$"))p=`${o}${h.replace("$","")}`;else{const v=h.replace(/\\\\/g,"__DOUBLE_BACKSLASH__").replace(/(^|[^\\])'/g,"$1\\'").replace(/__DOUBLE_BACKSLASH__/g,"\\\\");p=`'${EI(v,o)}'`}else if(r!=="color"&&!isNaN(parseFloat(h))){if(p=parseFloat(h),h.endsWith("%")){const S={w:"width",width:"width",x:"width",h:"height",height:"height",y:"height"}[r];S&&(p=`parent.node.${S} * (${p} / 100)`)}}else if(h.toLowerCase()==="true")p=!0;else if(h.toLowerCase()==="false")p=!1;else if(r.startsWith("@")&&h){const v=o.slice(0,-1);p=`${v}['${h.replace("$","")}'] && ${v}['${h.replace("$","")}'].bind(${v})`}else if(h.startsWith("$"))p=`${o}${h.replace("$","")}`;else if(f.exec(h)){const v=/\w+\s*:\s*(?:[^\s,}]+|".*?"|'.*?')/g,S=h.match(v);if(p={},S)for(let a=0;a<S.length;a++){const m=S[a].split(/\s*:\s*/);m&&AI(m[0],m[1],o,p)}return kI(p)}else p=`"${h}"`;return p},LS=h=>h.startsWith(":"),EI=(h,r)=>{const o=/\{\{\s*(\$\S+)\s*\}\}/g,f=[...h.matchAll(o)];if(f.length)for(let[p,v]of f)h=h.replace(p,`${v.replace("$",`'+${r}`)}+'`);return h},AI=(h,r,o,f)=>{r.startsWith("$")?f[h]=`${o}${r.replace("$","")}`:f[h]=r},kI=h=>{const r=[];return Object.keys(h).forEach(o=>{r.push(`${o}: ${h[o]}`)}),` { ${r.join(", ")} }`},Yw={};let bI=0;const II=h=>`BlitsComponent::${h}_${Yw[h]=(Yw[h]||0)+1}`,MI=()=>++bI,cr={},z0=(h,r,o,f=[])=>{cr[r]&&cr[r][h]&&cr[r][h].apply(o,f)},RI=(h,r,o)=>{const f=me[h];cr[r]&&cr[r][f]&&cr[r][f].apply(o)},_I=(h={},r)=>{cr[r]={},[...Object.keys(h),...Object.getOwnPropertySymbols(h)].forEach(f=>{typeof h[f]=="function"&&(cr[r][f]=h[f])})};let Gl=null,qc=null,lh=!1;const LI=()=>{lh=!0},PI=()=>{lh=!1},G0=new WeakMap,jc=(h,r)=>{if(Gl){if(lh||qc!==null&&r!==qc)return;let o=G0.get(h);o||(o=new Map,G0.set(h,o));let f=o.get(r);f||(f=new Set,o.set(r,f)),f.add(Gl)}},la=(h,r,o=!1)=>{if(lh===!0)return;const f=G0.get(h);if(!f)return;const p=f.get(r);if(p)for(let v of p)v(o)},Ac=(h,r=null)=>{Gl=h,qc=r,Gl(),Gl=null,qc=null},Fc=["push","pop","shift","unshift","splice","sort"],Kw=new WeakMap,ra=h=>{const r=h&&h[me.raw];return r?ra(r):h},X0=(h,r=null,o)=>{if(typeof h=="object"&&(h[me.id]!==void 0||h.constructor.name==="_ImageTexture"))return h;const f=Kw.get(h);if(f)return f;const p={get(S,a,m){return a===me.raw?h:Array.isArray(S)?typeof S[a]=="object"&&S[a]!==null?(Array.isArray(S[a])&&jc(S,a),X0(ra(S[a]),S,a)):Fc.indexOf(a)!==-1?function(..._){LI();const I=S[a].apply(this,_);return PI(),la(r,o),I}:a==="length"?h.length:Reflect.get(S,a,m):typeof S[a]=="object"&&S[a]!==null?(Array.isArray(S[a])&&jc(S,a),X0(ra(S[a]),S,a)):(jc(S,a),Reflect.get(S,a,m))},set(S,a,m,_){const I=ra(S[a]),M=ra(m);let R=!0;return I!==M&&(R=Reflect.set(S,a,m,_)),R&&I!==M&&(Array.isArray(S)&&a in S&&la(r,o,!0),la(S,a,!0)),R}},v=new Proxy(h,p);return Kw.set(h,v),v},PS=h=>(Object.keys(h).forEach(r=>{let o=h[r];if(h[r]!==null&&typeof h[r]=="object"){if(Object.getPrototypeOf(h[r])===Object.prototype)return PS(h[r]);if(Array.isArray(h[r]))for(let f=0;f<Fc.length-1;f++)h[r][Fc[f]]=function(p){Array.prototype[Fc[f]].call(this,p),la(h,r)}}Object.defineProperty(h,r,{enumerable:!0,configurable:!0,get(){return jc(h,r),o},set(f){o!==f&&(o=f,la(h,r))}})}),h),Yc=(h,r="Proxy")=>r==="defineProperty"?PS(h):X0(h),DI=["init","ready","focus","unfocus","destroy","attach","detach","enter","exit"],NI={previous:null,current:null,get state(){return this.current},set state(h){DI.indexOf(h)>-1&&(h!==this.current||h==="focus")&&(Kt.debug(`Setting lifecycle state from ${this.current} to ${h} for ${this.component.componentId}`),this.previous=this.current,this.current=h,RI(h,this.component[me.identifier],this.component),z0(h,this.component[me.identifier],this.component))}};function OI(h,r){const o={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},f=h.getContext("webgl",o)||h.getContext("experimental-webgl",o);if(!f)throw new Error("Unable to create WebGL context");return r?new Proxy(f,{get(p,v){const S=p[v];return typeof S=="function"?(r.increment(String(v)),S.bind(p)):S}}):f}function et(h,r){if(!NS()&&!h)throw new Error(r||"Assertion failed")}function Zw(h,r,o){const f=Math.trunc(h>>>24),p=Math.trunc(h>>>16&255),v=Math.trunc(h>>>8&255),S=Math.trunc(h&255),a=Math.trunc(r>>>24),m=Math.trunc(r>>>16&255),_=Math.trunc(r>>>8&255),I=Math.trunc(r&255),M=Math.round(a*o+f*(1-o)),R=Math.round(m*o+p*(1-o)),U=Math.round(_*o+v*(1-o)),x=Math.round(I*o+S*(1-o));return(M<<24|R<<16|U<<8|x)>>>0}function UI(h,r){const o=h>>>24,f=h>>>16&255,p=h>>>8&255,v=Math.trunc((h&255)*r);return(o<<24|f<<16|p<<8|v)>>>0}let DS=!0;function BI(h){DS=h==="webgl"}function kc(h,r,o=!1){const f=(h&255)/255*r,p=DS?f:1,v=Math.trunc((h>>>24)*p),S=Math.trunc((h>>>16&255)*p),a=Math.trunc((h>>>8&255)*p),m=Math.trunc(f*255);return o?(m<<24|a<<16|S<<8|v)>>>0:(v<<24|S<<16|a<<8|m)>>>0}function Kc(h,r){return Object.prototype.hasOwnProperty.call(h,r)}function NS(){return{VITE_TMDB_KEY:"ABC123",VITE_TMDB_BASE_URL:"https://8b4fa39d.lightningjs.workers.dev",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&!0}let jI=1;function FI(){return jI++}class hr{constructor(){N(this,"eventListeners",{})}on(r,o){let f=this.eventListeners[r];f||(f=[]),f.push(o),this.eventListeners[r]=f}off(r,o){const f=this.eventListeners[r];if(!f)return;if(!o){delete this.eventListeners[r];return}const p=f.indexOf(o);p>=0&&f.splice(p,1)}once(r,o){const f=(p,v)=>{this.off(r,f),o(p,v)};this.on(r,f)}emit(r,o){const f=this.eventListeners[r];f&&[...f].forEach(p=>{p(this,o)})}removeAllListeners(){this.eventListeners={}}}const $I=/^(data|ftps?|https?):/,Zl=h=>{const r=h>>>24,o=h>>>16&255,f=h>>>8&255,p=h&255;return[r/255,o/255,f/255,p/255]},VI=h=>{const r=h>>>24,o=h>>>16&255,f=h>>>8&255,p=h&255;return[r,o,f,p]};function HI(h){return(h&255)/255}function _0(h){const r=Math.floor(h[0]*255),o=Math.floor(h[1]*255),f=Math.floor(h[2]*255),p=Math.floor(h[3]*255);return`rgba(${r},${o},${f},${p.toFixed(4)})`}function Ys(h,r,o,f,p){return p?(p.x1=h,p.y1=r,p.x2=o,p.y2=f,p):{x1:h,y1:r,x2:o,y2:f}}function L0(h,r){return h.x1<r.x2&&h.x2>r.x1&&h.y1<r.y2&&h.y2>r.y1}function zI(h,r){return r?(r.x=h.x1,r.y=h.y1,r.width=h.x2-h.x1,r.height=h.y2-h.y1,r):{x:h.x1,y:h.y1,width:h.x2-h.x1,height:h.y2-h.y1}}function OS(h,r,o){const f=Math.max(h.x,r.x),p=Math.max(h.y,r.y),v=Math.min(h.x+h.width,r.x+r.width)-f,S=Math.min(h.y+h.height,r.y+r.height)-p;return v>0&&S>0?o?(o.x=f,o.y=p,o.width=v,o.height=S,o):{x:f,y:p,width:v,height:S}:o?(o.x=0,o.y=0,o.width=0,o.height=0,o):{x:0,y:0,width:0,height:0}}function US(h,r){return r?(r.x=h.x,r.y=h.y,r.width=h.width,r.height=h.height,r):{x:h.x,y:h.y,width:h.width,height:h.height}}function GI(h,r){return h===r?!0:h===null||r===null?!1:h.x===r.x&&h.y===r.y&&h.width===r.width&&h.height===r.height}function Qw(h,r){return h.x1<=r.x2&&h.y1<=r.y2&&h.x2>=r.x1&&h.y2>=r.y1}function XI(h,r){return h.x1<r.x1&&h.x2>r.x2&&h.y1<r.y1&&h.y2>r.y2}function WI(h){return h.x1<h.x2&&h.y1<h.y2}function qI(h){if(self.location.protocol==="file:"&&!$I.test(h)){const o=self.location.pathname.split("/");o.pop();const f=o.join("/"),p=self.location.protocol+"//"+f;return h.charAt(0)==="."&&(h=h.slice(1)),h.charAt(0)==="/"&&(h=h.slice(1)),p+"/"+h}return new URL(h,self.location.href).href}class li{constructor(){N(this,"ta");N(this,"tb");N(this,"tx");N(this,"tc");N(this,"td");N(this,"ty");N(this,"_floatArr",null);N(this,"mutation");this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return YI}static multiply(r,o,f){const p=r.ta*o.ta+r.tb*o.tc,v=r.ta*o.tb+r.tb*o.td,S=r.ta*o.tx+r.tb*o.ty+r.tx,a=r.tc*o.ta+r.td*o.tc,m=r.tc*o.tb+r.td*o.td,_=r.tc*o.tx+r.td*o.ty+r.ty;return f||(f=new li),f.ta=p,f.tb=v,f.tx=S,f.tc=a,f.td=m,f.ty=_,f.mutation=!0,f}static identity(r){return r||(r=new li),r.ta=1,r.tb=0,r.tx=0,r.tc=0,r.td=1,r.ty=0,r.mutation=!0,r}static translate(r,o,f){return f||(f=new li),f.ta=1,f.tb=0,f.tx=r,f.tc=0,f.td=1,f.ty=o,f.mutation=!0,f}static scale(r,o,f){return f||(f=new li),f.ta=r,f.tb=0,f.tx=0,f.tc=0,f.td=o,f.ty=0,f.mutation=!0,f}static rotate(r,o){const f=Math.cos(r),p=Math.sin(r);return o||(o=new li),o.ta=f,o.tb=-p,o.tx=0,o.tc=p,o.td=f,o.ty=0,o.mutation=!0,o}static copy(r,o){return o||(o=new li),o.ta=r.ta,o.tc=r.tc,o.tb=r.tb,o.td=r.td,o.tx=r.tx,o.ty=r.ty,o.mutation=!0,o}translate(r,o){return this.tx=this.ta*r+this.tb*o+this.tx,this.ty=this.tc*r+this.td*o+this.ty,this.mutation=!0,this}scale(r,o){return this.ta=this.ta*r,this.tb=this.tb*o,this.tc=this.tc*r,this.td=this.td*o,this.mutation=!0,this}rotate(r){if(r===0||!(r%Math.PI*2))return this;const o=Math.cos(r),f=Math.sin(r),p=this.ta*o+this.tb*f,v=this.tb*o-this.ta*f,S=this.tc*o+this.td*f,a=this.td*o-this.tc*f;return this.ta=p,this.tb=v,this.tc=S,this.td=a,this.mutation=!0,this}multiply(r){return li.multiply(this,r,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}const YI=new li,bc=0,Ic=2,Mc=4,Rc=6,_c=1,Lc=3,Pc=5,Dc=7;class Zc{constructor(r){N(this,"data");this.data=new Float32Array(8),r&&(this.data[bc]=r[bc],this.data[Ic]=r[Ic],this.data[Mc]=r[Mc],this.data[Rc]=r[Rc],this.data[_c]=r[_c],this.data[Lc]=r[Lc],this.data[Pc]=r[Pc],this.data[Dc]=r[Dc])}static translate(r,o,f,p,v,S,a,m,_){return _||(_=new Zc),_.data[bc]=r,_.data[Ic]=f,_.data[Mc]=v,_.data[Rc]=a,_.data[_c]=o,_.data[Lc]=p,_.data[Pc]=S,_.data[Dc]=m,_}get x1(){return this.data[bc]}get x2(){return this.data[Ic]}get x3(){return this.data[Mc]}get x4(){return this.data[Rc]}get y1(){return this.data[_c]}get y2(){return this.data[Lc]}get y3(){return this.data[Pc]}get y4(){return this.data[Dc]}}const Jw=h=>h&&!(h&h-1),BS=(h,r,o,f)=>{const p=3*h,v=3*(o-h)-p,S=1-p-v,a=3*r,m=3*(f-r)-a,_=1-a-m;return function(I){if(I>=1)return 1;if(I<=0)return 0;let M=.5,R,U,x;for(let H=0;H<20;H++){if(R=M*(M*(M*S+v)+p),x=I-R,x>-1e-8&&x<1e-8)return M*(M*(M*_+m)+a);if(U=M*(M*(3*S)+2*v)+p,U>1e-10&&U<1e-10)break;M+=x/U}let L=0,j=1;for(let H=0;H<20;H++){if(M=.5*(L+j),R=M*(M*(M*S+v)+p),x=I-R,x>-1e-8&&x<1e-8)return M*(M*(M*_+m)+a);x<0?j=M:L=M}}},$c={},KI={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},Vc=h=>h,ZI=h=>{const r=/-?\d*\.?\d+/g,o=h.match(r);if(o){const[f,p,v,S]=o,a=parseFloat(f||"0.42"),m=parseFloat(p||"0"),_=parseFloat(v||"1"),I=parseFloat(S||"1"),M=BS(a,m,_,I);return $c[h]=M,M}return console.warn("Unknown cubic-bezier timing: "+h),Vc},QI=h=>{if(h==="linear")return Vc;if($c[h]!==void 0)return $c[h]||Vc;if(h==="step-start")return()=>1;if(h==="step-end")return o=>o===1?1:0;const r=KI[h];if(r!==void 0){const[o,f,p,v]=r,S=BS(o,f,p,v);return $c[h]=S,S}return h.startsWith("cubic-bezier")?ZI(h):(console.warn("Unknown timing function: "+h),Vc)};function eS(h){return(h/1024/1024).toFixed(2)}class JI extends hr{constructor(o,f,p){super();N(this,"node");N(this,"props");N(this,"settings");N(this,"progress",0);N(this,"delayFor",0);N(this,"timingFunction");N(this,"propValuesMap",{});N(this,"dynPropValuesMap");this.node=o,this.props=f;for(const a in f)if(a!=="shaderProps")this.propValuesMap.props===void 0&&(this.propValuesMap.props={}),this.propValuesMap.props[a]={start:o[a]||0,target:f[a]};else if(o.shader.type!=="DynamicShader"){this.propValuesMap.shaderProps={};for(const m in f.shaderProps)this.propValuesMap.shaderProps[m]={start:o.shader.props[m],target:f.shaderProps[m]}}else{const m=Object.keys(f.shaderProps),_=m.length;this.dynPropValuesMap={};for(let I=0;I<_;I++){const M=m[I],R=f.shaderProps[M];this.dynPropValuesMap[M]={};const U=Object.entries(R),x=U.length;for(let L=0;L<x;L++){const[j,H]=U[L];this.dynPropValuesMap[M][j]={start:o.shader.props[M][j],target:H}}}}const v=p.easing||"linear",S=p.delay??0;this.settings={duration:p.duration??0,delay:S,easing:v,loop:p.loop??!1,repeat:p.repeat??0,repeatDelay:p.repeatDelay??0,stopMethod:p.stopMethod??!1},this.timingFunction=QI(v),this.delayFor=S}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(o,f){const p=Object.entries(f),v=p.length;for(let S=0;S<v;S++){const[a,m]=p[S];o[a]=m.start}}restore(){if(this.reset(),this.propValuesMap.props!==void 0&&this.restoreValues(this.node,this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const o=Object.keys(this.dynPropValuesMap),f=o.length;if(f>0)for(let p=0;p<f;p++){const v=o[p];this.restoreValues(this.node.shader.props[v],this.dynPropValuesMap[v])}}}reverseValues(o){const f=Object.entries(o),p=f.length;for(let v=0;v<p;v++){const[S,a]=f[v];o[S]={start:a.target,target:a.start}}}reverse(){if(this.progress=0,this.propValuesMap.props!==void 0&&this.reverseValues(this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.reverseValues(this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const o=Object.keys(this.dynPropValuesMap),f=o.length;if(f>0)for(let p=0;p<f;p++){const v=o[p];this.reverseValues(this.dynPropValuesMap[v])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(o,f,p){return(this.timingFunction(o)||o)*(p-f)+f}updateValue(o,f,p,v){if(this.progress===1)return f;if(this.progress===0)return p;const S=f;if(o.indexOf("color")!==-1){if(p===S)return p;if(v){const a=this.timingFunction(this.progress)||this.progress;return Zw(p,S,a)}return Zw(p,S,this.progress)}return v?this.applyEasing(this.progress,p,S):p+(S-p)*this.progress}updateValues(o,f,p){const v=Object.entries(f),S=v.length;for(let a=0;a<S;a++){const[m,_]=v[a];o[m]=this.updateValue(m,_.target,_.start,p)}}update(o){const{duration:f,loop:p,easing:v,stopMethod:S}=this.settings,{delayFor:a}=this;if(f===0&&a===0){this.emit("finished",{});return}if(this.delayFor>0){if(this.delayFor-=o,this.delayFor>=0)return;o=-this.delayFor,this.delayFor=0}if(f===0){this.emit("finished",{});return}if(this.progress===0&&this.emit("animating",{}),this.progress+=o/f,this.progress>1&&(this.progress=p?0:1,S)){this.emit("finished",{});return}if(this.propValuesMap.props!==void 0&&this.updateValues(this.node,this.propValuesMap.props,v),this.propValuesMap.shaderProps!==void 0&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,v),this.dynPropValuesMap!==void 0){const m=Object.keys(this.dynPropValuesMap),_=m.length;if(_>0)for(let I=0;I<_;I++){const M=m[I];this.updateValues(this.node.shader.props[M],this.dynPropValuesMap[M],v)}}this.progress===1&&this.emit("finished",{})}}class eM extends hr{constructor(o,f){super();N(this,"manager");N(this,"animation");N(this,"stoppedPromise");N(this,"stoppedResolve",null);N(this,"state");this.manager=o,this.animation=f,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this)}start(){return this.state!=="running"&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="running"),this}stop(){return this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating)}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(o=>{this.stoppedResolve=o}))}onFinished(){et(this.stoppedResolve);const{loop:o,stopMethod:f}=this.animation.settings;if(f==="reverse"){this.animation.once("finished",this.onFinished),this.animation.reverse();return}o||(this.unregisterAnimation(),this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this),this.state="stopped")}onAnimating(){this.emit("animating",this)}}var ai;(function(h){h[h.Init=0]="Init",h[h.OutOfBounds=2]="OutOfBounds",h[h.InBounds=4]="InBounds",h[h.InViewport=8]="InViewport"})(ai||(ai={}));const Ql=new Map;Ql.set(ai.Init,"init");Ql.set(ai.OutOfBounds,"outOfBounds");Ql.set(ai.InBounds,"inBounds");Ql.set(ai.InViewport,"inViewport");var Oe;(function(h){h[h.Children=1]="Children",h[h.ScaleRotate=2]="ScaleRotate",h[h.Local=4]="Local",h[h.Global=8]="Global",h[h.Clipping=16]="Clipping",h[h.CalculatedZIndex=32]="CalculatedZIndex",h[h.ZIndexSortedChildren=64]="ZIndexSortedChildren",h[h.PremultipliedColors=128]="PremultipliedColors",h[h.WorldAlpha=256]="WorldAlpha",h[h.RenderState=512]="RenderState",h[h.IsRenderable=1024]="IsRenderable",h[h.RenderTexture=2048]="RenderTexture",h[h.ParentRenderTexture=4096]="ParentRenderTexture",h[h.RenderBounds=8192]="RenderBounds",h[h.None=0]="None",h[h.All=8191]="All"})(Oe||(Oe={}));class W0 extends hr{constructor(o,f){super();N(this,"stage");N(this,"children",[]);N(this,"_id",FI());N(this,"props");N(this,"updateType",Oe.All);N(this,"childUpdateType",Oe.None);N(this,"globalTransform");N(this,"scaleRotateTransform");N(this,"localTransform");N(this,"renderCoords");N(this,"renderBound");N(this,"strictBound");N(this,"preloadBound");N(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1});N(this,"isRenderable",!1);N(this,"renderState",ai.Init);N(this,"worldAlpha",1);N(this,"premultipliedColorTl",0);N(this,"premultipliedColorTr",0);N(this,"premultipliedColorBl",0);N(this,"premultipliedColorBr",0);N(this,"calcZIndex",0);N(this,"hasRTTupdates",!1);N(this,"parentHasRenderTexture",!1);N(this,"onTextureLoaded",(o,f)=>{var p,v;this.autosizeNode(f),this.stage.requestRender(),this.parentHasRenderTexture&&this.setRTTUpdates(1),this.emit("loaded",{type:"texture",dimensions:f}),((v=(p=this.props.textureOptions)==null?void 0:p.resizeMode)==null?void 0:v.type)==="contain"&&this.setUpdateType(Oe.Local)});N(this,"onTextureFailed",(o,f)=>{this.emit("failed",{type:"texture",error:f})});N(this,"onTextureFreed",()=>{this.emit("freed",{type:"texture"})});this.stage=o,this.props={...f,parent:null,texture:null,src:null,rtt:!1},this.parent=f.parent,this.texture=f.texture,this.src=f.src,this.rtt=f.rtt,this.updateScaleRotateTransform(),this.setUpdateType(Oe.Local|Oe.RenderBounds|Oe.RenderState)}loadTexture(){const{texture:o}=this.props;et(o),queueMicrotask(()=>{o.preventCleanup=this.props.preventCleanup,this.textureOptions.preload&&o.ctxTexture.load(),o.state==="loaded"?(et(o.dimensions),this.onTextureLoaded(o,o.dimensions)):o.state==="failed"?(et(o.error),this.onTextureFailed(o,o.error)):o.state==="freed"&&this.onTextureFreed(o),o.on("loaded",this.onTextureLoaded),o.on("failed",this.onTextureFailed),o.on("freed",this.onTextureFreed)})}unloadTexture(){this.texture&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this,!1))}autosizeNode(o){this.autosize&&(this.width=o.width,this.height=o.height)}setUpdateType(o){this.updateType|=o;const f=this.props.parent;f!==null&&!(f.updateType&Oe.Children)&&f.setUpdateType(Oe.Children),this.parentHasRenderTexture&&this.setRTTUpdates(o)}sortChildren(){this.children.sort((o,f)=>o.calcZIndex-f.calcZIndex)}updateScaleRotateTransform(){const{rotation:o,scaleX:f,scaleY:p}=this.props;if(o===0&&f===1&&p===1){this.scaleRotateTransform=void 0;return}this.scaleRotateTransform=li.rotate(o,this.scaleRotateTransform).scale(f,p)}updateLocalTransform(){var _,I;const{x:o,y:f,width:p,height:v}=this.props,S=this.props.mountX*p,a=this.props.mountY*v;if(this.scaleRotateTransform){const M=this.props.pivotX*p,R=this.props.pivotY*v;this.localTransform=li.translate(o-S+M,f-a+R,this.localTransform).multiply(this.scaleRotateTransform).translate(-M,-R)}else this.localTransform=li.translate(o-S,f-a,this.localTransform);const m=this.props.texture;if(m&&m.dimensions&&((I=(_=this.props.textureOptions)==null?void 0:_.resizeMode)==null?void 0:I.type)==="contain"){let M=1,R=1,U=0,x=0;const{width:L,height:j}=m.dimensions,H=L/j,Y=p/v;if(H>Y){const Z=p/L,X=j*Z;x=(v-X)/2,R=X/v}else{const Z=v/j,X=L*Z;U=(p-X)/2,M=X/p}this.localTransform.translate(U,x).scale(M,R)}this.setUpdateType(Oe.Global)}update(o,f){var S;this.updateType&Oe.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(Oe.Local)),this.updateType&Oe.Local&&(this.updateLocalTransform(),this.setUpdateType(Oe.Global));const p=this.props.parent;let v=null;if(this.updateType&Oe.ParentRenderTexture){let a=this.parent;for(;a;)a.rtt&&(this.parentHasRenderTexture=!0),a=a.parent}if(this.updateType^Oe.All&&this.updateType&Oe.RenderTexture&&this.children.forEach(a=>{a.setUpdateType(Oe.All)}),this.updateType&Oe.Global&&(et(this.localTransform),this.globalTransform=li.copy((p==null?void 0:p.globalTransform)||this.localTransform,this.globalTransform),this.parentHasRenderTexture&&((S=this.props.parent)!=null&&S.rtt)&&(this.globalTransform=li.identity()),p&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(Oe.RenderState|Oe.Children),this.clipping===!0&&this.setUpdateType(Oe.Clipping),this.childUpdateType|=Oe.Global),this.updateType&Oe.RenderBounds&&(this.createRenderBounds(),this.setUpdateType(Oe.RenderState),this.setUpdateType(Oe.Children)),this.updateType&Oe.RenderState&&(v=this.checkRenderBounds(),this.setUpdateType(Oe.IsRenderable),v!==ai.OutOfBounds&&this.updateRenderState(v)),this.updateType&Oe.IsRenderable&&this.updateIsRenderable(),this.renderState!==ai.OutOfBounds){if(this.updateType&Oe.Clipping&&(this.calculateClippingRect(f),this.setUpdateType(Oe.Children),this.childUpdateType|=Oe.Clipping,this.childUpdateType|=Oe.RenderBounds),this.updateType&Oe.WorldAlpha&&(p?this.worldAlpha=p.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(Oe.Children|Oe.PremultipliedColors|Oe.IsRenderable),this.childUpdateType|=Oe.WorldAlpha),this.updateType&Oe.PremultipliedColors&&(this.premultipliedColorTl=kc(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=kc(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=kc(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=kc(this.props.colorBr,this.worldAlpha,!0))),p!==null&&this.updateType&Oe.CalculatedZIndex&&(this.calculateZIndex(),p.setUpdateType(Oe.ZIndexSortedChildren)),this.updateType&Oe.Children&&this.children.length>0&&this.rtt===!1)for(let a=0;a<this.children.length;a++){const m=this.children[a];m!==void 0&&(m.setUpdateType(this.childUpdateType),m.updateType!==0&&m.update(o,this.clippingRect))}this.updateType&Oe.ZIndexSortedChildren&&this.sortChildren(),v===ai.OutOfBounds&&this.updateRenderState(v),this.updateType=0,this.childUpdateType=0}}checkRenderProps(){return this.props.texture?!0:!this.props.width||!this.props.height?!1:!!(this.props.shader!==this.stage.defShaderCtr||this.props.clipping||this.props.color!==0||this.props.colorTop!==0||this.props.colorBottom!==0||this.props.colorLeft!==0||this.props.colorRight!==0||this.props.colorTl!==0||this.props.colorTr!==0||this.props.colorBl!==0||this.props.colorBr!==0)}checkRenderBounds(){return et(this.renderBound),et(this.strictBound),et(this.preloadBound),Qw(this.renderBound,this.strictBound)?ai.InViewport:Qw(this.renderBound,this.preloadBound)?ai.InBounds:XI(this.renderBound,this.strictBound)?ai.InViewport:this.parent!==null&&(this.props.width===0||this.props.height===0)?this.parent.renderState:ai.OutOfBounds}createPreloadBounds(o){const f=this.stage.boundsMargin;return Ys(o.x1-f[3],o.y1-f[0],o.x2+f[1],o.y2+f[2],this.preloadBound)}updateBoundingRect(){const{renderCoords:o,globalTransform:f}=this;et(f),et(o);const{tb:p,tc:v}=f,{x1:S,y1:a,x3:m,y3:_}=o;if(p===0||v===0)this.renderBound=Ys(S,a,m,_,this.renderBound);else{const{x2:I,x4:M,y2:R,y4:U}=o;this.renderBound=Ys(Math.min(S,I,m,M),Math.min(a,R,_,U),Math.max(S,I,m,M),Math.max(a,R,_,U),this.renderBound)}}createRenderBounds(){if(et(this.stage),this.clipping===!1)if(this.parent!==null){this.strictBound=this.parent.strictBound??Ys(0,0,this.stage.root.width,this.stage.root.height),this.preloadBound=this.parent.preloadBound??this.createPreloadBounds(this.strictBound);return}else{this.strictBound=Ys(0,0,this.stage.root.width,this.stage.root.height),this.preloadBound=this.createPreloadBounds(this.strictBound);return}const{x:o,y:f,width:p,height:v}=this.props,{tx:S,ty:a}=this.globalTransform||{},m=S??o,_=a??f;this.strictBound=Ys(m,_,m+p,_+v,this.strictBound),this.preloadBound=this.createPreloadBounds(this.strictBound)}updateRenderState(o){if(o===this.renderState)return;const f=this.renderState;this.renderState=o;const p=Ql.get(o);et(p),this.emit(p,{previous:f,current:o})}updateIsRenderable(){let o;this.worldAlpha===0||!this.checkRenderProps()?o=!1:o=this.renderState>ai.OutOfBounds,this.isRenderable!==o&&(this.isRenderable=o,this.onChangeIsRenderable(o))}onChangeIsRenderable(o){var f;(f=this.texture)==null||f.setRenderableOwner(this,o)}calculateRenderCoords(){const{width:o,height:f,globalTransform:p}=this;et(p);const{tx:v,ty:S,ta:a,tb:m,tc:_,td:I}=p;if(m===0&&_===0){const M=v,R=v+o*a,U=S,x=S+f*I;this.renderCoords=Zc.translate(M,U,R,U,R,x,M,x,this.renderCoords)}else this.renderCoords=Zc.translate(v,S,v+o*a,S+o*_,v+o*a+f*m,S+o*_+f*I,v+f*m,S+f*I,this.renderCoords)}calculateClippingRect(o){et(this.globalTransform);const{clippingRect:f,props:p,globalTransform:v}=this,{clipping:S}=p,a=v.tb!==0||v.tc!==0;S===!0&&a===!1?(f.x=v.tx,f.y=v.ty,f.width=this.width*v.ta,f.height=this.height*v.td,f.valid=!0):f.valid=!1,o.valid===!0&&f.valid===!0?OS(o,f,f):o.valid===!0&&(US(o,f),f.valid=!0)}calculateZIndex(){var S,a;const o=this.props,f=o.zIndex||0,p=((S=o.parent)==null?void 0:S.zIndex)||0;let v=f;(a=o.parent)!=null&&a.zIndexLocked&&(v=f<p?f:p),this.calcZIndex=v}destroy(){this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,delete this.renderCoords,delete this.renderBound,delete this.strictBound,delete this.preloadBound,delete this.globalTransform,delete this.scaleRotateTransform,delete this.localTransform,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;const o=[...this.children];for(let f=0;f<o.length;f++)o[f].destroy();this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}renderQuads(o){const{texture:f,width:p,height:v,textureOptions:S,rtt:a,shader:m}=this.props;if(this.parentHasRenderTexture&&(!o.renderToTextureActive||this.parentRenderTexture!==o.activeRttNode))return;const{premultipliedColorTl:_,premultipliedColorTr:I,premultipliedColorBl:M,premultipliedColorBr:R}=this,{zIndex:U,worldAlpha:x,globalTransform:L,clippingRect:j,renderCoords:H}=this;et(L),et(H),o.addQuad({width:p,height:v,colorTl:_,colorTr:I,colorBl:M,colorBr:R,texture:f,textureOptions:S,zIndex:U,shader:m.shader,shaderProps:m.getResolvedProps(),alpha:x,clippingRect:j,tx:L.tx,ty:L.ty,ta:L.ta,tb:L.tb,tc:L.tc,td:L.td,renderCoords:H,rtt:a,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions})}get id(){return this._id}get data(){return this.props.data}set data(o){this.props.data=o}get x(){return this.props.x}set x(o){this.props.x!==o&&(this.props.x=o,this.setUpdateType(Oe.Local))}get absX(){var o,f,p;return this.props.x+-this.props.width*this.props.mountX+(((o=this.props.parent)==null?void 0:o.absX)||((p=(f=this.props.parent)==null?void 0:f.globalTransform)==null?void 0:p.tx)||0)}get absY(){var o;return this.props.y+-this.props.height*this.props.mountY+(((o=this.props.parent)==null?void 0:o.absY)??0)}get y(){return this.props.y}set y(o){this.props.y!==o&&(this.props.y=o,this.setUpdateType(Oe.Local))}get width(){return this.props.width}set width(o){this.props.width!==o&&(this.props.width=o,this.setUpdateType(Oe.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(Oe.RenderTexture)))}get height(){return this.props.height}set height(o){this.props.height!==o&&(this.props.height=o,this.setUpdateType(Oe.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(Oe.RenderTexture)))}get scale(){return this.scaleX}set scale(o){this.scaleX=o,this.scaleY=o}get scaleX(){return this.props.scaleX}set scaleX(o){this.props.scaleX!==o&&(this.props.scaleX=o,this.setUpdateType(Oe.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(o){this.props.scaleY!==o&&(this.props.scaleY=o,this.setUpdateType(Oe.ScaleRotate))}get mount(){return this.props.mount}set mount(o){(this.props.mountX!==o||this.props.mountY!==o)&&(this.props.mountX=o,this.props.mountY=o,this.props.mount=o,this.setUpdateType(Oe.Local))}get mountX(){return this.props.mountX}set mountX(o){this.props.mountX!==o&&(this.props.mountX=o,this.setUpdateType(Oe.Local))}get mountY(){return this.props.mountY}set mountY(o){this.props.mountY!==o&&(this.props.mountY=o,this.setUpdateType(Oe.Local))}get pivot(){return this.props.pivot}set pivot(o){(this.props.pivotX!==o||this.props.pivotY!==o)&&(this.props.pivotX=o,this.props.pivotY=o,this.props.pivot=o,this.setUpdateType(Oe.Local))}get pivotX(){return this.props.pivotX}set pivotX(o){this.props.pivotX!==o&&(this.props.pivotX=o,this.setUpdateType(Oe.Local))}get pivotY(){return this.props.pivotY}set pivotY(o){this.props.pivotY!==o&&(this.props.pivotY=o,this.setUpdateType(Oe.Local))}get rotation(){return this.props.rotation}set rotation(o){this.props.rotation!==o&&(this.props.rotation=o,this.setUpdateType(Oe.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(o){this.props.alpha=o,this.setUpdateType(Oe.PremultipliedColors|Oe.WorldAlpha|Oe.Children),this.childUpdateType|=Oe.Global}get autosize(){return this.props.autosize}set autosize(o){this.props.autosize=o}get clipping(){return this.props.clipping}set clipping(o){this.props.clipping=o,this.setUpdateType(Oe.Clipping|Oe.RenderBounds|Oe.Children),this.childUpdateType|=Oe.Global|Oe.Clipping}get color(){return this.props.color}set color(o){this.colorTop=o,this.colorBottom=o,this.colorLeft=o,this.colorRight=o,this.props.color=o,this.setUpdateType(Oe.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(o){(this.props.colorTl!==o||this.props.colorTr!==o)&&(this.colorTl=o,this.colorTr=o),this.props.colorTop=o,this.setUpdateType(Oe.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(o){(this.props.colorBl!==o||this.props.colorBr!==o)&&(this.colorBl=o,this.colorBr=o),this.props.colorBottom=o,this.setUpdateType(Oe.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(o){(this.props.colorTl!==o||this.props.colorBl!==o)&&(this.colorTl=o,this.colorBl=o),this.props.colorLeft=o,this.setUpdateType(Oe.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(o){(this.props.colorTr!==o||this.props.colorBr!==o)&&(this.colorTr=o,this.colorBr=o),this.props.colorRight=o,this.setUpdateType(Oe.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(o){this.props.colorTl=o,this.setUpdateType(Oe.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(o){this.props.colorTr=o,this.setUpdateType(Oe.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(o){this.props.colorBl=o,this.setUpdateType(Oe.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(o){this.props.colorBr=o,this.setUpdateType(Oe.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(o){this.props.zIndexLocked=o,this.setUpdateType(Oe.CalculatedZIndex|Oe.Children),this.children.forEach(f=>{f.setUpdateType(Oe.CalculatedZIndex)})}get zIndex(){return this.props.zIndex}set zIndex(o){this.props.zIndex=o,this.setUpdateType(Oe.CalculatedZIndex|Oe.Children),this.children.forEach(f=>{f.setUpdateType(Oe.CalculatedZIndex)})}get parent(){return this.props.parent}set parent(o){const f=this.props.parent;if(f!==o){if(this.props.parent=o,f){const p=f.children.indexOf(this);et(p!==-1,"CoreNode.parent: Node not found in old parent's children!"),f.children.splice(p,1),f.setUpdateType(Oe.Children|Oe.ZIndexSortedChildren)}o&&(o.children.push(this),this.setUpdateType(Oe.All),o.setUpdateType(Oe.Children|Oe.ZIndexSortedChildren),(o.rtt||o.parentHasRenderTexture)&&this.setRTTUpdates(Oe.All)),this.updateScaleRotateTransform(),this.setUpdateType(Oe.RenderBounds|Oe.Children)}}get preventCleanup(){return this.props.preventCleanup}set preventCleanup(o){this.props.preventCleanup=o}get rtt(){return this.props.rtt}set rtt(o){var f,p;if(this.props.rtt===!0&&(this.props.rtt=o,o===!1&&this.texture!==null)){this.unloadTexture(),this.setUpdateType(Oe.All),this.children.forEach(v=>{v.parentHasRenderTexture=!1}),(f=this.stage.renderer)==null||f.removeRTTNode(this);return}o!==!1&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.props.rtt=!0,this.hasRTTupdates=!0,this.setUpdateType(Oe.All),this.children.forEach(v=>{v.setUpdateType(Oe.All)}),(p=this.stage.renderer)==null||p.renderToTexture(this))}get shader(){return this.props.shader}set shader(o){this.props.shader!==o&&(this.props.shader=o,this.setUpdateType(Oe.IsRenderable))}get src(){return this.props.src}set src(o){if(this.props.src!==o){if(this.props.src=o,!o){this.texture=null;return}this.texture=this.stage.txManager.loadTexture("ImageTexture",{src:o,width:this.props.width,height:this.props.height,type:this.props.imageType,sx:this.props.srcX,sy:this.props.srcY,sw:this.props.srcWidth,sh:this.props.srcHeight})}}set imageType(o){this.props.imageType!==o&&(this.props.imageType=o)}get imageType(){return this.props.imageType||null}get srcHeight(){return this.props.srcHeight}set srcHeight(o){this.props.srcHeight=o}get srcWidth(){return this.props.srcWidth}set srcWidth(o){this.props.srcWidth=o}get srcX(){return this.props.srcX}set srcX(o){this.props.srcX=o}get srcY(){return this.props.srcY}set srcY(o){this.props.srcY=o}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){let o=this.parent;for(;o;){if(o.rtt)return o;o=o.parent}return null}get texture(){return this.props.texture}set texture(o){if(this.props.texture===o)return;const f=this.props.texture;f&&(f.setRenderableOwner(this,!1),this.unloadTexture()),this.props.texture=o,o&&(o.setRenderableOwner(this,this.isRenderable),this.loadTexture()),this.setUpdateType(Oe.IsRenderable)}set textureOptions(o){this.props.textureOptions=o}get textureOptions(){return this.props.textureOptions}setRTTUpdates(o){var f;this.hasRTTupdates=!0,(f=this.parent)==null||f.setRTTUpdates(o)}animate(o,f){const p=new JI(this,o,f);return new eM(this.stage.animationManager,p)}flush(){}}const tM=h=>{let r=!1;const o=()=>{if(h.updateFrameTime(),h.updateAnimations(),!h.hasSceneUpdates()){h.calculateFps(),setTimeout(o,16.666666666666668),r||(h.txMemManager.checkCleanup()&&h.txMemManager.cleanup(),h.eventBus.emit("idle"),r=!0),h.flushFrameEvents();return}r=!1,h.drawFrame(),h.flushFrameEvents(),requestAnimationFrame(o)};requestAnimationFrame(o)},nM=()=>performance?performance.now():Date.now();class iM{constructor(){N(this,"activeAnimations",new Set)}registerAnimation(r){this.activeAnimations.add(r)}unregisterAnimation(r){this.activeAnimations.delete(r)}update(r){this.activeAnimations.forEach(o=>{o.update(r)})}}class ca extends hr{constructor(o){super();N(this,"txManager");N(this,"dimensions",null);N(this,"error",null);N(this,"state","freed");N(this,"renderableOwners",new Set);N(this,"renderable",!1);N(this,"lastRenderableChangeTime",0);N(this,"preventCleanup",!1);this.txManager=o}setRenderableOwner(o,f){var v,S;const p=this.renderableOwners.size;if(f){this.renderableOwners.add(o);const a=this.renderableOwners.size;a>p&&a===1&&(this.renderable=!0,this.lastRenderableChangeTime=this.txManager.frameTime,(v=this.onChangeIsRenderable)==null||v.call(this,!0))}else{this.renderableOwners.delete(o);const a=this.renderableOwners.size;a<p&&a===0&&(this.renderable=!1,this.lastRenderableChangeTime=this.txManager.frameTime,(S=this.onChangeIsRenderable)==null||S.call(this,!1))}}get ctxTexture(){const o=this.txManager.renderer.createCtxTexture(this);return Object.defineProperty(this,"ctxTexture",{value:o}),o}setState(o,...f){if(this.state!==o){if(this.state=o,o==="loaded"){const p=f;this.dimensions=p[0]}else if(o==="failed"){const p=f;this.error=p[0]}this.emit(o,...f)}}static makeCacheKey(o){return!1}static resolveDefaults(o){return{}}}function oM(){function h(o){return o.indexOf("image/png")!==-1}function r(o,f,p,v,S,a){return new Promise(function(m,_){var I=new XMLHttpRequest;I.open("GET",o,!0),I.responseType="blob",I.onload=function(){if(I.status!==200)return _(new Error("Failed to load image: "+I.statusText));var M=I.response,R=f!==void 0?f:h(M.type);if(S!==null&&a!==null){createImageBitmap(M,p||0,v||0,S,a,{premultiplyAlpha:R?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}).then(function(U){m({data:U,premultiplyAlpha:f})}).catch(function(U){_(U)});return}createImageBitmap(M,{premultiplyAlpha:R?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}).then(function(U){m({data:U,premultiplyAlpha:f})}).catch(function(U){_(U)})},I.onerror=function(){_(new Error("Network error occurred while trying to fetch the image."))},I.send()})}self.onmessage=o=>{var f=o.data.src,p=o.data.id,v=o.data.premultiplyAlpha,S=o.data.sx,a=o.data.sy,m=o.data.sw,_=o.data.sh;r(f,v,S,a,m,_).then(function(I){self.postMessage({id:p,src:f,data:I})}).catch(function(I){self.postMessage({id:p,src:f,error:I.message})})}}class rM{constructor(r){N(this,"imageWorkersEnabled",!0);N(this,"messageManager",{});N(this,"workers",[]);N(this,"workerIndex",0);N(this,"nextId",0);this.workers=this.createWorkers(r),this.workers.forEach(o=>{o.onmessage=this.handleMessage.bind(this)})}handleMessage(r){const{id:o,data:f,error:p}=r.data,v=this.messageManager[o];if(v){const[S,a]=v;delete this.messageManager[o],p?a(new Error(p)):S(f)}}createWorkers(r=1){const o=`(${oM.toString()})()`,f=new Blob([o.replace('"use strict";',"")],{type:"application/javascript"}),p=(self.URL?URL:webkitURL).createObjectURL(f),v=[];for(let S=0;S<r;S++)v.push(new Worker(p));return v}getNextWorker(){const r=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,r}getImage(r,o,f,p,v,S){return new Promise((a,m)=>{try{if(this.workers){const _=this.nextId++;this.messageManager[_]=[a,m];const I=this.getNextWorker();I&&I.postMessage({id:_,src:r,premultiplyAlpha:o,sx:f,sy:p,sw:v,sh:S})}}catch(_){m(_)}})}}const Xl=class Xl extends ca{constructor(o,f){super(o);N(this,"props");this.props=Xl.resolveDefaults(f||{})}get color(){return this.props.color}set color(o){this.props.color=o}async getTextureData(){const o=new Uint32Array([this.color]),f=new Uint8ClampedArray(o.buffer);return{data:new ImageData(f,1,1),premultiplyAlpha:!0}}static makeCacheKey(o){return`ColorTexture,${Xl.resolveDefaults(o).color}`}static resolveDefaults(o){return{color:o.color||4294967295}}};N(Xl,"z$__type__Props");let Qc=Xl;function sM(h){return/\.(ktx|pvr)$/.test(h)}const tS=async h=>{const o=await(await fetch(h)).arrayBuffer();return h.indexOf(".ktx")!==-1?aM(o):lM(o)},aM=async h=>{const r=new DataView(h),o=r.getUint32(12)===16909060,f=[],p={glInternalFormat:r.getUint32(28,o),pixelWidth:r.getUint32(36,o),pixelHeight:r.getUint32(40,o),numberOfMipmapLevels:r.getUint32(56,o),bytesOfKeyValueData:r.getUint32(60,o)};let v=64;v+=p.bytesOfKeyValueData;for(let S=0;S<p.numberOfMipmapLevels;S++){const a=r.getUint32(v);v+=4,f.push(r.buffer.slice(v,a)),v+=a}return{data:{glInternalFormat:p.glInternalFormat,mipmaps:f,width:p.pixelWidth||0,height:p.pixelHeight||0,type:"ktx"},premultiplyAlpha:!1}},lM=async h=>{const a=h,m=new Int32Array(a,0,13),_=m[12]+52,I=new Uint8Array(a,_),M=[],R={pixelWidth:m[7],pixelHeight:m[6],numberOfMipmapLevels:m[11]||0};let U=0,x=R.pixelWidth||0,L=R.pixelHeight||0;for(let j=0;j<R.numberOfMipmapLevels;j++){const H=(x+3>>2)*(L+3>>2)*8,Y=new Uint8Array(a,I.byteOffset+U,H);M.push(Y),U+=H,x=x>>1,L=L>>1}return{data:{glInternalFormat:36196,mipmaps:M,width:R.pixelWidth||0,height:R.pixelHeight||0,type:"pvr"},premultiplyAlpha:!1}};function uM(h){return/\.(svg)$/.test(h)}const nS=(h,r,o,f,p,v,S)=>new Promise((a,m)=>{const _=document.createElement("canvas"),I=_.getContext("2d");et(I),I.imageSmoothingEnabled=!0;const M=new Image;M.onload=()=>{const R=f??0,U=p??0,x=r||M.width,L=o||M.height;_.width=x,_.height=L,I.drawImage(M,0,0,x,L),a({data:I.getImageData(R,U,v??x,S??L),premultiplyAlpha:!1})},M.onerror=R=>{m(R)},M.src=h}),Wl=class Wl extends ca{constructor(o,f){super(o);N(this,"props");this.props=Wl.resolveDefaults(f)}hasAlphaChannel(o){return o.indexOf("image/png")!==-1}async loadImage(o){const{premultiplyAlpha:f,sx:p,sy:v,sw:S,sh:a,width:m,height:_}=this.props;if(this.txManager.imageWorkerManager!==null)return await this.txManager.imageWorkerManager.getImage(o,f,p,v,S,a);if(this.txManager.hasCreateImageBitmap===!0){const M=await(await fetch(o)).blob(),R=f??this.hasAlphaChannel(M.type);return S!==null&&a!==null?{data:await createImageBitmap(M,p??0,v??0,S,a,{premultiplyAlpha:R?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:R}:{data:await createImageBitmap(M,{premultiplyAlpha:R?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:R}}else{const I=new Image(m||void 0,_||void 0);return o.substr(0,5)!=="data:"&&(I.crossOrigin="Anonymous"),I.src=o,await new Promise((M,R)=>{I.onload=()=>M(),I.onerror=()=>R(new Error("Failed to load image"))}).catch(M=>{console.error(M)}),{data:I,premultiplyAlpha:f??!0}}}async getTextureData(){const{src:o,premultiplyAlpha:f,type:p}=this.props;if(o===null)return{data:null};if(typeof o!="string")return o instanceof ImageData?{data:o,premultiplyAlpha:f}:{data:o(),premultiplyAlpha:f};const v=qI(o);return p==="regular"?this.loadImage(v):p==="svg"?nS(v,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):uM(o)===!0?nS(v,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):p==="compressed"||sM(o)===!0?tS(v):this.loadImage(v)}static makeCacheKey(o){const f=Wl.resolveDefaults(o),p=f.key||f.src;if(typeof p!="string")return!1;let v="";return f.sh!==null&&f.sw!==null&&(v+=",",v+=f.sx??"",v+=f.sy??"",v+=f.sw||"",v+=f.sh||""),`ImageTexture,${p},${f.premultiplyAlpha??"true"}${v}`}static resolveDefaults(o){return{src:o.src??"",premultiplyAlpha:o.premultiplyAlpha??!0,key:o.key??null,type:o.type??null,width:o.width??null,height:o.height??null,sx:o.sx??null,sy:o.sy??null,sw:o.sw??null,sh:o.sh??null}}};N(Wl,"z$__type__Props");let Jc=Wl;const ql=class ql extends ca{constructor(o,f){super(o);N(this,"props");this.props=ql.resolveDefaults(f)}async getTextureData(){const{width:o,height:f}=this.props,p=o*f*4,v=new Uint8ClampedArray(p);for(let S=0;S<p;S+=4){const a=Math.floor(Math.random()*256);v[S]=a,v[S+1]=a,v[S+2]=a,v[S+3]=255}return{data:new ImageData(v,o,f)}}static makeCacheKey(o){if(o.cacheId===void 0)return!1;const f=ql.resolveDefaults(o);return`NoiseTexture,${f.width},${f.height},${f.cacheId}`}static resolveDefaults(o){return{width:o.width??128,height:o.height??128,cacheId:o.cacheId??0}}};N(ql,"z$__type__Props");let q0=ql;const rh=class rh extends ca{constructor(o,f){super(o);N(this,"props");N(this,"parentTexture");N(this,"onParentTxLoaded",()=>{this.setState("loaded",{width:this.props.width,height:this.props.height})});N(this,"onParentTxFailed",(o,f)=>{this.setState("failed",f)});this.props=rh.resolveDefaults(f||{}),this.parentTexture=this.props.texture,queueMicrotask(()=>{const p=this.parentTexture;p.state==="loaded"?this.onParentTxLoaded(p,p.dimensions):p.state==="failed"&&this.onParentTxFailed(p,p.error),p.on("loaded",this.onParentTxLoaded),p.on("failed",this.onParentTxFailed)})}onChangeIsRenderable(o){this.parentTexture.setRenderableOwner(this,o)}async getTextureData(){return{data:this.props}}static makeCacheKey(o){return!1}static resolveDefaults(o){return{texture:o.texture,x:o.x||0,y:o.y||0,width:o.width||0,height:o.height||0}}};N(rh,"z$__type__Props");let fa=rh;const sh=class sh extends ca{constructor(o,f){super(o);N(this,"props");this.props=sh.resolveDefaults(f||{})}get width(){return this.props.width}set width(o){this.props.width=o}get height(){return this.props.height}set height(o){this.props.height=o}async getTextureData(){return{data:null,premultiplyAlpha:null}}static resolveDefaults(o){return{width:o.width||256,height:o.height||256}}};N(sh,"z$__type__Props");let Yl=sh;class fM{constructor(r){N(this,"keyCache",new Map);N(this,"inverseKeyCache",new WeakMap);N(this,"txConstructors",{});N(this,"imageWorkerManager",null);N(this,"hasCreateImageBitmap",!!self.createImageBitmap);N(this,"hasWorker",!!self.Worker);N(this,"renderer");N(this,"frameTime",0);this.hasCreateImageBitmap&&this.hasWorker&&r>0&&(this.imageWorkerManager=new rM(r)),this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.registerTextureType("ImageTexture",Jc),this.registerTextureType("ColorTexture",Qc),this.registerTextureType("NoiseTexture",q0),this.registerTextureType("SubTexture",fa),this.registerTextureType("RenderTexture",Yl)}registerTextureType(r,o){this.txConstructors[r]=o}loadTexture(r,o){let f;const p=this.txConstructors[r];if(!p)throw new Error(`Texture type "${r}" is not registered`);if(!f){const v=p.makeCacheKey(o);v&&this.keyCache.has(v)?f=this.keyCache.get(v):(f=new p(this,o),v&&this.initTextureToCache(f,v))}return f}initTextureToCache(r,o){const{keyCache:f,inverseKeyCache:p}=this;f.set(o,r),p.set(r,o)}removeTextureFromCache(r){const{inverseKeyCache:o,keyCache:f}=this,p=o.get(r);p&&f.delete(p)}}const P0=new Map,cM={normal:400,bold:700,bolder:900,lighter:100},iS=h=>typeof h=="number"?h:cM[h]||400;function hM(h,r,o,f,p){let v=iS(o);for(const S of h){const a=S[r];if(!a)continue;if(a.size===1)return console.warn(`TrFontManager: Only one font face found for family: '${r}' - will be used for all weights and styles`),a.values().next().value;const m=new Map;for(const I of a){const M=iS(I.descriptors.weight);if(M===v&&I.descriptors.style===f&&I.descriptors.stretch===p)return I;m.set(M,I)}const _=`TrFontManager: No exact match: '${r} Weight: ${v} Style: ${f} Stretch: ${p}'`;if(console.error(_),v===400&&m.has(500))return m.get(500);if(v===500&&m.has(400))return m.get(400);if(v<400){for(;v>0;){if(m.has(v))return m.get(v);v-=100}v=600}for(;v<1e3;){if(m.has(v))return m.get(v);v+=100}for(v=500;v>0;){if(m.has(v))return m.get(v);v-=100}}}class ug{constructor(r){N(this,"textRenderers");this.textRenderers=r}addFontFace(r){for(const o in this.textRenderers){const f=this.textRenderers[o];f&&f.isFontFaceSupported(r)&&f.addFontFace(r)}}static resolveFontFace(r,o){const{fontFamily:f,fontWeight:p,fontStyle:v,fontStretch:S}=o,a=`${f}${v}${p}${S}`;if(P0.has(a)===!0)return P0.get(a);const m=hM(r,f,p,v,S);return m!==void 0&&P0.set(a,m),m}}class jS{static makeCacheKey(r){return!1}static resolveDefaults(r){return{}}}function oS(h,r,o){const f=h.createShader(r);if(!f)throw new Error;if(h.shaderSource(f,o),h.compileShader(f),h.getShaderParameter(f,h.COMPILE_STATUS))return f;console.log(h.getShaderInfoLog(f)),h.deleteShader(f)}function dM(h,r,o){const f=h.createProgram();if(!f)throw new Error;if(h.attachShader(f,r),h.attachShader(f,o),h.linkProgram(f),h.getProgramParameter(f,h.LINK_STATUS))return f;console.log(h.getProgramInfoLog(f)),h.deleteProgram(f)}class dr extends jS{constructor(o){super();N(this,"boundBufferCollection",null);N(this,"buffersBound",!1);N(this,"program");N(this,"vao");N(this,"renderer");N(this,"glw");N(this,"attributeBuffers");N(this,"attributeLocations");N(this,"attributeNames");N(this,"uniformLocations");N(this,"uniformTypes");N(this,"supportsIndexedTextures");const f=this.renderer=o.renderer,p=this.glw=this.renderer.glw;this.supportsIndexedTextures=o.supportsIndexedTextures||!1;const v=p.isWebGl2(),S=v&&o.webgl2Extensions||!v&&o.webgl1Extensions||[],a=v?"2.0":"1.0";S.forEach(L=>{if(!p.getExtension(L))throw new Error(`Shader "${this.constructor.name}" requires extension "${L}" for WebGL ${a} but wasn't found`)});const m=o.shaderSources||this.constructor.shaderSources;if(m)v&&(m!=null&&m.webGl2)&&(m.fragment=m.webGl2.fragment,m.vertex=m.webGl2.vertex,delete m.webGl2);else throw new Error(`Shader "${this.constructor.name}" is missing shaderSources.`);const _=f.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,I=m.vertex instanceof Function?m.vertex(_):m.vertex,M=m.fragment instanceof Function?m.fragment(_):m.fragment,R=oS(p,p.VERTEX_SHADER,I),U=oS(p,p.FRAGMENT_SHADER,M);if(!R||!U)throw new Error;const x=dM(p,R,U);if(!x)throw new Error;if(this.program=x,v){const L=p.createVertexArray();if(!L)throw new Error;this.vao=L,p.bindVertexArray(this.vao)}this.attributeLocations={},this.attributeBuffers={},this.attributeNames=[],[...o.attributes].forEach(L=>{const j=p.getAttribLocation(this.program,L);if(j<0)throw new Error(`${this.constructor.name}: Vertex shader must have an attribute "${L}"!`);const H=p.createBuffer();if(!H)throw new Error(`${this.constructor.name}: Could not create buffer for attribute "${L}"`);this.attributeLocations[L]=j,this.attributeBuffers[L]=H,this.attributeNames.push(L)}),this.uniformLocations={},this.uniformTypes={},o.uniforms.forEach(L=>{const j=p.getUniformLocation(this.program,L.name);if(this.uniformTypes[L.name]=L.uniform,!j){console.warn(`Shader "${this.constructor.name}" could not get uniform location for "${L.name}"`);return}this.uniformLocations[L.name]=j})}bindBufferAttribute(o,f,p){const{glw:v}=this;v.enableVertexAttribArray(o),v.vertexAttribPointer(f,o,p.size,p.type,p.normalized,p.stride,p.offset)}disableAttribute(o){this.glw.disableVertexAttribArray(o)}disableAttributes(){for(const o in this.attributeLocations)this.disableAttribute(this.attributeLocations[o]);this.boundBufferCollection=null}canBatchShaderProps(o,f){return!1}bindRenderOp(o,f){this.bindBufferCollection(o.buffers),o.textures.length>0&&this.bindTextures(o.textures);const{glw:p,parentHasRenderTexture:v,renderToTexture:S}=o;if(!(S&&v)){if(v){const{width:a,height:m}=o.framebufferDimensions||{};this.setUniform("u_pixelRatio",1),this.setUniform("u_resolution",new Float32Array([a??0,m??0]))}else this.setUniform("u_pixelRatio",o.options.pixelRatio),this.setUniform("u_resolution",new Float32Array([p.canvas.width,p.canvas.height]));if(f){if(Kc(f,"$dimensions")){let a=f.$dimensions;a||(a=o.dimensions),this.setUniform("u_dimensions",[a.width,a.height])}if(Kc(f,"$alpha")){let a=f.$alpha;a||(a=o.alpha),this.setUniform("u_alpha",a)}this.bindProps(f)}}}setUniform(o,...f){this.glw.setUniform(this.uniformTypes[o],this.uniformLocations[o],...f)}bindBufferCollection(o){if(this.boundBufferCollection!==o){for(const f in this.attributeLocations){const p=o.getBuffer(f),v=o.getAttributeInfo(f);et(p,`Buffer for "${f}" not found`),et(v),this.bindBufferAttribute(this.attributeLocations[f],p,v)}this.boundBufferCollection=o}}bindProps(o){}bindTextures(o){}attach(){this.glw.useProgram(this.program),this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}N(dr,"shaderSources");class FS extends dr{constructor(r){super({renderer:r,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(r){const{glw:o}=this;o.activeTexture(0),o.bindTexture(r[0].ctxTexture)}}N(FS,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;


      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio;
        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);

        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);
        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
          vec4 color = texture2D(u_texture, v_textureCoordinate);
          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);
      }
    `});class $S extends dr{constructor(o){super({renderer:o,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});N(this,"supportsIndexedTextures",!0)}bindTextures(o){const{renderer:f,glw:p}=this;if(o.length>f.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${f.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);o.forEach((S,a)=>{p.activeTexture(a),p.bindTexture(S.ctxTexture)});const v=Array.from(Array(o.length).keys());this.setUniform("u_textures[0]",v)}}N($S,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_textureCoordinate;
      attribute vec2 a_position;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      void main(){
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;
        v_textureIndex = a_textureIndex;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:o=>`
      #define txUnits ${o}
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_image;
      uniform sampler2D u_textures[txUnits];

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      vec4 sampleFromTexture(sampler2D textures[${o}], int idx, vec2 uv) {
        ${Array.from(Array(o).keys()).map(f=>`
          ${f!==0?"else ":""}if (idx == ${f}) {
            return texture2D(textures[${f}], uv);
          }
        `).join("")}
        return texture2D(textures[0], uv);
      }

      void main(){
        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);
      }
    `});class Mn{constructor(r){N(this,"priority",1);N(this,"name","");N(this,"ref");N(this,"target");N(this,"passParameters","");N(this,"declaredUniforms","");N(this,"uniformInfo",{});const{ref:o,target:f,props:p={}}=r;this.ref=o,this.target=f;const v={},S=[];let a="";const m=this.constructor.uniforms||{};for(const _ in m){const I=m[_],M=I.type,R=`${o}_${_}`;let U="";I.size&&(U=`[${I.size(p)}]`),S.push(R),a+=`uniform ${M} ${R}${U};`,v[_]={name:R,uniform:m[_].method}}this.passParameters=S.join(","),this.declaredUniforms=a,this.uniformInfo=v}static getEffectKey(r){return""}static getMethodParameters(r,o){const f=[];for(const p in r){const v=r[p];let S="";v.size&&(S=`[${v.size(o)}]`),f.push(`${v.type} ${p}${S}`)}return f.join(",")}static resolveDefaults(r){return{}}static makeEffectKey(r){return!1}}N(Mn,"uniforms",{}),N(Mn,"methods"),N(Mn,"onShaderMask"),N(Mn,"onColorize"),N(Mn,"onEffectMask");const D0=new Map,pM=(h,r)=>{const o=JSON.stringify(h);if(D0.has(o))return D0.get(o);h=h??[];const f=[],p=h.length;let v=0;for(;v<p;v++){const{name:S,type:a,props:m}=h[v],_={name:S,type:a,props:{}},I=r[a],M=I.resolveDefaults(m),R=I.uniforms,U=Object.keys(R),x=U.length;let L=0;for(;L<x;L++){const j=U[L],H=R[j],Y={value:M[j],programValue:void 0,updateOnBind:H.updateOnBind||!1,hasValidator:H.validator!==void 0,hasProgramValueUpdater:H.updateProgramValue!==void 0},Z=Y.hasValidator&&H.validator(M[j],M)||M[j];M[j]!==Z&&(Y.validatedValue=Z),Y.hasProgramValueUpdater&&H.updateProgramValue(Y),Y.programValue===void 0&&(Y.programValue=Y.value),_.props[j]=Y}f.push(_)}return D0.set(o,f),f},Vo=class Vo extends dr{constructor(o,f,p){const v=Vo.createShader(f,p);super({renderer:o,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...v.uniforms],shaderSources:{vertex:v.vertex,fragment:v.fragment}});N(this,"effects",[]);this.effects=v.effects}bindTextures(o){const{glw:f}=this;f.activeTexture(0),f.bindTexture(o[0].ctxTexture)}bindProps(o){var S;const f=o.effects,p=f.length;let v=0;for(;v<p;v++){const a=f[v],m=this.effects[v].uniformInfo,_=Object.keys(a.props),I=_.length;let M=0;for(;M<I;M++){const R=_[M];if(a.props[R].updateOnBind===!0){const x=(S=this.renderer.shManager.getRegisteredEffects()[a.type])==null?void 0:S.uniforms[R];x==null||x.updateProgramValue(a.props[R],o)}this.setUniform(m[R].name,a.props[R].programValue)}}}canBatchShaderProps(o,f){if(o.$alpha!==f.$alpha||o.$dimensions.width!==f.$dimensions.width||o.$dimensions.height!==f.$dimensions.height||o.effects.length!==f.effects.length)return!1;const p=o.effects.length;let v=0;for(;v<p;v++){const S=o.effects[v],a=f.effects[v];if(S.type!==a.type)return!1;for(const m in S.props)if(a.props&&!a.props[m]||S.props[m].value!==a.props[m].value)return!1}return!0}static createShader(o,f){const p={},v={};let S="";const a=[],m=[],_=o.effects.map(x=>{const L=f[x.type],j=L.getEffectKey(x.props||{});p[j]=p[j]?++p[j]:1;const H=p[j];H===1&&m.push({key:j,type:x.type,props:x.props});const Y=new L({ref:`${j}${H===1?"":H}`,target:j,props:x.props});return S+=Y.declaredUniforms,a.push(...Object.values(Y.uniformInfo)),Y});let I="";m==null||m.forEach(x=>{const L=f[x.type],j=L.resolveDefaults(x.props??{}),H=[];for(const se in L.methods){let W=se;const ce=L.methods[se];v[se]&&v[se]!==ce&&(W=Vo.resolveMethodDuplicate(se,ce,v)),v[W]=ce.replace("function",W),H.push({m:se,cm:W})}let Y=L.onShaderMask instanceof Function?L.onShaderMask(j):L.onShaderMask,Z=L.onColorize instanceof Function?L.onColorize(j):L.onColorize,X=L.onEffectMask instanceof Function?L.onEffectMask(j):L.onEffectMask;H.forEach(se=>{const{m:W,cm:ce}=se,E=new RegExp(`\\$${W}`,"g");Y&&(Y=Y.replace(E,ce)),Z&&(Z=Z.replace(E,ce)),X&&(X=X.replace(E,ce))});const re=L.getMethodParameters(L.uniforms,j),le=re.length>0?`, ${re}`:"";Y&&(I+=`
        float fx_${x.key}_onShaderMask(float shaderMask ${le}) {
          ${Y}
        }
        `),Z&&(I+=`
          vec4 fx_${x.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${le}) {
            ${Z}
          }
        `),X&&(I+=`
          vec4 fx_${x.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${le}) {
            ${X}
          }
        `)});let M="";for(const x in v)M+=v[x];let R="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",U=`

    `;for(let x=0;x<_.length;x++){const L=_[x],j=L.passParameters.length>0?`, ${L.passParameters}`:"",H=f[L.name];H.onShaderMask&&(U+=`
        shaderMask = fx_${L.target}_onShaderMask(shaderMask ${j});
        `),H.onColorize&&(U+=`
        maskColor = fx_${L.target}_onColorize(shaderMask, maskColor, shaderColor${j});
        `),H.onEffectMask&&(R=`fx_${L.target}_onEffectMask(shaderMask, maskColor, shaderColor${j})`);const Y=_[x+1];(Y===void 0||f[Y.name].onEffectMask)&&(U+=`
          shaderColor = ${R};
        `)}return{effects:_,uniforms:a,fragment:Vo.fragment(S,M,I,U),vertex:Vo.vertex()}}static resolveMethodDuplicate(o,f,p,v=0){const S=o+(v>0?v:"");return p[S]&&p[S]!==f?this.resolveMethodDuplicate(o,f,p,++v):S}static resolveDefaults(o,f){return et(f),{effects:pM(o.effects??[],f),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(o,f){var v;let p="";return(v=o.effects)==null||v.forEach(S=>{const m=f[S.type].getEffectKey(S.props||{});p+=`,${m}`}),`DynamicShader${p}`}};N(Vo,"z$__type__Props"),N(Vo,"vertex",()=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    attribute vec2 a_textureCoordinate;
    attribute vec2 a_position;
    attribute vec4 a_color;
    attribute float a_textureIndex;

    uniform vec2 u_resolution;
    uniform float u_pixelRatio;

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;
    varying float v_textureIndex;

    void main(){
      vec2 normalized = a_position * u_pixelRatio / u_resolution;
      vec2 zero_two = normalized * 2.0;
      vec2 clip_space = zero_two - 1.0;

      // pass to fragment
      v_color = a_color;
      v_textureCoordinate = a_textureCoordinate;
      v_textureIndex = a_textureIndex;

      // flip y
      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
    }
  `),N(Vo,"fragment",(o,f,p,v)=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    #define PI 3.14159265359

    uniform vec2 u_resolution;
    uniform vec2 u_dimensions;
    uniform float u_alpha;
    uniform float u_radius;
    uniform sampler2D u_texture;
    uniform float u_pixelRatio;

    ${o}

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;

    ${f}

    ${p}

    void main() {
      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;
      vec2 d = abs(p) - (u_dimensions) * 0.5;
      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));

      vec4 shaderColor = vec4(0.0);
      float shaderMask = lng_DefaultMask;

      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;

      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));

      ${v}

      gl_FragColor = shaderColor * u_alpha;
    }
  `);let sa=Vo;class Y0 extends dr{constructor(r){super({renderer:r,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(r){return{radius:r.radius||10,$dimensions:{width:0,height:0}}}bindTextures(r){const{glw:o}=this;o.activeTexture(0),o.bindTexture(r[0].ctxTexture)}bindProps(r){const o=Math.min(r.$dimensions.width,r.$dimensions.height)/(2*r.radius);this.setUniform("u_radius",r.radius*Math.min(o,1))}canBatchShaderProps(r,o){return r.radius===o.radius&&r.$dimensions.width===o.$dimensions.width&&r.$dimensions.height===o.$dimensions.height}}N(Y0,"z$__type__Props"),N(Y0,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform vec2 u_dimensions;
      uniform float u_radius;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      float boxDist(vec2 p, vec2 size, float radius){
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }

      float fillMask(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }

      void main() {
        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;
        vec2 halfDimensions = u_dimensions * 0.5;

        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);
        gl_FragColor = mix(vec4(0.0), color, fillMask(d));
      }
    `});const gM=new Float32Array([1,0,0,0,1,0,0,0,1]),ah=class ah extends dr{constructor(r){super({renderer:r,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(r){const{glw:o}=this;o.activeTexture(0),o.bindTexture(r[0].ctxTexture)}bindProps(r){const o=ah.resolveDefaults(r);for(const f in o)if(f==="transform")this.setUniform("u_transform",!1,o[f]);else if(f==="scrollY")this.setUniform("u_scrollY",o[f]);else if(f==="color"){const p=Zl(o.color);this.setUniform("u_color",p)}else f==="size"?this.setUniform("u_size",o[f]):f==="distanceRange"?this.setUniform("u_distanceRange",o[f]):f==="debug"&&this.setUniform("u_debug",o[f]?1:0)}static resolveDefaults(r={}){return{transform:r.transform??gM,scrollY:r.scrollY??0,color:r.color??4294967295,size:r.size??16,distanceRange:r.distanceRange??1,debug:r.debug??!1}}};N(ah,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      // an attribute is an input (in) to a vertex shader.
      // It will receive data from a buffer
      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;

      uniform vec2 u_resolution;
      uniform mat3 u_transform;
      uniform float u_scrollY;
      uniform float u_pixelRatio;
      uniform float u_size;

      varying vec2 v_texcoord;

      void main() {
        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);
        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;

        // Calculate screen space with pixel ratio
        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);

        gl_Position = vec4(screenSpace, 0.0, 1.0);
        v_texcoord = a_textureCoordinate;

      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      uniform vec4 u_color;
      uniform sampler2D u_texture;
      uniform float u_distanceRange;
      uniform float u_pixelRatio;
      uniform int u_debug;

      varying vec2 v_texcoord;

      float median(float r, float g, float b) {
          return max(min(r, g), min(max(r, g), b));
      }

      void main() {
          vec3 sample = texture2D(u_texture, v_texcoord).rgb;
          if (u_debug == 1) {
            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);
            return;
          }
          float scaledDistRange = u_distanceRange * u_pixelRatio;
          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);
          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;

          // Build the final color.
          // IMPORTANT: We must premultiply the color by the alpha value before returning it.
          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);
      }
    `});let K0=ah;const ha=h=>{h.programValue===void 0&&(h.programValue=new Float32Array(4));const r=h.value,o=h.programValue;o[0]=(r>>>24)/255,o[1]=(r>>>16&255)/255,o[2]=(r>>>8&255)/255,o[3]=(r&255)/255},mM=h=>{const r=h.validatedValue||h.value;if(h.programValue instanceof Float32Array){const o=h.programValue;o[0]=r[0],o[1]=r[1]}else h.programValue=new Float32Array(r)},yM=h=>{const r=h.validatedValue||h.value;if(h.programValue instanceof Float32Array){const o=h.programValue;o[0]=r[0],o[1]=r[1],o[2]=r[1],o[3]=r[1]}else h.programValue=new Float32Array(r)},VS=h=>{const r=h.validatedValue||h.value;if(h.programValue instanceof Float32Array){const o=r.length,f=h.programValue;for(let p=0;p<o;p++)f[p]=r[p]}else h.programValue=new Float32Array(r)},fg=h=>{const r=Array.isArray(h);if(r){if(r&&h.length===4)return h;if(r&&h.length===2)return[h[0],h[1],h[0],h[1]];if(r&&h.length===3)return[h[0],h[1],h[2],h[0]]}else return[h,h,h,h];return[h[0],h[0],h[0],h[0]]},HS=(h,r)=>{h.programValue===void 0&&(h.programValue=new Float32Array(4));const o=h.programValue,f=h.validatedValue||h.value;if(r===void 0&&h.$dimensions===void 0){o[0]=f[0],o[1]=f[1],o[2]=f[2],o[3]=f[3];return}let p=h.$dimensions;if(r!==void 0){const{$dimensions:R}=r;if(p!==void 0&&(p.width===R.width||p.height===R.height))return;p===void 0&&(p={width:R==null?void 0:R.width,height:R==null?void 0:R.height},h.$dimensions=p)}const{width:v,height:S}=p,[a,m,_,I]=f,M=Math.min(Math.min(Math.min(v/Math.max(v,a+m),v/Math.max(v,_+I)),Math.min(S/Math.max(S,a+_),S/Math.max(S,m+I))),1);o[0]=a*M,o[1]=m*M,o[2]=_*M,o[3]=I*M};class Zs extends Mn{constructor(){super(...arguments);N(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(o){return{radius:o.radius??10}}}N(Zs,"z$__type__Props"),N(Zs,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:fg,updateProgramValue:HS}}),N(Zs,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),N(Zs,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);
  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);
  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);
  `),N(Zs,"onEffectMask",`
  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));
  `);class Fl extends Mn{constructor(){super(...arguments);N(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(o){return{width:o.width??10,color:o.color??4294967295}}}N(Fl,"z$__type__Props"),N(Fl,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ha,method:"uniform4fv",type:"vec4"}}),N(Fl,"onEffectMask",`
  float intR = shaderMask + 1.0;
  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);
  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);
  `),N(Fl,"onColorize",`
    return color;
  `);const lr=class lr extends Mn{constructor(){super(...arguments);N(this,"name","linearGradient")}static getEffectKey(o){return`linearGradient${o.colors.length}`}static resolveDefaults(o){const f=o.colors??[4278190080,4294967295];let p=o.stops||[];if(p.length===0||p.length!==f.length){const v=f.length;let S=0;const a=p;for(;S<v;S++)p[S]?(a[S]=p[S],p[S-1]===void 0&&a[S-2]!==void 0&&(a[S-1]=a[S-2]+(p[S]-a[S-2])/2)):a[S]=S*(1/(f.length-1));p=a}return{colors:f,stops:p,angle:o.angle??0}}};N(lr,"z$__type__Props"),N(lr,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:o=>o.reduce((f,p)=>f.concat(Zl(p)),[]),updateProgramValue:VS,size:o=>o.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:o=>o.colors.length,method:"uniform1fv",type:"float"}}),N(lr,"methods",{fromLinear:`
      vec4 function(vec4 linearRGB) {
        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);
        vec4 lower = linearRGB * vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,toLinear:`
      vec4 function(vec4 sRGB) {
        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));
        vec4 lower = sRGB/vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,calcPoint:`
      vec2 function(float d, float angle) {
        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);
      }
    `}),N(lr,"ColorLoop",o=>{let f="";for(let p=2;p<o;p++)f+=`colorOut = mix(colorOut, colors[${p}], clamp((dist - stops[${p-1}]) / (stops[${p}] - stops[${p-1}]), 0.0, 1.0));`;return f}),N(lr,"onColorize",o=>{const f=o.colors.length||1;return`
      float a = angle - (PI / 180.0 * 90.0);
      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));
      vec2 f = $calcPoint(lineDist * 0.5, a);
      vec2 t = $calcPoint(lineDist * 0.5, a + PI);
      vec2 gradVec = t - f;
      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));
      ${lr.ColorLoop(f)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let Z0=lr;class Q0 extends Mn{constructor(){super(...arguments);N(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(o){return{amount:o.amount??1}}}N(Q0,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),N(Q0,"onColorize",`
    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;
    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);
  `);class Qs extends Mn{constructor(){super(...arguments);N(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(o){return{width:o.width??10,color:o.color??4294967295}}}N(Qs,"z$__type__Props"),N(Qs,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ha,method:"uniform4fv",type:"vec4"}}),N(Qs,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),N(Qs,"onEffectMask",`
  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),N(Qs,"onColorize",`
    return color;
  `);class Js extends Mn{constructor(){super(...arguments);N(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(o){return{width:o.width??10,color:o.color??4294967295}}}N(Js,"z$__type__Props"),N(Js,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ha,method:"uniform4fv",type:"vec4"}}),N(Js,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),N(Js,"onEffectMask",`
  vec2 pos = vec2(0.0, width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),N(Js,"onColorize",`
    return color;
  `);class ea extends Mn{constructor(){super(...arguments);N(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(o){return{width:o.width??10,color:o.color??4294967295}}}N(ea,"z$__type__Props"),N(ea,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ha,method:"uniform4fv",type:"vec4"}}),N(ea,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),N(ea,"onEffectMask",`
  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),N(ea,"onColorize",`
    return color;
  `);class ta extends Mn{constructor(){super(...arguments);N(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(o){return{width:o.width??10,color:o.color??4294967295}}}N(ta,"z$__type__Props"),N(ta,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ha,method:"uniform4fv",type:"vec4"}}),N(ta,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),N(ta,"onEffectMask",`
  vec2 pos = vec2(width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),N(ta,"onColorize",`
    return color;
  `);class $l extends Mn{constructor(){super(...arguments);N(this,"name","glitch")}static getEffectKey(o){return"glitch"}static resolveDefaults(o){return{amplitude:o.amplitude??.2,narrowness:o.narrowness??4,blockiness:o.blockiness??2,minimizer:o.minimizer??8,time:o.time??Date.now()}}}N($l,"z$__type__Props"),N($l,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:o=>{const f=o.value=(Date.now()-o.value)%1e3;o.programValue=f},type:"float"}}),N($l,"methods",{rand:`
      float function(vec2 p, float time) {
        float t = floor(time * 20.) / 10.;
        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);
      }
    `,noise:`
      float function(vec2 uv, float blockiness, float time) {
        vec2 lv = fract(uv);
        vec2 id = floor(uv);

        float n1 = rand(id, time);
        float n2 = rand(id+vec2(1,0), time);
        float n3 = rand(id+vec2(0,1), time);
        float n4 = rand(id+vec2(1,1), time);
        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);
        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);
      }
    `,fbm:`
      float function(vec2 uv, int count, float blockiness, float complexity, float time) {
        float val = 0.0;
        float amp = 0.5;
        const int MAX_ITERATIONS = 10;

        for(int i = 0; i < MAX_ITERATIONS; i++) {
          if(i >= count) {break;}
          val += amp * noise(uv, blockiness, time);
          amp *= 0.5;
          uv *= complexity;
        }
        return val;
      }
    `}),N($l,"onColorize",`
    vec2 uv = v_textureCoordinate.xy;
    float aspect = u_dimensions.x / u_dimensions.y;
    vec2 a = vec2(uv.x * aspect , uv.y);
    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));

    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);
    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);
    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);
    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);

    vec3 f = vec3(colR, colG, colB);
    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);
  `);class Hc extends Mn{constructor(){super(...arguments);N(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(o){return{fade:o.fade??10}}}N(Hc,"z$__type__Props"),N(Hc,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:fg,updateProgramValue:yM}}),N(Hc,"onColorize",`
  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;
  vec2 pos1;
  vec2 pos2;
  vec2 d;
  float c;
  vec4 result = maskColor;


  if(fade[0] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x, point.y + fade[0]);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[1] > 0.0) {
    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);
    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[2] > 0.0) {
    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);
    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[3] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x + fade[3], point.y);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  return result;
  `);const $r=class $r extends Mn{constructor(){super(...arguments);N(this,"name","radialGradient")}static getEffectKey(o){return`radialGradient${o.colors.length}`}static resolveDefaults(o){const f=o.colors??[4278190080,4294967295];let p=o.stops||[];if(p.length===0||p.length!==f.length){const v=f.length;let S=0;const a=p;for(;S<v;S++)p[S]?(a[S]=p[S],p[S-1]===void 0&&a[S-2]!==void 0&&(a[S-1]=a[S-2]+(p[S]-a[S-2])/2)):a[S]=S*(1/(f.length-1));p=a}return{colors:f,stops:p,width:o.width??0,height:o.height??o.width??0,pivot:o.pivot??[.5,.5]}}};N($r,"z$__type__Props"),N($r,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:mM,method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:o=>o.reduce((f,p)=>f.concat(Zl(p)),[]),updateProgramValue:VS,size:o=>o.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:o=>o.colors.length,method:"uniform1fv",type:"float"}}),N($r,"ColorLoop",o=>{let f="";for(let p=2;p<o;p++)f+=`colorOut = mix(colorOut, colors[${p}], clamp((dist - stops[${p-1}]) / (stops[${p}] - stops[${p-1}]), 0.0, 1.0));`;return f}),N($r,"onColorize",o=>{const f=o.colors.length||1;return`
      vec2 point = v_textureCoordinate.xy * u_dimensions;
      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);

      float dist = length((point - projection) / vec2(width, height));

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = mix(colors[0], colors[1], stopCalc);
      ${$r.ColorLoop(f)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let J0=$r;class na extends Mn{constructor(){super(...arguments);N(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(o){return{width:o.width??10,progress:o.progress??.5,offset:o.offset??0,range:o.range??Math.PI*2,rounded:o.rounded??!1,radius:o.radius??1,color:o.color??4294967295}}}N(na,"z$__type__Props"),N(na,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:o=>o?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ha,method:"uniform4fv",type:"vec4"}}),N(na,"methods",{rotateUV:`
    vec2 function(vec2 uv, float d) {
      float s = sin(d);
      float c = cos(d);
      mat2 rotMatrix = mat2(c, -s, s, c);
      return uv * rotMatrix;
    }
    `,drawDot:`
    float function(vec2 uv, vec2 p, float r) {
      uv += p;
      float circle = length(uv) - r;
      return clamp(-circle, 0.0, 1.0);
    }
    `}),N(na,"onEffectMask",`
    float outerRadius = radius * u_dimensions.y * 0.5;

    float endAngle = range * progress - 0.0005;

    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;

    uv = $rotateUV(uv, -(offset));
    float linewidth = width * u_pixelRatio;
    float circle = length(uv) - (outerRadius - linewidth) ;
    circle = abs(circle) - linewidth;
    circle = clamp(-circle, 0.0, 1.0);

    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);
    float p = endAngle / (PI * 2.);

    circle *= step(fract(angle), fract(p));

    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));
    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));

    return mix(shaderColor, maskColor, circle);
  `),N(na,"onColorize",`
    return color;
  `);class ia extends Mn{constructor(){super(...arguments);N(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(o){return{x:o.x||0,y:o.y||0,width:o.width||50,height:o.height||50,radius:o.radius??0}}}N(ia,"z$__type__Props"),N(ia,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:fg,updateProgramValue:HS}}),N(ia,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),N(ia,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  vec2 size = vec2(width, height) * 0.5;
  vec2 basePos = v_textureCoordinate.xy * u_dimensions.xy - vec2(x, y);
  vec2 pos = basePos - size;
  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);
  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);
  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);
  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);
  return $boxDist(pos, size, r);
  `),N(ia,"onEffectMask",`
  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));
  `);const zS="RoundedRectangle";class cg extends jS{constructor(o){super();N(this,"shType");this.shType=o,o!==zS&&console.warn("Unsupported shader:",o)}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class vM{constructor(r,o,f,p){N(this,"type");N(this,"shader");N(this,"resolvedProps");N(this,"props");this.type=r,this.shader=o,this.resolvedProps=f;const v=Object.keys(f),S=v.length,a={};for(let m=0;m<S;m++){const _=v[m];Object.defineProperty(a,_,{get:()=>this.resolvedProps[_],set:I=>{this.resolvedProps[_]=I,p.requestRender()}})}this.props=a}getResolvedProps(){return this.resolvedProps}}class xM{constructor(r,o,f){N(this,"shader");N(this,"resolvedProps");N(this,"props");N(this,"type");this.shader=r,this.type="DynamicShader",this.resolvedProps=o;const p=f.getRegisteredEffects(),v={},S=o.effects,a=S.length;for(let m=0;m<a;m++){const{name:_,props:I,type:M}=S[m];if(_===void 0)continue;const R={},U=Object.keys(I),x=U.length;for(let L=0;L<x;L++){const j=U[L];Object.defineProperty(R,j,{get:()=>this.resolvedProps.effects[m].props[j].value,set:H=>{var Z,X;const Y=this.resolvedProps.effects[m].props[j];Y.value=H,Y.hasValidator&&(H=Y.validatedValue=(Z=p[M].uniforms[j])==null?void 0:Z.validator(H,I)),Y.hasProgramValueUpdater?(X=p[M].uniforms[j])==null||X.updateProgramValue(Y):Y.programValue=H,f.renderer.stage.requestRender()}})}Object.defineProperty(v,_,{get:()=>R})}this.props=v}getResolvedProps(){return this.resolvedProps}}class wM{constructor(){N(this,"shCache",new Map);N(this,"shConstructors",{});N(this,"attachedShader",null);N(this,"effectConstructors",{});N(this,"renderer");this.registerShaderType("DefaultShader",FS),this.registerShaderType("DefaultShaderBatched",$S),this.registerShaderType("RoundedRectangle",Y0),this.registerShaderType("DynamicShader",sa),this.registerShaderType("SdfShader",K0),this.registerEffectType("border",Fl),this.registerEffectType("borderBottom",ea),this.registerEffectType("borderLeft",ta),this.registerEffectType("borderRight",Qs),this.registerEffectType("borderTop",Js),this.registerEffectType("fadeOut",Hc),this.registerEffectType("linearGradient",Z0),this.registerEffectType("radialGradient",J0),this.registerEffectType("grayscale",Q0),this.registerEffectType("glitch",$l),this.registerEffectType("radius",Zs),this.registerEffectType("radialProgress",na),this.registerEffectType("holePunch",ia)}registerShaderType(r,o){this.shConstructors[r]=o}registerEffectType(r,o){this.effectConstructors[r]=o}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(r,o){if(!this.renderer)throw new Error("Renderer is not been defined");const f=this.shConstructors[r];if(!f)throw new Error(`Shader type "${r}" is not registered`);if(this.renderer.mode==="canvas"&&f.prototype instanceof dr)return this._createShaderCtr(r,new cg(r),o);if(r==="DynamicShader")return this.loadDynamicShader(o);const p=f.resolveDefaults(o),v=f.makeCacheKey(p)||f.name;if(v&&this.shCache.has(v))return this._createShaderCtr(r,this.shCache.get(v),p);const S=new f(this.renderer,o);return v&&this.shCache.set(v,S),this._createShaderCtr(r,S,p)}loadDynamicShader(r){if(!this.renderer)throw new Error("Renderer is not been defined");const o=sa.resolveDefaults(r,this.effectConstructors),f=sa.makeCacheKey(o,this.effectConstructors);if(f&&this.shCache.has(f))return this._createDynShaderCtr(this.shCache.get(f),o);const p=new sa(this.renderer,r,this.effectConstructors);return f&&this.shCache.set(f,p),this._createDynShaderCtr(p,o)}_createShaderCtr(r,o,f){return new vM(r,o,f,this.renderer.stage)}_createDynShaderCtr(r,o){return new xM(r,o,this)}useShader(r){this.attachedShader!==r&&(this.attachedShader&&this.attachedShader.detach(),r.attach(),this.attachedShader=r)}}const SM={x:(h,r)=>{h.props.x=r},y:(h,r)=>{h.props.y=r},width:(h,r)=>{h.props.width=r},height:(h,r)=>{h.props.height=r},color:(h,r)=>{h.props.color=r},zIndex:(h,r)=>{h.props.zIndex=r},fontFamily:(h,r)=>{h.props.fontFamily=r},fontWeight:(h,r)=>{h.props.fontWeight=r},fontStyle:(h,r)=>{h.props.fontStyle=r},fontStretch:(h,r)=>{h.props.fontStretch=r},fontSize:(h,r)=>{h.props.fontSize=r},text:(h,r)=>{h.props.text=r},textAlign:(h,r)=>{h.props.textAlign=r},contain:(h,r)=>{h.props.contain=r},offsetY:(h,r)=>{h.props.offsetY=r},scrollable:(h,r)=>{h.props.scrollable=r},scrollY:(h,r)=>{h.props.scrollY=r},letterSpacing:(h,r)=>{h.props.letterSpacing=r},lineHeight:(h,r)=>{h.props.lineHeight=r},maxLines:(h,r)=>{h.props.maxLines=r},textBaseline:(h,r)=>{h.props.textBaseline=r},verticalAlign:(h,r)=>{h.props.verticalAlign=r},overflowSuffix:(h,r)=>{h.props.overflowSuffix=r},debug:(h,r)=>{h.props.debug=r}};class hg{constructor(r){N(this,"stage");N(this,"set");this.stage=r;const o={...SM,...this.getPropertySetters()};this.set=Object.freeze(Object.fromEntries(Object.entries(o).map(([f,p])=>[f,(v,S)=>{v.props[f]!==S&&(p(v,S),this.stage.requestRender())}])))}setStatus(r,o,f){r.status!==o&&(r.status=o,r.emitter.emit(o,f))}setIsRenderable(r,o){r.isRenderable=o}destroyState(r){this.setStatus(r,"destroyed"),r.emitter.removeAllListeners()}scheduleUpdateState(r){r.updateScheduled||(r.updateScheduled=!0,queueMicrotask(()=>{r.status!=="destroyed"&&(r.updateScheduled=!1,this.updateState(r))}))}}class TM{constructor(){N(this,"data",{})}reset(){this.data={}}increment(r){this.data[r]||(this.data[r]=0),this.data[r]++}getData(){return{...this.data}}}class CM{constructor(r,o){N(this,"stage");N(this,"memUsed",0);N(this,"loadedTextures",new Map);N(this,"criticalThreshold");N(this,"targetThreshold");N(this,"cleanupInterval");N(this,"debugLogging");N(this,"lastCleanupTime",0);N(this,"criticalCleanupRequested",!1);N(this,"frameTime",0);this.stage=r;const{criticalThreshold:f}=o;this.criticalThreshold=Math.round(f);const p=Math.max(0,Math.min(1,o.targetThresholdLevel));if(this.targetThreshold=Math.round(f*p),this.cleanupInterval=o.cleanupInterval,this.debugLogging=o.debugLogging,o.debugLogging){let v=0;setInterval(()=>{v!==this.memUsed&&(v=this.memUsed,console.log(`[TextureMemoryManager] Memory used: ${eS(this.memUsed)} mb / ${eS(this.criticalThreshold)} mb (${(this.memUsed/this.criticalThreshold*100).toFixed(1)}%)`))},1e3)}f===0&&(this.setTextureMemUse=()=>{})}setTextureMemUse(r,o){if(this.loadedTextures.has(r)&&(this.memUsed-=this.loadedTextures.get(r)),o===0){this.loadedTextures.delete(r);return}else this.memUsed+=o,this.loadedTextures.set(r,o);this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}cleanup(){const r=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,this.criticalCleanupRequested=!1,r&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.debugLogging&&console.log(`[TextureMemoryManager] Cleaning up textures. Critical: ${r}`);const o=[...this.loadedTextures.keys()].sort((v,S)=>{const a=v.renderable,m=S.renderable;return a===m?v.lastRenderableChangeTime-S.lastRenderableChangeTime:a?1:m?-1:0}),f=this.targetThreshold,p=this.stage.txManager;for(const v of o)if(v.renderable||(v.preventCleanup===!1&&(v.ctxTexture.free(),p.removeTextureFromCache(v)),this.memUsed<=f))break;this.memUsed>=this.criticalThreshold&&(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),console.warn(`[TextureMemoryManager] Memory usage above critical threshold after cleanup: ${this.memUsed}`))}getMemoryInfo(){let r=0;const o=[...this.loadedTextures.keys()].reduce((f,p)=>(r+=p.renderable?1:0,f+(p.renderable?this.loadedTextures.get(p):0)),0);return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:o,memUsed:this.memUsed,renderableTexturesLoaded:r,loadedTextures:this.loadedTextures.size}}}class GS{constructor(r,o){N(this,"textureSource");N(this,"memManager");this.memManager=r,this.textureSource=o}setTextureMemUse(r){this.memManager.setTextureMemUse(this.textureSource,r)}get renderable(){return this.textureSource.renderable}}class XS{constructor(r){N(this,"options");N(this,"mode");N(this,"stage");N(this,"txManager");N(this,"txMemManager");N(this,"shManager");N(this,"rttNodes",[]);this.options=r,this.stage=r.stage,this.txManager=r.txManager,this.txMemManager=r.txMemManager,this.shManager=r.shManager}}class EM extends W0{constructor(o,f,p){super(o,f);N(this,"textRenderer");N(this,"trState");N(this,"_textRendererOverride",null);N(this,"onTextLoaded",()=>{const{contain:o}=this,f=this.trState.props.width,p=this.trState.props.height,v=this.trState.textW||0,S=this.trState.textH||0;o==="both"?(this.props.width=f,this.props.height=p):o==="width"?(this.props.width=f,this.props.height=S):o==="none"&&(this.props.width=v,this.props.height=S),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});N(this,"onTextFailed",(o,f)=>{this.emit("failed",{type:"text",error:f})});this._textRendererOverride=f.textRendererOverride,this.textRenderer=p;const v=this.createState({x:this.absX,y:this.absY,width:f.width,height:f.height,textAlign:f.textAlign,color:f.color,zIndex:f.zIndex,contain:f.contain,scrollable:f.scrollable,scrollY:f.scrollY,offsetY:f.offsetY,letterSpacing:f.letterSpacing,debug:f.debug,fontFamily:f.fontFamily,fontSize:f.fontSize,fontStretch:f.fontStretch,fontStyle:f.fontStyle,fontWeight:f.fontWeight,text:f.text,lineHeight:f.lineHeight,maxLines:f.maxLines,textBaseline:f.textBaseline,verticalAlign:f.verticalAlign,overflowSuffix:f.overflowSuffix});this.trState=v}get width(){return this.props.width}set width(o){this.props.width=o,this.textRenderer.set.width(this.trState,o),this.contain==="none"&&this.setUpdateType(Oe.Local)}get height(){return this.props.height}set height(o){this.props.height=o,this.textRenderer.set.height(this.trState,o),this.contain!=="both"&&this.setUpdateType(Oe.Local)}get color(){return this.trState.props.color}set color(o){this.textRenderer.set.color(this.trState,o)}get text(){return this.trState.props.text}set text(o){this.textRenderer.set.text(this.trState,o)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(o){this._textRendererOverride=o,this.textRenderer.destroyState(this.trState);const f=this.stage.resolveTextRenderer(this.trState.props,this._textRendererOverride);if(!f){console.warn("Text Renderer not found for font",this.trState.props.fontFamily);return}this.textRenderer=f,this.trState=this.createState(this.trState.props)}get fontSize(){return this.trState.props.fontSize}set fontSize(o){this.textRenderer.set.fontSize(this.trState,o)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(o){this.textRenderer.set.fontFamily(this.trState,o)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(o){this.textRenderer.set.fontStretch(this.trState,o)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(o){this.textRenderer.set.fontStyle(this.trState,o)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(o){this.textRenderer.set.fontWeight(this.trState,o)}get textAlign(){return this.trState.props.textAlign}set textAlign(o){this.textRenderer.set.textAlign(this.trState,o)}get contain(){return this.trState.props.contain}set contain(o){this.textRenderer.set.contain(this.trState,o)}get scrollable(){return this.trState.props.scrollable}set scrollable(o){this.textRenderer.set.scrollable(this.trState,o)}get scrollY(){return this.trState.props.scrollY}set scrollY(o){this.textRenderer.set.scrollY(this.trState,o)}get offsetY(){return this.trState.props.offsetY}set offsetY(o){this.textRenderer.set.offsetY(this.trState,o)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(o){this.textRenderer.set.letterSpacing(this.trState,o)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(o){this.textRenderer.set.lineHeight(this.trState,o)}get maxLines(){return this.trState.props.maxLines}set maxLines(o){this.textRenderer.set.maxLines(this.trState,o)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(o){this.textRenderer.set.textBaseline(this.trState,o)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(o){this.textRenderer.set.verticalAlign(this.trState,o)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(o){this.textRenderer.set.overflowSuffix(this.trState,o)}get debug(){return this.trState.props.debug}set debug(o){this.textRenderer.set.debug(this.trState,o)}update(o,f){super.update(o,f),et(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkRenderProps(){return this.trState&&this.trState.props.text!==""?!0:super.checkRenderProps()}onChangeIsRenderable(o){super.onChangeIsRenderable(o),this.textRenderer.setIsRenderable(this.trState,o)}renderQuads(o){var f;if(et(this.globalTransform),!this.textRenderer.renderQuads){super.renderQuads(o);return}this.parentHasRenderTexture&&(!o.renderToTextureActive||this.parentRenderTexture!==o.activeRttNode)||(this.parentHasRenderTexture&&((f=this.props.parent)!=null&&f.rtt)&&(this.globalTransform=li.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),et(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions))}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}createState(o){const f=this.textRenderer.createState(o,this);return f.emitter.on("loaded",this.onTextLoaded),f.emitter.on("failed",this.onTextFailed),this.textRenderer.scheduleUpdateState(f),f}}function AM(h){const r={boolean:!0,string:!0,number:!0,undefined:!0},o=Object.keys(h);for(let f=0;f<o.length;f++){const p=o[f];if(!p)continue;const v=h[p],S=typeof v;S==="string"&&v.length>2048&&(console.warn(`Custom Data value for ${p} is too long, it will be truncated to 2048 characters`),h[p]=v.substring(0,2048)),r[S]||(console.warn(`Custom Data value for ${p} is not a boolean, string, or number, it will be ignored`),delete h[p])}return h}const kM=2e6;class bM{constructor(r){N(this,"options");N(this,"animationManager");N(this,"txManager");N(this,"txMemManager");N(this,"fontManager");N(this,"textRenderers");N(this,"shManager");N(this,"renderer");N(this,"root");N(this,"boundsMargin");N(this,"defShaderCtr");N(this,"eventBus");N(this,"deltaTime",0);N(this,"lastFrameTime",0);N(this,"currentFrameTime",0);N(this,"fpsNumFrames",0);N(this,"fpsElapsedTime",0);N(this,"renderRequested",!1);N(this,"frameEventQueue",[]);N(this,"fontResolveMap",{});N(this,"contextSpy",null);this.options=r;const{canvas:o,clearColor:f,appWidth:p,appHeight:v,boundsMargin:S,enableContextSpy:a,numImageWorkers:m,textureMemory:_,renderEngine:I,fontEngines:M}=r;this.eventBus=r.eventBus,this.txManager=new fM(m),this.txMemManager=new CM(this,_),this.shManager=new wM,this.animationManager=new iM,this.contextSpy=a?new TM:null;let R=[0,0,0,0];S&&(R=Array.isArray(S)?S:[S,S,S,S]),this.boundsMargin=R;const U={stage:this,canvas:o,pixelRatio:r.devicePhysicalPixelRatio*r.deviceLogicalPixelRatio,clearColor:f??4278190080,bufferMemory:kM,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy};this.renderer=new I(U);const x=this.renderer.mode||"webgl";this.defShaderCtr=this.renderer.getDefShaderCtr(),BI(x),this.txManager.renderer=this.renderer,this.textRenderers={},M.forEach(j=>{const H=new j(this),Y=H.type;if(Y==="sdf"&&x==="canvas"){console.warn("SdfTextRenderer is not compatible with Canvas renderer. Skipping...");return}H instanceof hg&&(Y==="canvas"?this.textRenderers.canvas=H:Y==="sdf"&&(this.textRenderers.sdf=H))}),Object.keys(this.textRenderers).length===0&&console.warn("No text renderers available. Your text will not render."),this.fontManager=new ug(this.textRenderers);const L=new W0(this,{x:0,y:0,width:p,height:v,alpha:1,autosize:!1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1,preventCleanup:!1});this.root=L,tM(this)}updateFrameTime(){const r=nM();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=r,this.deltaTime=this.lastFrameTime?r-this.lastFrameTime:100/6,this.txManager.frameTime=r,this.txMemManager.frameTime=r,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}updateAnimations(){const{animationManager:r}=this;this.root&&r.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested}drawFrame(){const{renderer:r,renderRequested:o}=this;et(r),this.root.updateType!==0&&this.root.update(this.deltaTime,this.root.clippingRect),r.reset(),this.txMemManager.criticalCleanupRequested&&this.txMemManager.cleanup(),r.rttNodes.length>0&&r.renderRTTNodes(),this.addQuads(this.root),r==null||r.render(),this.calculateFps(),o&&(this.renderRequested=!1)}queueFrameEvent(r,o){this.frameEventQueue.push([r,o])}flushFrameEvents(){for(const[r,o]of this.frameEventQueue)this.eventBus.emit(r,o);this.frameEventQueue=[]}calculateFps(){var o,f;const{fpsUpdateInterval:r}=this.options;if(r&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=r)){const p=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:p,contextSpyData:((o=this.contextSpy)==null?void 0:o.getData())??null}),(f=this.contextSpy)==null||f.reset()}}addQuads(r){et(this.renderer),r.isRenderable===!0&&r.renderQuads(this.renderer);for(let o=0;o<r.children.length;o++){const f=r.children[o];f!==void 0&&f.worldAlpha!==0&&this.addQuads(f)}}requestRender(){this.renderRequested=!0}resolveTextRenderer(r,o=null){const f=`${r.fontFamily}${r.fontStyle}${r.fontWeight}${r.fontStretch}${o||""}`;if(this.fontResolveMap[f]!==void 0)return this.fontResolveMap[f];let p=o,v=!1;if(p){const a=this.textRenderers[p];a?a.canRenderFont(r)||(console.warn(`Cannot use override text renderer '${p}' for font`,r),p=null,v=!0):(console.warn(`Text renderer override '${p}' not found.`),p=null,v=!0)}if(!p){for(const[a,m]of Object.entries(this.textRenderers))if(m.canRenderFont(r)){p=a;break}!p&&this.textRenderers.canvas!==void 0&&(p="canvas")}if(v&&console.warn(`Falling back to text renderer ${String(p)}`),!p)return null;const S=this.textRenderers[p];return et(S,"resolvedTextRenderer undefined"),this.fontResolveMap[f]=S,S}createShaderCtr(r,o){return this.shManager.loadShader(r,o)}createNode(r){const o=this.resolveNodeDefaults(r);return new W0(this,o)}createTextNode(r){const o=r.fontSize??16,f={...this.resolveNodeDefaults(r),text:r.text??"",textRendererOverride:r.textRendererOverride??null,fontSize:o,fontFamily:r.fontFamily??"sans-serif",fontStyle:r.fontStyle??"normal",fontWeight:r.fontWeight??"normal",fontStretch:r.fontStretch??"normal",textAlign:r.textAlign??"left",contain:r.contain??"none",scrollable:r.scrollable??!1,scrollY:r.scrollY??0,offsetY:r.offsetY??0,letterSpacing:r.letterSpacing??0,lineHeight:r.lineHeight,maxLines:r.maxLines??0,textBaseline:r.textBaseline??"alphabetic",verticalAlign:r.verticalAlign??"middle",overflowSuffix:r.overflowSuffix??"...",debug:r.debug??{},shaderProps:null},p=this.resolveTextRenderer(f,r.textRendererOverride);if(!p)throw new Error(`No compatible text renderer found for ${f.fontFamily}`);return new EM(this,f,p)}resolveNodeDefaults(r){const o=r.color??4294967295,f=r.colorTl??r.colorTop??r.colorLeft??o,p=r.colorTr??r.colorTop??r.colorRight??o,v=r.colorBl??r.colorBottom??r.colorLeft??o,S=r.colorBr??r.colorBottom??r.colorRight??o,a=AM(r.data??{});return{x:r.x??0,y:r.y??0,width:r.width??0,height:r.height??0,alpha:r.alpha??1,autosize:r.autosize??!1,clipping:r.clipping??!1,color:o,colorTop:r.colorTop??o,colorBottom:r.colorBottom??o,colorLeft:r.colorLeft??o,colorRight:r.colorRight??o,colorBl:v,colorBr:S,colorTl:f,colorTr:p,zIndex:r.zIndex??0,zIndexLocked:r.zIndexLocked??0,parent:r.parent??null,texture:r.texture??null,textureOptions:r.textureOptions??{},shader:r.shader??this.defShaderCtr,src:r.src??null,srcHeight:r.srcHeight,srcWidth:r.srcWidth,srcX:r.srcX,srcY:r.srcY,scale:r.scale??null,scaleX:r.scaleX??r.scale??1,scaleY:r.scaleY??r.scale??1,mount:r.mount??0,mountX:r.mountX??r.mount??0,mountY:r.mountY??r.mount??0,pivot:r.pivot??.5,pivotX:r.pivotX??r.pivot??.5,pivotY:r.pivotY??r.pivot??.5,rotation:r.rotation??0,rtt:r.rtt??!1,data:a,preventCleanup:r.preventCleanup??!1,imageType:r.imageType}}}class IM extends hr{constructor(o,f){var L,j,H,Y;super();N(this,"root");N(this,"canvas");N(this,"settings");N(this,"stage");N(this,"inspector",null);const p={criticalThreshold:((L=o.textureMemory)==null?void 0:L.criticalThreshold)||124e6,targetThresholdLevel:((j=o.textureMemory)==null?void 0:j.targetThresholdLevel)||.5,cleanupInterval:((H=o.textureMemory)==null?void 0:H.cleanupInterval)||3e4,debugLogging:((Y=o.textureMemory)==null?void 0:Y.debugLogging)||!1},v={appWidth:o.appWidth||1920,appHeight:o.appHeight||1080,textureMemory:p,boundsMargin:o.boundsMargin||0,deviceLogicalPixelRatio:o.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:o.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:o.clearColor??0,fpsUpdateInterval:o.fpsUpdateInterval||0,numImageWorkers:o.numImageWorkers!==void 0?o.numImageWorkers:2,enableContextSpy:o.enableContextSpy??!1,inspector:o.inspector??!1,renderEngine:o.renderEngine,quadBufferSize:o.quadBufferSize??4*1024*1024,fontEngines:o.fontEngines};this.settings=v;const{appWidth:S,appHeight:a,deviceLogicalPixelRatio:m,devicePhysicalPixelRatio:_,inspector:I}=v,M=S*m,R=a*m,U=document.createElement("canvas");this.canvas=U,U.width=M*_,U.height=R*_,U.style.width=`${M}px`,U.style.height=`${R}px`,this.stage=new bM({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,fpsUpdateInterval:this.settings.fpsUpdateInterval,numImageWorkers:this.settings.numImageWorkers,renderEngine:this.settings.renderEngine,textureMemory:p,eventBus:this,quadBufferSize:this.settings.quadBufferSize,fontEngines:this.settings.fontEngines}),this.root=this.stage.root;let x;if(typeof f=="string"?x=document.getElementById(f):x=f,!x)throw new Error("Could not find target element");x.appendChild(U),I&&!NS()&&(this.inspector=new I(U,v))}createNode(o){et(this.stage,"Stage is not initialized");const f=this.stage.createNode(o);return this.inspector?this.inspector.createNode(f):f}createTextNode(o){const f=this.stage.createTextNode(o);return this.inspector?this.inspector.createTextNode(f):f}destroyNode(o){return this.inspector&&this.inspector.destroyNode(o.id),o.destroy()}createTexture(o,f){return this.stage.txManager.loadTexture(o,f)}createShader(o,f){return this.stage.shManager.loadShader(o,f)}createDynamicShader(o){return this.stage.shManager.loadDynamicShader({effects:o})}createEffect(o,f,p){return{name:p,type:o,props:f}}getNodeById(o){var v;const f=(v=this.stage)==null?void 0:v.root;if(!f)return null;const p=S=>{if(S.id===o)return S;for(const a of S.children){const m=p(a);if(m)return m}return null};return p(f)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){throw new Error("Not implemented")}}class WS extends hr{constructor(o){super();N(this,"fontFamily");N(this,"descriptors");N(this,"loaded",!1);N(this,"metrics",null);const{fontFamily:f,descriptors:p,metrics:v}=o;v&&(this.metrics={ascender:v.ascender/v.unitsPerEm,descender:v.descender/v.unitsPerEm,lineGap:v.lineGap/v.unitsPerEm}),this.fontFamily=f,this.descriptors={style:"normal",weight:"normal",stretch:"normal",...p}}static convertToCssFontFaceDescriptors(o){return{style:o.style,weight:typeof o.weight=="number"?`${o.weight}`:o.weight,stretch:o.stretch,unicodeRange:o.unicodeRange,featureSettings:o.featureSettings,display:o.display}}}class zc extends WS{constructor(o){super(o);N(this,"fontFace");N(this,"fontUrl");const{fontFamily:f,fontUrl:p}=o,v=p.replace(/\(|\)/g,""),S=this.descriptors,a={style:S.style,weight:typeof S.weight=="number"?`${S.weight}`:S.weight,stretch:S.stretch,unicodeRange:S.unicodeRange,featureSettings:S.featureSettings,display:S.display},m=new FontFace(f,`url(${v})`,a);v.length>0?m.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error):(this.loaded=!0,this.emit("loaded")),this.fontFace=m,this.fontUrl=p}}class MM{}class qS extends MM{constructor(o,f,p,v,S,a,m,_,I,M,R,U,x){super();N(this,"glw");N(this,"options");N(this,"buffers");N(this,"shader");N(this,"shaderProps");N(this,"alpha");N(this,"clippingRect");N(this,"dimensions");N(this,"bufferIdx");N(this,"zIndex");N(this,"renderToTexture");N(this,"parentHasRenderTexture");N(this,"framebufferDimensions");N(this,"length",0);N(this,"numQuads",0);N(this,"textures",[]);N(this,"maxTextures");this.glw=o,this.options=f,this.buffers=p,this.shader=v,this.shaderProps=S,this.alpha=a,this.clippingRect=m,this.dimensions=_,this.bufferIdx=I,this.zIndex=M,this.renderToTexture=R,this.parentHasRenderTexture=U,this.framebufferDimensions=x,this.maxTextures=v.supportsIndexedTextures?o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(o){const{textures:f,maxTextures:p}=this,v=f.findIndex(a=>a===o);if(v!==-1)return v;const S=f.length;return S>=p?4294967295:(this.textures.push(o),S)}draw(){const{glw:o,shader:f,shaderProps:p,options:v}=this,{shManager:S}=v;S.useShader(f),f.bindRenderOp(this,p);const a=this.bufferIdx/24*6*2;if(this.clippingRect.valid){const{x:m,y:_,width:I,height:M}=this.clippingRect,R=v.pixelRatio,U=v.canvas.height,x=Math.round(m*R),L=Math.round(I*R),j=Math.round(M*R),H=Math.round(U-j-_*R);o.setScissorTest(!0),o.scissor(x,H,L,j)}else o.setScissorTest(!1);o.drawElements(o.TRIANGLES,6*this.numQuads,o.UNSIGNED_SHORT,a)}}function RM(h){const r={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(r).forEach(f=>{r[f]=h.getParameter(h[f])}),r}function _M(h){const r={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(r).forEach(f=>{r[f]=h.getExtension(f)}),r}function LM(h,r){const o=~~(r/80),f=new Uint16Array(o*6);for(let v=0,S=0;v<o;v+=6,S+=4)f[v]=S,f[v+1]=S+1,f[v+2]=S+2,f[v+3]=S+2,f[v+4]=S+1,f[v+5]=S+3;const p=h.createBuffer();h.elementArrayBufferData(p,f,h.STATIC_DRAW)}function PM(h){return h!==null&&typeof h=="object"&&h.constructor&&h.constructor.name==="HTMLImageElement"}const N0=new Uint8Array([0,0,0,0]);class eh extends GS{constructor(o,f,p){super(f,p);N(this,"glw");N(this,"_nativeCtxTexture",null);N(this,"_state","freed");N(this,"_w",0);N(this,"_h",0);this.glw=o}get ctxTexture(){return this._state==="freed"&&this.load(),et(this._nativeCtxTexture),this._nativeCtxTexture}get w(){return this._w}get h(){return this._h}load(){this._state==="loading"||this._state==="loaded"||(this._state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),this.onLoadRequest().then(({width:o,height:f})=>{this._state!=="freed"&&(this._state="loaded",this._w=o,this._h=f,this.textureSource.setState("loaded",{width:o,height:f}))}).catch(o=>{this._state!=="freed"&&(this._state="failed",this.textureSource.setState("failed",o),console.error(o))}))}async onLoadRequest(){var S;const{glw:o}=this;o.texImage2D(0,o.RGBA,1,1,0,o.RGBA,o.UNSIGNED_BYTE,null),this.setTextureMemUse(N0.byteLength);const f=await((S=this.textureSource)==null?void 0:S.getTextureData());if(!this._nativeCtxTexture)return et(this._state==="freed"),{width:0,height:0};let p=0,v=0;if(et(this._nativeCtxTexture),o.activeTexture(0),typeof ImageBitmap<"u"&&f.data instanceof ImageBitmap||f.data instanceof ImageData||PM(f.data)){const a=f.data;p=a.width,v=a.height,o.bindTexture(this._nativeCtxTexture),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!f.premultiplyAlpha),o.texImage2D(0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,a),this.setTextureMemUse(p*v*4),(o.isWebGl2()||Jw(p)&&Jw(v))&&o.generateMipmap()}else if(f.data===null)p=0,v=0,o.bindTexture(this._nativeCtxTexture),o.texImage2D(0,o.RGBA,1,1,0,o.RGBA,o.UNSIGNED_BYTE,N0),this.setTextureMemUse(N0.byteLength);else if("mipmaps"in f.data&&f.data.mipmaps){const{mipmaps:a,width:m=0,height:_=0,type:I,glInternalFormat:M}=f.data,R=I==="ktx"?new DataView(a[0]??new ArrayBuffer(0)):a[0];o.bindTexture(this._nativeCtxTexture),o.compressedTexImage2D(0,M,m,_,0,R),o.texParameteri(o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_MIN_FILTER,o.LINEAR),this.setTextureMemUse(R.byteLength)}else console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",f);return{width:p,height:v}}free(){if(this._state==="freed"||(this._state="freed",this.textureSource.setState("freed"),this._w=0,this._h=0,!this._nativeCtxTexture))return;const{glw:o}=this;o.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null}createNativeCtxTexture(){const{glw:o}=this,f=o.createTexture();if(!f)throw new Error("Could not create WebGL Texture");return o.activeTexture(0),o.bindTexture(f),o.texParameteri(o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),f}}class DM extends eh{constructor(r,o,f){super(r,o,f)}async onLoadRequest(){var o,f;const r=await this.textureSource.getTextureData();return{width:((o=r.data)==null?void 0:o.width)||0,height:((f=r.data)==null?void 0:f.height)||0}}}class YS{constructor(r){N(this,"config");this.config=r}getBuffer(r){var o;return(o=this.config.find(f=>f.attributes[r]))==null?void 0:o.buffer}getAttributeInfo(r){var o;return(o=this.config.find(f=>f.attributes[r]))==null?void 0:o.attributes[r]}}function NM(h){return self.WebGL2RenderingContext&&h instanceof self.WebGL2RenderingContext}class OM{constructor(r){N(this,"gl");N(this,"activeTextureUnit",0);N(this,"texture2dUnits");N(this,"texture2dParams",new WeakMap);N(this,"scissorEnabled");N(this,"scissorX");N(this,"scissorY");N(this,"scissorWidth");N(this,"scissorHeight");N(this,"blendEnabled");N(this,"blendSrcRgb");N(this,"blendDstRgb");N(this,"blendSrcAlpha");N(this,"blendDstAlpha");N(this,"boundArrayBuffer");N(this,"boundElementArrayBuffer");N(this,"curProgram");N(this,"programUniforms",new WeakMap);N(this,"canvas");N(this,"MAX_RENDERBUFFER_SIZE");N(this,"MAX_TEXTURE_SIZE");N(this,"MAX_VIEWPORT_DIMS");N(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS");N(this,"MAX_TEXTURE_IMAGE_UNITS");N(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS");N(this,"MAX_VERTEX_ATTRIBS");N(this,"MAX_VARYING_VECTORS");N(this,"MAX_VERTEX_UNIFORM_VECTORS");N(this,"MAX_FRAGMENT_UNIFORM_VECTORS");N(this,"TEXTURE_MAG_FILTER");N(this,"TEXTURE_MIN_FILTER");N(this,"TEXTURE_WRAP_S");N(this,"TEXTURE_WRAP_T");N(this,"LINEAR");N(this,"CLAMP_TO_EDGE");N(this,"RGBA");N(this,"UNSIGNED_BYTE");N(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL");N(this,"UNPACK_FLIP_Y_WEBGL");N(this,"FLOAT");N(this,"TRIANGLES");N(this,"UNSIGNED_SHORT");N(this,"ONE");N(this,"ONE_MINUS_SRC_ALPHA");N(this,"VERTEX_SHADER");N(this,"FRAGMENT_SHADER");N(this,"STATIC_DRAW");N(this,"COMPILE_STATUS");N(this,"LINK_STATUS");N(this,"DYNAMIC_DRAW");N(this,"COLOR_ATTACHMENT0");this.gl=r,this.activeTextureUnit=r.getParameter(r.ACTIVE_TEXTURE)-r.TEXTURE0;const o=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(o).fill(void 0).map((p,v)=>(this.activeTexture(v),r.getParameter(r.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=r.isEnabled(r.SCISSOR_TEST);const f=r.getParameter(r.SCISSOR_BOX);this.scissorX=f[0],this.scissorY=f[1],this.scissorWidth=f[2],this.scissorHeight=f[3],this.blendEnabled=r.isEnabled(r.BLEND),this.blendSrcRgb=r.getParameter(r.BLEND_SRC_RGB),this.blendDstRgb=r.getParameter(r.BLEND_DST_RGB),this.blendSrcAlpha=r.getParameter(r.BLEND_SRC_ALPHA),this.blendDstAlpha=r.getParameter(r.BLEND_DST_ALPHA),this.boundArrayBuffer=r.getParameter(r.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=r.getParameter(r.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=r.getParameter(r.CURRENT_PROGRAM),this.canvas=r.canvas,this.MAX_RENDERBUFFER_SIZE=r.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=r.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=r.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=r.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=r.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=r.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=r.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=r.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=r.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=r.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=r.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=r.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=r.TEXTURE_WRAP_T,this.LINEAR=r.LINEAR,this.CLAMP_TO_EDGE=r.CLAMP_TO_EDGE,this.RGBA=r.RGBA,this.UNSIGNED_BYTE=r.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=r.UNPACK_FLIP_Y_WEBGL,this.FLOAT=r.FLOAT,this.TRIANGLES=r.TRIANGLES,this.UNSIGNED_SHORT=r.UNSIGNED_SHORT,this.ONE=r.ONE,this.ONE_MINUS_SRC_ALPHA=r.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=r.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=r.TRIANGLES,this.UNSIGNED_SHORT=r.UNSIGNED_SHORT,this.VERTEX_SHADER=r.VERTEX_SHADER,this.FRAGMENT_SHADER=r.FRAGMENT_SHADER,this.STATIC_DRAW=r.STATIC_DRAW,this.COMPILE_STATUS=r.COMPILE_STATUS,this.LINK_STATUS=r.LINK_STATUS,this.DYNAMIC_DRAW=r.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=r.COLOR_ATTACHMENT0}isWebGl2(){return NM(this.gl)}activeTexture(r){const{gl:o}=this;this.activeTextureUnit!==r&&(o.activeTexture(r+o.TEXTURE0),this.activeTextureUnit=r)}bindTexture(r){const{gl:o,activeTextureUnit:f,texture2dUnits:p}=this;p[f]!==r&&(p[f]=r,o.bindTexture(this.gl.TEXTURE_2D,r))}_getActiveTexture(){const{activeTextureUnit:r,texture2dUnits:o}=this;return o[r]}texParameteri(r,o){const{gl:f,texture2dParams:p}=this,v=this._getActiveTexture();if(!v)throw new Error("No active texture");let S=p.get(v);S||(S={},p.set(v,S)),S[r]!==o&&(S[r]=o,f.texParameteri(f.TEXTURE_2D,r,o))}texImage2D(r,o,f,p,v,S,a,m){const{gl:_}=this;S?_.texImage2D(_.TEXTURE_2D,r,o,f,p,v,S,a,m):_.texImage2D(_.TEXTURE_2D,r,o,f,p,v)}compressedTexImage2D(r,o,f,p,v,S){const{gl:a}=this;a.compressedTexImage2D(a.TEXTURE_2D,r,o,f,p,v,S)}pixelStorei(r,o){const{gl:f}=this;f.pixelStorei(r,o)}generateMipmap(){const{gl:r}=this;r.generateMipmap(r.TEXTURE_2D)}createTexture(){const{gl:r}=this;return r.createTexture()}deleteTexture(r){const{gl:o}=this;r&&this.texture2dParams.delete(r),o.deleteTexture(r)}viewport(r,o,f,p){const{gl:v}=this;v.viewport(r,o,f,p)}clearColor(r,o,f,p){const{gl:v}=this;v.clearColor(r,o,f,p)}setScissorTest(r){const{gl:o,scissorEnabled:f}=this;r!==f&&(r?o.enable(o.SCISSOR_TEST):o.disable(o.SCISSOR_TEST),this.scissorEnabled=r)}scissor(r,o,f,p){const{gl:v,scissorX:S,scissorY:a,scissorWidth:m,scissorHeight:_}=this;(r!==S||o!==a||f!==m||p!==_)&&(v.scissor(r,o,f,p),this.scissorX=r,this.scissorY=o,this.scissorWidth=f,this.scissorHeight=p)}setBlend(r){const{gl:o,blendEnabled:f}=this;r!==f&&(r?o.enable(o.BLEND):o.disable(o.BLEND),this.blendEnabled=r)}blendFunc(r,o){const{gl:f,blendSrcRgb:p,blendDstRgb:v,blendSrcAlpha:S,blendDstAlpha:a}=this;(r!==p||o!==v||r!==S||o!==a)&&(f.blendFunc(r,o),this.blendSrcRgb=r,this.blendDstRgb=o,this.blendSrcAlpha=r,this.blendDstAlpha=o)}createBuffer(){const{gl:r}=this;return r.createBuffer()}createFramebuffer(){const{gl:r}=this;return r.createFramebuffer()}bindFramebuffer(r){const{gl:o}=this;o.bindFramebuffer(o.FRAMEBUFFER,r)}framebufferTexture2D(r,o,f){const{gl:p}=this;p.framebufferTexture2D(p.FRAMEBUFFER,r,p.TEXTURE_2D,o,f)}clear(){const{gl:r}=this;r.clear(r.COLOR_BUFFER_BIT)}arrayBufferData(r,o,f){const{gl:p,boundArrayBuffer:v}=this;v!==r&&(p.bindBuffer(p.ARRAY_BUFFER,r),this.boundArrayBuffer=r),p.bufferData(p.ARRAY_BUFFER,o,f)}elementArrayBufferData(r,o,f){const{gl:p,boundElementArrayBuffer:v}=this;v!==r&&(p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,r),this.boundElementArrayBuffer=r),p.bufferData(p.ELEMENT_ARRAY_BUFFER,o,f)}vertexAttribPointer(r,o,f,p,v,S,a){const{gl:m,boundArrayBuffer:_}=this;_!==r&&(m.bindBuffer(m.ARRAY_BUFFER,r),this.boundArrayBuffer=r),m.vertexAttribPointer(o,f,p,v,S,a)}useProgram(r){const{gl:o,curProgram:f}=this;f!==r&&(o.useProgram(r),this.curProgram=r)}setUniform(r,o,...f){const{gl:p,programUniforms:v}=this;let S=v.get(this.curProgram);S||(S=new Map,v.set(this.curProgram,S));const a=S.get(o);(!a||!UM(a,f))&&(S.set(o,f),p[r](o,...f))}getParameter(r){const{gl:o}=this;return o.getParameter(r)}drawElements(r,o,f,p){const{gl:v}=this;v.drawElements(r,o,f,p)}getExtension(r){const{gl:o}=this;return o.getExtension(r)}createVertexArray(){const{gl:r}=this;return et(r instanceof WebGL2RenderingContext),r.createVertexArray()}bindVertexArray(r){const{gl:o}=this;et(o instanceof WebGL2RenderingContext),o.bindVertexArray(r)}getAttribLocation(r,o){const{gl:f}=this;return f.getAttribLocation(r,o)}getUniformLocation(r,o){const{gl:f}=this;return f.getUniformLocation(r,o)}enableVertexAttribArray(r){const{gl:o}=this;o.enableVertexAttribArray(r)}disableVertexAttribArray(r){const{gl:o}=this;o.disableVertexAttribArray(r)}createShader(r){const{gl:o}=this;return o.createShader(r)}compileShader(r){const{gl:o}=this;o.compileShader(r)}attachShader(r,o){const{gl:f}=this;f.attachShader(r,o)}linkProgram(r){const{gl:o}=this;o.linkProgram(r)}deleteProgram(r){const{gl:o}=this;o.deleteProgram(r)}getShaderParameter(r,o){const{gl:f}=this;return f.getShaderParameter(r,o)}getShaderInfoLog(r){const{gl:o}=this;return o.getShaderInfoLog(r)}createProgram(){const{gl:r}=this;return r.createProgram()}getProgramParameter(r,o){const{gl:f}=this;return f.getProgramParameter(r,o)}getProgramInfoLog(r){const{gl:o}=this;return o.getProgramInfoLog(r)}shaderSource(r,o){const{gl:f}=this;f.shaderSource(r,o)}deleteShader(r){const{gl:o}=this;o.deleteShader(r)}}function UM(h,r){return h.length!==r.length?!1:h.every((o,f)=>Array.isArray(o)||o instanceof Float32Array?!1:o===r[f])}class rS extends eh{constructor(o,f,p){super(o,f,p);N(this,"framebuffer");const v=o.createFramebuffer();et(v,"Unable to create framebuffer"),this.framebuffer=v}async onLoadRequest(){const{glw:o}=this,f=this._nativeCtxTexture=this.createNativeCtxTexture(),{width:p,height:v}=this.textureSource;return o.texImage2D(0,o.RGBA,p,v,0,o.RGBA,o.UNSIGNED_BYTE,null),this.setTextureMemUse(p*v*4),o.bindFramebuffer(this.framebuffer),o.framebufferTexture2D(o.COLOR_ATTACHMENT0,f,0),o.bindFramebuffer(null),{width:p,height:v}}}const BM=24;class dg extends XS{constructor(o){super(o);N(this,"glw");N(this,"system");N(this,"quadBuffer");N(this,"fQuadBuffer");N(this,"uiQuadBuffer");N(this,"renderOps",[]);N(this,"curBufferIdx",0);N(this,"curRenderOp",null);N(this,"rttNodes",[]);N(this,"activeRttNode",null);N(this,"defShaderCtrl");N(this,"defaultShader");N(this,"quadBufferCollection");N(this,"defaultTexture");N(this,"quadBufferUsage",0);N(this,"renderToTextureActive",!1);this.quadBuffer=new ArrayBuffer(this.stage.options.quadBufferSize),this.fQuadBuffer=new Float32Array(this.quadBuffer),this.uiQuadBuffer=new Uint32Array(this.quadBuffer),this.mode="webgl";const{canvas:f,clearColor:p,bufferMemory:v}=o;this.defaultTexture=new Qc(this.txManager),this.defaultTexture.setRenderableOwner(this,!0),this.defaultTexture.once("loaded",()=>{this.stage.requestRender()});const S=OI(f,o.contextSpy),a=this.glw=new OM(S),m=Zl(p);a.viewport(0,0,f.width,f.height),a.clearColor(m[0],m[1],m[2],m[3]),a.setBlend(!0),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),LM(a,v),this.system={parameters:RM(this.glw),extensions:_M(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;const _=a.createBuffer();et(_);const I=6*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new YS([{buffer:_,attributes:{a_position:{name:"a_position",size:2,type:a.FLOAT,normalized:!1,stride:I,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:a.FLOAT,normalized:!1,stride:I,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:a.UNSIGNED_BYTE,normalized:!0,stride:I,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:a.FLOAT,normalized:!1,stride:I,offset:5*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:o}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,o.setScissorTest(!1),o.clear()}getShaderManager(){return this.shManager}createCtxTexture(o){return o instanceof fa?new DM(this.glw,this.txMemManager,o):o instanceof Yl?new rS(this.glw,this.txMemManager,o):new eh(this.glw,this.txMemManager,o)}addQuad(o){const{fQuadBuffer:f,uiQuadBuffer:p}=this,{width:v,height:S,colorTl:a,colorTr:m,colorBl:_,colorBr:I,textureOptions:M,shader:R,shaderProps:U,alpha:x,clippingRect:L,tx:j,ty:H,ta:Y,tb:Z,tc:X,td:re,renderCoords:le,rtt:se,parentHasRenderTexture:W,framebufferDimensions:ce}=o;let{texture:E}=o;if(U!==null){if(Kc(U,"$dimensions")){const $=U.$dimensions;$.width=v,$.height=S}Kc(U,"$alpha")&&(U.$alpha=x)}E=E??this.defaultTexture,et(E instanceof ca,"Invalid texture type");let{curBufferIdx:F,curRenderOp:ue}=this;const ye={width:v,height:S},ge=R||this.defaultShader;et(ge instanceof dr),this.reuseRenderOp(o)||(this.newRenderOp(ge,U,x,ye,L,F,se,W,ce),ue=this.curRenderOp,et(ue));const ie=(M==null?void 0:M.flipX)??!1;let ee=(M==null?void 0:M.flipY)??!1;E instanceof Yl&&(ee=!ee);let de=0,Ee=0,Ie=1,ke=1;if(E instanceof fa){const{x:$,y:Pe,width:He,height:Se}=E.props,{width:V=0,height:Ae=0}=E.parentTexture.dimensions||{width:0,height:0};de=$/V,Ie=de+He/V,Ee=Pe/Ae,ke=Ee+Se/Ae,E=E.parentTexture}const Le=(M==null?void 0:M.resizeMode)??!1;if(E instanceof Jc&&Le&&E.dimensions){const{width:$,height:Pe}=E.dimensions;if(Le.type==="cover"){const He=v/$,Se=S/Pe,V=Math.max(He,Se),Ae=1/V;if(V&&He&&He<V){const Ce=Ae*v;de=(1-Ce/$)*(Le.clipX??.5),Ie=de+Ce/$}if(V&&Se&&Se<V){const Ce=Ae*S;Ee=(1-Ce/Pe)*(Le.clipY??.5),ke=Ee+Ce/Pe}}}ie&&([de,Ie]=[Ie,de]),ee&&([Ee,ke]=[ke,Ee]);const _e=E.ctxTexture;et(_e instanceof eh);const De=this.addTexture(_e,F);if(ue=this.curRenderOp,et(ue),le){const{x1:$,y1:Pe,x2:He,y2:Se,x3:V,y3:Ae,x4:Ce,y4:je}=le;f[F++]=$,f[F++]=Pe,f[F++]=de,f[F++]=Ee,p[F++]=a,f[F++]=De,f[F++]=He,f[F++]=Se,f[F++]=Ie,f[F++]=Ee,p[F++]=m,f[F++]=De,f[F++]=Ce,f[F++]=je,f[F++]=de,f[F++]=ke,p[F++]=_,f[F++]=De,f[F++]=V,f[F++]=Ae,f[F++]=Ie,f[F++]=ke,p[F++]=I,f[F++]=De}else if(Z!==0||X!==0)f[F++]=j,f[F++]=H,f[F++]=de,f[F++]=Ee,p[F++]=a,f[F++]=De,f[F++]=j+v*Y,f[F++]=H+v*X,f[F++]=Ie,f[F++]=Ee,p[F++]=m,f[F++]=De,f[F++]=j+S*Z,f[F++]=H+S*re,f[F++]=de,f[F++]=ke,p[F++]=_,f[F++]=De,f[F++]=j+v*Y+S*Z,f[F++]=H+v*X+S*re,f[F++]=Ie,f[F++]=ke,p[F++]=I,f[F++]=De;else{const $=j+v*Y,Pe=H+S*re;f[F++]=j,f[F++]=H,f[F++]=de,f[F++]=Ee,p[F++]=a,f[F++]=De,f[F++]=$,f[F++]=H,f[F++]=Ie,f[F++]=Ee,p[F++]=m,f[F++]=De,f[F++]=j,f[F++]=Pe,f[F++]=de,f[F++]=ke,p[F++]=_,f[F++]=De,f[F++]=$,f[F++]=Pe,f[F++]=Ie,f[F++]=ke,p[F++]=I,f[F++]=De}ue.length+=BM,ue.numQuads++,this.curBufferIdx=F}newRenderOp(o,f,p,v,S,a,m,_,I){const M=new qS(this.glw,this.options,this.quadBufferCollection,o,f,p,S,v,a,0,m,_,I);this.curRenderOp=M,this.renderOps.push(M)}addTexture(o,f,p){const{curRenderOp:v}=this;et(v);const S=v.addTexture(o);if(S===4294967295){if(p)throw new Error("Unable to add texture to render op");const{shader:a,shaderProps:m,dimensions:_,clippingRect:I,alpha:M}=v;return this.newRenderOp(a,m,M,_,I,f),this.addTexture(o,f,!0)}return S}reuseRenderOp(o){var _;const{shader:f,shaderProps:p,parentHasRenderTexture:v,rtt:S,clippingRect:a}=o,m=f||this.defaultShader;return!(((_=this.curRenderOp)==null?void 0:_.shader)!==m||!GI(this.curRenderOp.clippingRect,a)||v||S||this.curRenderOp.shader!==this.defaultShader&&(!p||!this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,p)))}addRenderOp(o){this.renderOps.push(o),this.curRenderOp=null}render(o="screen"){const{glw:f,quadBuffer:p}=this,v=new Float32Array(p,0,this.curBufferIdx),S=this.quadBufferCollection.getBuffer("a_position")??null;f.arrayBufferData(S,v,f.STATIC_DRAW),this.renderOps.forEach((a,m)=>{a.draw()}),this.quadBufferUsage=this.curBufferIdx*v.BYTES_PER_ELEMENT}renderToTexture(o){for(let f=0;f<this.rttNodes.length;f++)if(this.rttNodes[f]===o)return;this.rttNodes.unshift(o)}renderRTTNodes(){const{glw:o}=this;this.stage;for(let f=0;f<this.rttNodes.length;f++){const p=this.rttNodes[f];if(!p||!p.hasRTTupdates)continue;this.activeRttNode=p,et(p.texture,"RTT node missing texture");const v=p.texture.ctxTexture;et(v instanceof rS),this.renderToTextureActive=!0,o.bindFramebuffer(v.framebuffer),o.viewport(0,0,v.w,v.h),o.clear();for(let S=0;S<p.children.length;S++){const a=p.children[S];a&&(a.update(this.stage.deltaTime,{x:0,y:0,width:0,height:0,valid:!1}),this.stage.addQuads(a),a.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,p.hasRTTupdates=!1}o.bindFramebuffer(null),o.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(o){const f=this.rttNodes.indexOf(o);f!==-1&&this.rttNodes.splice(f,1)}getBufferInfo(){return{totalAvailable:this.stage.options.quadBufferSize,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}}const jM={LINE_FEED:10,CARRIAGE_RETURN:13,SPACE:32,TAB:9,ZERO_WIDTH_SPACE:8203,ZERO_WIDTH_NON_JOINER:8204,ZERO_WIDTH_JOINER:8205,LEFT_TO_RIGHT_MARK:8206,RIGHT_TO_LEFT_MARK:8207,LEFT_TO_RIGHT_EMBEDDING:8234,RIGHT_TO_LEFT_EMBEDDING:8235,POP_DIRECTIONAL_FORMATTING:8236,LEFT_TO_RIGHT_OVERRIDE:8237,RIGHT_TO_LEFT_OVERRIDE:8238,LINE_SEPARATOR:8232,PARAGRAPH_SEPARATOR:8233,OBJECT_REPLACEMENT_CHARACTER:65532,REPLACEMENT_CHARACTER:65533,ZERO_WIDTH_NO_BREAK_SPACE:65279,LEFT_TO_RIGHT_ISOLATE:8294,RIGHT_TO_LEFT_ISOLATE:8295,FIRST_STRONG_ISOLATE:8296,POP_DIRECTIONAL_ISOLATE:8297,INHIBIT_SYMMETRIC_SWAPPING:8298,ACTIVATE_SYMMETRIC_SWAPPING:8299,INHIBIT_ARABIC_FORM_SHAPING:8300,ACTIVATE_ARABIC_FORM_SHAPING:8301,NATIONAL_DIGIT_SHAPES:8302,NOMINAL_DIGIT_SHAPES:8303,LEFT_TO_RIGHT_BOUNDARY:8206,RIGHT_TO_LEFT_BOUNDARY:8207};class FM{}class $M extends FM{constructor(o,f){super();N(this,"data");N(this,"glyphMap");N(this,"kernings");this.data=o,this.glyphMap=f;const p=this.kernings={};o.kernings.forEach(v=>{const S=v.second,a=p[S]=p[S]||{};a[v.first]=v.amount}),this.kernings=p}*shapeText(o,f){var S;let p,v;for(;(p=f.peek())&&!p.done;){const a=p.value,m=this.glyphMap.get(a);if(f.next(),m!==void 0){const _=v!==void 0?(((S=this.kernings[m.id])==null?void 0:S[v])||0)+o.letterSpacing:0;v=m.id,yield{mapped:!0,glyphId:m.id,codepoint:a,cluster:f.lastIndex,xAdvance:m.xadvance+_,yAdvance:0,xOffset:m.xoffset+_,yOffset:m.yoffset,xBearing:0,yBearing:0,width:m.width,height:m.height}}else a===jM.LINE_FEED&&(v=void 0),yield{mapped:!1,codepoint:a,cluster:f.lastIndex}}}}class eg extends WS{constructor(o,f){super(f);N(this,"type");N(this,"texture");N(this,"maxCharHeight",0);N(this,"data");N(this,"shaper");N(this,"glyphMap",new Map);const{atlasUrl:p,atlasDataUrl:v,stage:S}=f;this.type=o;const a=S.renderer;et(a instanceof dg,"SDF Font Faces can only be used with the WebGL Renderer"),this.texture=S.txManager.loadTexture("ImageTexture",{src:p,premultiplyAlpha:!1}),this.texture.on("loaded",()=>{this.checkLoaded(),S.requestRender()}),this.texture.ctxTexture.load(),fetch(v).then(async m=>{var I;this.data=await m.json(),et(this.data);let _=0;if(this.data.chars.forEach(M=>{this.glyphMap.set(M.id,M);const R=M.yoffset+M.height;R>_&&(_=R)}),this.maxCharHeight=_,this.shaper=new $M(this.data,this.glyphMap),!this.metrics)if((I=this.data)!=null&&I.lightningMetrics){const{ascender:M,descender:R,lineGap:U,unitsPerEm:x}=this.data.lightningMetrics;this.metrics={ascender:M/x,descender:R/x,lineGap:U/x}}else throw new Error(`Font metrics not found in ${this.type} font ${this.fontFamily}. Make sure you are using the latest version of the Lightning 3 \`msdf-generator\` tool to generate your SDF fonts.`);this.checkLoaded()}).catch(console.error)}getAtlasEntry(o){const f=this.glyphMap.get(o);if(f===void 0)throw new Error(`Glyph ${o} not found in font ${this.fontFamily}`);return{x:f.x,y:f.y,width:f.width,height:f.height}}checkLoaded(){this.loaded||this.texture.state==="loaded"&&this.data&&(this.loaded=!0,this.emit("loaded"))}}const VM=24;function HM(h,r,o,f,p,v,S,a,m){const _=Math.min(Math.max(S.firstLineIdx,0),a.length),I=0,{metrics:M}=o;et(M,"Font metrics not loaded"),et(o.data,"Font data not loaded");const R=(M.ascender-M.descender)*h;let U=0;f==="middle"?U=(r-R)/2:f==="bottom"&&(U=r-R);const x=p/v,L=o.data.common.base,H=M.ascender*h-L,Y=x+H+_*r+U;if(!(m&&Y>=m/v))return{sdfX:I,sdfY:Y,lineIndex:_}}class Vl{constructor(r,o=0){N(this,"iterator");N(this,"peekBuffer",[]);N(this,"_lastIndex");this.iterator=r,this.iterator=r,this._lastIndex=o-1,this.peekBuffer=[]}next(){const r=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return r.done?this._lastIndex=-1:this._lastIndex++,r}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const r=this.iterator.next();return this.peekBuffer.push(r),r}get lastIndex(){return this._lastIndex}}function*Hl(h,r=0){let o=r;for(;o<h.length;){const f=h.codePointAt(o);if(f===void 0)throw new Error("Invalid Unicode code point");yield f,o+=f<=65535?1:2}}function zM(h,r,o){const f=o.shapeText(r,new Vl(Hl(h,0),0));let p=0;for(const v of f)v.mapped&&(p+=v.xAdvance);return p}function GM(h,r,o,f,p,v,S,a,m,_,I,M,R,U,x,L,j,H,Y){et(x,"Font face must be loaded"),et(x.loaded,"Font face must be loaded"),et(x.data,"Font face must be loaded"),et(x.shaper,"Font face must be loaded");const Z=a/x.data.info.size,X=m/Z,re=v/Z,le=_/Z,se=R[h],W=(se==null?void 0:se.codepointIndex)||0,ce=(se==null?void 0:se.maxX)||0,E=(se==null?void 0:se.maxY)||0;let F=ce,ue=E,ye=r,ge=o,ie=0;const ee={codepointIndex:-1,bufferOffset:-1,xStart:-1},de=x.shaper,Ee={letterSpacing:le};let Ie=de.shapeText(Ee,new Vl(Hl(f,W),W)),ke,Le=-1;const _e=[],De=S/Z,$=zM(H,Ee,de);let Pe=!0;for(;Pe;){const He=(Y===0||h+1<Y)&&(M!=="both"||j||ge+X+x.maxCharHeight<=De),Se=He?re:re-$;let V=0;const Ae=ge+x.maxCharHeight>=U.y1,Ce=ge<=U.y2,je=Ae&&Ce;for(;(ke=Ie.next())&&!ke.done;){const he=ke.value;if(h===R.length)R.push({codepointIndex:he.cluster,maxY:ue,maxX:F});else if(h>R.length)throw new Error("Unexpected lineCache length");if(he.codepoint===32||he.codepoint===10?ee.codepointIndex!==-1&&(ee.codepointIndex=-1,V=ye):ee.codepointIndex===-1&&(ee.codepointIndex=he.cluster,ee.bufferOffset=ie,ee.xStart=V),he.mapped){const Re=ye+he.xOffset+he.width;if(M!=="none"&&Re>=Se&&ee.codepointIndex!==-1&&ee.xStart>0)if(He){Ie=de.shapeText(Ee,new Vl(Hl(f,ee.codepointIndex),ee.codepointIndex)),ie=ee.bufferOffset;break}else Ie=de.shapeText(Ee,new Vl(Hl(H,0),0)),ye=ee.xStart,ie=ee.bufferOffset,M="none";else{const Ve=ye+he.xOffset,ae=ge+he.yOffset;if(je){Le===-1&&(Le=ie);const Q=x.getAtlasEntry(he.glyphId),be=Q.x/x.data.common.scaleW,st=Q.y/x.data.common.scaleH,Xe=Q.width/x.data.common.scaleW,Fe=Q.height/x.data.common.scaleH;I[ie++]=Ve,I[ie++]=ae,I[ie++]=be,I[ie++]=st,I[ie++]=Ve+he.width,I[ie++]=ae,I[ie++]=be+Xe,I[ie++]=st,I[ie++]=Ve,I[ie++]=ae+he.height,I[ie++]=be,I[ie++]=st+Fe,I[ie++]=Ve+he.width,I[ie++]=ae+he.height,I[ie++]=be+Xe,I[ie++]=st+Fe}ue=Math.max(ue,ae+he.height),F=Math.max(F,Ve+he.width),ye+=he.xAdvance}}else if(he.codepoint===10){if(He)break;Ie=de.shapeText(Ee,new Vl(Hl(H,0),0)),M="none"}}Le!==-1&&(_e.push({bufferStart:Le,bufferEnd:ie}),Le=-1),ye=0,ge+=X,h++,ee.codepointIndex=-1,V=0,!L&&M==="both"&&ge>U.y2||ke&&ke.done?Pe=!1:He||(Pe=!1)}if(p==="center"){const He=M==="none"?F:re;for(let Se=0;Se<_e.length;Se++){const V=_e[Se],Ae=I[V.bufferEnd-4]-I[V.bufferStart],Ce=(He-Ae)/2;for(let je=V.bufferStart;je<V.bufferEnd;je+=4)I[je]+=Ce}}else if(p==="right"){const He=M==="none"?F:re;for(let Se=0;Se<_e.length;Se++){const V=_e[Se],Ae=V.bufferEnd===V.bufferStart?0:I[V.bufferEnd-4]-I[V.bufferStart],Ce=He-Ae;for(let je=V.bufferStart;je<V.bufferEnd;je+=4)I[je]+=Ce}}return et(ke),{bufferNumFloats:ie,bufferNumQuads:ie/16,layoutNumCharacters:ke.done?f.length-W:ke.value.cluster-W+1,fullyProcessed:!!ke.done,maxX:F,maxY:ue,numLines:R.length}}function XM(h,r){return Math.ceil(h/r)*r}function WM(h,r){return Math.floor(h/r)*r}function qM(h,r,o,f,p,v,S,a){const{screen:m,sdf:_}=h;if(!WI(S))m.x1=0,m.y1=0,m.x2=0,m.y2=0,_.x1=0,_.y1=0,_.x2=0,_.y2=0,h.numLines=0,h.firstLineIdx=0;else{const I=S.x1-r,M=I+(S.x2-S.x1),R=S.y1-o+f,U=WM(R-v,p||1),x=XM(R+(S.y2-S.y1)+v,p||1);m.x1=I,m.y1=U,m.x2=M,m.y2=x,_.x1=I/a,_.y1=U/a,_.x2=M/a,_.y2=x/a,h.numLines=Math.ceil((x-U)/p),h.firstLineIdx=p?Math.floor(U/p):0}h.valid=!0}function KS(h,r){return r*(h.ascender-h.descender+h.lineGap)}const YM={x:0,y:0,width:0,height:0};class KM extends hg{constructor(o){super(o);N(this,"ssdfFontFamilies",{});N(this,"msdfFontFamilies",{});N(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]);N(this,"sdfShader");N(this,"rendererBounds");N(this,"type","sdf");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(o,f)=>{o.props.fontFamily=f,this.releaseFontFace(o),this.invalidateLayoutCache(o)},fontWeight:(o,f)=>{o.props.fontWeight=f,this.releaseFontFace(o),this.invalidateLayoutCache(o)},fontStyle:(o,f)=>{o.props.fontStyle=f,this.releaseFontFace(o),this.invalidateLayoutCache(o)},fontStretch:(o,f)=>{o.props.fontStretch=f,this.releaseFontFace(o),this.invalidateLayoutCache(o)},fontSize:(o,f)=>{o.props.fontSize=f,this.invalidateLayoutCache(o)},text:(o,f)=>{o.props.text=f,this.invalidateLayoutCache(o)},textAlign:(o,f)=>{o.props.textAlign=f,this.invalidateLayoutCache(o)},color:(o,f)=>{o.props.color=f},x:(o,f)=>{o.props.x=f,o.elementBounds.valid&&(this.setElementBoundsX(o),!o.renderWindow.valid&&L0(o.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(o))},y:(o,f)=>{o.props.y=f,o.elementBounds.valid&&(this.setElementBoundsY(o),!o.renderWindow.valid&&L0(o.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(o))},contain:(o,f)=>{o.props.contain=f,this.invalidateLayoutCache(o)},width:(o,f)=>{o.props.width=f,o.props.contain!=="none"&&this.invalidateLayoutCache(o)},height:(o,f)=>{o.props.height=f,o.props.contain==="both"&&this.invalidateLayoutCache(o)},offsetY:(o,f)=>{o.props.offsetY=f,this.invalidateLayoutCache(o)},scrollable:(o,f)=>{o.props.scrollable=f,this.invalidateLayoutCache(o)},scrollY:(o,f)=>{o.props.scrollY=f,this.scheduleUpdateState(o)},letterSpacing:(o,f)=>{o.props.letterSpacing=f,this.invalidateLayoutCache(o)},lineHeight:(o,f)=>{o.props.lineHeight=f,o.resLineHeight=void 0,this.invalidateLayoutCache(o)},maxLines:(o,f)=>{o.props.maxLines=f,this.invalidateLayoutCache(o)},textBaseline:(o,f)=>{o.props.textBaseline=f,this.invalidateLayoutCache(o)},verticalAlign:(o,f)=>{o.props.verticalAlign=f,this.invalidateLayoutCache(o)},overflowSuffix:(o,f)=>{o.props.overflowSuffix=f,this.invalidateLayoutCache(o)},debug:(o,f)=>{o.props.debug=f}}}canRenderFont(o){const{fontFamily:f}=o;return f in this.ssdfFontFamilies||f in this.msdfFontFamilies||f==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(o){return o instanceof eg}addFontFace(o){et(o instanceof eg);const f=o.fontFamily,p=o.type==="ssdf"?this.ssdfFontFamilies:o.type==="msdf"?this.msdfFontFamilies:void 0;if(!p){console.warn(`Invalid font face type: ${o.type}`);return}let v=p[f];v||(v=new Set,p[f]=v),v.add(o)}createState(o){return{props:o,status:"initialState",updateScheduled:!1,emitter:new hr,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(o){let{trFontFace:f}=o;const{textH:p,lineCache:v,debugData:S,forceFullLayoutCalc:a}=o;if(S.updateCount++,o.status==="initialState"&&this.setStatus(o,"loading"),!f){if(f=this.resolveFontFace(o.props),o.trFontFace=f,!f){const de=`SdfTextRenderer: Could not resolve font face for family: '${o.props.fontFamily}'`;console.error(de),this.setStatus(o,"failed",new Error(de));return}f.texture.setRenderableOwner(o,!0)}if(!f.loaded){f.once("loaded",()=>{this.scheduleUpdateState(o)});return}et(f.data,"Font face data should be loaded"),et(f.metrics,"Font face metrics should be loaded");const{text:m,fontSize:_,x:I,y:M,contain:R,width:U,height:x,verticalAlign:L,scrollable:j,overflowSuffix:H,maxLines:Y}=o.props,Z=R==="both"&&j?o.props.scrollY:0,{renderWindow:X}=o,re=f.data.info.size,le=_/re;let se=o.resLineHeight;if(se===void 0){const de=o.props.lineHeight;de===void 0?se=KS(f.metrics,_):se=de,o.resLineHeight=se}const W=se/le;o.distanceRange=le*f.data.distanceField.distanceRange;const ce=m.length*VM;let E=o.vertexBuffer;(!E||E.length<ce)&&(E=new Float32Array(ce*2));const F=o.elementBounds;if(F.valid||(this.setElementBoundsX(o),this.setElementBoundsY(o),F.valid=!0),!a&&X.valid){const de=X.screen;if(I+de.x1<=F.x1&&I+de.x2>=F.x2&&M-Z+de.y1<=F.y1&&M-Z+de.y2>=F.y2){this.setStatus(o,"loaded");return}X.valid=!1,this.setStatus(o,"loading")}const{offsetY:ue,textAlign:ye}=o.props;if(!X.valid){if(!L0(F,this.rendererBounds))return;qM(X,I,M,Z,se,R==="both"?F.y2-F.y1:0,F,le)}const ge=HM(re,W,f,L,ue,le,X,v,p);if(!ge){this.setStatus(o,"loaded");return}const{letterSpacing:ie}=o.props,ee=GM(ge.lineIndex,ge.sdfX,ge.sdfY,m,ye,U,x,_,se,ie,E,R,v,X.sdf,f,a,j,H,Y);o.bufferUploaded=!1,o.bufferNumFloats=ee.bufferNumFloats,o.bufferNumQuads=ee.bufferNumQuads,o.vertexBuffer=E,o.renderWindow=X,S.lastLayoutNumCharacters=ee.layoutNumCharacters,S.bufferSize=E.byteLength,ee.fullyProcessed&&(o.textW=ee.maxX*le,o.textH=ee.numLines*W*le),this.setStatus(o,"loaded")}renderQuads(o,f,p,v,S,a){var F,ue;if(!o.vertexBuffer)return;const m=this.stage.renderer;et(m instanceof dg);const{fontSize:_,color:I,contain:M,scrollable:R,zIndex:U,debug:x}=o.props,L=M==="both"&&R?o.props.scrollY:0,{textW:j=0,textH:H=0,distanceRange:Y,vertexBuffer:Z,bufferUploaded:X,trFontFace:re,elementBounds:le}=o;let{webGlBuffers:se}=o;if(!se){const ye=m.glw,ge=4*Float32Array.BYTES_PER_ELEMENT,ie=ye.createBuffer();et(ie),o.webGlBuffers=new YS([{buffer:ie,attributes:{a_position:{name:"a_position",size:2,type:ye.FLOAT,normalized:!1,stride:ge,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:ye.FLOAT,normalized:!1,stride:ge,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),o.bufferUploaded=!1,et(o.webGlBuffers),se=o.webGlBuffers}if(!X){const ye=m.glw,ge=(se==null?void 0:se.getBuffer("a_textureCoordinate"))??null;ye.arrayBufferData(ge,Z,ye.STATIC_DRAW),o.bufferUploaded=!0}if(et(re),R&&M==="both"){et(le.valid);const ye=zI(le,YM);p.valid?(o.clippingRect.valid=!0,p=OS(p,ye,o.clippingRect)):(o.clippingRect.valid=!0,p=US(ye,o.clippingRect))}const W=new qS(m.glw,m.options,se,this.sdfShader,{transform:f.getFloatArr(),color:UI(I,v),size:_/(((F=re.data)==null?void 0:F.info.size)||0),scrollY:L,distanceRange:Y,debug:x.sdfShaderDebug},v,p,{height:H,width:j},0,U,!1,S,a),ce=(ue=o.trFontFace)==null?void 0:ue.texture;et(ce);const E=ce.ctxTexture;W.addTexture(E),W.length=o.bufferNumFloats,W.numQuads=o.bufferNumQuads,m.addRenderOp(W)}setIsRenderable(o,f){var p;super.setIsRenderable(o,f),(p=o.trFontFace)==null||p.texture.setRenderableOwner(o,f)}destroyState(o){var f;super.destroyState(o),(f=o.trFontFace)==null||f.texture.setRenderableOwner(o,!1)}resolveFontFace(o){return ug.resolveFontFace(this.fontFamilyArray,o)}releaseFontFace(o){o.resLineHeight=void 0,o.trFontFace&&(o.trFontFace.texture.setRenderableOwner(o,!1),o.trFontFace=void 0)}invalidateLayoutCache(o){o.renderWindow.valid=!1,o.elementBounds.valid=!1,o.textH=void 0,o.textW=void 0,o.lineCache=[],this.setStatus(o,"loading"),this.scheduleUpdateState(o)}setElementBoundsX(o){const{x:f,contain:p,width:v}=o.props,{elementBounds:S}=o;S.x1=f,S.x2=p!=="none"?f+v:1/0}setElementBoundsY(o){const{y:f,contain:p,height:v}=o.props,{elementBounds:S}=o;S.y1=f,S.y2=p==="both"?f+v:1/0}}function ZM(h,r,o){if(r.metrics)return r.metrics;const f=h.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz");console.warn(`Font metrics not provided for Canvas Web font ${r.fontFamily}. Using fallback values. It is HIGHLY recommended you use the latest version of the Lightning 3 \`msdf-generator\` tool to extract the default metrics for the font and provide them in the Canvas Web font definition.`);let p;return f.actualBoundingBoxDescent&&f.actualBoundingBoxAscent?p={ascender:f.actualBoundingBoxAscent/o,descender:-f.actualBoundingBoxDescent/o,lineGap:.2}:p={ascender:.8,descender:-.2,lineGap:.2},r.metrics=p,p}const sS=2048;function aS(h,r,o,f,p){const v=h!=="bottom"?.5*r:0;return o*(f-1)+v+Math.max(o,r)+(p||0)}class QM{constructor(r,o){N(this,"_canvas");N(this,"_context");N(this,"_settings");this._canvas=r,this._context=o,this._settings=this.mergeDefaults({})}set settings(r){this._settings=this.mergeDefaults(r)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const r=[this._settings.fontFamily],o=[];for(let f=0,p=r.length;f<p;f++)r[f]==="serif"||r[f]==="sans-serif"?o.push(r[f]):o.push(`"${r[f]}"`);return`${this._settings.fontStyle} ${this._settings.fontSize*this.getPrecision()}px ${o.join(",")}`}_load(){if(document.fonts){const r=this._getFontSetting();try{if(!document.fonts.check(r,this._settings.text))return document.fonts.load(r,this._settings.text).catch(o=>{console.warn("[Lightning] Font load error",o,r)}).then(()=>{document.fonts.check(r,this._settings.text)||console.warn("[Lightning] Font not found",r)})}catch{console.warn("[Lightning] Can't check font loading for "+r)}}}calculateRenderInfo(){const r={},o=this.getPrecision(),f=this._settings.paddingLeft*o,p=this._settings.paddingRight*o,v=this._settings.fontSize*o;let S=this._settings.offsetY===null?null:this._settings.offsetY*o;const a=this._settings.w*o,m=this._settings.h*o;let _=this._settings.wordWrapWidth*o;const I=this._settings.cutSx*o,M=this._settings.cutEx*o,R=this._settings.cutSy*o,U=this._settings.cutEy*o,x=(this._settings.letterSpacing||0)*o,L=this._settings.textIndent*o,j=this._settings.trFontFace;this.setFontProperties(),et(j);const H=ZM(this._context,j,v),Y=KS(H,v)*o,Z=this._settings.lineHeight!==null?this._settings.lineHeight*o:Y,X=this._settings.maxHeight,re=X!==null&&Z>0?Math.floor(X/Z):0,le=this._settings.maxLines,se=re>0&&le>0?Math.min(re,le):Math.max(re,le);let W=a||2048/this.getPrecision(),ce=W-f;if(ce<10&&(W+=10-ce,ce=10),_||(_=ce),this._settings.textOverflow&&!this._settings.wordWrap){let ie;switch(this._settings.textOverflow){case"clip":ie="";break;case"ellipsis":ie=this._settings.overflowSuffix;break;default:ie=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,_-L,ie)}let E;if(this._settings.wordWrap)E=this.wrapText(this._settings.text,_,x,L);else{E={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const ie=E.l.length;for(let ee=0;ee<ie-1;ee++)E.n.push(ee)}let F=E.l;if(se&&F.length>se){const ie=F.slice(0,se);let ee=null;if(this._settings.overflowSuffix){const Le=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,_e=this.wrapText(ie[ie.length-1],_-Le,x,L);ie[ie.length-1]=`${_e.l[0]}${this._settings.overflowSuffix}`,ee=[_e.l.length>1?_e.l[1]:""]}else ee=[""];let de;const Ee=F.length;let Ie=0;const ke=E.n.length;for(de=se;de<Ee;de++)ee[Ie]+=`${ee[Ie]?" ":""}${F[de]}`,de+1<ke&&E.n[de+1]&&Ie++;r.remainingText=ee.join(`
`),r.moreTextLines=!0,F=ie}else r.moreTextLines=!1,r.remainingText="";let ue=0;const ye=[];for(let ie=0;ie<F.length;ie++){const ee=this.measureText(F[ie],x)+(ie===0?L:0);ye.push(ee),ue=Math.max(ue,ee)}r.lineWidths=ye,a||(W=ue+f+p,ce=ue);let ge;return m?ge=m:ge=aS(this._settings.textBaseline,v,Z,F.length,S),S===null&&(S=v),r.w=W,r.h=ge,r.lines=F,r.precision=o,W||(W=1),ge||(ge=1),(I||M)&&(W=Math.min(W,M-I)),(R||U)&&(ge=Math.min(ge,U-R)),r.width=W,r.innerWidth=ce,r.height=ge,r.fontSize=v,r.cutSx=I,r.cutSy=R,r.cutEx=M,r.cutEy=U,r.lineHeight=Z,r.defLineHeight=Y,r.lineWidths=ye,r.offsetY=S,r.paddingLeft=f,r.paddingRight=p,r.letterSpacing=x,r.textIndent=L,r.metrics=H,r}draw(r,o){const f=this.getPrecision(),p=(o==null?void 0:o.lines)||r.lines,v=(o==null?void 0:o.lineWidths)||r.lineWidths,S=o?aS(this._settings.textBaseline,r.fontSize,r.lineHeight,o.lines.length,this._settings.offsetY===null?null:this._settings.offsetY*f):r.height;this._canvas.width=Math.min(Math.ceil(r.width+this._settings.textRenderIssueMargin),sS),this._canvas.height=Math.min(Math.ceil(S),sS),this.setFontProperties(),r.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(r.cutSx||r.cutSy)&&this._context.translate(-r.cutSx,-r.cutSy);let a,m;const _=[],{metrics:I}=r,M=I?I.ascender*r.fontSize:r.fontSize,R=(I.ascender-I.descender)*r.fontSize;for(let x=0,L=p.length;x<L;x++)a=x===0?r.textIndent:0,m=x*r.lineHeight+M,this._settings.verticalAlign=="middle"?m+=(r.lineHeight-R)/2:this._settings.verticalAlign=="bottom"&&(m+=r.lineHeight-R),this._settings.textAlign==="right"?a+=r.innerWidth-v[x]:this._settings.textAlign==="center"&&(a+=(r.innerWidth-v[x])/2),a+=r.paddingLeft,_.push({text:p[x],x:a,y:m,w:v[x]});if(this._settings.highlight){const x=this._settings.highlightColor,L=this._settings.highlightHeight*f||r.fontSize*1.5,j=this._settings.highlightOffset*f,H=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*f:r.paddingLeft,Y=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*f:r.paddingRight;this._context.fillStyle=_0(x);for(let Z=0;Z<_.length;Z++){const X=_[Z];this._context.fillRect(X.x-H,X.y-r.offsetY+j,X.w+Y+H,L)}}let U=null;this._settings.shadow&&(U=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=_0(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*f,this._context.shadowOffsetY=this._settings.shadowOffsetY*f,this._context.shadowBlur=this._settings.shadowBlur*f),this._context.fillStyle=_0(this._settings.textColor);for(let x=0,L=_.length;x<L;x++){const j=_[x];if(r.letterSpacing===0)this._context.fillText(j.text,j.x,j.y);else{const H=j.text.split("");let Y=j.x;for(let Z=0,X=H.length;Z<X;Z++)this._context.fillText(H[Z],Y,j.y),Y+=this.measureText(H[Z],r.letterSpacing)}}U&&(this._context.shadowColor=U[0],this._context.shadowOffsetX=U[1],this._context.shadowOffsetY=U[2],this._context.shadowBlur=U[3]),(r.cutSx||r.cutSy)&&this._context.translate(r.cutSx,r.cutSy)}wrapWord(r,o,f){const p=this._context.measureText(f).width,v=r.length,S=this._context.measureText(r).width;if(S<=o)return r;let a=Math.floor(o*v/S),m=this._context.measureText(r.substring(0,a)).width+p;if(m>o)for(;a>0&&(m=this._context.measureText(r.substring(0,a)).width+p,m>o);)a-=1;else for(;a<v;)if(m=this._context.measureText(r.substring(0,a)).width+p,m<o)a+=1;else{a-=1;break}return r.substring(0,a)+(o>=p?f:"")}wrapText(r,o,f,p=0){const v=r.split(/\r?\n/g);let S=[];const a=[];for(let m=0;m<v.length;m++){const _=[];let I="",M=o-p;const R=v[m].split(" ");for(let U=0;U<R.length;U++){const x=this.measureText(R[U],f),L=x+this.measureText(" ",f);U===0||L>M?(U>0&&(_.push(I),I=""),I+=R[U],M=o-x-(U===0?p:0)):(M-=L,I+=` ${R[U]}`)}_.push(I),I="",S=S.concat(_),m<v.length-1&&a.push(S.length)}return{l:S,n:a}}measureText(r,o=0){return o?r.split("").reduce((f,p)=>f+this._context.measureText(p).width+o,0):this._context.measureText(r).width}mergeDefaults(r){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFamily:null,trFontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxHeight:null,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...r}}}const lS=typeof self>"u"?globalThis:self;var IS;const uS=((IS=lS.document)==null?void 0:IS.fonts)||lS.fonts;function JM(h){const{fontFamily:r,fontStyle:o,fontWeight:f,fontStretch:p,fontSize:v}=h;return[o,f,p,`${v}px`,r].join(" ")}class eR extends hg{constructor(o){super(o);N(this,"canvas");N(this,"context");N(this,"fontFamilies",{});N(this,"fontFamilyArray",[this.fontFamilies]);N(this,"type","canvas");N(this,"loadFont",o=>{const f=JM(o.props),p=ug.resolveFontFace(this.fontFamilyArray,o.props);if(et(p,`Could not resolve font face for ${f}`),o.fontInfo={fontFace:p,cssString:f,loaded:!1},!o.fontInfo.loaded){uS.load(f).then(this.onFontLoaded.bind(this,o,f)).catch(this.onFontLoadError.bind(this,o,f));return}});typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let f=this.canvas.getContext("2d",{willReadFrequently:!0});f||(this.canvas=document.createElement("canvas"),f=this.canvas.getContext("2d",{willReadFrequently:!0})),et(f),this.context=f,this.addFontFace(new zc({fontFamily:"sans-serif",descriptors:{},fontUrl:""}))}getPropertySetters(){return{fontFamily:(o,f)=>{o.props.fontFamily=f,o.fontInfo=void 0,this.invalidateLayoutCache(o)},fontWeight:(o,f)=>{o.props.fontWeight=f,o.fontInfo=void 0,this.invalidateLayoutCache(o)},fontStyle:(o,f)=>{o.props.fontStyle=f,o.fontInfo=void 0,this.invalidateLayoutCache(o)},fontStretch:(o,f)=>{o.props.fontStretch=f,o.fontInfo=void 0,this.invalidateLayoutCache(o)},fontSize:(o,f)=>{o.props.fontSize=f,o.fontInfo=void 0,this.invalidateLayoutCache(o)},text:(o,f)=>{o.props.text=f,this.invalidateLayoutCache(o)},textAlign:(o,f)=>{o.props.textAlign=f,this.invalidateLayoutCache(o)},color:(o,f)=>{o.props.color=f,this.invalidateLayoutCache(o)},x:(o,f)=>{o.props.x=f},y:(o,f)=>{o.props.y=f},contain:(o,f)=>{o.props.contain=f,this.invalidateLayoutCache(o)},width:(o,f)=>{o.props.width=f,o.props.contain!=="none"&&this.invalidateLayoutCache(o)},height:(o,f)=>{o.props.height=f,o.props.contain==="both"&&this.invalidateLayoutCache(o)},offsetY:(o,f)=>{o.props.offsetY=f,this.invalidateLayoutCache(o)},scrollY:(o,f)=>{o.props.scrollY=f},letterSpacing:(o,f)=>{o.props.letterSpacing=f,this.invalidateLayoutCache(o)},lineHeight:(o,f)=>{o.props.lineHeight=f,this.invalidateLayoutCache(o)},maxLines:(o,f)=>{o.props.maxLines=f,this.invalidateLayoutCache(o)},textBaseline:(o,f)=>{o.props.textBaseline=f,this.invalidateLayoutCache(o)},verticalAlign:(o,f)=>{o.props.verticalAlign=f,this.invalidateLayoutCache(o)},overflowSuffix:(o,f)=>{o.props.overflowSuffix=f,this.invalidateLayoutCache(o)}}}canRenderFont(o){return!0}isFontFaceSupported(o){return o instanceof zc}addFontFace(o){et(o instanceof zc),o.fontFamily!=="sans-serif"&&uS.add(o.fontFace);const{fontFamilies:f}=this,p=o.fontFace.family;let v=f[p];v||(v=new Set,f[p]=v),v.add(o)}createState(o,f){return{node:f,props:o,status:"initialState",updateScheduled:!1,emitter:new hr,textureNode:void 0,lightning2TextRenderer:new QM(this.canvas,this.context),renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(o){if(o.status==="initialState"&&this.setStatus(o,"loading"),o.status!=="loaded"){if(!o.fontInfo)return this.loadFont(o);o.fontInfo.loaded&&(o.renderInfo||(o.renderInfo=this.calculateRenderInfo(o),o.textH=o.renderInfo.lineHeight*o.renderInfo.lines.length,o.textW=o.renderInfo.width,this.renderSingleCanvasPage(o)))}}renderSingleCanvasPage(o){et(o.renderInfo);const f=o.node,p=this.stage.txManager.loadTexture("ImageTexture",{src:(function(v,S){return et(S),v.draw(S,{lines:S.lines,lineWidths:S.lineWidths}),this.canvas.width===0||this.canvas.height===0?null:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)}).bind(this,o.lightning2TextRenderer,o.renderInfo)});if(o.textureNode)o.textureNode.texture=p;else{const v=this.stage.createNode({parent:f,texture:p,autosize:!0,alpha:HI(o.props.color)});o.textureNode=v}this.setStatus(o,"loaded")}calculateRenderInfo(o){var f;return o.lightning2TextRenderer.settings={text:o.props.text,textAlign:o.props.textAlign,fontFamily:o.props.fontFamily,trFontFace:(f=o.fontInfo)==null?void 0:f.fontFace,fontSize:o.props.fontSize,fontStyle:[o.props.fontStretch,o.props.fontStyle,o.props.fontWeight].join(" "),textColor:Zl(o.props.color),offsetY:o.props.offsetY,wordWrap:o.props.contain!=="none",wordWrapWidth:o.props.contain==="none"?void 0:o.props.width,letterSpacing:o.props.letterSpacing,lineHeight:o.props.lineHeight??null,maxLines:o.props.maxLines,maxHeight:o.props.contain==="both"?o.props.height-o.props.offsetY:null,textBaseline:o.props.textBaseline,verticalAlign:o.props.verticalAlign,overflowSuffix:o.props.overflowSuffix,w:o.props.contain!=="none"?o.props.width:void 0},o.renderInfo=o.lightning2TextRenderer.calculateRenderInfo(),o.renderInfo}renderQuads(){}destroyState(o){o.status!=="destroyed"&&(super.destroyState(o),o.textureNode&&(o.textureNode.destroy(),delete o.textureNode),delete o.renderInfo)}invalidateLayoutCache(o){o.renderInfo=void 0,this.setStatus(o,"loading"),this.scheduleUpdateState(o)}onFontLoaded(o,f){var p;f!==((p=o.fontInfo)==null?void 0:p.cssString)||!o.fontInfo||(o.fontInfo.loaded=!0,this.scheduleUpdateState(o))}onFontLoadError(o,f,p){var v;f!==((v=o.fontInfo)==null?void 0:v.cssString)||!o.fontInfo||(o.fontInfo.loaded=!0,console.error(`CanvasTextRenderer: Error loading font '${o.fontInfo.cssString}'`,p),this.scheduleUpdateState(o))}}const tR={isWhite:!0,a:1,r:255,g:255,b:255};function O0(h){if(h===4294967295)return tR;const r=(h>>>24&255)/255,o=h>>>16&255&255,f=h>>>8&255&255,p=h&255&255;return{isWhite:!1,a:r,r:p,g:f,b:o}}function Gc({a:h,r,g:o,b:f}){return`rgba(${r},${o},${f},${h})`}class nR extends GS{constructor(){super(...arguments);N(this,"image");N(this,"tintCache")}load(){this.textureSource.state==="freed"&&(this.textureSource.setState("loading"),this.onLoadRequest().then(o=>{this.textureSource.setState("loaded",o),this.updateMemSize()}).catch(o=>{this.textureSource.setState("failed",o)}))}free(){this.image=void 0,this.tintCache=void 0,this.textureSource.setState("freed"),this.setTextureMemUse(0)}updateMemSize(){const o=this.tintCache?8:4;if(this.textureSource.dimensions){const{width:f,height:p}=this.textureSource.dimensions;this.setTextureMemUse(f*p*o)}}hasImage(){return this.image!==void 0}getImage(o){var S;const f=this.image;if(et(f,"Attempt to get unloaded image texture"),o.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),f;const p=Gc(o);if(((S=this.tintCache)==null?void 0:S.key)===p)return this.tintCache.image;const v=this.tintTexture(f,p);return this.tintCache={key:p,image:v},this.updateMemSize(),v}tintTexture(o,f){const{width:p,height:v}=o,S=document.createElement("canvas");S.width=p,S.height=v;const a=S.getContext("2d");return a&&(a.fillStyle=f,a.globalCompositeOperation="copy",a.fillRect(0,0,p,v),a.globalCompositeOperation="multiply",a.drawImage(o,0,0,p,v,0,0,p,v),a.globalCompositeOperation="destination-in",a.drawImage(o,0,0,p,v,0,0,p,v)),S}async onLoadRequest(){const{data:o}=await this.textureSource.getTextureData();if(o instanceof ImageData){const f=document.createElement("canvas");f.width=o.width,f.height=o.height;const p=f.getContext("2d");return p&&p.putImageData(o,0,0),this.image=f,{width:o.width,height:o.height}}else if(typeof ImageBitmap<"u"&&o instanceof ImageBitmap)return this.image=o,{width:o.width,height:o.height};return{width:0,height:0}}}function iR(h){var r;return h.shader instanceof cg&&h.shader.shType===zS?((r=h.shaderProps)==null?void 0:r.radius)??0:0}class oR extends XS{constructor(o){super(o);N(this,"context");N(this,"canvas");N(this,"pixelRatio");N(this,"clearColor");N(this,"renderToTextureActive",!1);N(this,"activeRttNode",null);N(this,"defShaderCtr");this.mode="canvas",this.shManager.renderer=this;const{canvas:f,pixelRatio:p,clearColor:v}=o;this.canvas=f,this.context=f.getContext("2d"),this.pixelRatio=p,this.clearColor=v?VI(v):void 0,this.defShaderCtr={type:"DefaultShader",props:{},shader:new cg("DefaultShader"),getResolvedProps:()=>()=>({})}}reset(){this.canvas.width=this.canvas.width;const o=this.context;if(this.clearColor){const[f,p,v,S]=this.clearColor;o.fillStyle=`rgba(${f}, ${p}, ${v}, ${S/255})`,o.fillRect(0,0,this.canvas.width,this.canvas.height)}o.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(o){const f=this.context,{tx:p,ty:v,width:S,height:a,alpha:m,colorTl:_,colorTr:I,colorBr:M,ta:R,tb:U,tc:x,td:L,clippingRect:j}=o;let H=o.texture,Y,Z;if(H){if(H instanceof fa&&(Z=H.props,H=H.parentTexture),Y=H.ctxTexture,H.state==="freed"){Y.load();return}if(H.state!=="loaded"||!Y.hasImage())return}const X=O0(_),re=R!==1,le=j.width!==0&&j.height!==0,se=_!==I||_!==M,W=o.shader?iR(o):0;if((re||le||W)&&f.save(),le){const ce=new Path2D,{x:E,y:F,width:ue,height:ye}=j;ce.rect(E,F,ue,ye),f.clip(ce)}if(re){const ce=this.pixelRatio;f.setTransform(R,x,U,L,p*ce,v*ce),f.scale(ce,ce),f.translate(-p,-v)}if(W){const ce=new Path2D;ce.roundRect(p,v,S,a,W),f.clip(ce)}if(Y){const ce=Y.getImage(X);f.globalAlpha=m,Z?f.drawImage(ce,Z.x,Z.y,Z.width,Z.height,p,v,S,a):f.drawImage(ce,p,v,S,a),f.globalAlpha=1}else if(se){let ce=p,E=v,F;_===I?(ce=p,E=v+a,F=O0(M)):(ce=p+S,E=v,F=O0(I));const ue=f.createLinearGradient(p,v,ce,E);ue.addColorStop(0,Gc(X)),ue.addColorStop(1,Gc(F)),f.fillStyle=ue,f.fillRect(p,v,S,a)}else f.fillStyle=Gc(X),f.fillRect(p,v,S,a);(re||le||W)&&f.restore()}createCtxTexture(o){return new nR(this.txMemManager,o)}getShaderManager(){return this.shManager}getDefShaderCtr(){return this.defShaderCtr}renderRTTNodes(){}removeRTTNode(o){}renderToTexture(o){}getBufferInfo(){return null}}const ZS=50,fS={hd:.66666667,"720p":.66666667,720:.66666667,fhd:1,fullhd:1,"1080p":1,1080:1,"4k":2,"2160p":2,2160:2},rR=()=>{const h=no.stage;io.get("fonts",[]).forEach(r=>{r.type==="sdf"||r.type==="msdf"?(!r.png&&r.file&&(r.png=r.file.replace(/\.[^.]+$/,`.${r.type}.png`)),!r.json&&r.file&&(r.json=r.file.replace(/\.[^.]+$/,`.${r.type}.json`)),h.fontManager.addFontFace(new eg(r.type,{fontFamily:r.family,descriptors:{},atlasUrl:r.png,atlasDataUrl:r.json,stage:h,metrics:r.metrics}))):r.type==="web"&&h.fontManager.addFontFace(new zc({fontFamily:r.family,fontUrl:r.file,descriptors:{},metrics:r.metrics}))})},sR=()=>{const h=no.stage;io.get("shaders",[]).forEach(r=>{h.shManager.registerShaderType(r.name,r.type)}),io.get("effects",[]).forEach(r=>{h.shManager.registerShaderType(r.name,r.type)})};let no={};const aR=h=>{const r="renderMode"in h?h.renderMode:"webgl";if(r==="webgl")return dg;if(r==="canvas")return oR},lR=(h,r,o={})=>{no=new IM({appWidth:o.w||1920,appHeight:o.h||1080,fpsUpdateInterval:o.fpsInterval||1e3,deviceLogicalPixelRatio:o.pixelRatio||fS[o.screenResolution]||fS[window.innerHeight]||1,numImageWorkers:"webWorkersLimit"in o?o.webWorkersLimit:window.navigator.hardwareConcurrency||2,clearColor:o.canvasColor&&aa.normalize(o.canvasColor)||0,enableInspector:o.inspector||!1,boundsMargin:o.viewportMargin||0,txMemByteThreshold:"gpuMemoryLimit"in o?o.gpuMemoryLimit*1024*1024:200*1024*1024,renderEngine:aR(o),fontEngines:[KM,eR]},r);const f=()=>{let p=h();p.quit=()=>{Kt.info("Closing App"),p.destroy(),p=null,no=null}};return sR(),rR(),f(),no},cS=h=>h!==null&&typeof h=="object"&&"transition"in h,_l=h=>typeof h=="string"&&h.startsWith("{")&&h.endsWith("}"),Ll=h=>JSON.parse(h.replace(/'/g,'"').replace(/([\w-_]+)\s*:/g,'"$1":')),Ks=function(h,r){return typeof h!="string"?h:h.indexOf("%")===h.length-1?this.element.parent&&this.element.parent[r]&&this.element.parent[r]*(parseFloat(h)/100):h},tg=h=>{if(typeof h!="object"||h===null)return h;if(h.constructor===Object){if("value"in h)return h.value;if("transition"in h)return tg(h.transition)}return h},uR={top:"colorTop",bottom:"colorBottom",left:"colorLeft",right:"colorRight"};let ng=null;const fR={set parent(h){this.props.parent=h==="root"?no.root:h.node},set rotation(h){this.props.rotation=h*(Math.PI/180)},set w(h){this.props.width=Ks.call(this,h,"width")},set width(h){this.props.width=Ks.call(this,h,"width")},set h(h){this.props.height=Ks.call(this,h,"height")},set height(h){this.props.height=Ks.call(this,h,"height")},set x(h){this.props.x=Ks.call(this,h,"width")},set y(h){this.props.y=Ks.call(this,h,"height")},set z(h){this.props.zIndex=h},set zIndex(h){this.props.zIndex=h},set color(h){typeof h=="string"&&h.startsWith("{")===!1?this.props.color=aa.normalize(h):(typeof h=="object"||_l(h)===!0&&(h=Ll(h)))&&(this.props.color=0,Object.entries(h).forEach(r=>{this.props[uR[r[0]]]=aa.normalize(r[1])}))},set src(h){this.props.src=h,this.raw.color===void 0&&(this.props.color=4294967295)},set texture(h){this.props.texture=h,this.raw.color===void 0&&h==null?this.props.color=0:this.raw.color===void 0&&(this.props.color=4294967295)},set fit(h){const r={};if(h==="cover"||h==="contain"){this.props.textureOptions={resizeMode:{type:h}};return}(typeof h=="object"||_l(h)===!0&&(h=Ll(h)))&&(r.type=h.type||"cover",typeof h.position=="number"&&(r.clipY=r.clipX=h.position),typeof h.position=="object"&&(r.clipX="x"in h.position?h.position.x:null,r.clipY="y"in h.position?h.position.y:null),this.props.textureOptions={resizeMode:r})},set rtt(h){this.props.rtt=h,h===!0&&this.raw.color===void 0&&(this.props.color=4294967295)},set mount(h){typeof h=="object"||_l(h)===!0&&(h=Ll(h))?("x"in h&&(this.props.mountX=h.x),"y"in h&&(this.props.mountY=h.y)):(this.props.mountX=h,this.props.mountY=h)},set pivot(h){typeof h=="object"||_l(h)===!0&&(h=Ll(h))?("x"in h&&(this.props.pivotX=h.x),"y"in h&&(this.props.pivotY=h.y)):(this.props.pivotX=h,this.props.pivotY=h)},set scale(h){typeof h=="object"||_l(h)===!0&&(h=Ll(h))?("x"in h&&(this.props.scaleX=h.x),"y"in h&&(this.props.scaleY=h.y)):this.props.scale=h},set show(h){this.props.alpha=h?1:0},set alpha(h){this.props.alpha=h},set shader(h){h!==null?this.props.shader=no.createShader(h.type,h.props):this.props.shader=no.createShader("DefaultShader")},set effects(h){for(let r=0;r<h.length;r++)h[r].props&&h[r].props.color&&(h[r].props.color=aa.normalize(h[r].props.color));this.props.shader=no.createShader("DynamicShader",{effects:h})},set clipping(h){this.props.clipping=h},set overflow(h){this.props.clipping=!h},set font(h){this.props.fontFamily=h},set size(h){this.props.fontSize=h},set wordwrap(h){this.props.width=h,this.props.contain="width"},set maxheight(h){this.props.height=h,this.props.contain="both"},set contain(h){this.props.contain=h},set maxlines(h){this.props.maxLines=h},set textoverflow(h){this.props.overflowSuffix=h===!1?" ":h===!0?void 0:h},set letterspacing(h){this.props.letterSpacing=h||1},set lineheight(h){this.props.lineHeight=h},set align(h){this.props.textAlign=h},set content(h){this.props.text=""+h}},cR={populate(h){const r=h;r.node=this.config.node,r[me.isSlot]===!0&&(this[me.isSlot]=!0),this.props.element=this,this.props.parent=this.config.parent,delete r.parent,this.props.raw=h;const o=Object.keys(r),f=o.length;for(let p=0;p<f;p++){const v=o[p],S=r[v];S!==void 0&&(this.props[v]=tg(S))}this.props.props.color===void 0&&!("__textnode"in r)&&(this.props.props.color=0),this.node=r.__textnode?no.createTextNode({...ng,...this.props.props}):no.createNode(this.props.props),r["@loaded"]!==void 0&&typeof r["@loaded"]=="function"&&this.node.on("loaded",(p,{type:v,dimensions:S})=>{r["@loaded"]({w:S.width,h:S.height,type:v},this)}),r["@error"]!==void 0&&typeof r["@error"]=="function"&&this.node.on("failed",(p,v)=>{r["@error"](v,this)})},set(h,r){if(r===void 0||this.props.raw[h]===r)return;this.props.raw[h]=r,this.props.props={},this.props[h]=tg(r);const o=Object.keys(this.props.props);if(o.length===1){if(cS(r)===!0)return this.animate(o[0],this.props.props[o[0]],r.transition);this.node[o[0]]=this.props.props[o[0]]}else for(let f=0;f<o.length;f++){if(cS(r)===!0)return this.animate(o[f],this.props.props[o[f]],r.transition);this.node[o[f]]=this.props.props[o[f]]}},animate(h,r,o){if(this.node[h]===r)return;this.scheduledTransitions[h]&&this.scheduledTransitions[h].f.state==="running"&&(this.node[h]=this.scheduledTransitions[h].v);const f={};f[h]=r;const p=this.node.animate(f,{duration:typeof o=="object"&&"duration"in o?o.duration:300,easing:typeof o=="object"&&"easing"in o?o.easing:"ease",delay:typeof o=="object"&&"delay"in o?o.delay:0}),v=this.node[h];this.scheduledTransitions[h]={v:f[h],cancel:!1,f:p},o.start&&typeof o.start=="function"&&p.once("animating",()=>{o.start.call(this.component,this,h,v)}),p.once("stopped",()=>{this.scheduledTransitions[h]=null,o.end&&typeof o.end=="function"&&o.end.call(this.component,this,h,this.node[h])}),p.start()},destroy(){Kt.debug("Deleting  Node",this.nodeId),this.node.destroy()},get nodeId(){return this.node&&this.node.id},get ref(){return this.props.ref||null},get parent(){return this.node&&this.node.parent},get children(){return this.component[me.getChildren]().filter(h=>h.parent===(this[me.isSlot]?this.node.children[0]:this.node))}},hR=(h,r)=>(ng===null&&(ng={fontSize:32,fontFamily:io.get("defaultFont","sans-serif")}),Object.assign(Object.create(cR),{props:Object.assign(Object.create(fR),{props:{}}),scheduledTransitions:{},config:h,component:r})),hS={Element:hR,Launch:lR};let Kl={};const pg={},dR=(h,r,o)=>{io.set(o),yI(),pg.element=hS.Element,Kl=hS.Launch(h,r,o)},pR={before:{prop:"alpha",value:0},in:{prop:"alpha",value:1,duration:200},out:{prop:"alpha",value:0,duration:100}},ur=window.speechSynthesis,gR=()=>(window.navigator||{}).userAgent||"",dS=()=>/android/i.test(gR());let QS=!1,th=null;const gg=()=>th&&clearTimeout(th),ig=h=>{if(!h||th)return gg();ur.pause(),ur.resume(),th=setTimeout(()=>{ig(h)},5e3)},oa={lang:"en-US",pitch:1,rate:1,voice:null,volume:1},mR=()=>{oa.voice=ur.getVoices()[0],QS=!0},yR=(h,r)=>{const o=new SpeechSynthesisUtterance(r.value);o.lang=r.lang||oa.lang,o.pitch=r.pitch||oa.pitch,o.rate=r.rate||oa.rate,o.voice=r.voice||oa.voice,o.volume=r.volume||oa.volume,o.onstart=()=>{dS()||ig(o),h.onstart()},o.onresume=()=>{dS()||ig(o),h.onresume()},o.onpause=()=>{h.onpause()},o.onend=()=>{h.onend()},o.onerror=()=>{gg(),h.onerror()},ur.speak(o)},Xc={speak(h){QS||mR(),this.cancel(),yR(this,h)},resume(){ur.resume()},pause(){ur.pause()},cancel(){ur.cancel(),gg()},getVoices(){return ur.getVoices()},onend(){},onerror(){},onstart(){},onresume(){},onpause(){}};let pS;const mg=(h,r="off")=>{clearTimeout(pS),Xc.cancel(),r==="assertive"?Xc.speak({value:h}):pS=setTimeout(()=>{Xc.speak({value:h})},400)},vR=h=>mg(h,"polite"),xR=h=>mg(h,"assertive"),wR=()=>{Xc.cancel()},JS={speak:mg,polite:vR,assertive:xR,stop:wR};let nh,ih=!1;const eT=new WeakMap,tT=[];let nT={},iT={},og=!1,oT;const SR=()=>(document.location.hash||"/").replace(/^#/,""),gS=h=>h.replace(/^\/+|\/+$/g,"").toLowerCase(),TR=h=>typeof h=="object"&&h!==null,CR=h=>typeof h=="string",ER=(h,r=[])=>{const o=h;h=gS(h);let f=!1,p=0;for(;!f&&p<r.length;){const v=r[p];if(v.path=gS(v.path),v.path===h)v.params={},f=v;else if(v.path.indexOf(":")>-1){const S=[...v.path.matchAll(/:([^\s/]+)/gi)];let a=v.path;S.reverse().forEach(_=>{a=a.substring(0,_.index)+"([^\\s/]+)"+a.substring(_.index+_[0].length)});const m=o.match(new RegExp(`${a}`,"i"));m&&(v.params=S.reverse().reduce((_,I,M)=>(_[I[1]]=m[M+1],_),{}),f=v)}else if(v.path.endsWith("*")){const S=new RegExp(v.path.replace(/\/?\*/,"/?([^\\s]*)"),"i"),a=h.match(S);a&&(a[1]&&(v.params={path:a[1]}),f=v)}p++}return f&&(f.options={...f.options,...nT},f.data||(f.data={}),nh=f),f},AR=async function(){if(ih=!0,this.parent[me.routes]){const h=nh,r=SR();let o=ER(r,this.parent[me.routes]),f;if(o){if(o.hooks&&o.hooks.before&&(f=await o.hooks.before(o,h),CR(f))){nh=h,uh(f);return}o=TR(f)?f:o,og===!1&&h&&h.options.inHistory===!0&&tT.push(h),"transition"in o||(o.transition=pR),typeof o.transition=="function"&&(o.transition=o.transition(h,o));let p,{view:v,focus:S}=eT.get(o)||{};if(v)p=v[me.holder];else{p=pg.element({parent:this[me.children][0]}),p.populate({}),p.set("w","100%"),p.set("h","100%");const m={...this[me.props],...o.params,...iT,...o.data};v=await o.component({props:m},p,this),v[Symbol.toStringTag]==="Module"&&(v.default&&typeof v.default=="function"?v=v.default({props:m},p,this):Kt.error("Dynamic import doesn't have a default export or default is not a function")),typeof v=="function"&&(v=v({props:m},p,this))}if(this[me.children].push(v),oT=fr.get(),S?fr.set(S):fr.set(v),o.transition.before)if(Array.isArray(o.transition.before))for(let m=0;m<o.transition.before.length;m++)p.set(o.transition.before[m].prop,o.transition.before[m].value);else p.set(o.transition.before.prop,o.transition.before.value);let a=!1;if(h){a=!0;const m=this[me.children].splice(1,1).pop();m&&kR(h,m,o.transition.out)}if(o.transition.in)if(Array.isArray(o.transition.in))for(let m=0;m<o.transition.in.length;m++)m===o.transition.length-1?await ua(p,o.transition.in[m],a):ua(p,o.transition.in[m],a);else await ua(p,o.transition.in,a);o.announce&&(typeof o.announce=="string"&&(o.announce={message:o.announce}),JS.speak(o.announce.message,o.announce.politeness)),this.activeView=this[me.children][this[me.children].length-1]}else Kt.error(`Route ${r} not found`)}og=!1,ih=!1},kR=async(h,r,o)=>{if(o)if(Array.isArray(o))for(let f=0;f<o.length;f++)f===o.length-1?await ua(r[me.holder],o[f]):ua(r[me.holder],o[f]);else await ua(r[me.holder],o);h.options&&h.options.keepAlive===!0?eT.set(h,{view:r,focus:oT}):(r.destroy(),r=null)},ua=(h,r,o=!0)=>new Promise(f=>{if(o){const p=r.end;r.end=p?(...v)=>{p(...v),f()}:f,h.set(r.prop,{transition:r})}else h.set(r.prop,r.value),f()}),uh=(h,r={},o={})=>{iT=r,nT=o,window.location.hash=`#${h}`},rT=()=>{const h=tT.pop();if(h){og=!0;let r=h.path;return r.indexOf(":")>-1&&Object.keys(h.params).forEach(o=>{r=r.replace(`:${o}`,h.params[o])}),uh(r),!0}else return!1},U0={navigate:AR,to:uh,back:rT};let sr=null,Nc=[],mS;const fr={_hold:!1,set hold(h){this._hold=h},get hold(){return this._hold},get(){return sr},set(h,r){clearTimeout(mS),sr&&sr!==h.parent&&sr.unfocus(),Nc.reverse().forEach(o=>o.unfocus()),h!==sr&&(mS=setTimeout(()=>{sr=h,sr.lifecycle.state="focus",r instanceof KeyboardEvent?document.dispatchEvent(new KeyboardEvent("keydown",r)):Nc=[]},this.hold?io.get("holdTimeout",ZS):0))},input(h,r){if(ih===!0)return;Nc=sT([sr],h);const o=Nc.shift();o&&(o[me.inputEvents][h]?o[me.inputEvents][h].call(o,r):o[me.inputEvents].any&&o[me.inputEvents].any.call(o,r))}},sT=(h,r)=>h[0][me.inputEvents]&&(typeof h[0][me.inputEvents][r]=="function"||typeof h[0][me.inputEvents].any=="function")?h:h[0].parent?(h.unshift(h[0].parent),sT(h,r)):[],Pl=new Map,Dl=new Map,rg={registerListener(h,r,o,f=0){let p=Pl.get(r);p===void 0&&(p=new Map,Pl.set(r,p));let v=p.get(h);v===void 0&&(v=new Set,p.set(h,v)),v.add({cb:o,priority:f}),Dl.delete(r)},executeListeners(h,r){const o=Pl.get(h);if(o===void 0||o.size===0)return!0;if(Dl.has(h)===!1){const p=[];for(const[v,S]of o)for(const a of S)p.push({...a,component:v});p.sort((v,S)=>S.priority-v.priority),Dl.set(h,p)}const f=Dl.get(h);for(let p=0;p<f.length;p++){const{cb:v,component:S}=f[p];if(v.call(S,r)===!1)return!1}return!0},removeListeners(h){for(const[r,o]of Pl)o.has(h)&&(o.delete(h),Dl.delete(r),o.size===0&&Pl.delete(r))}},bR={focus:{value:function(h){return Kt.warn("this.focus is deprecated, use this.$focus instead"),this.$focus(h)},writable:!1,enumerable:!0,configurable:!1},$focus:{value:function(h){this[me.state].hasFocus=!0,fr.set(this,h)},writable:!1,enumerable:!0,configurable:!1},unfocus:{value:function(){this[me.state].hasFocus=!1,this.lifecycle.state="unfocus"},writable:!1,enumerable:!0,configurable:!1},destroy:{value:function(){this.lifecycle.state="destroy",this.$clearTimeouts(),this.$clearIntervals(),rg.removeListeners(this),aT(this[me.children]),Kt.debug(`Destroyed component ${this.componentId}`)},writable:!1,enumerable:!0,configurable:!1},select:{value:function(h){return Kt.warn("this.select is deprecated, use this.$select instead"),this.$select(h)},writable:!1,enumerable:!0,configurable:!1},$select:{value:function(h){let r=null;return this[me.children].forEach(o=>{Array.isArray(o)?o.forEach(f=>{f.ref===h&&(r=f)}):Object.getPrototypeOf(o)===Object.prototype?Object.keys(o).forEach(f=>{o[f].ref===h&&(r=o[f])}):o.ref===h&&(r=o)}),r},writable:!1,enumerable:!0,configurable:!1},trigger:{value:function(h){return Kt.warn("this.trigger is deprecated, use this.$trigger instead"),this.$trigger(h)},writable:!1,enumerable:!0,configurable:!1},$trigger:{value:function(h){let r=this[me.originalState];if(h.indexOf(".")>-1){const o=h.split(".");h=o.pop(o);for(let f=0;f<o.length;f++)r=r[o[f]]}la(r,h,!0)},writable:!1,enumerable:!0,configurable:!1},shader:{value:function(h,r){return{type:h,props:r}},writable:!1,enumerable:!0,configurable:!1}},aT=function(h){for(let r=0;r<h.length;r++){if(!h[r])return;h[r].destroy&&typeof h[r].destroy=="function"?h[r].destroy():Object.getPrototypeOf(h[r])===Object.prototype&&aT(Object.values(h[r])),h[r]=null}h.length=0},IR={$setTimeout:{value:function(h,r,...o){const f=setTimeout(()=>{this[me.timeouts]=this[me.timeouts].filter(p=>p!==f),h.apply(null,o)},r,o);return this[me.timeouts].push(f),f},writable:!1,enumerable:!0,configurable:!1},$clearTimeout:{value:function(h){this[me.timeouts].indexOf(h)>-1&&(this[me.timeouts]=this[me.timeouts].filter(r=>r!==h),clearTimeout(h))},writable:!1,enumerable:!0,configurable:!1},$clearTimeouts:{value:function(){for(let h=0;h<this[me.timeouts].length;h++)clearTimeout(this[me.timeouts][h]);this[me.timeouts]=[]},writable:!1,enumerable:!0,configurable:!1},$setInterval:{value:function(h,r,...o){const f=setInterval(()=>h.apply(null,o),r,o);return this[me.intervals].push(f),f},writable:!1,enumerable:!0,configurable:!1},$clearInterval:{value:function(h){this[me.intervals].indexOf(h)>-1&&(this[me.intervals]=this[me.intervals].filter(r=>r!==h),clearInterval(h))},writable:!1,enumerable:!0,configurable:!1},$clearIntervals:{value:function(){for(let h=0;h<this[me.intervals].length;h++)clearInterval(this[me.intervals][h]);this[me.intervals]=[]},writable:!1,enumerable:!0,configurable:!1}},MR={$emit:{value:function(h,r){return rg.executeListeners(h,r)},writable:!1,enumerable:!0,configurable:!1},$listen:{value:function(h,r,o=0){rg.registerListener(this,h,r,o)},writable:!1,enumerable:!0,configurable:!1}},RR={$router:{value:{to:uh,back:rT,get currentRoute(){return nh},get routes(){return this[me.routes]},get navigating(){return ih}},writable:!1,enumerable:!0,configurable:!1}},_R={$announcer:{value:JS,writable:!1,enumerable:!0,configurable:!1}},LR={[me.renderer]:{value:()=>Kl,writable:!1,enumerable:!0,configurable:!1},[me.getChildren]:{value(){const h=this.rootParent||this.parent;return(this[me.children]||[]).concat(h&&h[me.getChildren]().map(r=>Object.getPrototypeOf(r)===Object.prototype?Object.values(r).map(o=>(o.forComponent=o.config&&o.config.parent.component,o)):r).flat().filter(r=>{if(r&&r.component)return r.component&&r.component.componentId===this.componentId||r.forComponent&&r.forComponent.componentId===this.componentId})||[])},writable:!1,enumerable:!0,configurable:!1}},Nl=Object.defineProperties({[me.launched]:!1},{...bR,...IR,...MR,...RR,..._R,...LR}),PR={cast:h=>h,required:!1},DR=(h,r=[])=>{r.indexOf("ref")===-1&&r.push("ref"),h[me.propKeys]=[],r.forEach(o=>{o={...PR,...typeof o=="object"?o:{key:o}},h[me.propKeys].push(o.key),Object.defineProperty(h,o.key,{get(){const f=o.cast(this[me.props]&&o.key in this[me.props]?this[me.props][o.key]:"default"in o?o.default:void 0);return o.required&&f===void 0&&Kt.warn(`${o.key} is required`),f},set(f){Kt.warn(`Warning! Avoid mutating props directly (${o.key})`),this[me.props][o.key]=f}})})},NR=(h,r)=>{h[me.methodKeys]=[];for(let o in r)h[me.propKeys]&&h[me.propKeys].indexOf(o)>-1?Kt.error(`${o} already exists as a prop`):(typeof r[o]!="function"&&Kt.warn(`${o} is not a function`),h[me.methodKeys].push(o),h[o]=r[o])},OR=(h,r=()=>{})=>{Object.defineProperty(h,me.stateKeys,{value:[],enumerable:!1,configurable:!1,writable:!1}),Object.keys(r.apply(h)||{}).concat(["hasFocus"]).forEach(f=>{h[me.propKeys]&&h[me.propKeys].indexOf(f)>-1&&Kt.error(`State ${f} already exists as a prop`),h[me.methodKeys]&&h[me.methodKeys].indexOf(f)>-1&&Kt.error(`State ${f} already exists as a method`),h[me.stateKeys].push(f),Object.defineProperty(h,f,{get(){return this[me.state][f]},set(p){this[me.state][f]=p}})})},UR=(h,r)=>{h[me.computedKeys]=[];for(let o in r)h[me.stateKeys]&&h[me.stateKeys].indexOf(o)>-1?Kt.error(`${o} already exists as a state variable`):h[me.propKeys]&&h[me.propKeys].indexOf(o)>-1?Kt.error(`${o} already exists as a prop`):h[me.methodKeys]&&h[me.methodKeys].indexOf(o)>-1?Kt.error(`${o} already exists as a method`):(typeof r[o]!="function"&&Kt.warn(`${o} is not a function`),h[me.computedKeys].push(o),Object.defineProperty(h,o,{get(){return r[o].apply(this)}}))},BR=(h,r)=>{h[me.inputEvents]=[],Object.keys(r).forEach(o=>{typeof r[o]!="function"&&Kt.warn(`${r[o]} is not a function`),h[me.inputEvents][o]=r[o]})},jR=(h,r)=>{h[me.routes]=[],Object.keys(r).forEach(o=>{h[me.routes][o]={...r[o],options:{inHistory:!0,...r[o].options}}})},FR=(h,r)=>{h[me.watchKeys]=[],h[me.watchers]={};for(let o in r)typeof r[o]!="function"&&console.warn(`${o} is not a function`),h[me.watchKeys].push(o),h[me.watchers][o]=function(f,p){r[o].call(this,f,p)}};let $R=0;function VR(h,r){return h[me.identifier]=++$R,_I(r.hooks,h[me.identifier]),DR(h,r.props),r.methods&&NR(h,r.methods),OR(h,r.state),r.computed&&UR(h,r.computed),r.watch&&FR(h,r.watch),r.routes&&jR(h,r.routes),r.input&&BR(h,r.input),h}const HR=()=>Hr("Circle",{code:{render:function(r,o,f,p,v,S){const a=[],m={};return a[0]=this.element({parent:r||"root"},o),m.color=o.color,m.w=o.size,m.h=o.size,m.effects=[o.shader("radius",{radius:o.radius})],a[0].populate(m),a},effects:[function(r,o,f,p,v,S){o[0].set("color",r.color)},function(r,o,f,p,v,S){o[0].set("w",r.size)},function(r,o,f,p,v,S){o[0].set("h",r.size)},function(r,o,f,p,v,S){o[0].set("effects",[r.shader("radius",{radius:r.radius})])}],context:{}},props:[{key:"size",default:40},"color"],computed:{radius(){return this.size/2}}});let B0;const zR=()=>Hr("RouterView",{code:{render:function(r,o,f,p,v,S){const a=[],m={};return a[0]=this.element({parent:r||"root"},o),m.w=r.node.width*(100/100),m.height=r.node.height*(100/100),a[0].populate(m),a},effects:[],context:{}},state(){return{activeView:null}},hooks:{ready(){B0=()=>U0.navigate.apply(this),U0.navigate.apply(this),window.addEventListener("hashchange",B0)},destroy(){window.removeEventListener("hashchange",B0,!1)},focus(){this.activeView&&this.activeView.$focus()}},input:{back(){U0.back()}}}),GR=()=>Hr("Sprite",{code:{render:function(r,o,f,p,v,S){const a=[],m={};return a[0]=this.element({parent:r||"root"},o),m.w=r.node.width*(100/100),m.h=r.node.height*(100/100),m.texture=o.texture,m.color=o.color,a[0].populate(m),a},effects:[function(r,o,f,p,v,S){o[0].set("texture",r.texture)},function(r,o,f,p,v,S){o[0].set("color",r.color)}],context:{}},props:["image","map","frame","color"],state(){return{spriteTexture:!1}},computed:{texture(){const h="frames"in this.map?Object.assign({},this.map.defaults||{},this.map.frames[this.frame]):this.map[this.frame];if(this.spriteTexture&&h)return this[me.renderer]().createTexture("SubTexture",{texture:this.spriteTexture,x:h.x,y:h.y,width:h.w,height:h.h})}},hooks:{ready(){this.spriteTexture=this[me.renderer]().createTexture("ImageTexture",{src:this.image})}}}),XR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaMAAAAbCAYAAADRe+BYAAAAAXNSR0IArs4c6QAAGn9JREFUeF7tXQ1UVdWePxcWFg7ZA0sym5n0Tmk1z4+0YeVU4yo1h1jvPVBo1ETU8QvTdJlhsmKpi0he5jyXX0CKIWkpl3OlME3RGcdJixVEas+nJtq0sMwXN/kIgbxn1m+791n/ezifF0hr7lmrVV3O2Wfv/977//v//h/7uKTQFZJASAIhCYQkEJLADZaAy+j9iqIMkCRpliRJGeSeWkmSClwuV25X9VtRlOGSJI3m7wq6bd5Osqa/6OZSSZJKXC4X+h7UpSgKZABZQCbiKuHt4t+dvri8z5GG3E77rChKtCRJ9TY647ht0aaiKJAx5LCK/4Y5m23jneotiqJgvg84eCaYd6Cf4h/xqgo+ZwUO3h1wK5cx1oIYP/5eJUlSrsvl6tRakGUZbYr9tjQpKanL9lmw4w09F5LAzyUBXTDiih3KAspN76pwuVxjgu2koijYzGibbmg0tzQYoOPt5Zv0xydJ0hiXywWlYfviAAE5UBDSPu9YUep1QFEUvAdKWlyOAYPP26c2BhhM25ivXZo+4lWOxx8EGEHRw6iwdXHjQbu26LMwTlJsNUZusrEeHMuC9kGWZRgSYs/VJiUluZ32MXR/SAK/VAkYgREsdKaAKysr58fFxd0Di23Xrl1ScjKMTUl69913906cODHe6cDNFAVvcyAUHCxNO21rGIVv7969ufHx8djQGatWrZIyMq4bmj6frz4mJuYRSZJsMyQNQJS43e4/19bWThk+fPiA/Px8afhwkDpJKikpKUhJSXHEDujY9MDU7XZLtbWsq1BItvrMWQsAQxozZoxUUQEiYHrZapuzAYCcAOWSnJycv2RmZjZThiRJklMZGDIkyHfWLNgskkRkgXVh+g4N0NUuWLCgYN26dcMHDBiQjPUr5qyoqOjttLS0KVYC0syTui/q6+tX9O7duyU6OnoV2h09+rodEexakGUZG4vNnbiWL18uHT9+HCBsay84Gcv/13s9Hs/osLAwlZW7XK6KxMRES8Pa6/Ue4GuLic7v94+ZMGGC5Qb7OeXcXWMrLS3Nd7lcs+zKKtgxdwAjupnPnDlTNHDgwN9RhlRfXy9FR0dDuUsxMTGYDMuJ1GxooAO0eNWgQYNaX3jhhcfnzp2bhHuWLl0q5eayfWd7AyqKoro2uIJ5jr7vwIEDqqKIi4trqKysfJK7VUxlRl1ebW1tX99yyy3tlCFB+aBtroCklJQUS0Wp90L+Hii5ABYaJBhBtowRjBgxQqqqsiSCdsEISpJZIZcuXVp01113PaPHkKyAQmf8umCE9XXu3Dm2zgCoAFZ+YXGYMiS6HjZt2iSnp6eztYVLZ87gVrPFkCjQX758+d0+ffr8k1gP6Oenn34qDRgwgBkQbrfb8VqQZVnIGCyerYX9+/dLeXl5MERuSoYky7JiU/GoLE+r1A2eh4cEIKG7gD0ez4CwsDCsxwD2qygKmGlFUlKSobtUq7A5sLgnTJhgaPDx91EX+i8CjLpqbHSeXS7XCKN5sbkWDG/TAyNVuSckJHyzZ8+evvxpbNoSRVHgDmMmK1d4toFD0wumOGH9wgruBBip7q2YmBgGkiBCXDGiv6qCnj17tlRQUGBrc5PYgJSZmTk1JyfnAd5/LPTZBESowoTV7igeoSiKUEK1ly5dCo+Njf17vKezYERkAU0etAVHjZPm5uaiqKioxylD4uMNun0DgFbnbNq0aXveeustgB8TixVLpOuTsEPMeYqiKFgXTKkQkLM1ZxTkNPuCrf8rV678qVevXi+QfWGrXdxfXl4e3dbWxmJ933zzzbHz588/OnLkSKmpqUlKT0/Hv9U51CjGDq482hZk1aNHjxEJCQlsU3D2JYxB/MRiXTQG6Pf7TRUzna9uBCPxmg5xM1mW1bVhovxKkpKSdI0MPTAqLi6WvF6voWGt907OWtGFTu2vzipw+nx3jU0wo6+++qpu0aJF/bg+cURC7IxTD4xUK5goRNUipco9JSUFbgks9Bg7L9MBo+EbN24M7wwzIm3S4K+qCKgSIcpphB12xNumSQEqkFElDTYHVgewtmtp42ZqbX/99dfTzp07VzBq1KiIToCRaii4XOrUOhlrh2mk8nv66acr9u/fL+JatpWtk7VBmaLf778QHh5+O2cKtli4jvGB17O+0jkrKCiQYJzYnTMKcnpuQ+pqdWL0cJBQFeybb7557Nq1a4/OmTOHiS0vLw8MKYBpERYlaS1VjbsvNykpiS1MCyWOdc1csMGCUVKSSkDNprvW6/XWCncXUejqM2PHjpXE2PFjdXX10uzsbOYu0Shb39mzZ7MyMjL+BkYt5mTKlCnS4MGDWVunTp0qy8zM/IO2M3oKGyx8yZIlbNvpGTuyLMNFfd0nz69fChh18dgoE+6UXtFbJHpgpDINsulU9DfY7EF3jG7iYNx0ZFA0AQDg6KOK7erVqy2RkZGR/H4nihRgdD14cZ1xCaUGxT/A7/dfue+++27n8R1bCpMDEdoVcRgE1OH2SxaxhyCZEZMBxrpt27ZIEXPhfQdQMjeGQ3BgG7G9vb0pPj4+Cm2KuCFvJ6ikE6M+0PWgcbPZskDpnGNOYDBVVVWNURQFCheGFlMqRL625syAcdF9gTXCKD5Zx7b2hVB2iqL8MHXq1N+gjW3btjERcWWCdQdFyRiO1+udxfsjcateBSuakQcFi+fvvffeD9asWSPiu779+/e/lZeX9wRkAcUPABDX3Llz4Yo1VMx03igz6iowQvsUkI4fPy4tX76csU8Kwh6PZ/uOHTsm0/5ERUVJGzdulPBvXDNmzCjz+XwBgETBCOOMjY1l93JZdfDyeL3e4YqisKSgpqam+qioKGZ43+xg1E1jE8aurT3jRM/gXrtgpFoMBmDEXHhOX86Vst4mDtb1F9AFatVv3br18PTp0/+F32BLsdHGqDIiv1ekpqZuKy4uvq45rrs8bGV9kb75EhMTs3bv3r2OxreCBCM1wG4yFylOUpAVRWHWUEtLy9XIyMhbDdqtgoUezPxrn1EUhY0BivmOO+6Q6uvroZxtuVZFW8gqrKurK+vXrx9cCtqrdv369fnz588XSQG24jt03RNWRfeFyswJGFkaPVTZnT9//sTixYt/iw5v2LDhWN++fR8lilJti7riuLJWvRMiI6+xsVEFtldffbXsgQce+D3a2rdvn1xQUBBAY15//XUGzri6AIwMy0XQPo0ZGSl0Oj64KlNTU/FoCgdaxuBIP1WXPH7Pz88vvfPOO9n4Vq9eLR09ejRgT1Iw8nq9UmJiIhs3/ru4uBhuy4B1TMF93759344bN+4u3K/Xd85KA8oJYPwhlkXjWBp21sHVKsuyuo9RNpGYmGjL9d9dY6P9SUpKYvNL3cUYn6IoyHjNQKID2XCOyhO6CowsN52RoupCZhTwCtruTz/9VBMREYFYDNhIUG5FPTACW5gxY0ZzcXExzCu0i4VsmflG3UU8KwtZXQOqq6svDRs2jJlqQYIR3D0Zp0+fDp88eXKvqqoq9KkkIyNjFjILcTU3N7c9+eSTz1ZWVu62Ag9t7RMSItLT05EEMn7o0KGLNm/eHC+y04LNrqR9oG7L3bt3y4mJiUJpOlpfkK/f738zLCzsXu0YwWRnzpz5fWFhocgMtIxDoQ1togkHHGbUUKMH9zph+FTZbdiwofbgwYPol2/Lli0ro6Oj/8NIUVKWAGXd1NQ0AgpVWPFQnAUFBVCcPlmWsSYZI+T34j9VJU4B4mYAI3ROh3VV8PExNzF3XzKQ0jGEsc9pUhDzlHAlqmbTgVUOGTKEufbAJDB2vofVxAkB7j/88EPF+++/PxquQD0wEnEVkz0VoJg196t/o6wX4zKKfem9h4JRV47NCox4yAPrtkMpEIBq/PjxtrJsf5VgpEnv9Y0cOXLXsWPHhEA6y7ryR48ezZS7UMRz5sw5kZ+fD3eAJRBxxSYsHzAKUF6AiK+xsfHPUVFR/xwsGJEF2oEh0VRpriwt2SwFI7i8kLDiu54hwhYdssfgBsLFs8g6WJZWgKcBI9XVOnDgwK/PnDnzt1yJqC4qq/ZorVVTU9Op+Ph46ciRIw+gr5CBcIOmpqZeKi4uRualbbclBUudfqhxFx4zYrhklZYtlJ3f729IS0vrBSYAJVReXj5bJDUQdqC6/ajS4gxgqSzLeJZZHcJFB9esLMvMWqVsScTRONipacs3AxhRpUpiHj6v17tUuCcJIBkZE2r8lAKWVmE3NzerMSrOdlQmRe997733Prxy5crTemDk9XrB5JmLFvt50aJF2y9cuBDvdruTX3zxRdUVuGrVqvmVlZXrcR/YX0tLy/+Gh4dHYX7nzZt34Z133nm4ra1NgKjv+eefb7p48SL2AC5Lg6w7xob9oQEj1hmPx+MOCwtTMwyPHj0qFRYWFtXX168cMWLE6wsWLEgS7tL09PQV33777XKrvfurAyNt4eeMGTNyCgsLl3FBdEpZ8jbYIqeK+LPPPrv28MMPT7TjqqTunldeeSU9Ozt7I28XGw1WH7P8gmFGZLIZQ+LgiEVcpRO8D4hD6C0UCkaaFGvIkbXb0tJy4tZbb/1HPM8z+CwVsMG71DTv48ePVwwZMkQkSjhqj9aGpaamphYXF2MTMBZEU8YvXLjg79+//7/ZmTPa39OnT//hiy++2JmYmNgDv6N+LTo6+mVaxE3S6k37TpMNvvzyy7+89NJLg/i7mKFA2Y/W5URdWTwFvMrr9SJOOhqxjdTUVJFUBPcWq186ffp0w8svv9yLv0NlC13BjEwUTYAbyspNx2WCPcYMHsKAmK7XnFIhtbe3/xgREbHS7/eXmKVni/5pXVlgW1u2bGmJiIiI1KbSE/biS01NdT333HO/EfE16qaTZRl9ZWtsyZIlQ8+dO4d1xS64AQWA8bGoa4IaFHh3ZGTk3scff/xf8dwnn3wi5+bmCs+ArcSo7hibHTAirBJ6gTEkjFm4QPnatXSH282m040Z8Ww6W6httFi70k2nPTli/fr1GSQ2YNuNZoXg4u/Nzc0Xe/bsyVLfefaaKdtwcFyP2oUDBw6kjh07tthun0zkjEXCLJmSkhIW2Ley3Gl/CRiBAcBCZ24PnSwzR/Ed0V/aTkpKSnVJScnD/G+23GikHRbjunr1al1kZKSIGang2djY+D8a9mnJEHVk2qFAVRSEX7lyBSAXxksMTK1ZCjZW8wvLc/Xq1QEuZvG8SAEXSQ8ffPDBic2bNyP2xO4XLi+iNALm6EaBkdWYz58/v3Px4sXP8vtUQ3LatGn5Dz744CwR5yLtwNNQYBZjoQqbg4/0xhtvnOjfv/9vCQNl7lfBWuvq6vbMnz//GZrsYRDvUuPfnHGneL3eZE2yCbqrrumdO3f+V0REhIhls6EoinJh/PjxIovUtt7qrrFZMSMetxTTwEpfOBtnLJ0YFKoBpDf3pnVGBGwoGKmp38QCtKSQ3Q1G3IpH1guzqD766KOcxx57TDAi/GQrs4koNXFmHn4S7rSAYYhgOwEjU+alc/6c1X5Ehp0tMOLMR6Sf4rimgIJBg7RmS2uFxyCG8yJn9Dcgk4YyEVLbZLrotIOmcvnuu++qY2NjBRBZ9k+nLQZGFy9ebOnXr5/InqTrV5stGhR4kvMUkylLPnLkSOUTTzyBgljTNaepB7JcB7iBx3tU8KTMCjECYYFnZGQ0nD17FgyIyY+mJvM2AuawK8DIRjYdk7PNotdcj8fTtmPHjudJHEKrY5DOnYF4Dyxw4RLie7EiIiIiRdRXUeHqKewJEyaUTZo0iSV4CCtelmXIiDHKDRs27Dl48OAz8+bNa33qqaduwW96YJSVlfV2bGxsXN++ff9Bb0J55iP+pI6FJrCIZwoLCzeXl5f/O/9/256B7hqbAzBS9xItJbCI76miMj2BwSBriJ2fxY/XUV0BTt0dROl3OptOe2bY559/vm7o0KGIB4iAWjDZc1Ds4py3DmfxUQV64sSJ1sGDB7NFqpehqLMwdQ80NcimE4+bjkETz+hwRhplHiTAbkn/deq0VEWmiSn91e1238E765TNqP7911577ciyZctQWIsrmHlTa0K4q5PWhqmB7aampvbbbruN1XTZKaY1QwsKyMOGDfugpqYGadSmblC6WQmT6fAa6u7gykydMw5oLMYAqx4KuaGhoTYtLU0kZwgLX83044ohAIApWHVBzMhIVB3ASK/OyOBhoyxVcTDycIASAFHUGV2+fPnU7NmzH9S2p6eweVwNbUULBsrBCL/5ONBG5+Tk1A4aNIjJloJReXl5VVtbG4ycgFok7bsJGAUADJU/Ya943JGh1B1js+OmI8xI1Q0GYGRKWozOplM3NGdH4vQFlRWtXbv2xMKFC1kaqlPWQSeps2467blptbW1f3S73TNNLCozvRLwN8p8uMWbybOnsOigQNniW7hw4V/Xrl0rFLFpait/geoyoy/sDBihHdpfnt32Co8XqUWVyACMjY2N4m4kS+ZBs8jwzMSJE5s+/PDD2zgQqXU7mZmZp8gpFbaZEW2fH7skArZB1TLQmByy/yZNmoREiL/j71EPevV4PHXJycnCjecIPMWcaU9z52vvJf53U9lSBUSSDTqsTQAqUq9xkWC+Kl+tq+/QoUOH169fD7eP6tKjabgALQDS0aNHWRvaLDAKRvw5duaV3llsBnVGwaR2G+1JgBDWgVWSifBiZGzatCla1A5lZWVVnjx5cpxwKeMlVGETJYokD8iLHWQJGWzatIn1iRfPMta0devW6ttvv52xdgpGpaWlySKlGQkMa9asOYWkGbBnWjOlB0Z6ZxISJuHIGOuOsd0MYIQiR/gyr1ePdbzAFLAAYGk6Qm9tU10ARnaOB1Ff6yJHE1ihEmJQ165dOxQeHi6Cvh0eqaury7/nnntEpl6nEiSohR1MAgP629TUtCcqKup6JV/Hy5eQkPCfe/bsEYFRWy4Aq1O2OyMDCh55eXmVc+fOFS6uzrh+aSZVBym0trYevvvuu4fwGiZHqf4mspjtcrlgSYvEC0OAo66Z77//vm7mzJkCFHXnQwe41Pu0yoy46ALYhCZl2HDpUzAqLS1V60b0UnS7EIwsla5mnIYpz+vWrSvv168fOz6KK/UAo8ZIYXu9XtTKME8IQEowrJUrV1bU1NRgTpHNJxKBAsBIlmVWAI9n09LSahoaGoYKAdsAI5H56vvxxx979ezZM1xk1zU2Nva30lH0790xthsORhggLN+cnJz/XrZsGS0cFN8zAhBdP77bRvqqmUBvZjDicohesWLFl1OmTIlBbIBcBTt27KiZPHnyDELPg1ag/F16p184strBANDfBQsWxCB7jFxLR40aFXP48GFhuVtm09GHy8rKhp09e/bo4sWLaeFrRWVlZVlcXFxaMDKgrKgzRa566ys7O/vtuLi4ySKVm99TVV9fX967d2+kzwvQsGSHtH0NGDGr3e12R+I0d3JmnynIUzZSWlpat337drHHdOOa1OUhMudEcSZ11RHmhC53UPBZWVlTwsLCtglFC5der169cIIGTnRg8jBiRgZFnurxMCRmFAwzsgQjTYzN16NHD7deTIjGpHj8B8NS5WqgsBlg0dgIHmpvbz/57LPPskxRpOhzI4LJSZNNB8Yd3dra2jpx4kThrkebSLfH/SyQr2VGdF5ramq2f/zxx5PFUUh8nh3pk+4Y200BRnwCADqm3zVyemq3CTDRTBRbFrumLUcMyWZsR7zCSg5ssdo9fcEMnPnf6NFGjsCIzBs2iNF3mNj3nRyczye6bPVRvM7IgM5fMPOvJ1ZThiQynqgbx8bcWMnCiQKhcUk7rJqekaYFLno2oxnbo/uMjYWewECKYum6o3KkRw/9bGCEflLlDeA9dOjQsb17947E3wBWra2tq4S7rKGhgdVt8clS58RCYQfokLKysi+LiopEMgKKilfpnKsHEINMmXFOAAdZjAEfYaRg5PF4SkidTu3UqVPDGhsb783Ly/P36dMnDG1xlovCbXHQrehfLXebBtQ1dsfYuhqMPB5PBf+EB3RTQCGw3fiG9rh2xpCsCvocbGzcejODEfonzqjTfvEVckBQ2cqv7UQcnQUj2l8sYEqR2Jdv7Rbo6nRa7wvAGLuQg5NxintpxbwjxmbjZVi7mDP64UIofsigM98JosAs4hqQAVMcNi+q5O0AMFWWWkZH+9PBKOBuLgT5MW7ci7ZGI74i4iN1dXUN8+fPFwqcghFtW2UxP6ebTshz+/btf4qMjGSno5tcvqysrLMnT54ULl81A9FMYWs/FUGAmRkKRjVSvL7LyGhXi6H5kUPo9lKv1ztaABs9oikhIWHz9OnTWSYdZ7oU/E2PCeqOsXU1GPFTNMSHUANq0OyAkc19FbotJIGQBG5GCXAlK8oe6NEzOARUTcQpKir6qqysjH3ChJ/EbwqsNwKM0LGHHnoo9/77739Jm9INpt/Y2Fg+depU1P6JM9ICYtpmChttC8DR1M4wQ8GsYBcyrqqqOvDII48wb0R7ezsKaVf06NGjQJykITLlZs2aJY8bN47FbTWuQFbD5/V6dwmg4myKsWDBDFHUvGTJkphLly7hfhgHjCF119gcpHZbZtNRZrRz5876nTt3IpGGyTcERjej9gj1KSSBLpQAXFjt7e2qgtNruqGh4d20tDRxcoAdlyFthn5awK5OoezfMmak02fqljSSlpk7Wsts6fd5tNmu2uxQo76bufNVhqRx6dO2qIuX9k87H/S4Lz23cHeMjZE14voX80xlpZcBS9k87Sv1hDGDwe7C6cKtEWoqJIGQBG6EBHJzc5+vr69/Iy4ujh1lxK+S6urqquzsbLgzRZ2Mk7gXmrkRYIT3QhGKWiPqirbjhjVT2GhbgISegjUDUvQJCph+dgZuU7jb2AcUSQYyVch6BgB9D3XjqrEjyozInHbX2LoSjCAnjI/FjkLM6EZohNA7QxK4cRKAwlZrrQy64Si78MYNJfTmX5sEQszo1zajofGEJGAtAfHNHVGegSeQ2CD+sW4hdEdIAl0sgRAYdbFAQ82FJBCSQEgCIQk4l0AIjJzLLPRESAIhCYQkEJJAF0vg/wBMng85iZWBHAAAAABJRU5ErkJggg==",WR=()=>Hr("FPScounter",{code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.y=15,I.x=20,a[1].populate(I),r=a[1];const M={};a[2]=this.element({parent:r||"root"},o),a[2].populate(M);const R=f.components&&f.components.Sprite||p.Sprite;r=a[2];const U={};a[3]=this.element({parent:r||"root"},o),U.image=o.image,U.w=43,U.h=25,U.map=o.sprite,U.frame="fps";const x=[];if(typeof R<"u")for(let ft in R.config.props)delete U[R.config.props[ft]],x.push(R.config.props[ft]);a[3].populate(U),r=a[3];const L={};L.image=o.image,L.w=43,L.h=25,L.map=o.sprite,L.frame="fps",m=L.is||"Sprite";let j;if(typeof m=="string"){if(j=f.components&&f.components[m]||p[m],!j)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(j=m);a[4]=j.call(null,{props:L},a[3],o),a[4][Symbol.for("slots")][0]?(r=a[4][Symbol.for("slots")][0],o=a[4]):r=a[4][Symbol.for("children")][0],r=a[2];const H={};a[5]=this.element({parent:r||"root"},o),H.x=58,H.y=2,a[5].populate(H);const Y=f.components&&f.components.Sprite||p.Sprite;r=a[5];const Z={};a[6]=this.element({parent:r||"root"},o),Z.image=o.image,Z.x=0,Z.h=20,Z.w=20,Z.map=o.sprite,Z.frame=o.fps[0];const X=[];if(typeof Y<"u")for(let ft in Y.config.props)delete Z[Y.config.props[ft]],X.push(Y.config.props[ft]);a[6].populate(Z),r=a[6];const re={};re.image=o.image,re.x=0,re.h=20,re.w=20,re.map=o.sprite,re.frame=o.fps[0],m=re.is||"Sprite";let le;if(typeof m=="string"){if(le=f.components&&f.components[m]||p[m],!le)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(le=m);a[7]=le.call(null,{props:re},a[6],o),a[7][Symbol.for("slots")][0]?(r=a[7][Symbol.for("slots")][0],o=a[7]):r=a[7][Symbol.for("children")][0];const se=f.components&&f.components.Sprite||p.Sprite;r=a[5];const W={};a[8]=this.element({parent:r||"root"},o),W.image=o.image,W.x=18,W.h=20,W.w=20,W.map=o.sprite,W.frame=o.fps[1];const ce=[];if(typeof se<"u")for(let ft in se.config.props)delete W[se.config.props[ft]],ce.push(se.config.props[ft]);a[8].populate(W),r=a[8];const E={};E.image=o.image,E.x=18,E.h=20,E.w=20,E.map=o.sprite,E.frame=o.fps[1],m=E.is||"Sprite";let F;if(typeof m=="string"){if(F=f.components&&f.components[m]||p[m],!F)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(F=m);a[9]=F.call(null,{props:E},a[8],o),a[9][Symbol.for("slots")][0]?(r=a[9][Symbol.for("slots")][0],o=a[9]):r=a[9][Symbol.for("children")][0];const ue=f.components&&f.components.Sprite||p.Sprite;r=a[5];const ye={};a[10]=this.element({parent:r||"root"},o),ye.image=o.image,ye.x=36,ye.h=20,ye.w=20,ye.map=o.sprite,ye.frame=o.fps[2];const ge=[];if(typeof ue<"u")for(let ft in ue.config.props)delete ye[ue.config.props[ft]],ge.push(ue.config.props[ft]);a[10].populate(ye),r=a[10];const ie={};ie.image=o.image,ie.x=36,ie.h=20,ie.w=20,ie.map=o.sprite,ie.frame=o.fps[2],m=ie.is||"Sprite";let ee;if(typeof m=="string"){if(ee=f.components&&f.components[m]||p[m],!ee)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(ee=m);a[11]=ee.call(null,{props:ie},a[10],o),a[11][Symbol.for("slots")][0]?(r=a[11][Symbol.for("slots")][0],o=a[11]):r=a[11][Symbol.for("children")][0],r=a[1];const de={};a[12]=this.element({parent:r||"root"},o),de.x=150,a[12].populate(de);const Ee=f.components&&f.components.Sprite||p.Sprite;r=a[12];const Ie={};a[13]=this.element({parent:r||"root"},o),Ie.image=o.image,Ie.y=2,Ie.w=48,Ie.h=25,Ie.map=o.sprite,Ie.frame="avg";const ke=[];if(typeof Ee<"u")for(let ft in Ee.config.props)delete Ie[Ee.config.props[ft]],ke.push(Ee.config.props[ft]);a[13].populate(Ie),r=a[13];const Le={};Le.image=o.image,Le.y=2,Le.w=48,Le.h=25,Le.map=o.sprite,Le.frame="avg",m=Le.is||"Sprite";let _e;if(typeof m=="string"){if(_e=f.components&&f.components[m]||p[m],!_e)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(_e=m);a[14]=_e.call(null,{props:Le},a[13],o),a[14][Symbol.for("slots")][0]?(r=a[14][Symbol.for("slots")][0],o=a[14]):r=a[14][Symbol.for("children")][0],r=a[12];const De={};a[15]=this.element({parent:r||"root"},o),De.x=63,De.y=2,a[15].populate(De);const $=f.components&&f.components.Sprite||p.Sprite;r=a[15];const Pe={};a[16]=this.element({parent:r||"root"},o),Pe.image=o.image,Pe.x=0,Pe.h=20,Pe.w=20,Pe.map=o.sprite,Pe.frame=o.avgFps[0];const He=[];if(typeof $<"u")for(let ft in $.config.props)delete Pe[$.config.props[ft]],He.push($.config.props[ft]);a[16].populate(Pe),r=a[16];const Se={};Se.image=o.image,Se.x=0,Se.h=20,Se.w=20,Se.map=o.sprite,Se.frame=o.avgFps[0],m=Se.is||"Sprite";let V;if(typeof m=="string"){if(V=f.components&&f.components[m]||p[m],!V)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(V=m);a[17]=V.call(null,{props:Se},a[16],o),a[17][Symbol.for("slots")][0]?(r=a[17][Symbol.for("slots")][0],o=a[17]):r=a[17][Symbol.for("children")][0];const Ae=f.components&&f.components.Sprite||p.Sprite;r=a[15];const Ce={};a[18]=this.element({parent:r||"root"},o),Ce.image=o.image,Ce.x=18,Ce.h=20,Ce.w=20,Ce.map=o.sprite,Ce.frame=o.avgFps[1];const je=[];if(typeof Ae<"u")for(let ft in Ae.config.props)delete Ce[Ae.config.props[ft]],je.push(Ae.config.props[ft]);a[18].populate(Ce),r=a[18];const he={};he.image=o.image,he.x=18,he.h=20,he.w=20,he.map=o.sprite,he.frame=o.avgFps[1],m=he.is||"Sprite";let Re;if(typeof m=="string"){if(Re=f.components&&f.components[m]||p[m],!Re)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(Re=m);a[19]=Re.call(null,{props:he},a[18],o),a[19][Symbol.for("slots")][0]?(r=a[19][Symbol.for("slots")][0],o=a[19]):r=a[19][Symbol.for("children")][0];const Ve=f.components&&f.components.Sprite||p.Sprite;r=a[15];const ae={};a[20]=this.element({parent:r||"root"},o),ae.image=o.image,ae.x=36,ae.h=20,ae.w=20,ae.map=o.sprite,ae.frame=o.avgFps[2];const Q=[];if(typeof Ve<"u")for(let ft in Ve.config.props)delete ae[Ve.config.props[ft]],Q.push(Ve.config.props[ft]);a[20].populate(ae),r=a[20];const be={};be.image=o.image,be.x=36,be.h=20,be.w=20,be.map=o.sprite,be.frame=o.avgFps[2],m=be.is||"Sprite";let st;if(typeof m=="string"){if(st=f.components&&f.components[m]||p[m],!st)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(st=m);a[21]=st.call(null,{props:be},a[20],o),a[21][Symbol.for("slots")][0]?(r=a[21][Symbol.for("slots")][0],o=a[21]):r=a[21][Symbol.for("children")][0],r=a[1];const Xe={};a[22]=this.element({parent:r||"root"},o),Xe.x=0,Xe.y=40,a[22].populate(Xe);const Fe=f.components&&f.components.Sprite||p.Sprite;r=a[22];const Ke={};a[23]=this.element({parent:r||"root"},o),Ke.image=o.image,Ke.x=-2,Ke.w=47,Ke.h=25,Ke.map=o.sprite,Ke.frame="min";const kt=[];if(typeof Fe<"u")for(let ft in Fe.config.props)delete Ke[Fe.config.props[ft]],kt.push(Fe.config.props[ft]);a[23].populate(Ke),r=a[23];const qt={};qt.image=o.image,qt.x=-2,qt.w=47,qt.h=25,qt.map=o.sprite,qt.frame="min",m=qt.is||"Sprite";let $t;if(typeof m=="string"){if($t=f.components&&f.components[m]||p[m],!$t)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&($t=m);a[24]=$t.call(null,{props:qt},a[23],o),a[24][Symbol.for("slots")][0]?(r=a[24][Symbol.for("slots")][0],o=a[24]):r=a[24][Symbol.for("children")][0],r=a[22];const We={};a[25]=this.element({parent:r||"root"},o),We.x=58,We.y=2,a[25].populate(We);const Sn=f.components&&f.components.Sprite||p.Sprite;r=a[25];const lt={};a[26]=this.element({parent:r||"root"},o),lt.image=o.image,lt.x=0,lt.h=20,lt.w=20,lt.map=o.sprite,lt.frame=o.minFps[0];const zr=[];if(typeof Sn<"u")for(let ft in Sn.config.props)delete lt[Sn.config.props[ft]],zr.push(Sn.config.props[ft]);a[26].populate(lt),r=a[26];const ui={};ui.image=o.image,ui.x=0,ui.h=20,ui.w=20,ui.map=o.sprite,ui.frame=o.minFps[0],m=ui.is||"Sprite";let oo;if(typeof m=="string"){if(oo=f.components&&f.components[m]||p[m],!oo)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(oo=m);a[27]=oo.call(null,{props:ui},a[26],o),a[27][Symbol.for("slots")][0]?(r=a[27][Symbol.for("slots")][0],o=a[27]):r=a[27][Symbol.for("children")][0];const go=f.components&&f.components.Sprite||p.Sprite;r=a[25];const Lt={};a[28]=this.element({parent:r||"root"},o),Lt.image=o.image,Lt.x=18,Lt.h=20,Lt.w=20,Lt.map=o.sprite,Lt.frame=o.minFps[1];const ut=[];if(typeof go<"u")for(let ft in go.config.props)delete Lt[go.config.props[ft]],ut.push(go.config.props[ft]);a[28].populate(Lt),r=a[28];const Be={};Be.image=o.image,Be.x=18,Be.h=20,Be.w=20,Be.map=o.sprite,Be.frame=o.minFps[1],m=Be.is||"Sprite";let vn;if(typeof m=="string"){if(vn=f.components&&f.components[m]||p[m],!vn)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(vn=m);a[29]=vn.call(null,{props:Be},a[28],o),a[29][Symbol.for("slots")][0]?(r=a[29][Symbol.for("slots")][0],o=a[29]):r=a[29][Symbol.for("children")][0];const vt=f.components&&f.components.Sprite||p.Sprite;r=a[25];const Bn={};a[30]=this.element({parent:r||"root"},o),Bn.image=o.image,Bn.x=36,Bn.h=20,Bn.w=20,Bn.map=o.sprite,Bn.frame=o.minFps[2];const mo=[];if(typeof vt<"u")for(let ft in vt.config.props)delete Bn[vt.config.props[ft]],mo.push(vt.config.props[ft]);a[30].populate(Bn),r=a[30];const Tn={};Tn.image=o.image,Tn.x=36,Tn.h=20,Tn.w=20,Tn.map=o.sprite,Tn.frame=o.minFps[2],m=Tn.is||"Sprite";let fi;if(typeof m=="string"){if(fi=f.components&&f.components[m]||p[m],!fi)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(fi=m);a[31]=fi.call(null,{props:Tn},a[30],o),a[31][Symbol.for("slots")][0]?(r=a[31][Symbol.for("slots")][0],o=a[31]):r=a[31][Symbol.for("children")][0],r=a[1];const bt={};a[32]=this.element({parent:r||"root"},o),bt.x=150,bt.y=40,a[32].populate(bt);const qe=f.components&&f.components.Sprite||p.Sprite;r=a[32];const Zt={};a[33]=this.element({parent:r||"root"},o),Zt.image=o.image,Zt.w=53,Zt.h=25,Zt.map=o.sprite,Zt.frame="max";const Rn=[];if(typeof qe<"u")for(let ft in qe.config.props)delete Zt[qe.config.props[ft]],Rn.push(qe.config.props[ft]);a[33].populate(Zt),r=a[33];const Pt={};Pt.image=o.image,Pt.w=53,Pt.h=25,Pt.map=o.sprite,Pt.frame="max",m=Pt.is||"Sprite";let Ze;if(typeof m=="string"){if(Ze=f.components&&f.components[m]||p[m],!Ze)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(Ze=m);a[34]=Ze.call(null,{props:Pt},a[33],o),a[34][Symbol.for("slots")][0]?(r=a[34][Symbol.for("slots")][0],o=a[34]):r=a[34][Symbol.for("children")][0],r=a[32];const ci={};a[35]=this.element({parent:r||"root"},o),ci.x=63,ci.y=2,a[35].populate(ci);const xn=f.components&&f.components.Sprite||p.Sprite;r=a[35];const Di={};a[36]=this.element({parent:r||"root"},o),Di.image=o.image,Di.x=0,Di.h=20,Di.w=20,Di.map=o.sprite,Di.frame=o.maxFps[0];const pr=[];if(typeof xn<"u")for(let ft in xn.config.props)delete Di[xn.config.props[ft]],pr.push(xn.config.props[ft]);a[36].populate(Di),r=a[36];const fn={};fn.image=o.image,fn.x=0,fn.h=20,fn.w=20,fn.map=o.sprite,fn.frame=o.maxFps[0],m=fn.is||"Sprite";let Hi;if(typeof m=="string"){if(Hi=f.components&&f.components[m]||p[m],!Hi)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(Hi=m);a[37]=Hi.call(null,{props:fn},a[36],o),a[37][Symbol.for("slots")][0]?(r=a[37][Symbol.for("slots")][0],o=a[37]):r=a[37][Symbol.for("children")][0];const zi=f.components&&f.components.Sprite||p.Sprite;r=a[35];const jn={};a[38]=this.element({parent:r||"root"},o),jn.image=o.image,jn.x=18,jn.h=20,jn.w=20,jn.map=o.sprite,jn.frame=o.maxFps[1];const Wn=[];if(typeof zi<"u")for(let ft in zi.config.props)delete jn[zi.config.props[ft]],Wn.push(zi.config.props[ft]);a[38].populate(jn),r=a[38];const Gi={};Gi.image=o.image,Gi.x=18,Gi.h=20,Gi.w=20,Gi.map=o.sprite,Gi.frame=o.maxFps[1],m=Gi.is||"Sprite";let gr;if(typeof m=="string"){if(gr=f.components&&f.components[m]||p[m],!gr)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(gr=m);a[39]=gr.call(null,{props:Gi},a[38],o),a[39][Symbol.for("slots")][0]?(r=a[39][Symbol.for("slots")][0],o=a[39]):r=a[39][Symbol.for("children")][0];const Fn=f.components&&f.components.Sprite||p.Sprite;r=a[35];const Xi={};a[40]=this.element({parent:r||"root"},o),Xi.image=o.image,Xi.x=36,Xi.h=20,Xi.w=20,Xi.map=o.sprite,Xi.frame=o.maxFps[2];const mr=[];if(typeof Fn<"u")for(let ft in Fn.config.props)delete Xi[Fn.config.props[ft]],mr.push(Fn.config.props[ft]);a[40].populate(Xi),r=a[40];const St={};St.image=o.image,St.x=36,St.h=20,St.w=20,St.map=o.sprite,St.frame=o.maxFps[2],m=St.is||"Sprite";let yr;if(typeof m=="string"){if(yr=f.components&&f.components[m]||p[m],!yr)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(yr=m);return a[41]=yr.call(null,{props:St},a[40],o),a[41][Symbol.for("slots")][0]?(r=a[41][Symbol.for("slots")][0],o=a[41]):r=a[41][Symbol.for("children")][0],a},effects:[function(r,o,f,p,v,S){(typeof skip6>"u"||skip6.indexOf("frame")===-1)&&o[6].set("frame",r.fps[0])},function(r,o,f,p,v,S){o[7][Symbol.for("props")].frame=r.fps[0]},function(r,o,f,p,v,S){(typeof skip8>"u"||skip8.indexOf("frame")===-1)&&o[8].set("frame",r.fps[1])},function(r,o,f,p,v,S){o[9][Symbol.for("props")].frame=r.fps[1]},function(r,o,f,p,v,S){(typeof skip10>"u"||skip10.indexOf("frame")===-1)&&o[10].set("frame",r.fps[2])},function(r,o,f,p,v,S){o[11][Symbol.for("props")].frame=r.fps[2]},function(r,o,f,p,v,S){(typeof skip16>"u"||skip16.indexOf("frame")===-1)&&o[16].set("frame",r.avgFps[0])},function(r,o,f,p,v,S){o[17][Symbol.for("props")].frame=r.avgFps[0]},function(r,o,f,p,v,S){(typeof skip18>"u"||skip18.indexOf("frame")===-1)&&o[18].set("frame",r.avgFps[1])},function(r,o,f,p,v,S){o[19][Symbol.for("props")].frame=r.avgFps[1]},function(r,o,f,p,v,S){(typeof skip20>"u"||skip20.indexOf("frame")===-1)&&o[20].set("frame",r.avgFps[2])},function(r,o,f,p,v,S){o[21][Symbol.for("props")].frame=r.avgFps[2]},function(r,o,f,p,v,S){(typeof skip26>"u"||skip26.indexOf("frame")===-1)&&o[26].set("frame",r.minFps[0])},function(r,o,f,p,v,S){o[27][Symbol.for("props")].frame=r.minFps[0]},function(r,o,f,p,v,S){(typeof skip28>"u"||skip28.indexOf("frame")===-1)&&o[28].set("frame",r.minFps[1])},function(r,o,f,p,v,S){o[29][Symbol.for("props")].frame=r.minFps[1]},function(r,o,f,p,v,S){(typeof skip30>"u"||skip30.indexOf("frame")===-1)&&o[30].set("frame",r.minFps[2])},function(r,o,f,p,v,S){o[31][Symbol.for("props")].frame=r.minFps[2]},function(r,o,f,p,v,S){(typeof skip36>"u"||skip36.indexOf("frame")===-1)&&o[36].set("frame",r.maxFps[0])},function(r,o,f,p,v,S){o[37][Symbol.for("props")].frame=r.maxFps[0]},function(r,o,f,p,v,S){(typeof skip38>"u"||skip38.indexOf("frame")===-1)&&o[38].set("frame",r.maxFps[1])},function(r,o,f,p,v,S){o[39][Symbol.for("props")].frame=r.maxFps[1]},function(r,o,f,p,v,S){(typeof skip40>"u"||skip40.indexOf("frame")===-1)&&o[40].set("frame",r.maxFps[2])},function(r,o,f,p,v,S){o[41][Symbol.for("props")].frame=r.maxFps[2]}],context:{}},state(){return{image:XR,sprite:{defaults:{y:1,w:20,h:20},frames:{"-":{x:-1e3},0:{x:1},1:{x:23},2:{x:45},3:{x:67},4:{x:89},5:{x:111},6:{x:133},7:{x:155},8:{x:177},9:{x:199},avg:{x:221,w:48,h:25},fps:{x:271,w:43,h:25},max:{x:316,w:53,h:25},min:{x:371,w:47,h:25}}},fps:"---",avgFps:"---",minFps:"---",maxFps:"---"}},hooks:{ready(){let h=1e4,r=0,o=0,f=0,p=0;Kl.on("fpsUpdate",(v,{fps:S})=>{h=Math.min(S,h),r=Math.max(S,r),f+=S,p++,o=Math.round(f/p),this.fps=S.toString().padStart(3,"0"),this.avgFps=o.toString().padStart(3,"0"),this.minFps=h.toString().padStart(3,"0"),this.maxFps=r.toString().padStart(3,"0")})}}}),qR=()=>Hr("Layout",{code:{render:function(r,o,f,p,v,S){const a=[],m={};return a[0]=this.element({parent:r||"root"},o),m[Symbol.for("isSlot")]=!0,m.ref="slot",a[0].populate(m),a},effects:[],context:{}},props:["direction",{key:"gap",default:0}],hooks:{ready(){this.___layout()}},methods:{___layout(){let h=0;this.$select("slot").children.forEach(r=>{r.set(this.direction==="vertical"?"y":"x",h),h+=(r.node[this.direction==="vertical"?"height":"width"]||0)+(this.gap||0)})}}}),YR=()=>({Circle:HR(),RouterView:zR(),Sprite:GR(),FPScounter:WR(),Layout:qR()}),KR={name:"log",plugin(){return MS("App")}},sg={log:KR},lT=(h,r="",o={})=>{let f;if(typeof r=="object"?o=r:f=r,typeof h=="function"){if(f===void 0)throw Error("Error registering plugin: name is required for plugin");sg[f]={plugin:h,options:o}}else h.plugin&&lT(h.plugin,f||h.name,o)};let j0;const yS=h=>{throw new Error(`Parameter ${h} is required`)},Hr=(h=yS("name"),r=yS("config"))=>{let o;const f=function(v,S,a,m){this.componentId=II(h),this.lifecycle=Object.assign(Object.create(NI),{component:this,previous:null,current:null}),this.parent=a,this.rootParent=m,this[me.holder]=S,this[me.id]=MI(),this[me.props]=Yc(v.props||{},io.get("reactivityMode")),this[me.timeouts]=[],this[me.intervals]=[],this[me.originalState]={...r.state&&typeof r.state=="function"&&r.state.apply(this)||{},hasFocus:!1},this[me.state]=Yc(this[me.originalState],io.get("reactivityMode")),this.lifecycle.state="init",this[me.children]=r.code.render.apply(pg,[S,this,r,j0,Ac,ra])||[],this[me.wrapper]=this[me.children][0],this[me.slots]=this[me.children].filter(I=>I[me.isSlot]),r.hooks&&(r.hooks.frameTick&&Kl.on("frameTick",(I,M)=>z0("frameTick",this[me.identifier],this,[M])),r.hooks.idle&&Kl.on("idle",()=>{z0("idle",this[me.identifier],this)}),r.hooks.attach&&this[me.wrapper].node.on("inBounds",()=>{this.lifecycle.state="attach"}),r.hooks.detach&&this[me.wrapper].node.on("outOfBounds",(I,{previous:M})=>{M>0&&(this.lifecycle.state="detach")}),r.hooks.enter&&this[me.wrapper].node.on("inViewport",()=>{this.lifecycle.state="enter"}),r.hooks.exit&&this[me.wrapper].node.on("outOfViewport",()=>{this.lifecycle.state="exit"}));const _=r.code.effects;for(let I=0;I<_.length;I++)Ac(()=>{_[I](this,this[me.children],r,j0,m,Ac)});return this[me.watchers]&&Object.keys(this[me.watchers]).forEach(I=>{let M=this,R=I;if(I.indexOf(".")>-1){const x=I.split(".");R=x.pop();for(let L=0;L<x.length;L++)M=M[x[L]]}let U=this[R];Ac((x=!1)=>{const L=M[R];(U!==L||x===!0)&&(this[me.watchers][I].apply(this,[L,U]),U=L)})}),Object.getOwnPropertySymbols(this).forEach(I=>{Object.defineProperties(this,{[I]:{enumerable:!1,configurable:!1}})}),setTimeout(()=>this.lifecycle.state="ready"),this},p=(v={},S,a,m)=>(Nl[me.launched]===!1&&(Object.keys(sg).forEach(_=>{const I=`$${_}`;I in Nl&&Kt.warn(`"${_}" (this.${I}) already exists as a property or plugin on the Base Component. You may be overwriting built-in functionality. Proceed with care!`);const M=sg[_];Object.defineProperty(Nl,I,{value:M.plugin(M.options),writable:!1,enumerable:!0,configurable:!1})}),j0=YR(),Nl[me.launched]=!0),o||(Kt.debug(`Setting up ${h} component`),o=VR(Object.create(Nl),r)),r.code||(Kt.debug(`Generating code for ${h} component`),r.code=TI.call(r,SI(r.template,h))),f.call(Object.create(o),v,S,a,m));return p.config=r,p},ZR=h=>{const r={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Enter:"enter"," ":"space",Backspace:"back",Escape:"escape",37:"left",39:"right",38:"up",40:"down",13:"enter",32:"space",8:"back",27:"escape"};h.hooks=h.hooks||{};let o,f,p;return h.hooks[me.destroy]=function(){document.removeEventListener("keydown",o),document.removeEventListener("keyup",f)},h.hooks[me.init]=function(){const v={...r,...io.get("keymap",{})};o=S=>{const a=v[S.key]||v[S.keyCode]||S.key||S.keyCode;fr.input(a,S),clearTimeout(p),p=setTimeout(()=>{fr.hold=!0},io.get("holdTimeout",ZS))},f=()=>{clearTimeout(p),fr.hold=!1},document.addEventListener("keydown",o),document.addEventListener("keyup",f),setTimeout(()=>fr.set(this))},Hr("App",h)},at={Component:Hr,Application:ZR,Launch:dR,Plugin:lT},QR=h=>new Promise((r,o)=>{const f=new XMLHttpRequest;f.onreadystatechange=function(){f.readyState==XMLHttpRequest.DONE&&(f.status===0||f.status===200?r(JSON.parse(f.responseText)):o(f.statusText))},f.open("GET",h),f.send(null)}),JR={name:"language",plugin(h={}){let r={},o={};const f=Yc({language:"",loaded:0}),p=a=>{o=r[a]||{},f.language=a,Object.keys(r).length===0&&Kt.warn("No translations loaded. Please load a file with translations or specify a translations object manually"),a in r||Kt.warn(`Language ${a} not available in the loaded translations`)},v=a=>QR(a).then(m=>{S(m)}).catch(m=>{Kt.error(m)}),S=a=>{r=a,o=r[f.language]||{},f.loaded++};return"file"in h?v(h.file).then(()=>{"language"in h&&p(h.language)}):"language"in h&&p(h.language),{translate(a){f.language,f.loaded;let m=[...arguments].slice(1);return m.length===0?o&&o[a]||a:(m.length===1&&typeof m[0]=="object"&&(m=m.pop()),Object.keys(Array.isArray(m)?Object.assign({},m):m).reduce((_,I)=>_.replace(new RegExp("{\\s?"+I+"\\s?}","g"),m[I]),o&&o[a]||a))},get language(){return f.language},set(a){p(a)},translations(a){S(a)},load(a){return v(a)}}}},e_=(h,r,o)=>{const f=o.split(".");for(let p=0;p<f.length;p++){const v=f[p];if(h!==null&&v in h)h=h[v],r=r!==null&&v in r?r[v]:null;else if(r!==null&&v in r)r=r[v],h=r;else{h=void 0;break}}return h},uT={name:"theme",plugin(h={}){let r={};const o=Yc({current:"default"});let f={},p=null;return"themes"in h?(f=h.themes,o.current=h.current||"default",p=h.base||"default"):f={default:h},{get(v,S){if(o.current,r[v]!==void 0)return r[v];const a=e_(f[o.current],f[p],v);return a!==void 0?(r[v]=a,a):S},set(v){v in f?(r={},o.current=v):Kt.warn(`Theme ${v} not found`)}}}},F0=h=>new URLSearchParams(window.location.search).get(h),Ol={sky:{test(){return navigator.userAgent.indexOf("WPE Sky")>-1||F0("keymapping")==="sky"},mapping:{Escape:"back",27:"back"}},webos:{test(){return navigator.userAgent.indexOf("WebOS")>-1||F0("keymapping")==="webos"},mapping:{19:"pause",33:"channelUp",34:"channelDown",412:"rewind",413:"stop",415:"play",417:"fastForward",461:"back"}},tizen:{test(){return navigator.userAgent.indexOf("Tizen")>-1||F0("keymapping")==="tizen"},mapping:{10009:"back",10252:"playPause",19:"pause",412:"rewind",413:"stop",415:"play",417:"fastForward",427:"channelUp",428:"channelDown"}}},t_=()=>{let h={};return Object.keys(Ol).forEach(r=>{if(Ol[r].test&&typeof Ol[r].test=="function"&&Ol[r].test()===!0){h=Ol[r].mapping;return}}),h},n_="modulepreload",i_=function(h){return"/"+h},vS={},o_=function(r,o,f){if(!o||o.length===0)return r();const p=document.getElementsByTagName("link");return Promise.all(o.map(v=>{if(v=i_(v),v in vS)return;vS[v]=!0;const S=v.endsWith(".css"),a=S?'[rel="stylesheet"]':"";if(!!f)for(let I=p.length-1;I>=0;I--){const M=p[I];if(M.href===v&&(!S||M.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${v}"]${a}`))return;const _=document.createElement("link");if(_.rel=S?"stylesheet":n_,S||(_.as="script",_.crossOrigin=""),_.href=v,document.head.appendChild(_),S)return new Promise((I,M)=>{_.addEventListener("load",I),_.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${v}`)))})})).then(()=>r()).catch(v=>{const S=new Event("vite:preloadError",{cancelable:!0});if(S.payload=v,window.dispatchEvent(S),!S.defaultPrevented)throw v})},r_=at.Component("PortalItem",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.w=370,m.h=320,m.scale={transition:o.hasFocus?1.1:1},m.color=o.backgroundColor,m.effects=[o.shader("radius",{radius:6})],a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.x=30,_.y=30,_.content=o.number,_.size=84,_.color=o.fontColor,_.__textnode=!0,a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.x=30,I.y=140,I.content=o.title,I.size=42,I.font="raleway",I.color=o.fontColor,I.letterspacing=2,I.__textnode=!0,a[2].populate(I),r=a[0];const M={};return a[3]=this.element({parent:r||"root"},o),M.x=30,M.y=200,M.content=o.description,M.wordwrap=300,M.size=28,M.color=o.fontColor,M.lineheight=32,M.__textnode=!0,a[3].populate(M),a},effects:[function(r,o,f,p,v,S){o[0].set("scale",{transition:r.hasFocus?1.1:1})},function(r,o,f,p,v,S){o[0].set("color",r.backgroundColor)},function(r,o,f,p,v,S){o[0].set("effects",[r.shader("radius",{radius:6})])},function(r,o,f,p,v,S){o[1].set("content",r.number)},function(r,o,f,p,v,S){o[1].set("color",r.fontColor)},function(r,o,f,p,v,S){o[2].set("content",r.title)},function(r,o,f,p,v,S){o[2].set("color",r.fontColor)},function(r,o,f,p,v,S){o[3].set("content",r.description)},function(r,o,f,p,v,S){o[3].set("color",r.fontColor)}],context:{}},props:["title","description","index","id"],state(){return{backgroundColor:"#44037a",fontColor:"#e8d7f9",number:this.index<9?`0${this.index+1}`:this.index+1}},hooks:{focus(){this.backgroundColor="#fafafa",this.fontColor="#000"},unfocus(){this.$router.navigating||(this.backgroundColor="#44037a",this.fontColor="#e8d7f9")}},input:{enter(){this.$router.to(`/${this.id}`)},back(){}}}),s_=at.Component("PortalRow",{components:{PortalItem:r_},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.alpha={transition:{value:o.itemOffset<240?1:0,duration:200}},a[1].populate(I),r=a[1];const M={};a[2]=this.element({parent:r||"root"},o),M.content=o.title,M.x=60,M.__textnode=!0,a[2].populate(M),r=a[1];const R={};a[3]=this.element({parent:r||"root"},o),R.y=50,R.x=60,R.h=1,R.w=1800,R.color="0xe8d7f9ff",a[3].populate(R),r=a[0];const U={};a[4]=this.element({parent:r||"root"},o),U.y=100,U.x={transition:o.rowOffset},a[4].populate(U),r=a[4];const x=[],L=(j=[],H,Y)=>{const Z=S(j),X=new Set;let re=Z.length;for(;re--;){const W=Z[re];X.add(""+W.id)}let le=Y.length;for(;le--;)if(X.has(Y[le])===!1){const W=Y[le];H[5][W]&&H[5][W].destroy(),delete H[5][W],H[6][W]&&H[6][W].destroy(),delete H[6][W]}Y.length=0;const se=Z.length;for(let W=0;W<se;W++){const ce=Object.create(o);r=H[4],ce.index=W,ce.item=Z[W],ce.key=""+ce.item.id,Y.push(ce.key);const E=f.components&&f.components.PortalItem||p.PortalItem;H[5]===void 0&&(H[5]={});const F={};H[5][ce.key]===void 0&&(H[5][ce.key]=this.element({parent:r||"root"},o)),F.x={transition:{value:ce.itemOffset+ce.index*430,delay:50*(ce.index%4),duration:500}},F.title=ce.item.title,F.description=ce.item.description,F.id=ce.item.id,F.index=ce.index,F.ref="item"+ce.index;const ue=[];if(typeof E<"u")for(let ge in E.config.props)delete F[E.config.props[ge]],ue.push(E.config.props[ge]);H[5][ce.key].nodeId===void 0&&H[5][ce.key].populate(F),H[6]===void 0&&(H[6]={}),r=H[5][ce.key];const ye={};if(H[6][ce.key]===void 0){ye.x={transition:{value:ce.itemOffset+ce.index*430,delay:50*(ce.index%4),duration:500}},ye.title=ce.item.title,ye.description=ce.item.description,ye.id=ce.item.id,ye.index=ce.index,ye.ref="item"+ce.index,m=ye.is||"PortalItem";let ge;if(typeof m=="string"){if(ge=f.components&&f.components[m]||p[m],!ge)throw new Error('Component "PortalItem" not found')}else typeof m=="function"&&m.name==="factory"&&(ge=m);H[6][ce.key]=ge.call(null,{props:ye},H[5][ce.key],o),H[6][ce.key][Symbol.for("slots")][0]?(r=H[6][ce.key][Symbol.for("slots")][0],o=H[6][ce.key]):r=H[6][ce.key][Symbol.for("children")][0]}v(()=>{(typeof ue>"u"||ue.indexOf("ref")===-1)&&H[5][ce.key].set("ref","item"+ce.index)},"items"),H[6][ce.key][Symbol.for("props")].ref="item"+ce.index}};return v(()=>{L(o.items,a,x)},"items"),v(()=>{o.itemOffset;for(let j=0;j<o.items.length;j++){const H={};H.index=j,H.item=o.items[j],H.key=H.item.id,(typeof skip5>"u"||skip5.indexOf("x")===-1)&&a[5][H.key].set("x",{transition:{value:o.itemOffset+H.index*430,delay:50*(H.index%4),duration:500}})}}),v(()=>{o.itemOffset;for(let j=0;j<o.items.length;j++){const H={};H.index=j,H.item=o.items[j],H.key=H.item.id,a[6][H.key][Symbol.for("props")].x={transition:{value:o.itemOffset+H.index*430,delay:50*(H.index%4),duration:500}}}}),a},effects:[function(r,o,f,p,v,S){o[1].set("alpha",{transition:{value:r.itemOffset<240?1:0,duration:200}})},function(r,o,f,p,v,S){o[4].set("x",{transition:r.rowOffset})}],context:{}},props:["title","items"],state(){return{focused:0,rowOffset:60,itemOffset:240}},hooks:{ready(){this.itemOffset=0},focus(){this.$trigger("focused")}},watch:{focused(h){const r=this.$select(`item${h}`);r&&r.$focus&&(r.$focus(),h<1?this.rowOffset=60:h>this.items.length-2?this.rowOffset=60-(this.items.length-2)*430+430:this.rowOffset=60-h*430+430)}},input:{left(){this.focused>0?this.focused--:this.focused=this.items.length-1},right(){this.focused<this.items.length-1?this.focused++:this.focused=0}}}),a_="@lightningjs/blits-example-app",l_="1.1.0",u_="Lightning 3 Blits Example App",f_="index.js",c_="module",h_={start:"npm run dev","start:test":"NODE_ENV=testing npm run dev",lint:"eslint '**/*.js'","lint:fix":"eslint '**/*.js' --fix",build:"vite build",dev:"vite dev --host",test:"NODE_ENV=testing backstop --config=backstop.cjs test","test:reference":"NODE_ENV=testing backstop --config=backstop.cjs reference"},d_={hooks:{"pre-commit":"lint-staged"}},p_="Michiel van der Geest <hello@michielvandergeest.com>",g_="Apache-2",m_={backstopjs:"^6.3.22",eslint:"^8.8.0","eslint-config-prettier":"^8.3.0","eslint-plugin-prettier":"^4.0.0",husky:"^7.0.4","lint-staged":"^12.3.3",playwright:"^1.41.0",prettier:"^2.5.1","shaka-player":"^4.7.1",vite:"^4.0.4"},y_={"@lightningjs/blits":"^1.4.0"},v_={name:a_,version:l_,description:u_,main:f_,type:c_,scripts:h_,"lint-staged":{"*.js":["eslint --fix"]},husky:d_,author:p_,license:g_,devDependencies:m_,dependencies:y_},x_=at.Component("Portal",{components:{PortalRow:s_},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),_.w=1920,_.h=1080,_.color="{top: '0x44037aff', bottom: '0x240244ff'}",a[0].populate(_);const I=f.components&&f.components.PortalRow||p.PortalRow;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o),M.mount="{y: 0.5}",M.h=500,M.y={transition:-o.rowFocused*420+550},M.title="Demos",M.items=o.demo,M.ref="row0";const R=[];if(typeof I<"u")for(let de in I.config.props)delete M[I.config.props[de]],R.push(I.config.props[de]);a[1].populate(M),r=a[1];const U={};U.mount="{y: 0.5}",U.h=500,U.y={transition:-o.rowFocused*420+550},U.title="Demos",U.items=o.demo,U.ref="row0",m=U.is||"PortalRow";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "PortalRow" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0];const L=f.components&&f.components.PortalRow||p.PortalRow;r=a[0];const j={};a[3]=this.element({parent:r||"root"},o),j.mount="{y: 0.5}",j.h=500,j.y={transition:-o.rowFocused*420+1100},j.title="Examples and tests",j.items=o.example,j.ref="row1";const H=[];if(typeof L<"u")for(let de in L.config.props)delete j[L.config.props[de]],H.push(L.config.props[de]);a[3].populate(j),r=a[3];const Y={};Y.mount="{y: 0.5}",Y.h=500,Y.y={transition:-o.rowFocused*420+1100},Y.title="Examples and tests",Y.items=o.example,Y.ref="row1",m=Y.is||"PortalRow";let Z;if(typeof m=="string"){if(Z=f.components&&f.components[m]||p[m],!Z)throw new Error('Component "PortalRow" not found')}else typeof m=="function"&&m.name==="factory"&&(Z=m);a[4]=Z.call(null,{props:Y},a[3],o),a[4][Symbol.for("slots")][0]?(r=a[4][Symbol.for("slots")][0],o=a[4]):r=a[4][Symbol.for("children")][0];const X=f.components&&f.components.PortalRow||p.PortalRow;r=a[0];const re={};a[5]=this.element({parent:r||"root"},o),re.mount="{y: 0.5}",re.h=500,re.y={transition:-o.rowFocused*420+1650},re.title="Benchmarks and stress tests",re.items=o.benchmark,re.ref="row2";const le=[];if(typeof X<"u")for(let de in X.config.props)delete re[X.config.props[de]],le.push(X.config.props[de]);a[5].populate(re),r=a[5];const se={};se.mount="{y: 0.5}",se.h=500,se.y={transition:-o.rowFocused*420+1650},se.title="Benchmarks and stress tests",se.items=o.benchmark,se.ref="row2",m=se.is||"PortalRow";let W;if(typeof m=="string"){if(W=f.components&&f.components[m]||p[m],!W)throw new Error('Component "PortalRow" not found')}else typeof m=="function"&&m.name==="factory"&&(W=m);a[6]=W.call(null,{props:se},a[5],o),a[6][Symbol.for("slots")][0]?(r=a[6][Symbol.for("slots")][0],o=a[6]):r=a[6][Symbol.for("children")][0],r=a[0];const ce={};a[7]=this.element({parent:r||"root"},o),ce.w=1920,ce.h=200,ce.color="0x44037aff",a[7].populate(ce),r=a[7];const E={};a[8]=this.element({parent:r||"root"},o),E.w=1920,E.h=70,E.y=200,E.color="{top: '0x44037aff'}",a[8].populate(E),r=a[7];const F={};a[9]=this.element({parent:r||"root"},o),F.y={transition:{value:80-o.logoOffset,duration:400}},a[9].populate(F),r=a[9];const ue={};a[10]=this.element({parent:r||"root"},o),ue.src="assets/blits-logo-full.png",ue.w=200,ue.h=112,ue.x=60,a[10].populate(ue),r=a[9];const ye={};a[11]=this.element({parent:r||"root"},o),ye.w=2,ye.h=120,ye.y=-10,ye.color="0xffffff80",ye.x=300,a[11].populate(ye),r=a[9];const ge={};a[12]=this.element({parent:r||"root"},o),ge.x=320,ge.y=16,a[12].populate(ge),r=a[12];const ie={};a[13]=this.element({parent:r||"root"},o),ie.y=0,ie.size=36,ie.content="Example App",ie.__textnode=!0,a[13].populate(ie),r=a[12];const ee={};return a[14]=this.element({parent:r||"root"},o),ee.y=50,ee.size=24,ee.content="v"+o.version,ee.__textnode=!0,a[14].populate(ee),a},effects:[function(r,o,f,p,v,S){(typeof skip1>"u"||skip1.indexOf("y")===-1)&&o[1].set("y",{transition:-r.rowFocused*420+550})},function(r,o,f,p,v,S){o[2][Symbol.for("props")].y={transition:-r.rowFocused*420+550}},function(r,o,f,p,v,S){(typeof skip3>"u"||skip3.indexOf("y")===-1)&&o[3].set("y",{transition:-r.rowFocused*420+1100})},function(r,o,f,p,v,S){o[4][Symbol.for("props")].y={transition:-r.rowFocused*420+1100}},function(r,o,f,p,v,S){(typeof skip5>"u"||skip5.indexOf("y")===-1)&&o[5].set("y",{transition:-r.rowFocused*420+1650})},function(r,o,f,p,v,S){o[6][Symbol.for("props")].y={transition:-r.rowFocused*420+1650}},function(r,o,f,p,v,S){o[9].set("y",{transition:{value:80-r.logoOffset,duration:400}})}],context:{}},state(){return{version:v_.version,offset:60,rowFocused:0,rows:["demo","example","benchmark"],logoOffset:50,demo:[{title:"Loader",id:"demos/loading",description:"A basic loading screen"},{title:"Intro",id:"demos/intro",description:"A splash screen with custom animations"},{title:"Theming",id:"demos/theming",description:"Dynamically changing the styling of a component with themes"},{title:"TMDB",id:"demos/tmdb",description:"The Movie Database (TMDB) example using data from a remote API"},{title:"Sprites",id:"demos/sprites",description:"Display multiple images while keeping low memory footprint"},{title:"Focus",id:"demos/focushandling",description:"Managing focus between components in a simple layout"},{title:"Memory Game",id:"demos/memory-game",description:"Memory game with speech assistence (for accessibility)"},{title:"Video player",id:"demos/player",description:"Example of Video Playback with basic controls"}],example:[{title:"Positioning",id:"examples/positioning",description:"Positioning Elements and Components"},{title:"Colors",id:"examples/colors",description:"Using different formats and notations for defining colors"},{title:"Gradients",id:"examples/gradients",description:"Example of Basic gradients"},{title:"Transitions",id:"examples/transitions",description:"Comparing different transition easing functions"},{title:"Components",id:"examples/components",description:"Reusable Components"},{title:"Alpha",id:"examples/alpha",description:"Applying transparency to Elements, Images and Components"},{title:"Scaling",id:"examples/scaling",description:"Resizing and scaling Elements and Components"},{title:"Rotation",id:"examples/rotation",description:"Rotating Elements"},{title:"Key input",id:"examples/keyinput",description:"Handling user input events"},{title:"For Loop",id:"examples/forloop",description:"Iterating over Elements and Components using for loops"},{title:"Advanced loop",id:"examples/forloop-advanced",description:"Testing various Array operations with a for loop"},{title:"Effects",id:"examples/effects",description:"Applying one or multiple effects (aka shaders)"},{title:"Show",id:"examples/showif",description:"Conditionally show or hide Elements and Components"},{title:"Events",id:"examples/events",description:"Communication between components by emitting and listening for events"},{title:"Images",id:"examples/images",description:"1 image says more than 1000 words ;)"},{title:"Texts",id:"examples/texts",description:"Displaying and formatting text"},{title:"Slots",id:"examples/slots",description:"Insert dynamic content from a parent into a child using slots"},{title:"Viewport",id:"examples/viewport",description:"Lifecycle events when entering and leaving the viewport (margins)"},{title:"Image resizing",id:"examples/resize",description:'Using the "fit" syntax for resizing images on the fly'},{title:"Translations",id:"examples/languageplugin",description:"Language Plugin for internationalization"}],benchmark:[{title:"Exponential",id:"benchmarks/exponential",description:"Spawn a large number of components at an exponential rate"}]}},hooks:{ready(){this.logoOffset=0,this.$trigger("rowFocused"),console.log("backstopjs:ready")}},watch:{rowFocused(h){const r=this.$select(`row${h}`);r&&r.$focus&&r.$focus()}},input:{up(){this.rowFocused=(this.rowFocused-1+this.rows.length)%this.rows.length},down(){this.rowFocused=(this.rowFocused+1)%this.rows.length}}}),w_=at.Component("Letter",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.w=o.w,_.h={transition:{value:410+o.offset,duration:o.duration,delay:o.wait,easing:o.timingFunction}},_.color="0xe6e6e6ff",a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.w=o.w,I.h=280,I.src=o.image,I.y={transition:{value:400+o.offset,duration:o.duration,delay:o.wait,easing:o.timingFunction}},a[2].populate(I),r=a[0];const M={};return a[3]=this.element({parent:r||"root"},o),M.w=o.w,M.color="0xe6e6e6ff",M.h={transition:{value:500-o.offset,duration:o.duration,delay:o.wait,easing:o.timingFunction}},M.y={transition:{value:660+o.offset,duration:o.duration,delay:o.wait,easing:o.timingFunction}},a[3].populate(M),a},effects:[function(r,o,f,p,v,S){o[1].set("h",{transition:{value:410+r.offset,duration:r.duration,delay:r.wait,easing:r.timingFunction}})},function(r,o,f,p,v,S){o[2].set("src",r.image)},function(r,o,f,p,v,S){o[2].set("y",{transition:{value:400+r.offset,duration:r.duration,delay:r.wait,easing:r.timingFunction}})},function(r,o,f,p,v,S){o[3].set("h",{transition:{value:500-r.offset,duration:r.duration,delay:r.wait,easing:r.timingFunction}})},function(r,o,f,p,v,S){o[3].set("y",{transition:{value:660+r.offset,duration:r.duration,delay:r.wait,easing:r.timingFunction}})}],context:{}},props:["w","letter","direction","delay"],computed:{image(){return`assets/${this.letter}.png`}},state(){return{offset:this.direction==="up"?-680:680,duration:1e3,wait:0,timingFunction:"cubic-bezier(1,-0.64,.39,1.44)"}},hooks:{ready(){this.animate()}},methods:{animate(){this.$setTimeout(()=>{this.offset=0},1e3),this.$setTimeout(()=>{this.wait=this.delay+150,this.duration=1e3,this.offset=1080},2800),this.$setTimeout(()=>{this.wait=this.delay/3,this.timingFunction="ease-in-out",this.duration=1500,this.offset=0},5e3)}}}),S_=at.Component("Intro",{components:{Letter:w_},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),_.w=1920,_.h=1080,_.src="assets/background.jpg",a[0].populate(_);const I=f.components&&f.components.Letter||p.Letter;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o),M.letter="l",M.w=294;const R=[];if(typeof I<"u")for(let Xe in I.config.props)delete M[I.config.props[Xe]],R.push(I.config.props[Xe]);a[1].populate(M),r=a[1];const U={};U.letter="l",U.w=294,m=U.is||"Letter";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "Letter" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0];const L=f.components&&f.components.Letter||p.Letter;r=a[0];const j={};a[3]=this.element({parent:r||"root"},o),j.letter="i-1",j.w=128,j.x=294,j.direction="up",j.delay=50;const H=[];if(typeof L<"u")for(let Xe in L.config.props)delete j[L.config.props[Xe]],H.push(L.config.props[Xe]);a[3].populate(j),r=a[3];const Y={};Y.letter="i-1",Y.w=128,Y.x=294,Y.direction="up",Y.delay=50,m=Y.is||"Letter";let Z;if(typeof m=="string"){if(Z=f.components&&f.components[m]||p[m],!Z)throw new Error('Component "Letter" not found')}else typeof m=="function"&&m.name==="factory"&&(Z=m);a[4]=Z.call(null,{props:Y},a[3],o),a[4][Symbol.for("slots")][0]?(r=a[4][Symbol.for("slots")][0],o=a[4]):r=a[4][Symbol.for("children")][0];const X=f.components&&f.components.Letter||p.Letter;r=a[0];const re={};a[5]=this.element({parent:r||"root"},o),re.letter="g-1",re.w=205,re.x=422,re.delay=100;const le=[];if(typeof X<"u")for(let Xe in X.config.props)delete re[X.config.props[Xe]],le.push(X.config.props[Xe]);a[5].populate(re),r=a[5];const se={};se.letter="g-1",se.w=205,se.x=422,se.delay=100,m=se.is||"Letter";let W;if(typeof m=="string"){if(W=f.components&&f.components[m]||p[m],!W)throw new Error('Component "Letter" not found')}else typeof m=="function"&&m.name==="factory"&&(W=m);a[6]=W.call(null,{props:se},a[5],o),a[6][Symbol.for("slots")][0]?(r=a[6][Symbol.for("slots")][0],o=a[6]):r=a[6][Symbol.for("children")][0];const ce=f.components&&f.components.Letter||p.Letter;r=a[0];const E={};a[7]=this.element({parent:r||"root"},o),E.letter="h",E.w=224,E.x=627,E.direction="up",E.delay=150;const F=[];if(typeof ce<"u")for(let Xe in ce.config.props)delete E[ce.config.props[Xe]],F.push(ce.config.props[Xe]);a[7].populate(E),r=a[7];const ue={};ue.letter="h",ue.w=224,ue.x=627,ue.direction="up",ue.delay=150,m=ue.is||"Letter";let ye;if(typeof m=="string"){if(ye=f.components&&f.components[m]||p[m],!ye)throw new Error('Component "Letter" not found')}else typeof m=="function"&&m.name==="factory"&&(ye=m);a[8]=ye.call(null,{props:ue},a[7],o),a[8][Symbol.for("slots")][0]?(r=a[8][Symbol.for("slots")][0],o=a[8]):r=a[8][Symbol.for("children")][0];const ge=f.components&&f.components.Letter||p.Letter;r=a[0];const ie={};a[9]=this.element({parent:r||"root"},o),ie.letter="t",ie.w=190,ie.x=851,ie.delay=200;const ee=[];if(typeof ge<"u")for(let Xe in ge.config.props)delete ie[ge.config.props[Xe]],ee.push(ge.config.props[Xe]);a[9].populate(ie),r=a[9];const de={};de.letter="t",de.w=190,de.x=851,de.delay=200,m=de.is||"Letter";let Ee;if(typeof m=="string"){if(Ee=f.components&&f.components[m]||p[m],!Ee)throw new Error('Component "Letter" not found')}else typeof m=="function"&&m.name==="factory"&&(Ee=m);a[10]=Ee.call(null,{props:de},a[9],o),a[10][Symbol.for("slots")][0]?(r=a[10][Symbol.for("slots")][0],o=a[10]):r=a[10][Symbol.for("children")][0];const Ie=f.components&&f.components.Letter||p.Letter;r=a[0];const ke={};a[11]=this.element({parent:r||"root"},o),ke.letter="n-1",ke.w=221,ke.x=1041,ke.direction="up",ke.delay=250;const Le=[];if(typeof Ie<"u")for(let Xe in Ie.config.props)delete ke[Ie.config.props[Xe]],Le.push(Ie.config.props[Xe]);a[11].populate(ke),r=a[11];const _e={};_e.letter="n-1",_e.w=221,_e.x=1041,_e.direction="up",_e.delay=250,m=_e.is||"Letter";let De;if(typeof m=="string"){if(De=f.components&&f.components[m]||p[m],!De)throw new Error('Component "Letter" not found')}else typeof m=="function"&&m.name==="factory"&&(De=m);a[12]=De.call(null,{props:_e},a[11],o),a[12][Symbol.for("slots")][0]?(r=a[12][Symbol.for("slots")][0],o=a[12]):r=a[12][Symbol.for("children")][0];const $=f.components&&f.components.Letter||p.Letter;r=a[0];const Pe={};a[13]=this.element({parent:r||"root"},o),Pe.letter="i-2",Pe.w=115,Pe.x=1262,Pe.delay=300;const He=[];if(typeof $<"u")for(let Xe in $.config.props)delete Pe[$.config.props[Xe]],He.push($.config.props[Xe]);a[13].populate(Pe),r=a[13];const Se={};Se.letter="i-2",Se.w=115,Se.x=1262,Se.delay=300,m=Se.is||"Letter";let V;if(typeof m=="string"){if(V=f.components&&f.components[m]||p[m],!V)throw new Error('Component "Letter" not found')}else typeof m=="function"&&m.name==="factory"&&(V=m);a[14]=V.call(null,{props:Se},a[13],o),a[14][Symbol.for("slots")][0]?(r=a[14][Symbol.for("slots")][0],o=a[14]):r=a[14][Symbol.for("children")][0];const Ae=f.components&&f.components.Letter||p.Letter;r=a[0];const Ce={};a[15]=this.element({parent:r||"root"},o),Ce.letter="n-2",Ce.w=219,Ce.x=1377,Ce.direction="up",Ce.delay=350;const je=[];if(typeof Ae<"u")for(let Xe in Ae.config.props)delete Ce[Ae.config.props[Xe]],je.push(Ae.config.props[Xe]);a[15].populate(Ce),r=a[15];const he={};he.letter="n-2",he.w=219,he.x=1377,he.direction="up",he.delay=350,m=he.is||"Letter";let Re;if(typeof m=="string"){if(Re=f.components&&f.components[m]||p[m],!Re)throw new Error('Component "Letter" not found')}else typeof m=="function"&&m.name==="factory"&&(Re=m);a[16]=Re.call(null,{props:he},a[15],o),a[16][Symbol.for("slots")][0]?(r=a[16][Symbol.for("slots")][0],o=a[16]):r=a[16][Symbol.for("children")][0];const Ve=f.components&&f.components.Letter||p.Letter;r=a[0];const ae={};a[17]=this.element({parent:r||"root"},o),ae.letter="g-2",ae.w=324,ae.x=1596,ae.direction="up",ae.delay=400;const Q=[];if(typeof Ve<"u")for(let Xe in Ve.config.props)delete ae[Ve.config.props[Xe]],Q.push(Ve.config.props[Xe]);a[17].populate(ae),r=a[17];const be={};be.letter="g-2",be.w=324,be.x=1596,be.direction="up",be.delay=400,m=be.is||"Letter";let st;if(typeof m=="string"){if(st=f.components&&f.components[m]||p[m],!st)throw new Error('Component "Letter" not found')}else typeof m=="function"&&m.name==="factory"&&(st=m);return a[18]=st.call(null,{props:be},a[17],o),a[18][Symbol.for("slots")][0]?(r=a[18][Symbol.for("slots")][0],o=a[18]):r=a[18][Symbol.for("children")][0],a},effects:[],context:{}}}),T_=at.Component("Toggle",{code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),_.w=100,_.h=50,_.y=5,_.color=o.bgColor,_.effects=[o.shader("radius",{radius:25})],a[0].populate(_);const I=f.components&&f.components.Circle||p.Circle;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o),M.x={transition:o.on?0:50},M.size=50;const R=[];if(typeof I<"u")for(let L in I.config.props)delete M[I.config.props[L]],R.push(I.config.props[L]);a[1].populate(M),r=a[1];const U={};U.x={transition:o.on?0:50},U.size=50,U.color=o.primaryColor,m=U.is||"Circle";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "Circle" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);return a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0],a},effects:[function(r,o,f,p,v,S){o[0].set("color",r.bgColor)},function(r,o,f,p,v,S){o[0].set("effects",[r.shader("radius",{radius:25})])},function(r,o,f,p,v,S){(typeof skip1>"u"||skip1.indexOf("x")===-1)&&o[1].set("x",{transition:r.on?0:50})},function(r,o,f,p,v,S){o[2][Symbol.for("props")].x={transition:r.on?0:50}},function(r,o,f,p,v,S){o[2][Symbol.for("props")].color=r.primaryColor}],context:{}},props:["bgColor","primaryColor","on"]}),C_=at.Component("Bar",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.w={value:o.w,duration:o.duration},m.h={value:o.h,duration:o.duration},m.color=o.bgColor,m.x=o.index*(o.w+o.w/4),m.effects=[o.shader("radius",{radius:10})],a[0].populate(m),r=a[0];const _={};return a[1]=this.element({parent:r||"root"},o),_.w=o.w,_.y={transition:{value:o.h-o.innerH,duration:o.duration}},_.h={transition:{value:o.innerH,duration:o.duration}},_.color=o.primaryColor,_.effects=[o.shader("radius",{radius:10})],a[1].populate(_),a},effects:[function(r,o,f,p,v,S){o[0].set("w",{value:r.w,duration:r.duration})},function(r,o,f,p,v,S){o[0].set("h",{value:r.h,duration:r.duration})},function(r,o,f,p,v,S){o[0].set("color",r.bgColor)},function(r,o,f,p,v,S){o[0].set("x",r.index*(r.w+r.w/4))},function(r,o,f,p,v,S){o[0].set("effects",[r.shader("radius",{radius:10})])},function(r,o,f,p,v,S){o[1].set("w",r.w)},function(r,o,f,p,v,S){o[1].set("y",{transition:{value:r.h-r.innerH,duration:r.duration}})},function(r,o,f,p,v,S){o[1].set("h",{transition:{value:r.innerH,duration:r.duration}})},function(r,o,f,p,v,S){o[1].set("color",r.primaryColor)},function(r,o,f,p,v,S){o[1].set("effects",[r.shader("radius",{radius:10})])}],context:{}},props:["bgColor","primaryColor","height","index","size"],state(){return{h:200,innerH:0,duration:400}},hooks:{ready(){this.innerH=this.height}},computed:{w(){return this.size==="large"?110:72}},watch:{bgColor(){this.duration=1e-6,this.innerH=0,this.$setTimeout(()=>{this.duration=400,this.innerH=this.height},200)},size(){this.duration=1e-6,this.innerH=0,this.$setTimeout(()=>{this.duration=400,this.innerH=this.height},100)}}}),E_=at.Component("Theming",{components:{Bar:C_,Toggle:T_},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),_.w=1920,_.h=1080,_.color={transition:o.$colors.get("bg")},a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.y=1020,I.x=1160,I.size=28,I.color=o.$colors.get("color4"),I.content='Use "up", "down", "left" and "right" to change the appearance',I.__textnode=!0,a[1].populate(I),r=a[0];const M={};a[2]=this.element({parent:r||"root"},o),M.x={transition:(1920-o.$sizes.get("w"))/2},M.y={transition:(1080-o.$sizes.get("h"))/2},a[2].populate(M),r=a[2];const R={};a[3]=this.element({parent:r||"root"},o),R.x=-250,R.y=-100,R.src="assets/shadow.png",R.w=1e3,R.h=900,R.alpha=.5,a[3].populate(R),r=a[2];const U={};a[4]=this.element({parent:r||"root"},o),U.w={transition:o.$sizes.get("w")},U.h={transition:o.$sizes.get("h")},U.color=o.$colors.get("color1"),U.effects=[o.shader("radius",{radius:o.radius})],a[4].populate(U),r=a[4];const x={};a[5]=this.element({parent:r||"root"},o),x.w={transition:o.$sizes.get("w")},x.h=100,x.color=o.$colors.get("color2"),x.effects=[o.shader("radius",{radius:o.radius})],a[5].populate(x),r=a[4];const L={};a[6]=this.element({parent:r||"root"},o),L.w={transition:o.$sizes.get("w")},L.h=80,L.y=20,L.color=o.$colors.get("color2"),a[6].populate(L),r=a[4];const j={};a[7]=this.element({parent:r||"root"},o),j.content=o.text,j.color=o.$colors.get("color3"),j.size=28,j.x=20,j.y=14,j.__textnode=!0,a[7].populate(j);const H=f.components&&f.components.Toggle||p.Toggle;r=a[4];const Y={};a[8]=this.element({parent:r||"root"},o),Y.x={transition:o.$sizes.get("w")-120},Y.on=o.mode==="dark",Y.bgColor=o.$colors.get("color1"),Y.primaryColor="#22c55e";const Z=[];if(typeof H<"u")for(let ae in H.config.props)delete Y[H.config.props[ae]],Z.push(H.config.props[ae]);a[8].populate(Y),r=a[8];const X={};X.x={transition:o.$sizes.get("w")-120},X.on=o.mode==="dark",X.bgColor=o.$colors.get("color1"),X.primaryColor="#22c55e",m=X.is||"Toggle";let re;if(typeof m=="string"){if(re=f.components&&f.components[m]||p[m],!re)throw new Error('Component "Toggle" not found')}else typeof m=="function"&&m.name==="factory"&&(re=m);a[9]=re.call(null,{props:X},a[8],o),a[9][Symbol.for("slots")][0]?(r=a[9][Symbol.for("slots")][0],o=a[9]):r=a[9][Symbol.for("children")][0],r=a[2];const le={};a[10]=this.element({parent:r||"root"},o),le.w=200,le.h={transition:o.$sizes.get("block1.h")},le.x=25,le.y=140,le.color=o.$colors.get("color2"),le.effects=[o.shader("radius",{radius:o.radius/2})],a[10].populate(le),r=a[2];const se={};a[11]=this.element({parent:r||"root"},o),se.w={transition:o.$sizes.get("block2.w")},se.h=o.$sizes.get("block2.h"),se.x=270,se.y={transition:o.$sizes.get("block2.y")},se.color=o.$colors.get("color2"),se.effects=[o.shader("radius",{radius:o.radius/2})],a[11].populate(se),r=a[2];const W={};a[12]=this.element({parent:r||"root"},o),W.x={transition:o.$sizes.get("graph.x")},W.y={transition:o.$sizes.get("graph.y")},W.w=o.$sizes.get("graph.w"),W.h=o.$sizes.get("graph.h"),W.color="0x00000000",a[12].populate(W),r=a[12];const ce={};a[13]=this.element({parent:r||"root"},o),ce.x={transition:o.$sizes.get("graph.offset")},ce.y={transition:o.$sizes.get("graph.offset")},a[13].populate(ce);const E=f.components&&f.components.Bar||p.Bar;r=a[13];const F={};a[14]=this.element({parent:r||"root"},o),F.bgColor=o.$colors.get("color2"),F.primaryColor=o.$colors.get("color4"),F.size=o.$sizes.get("graph.size"),F.height=100,F.index=0;const ue=[];if(typeof E<"u")for(let ae in E.config.props)delete F[E.config.props[ae]],ue.push(E.config.props[ae]);a[14].populate(F),r=a[14];const ye={};ye.bgColor=o.$colors.get("color2"),ye.primaryColor=o.$colors.get("color4"),ye.size=o.$sizes.get("graph.size"),ye.height=100,ye.index=0,m=ye.is||"Bar";let ge;if(typeof m=="string"){if(ge=f.components&&f.components[m]||p[m],!ge)throw new Error('Component "Bar" not found')}else typeof m=="function"&&m.name==="factory"&&(ge=m);a[15]=ge.call(null,{props:ye},a[14],o),a[15][Symbol.for("slots")][0]?(r=a[15][Symbol.for("slots")][0],o=a[15]):r=a[15][Symbol.for("children")][0];const ie=f.components&&f.components.Bar||p.Bar;r=a[13];const ee={};a[16]=this.element({parent:r||"root"},o),ee.bgColor=o.$colors.get("color2"),ee.primaryColor=o.$colors.get("color4"),ee.size=o.$sizes.get("graph.size"),ee.height=140,ee.index=1;const de=[];if(typeof ie<"u")for(let ae in ie.config.props)delete ee[ie.config.props[ae]],de.push(ie.config.props[ae]);a[16].populate(ee),r=a[16];const Ee={};Ee.bgColor=o.$colors.get("color2"),Ee.primaryColor=o.$colors.get("color4"),Ee.size=o.$sizes.get("graph.size"),Ee.height=140,Ee.index=1,m=Ee.is||"Bar";let Ie;if(typeof m=="string"){if(Ie=f.components&&f.components[m]||p[m],!Ie)throw new Error('Component "Bar" not found')}else typeof m=="function"&&m.name==="factory"&&(Ie=m);a[17]=Ie.call(null,{props:Ee},a[16],o),a[17][Symbol.for("slots")][0]?(r=a[17][Symbol.for("slots")][0],o=a[17]):r=a[17][Symbol.for("children")][0];const ke=f.components&&f.components.Bar||p.Bar;r=a[13];const Le={};a[18]=this.element({parent:r||"root"},o),Le.bgColor=o.$colors.get("color2"),Le.primaryColor=o.$colors.get("color4"),Le.size=o.$sizes.get("graph.size"),Le.height=170,Le.index=2;const _e=[];if(typeof ke<"u")for(let ae in ke.config.props)delete Le[ke.config.props[ae]],_e.push(ke.config.props[ae]);a[18].populate(Le),r=a[18];const De={};De.bgColor=o.$colors.get("color2"),De.primaryColor=o.$colors.get("color4"),De.size=o.$sizes.get("graph.size"),De.height=170,De.index=2,m=De.is||"Bar";let $;if(typeof m=="string"){if($=f.components&&f.components[m]||p[m],!$)throw new Error('Component "Bar" not found')}else typeof m=="function"&&m.name==="factory"&&($=m);a[19]=$.call(null,{props:De},a[18],o),a[19][Symbol.for("slots")][0]?(r=a[19][Symbol.for("slots")][0],o=a[19]):r=a[19][Symbol.for("children")][0];const Pe=f.components&&f.components.Bar||p.Bar;r=a[13];const He={};a[20]=this.element({parent:r||"root"},o),He.bgColor=o.$colors.get("color2"),He.primaryColor=o.$colors.get("color4"),He.size=o.$sizes.get("graph.size"),He.height=150,He.index=3;const Se=[];if(typeof Pe<"u")for(let ae in Pe.config.props)delete He[Pe.config.props[ae]],Se.push(Pe.config.props[ae]);a[20].populate(He),r=a[20];const V={};V.bgColor=o.$colors.get("color2"),V.primaryColor=o.$colors.get("color4"),V.size=o.$sizes.get("graph.size"),V.height=150,V.index=3,m=V.is||"Bar";let Ae;if(typeof m=="string"){if(Ae=f.components&&f.components[m]||p[m],!Ae)throw new Error('Component "Bar" not found')}else typeof m=="function"&&m.name==="factory"&&(Ae=m);a[21]=Ae.call(null,{props:V},a[20],o),a[21][Symbol.for("slots")][0]?(r=a[21][Symbol.for("slots")][0],o=a[21]):r=a[21][Symbol.for("children")][0];const Ce=f.components&&f.components.Bar||p.Bar;r=a[13];const je={};a[22]=this.element({parent:r||"root"},o),je.bgColor=o.$colors.get("color2"),je.primaryColor=o.$colors.get("color4"),je.size=o.$sizes.get("graph.size"),je.height=90,je.index=4;const he=[];if(typeof Ce<"u")for(let ae in Ce.config.props)delete je[Ce.config.props[ae]],he.push(Ce.config.props[ae]);a[22].populate(je),r=a[22];const Re={};Re.bgColor=o.$colors.get("color2"),Re.primaryColor=o.$colors.get("color4"),Re.size=o.$sizes.get("graph.size"),Re.height=90,Re.index=4,m=Re.is||"Bar";let Ve;if(typeof m=="string"){if(Ve=f.components&&f.components[m]||p[m],!Ve)throw new Error('Component "Bar" not found')}else typeof m=="function"&&m.name==="factory"&&(Ve=m);return a[23]=Ve.call(null,{props:Re},a[22],o),a[23][Symbol.for("slots")][0]?(r=a[23][Symbol.for("slots")][0],o=a[23]):r=a[23][Symbol.for("children")][0],a},effects:[function(r,o,f,p,v,S){o[0].set("color",{transition:r.$colors.get("bg")})},function(r,o,f,p,v,S){o[1].set("color",r.$colors.get("color4"))},function(r,o,f,p,v,S){o[2].set("x",{transition:(1920-r.$sizes.get("w"))/2})},function(r,o,f,p,v,S){o[2].set("y",{transition:(1080-r.$sizes.get("h"))/2})},function(r,o,f,p,v,S){o[4].set("w",{transition:r.$sizes.get("w")})},function(r,o,f,p,v,S){o[4].set("h",{transition:r.$sizes.get("h")})},function(r,o,f,p,v,S){o[4].set("color",r.$colors.get("color1"))},function(r,o,f,p,v,S){o[4].set("effects",[r.shader("radius",{radius:r.radius})])},function(r,o,f,p,v,S){o[5].set("w",{transition:r.$sizes.get("w")})},function(r,o,f,p,v,S){o[5].set("color",r.$colors.get("color2"))},function(r,o,f,p,v,S){o[5].set("effects",[r.shader("radius",{radius:r.radius})])},function(r,o,f,p,v,S){o[6].set("w",{transition:r.$sizes.get("w")})},function(r,o,f,p,v,S){o[6].set("color",r.$colors.get("color2"))},function(r,o,f,p,v,S){o[7].set("content",r.text)},function(r,o,f,p,v,S){o[7].set("color",r.$colors.get("color3"))},function(r,o,f,p,v,S){(typeof skip8>"u"||skip8.indexOf("x")===-1)&&o[8].set("x",{transition:r.$sizes.get("w")-120})},function(r,o,f,p,v,S){(typeof skip8>"u"||skip8.indexOf("on")===-1)&&o[8].set("on",r.mode==="dark")},function(r,o,f,p,v,S){(typeof skip8>"u"||skip8.indexOf("bgColor")===-1)&&o[8].set("bgColor",r.$colors.get("color1"))},function(r,o,f,p,v,S){o[9][Symbol.for("props")].x={transition:r.$sizes.get("w")-120}},function(r,o,f,p,v,S){o[9][Symbol.for("props")].on=r.mode==="dark"},function(r,o,f,p,v,S){o[9][Symbol.for("props")].bgColor=r.$colors.get("color1")},function(r,o,f,p,v,S){o[10].set("h",{transition:r.$sizes.get("block1.h")})},function(r,o,f,p,v,S){o[10].set("color",r.$colors.get("color2"))},function(r,o,f,p,v,S){o[10].set("effects",[r.shader("radius",{radius:r.radius/2})])},function(r,o,f,p,v,S){o[11].set("w",{transition:r.$sizes.get("block2.w")})},function(r,o,f,p,v,S){o[11].set("h",r.$sizes.get("block2.h"))},function(r,o,f,p,v,S){o[11].set("y",{transition:r.$sizes.get("block2.y")})},function(r,o,f,p,v,S){o[11].set("color",r.$colors.get("color2"))},function(r,o,f,p,v,S){o[11].set("effects",[r.shader("radius",{radius:r.radius/2})])},function(r,o,f,p,v,S){o[12].set("x",{transition:r.$sizes.get("graph.x")})},function(r,o,f,p,v,S){o[12].set("y",{transition:r.$sizes.get("graph.y")})},function(r,o,f,p,v,S){o[12].set("w",r.$sizes.get("graph.w"))},function(r,o,f,p,v,S){o[12].set("h",r.$sizes.get("graph.h"))},function(r,o,f,p,v,S){o[13].set("x",{transition:r.$sizes.get("graph.offset")})},function(r,o,f,p,v,S){o[13].set("y",{transition:r.$sizes.get("graph.offset")})},function(r,o,f,p,v,S){(typeof skip14>"u"||skip14.indexOf("bgColor")===-1)&&o[14].set("bgColor",r.$colors.get("color2"))},function(r,o,f,p,v,S){(typeof skip14>"u"||skip14.indexOf("primaryColor")===-1)&&o[14].set("primaryColor",r.$colors.get("color4"))},function(r,o,f,p,v,S){(typeof skip14>"u"||skip14.indexOf("size")===-1)&&o[14].set("size",r.$sizes.get("graph.size"))},function(r,o,f,p,v,S){o[15][Symbol.for("props")].bgColor=r.$colors.get("color2")},function(r,o,f,p,v,S){o[15][Symbol.for("props")].primaryColor=r.$colors.get("color4")},function(r,o,f,p,v,S){o[15][Symbol.for("props")].size=r.$sizes.get("graph.size")},function(r,o,f,p,v,S){(typeof skip16>"u"||skip16.indexOf("bgColor")===-1)&&o[16].set("bgColor",r.$colors.get("color2"))},function(r,o,f,p,v,S){(typeof skip16>"u"||skip16.indexOf("primaryColor")===-1)&&o[16].set("primaryColor",r.$colors.get("color4"))},function(r,o,f,p,v,S){(typeof skip16>"u"||skip16.indexOf("size")===-1)&&o[16].set("size",r.$sizes.get("graph.size"))},function(r,o,f,p,v,S){o[17][Symbol.for("props")].bgColor=r.$colors.get("color2")},function(r,o,f,p,v,S){o[17][Symbol.for("props")].primaryColor=r.$colors.get("color4")},function(r,o,f,p,v,S){o[17][Symbol.for("props")].size=r.$sizes.get("graph.size")},function(r,o,f,p,v,S){(typeof skip18>"u"||skip18.indexOf("bgColor")===-1)&&o[18].set("bgColor",r.$colors.get("color2"))},function(r,o,f,p,v,S){(typeof skip18>"u"||skip18.indexOf("primaryColor")===-1)&&o[18].set("primaryColor",r.$colors.get("color4"))},function(r,o,f,p,v,S){(typeof skip18>"u"||skip18.indexOf("size")===-1)&&o[18].set("size",r.$sizes.get("graph.size"))},function(r,o,f,p,v,S){o[19][Symbol.for("props")].bgColor=r.$colors.get("color2")},function(r,o,f,p,v,S){o[19][Symbol.for("props")].primaryColor=r.$colors.get("color4")},function(r,o,f,p,v,S){o[19][Symbol.for("props")].size=r.$sizes.get("graph.size")},function(r,o,f,p,v,S){(typeof skip20>"u"||skip20.indexOf("bgColor")===-1)&&o[20].set("bgColor",r.$colors.get("color2"))},function(r,o,f,p,v,S){(typeof skip20>"u"||skip20.indexOf("primaryColor")===-1)&&o[20].set("primaryColor",r.$colors.get("color4"))},function(r,o,f,p,v,S){(typeof skip20>"u"||skip20.indexOf("size")===-1)&&o[20].set("size",r.$sizes.get("graph.size"))},function(r,o,f,p,v,S){o[21][Symbol.for("props")].bgColor=r.$colors.get("color2")},function(r,o,f,p,v,S){o[21][Symbol.for("props")].primaryColor=r.$colors.get("color4")},function(r,o,f,p,v,S){o[21][Symbol.for("props")].size=r.$sizes.get("graph.size")},function(r,o,f,p,v,S){(typeof skip22>"u"||skip22.indexOf("bgColor")===-1)&&o[22].set("bgColor",r.$colors.get("color2"))},function(r,o,f,p,v,S){(typeof skip22>"u"||skip22.indexOf("primaryColor")===-1)&&o[22].set("primaryColor",r.$colors.get("color4"))},function(r,o,f,p,v,S){(typeof skip22>"u"||skip22.indexOf("size")===-1)&&o[22].set("size",r.$sizes.get("graph.size"))},function(r,o,f,p,v,S){o[23][Symbol.for("props")].bgColor=r.$colors.get("color2")},function(r,o,f,p,v,S){o[23][Symbol.for("props")].primaryColor=r.$colors.get("color4")},function(r,o,f,p,v,S){o[23][Symbol.for("props")].size=r.$sizes.get("graph.size")}],context:{}},state(){return{mode:"dark",sizes:"small",radius:20}},watch:{mode(h){this.$colors.set(h)},sizes(h){this.$sizes.set(h)}},computed:{text(){return this.mode==="dark"?"Dark mode":"Light mode"}},input:{right(){this.toggleX=0,this.$setTimeout(()=>{this.mode="light"},150)},left(){this.toggleX=48,this.$setTimeout(()=>{this.mode="dark"},150)},up(){this.sizes="large"},down(){this.sizes="small"}}}),A_="ABC123",k_="https://8b4fa39d.lightningjs.workers.dev";let fT,cT;const b_="w185",I_={headers:{"Content-Type":"application/json",Authorization:"Bearer "+A_}};function xS(h,r=b_){return cT+r+h}function M_(...h){return fT?ag(...h):hT().then(()=>ag(...h))}function ag(h,r={}){return fetch(k_+h,{...I_,...r}).then(o=>o.json())}function hT(){return ag("/configuration").then(h=>(fT=h,cT=h.images.secure_base_url,h))}const yg={get:M_,loadConfig:hT},wS=h=>yg.get(`/${h}/popular`).then(dT),dT=h=>h.results.filter(o=>!o.adult).map(o=>({poster:xS(o.poster_path||o.profile_path),background:xS(o.backdrop_path,"w1280"),identifier:o.id,title:o.title||o.name,overview:o.overview})),Ul=h=>{const r=Array.isArray(h)?h:[h];return R_("movie").then(({genres:o})=>{let f=[];return o.forEach(p=>{r.includes(p.name)&&f.push(p.id)}),yg.get(`/discover/movie?with_genres=${f.join()}`).then(dT)})},R_=h=>yg.get(`/genre/${h}/list`),__=at.Component("Poster",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.w=1280,m.h=720,m.x=o.x,m.src=o.item.background,m.color="{top: '0xffffffff', bottom: '0x000000ff'}",m.scale={transition:{value:o.scale,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},m._effects=[o.shader("radius",{radius:8})],a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.alpha={transition:{value:o.alpha,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},a[1].populate(_),r=a[1];const I={};a[2]=this.element({parent:r||"root"},o),I.w=185,I.h=278,I.x=54,I.y=220,I.src=o.item.poster,a[2].populate(I),r=a[1];const M={};a[3]=this.element({parent:r||"root"},o),M.content=o.item.title,M.font="raleway",M.y=520,M.x=54,M.size=64,M.wordwrap=1e3,M.maxlines=1,M.__textnode=!0,a[3].populate(M),r=a[1];const R={};return a[4]=this.element({parent:r||"root"},o),R.content=o.item.overview,R.size=21,R.y=620,R.x=60,R.color="0xccccccff",R.wordwrap=1e3,R.maxlines=2,R.lineheight=36,R.__textnode=!0,a[4].populate(R),a},effects:[function(r,o,f,p,v,S){o[0].set("src",r.item.background)},function(r,o,f,p,v,S){o[0].set("scale",{transition:{value:r.scale,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,o,f,p,v,S){o[0].set("_effects",[r.shader("radius",{radius:8})])},function(r,o,f,p,v,S){o[1].set("alpha",{transition:{value:r.alpha,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,o,f,p,v,S){o[2].set("src",r.item.poster)},function(r,o,f,p,v,S){o[3].set("content",r.item.title)},function(r,o,f,p,v,S){o[4].set("content",r.item.overview)}],context:{}},props:["src","index","item","width"],state(){return{scale:1,zIndex:1,alpha:0}},computed:{x(){return this.index*this.width}},hooks:{focus(){this.scale=1.1,this.alpha=1},unfocus(){this.scale=1,this.alpha=0}}}),L_=at.Component("Poster",{code:{render:function(r,o,f,p,v,S){const a=[],m={};return a[0]=this.element({parent:r||"root"},o),m.w=185,m.h=278,m.x=o.x,m.src=o.item.poster,m.scale={transition:{value:o.scale,duration:200,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},m._effects=[o.shader("radius",{radius:8})],a[0].populate(m),a},effects:[function(r,o,f,p,v,S){o[0].set("src",r.item.poster)},function(r,o,f,p,v,S){o[0].set("scale",{transition:{value:r.scale,duration:200,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,o,f,p,v,S){o[0].set("_effects",[r.shader("radius",{radius:8})])}],context:{}},props:["src","index","item","width"],state(){return{scale:1,color:"#333"}},computed:{x(){return this.index*this.width}},hooks:{focus(){this.color="#fff",this.scale=1.1},unfocus(){this.color="#333",this.scale=1}}}),P_=at.Component("PosterTitle",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.w=185,m.h=278,m.x=o.x,m.src=o.item.poster,m.scale={transition:{value:o.scale,duration:200,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},m._effects=[o.shader("radius",{radius:8})],a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.x=10,_.y={transition:{value:o.y,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},_.alpha={transition:{value:o.alpha,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},a[1].populate(_),r=a[1];const I={};return a[2]=this.element({parent:r||"root"},o),I.content=o.item.title,I.font="raleway",I.size=22,I.wordwrap=185,I.maxlines=2,I.lineheight=28,I.__textnode=!0,a[2].populate(I),a},effects:[function(r,o,f,p,v,S){o[0].set("src",r.item.poster)},function(r,o,f,p,v,S){o[0].set("scale",{transition:{value:r.scale,duration:200,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,o,f,p,v,S){o[0].set("_effects",[r.shader("radius",{radius:8})])},function(r,o,f,p,v,S){o[1].set("y",{transition:{value:r.y,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,o,f,p,v,S){o[1].set("alpha",{transition:{value:r.alpha,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})},function(r,o,f,p,v,S){o[2].set("content",r.item.title)}],context:{}},props:["src","index","item","width"],state(){return{scale:1,alpha:0,y:278}},computed:{x(){return this.index*this.width}},hooks:{focus(){this.scale=1.1,this.alpha=1,this.y=288},unfocus(){this.scale=1,this.alpha=0,this.y=278}}}),D_=at.Component("TmdbRow",{components:{Hero:__,Poster:L_,PosterTitle:P_},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.x={transition:{value:o.x,duration:300,easing:"ease-in-out"}},I.y=80,a[1].populate(I),r=a[1];const M=[],R=(U=[],x,L)=>{const j=S(U),H=new Set;let Y=j.length;for(;Y--;){const re=j[Y];H.add(""+re.identifier)}let Z=L.length;for(;Z--;)if(H.has(L[Z])===!1){const re=L[Z];x[2][re]&&x[2][re].destroy(),delete x[2][re],x[3][re]&&x[3][re].destroy(),delete x[3][re]}L.length=0;const X=j.length;for(let re=0;re<X;re++){const le=Object.create(o);r=x[1],le.index=re,le.item=j[re],le.key=""+le.item.identifier,le.__ref="poster"+re,L.push(le.key);const se=f.components&&f.components.Component||p.Component;x[2]===void 0&&(x[2]={});const W={};x[2][le.key]===void 0&&(x[2][le.key]=this.element({parent:r||"root"},o)),W.is=le.type,W.index=le.index,W.item=le.item,W.ref=le.__ref,W.width=le.width;const ce=[];if(typeof se<"u")for(let F in se.config.props)delete W[se.config.props[F]],ce.push(se.config.props[F]);x[2][le.key].nodeId===void 0&&x[2][le.key].populate(W),x[3]===void 0&&(x[3]={}),r=x[2][le.key];const E={};if(x[3][le.key]===void 0){E.is=le.type,E.index=le.index,E.item=le.item,E.ref=le.__ref,E.width=le.width,m=E.is||"Component";let F;if(typeof m=="string"){if(F=f.components&&f.components[m]||p[m],!F)throw new Error('Component "Component" not found')}else typeof m=="function"&&m.name==="factory"&&(F=m);x[3][le.key]=F.call(null,{props:E},x[2][le.key],o),x[3][le.key][Symbol.for("slots")][0]?(r=x[3][le.key][Symbol.for("slots")][0],o=x[3][le.key]):r=x[3][le.key][Symbol.for("children")][0]}}};return v(()=>{R(o.items,a,M)},"items"),a},effects:[function(r,o,f,p,v,S){o[1].set("x",{transition:{value:r.x,duration:300,easing:"ease-in-out"}})}],context:{}},props:["title","type","items","width"],state(){return{focused:0,offset:0}},hooks:{focus(){this.$trigger("focused")}},computed:{x(){return 150-Math.min(this.focused,this.items.length-1720/this.width)*this.width}},watch:{focused(h){const r=this.$select("poster"+h);r&&r.$focus&&(r.$focus(),this.$emit("posterSelect",this.items[h]))}},input:{left(){this.focused=Math.max(this.focused-1,0)},right(){this.focused=Math.min(this.focused+1,this.items.length-1)}}}),N_=at.Component("Background",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.src=o.bg1,_.w=1920,_.h=1080,_.color="{top: '0xffffffff', bottom: '0x000000ff'}",_.alpha={transition:{value:o.alpha1,duration:400,easing:"ease-in"}},a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.src=o.bg2,I.w=1920,I.h=1080,I.color="{top: '0xffffffff', bottom: '0x000000ff'}",I.alpha={transition:{value:o.alpha2,duration:400,easing:"ease-in"}},a[2].populate(I),r=a[0];const M={};return a[3]=this.element({parent:r||"root"},o),M.w=1920,M.h=1080,M.src="assets/gradient.png",M.color="0x8866ddff",M.alpha=.8,a[3].populate(M),a},effects:[function(r,o,f,p,v,S){o[1].set("src",r.bg1)},function(r,o,f,p,v,S){o[1].set("alpha",{transition:{value:r.alpha1,duration:400,easing:"ease-in"}})},function(r,o,f,p,v,S){o[2].set("src",r.bg2)},function(r,o,f,p,v,S){o[2].set("alpha",{transition:{value:r.alpha2,duration:400,easing:"ease-in"}})}],context:{}},props:["src"],state(){return{counter:0,alpha1:0,alpha2:0,bg1:!1,bg2:!1}},watch:{src(h){this.counter=(this.counter+1)%2,this.counter===0?(this.bg1=h,this.alpha1=.8,this.alpha2=0):(this.bg2=h,this.alpha1=0,this.alpha2=.8)}}}),O_=at.Component("TMdb",{components:{Background:N_,TmdbRow:D_},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),_.w=1920,_.h=1080,_.color="0x000000ff",a[0].populate(_);const I=f.components&&f.components.Background||p.Background;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o),M.src=o.src;const R=[];if(typeof I<"u")for(let se in I.config.props)delete M[I.config.props[se]],R.push(I.config.props[se]);a[1].populate(M),r=a[1];const U={};U.src=o.src,m=U.is||"Background";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "Background" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0],r=a[0];const L={};a[3]=this.element({parent:r||"root"},o),a[3].populate(L),r=a[3];const j={};a[4]=this.element({parent:r||"root"},o),j.y={transition:{value:o.contentY,duration:o.duration}},j.alpha={transition:{value:o.alpha,duration:o.duration}},a[4].populate(j),r=a[4];const H={};a[5]=this.element({parent:r||"root"},o),H.src="assets/logo.png",H.x=140,H.y=90,H.w=243,H.h=52,a[5].populate(H),r=a[4];const Y={};a[6]=this.element({parent:r||"root"},o),Y.content=o.title,Y.font="raleway",Y.size=80,Y.x=140,Y.y=300,Y.wordwrap=1e3,Y["@loaded"]=o.positionText&&o.positionText.bind(o),Y.maxlines=1,Y.__textnode=!0,a[6].populate(Y),r=a[4];const Z={};a[7]=this.element({parent:r||"root"},o),Z.content=o.overview,Z.wordwrap=880,Z.x=140,Z.y=430,Z.lineheight=40,Z.maxlines=3,Z.__textnode=!0,a[7].populate(Z),r=a[3];const X={};a[8]=this.element({parent:r||"root"},o),X.y={transition:{value:o.y,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}},a[8].populate(X),r=a[8];const re=[],le=(se=[],W,ce)=>{const E=S(se),F=new Set;let ue=E.length;for(;ue--;){const ie=E[ue];F.add(""+ie.title)}let ye=ce.length;for(;ye--;)if(F.has(ce[ye])===!1){const ie=ce[ye];W[9][ie]&&W[9][ie].destroy(),delete W[9][ie],W[10][ie]&&W[10][ie].destroy(),delete W[10][ie]}ce.length=0;const ge=E.length;for(let ie=0;ie<ge;ie++){const ee=Object.create(o);r=W[8],ee.index=ie,ee.row=E[ie],ee.key=""+ee.row.title,ee.__ref="row"+ie,ce.push(ee.key);const de=f.components&&f.components.TmdbRow||p.TmdbRow;W[9]===void 0&&(W[9]={});const Ee={};W[9][ee.key]===void 0&&(W[9][ee.key]=this.element({parent:r||"root"},o)),Ee.title=ee.row.title,Ee.items=ee.row.items,Ee.type=ee.row.type,Ee.width=ee.row.width,Ee.y=ee.row.y,Ee.ref=ee.__ref;const Ie=[];if(typeof de<"u")for(let Le in de.config.props)delete Ee[de.config.props[Le]],Ie.push(de.config.props[Le]);W[9][ee.key].nodeId===void 0&&W[9][ee.key].populate(Ee),W[10]===void 0&&(W[10]={}),r=W[9][ee.key];const ke={};if(W[10][ee.key]===void 0){ke.title=ee.row.title,ke.items=ee.row.items,ke.type=ee.row.type,ke.width=ee.row.width,ke.y=ee.row.y,ke.ref=ee.__ref,m=ke.is||"TmdbRow";let Le;if(typeof m=="string"){if(Le=f.components&&f.components[m]||p[m],!Le)throw new Error('Component "TmdbRow" not found')}else typeof m=="function"&&m.name==="factory"&&(Le=m);W[10][ee.key]=Le.call(null,{props:ke},W[9][ee.key],o),W[10][ee.key][Symbol.for("slots")][0]?(r=W[10][ee.key][Symbol.for("slots")][0],o=W[10][ee.key]):r=W[10][ee.key][Symbol.for("children")][0]}v(()=>{(typeof Ie>"u"||Ie.indexOf("items")===-1)&&W[9][ee.key].set("items",ee.row.items)},null),v(()=>{(typeof Ie>"u"||Ie.indexOf("type")===-1)&&W[9][ee.key].set("type",ee.row.type)},null),v(()=>{(typeof Ie>"u"||Ie.indexOf("width")===-1)&&W[9][ee.key].set("width",ee.row.width)},null),W[10][ee.key][Symbol.for("props")].items=ee.row.items,W[10][ee.key][Symbol.for("props")].type=ee.row.type,W[10][ee.key][Symbol.for("props")].width=ee.row.width}};return v(()=>{le(o.rows,a,re)},"rows"),a},effects:[function(r,o,f,p,v,S){(typeof skip1>"u"||skip1.indexOf("src")===-1)&&o[1].set("src",r.src)},function(r,o,f,p,v,S){o[2][Symbol.for("props")].src=r.src},function(r,o,f,p,v,S){o[4].set("y",{transition:{value:r.contentY,duration:r.duration}})},function(r,o,f,p,v,S){o[4].set("alpha",{transition:{value:r.alpha,duration:r.duration}})},function(r,o,f,p,v,S){o[6].set("content",r.title)},function(r,o,f,p,v,S){o[7].set("content",r.overview)},function(r,o,f,p,v,S){o[8].set("y",{transition:{value:r.y,duration:300,easing:"cubic-bezier(0.20, 1.00, 0.80, 1.00)"}})}],context:{}},state(){return{rows:[],items:[],src:"",focused:null,alpha:1,y:550,contentY:0,scale:1,title:"",overview:"",type:"Poster",duration:300}},watch:{focused(h){const r=this.$select("row"+h);r&&r.$focus&&r.$focus()}},hooks:{async ready(){this.$listen("posterSelect",h=>{this.focused===0&&(this.src=h.background,this.title=h.title,this.overview=h.overview)}),this.rows.push({title:"Popular Movies",items:await wS("movie"),type:"Poster",width:215,y:0}),this.rows.push({title:"Best Western movies",items:await Ul(["Western"]),type:"Hero",width:1370,y:358}),this.rows.push({title:"Best Comedy movies",items:await Ul(["Comedy"]),type:"PosterTitle",width:215,y:1158}),this.rows.push({title:"Popular TV shows",items:await wS("tv"),type:"PosterTitle",width:215,y:1536}),this.rows.push({title:"Best Adventure and Action movies",items:await Ul(["adventure","action"]),type:"Hero",width:1370,y:1914}),this.rows.push({title:"Best Documentaries",items:await Ul("Documentary"),type:"PosterTitle",width:215,y:2714}),this.rows.push({title:"Best Western movies 2",items:await Ul("Western"),type:"PosterTitle",width:215,y:3092}),this.focused=0},focus(){this.$trigger("focused")}},input:{up(){this.contentY=0,this.duration=300,this.focused=Math.max(this.focused-1,0),this.y=(this.focused===0?550:90)-this.rows[this.focused].y,this.alpha=this.focused===0?1:0},down(){this.contentY=-60,this.duration=200,this.focused=Math.min(this.focused+1,this.rows.length-1),this.y=(this.focused===0?550:90)-this.rows[this.focused].y,this.alpha=this.focused===0?1:0}}}),U_=at.Component("MenuSprite",{code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.src="assets/menusprite.png",I.x=748,I.y=120,I.w=425,I.h=340,a[1].populate(I),r=a[0];const M={};a[2]=this.element({parent:r||"root"},o),M.y=680,M.x=560,a[2].populate(M);const R=f.components&&f.components.Sprite||p.Sprite;r=a[2];const U={};a[3]=this.element({parent:r||"root"},o),U.image="assets/menusprite.png",U.x=0,U.w=140,U.h=140,U.map=o.map,U.frame=o.icon1;const x=[];if(typeof R<"u")for(let ee in R.config.props)delete U[R.config.props[ee]],x.push(R.config.props[ee]);a[3].populate(U),r=a[3];const L={};L.image="assets/menusprite.png",L.x=0,L.w=140,L.h=140,L.map=o.map,L.frame=o.icon1,m=L.is||"Sprite";let j;if(typeof m=="string"){if(j=f.components&&f.components[m]||p[m],!j)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(j=m);a[4]=j.call(null,{props:L},a[3],o),a[4][Symbol.for("slots")][0]?(r=a[4][Symbol.for("slots")][0],o=a[4]):r=a[4][Symbol.for("children")][0];const H=f.components&&f.components.Sprite||p.Sprite;r=a[2];const Y={};a[5]=this.element({parent:r||"root"},o),Y.image="assets/menusprite.png",Y.x=220,Y.w=140,Y.h=140,Y.map=o.map,Y.frame="icon2";const Z=[];if(typeof H<"u")for(let ee in H.config.props)delete Y[H.config.props[ee]],Z.push(H.config.props[ee]);a[5].populate(Y),r=a[5];const X={};X.image="assets/menusprite.png",X.x=220,X.w=140,X.h=140,X.map=o.map,X.frame="icon2",m=X.is||"Sprite";let re;if(typeof m=="string"){if(re=f.components&&f.components[m]||p[m],!re)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(re=m);a[6]=re.call(null,{props:X},a[5],o),a[6][Symbol.for("slots")][0]?(r=a[6][Symbol.for("slots")][0],o=a[6]):r=a[6][Symbol.for("children")][0];const le=f.components&&f.components.Sprite||p.Sprite;r=a[2];const se={};a[7]=this.element({parent:r||"root"},o),se.image="assets/menusprite.png",se.x=440,se.w=140,se.h=140,se.map=o.map,se.frame="icon3";const W=[];if(typeof le<"u")for(let ee in le.config.props)delete se[le.config.props[ee]],W.push(le.config.props[ee]);a[7].populate(se),r=a[7];const ce={};ce.image="assets/menusprite.png",ce.x=440,ce.w=140,ce.h=140,ce.map=o.map,ce.frame="icon3",m=ce.is||"Sprite";let E;if(typeof m=="string"){if(E=f.components&&f.components[m]||p[m],!E)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(E=m);a[8]=E.call(null,{props:ce},a[7],o),a[8][Symbol.for("slots")][0]?(r=a[8][Symbol.for("slots")][0],o=a[8]):r=a[8][Symbol.for("children")][0];const F=f.components&&f.components.Sprite||p.Sprite;r=a[2];const ue={};a[9]=this.element({parent:r||"root"},o),ue.image="assets/menusprite.png",ue.x=660,ue.w=140,ue.h=140,ue.map=o.map,ue.frame="icon4_unfocus";const ye=[];if(typeof F<"u")for(let ee in F.config.props)delete ue[F.config.props[ee]],ye.push(F.config.props[ee]);a[9].populate(ue),r=a[9];const ge={};ge.image="assets/menusprite.png",ge.x=660,ge.w=140,ge.h=140,ge.map=o.map,ge.frame="icon4_unfocus",m=ge.is||"Sprite";let ie;if(typeof m=="string"){if(ie=f.components&&f.components[m]||p[m],!ie)throw new Error('Component "Sprite" not found')}else typeof m=="function"&&m.name==="factory"&&(ie=m);return a[10]=ie.call(null,{props:ge},a[9],o),a[10][Symbol.for("slots")][0]?(r=a[10][Symbol.for("slots")][0],o=a[10]):r=a[10][Symbol.for("children")][0],a},effects:[function(r,o,f,p,v,S){(typeof skip3>"u"||skip3.indexOf("frame")===-1)&&o[3].set("frame",r.icon1)},function(r,o,f,p,v,S){o[4][Symbol.for("props")].frame=r.icon1}],context:{}},state(){return{icon1:"icon1_unfocus",map:{defaults:{w:160,h:160},frames:{icon1_focus:{x:0,y:0},icon1_unfocus:{x:170,y:340},icon2:{x:170,y:0},icon3:{x:350,y:0},icon4_unfocus:{x:680,y:170}}}}},hooks:{ready(){this.$setInterval(()=>{this.icon1=this.icon1==="icon1_unfocus"?"icon1_focus":"icon1_unfocus"},2e3)}}}),Oc=["menu"],B_=at.Component("Sprites",{components:{MenuSprite:U_},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_);const I=f.components&&f.components.MenuSprite||p.MenuSprite;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o),M.show=o.currentSprite==="menu";const R=[];if(typeof I<"u")for(let L in I.config.props)delete M[I.config.props[L]],R.push(I.config.props[L]);a[1].populate(M),r=a[1];const U={};U.show=o.currentSprite==="menu",m=U.is||"MenuSprite";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "MenuSprite" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);return a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0],a},effects:[function(r,o,f,p,v,S){(typeof skip1>"u"||skip1.indexOf("show")===-1)&&o[1].set("show",r.currentSprite==="menu")},function(r,o,f,p,v,S){o[2][Symbol.for("props")].show=r.currentSprite==="menu"}],context:{}},state(){return{currentSprite:"menu"}},input:{down(){const h=Oc.indexOf(this.currentSprite);h<Oc.length-1?this.currentSprite=Oc[h+1]:this.currentSprite=Oc[0]}}}),oh=at.Component("Button",{code:{render:function(r,o,f,p,v,S){const a=[],m={};return a[0]=this.element({parent:r||"root"},o),m.w=300,m.h=80,m.color=o.color||"0xff0000ff",m.effects=[o.shader("radius",{radius:20})],m.alpha={transition:o.alpha},m.scale={transition:o.scale},m.z=o.zIndex,m.rotation=o.rotate,a[0].populate(m),a},effects:[function(r,o,f,p,v,S){o[0].set("effects",[r.shader("radius",{radius:20})])},function(r,o,f,p,v,S){o[0].set("alpha",{transition:r.alpha})},function(r,o,f,p,v,S){o[0].set("scale",{transition:r.scale})},function(r,o,f,p,v,S){o[0].set("z",r.zIndex)},function(r,o,f,p,v,S){o[0].set("rotation",r.rotate)}],context:{}},props:["color"],state(){return{alpha:.4,scale:1,zIndex:1,rotate:0}},hooks:{focus(){this.$log.info(`Button with color ${this.color} received focus`),this.alpha=1,this.scale=this.scale===1?1.2:1,this.zIndex=100},unfocus(){this.$log.info(`Button with color ${this.color} lost focus`),this.alpha=.4,this.scale=1,this.zIndex=1,this.rotate=0}},input:{enter(){this.rotate=this.rotate===0?-4:0,this.scale=this.scale===1.2?1.3:1.2}}}),j_=at.Component("Menu",{components:{Button:oh},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),_.x={transition:o.x},_.w=400,_.h=1080,_.color="{right: '0x64748baa', left: '0x475569aa'}",a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.x=50,I.y=40,a[1].populate(I);const M=f.components&&f.components.Button||p.Button;r=a[1];const R={};a[2]=this.element({parent:r||"root"},o),R.color="0xe4e4e7ff",R.ref="menu1";const U=[];if(typeof M<"u")for(let ie in M.config.props)delete R[M.config.props[ie]],U.push(M.config.props[ie]);a[2].populate(R),r=a[2];const x={};x.color="0xe4e4e7ff",x.ref="menu1",m=x.is||"Button";let L;if(typeof m=="string"){if(L=f.components&&f.components[m]||p[m],!L)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(L=m);a[3]=L.call(null,{props:x},a[2],o),a[3][Symbol.for("slots")][0]?(r=a[3][Symbol.for("slots")][0],o=a[3]):r=a[3][Symbol.for("children")][0];const j=f.components&&f.components.Button||p.Button;r=a[1];const H={};a[4]=this.element({parent:r||"root"},o),H.color="0xe4e4e7ff",H.y=100,H.ref="menu2";const Y=[];if(typeof j<"u")for(let ie in j.config.props)delete H[j.config.props[ie]],Y.push(j.config.props[ie]);a[4].populate(H),r=a[4];const Z={};Z.color="0xe4e4e7ff",Z.y=100,Z.ref="menu2",m=Z.is||"Button";let X;if(typeof m=="string"){if(X=f.components&&f.components[m]||p[m],!X)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(X=m);a[5]=X.call(null,{props:Z},a[4],o),a[5][Symbol.for("slots")][0]?(r=a[5][Symbol.for("slots")][0],o=a[5]):r=a[5][Symbol.for("children")][0];const re=f.components&&f.components.Button||p.Button;r=a[1];const le={};a[6]=this.element({parent:r||"root"},o),le.color="0xe4e4e7ff",le.y=200,le.ref="menu3";const se=[];if(typeof re<"u")for(let ie in re.config.props)delete le[re.config.props[ie]],se.push(re.config.props[ie]);a[6].populate(le),r=a[6];const W={};W.color="0xe4e4e7ff",W.y=200,W.ref="menu3",m=W.is||"Button";let ce;if(typeof m=="string"){if(ce=f.components&&f.components[m]||p[m],!ce)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(ce=m);a[7]=ce.call(null,{props:W},a[6],o),a[7][Symbol.for("slots")][0]?(r=a[7][Symbol.for("slots")][0],o=a[7]):r=a[7][Symbol.for("children")][0];const E=f.components&&f.components.Button||p.Button;r=a[1];const F={};a[8]=this.element({parent:r||"root"},o),F.color="0xe4e4e7ff",F.y=300,F.ref="menu4";const ue=[];if(typeof E<"u")for(let ie in E.config.props)delete F[E.config.props[ie]],ue.push(E.config.props[ie]);a[8].populate(F),r=a[8];const ye={};ye.color="0xe4e4e7ff",ye.y=300,ye.ref="menu4",m=ye.is||"Button";let ge;if(typeof m=="string"){if(ge=f.components&&f.components[m]||p[m],!ge)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(ge=m);return a[9]=ge.call(null,{props:ye},a[8],o),a[9][Symbol.for("slots")][0]?(r=a[9][Symbol.for("slots")][0],o=a[9]):r=a[9][Symbol.for("children")][0],a},effects:[function(r,o,f,p,v,S){o[0].set("x",{transition:r.x})}],context:{}},state(){return{x:-360,focused:1}},hooks:{focus(){this.$trigger("focused"),this.x=0}},watch:{focused(){const h=this.$select(`menu${this.focused}`);h&&h.$focus&&h.$focus()}},input:{right(){this.parent.$focus(),this.x=-360},down(){this.focused=Math.min(this.focused+1,4)},up(){this.focused=Math.max(this.focused-1,1)},left(){}}}),F_=at.Component("FocusHandling",{components:{Menu:j_,Button:oh},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.x=300,I.y=150,a[1].populate(I);const M=f.components&&f.components.Button||p.Button;r=a[1];const R={};a[2]=this.element({parent:r||"root"},o),R.color="0xef4444ff",R.x=0,R.ref="button1";const U=[];if(typeof M<"u")for(let We in M.config.props)delete R[M.config.props[We]],U.push(M.config.props[We]);a[2].populate(R),r=a[2];const x={};x.color="0xef4444ff",x.x=0,x.ref="button1",m=x.is||"Button";let L;if(typeof m=="string"){if(L=f.components&&f.components[m]||p[m],!L)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(L=m);a[3]=L.call(null,{props:x},a[2],o),a[3][Symbol.for("slots")][0]?(r=a[3][Symbol.for("slots")][0],o=a[3]):r=a[3][Symbol.for("children")][0];const j=f.components&&f.components.Button||p.Button;r=a[1];const H={};a[4]=this.element({parent:r||"root"},o),H.color="0xf97316ff",H.x=320,H.ref="button2";const Y=[];if(typeof j<"u")for(let We in j.config.props)delete H[j.config.props[We]],Y.push(j.config.props[We]);a[4].populate(H),r=a[4];const Z={};Z.color="0xf97316ff",Z.x=320,Z.ref="button2",m=Z.is||"Button";let X;if(typeof m=="string"){if(X=f.components&&f.components[m]||p[m],!X)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(X=m);a[5]=X.call(null,{props:Z},a[4],o),a[5][Symbol.for("slots")][0]?(r=a[5][Symbol.for("slots")][0],o=a[5]):r=a[5][Symbol.for("children")][0];const re=f.components&&f.components.Button||p.Button;r=a[1];const le={};a[6]=this.element({parent:r||"root"},o),le.color="0x84cc16ff",le.x=640,le.ref="button3";const se=[];if(typeof re<"u")for(let We in re.config.props)delete le[re.config.props[We]],se.push(re.config.props[We]);a[6].populate(le),r=a[6];const W={};W.color="0x84cc16ff",W.x=640,W.ref="button3",m=W.is||"Button";let ce;if(typeof m=="string"){if(ce=f.components&&f.components[m]||p[m],!ce)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(ce=m);a[7]=ce.call(null,{props:W},a[6],o),a[7][Symbol.for("slots")][0]?(r=a[7][Symbol.for("slots")][0],o=a[7]):r=a[7][Symbol.for("children")][0];const E=f.components&&f.components.Button||p.Button;r=a[1];const F={};a[8]=this.element({parent:r||"root"},o),F.color="0x10b981ff",F.x=0,F.y=100,F.ref="button4";const ue=[];if(typeof E<"u")for(let We in E.config.props)delete F[E.config.props[We]],ue.push(E.config.props[We]);a[8].populate(F),r=a[8];const ye={};ye.color="0x10b981ff",ye.x=0,ye.y=100,ye.ref="button4",m=ye.is||"Button";let ge;if(typeof m=="string"){if(ge=f.components&&f.components[m]||p[m],!ge)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(ge=m);a[9]=ge.call(null,{props:ye},a[8],o),a[9][Symbol.for("slots")][0]?(r=a[9][Symbol.for("slots")][0],o=a[9]):r=a[9][Symbol.for("children")][0];const ie=f.components&&f.components.Button||p.Button;r=a[1];const ee={};a[10]=this.element({parent:r||"root"},o),ee.color="0x06b6d4ff",ee.y=100,ee.x=320,ee.ref="button5";const de=[];if(typeof ie<"u")for(let We in ie.config.props)delete ee[ie.config.props[We]],de.push(ie.config.props[We]);a[10].populate(ee),r=a[10];const Ee={};Ee.color="0x06b6d4ff",Ee.y=100,Ee.x=320,Ee.ref="button5",m=Ee.is||"Button";let Ie;if(typeof m=="string"){if(Ie=f.components&&f.components[m]||p[m],!Ie)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(Ie=m);a[11]=Ie.call(null,{props:Ee},a[10],o),a[11][Symbol.for("slots")][0]?(r=a[11][Symbol.for("slots")][0],o=a[11]):r=a[11][Symbol.for("children")][0];const ke=f.components&&f.components.Button||p.Button;r=a[1];const Le={};a[12]=this.element({parent:r||"root"},o),Le.color="0x3b82f6ff",Le.y=100,Le.x=640,Le.ref="button6";const _e=[];if(typeof ke<"u")for(let We in ke.config.props)delete Le[ke.config.props[We]],_e.push(ke.config.props[We]);a[12].populate(Le),r=a[12];const De={};De.color="0x3b82f6ff",De.y=100,De.x=640,De.ref="button6",m=De.is||"Button";let $;if(typeof m=="string"){if($=f.components&&f.components[m]||p[m],!$)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&($=m);a[13]=$.call(null,{props:De},a[12],o),a[13][Symbol.for("slots")][0]?(r=a[13][Symbol.for("slots")][0],o=a[13]):r=a[13][Symbol.for("children")][0];const Pe=f.components&&f.components.Button||p.Button;r=a[1];const He={};a[14]=this.element({parent:r||"root"},o),He.color="0x8b5cf6ff",He.y=200,He.x=0,He.ref="button7";const Se=[];if(typeof Pe<"u")for(let We in Pe.config.props)delete He[Pe.config.props[We]],Se.push(Pe.config.props[We]);a[14].populate(He),r=a[14];const V={};V.color="0x8b5cf6ff",V.y=200,V.x=0,V.ref="button7",m=V.is||"Button";let Ae;if(typeof m=="string"){if(Ae=f.components&&f.components[m]||p[m],!Ae)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(Ae=m);a[15]=Ae.call(null,{props:V},a[14],o),a[15][Symbol.for("slots")][0]?(r=a[15][Symbol.for("slots")][0],o=a[15]):r=a[15][Symbol.for("children")][0];const Ce=f.components&&f.components.Button||p.Button;r=a[1];const je={};a[16]=this.element({parent:r||"root"},o),je.color="0xd946efff",je.y=200,je.x=320,je.ref="button8";const he=[];if(typeof Ce<"u")for(let We in Ce.config.props)delete je[Ce.config.props[We]],he.push(Ce.config.props[We]);a[16].populate(je),r=a[16];const Re={};Re.color="0xd946efff",Re.y=200,Re.x=320,Re.ref="button8",m=Re.is||"Button";let Ve;if(typeof m=="string"){if(Ve=f.components&&f.components[m]||p[m],!Ve)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(Ve=m);a[17]=Ve.call(null,{props:Re},a[16],o),a[17][Symbol.for("slots")][0]?(r=a[17][Symbol.for("slots")][0],o=a[17]):r=a[17][Symbol.for("children")][0];const ae=f.components&&f.components.Button||p.Button;r=a[1];const Q={};a[18]=this.element({parent:r||"root"},o),Q.color="0xf43f5eff",Q.y=200,Q.x=640,Q.ref="button9";const be=[];if(typeof ae<"u")for(let We in ae.config.props)delete Q[ae.config.props[We]],be.push(ae.config.props[We]);a[18].populate(Q),r=a[18];const st={};st.color="0xf43f5eff",st.y=200,st.x=640,st.ref="button9",m=st.is||"Button";let Xe;if(typeof m=="string"){if(Xe=f.components&&f.components[m]||p[m],!Xe)throw new Error('Component "Button" not found')}else typeof m=="function"&&m.name==="factory"&&(Xe=m);a[19]=Xe.call(null,{props:st},a[18],o),a[19][Symbol.for("slots")][0]?(r=a[19][Symbol.for("slots")][0],o=a[19]):r=a[19][Symbol.for("children")][0];const Fe=f.components&&f.components.Menu||p.Menu;r=a[0];const Ke={};a[20]=this.element({parent:r||"root"},o),Ke.ref="menu";const kt=[];if(typeof Fe<"u")for(let We in Fe.config.props)delete Ke[Fe.config.props[We]],kt.push(Fe.config.props[We]);a[20].populate(Ke),r=a[20];const qt={};qt.ref="menu",m=qt.is||"Menu";let $t;if(typeof m=="string"){if($t=f.components&&f.components[m]||p[m],!$t)throw new Error('Component "Menu" not found')}else typeof m=="function"&&m.name==="factory"&&($t=m);return a[21]=$t.call(null,{props:qt},a[20],o),a[21][Symbol.for("slots")][0]?(r=a[21][Symbol.for("slots")][0],o=a[21]):r=a[21][Symbol.for("children")][0],a},effects:[],context:{}},state(){return{focused:1}},hooks:{focus(){this.$trigger("focused")}},watch:{focused(h){const r=this.$select(`button${h}`);r&&r.$focus&&r.$focus()}},input:{right(){this.focused=Math.min(this.focused+1,9)},left(){const h=this.focused-1;if(h===0){const r=this.$select("menu");r&&r.$focus&&r.$focus()}else this.focused=Math.max(h,1)},a(){const h=this.$select("menu");h&&h.$focus&&h.$focus()}}}),$_=at.Component("Positioning",{code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.w=100,I.h=100,I.x=20,I.y=20,I.color="0xecfeffff",a[1].populate(I),r=a[0];const M={};a[2]=this.element({parent:r||"root"},o),M.w=100,M.h=100,M.x=140,M.y=20,M.color="0xa5f3fcff",a[2].populate(M),r=a[0];const R={};a[3]=this.element({parent:r||"root"},o),R.w=100,R.h=100,R.x=260,R.y=20,R.color="0x22d3eeff",a[3].populate(R),r=a[0];const U={};a[4]=this.element({parent:r||"root"},o),U.w=100,U.h=100,U.x=380,U.y=20,U.color="0x0891b2ff",a[4].populate(U),r=a[0];const x={};a[5]=this.element({parent:r||"root"},o),x.w=100,x.h=100,x.x=o.x1,x.y=o.y,x.color="0xfdf4ffff",a[5].populate(x),r=a[0];const L={};a[6]=this.element({parent:r||"root"},o),L.w=100,L.h=100,L.x=o.x2,L.y=o.y,L.color="0xf5d0feff",a[6].populate(L),r=a[0];const j={};a[7]=this.element({parent:r||"root"},o),j.w=100,j.h=100,j.x=o.x3,j.y=o.y,j.color="0xe879f9ff",a[7].populate(j),r=a[0];const H={};a[8]=this.element({parent:r||"root"},o),H.w=100,H.h=100,H.x=o.x4,H.y=o.y,H.color="0xc026d3ff",a[8].populate(H),r=a[0];const Y={};a[9]=this.element({parent:r||"root"},o),Y.w=100,Y.h=100,Y.x=o.xA,Y.y=260,Y.color="0xfff7edff",a[9].populate(Y),r=a[0];const Z={};a[10]=this.element({parent:r||"root"},o),Z.w=100,Z.h=100,Z.x=o.xB,Z.y=260,Z.color="0xfed7aaff",a[10].populate(Z),r=a[0];const X={};a[11]=this.element({parent:r||"root"},o),X.w=100,X.h=100,X.x=o.xC,X.y=260,X.color="0xfb923cff",a[11].populate(X),r=a[0];const re={};a[12]=this.element({parent:r||"root"},o),re.w=100,re.h=100,re.x=o.xD,re.y=260,re.color="0xea580cff",a[12].populate(re),r=a[0];const le={};a[13]=this.element({parent:r||"root"},o),le.w=800,le.h=800,le.y=20,le.x=800,le.color="0xecfdf5ff",a[13].populate(le),r=a[13];const se={};a[14]=this.element({parent:r||"root"},o),se.w=600,se.h=600,se.y=20,se.x=20,se.color="0xa7f3d0ff",a[14].populate(se),r=a[14];const W={};a[15]=this.element({parent:r||"root"},o),W.w=400,W.h=400,W.y=100,W.x=20,W.color="0x34d399ff",a[15].populate(W),r=a[15];const ce={};a[16]=this.element({parent:r||"root"},o),ce.w=200,ce.h=100,ce.y=(400-100)/2,ce.x=(400-200)/2,ce.color="0x059669ff",a[16].populate(ce),r=a[16];const E={};a[17]=this.element({parent:r||"root"},o),E.w=50,E.h=50,E.y={transition:o.yNested},E.x={transition:o.xNested},E.color="0x065f46ff",a[17].populate(E),r=a[0];const F={};a[18]=this.element({parent:r||"root"},o),F.w=100,F.h=100,F.y=500,F.x=20,F.color="0xe11d48ff",a[18].populate(F),r=a[0];const ue={};a[19]=this.element({parent:r||"root"},o),ue.w=200,ue.h=200,ue.x=300,ue.y=600,ue.color="0x94a3b8ff",ue.z=100,a[19].populate(ue),r=a[19];const ye={};a[20]=this.element({parent:r||"root"},o),ye.content="Lightning!",ye.x=100,ye.y=140,ye.__textnode=!0,a[20].populate(ye),r=a[19];const ge={};a[21]=this.element({parent:r||"root"},o),ge.w=300,ge.h=100,ge.color="0x475569ff",a[21].populate(ge);const ie=f.components&&f.components.Circle||p.Circle;r=a[19];const ee={};a[22]=this.element({parent:r||"root"},o),ee.x=150,ee.y=150,ee.size=100,ee.color="0xffffffff";const de=[];if(typeof ie<"u")for(let Pe in ie.config.props)delete ee[ie.config.props[Pe]],de.push(ie.config.props[Pe]);a[22].populate(ee),r=a[22];const Ee={};Ee.x=150,Ee.y=150,Ee.size=100,Ee.color="0xffffffff",m=Ee.is||"Circle";let Ie;if(typeof m=="string"){if(Ie=f.components&&f.components[m]||p[m],!Ie)throw new Error('Component "Circle" not found')}else typeof m=="function"&&m.name==="factory"&&(Ie=m);a[23]=Ie.call(null,{props:Ee},a[22],o),a[23][Symbol.for("slots")][0]?(r=a[23][Symbol.for("slots")][0],o=a[23]):r=a[23][Symbol.for("children")][0],r=a[0];const ke={};a[24]=this.element({parent:r||"root"},o),ke.w=300,ke.h=300,ke.x=300,ke.y=600,ke.color="0xef444480",a[24].populate(ke),r=a[0];const Le={};a[25]=this.element({parent:r||"root"},o),Le.w=400,Le.h=100,Le.x=800,Le.y=900,Le.color="0x0284c7ff",a[25].populate(Le),r=a[25];const _e={};a[26]=this.element({parent:r||"root"},o),_e.w=r.node.width*(42/100),_e.h=r.node.height*(30/100),_e.y=r.node.height*(5/100),_e.x=r.node.width*(1/100),_e.color="0x075985ff",a[26].populate(_e),r=a[25];const De={};a[27]=this.element({parent:r||"root"},o),De.w=o.bar2.v,De.h=r.node.height*(30/100),De.y=r.node.height*(35/100),De.x=r.node.width*(1/100),De.color="0x6b21a8ff",a[27].populate(De),r=a[25];const $={};return a[28]=this.element({parent:r||"root"},o),$.w={transition:o.bar3},$.h=r.node.height*(30/100),$.y=r.node.height*(65/100),$.x=r.node.width*(1/100),$.color="0x9f1239ff",a[28].populate($),a},effects:[function(r,o,f,p,v,S){o[9].set("x",r.xA)},function(r,o,f,p,v,S){o[10].set("x",r.xB)},function(r,o,f,p,v,S){o[11].set("x",r.xC)},function(r,o,f,p,v,S){o[12].set("x",r.xD)},function(r,o,f,p,v,S){o[16].set("y",(400-100)/2)},function(r,o,f,p,v,S){o[16].set("x",(400-200)/2)},function(r,o,f,p,v,S){o[17].set("y",{transition:r.yNested})},function(r,o,f,p,v,S){o[17].set("x",{transition:r.xNested})},function(r,o,f,p,v,S){o[27].set("w",r.bar2.v)},function(r,o,f,p,v,S){o[28].set("w",{transition:r.bar3})}],context:{}},state(){return{x1:20,x2:140,x3:20+140+100,x4:380,y:140,xA:20,xB:140,xC:260,xD:380,yNested:0,xNested:0,bar2:{direction:"up",v:"10%"},bar3:"10%"}},hooks:{ready(){this.$setTimeout(()=>{this.xD=this.xD+200,this.xC=this.xC+100,this.xB=this.xB+50,this.xA=this.xA+25},4e3),this.$setInterval(()=>{this.yNested=this.yNested===0?50:0},2e3),this.$setInterval(()=>{this.xNested=this.xNested===0?150:0},1e3),this.$setInterval(()=>{const h=parseFloat(this.bar2.v),r=this.bar2.direction==="up"?h+10:h-10;this.bar2.v=r+"%",r>=90&&(this.bar2.direction="down"),r<=10&&(this.bar2.direction="up")},400),this.$setInterval(()=>{this.bar3=Math.ceil(Math.random()*96)+"%"},2e3)}}});var V_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function H_(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var pT={};/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/(function(h){(function(){var r=typeof window<"u"?window:V_,o={};(function(p,v,S){var a;function m(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var _=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};function I(e){e=[typeof globalThis=="object"&&globalThis,e,typeof p=="object"&&p,typeof self=="object"&&self,typeof v=="object"&&v];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}var M=I(this);function R(e,t){if(t)e:{var n=M;e=e.split(".");for(var i=0;i<e.length-1;i++){var s=e[i];if(!(s in n))break e;n=n[s]}e=e[e.length-1],i=n[e],t=t(i),t!=i&&t!=null&&_(n,e,{configurable:!0,writable:!0,value:t})}}R("Symbol",function(e){function t(l){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new n(i+(l||"")+"_"+s++,l)}function n(l,u){this.g=l,_(this,"description",{configurable:!0,writable:!0,value:u})}if(e)return e;n.prototype.toString=function(){return this.g};var i="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",s=0;return t}),R("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=M[t[n]];typeof i=="function"&&typeof i.prototype[e]!="function"&&_(i.prototype,e,{configurable:!0,writable:!0,value:function(){return U(m(this))}})}return e});function U(e){return e={next:e},e[Symbol.iterator]=function(){return this},e}function x(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if(typeof e.length=="number")return{next:m(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}function L(e){if(!(e instanceof Array)){e=x(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}var j=typeof Object.create=="function"?Object.create:function(e){function t(){}return t.prototype=e,new t},H;if(typeof Object.setPrototypeOf=="function")H=Object.setPrototypeOf;else{var Y;e:{var Z={a:!0},X={};try{X.__proto__=Z,Y=X.a;break e}catch{}Y=!1}H=Y?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var re=H;function le(e,t){if(e.prototype=j(t.prototype),e.prototype.constructor=e,re)re(e,t);else for(var n in t)if(n!="prototype")if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.hk=t.prototype}function se(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.A=this.i=null}function W(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}se.prototype.s=function(e){this.h=e};function ce(e,t){e.i={sg:t,Fg:!0},e.g=e.m||e.j}se.prototype.return=function(e){this.i={return:e},this.g=this.j};function E(e,t,n){return e.g=n,{value:t}}se.prototype.u=function(e){this.g=e};function F(e){e.g=0}function ue(e,t,n){e.m=t,n!=null&&(e.j=n)}function ye(e,t){e.m=0,e.j=t||0}function ge(e,t,n){e.g=t,e.m=n||0}function ie(e,t){return e.m=t||0,t=e.i.sg,e.i=null,t}function ee(e){e.A=[e.i],e.m=0,e.j=0}function de(e,t){var n=e.A.splice(0)[0];(n=e.i=e.i||n)?n.Fg?e.g=e.m||e.j:n.u!=null&&e.j<n.u?(e.g=n.u,e.i=null):e.g=e.j:e.g=t}function Ee(e){this.g=new se,this.h=e}function Ie(e,t){W(e.g);var n=e.g.l;return n?ke(e,"return"in n?n.return:function(i){return{value:i,done:!0}},t,e.g.return):(e.g.return(t),Le(e))}function ke(e,t,n,i){try{var s=t.call(e.g.l,n);if(!(s instanceof Object))throw new TypeError("Iterator result "+s+" is not an object");if(!s.done)return e.g.o=!1,s;var l=s.value}catch(u){return e.g.l=null,ce(e.g,u),Le(e)}return e.g.l=null,i.call(e.g,l),Le(e)}function Le(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.o=!1,{value:t.value,done:!1}}catch(n){e.g.h=void 0,ce(e.g,n)}if(e.g.o=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.Fg)throw t.sg;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _e(e){this.next=function(t){return W(e.g),e.g.l?t=ke(e,e.g.l.next,t,e.g.s):(e.g.s(t),t=Le(e)),t},this.throw=function(t){return W(e.g),e.g.l?t=ke(e,e.g.l.throw,t,e.g.s):(ce(e.g,t),t=Le(e)),t},this.return=function(t){return Ie(e,t)},this[Symbol.iterator]=function(){return this}}function De(e){function t(i){return e.next(i)}function n(i){return e.throw(i)}return new Promise(function(i,s){function l(u){u.done?i(u.value):Promise.resolve(u.value).then(t,n).then(l,s)}l(e.next())})}function $(e){return De(new _e(new Ee(e)))}function Pe(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}R("Promise",function(e){function t(u){this.h=0,this.i=void 0,this.g=[],this.o=!1;var c=this.j();try{u(c.resolve,c.reject)}catch(d){c.reject(d)}}function n(){this.g=null}function i(u){return u instanceof t?u:new t(function(c){c(u)})}if(e)return e;n.prototype.h=function(u){if(this.g==null){this.g=[];var c=this;this.i(function(){c.l()})}this.g.push(u)};var s=M.setTimeout;n.prototype.i=function(u){s(u,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var u=this.g;this.g=[];for(var c=0;c<u.length;++c){var d=u[c];u[c]=null;try{d()}catch(g){this.j(g)}}}this.g=null},n.prototype.j=function(u){this.i(function(){throw u})},t.prototype.j=function(){function u(g){return function(y){d||(d=!0,g.call(c,y))}}var c=this,d=!1;return{resolve:u(this.F),reject:u(this.l)}},t.prototype.F=function(u){if(u===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(u instanceof t)this.H(u);else{e:switch(typeof u){case"object":var c=u!=null;break e;case"function":c=!0;break e;default:c=!1}c?this.C(u):this.m(u)}},t.prototype.C=function(u){var c=void 0;try{c=u.then}catch(d){this.l(d);return}typeof c=="function"?this.I(c,u):this.m(u)},t.prototype.l=function(u){this.s(2,u)},t.prototype.m=function(u){this.s(1,u)},t.prototype.s=function(u,c){if(this.h!=0)throw Error("Cannot settle("+u+", "+c+"): Promise already settled in state"+this.h);this.h=u,this.i=c,this.h===2&&this.G(),this.A()},t.prototype.G=function(){var u=this;s(function(){if(u.B()){var c=M.console;typeof c<"u"&&c.error(u.i)}},1)},t.prototype.B=function(){if(this.o)return!1;var u=M.CustomEvent,c=M.Event,d=M.dispatchEvent;return typeof d>"u"?!0:(typeof u=="function"?u=new u("unhandledrejection",{cancelable:!0}):typeof c=="function"?u=new c("unhandledrejection",{cancelable:!0}):(u=M.document.createEvent("CustomEvent"),u.initCustomEvent("unhandledrejection",!1,!0,u)),u.promise=this,u.reason=this.i,d(u))},t.prototype.A=function(){if(this.g!=null){for(var u=0;u<this.g.length;++u)l.h(this.g[u]);this.g=null}};var l=new n;return t.prototype.H=function(u){var c=this.j();u.Ed(c.resolve,c.reject)},t.prototype.I=function(u,c){var d=this.j();try{u.call(c,d.resolve,d.reject)}catch(g){d.reject(g)}},t.prototype.then=function(u,c){function d(C,T){return typeof C=="function"?function(A){try{g(C(A))}catch(b){y(b)}}:T}var g,y,w=new t(function(C,T){g=C,y=T});return this.Ed(d(u,g),d(c,y)),w},t.prototype.catch=function(u){return this.then(void 0,u)},t.prototype.Ed=function(u,c){function d(){switch(g.h){case 1:u(g.i);break;case 2:c(g.i);break;default:throw Error("Unexpected state: "+g.h)}}var g=this;this.g==null?l.h(d):this.g.push(d),this.o=!0},t.resolve=i,t.reject=function(u){return new t(function(c,d){d(u)})},t.race=function(u){return new t(function(c,d){for(var g=x(u),y=g.next();!y.done;y=g.next())i(y.value).Ed(c,d)})},t.all=function(u){var c=x(u),d=c.next();return d.done?i([]):new t(function(g,y){function w(A){return function(b){C[A]=b,T--,T==0&&g(C)}}var C=[],T=0;do C.push(void 0),T++,i(d.value).Ed(w(C.length-1),y),d=c.next();while(!d.done)})},t});function He(e,t){return Object.prototype.hasOwnProperty.call(e,t)}R("WeakMap",function(e){function t(d){if(this.g=(c+=Math.random()+1).toString(),d){d=x(d);for(var g;!(g=d.next()).done;)g=g.value,this.set(g[0],g[1])}}function n(){}function i(d){var g=typeof d;return g==="object"&&d!==null||g==="function"}function s(d){if(!He(d,u)){var g=new n;_(d,u,{value:g})}}function l(d){var g=Object[d];g&&(Object[d]=function(y){return y instanceof n?y:(Object.isExtensible(y)&&s(y),g(y))})}if(function(){if(!e||!Object.seal)return!1;try{var d=Object.seal({}),g=Object.seal({}),y=new e([[d,2],[g,3]]);return y.get(d)!=2||y.get(g)!=3?!1:(y.delete(d),y.set(g,4),!y.has(d)&&y.get(g)==4)}catch{return!1}}())return e;var u="$jscomp_hidden_"+Math.random();l("freeze"),l("preventExtensions"),l("seal");var c=0;return t.prototype.set=function(d,g){if(!i(d))throw Error("Invalid WeakMap key");if(s(d),!He(d,u))throw Error("WeakMap key fail: "+d);return d[u][this.g]=g,this},t.prototype.get=function(d){return i(d)&&He(d,u)?d[u][this.g]:void 0},t.prototype.has=function(d){return i(d)&&He(d,u)&&He(d[u],this.g)},t.prototype.delete=function(d){return i(d)&&He(d,u)&&He(d[u],this.g)?delete d[u][this.g]:!1},t}),R("Map",function(e){function t(){var c={};return c.Mb=c.next=c.head=c}function n(c,d){var g=c[1];return U(function(){if(g){for(;g.head!=c[1];)g=g.Mb;for(;g.next!=g.head;)return g=g.next,{done:!1,value:d(g)};g=null}return{done:!0,value:void 0}})}function i(c,d){var g=d&&typeof d;g=="object"||g=="function"?l.has(d)?g=l.get(d):(g=""+ ++u,l.set(d,g)):g="p_"+d;var y=c[0][g];if(y&&He(c[0],g))for(c=0;c<y.length;c++){var w=y[c];if(d!==d&&w.key!==w.key||d===w.key)return{id:g,list:y,index:c,entry:w}}return{id:g,list:y,index:-1,entry:void 0}}function s(c){if(this[0]={},this[1]=t(),this.size=0,c){c=x(c);for(var d;!(d=c.next()).done;)d=d.value,this.set(d[0],d[1])}}if(function(){if(!e||typeof e!="function"||!e.prototype.entries||typeof Object.seal!="function")return!1;try{var c=Object.seal({x:4}),d=new e(x([[c,"s"]]));if(d.get(c)!="s"||d.size!=1||d.get({x:4})||d.set({x:4},"t")!=d||d.size!=2)return!1;var g=d.entries(),y=g.next();return y.done||y.value[0]!=c||y.value[1]!="s"?!1:(y=g.next(),!(y.done||y.value[0].x!=4||y.value[1]!="t"||!g.next().done))}catch{return!1}}())return e;var l=new WeakMap;s.prototype.set=function(c,d){c=c===0?0:c;var g=i(this,c);return g.list||(g.list=this[0][g.id]=[]),g.entry?g.entry.value=d:(g.entry={next:this[1],Mb:this[1].Mb,head:this[1],key:c,value:d},g.list.push(g.entry),this[1].Mb.next=g.entry,this[1].Mb=g.entry,this.size++),this},s.prototype.delete=function(c){return c=i(this,c),c.entry&&c.list?(c.list.splice(c.index,1),c.list.length||delete this[0][c.id],c.entry.Mb.next=c.entry.next,c.entry.next.Mb=c.entry.Mb,c.entry.head=null,this.size--,!0):!1},s.prototype.clear=function(){this[0]={},this[1]=this[1].Mb=t(),this.size=0},s.prototype.has=function(c){return!!i(this,c).entry},s.prototype.get=function(c){return(c=i(this,c).entry)&&c.value},s.prototype.entries=function(){return n(this,function(c){return[c.key,c.value]})},s.prototype.keys=function(){return n(this,function(c){return c.key})},s.prototype.values=function(){return n(this,function(c){return c.value})},s.prototype.forEach=function(c,d){for(var g=this.entries(),y;!(y=g.next()).done;)y=y.value,c.call(d,y[1],y[0],this)},s.prototype[Symbol.iterator]=s.prototype.entries;var u=0;return s}),R("Set",function(e){function t(n){if(this.g=new Map,n){n=x(n);for(var i;!(i=n.next()).done;)this.add(i.value)}this.size=this.g.size}return function(){if(!e||typeof e!="function"||!e.prototype.entries||typeof Object.seal!="function")return!1;try{var n=Object.seal({x:4}),i=new e(x([n]));if(!i.has(n)||i.size!=1||i.add(n)!=i||i.size!=1||i.add({x:4})!=i||i.size!=2)return!1;var s=i.entries(),l=s.next();return l.done||l.value[0]!=n||l.value[1]!=n?!1:(l=s.next(),l.done||l.value[0]==n||l.value[0].x!=4||l.value[1]!=l.value[0]?!1:s.next().done)}catch{return!1}}()?e:(t.prototype.add=function(n){return n=n===0?0:n,this.g.set(n,n),this.size=this.g.size,this},t.prototype.delete=function(n){return n=this.g.delete(n),this.size=this.g.size,n},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(n){return this.g.has(n)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(n,i){var s=this;this.g.forEach(function(l){return n.call(i,l,l,s)})},t)});function Se(e,t){e instanceof String&&(e+="");var n=0,i=!1,s={next:function(){if(!i&&n<e.length){var l=n++;return{value:t(l,e[l]),done:!1}}return i=!0,{done:!0,value:void 0}}};return s[Symbol.iterator]=function(){return s},s}R("Array.prototype.keys",function(e){return e||function(){return Se(this,function(t){return t})}});function V(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,s=0;s<i;s++){var l=e[s];if(t.call(n,l,s,e))return{Dg:s,v:l}}return{Dg:-1,v:void 0}}R("Array.prototype.findIndex",function(e){return e||function(t,n){return V(this,t,n).Dg}}),R("Array.from",function(e){return e||function(t,n,i){n=n??function(c){return c};var s=[],l=typeof Symbol<"u"&&Symbol.iterator&&t[Symbol.iterator];if(typeof l=="function"){t=l.call(t);for(var u=0;!(l=t.next()).done;)s.push(n.call(i,l.value,u++))}else for(l=t.length,u=0;u<l;u++)s.push(n.call(i,t[u],u));return s}}),R("Array.prototype.values",function(e){return e||function(){return Se(this,function(t,n){return n})}}),R("Object.is",function(e){return e||function(t,n){return t===n?t!==0||1/t===1/n:t!==t&&n!==n}}),R("Array.prototype.includes",function(e){return e||function(t,n){var i=this;i instanceof String&&(i=String(i));var s=i.length;for(n=n||0,0>n&&(n=Math.max(n+s,0));n<s;n++){var l=i[n];if(l===t||Object.is(l,t))return!0}return!1}});function Ae(e,t,n){if(e==null)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}R("String.prototype.includes",function(e){return e||function(t,n){return Ae(this,t,"includes").indexOf(t,n||0)!==-1}}),R("String.fromCodePoint",function(e){return e||function(t){for(var n="",i=0;i<arguments.length;i++){var s=Number(arguments[i]);if(0>s||1114111<s||s!==Math.floor(s))throw new RangeError("invalid_code_point "+s);65535>=s?n+=String.fromCharCode(s):(s-=65536,n+=String.fromCharCode(s>>>10&1023|55296),n+=String.fromCharCode(s&1023|56320))}return n}}),R("Array.prototype.find",function(e){return e||function(t,n){return V(this,t,n).v}}),R("String.prototype.startsWith",function(e){return e||function(t,n){var i=Ae(this,t,"startsWith"),s=i.length,l=t.length;n=Math.max(0,Math.min(n|0,i.length));for(var u=0;u<l&&n<s;)if(i[n++]!=t[u++])return!1;return u>=l}}),R("WeakSet",function(e){function t(n){if(this.g=new WeakMap,n){n=x(n);for(var i;!(i=n.next()).done;)this.add(i.value)}}return function(){if(!e||!Object.seal)return!1;try{var n=Object.seal({}),i=Object.seal({}),s=new e([n]);return!s.has(n)||s.has(i)?!1:(s.delete(n),s.add(i),!s.has(n)&&s.has(i))}catch{return!1}}()?e:(t.prototype.add=function(n){return this.g.set(n,!0),this},t.prototype.has=function(n){return this.g.has(n)},t.prototype.delete=function(n){return this.g.delete(n)},t)});var Ce=typeof Object.assign=="function"?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var s in i)He(i,s)&&(e[s]=i[s])}return e};R("Object.assign",function(e){return e||Ce}),R("Promise.prototype.finally",function(e){return e||function(t){return this.then(function(n){return Promise.resolve(t()).then(function(){return n})},function(n){return Promise.resolve(t()).then(function(){throw n})})}}),R("Array.prototype.entries",function(e){return e||function(){return Se(this,function(t,n){return[t,n]})}}),R("Number.isNaN",function(e){return e||function(t){return typeof t=="number"&&isNaN(t)}}),R("String.prototype.repeat",function(e){return e||function(t){var n=Ae(this,null,"repeat");if(0>t||1342177279<t)throw new RangeError("Invalid count value");t|=0;for(var i="";t;)t&1&&(i+=n),(t>>>=1)&&(n+=n);return i}}),R("Number.isFinite",function(e){return e||function(t){return typeof t!="number"?!1:!isNaN(t)&&t!==1/0&&t!==-1/0}}),R("Object.values",function(e){return e||function(t){var n=[],i;for(i in t)He(t,i)&&n.push(t[i]);return n}}),R("Math.log2",function(e){return e||function(t){return Math.log(t)/Math.LN2}}),R("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991}),R("Math.trunc",function(e){return e||function(t){if(t=Number(t),isNaN(t)||t===1/0||t===-1/0||t===0)return t;var n=Math.floor(Math.abs(t));return 0>t?-n:n}}),R("Object.entries",function(e){return e||function(t){var n=[],i;for(i in t)He(t,i)&&n.push([i,t[i]]);return n}});var je=this||self;function he(e,t){e=e.split(".");var n=je;e[0]in n||typeof n.execScript>"u"||n.execScript("var "+e[0]);for(var i;e.length&&(i=e.shift());)e.length||t===void 0?n[i]&&n[i]!==Object.prototype[i]?n=n[i]:n=n[i]={}:n[i]=t}function Re(){}function Ve(){}function ae(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}ae.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)};function Q(e){return e.h/(1-Math.pow(e.g,e.i))}function be(){this.h=new ae(2),this.j=new ae(5),this.g=0,this.i=128e3,this.l=16e3}be.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},be.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},be.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(Q(this.h),Q(this.j))};function st(){}function Xe(){}function Fe(){}function Ke(e){var t=Pe.apply(1,arguments);We.has(e)||(We.add(e),Fe.apply(st,L(t)))}function kt(){}function qt(){}function $t(){}var We=new Set;p.console&&(Fe=function(){return console.warn.apply(console,L(Pe.apply(0,arguments)))},Xe=function(){console.error.apply(console,L(Pe.apply(0,arguments)))});function Sn(){this.g={}}a=Sn.prototype,a.push=function(e,t){this.g.hasOwnProperty(e)?this.g[e].push(t):this.g[e]=[t]},a.get=function(e){return(e=this.g[e])?e.slice():null},a.remove=function(e,t){e in this.g&&(this.g[e]=this.g[e].filter(function(n){return n!=t}),this.g[e].length==0&&delete this.g[e])},a.forEach=function(e){for(var t in this.g)e(t,this.g[t])},a.size=function(){return Object.keys(this.g).length},a.keys=function(){return Object.keys(this.g)};function lt(){this.g=new Sn}a=lt.prototype,a.release=function(){this.Ra(),this.g=null},a.D=function(e,t,n,i){this.g&&(e=new zr(e,t,n,i),this.g.push(t,e))},a.ha=function(e,t,n,i){function s(u){l.jb(e,t,s),n(u)}var l=this;this.D(e,t,s,i)},a.jb=function(e,t,n){if(this.g){var i=this.g.get(t)||[];i=x(i);for(var s=i.next();!s.done;s=i.next())s=s.value,s.target!=e||n!=s.listener&&n||(s.jb(),this.g.remove(t,s))}},a.Ra=function(){if(this.g){var e=this.g,t=[],n;for(n in e.g)t.push.apply(t,L(e.g[n]));for(e=x(t),t=e.next();!t.done;t=e.next())t.value.jb();this.g.g={}}},he("shaka.util.EventManager",lt),lt.prototype.removeAll=lt.prototype.Ra,lt.prototype.unlisten=lt.prototype.jb,lt.prototype.listenOnce=lt.prototype.ha,lt.prototype.listen=lt.prototype.D,lt.prototype.release=lt.prototype.release;function zr(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.g=ui(e,i),this.target.addEventListener(t,n,this.g)}zr.prototype.jb=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};function ui(e,t){if(t==null)return!1;if(typeof t=="boolean")return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter(function(i){return!n.has(i)}),oo(e)?t:t.capture||!1}function oo(e){var t=go;if(t==null){t=!1;try{var n={},i={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch{t=!1}go=t}return t||!1}var go=void 0;function Lt(e){if(Be.has(e))return Be.get(e);if(p.ManagedMediaSource){var t=ManagedMediaSource.isTypeSupported(e);return Be.set(e,t),t}return p.MediaSource?(t=MediaSource.isTypeSupported(e),Be.set(e,t),t):!1}function ut(){return!!p.SourceBuffer&&!!SourceBuffer.prototype&&!!SourceBuffer.prototype.changeType}var Be=new Map;function vn(e,t){this.g=e,this.h=t}vn.prototype.toString=function(){return"v"+this.g+"."+this.h};function vt(e,t){var n=new vn(5,0),i=Tn,s=i.g,l=n.h-s.h;(0<(n.g-s.g||l)?i.i:i.h)(i.g,n,e,t)}function Bn(e,t,n,i){Fe([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function mo(e,t,n,i){Xe([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(" "))}var Tn=null;function fi(){}fi.prototype.extract=function(){},fi.prototype.decode=function(){return[]},fi.prototype.clear=function(){},fi.prototype.getStreams=function(){return[]};function bt(){}bt.prototype.init=function(){},bt.prototype.parse=function(){return[]};function qe(){}function Zt(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if(Rn(e)==Rn(t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=Ze(e);t=Ze(t);for(var i=0;i<e.byteLength;i++)if(n[i]!=t[i])return!1;return!0}function Rn(e){return e instanceof ArrayBuffer?e:e.buffer}function Pt(e){return e instanceof ArrayBuffer?e:e.byteOffset==0&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}function Ze(e,t,n){return n=n===void 0?1/0:n,Di(e,t===void 0?0:t,n,Uint8Array)}function ci(e,t,n){return n=n===void 0?1/0:n,Di(e,t===void 0?0:t,n,Uint16Array)}function xn(e,t,n){return n=n===void 0?1/0:n,Di(e,t===void 0?0:t,n,DataView)}function Di(e,t,n,i){var s=Rn(e),l=1;"BYTES_PER_ELEMENT"in i&&(l=i.BYTES_PER_ELEMENT);var u=((e.byteOffset||0)+e.byteLength)/l;return e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/l,u))),new i(s,e,Math.floor(Math.min(e+Math.max(n,0),u))-e)}he("shaka.util.BufferUtils",qe),qe.toDataView=xn,qe.toUint16=ci,qe.toUint8=Ze,qe.toArrayBuffer=Pt,qe.equal=Zt;function pr(){}pr.prototype.init=function(){},pr.prototype.i=function(){},pr.prototype.g=function(){},pr.prototype.j=function(){},he("shaka.media.IClosedCaptionParser",pr);function fn(e){this.l=new bt,(e=Hi[e.toLowerCase()])&&(this.l=e()),this.h=new fi,(e=zi)&&(this.h=e())}fn.prototype.init=function(e,t){t!==void 0&&t||this.g(),this.l.init(e)},fn.prototype.i=function(e){e=this.l.parse(e),e=x(e);for(var t=e.next();!t.done;t=e.next()){t=t.value;var n=Ze(t.packet);0<n.length&&this.h.extract(n,t.pts)}return this.h.decode()},fn.prototype.g=function(){this.h.clear()},fn.prototype.j=function(){return this.h.getStreams()},he("shaka.media.ClosedCaptionParser",fn),fn.findDecoder=function(){return zi},fn.unregisterDecoder=function(){zi=null},fn.registerDecoder=function(e){zi=e},fn.findParser=function(e){return Hi[e]},fn.unregisterParser=function(e){delete Hi[e]},fn.registerParser=function(e,t){Hi[e]=t};var Hi={},zi=null;function jn(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Wn,this.scroll=Gi}he("shaka.text.CueRegion",jn);var Wn=1;jn.units={PX:0,PERCENTAGE:Wn,LINES:2};var Gi="";jn.scrollMode={NONE:Gi,UP:"up"};function gr(e,t){return typeof e=="number"&&typeof t=="number"&&isNaN(e)&&isNaN(t)?!0:e===t}function Fn(e,t){t=e.indexOf(t),-1<t&&e.splice(t,1)}function Xi(e,t,n){if(n||(n=gr),e.length!=t.length)return!1;t=t.slice(),e=x(e);for(var i=e.next(),s={};!i.done;s={Gg:void 0},i=e.next()){if(s.Gg=i.value,i=t.findIndex(function(l){return function(u){return n(l.Gg,u)}}(s)),i==-1)return!1;t[i]=t[t.length-1],t.pop()}return t.length==0}function mr(e,t,n){if(n||(n=gr),e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function St(e,t,n){this.startTime=e,this.endTime=t,this.payload=n,this.region=new jn,this.position=null,this.positionAlign=Jl,this.size=0,this.textAlign=yo,this.direction=ga,this.writingMode=vr,this.lineInterpretation=eu,this.line=null,this.lineHeight="",this.lineAlign=xr,this.displayAlign=pa,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=Tg,this.fontStyle=hh,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={dc:32,rows:15}}function yr(e,t){return e=new St(e,t,""),e.lineBreak=!0,e}St.prototype.clone=function(){var e=new St(0,0,""),t;for(t in this)e[t]=this[t],e[t]&&e[t].constructor==Array&&(e[t]=e[t].slice());return e};function ft(e,t){if(e.startTime!=t.startTime||e.endTime!=t.endTime||e.payload!=t.payload)return!1;for(var n in e)if(n!="startTime"&&n!="endTime"&&n!="payload"){if(n=="nestedCues"){if(!mr(e.nestedCues,t.nestedCues,ft))return!1}else if(n=="region"||n=="cellResolution"){for(var i in e[n])if(e[n][i]!=t[n][i])return!1}else if(Array.isArray(e[n])){if(!mr(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1}return!0}he("shaka.text.Cue",St),St.equal=ft,St.prototype.clone=St.prototype.clone;var Jl="auto";St.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Jl};var yo="center",fh={LEFT:"left",RIGHT:"right",CENTER:yo,START:"start",END:"end"};St.textAlign=fh;var pa="after",xg={BEFORE:"before",CENTER:"center",AFTER:pa};St.displayAlign=xg;var ga="ltr";St.direction={HORIZONTAL_LEFT_TO_RIGHT:ga,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var vr="horizontal-tb";St.writingMode={HORIZONTAL_TOP_TO_BOTTOM:vr,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var eu=0;St.lineInterpretation={LINE_NUMBER:eu,PERCENTAGE:1};var xr="start",ch={CENTER:"center",START:xr,END:"end"};St.lineAlign=ch;var wg={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};St.defaultTextColor=wg;var Sg={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};St.defaultTextBackgroundColor=Sg;var Tg=400;St.fontWeight={NORMAL:Tg,BOLD:700};var hh="normal",Cg={NORMAL:hh,ITALIC:"italic",OBLIQUE:"oblique"};St.fontStyle=Cg,St.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};function Ho(){}Ho.prototype.destroy=function(){};function vo(e,t,n){dh[e.toLowerCase().split(";")[0]+"-"+n]={priority:n,ie:t}}function zo(e,t){for(var n=e.toLowerCase().split(";")[0],i=x([Eg,gh,ph,Go]),s=i.next();!s.done;s=i.next())if(s=dh[n+"-"+s.value]){var l=s.ie(),u=l.isSupported(e,t);if(l.destroy(),u)return s.ie}return null}he("shaka.transmuxer.TransmuxerEngine",Ho),Ho.findTransmuxer=zo,Ho.unregisterTransmuxer=function(e,t){delete dh[e.toLowerCase().split(";")[0]+"-"+t]},Ho.registerTransmuxer=vo,Ho.prototype.destroy=Ho.prototype.destroy;var dh={},Go=1,ph=2,gh=3,Eg=4;Ho.PluginPriority={FALLBACK:Go,PREFERRED_SECONDARY:ph,PREFERRED:gh,APPLICATION:Eg};/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/var yT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/function tn(e){var t;e instanceof tn?(tu(this,e.Bb),this.uc=e.uc,nu(this,e.Eb),mh(this,e.Mc),this.Pa=e.Pa,ma(this,e.g.clone()),this.ec=e.ec):e&&(t=String(e).match(yT))?(tu(this,t[1]||"",!0),this.uc=ya(t[2]||""),nu(this,t[3]||"",!0),mh(this,t[4]),this.Pa=ya(t[5]||"",!0),ma(this,t[6]||"",!0),this.ec=ya(t[7]||"")):this.g=new xa(null)}a=tn.prototype,a.Bb="",a.uc="",a.Eb="",a.Mc=null,a.Pa="",a.ec="",a.toString=function(){var e=[],t=this.Bb;if(t&&e.push(va(t,Ag,!0),":"),t=this.Eb){e.push("//");var n=this.uc;n&&e.push(va(n,Ag,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.Mc,t!=null&&e.push(":",String(t))}return(t=this.Pa)&&(this.Eb&&t.charAt(0)!="/"&&e.push("/"),e.push(va(t,t.charAt(0)=="/"?wT:xT,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.ec)&&e.push("#",va(t,TT)),e.join("")},a.resolve=function(e){var t=this.clone();t.Bb==="data"&&(t=new tn);var n=!!e.Bb;n?tu(t,e.Bb):n=!!e.uc,n?t.uc=e.uc:n=!!e.Eb,n?nu(t,e.Eb):n=e.Mc!=null;var i=e.Pa;if(n)mh(t,e.Mc);else if(n=!!e.Pa){if(i.charAt(0)!="/")if(this.Eb&&!this.Pa)i="/"+i;else{var s=t.Pa.lastIndexOf("/");s!=-1&&(i=t.Pa.substr(0,s+1)+i)}if(i==".."||i==".")i="";else if(i.indexOf("./")!=-1||i.indexOf("/.")!=-1){s=i.lastIndexOf("/",0)==0,i=i.split("/");for(var l=[],u=0;u<i.length;){var c=i[u++];c=="."?s&&u==i.length&&l.push(""):c==".."?((1<l.length||l.length==1&&l[0]!="")&&l.pop(),s&&u==i.length&&l.push("")):(l.push(c),s=!0)}i=l.join("/")}}return n?t.Pa=i:n=e.g.toString()!=="",n?ma(t,e.g.clone()):n=!!e.ec,n&&(t.ec=e.ec),t},a.clone=function(){return new tn(this)};function tu(e,t,n){e.Bb=n?ya(t,!0):t,e.Bb&&(e.Bb=e.Bb.replace(/:$/,""))}function nu(e,t,n){e.Eb=n?ya(t,!0):t}function mh(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Mc=t}else e.Mc=null}function ma(e,t,n){t instanceof xa?e.g=t:(n||(t=va(t,ST)),e.g=new xa(t))}function ya(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function va(e,t,n){return e!=null?(e=encodeURI(e).replace(t,vT),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function vT(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var Ag=/[#\/\?@]/g,xT=/[#\?:]/g,wT=/[#\?]/g,ST=/[#\?@]/g,TT=/#/g;function xa(e){this.g=e||null}function iu(e){if(!e.Ka&&(e.Ka={},e.Xc=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var i=t[n].indexOf("="),s=null;if(0<=i){var l=t[n].substring(0,i);s=t[n].substring(i+1)}else l=t[n];l=decodeURIComponent(l.replace(/\+/g," ")),s=s||"",e.add(l,decodeURIComponent(s.replace(/\+/g," ")))}}a=xa.prototype,a.Ka=null,a.Xc=null;function kg(e){return iu(e),e.Xc}a.add=function(e,t){iu(this),this.g=null;var n=this.Ka.hasOwnProperty(e)?this.Ka[e]:null;return n||(this.Ka[e]=n=[]),n.push(t),this.Xc++,this},a.set=function(e,t){return iu(this),this.g=null,this.Ka.hasOwnProperty(e)?this.Ka[e]=[t]:this.add(e,t),this},a.get=function(e){return iu(this),this.Ka[e]||[]},a.toString=function(){if(this.g)return this.g;if(!this.Ka)return"";var e=[],t;for(t in this.Ka)for(var n=encodeURIComponent(t),i=this.Ka[t],s=0;s<i.length;s++){var l=n;i[s]!==""&&(l+="="+encodeURIComponent(i[s])),e.push(l)}return this.g=e.join("&")},a.clone=function(){var e=new xa;if(e.g=this.g,this.Ka){var t={},n;for(n in this.Ka)t[n]=this.Ka[n].concat();e.Ka=t,e.Xc=this.Xc}return e};function K(e,t,n){var i=Pe.apply(3,arguments);this.severity=e,this.category=t,this.code=n,this.data=i,this.handled=!1,this.message="Shaka Error "+this.code;try{throw Error(this.message||"Shaka Error")}catch(s){this.stack=s.stack}}K.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},he("shaka.util.Error",K),K.Severity={RECOVERABLE:1,CRITICAL:2},K.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},K.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,DASH_INVALID_PATCH:4052,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,SRC_EQUALS_PRELOAD_NOT_SUPPORTED:7005,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005};function Gr(e){this.h=e,this.g=void 0}Gr.prototype.value=function(){return this.g==null&&(this.g=this.h()),this.g};function bg(e,t){return e.length&&t.length&&e!==t?0<yh(e,t).length:!0}function yh(e,t){if(!e.length)return t;if(!t.length)return e;var n=[];e=x(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var s=x(t),l=s.next();!l.done;l=s.next())if(l=l.value,i.keySystem==l.keySystem){s=new Map;for(var u=x((i.initData||[]).concat(l.initData||[])),c=u.next();!c.done;c=u.next())c=c.value,s.set(c.keyId,c);s=Array.from(s.values()),u=i.keyIds&&l.keyIds?new Set([].concat(L(i.keyIds),L(l.keyIds))):i.keyIds||l.keyIds,n.push({keySystem:i.keySystem,licenseServerUri:i.licenseServerUri||l.licenseServerUri,distinctiveIdentifierRequired:i.distinctiveIdentifierRequired||l.distinctiveIdentifierRequired,persistentStateRequired:i.persistentStateRequired||l.persistentStateRequired,videoRobustness:i.videoRobustness||l.videoRobustness,audioRobustness:i.audioRobustness||l.audioRobustness,serverCertificate:i.serverCertificate||l.serverCertificate,serverCertificateUri:i.serverCertificateUri||l.serverCertificateUri,initData:s,keyIds:u});break}}return n}function vh(e){return e?!!e.match(/^com\.(microsoft|chromecast)\.playready/):!1}var ou=new Gr(function(){return Pt(new Uint8Array([0]))}),ru=new Map;function wa(e){this.h=e,this.g=null}wa.prototype.Y=function(e){var t=this;this.stop();var n=!0,i=null;return this.g=function(){p.clearTimeout(i),n=!1},i=p.setTimeout(function(){n&&t.h()},1e3*e),this},wa.prototype.stop=function(){this.g&&(this.g(),this.g=null)};function ct(e){this.h=e,this.g=null}ct.prototype.tc=function(){return this.stop(),this.h(),this},ct.prototype.Y=function(e){var t=this;return this.stop(),this.g=new wa(function(){t.h()}).Y(e),this},ct.prototype.Sa=function(e){var t=this;return this.stop(),this.g=new wa(function(){t.g.Y(e),t.h()}).Y(e),this},ct.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},he("shaka.util.Timer",ct),ct.prototype.stop=ct.prototype.stop,ct.prototype.tickEvery=ct.prototype.Sa,ct.prototype.tickAfter=ct.prototype.Y,ct.prototype.tickNow=ct.prototype.tc;function Wi(){var e=p.ManagedMediaSource||p.MediaSource;return!!(e&&e.isTypeSupported)}function Sa(e){return Mg().canPlayType(e)!=""}function Ta(){return!!navigator.userAgent.match(/Edge?\//)}function ro(){return Rt("Xbox One")}function so(){return Rt("Tizen")}function Ca(){return Rt("Tizen 3")}function su(){return Rt("Tizen 2")}function ao(){return Rt("Web0S")}function au(){return ao()&&xh()===38}function hi(){return Rt("CrKey")}function xh(){if(!Rt("Chrome")||navigator.userAgent.match(/Edge\//))return null;var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null}function Xr(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!so()&&!Rt("PC=EOS")&&!Rt("PC=APL")&&!Rt("VirginMedia")&&!wh()&&!lo()&&!Rt("AFT")&&!Rt("WPE")&&!Rt("DT_STB_BCM")}function lu(){return Rt("PlayStation 5")}function lo(){return Rt("PlayStation 4")}function uu(){return Rt("Hisense")||Rt("VIDAA")}function wh(){return Rt("SOPOpenBrowser")}function Wr(){if(!Xr())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function Sh(){return navigator.userAgentData&&navigator.userAgentData.platform?navigator.userAgentData.platform.toLowerCase()=="windows":navigator.platform?navigator.platform.toLowerCase().includes("windows"):!1}function fu(){return Rt("Android")}function Ig(){return!!(so()||ao()||ro()||lo()||lu()||Rt("AFT")||Rt("PC=EOS")||Rt("PC=APL")||Rt("VirginMedia")||wh()||Rt("WPE")||hi()||uu()||Rt("DT_STB_BCM"))}function Rt(e){return(navigator.userAgent||"").includes(e)}function Mg(){return qr||(Th||(Th=new ct(function(){qr=null})),(qr=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(qr=document.createElement("video")),Th.Y(1),qr)}function cu(e){return e?e===p.shakaMediaKeysPolyfill:!!p.shakaMediaKeysPolyfill}function Rg(){var e,t,n,i,s,l,u,c,d,g,y,w,C,T,A;return $(function(b){switch(b.g){case 1:if(e={width:1/0,height:1/0},hi()){if(w=p.cast&&cast.__platform__&&cast.__platform__.canDisplayType,e.width=1280,e.height=720,ue(b,15),!(C=w)){b.u(17);break}return E(b,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160'),18)}if(so()){e.width=1920,e.height=1080;try{webapis.systeminfo&&webapis.systeminfo.getMaxVideoResolution?(t=webapis.systeminfo.getMaxVideoResolution(),e.width=t.width,e.height=t.height):webapis.productinfo.is8KPanelSupported&&webapis.productinfo.is8KPanelSupported()?(e.width=7680,e.height=4320):webapis.productinfo.isUdPanelSupported&&webapis.productinfo.isUdPanelSupported()&&(e.width=3840,e.height=2160)}catch{Fe("Tizen: Error detecting screen size, default screen size 1920x1080.")}b.u(3);break}if(ro()){e.width=1920,e.height=1080;try{n=void 0,n=typeof Windows<"u"?Windows:chrome.webview.hostObjects.sync.Windows,i=new n.Media.Protection.ProtectionCapabilities,s=n.Media.Protection.ProtectionCapabilityResult,l=null;do l=i.isTypeSupported('video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',"com.microsoft.playready.recommendation");while(l===s.maybe);l===s.probably&&(e.width=3840,e.height=2160)}catch{Fe("Xbox: Error detecting screen size, default screen size 1920x1080.")}b.u(3);break}if(ao()){try{u=JSON.parse(p.PalmSystem.deviceInfo),e.width=Math.max(1920,u.screenWidth),e.height=Math.max(1080,u.screenHeight)}catch{Fe("WebOS: Error detecting screen size, default screen size 1920x1080."),e.width=1920,e.height=1080}b.u(3);break}if(uu()){p.Hisense_Get4KSupportState&&p.Hisense_Get4KSupportState()?(e.width=3840,e.height=2160):(e.width=1920,e.height=1080),b.u(3);break}if(!lo()&&!lu()){b.u(3);break}return c=!1,ue(b,9),E(b,p.msdk.device.getDisplayInfo(),11);case 11:d=b.h,c=d.resolution==="4K",ge(b,10);break;case 9:return ie(b),ue(b,12),E(b,p.msdk.device.getDisplayInfoImmediate(),14);case 14:g=b.h,c=g.resolution==="4K",ge(b,10);break;case 12:y=ie(b),Fe("PlayStation: Failed to get the display info:",y);case 10:c?(e.width=3840,e.height=2160):(e.width=1920,e.height=1080),b.u(3);break;case 18:C=b.h;case 17:if(C){e.width=3840,e.height=2160,b.u(19);break}if(!(T=w)){b.u(20);break}return E(b,cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=1920; height=1080'),21);case 21:T=b.h;case 20:T&&(e.width=1920,e.height=1080);case 19:ge(b,3);break;case 15:A=ie(b),Xe("Failed to check canDisplayType:",A);case 3:return b.return(e)}})}var Th=null,qr=null;function wr(){}function Vt(e){if(!e)return"";if(e=Ze(e),e[0]==239&&e[1]==187&&e[2]==191&&(e=e.subarray(3)),p.TextDecoder&&!lo())return e=new TextDecoder().decode(e),e.includes("�")&&Xe('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),e;for(var t="",n=0;n<e.length;++n){var i=65533;if(e[n]&128?e.length>=n+2&&(e[n]&224)==192&&(e[n+1]&192)==128?(i=(e[n]&31)<<6|e[n+1]&63,n+=1):e.length>=n+3&&(e[n]&240)==224&&(e[n+1]&192)==128&&(e[n+2]&192)==128?(i=(e[n]&15)<<12|(e[n+1]&63)<<6|e[n+2]&63,n+=2):e.length>=n+4&&(e[n]&241)==240&&(e[n+1]&192)==128&&(e[n+2]&192)==128&&(e[n+3]&192)==128&&(i=(e[n]&7)<<18|(e[n+1]&63)<<12|(e[n+2]&63)<<6|e[n+3]&63,n+=3):i=e[n],65535>=i)t+=String.fromCharCode(i);else{i-=65536;var s=i&1023;t+=String.fromCharCode(55296+(i>>10)),t+=String.fromCharCode(56320+s)}}return t}function xo(e,t,n){if(!e)return"";if(!n&&e.byteLength%2!=0)throw new K(2,2,2004);n=Math.floor(e.byteLength/2);var i=new Uint16Array(n);e=xn(e);for(var s=0;s<n;s++)i[s]=e.getUint16(2*s,t);return Eh(i)}function wo(e){function t(i){return n.byteLength<=i||32<=n[i]&&126>=n[i]}if(!e)return"";var n=Ze(e);if(n[0]==239&&n[1]==187&&n[2]==191)return Vt(n);if(n[0]==254&&n[1]==255)return xo(n.subarray(2),!1);if(n[0]==255&&n[1]==254)return xo(n.subarray(2),!0);if(n[0]==0&&n[2]==0)return xo(e,!1);if(n[1]==0&&n[3]==0)return xo(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return Vt(e);throw new K(2,2,2003)}function qi(e){if(p.TextEncoder&&!lo()){var t=new TextEncoder;return Pt(t.encode(e))}e=encodeURIComponent(e),e=unescape(e),t=new Uint8Array(e.length);for(var n=0;n<e.length;n++)t[n]=e[n].charCodeAt(0);return Pt(t)}function Ch(e,t){for(var n=new ArrayBuffer(2*e.length),i=new DataView(n),s=0;s<e.length;++s)i.setUint16(2*s,e.charCodeAt(s),t);return n}function Eh(e){return _g.value()(e)}function $n(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&nbsp;":" ","&lrm;":"‎","&rlm;":"‏"},n=/&(?:amp|lt|gt|quot|apos|nbsp|lrm|rlm|#[xX]?[0-9a-fA-F]+);/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,function(s){return s[1]=="#"?(s=s[2]=="x"||s[2]=="X"?parseInt(s.substring(3),16):parseInt(s.substring(2),10),0<=s&&1114111>=s?String.fromCodePoint(s):""):t[s]||"'"}):e||""}he("shaka.util.StringUtils",wr),wr.resetFromCharCode=function(){_g.g=void 0},wr.toUTF16=Ch,wr.toUTF8=qi,wr.fromBytesAutoDetect=wo,wr.fromUTF16=xo,wr.fromUTF8=Vt;var _g=new Gr(function(){function e(n){try{var i=new Uint8Array(n);return 0<String.fromCharCode.apply(null,i).length}catch{return!1}}for(var t={ac:65536};0<t.ac;t={ac:t.ac},t.ac/=2)if(e(t.ac))return function(n){return function(i){for(var s="",l=0;l<i.length;l+=n.ac)s+=String.fromCharCode.apply(null,i.subarray(l,l+n.ac));return s}}(t);return null});function _n(){}function Lg(e){return e=Eh(Ze(e)),btoa(e)}function Sr(e,t){return t=t??!0,e=Lg(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function Ti(e){e=p.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t}function Tr(e){for(var t=e.length/2,n=new Uint8Array(t),i=0;i<t;i++)n[i]=p.parseInt(e.substr(2*i,2),16);return n}function So(e){var t=Ze(e);e="",t=x(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n=n.toString(16),n.length==1&&(n="0"+n),e+=n;return e}function Qt(){for(var e=Pe.apply(0,arguments),t=0,n=0;n<e.length;++n)t+=e[n].byteLength;t=new Uint8Array(t);for(var i=n=0;i<e.length;++i){var s=e[i];s instanceof Uint8Array?t.set(s,n):t.set(Ze(s),n),n+=s.byteLength}return t}he("shaka.util.Uint8ArrayUtils",_n),_n.concat=Qt,_n.toHex=So,_n.fromHex=Tr,_n.fromBase64=Ti,_n.toBase64=Sr,_n.toStandardBase64=Lg;function Cn(e,t){if(t.length==0)return e;if(e.length==1&&t.length==1){var n=new tn(e[0]);return t=new tn(t[0]),[n.resolve(t).toString()]}t=t.map(function(u){return new tn(u)}),n=[],e=x(e);for(var i=e.next();!i.done;i=e.next()){i=new tn(i.value);for(var s=x(t),l=s.next();!l.done;l=s.next())n.push(i.resolve(l.value).toString())}return n}function Cr(e,t,n,i){return e={keySystem:e,encryptionScheme:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:n||[],keyIds:new Set},i&&(e.keySystemUris=new Set([i])),e}function Pg(e,t){t=t===void 0?"cenc":t;var n=[],i=[],s=[];e.forEach(function(u,c){var d=c;d.length!=22&&(d=Sr(Tr(c),!1));var g=u;g.length!=22&&(g=Sr(Tr(u),!1)),u={kty:"oct",kid:d,k:g},n.push(u),i.push(u.kid),s.push(c)}),e=JSON.stringify({keys:n});var l=JSON.stringify({kids:i});return l=[{initData:Ze(qi(l)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",encryptionScheme:t,licenseServerUri:"data:application/json;base64,"+p.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:l,keyIds:new Set(s)}}function Yr(e,t){if(t.length==1)return t[0];if(e=qn(e,t),e!=null)return e;throw new K(2,4,4025,t)}function qn(e,t){for(var n=x(Dg[e]),i=n.next();!i.done;i=n.next()){i=i.value;for(var s=x(t),l=s.next();!l.done;l=s.next())if(l=l.value,i.test(l.trim()))return l.trim()}return e==mt?"":null}function Ah(e,t){var n=[];e=x(Dg[e]);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var s=x(t),l=s.next();!l.done;l=s.next())l=l.value,i.test(l.trim())&&n.push(l.trim())}return n}var mt="text",sn={ga:"video",X:"audio",ua:mt,De:"image",gj:"application"},CT=1/15,Dg={audio:[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4/,/^dts[cex]$/,/^iamf/,/^mhm[12]/],video:[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/,/^dva/,/^dav/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function kh(){}function an(e,t){var n=e;return t&&!Xo.includes(e)&&(n+='; codecs="'+t+'"'),n}function Er(e,t){return t&&(e+='; codecs="'+t+'"'),e}function Kr(e,t,n){var i=an(e,t);return t=Er(e,t),zo(t)?(e=zo(t))?(e=e(),n=e.convertCodecs(n,t),e.destroy()):n=t:n=e!="video/mp2t"&&n=="audio"?i.replace("video","audio"):i,n}function ET(e,t,n){var i=[t];return AT.forEach(function(s,l){var u=e[l];l=="codecs"?Xo.includes(e.mimeType)||i.push('codecs="'+n+'"'):u&&i.push(s+'="'+u+'"')}),e.hdr=="PQ"&&i.push('eotf="smpte2084"'),i.join(";")}function hu(e){return e.split(";")[0].split("/")[1]}function Vn(e){var t=Og(e);switch(e=t[0],t=t[1].toLowerCase(),!0){case(e==="mp4a"&&t==="69"):case(e==="mp4a"&&t==="6b"):case(e==="mp4a"&&t==="40.34"):return"mp3";case(e==="mp4a"&&t==="66"):case(e==="mp4a"&&t==="67"):case(e==="mp4a"&&t==="68"):case(e==="mp4a"&&t==="40.2"):case(e==="mp4a"&&t==="40.02"):case(e==="mp4a"&&t==="40.5"):case(e==="mp4a"&&t==="40.05"):case(e==="mp4a"&&t==="40.29"):case(e==="mp4a"&&t==="40.42"):return"aac";case(e==="mp4a"&&t==="a5"):return"ac-3";case(e==="mp4a"&&t==="a6"):return"ec-3";case(e==="mp4a"&&t==="b2"):return"dtsx";case(e==="mp4a"&&t==="a9"):return"dtsc";case e==="avc1":case e==="avc3":return"avc";case e==="hvc1":case e==="hev1":return"hevc";case e==="vvc1":case e==="vvi1":return"vvc";case e==="dvh1":case e==="dvhe":return"dovi-hevc";case e==="dvav":case e==="dva1":return"dovi-avc";case e==="dav1":return"dovi-av1";case e==="dvc1":case e==="dvi1":return"dovi-vvc"}return e}function Zr(e){var t=[];e=x(e.split(","));for(var n=e.next();!n.done;n=e.next())n=Og(n.value),t.push(n[0]);return t.sort().join(",")}function Ni(e){return e.split(";")[0]}function di(e){return e=e.split(/ *; */),e.shift(),(e=e.find(function(t){return t.startsWith("codecs=")}))?e.split("=")[1].replace(/^"|"$/g,""):""}function Ng(e){return e==="application/x-mpegurl"||e==="application/vnd.apple.mpegurl"}function Og(e){e=e.split(".");var t=e[0];return e.shift(),[t,e.join(".")]}he("shaka.util.MimeUtils",kh),kh.getFullTypeWithAllCodecs=Er,kh.getFullType=an;var AT=new Map().set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels"),Xo=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function To(e){this.i=null,this.j=e,this.B=!1,this.l=this.s=0,this.m=1/0,this.h=this.g=null,this.C="",this.A=function(){},this.o=new Map}function Ea(e){return ln[e]?!0:e=="application/cea-608"||e=="application/cea-708"?!!zi:!1}To.prototype.destroy=function(){return this.j=this.i=null,this.o.clear(),Promise.resolve()};function kT(e,t,n,i,s){var l,u,c,d,g,y,w;return $(function(C){if(C.g==1)return E(C,Promise.resolve(),2);if(!e.i||!e.j)return C.return();if(n==null||i==null)return e.i.parseInit(Ze(t)),C.return();for(l=e.B?n:e.s,u={periodStart:e.s,segmentStart:n,segmentEnd:i,vttOffset:l},c=e.i.parseMedia(Ze(t),u,s),d=x(c),g=d.next();!g.done;g=d.next())y=g.value,e.A(y,s||null,u);w=c.filter(function(T){return T.startTime>=e.l&&T.startTime<e.m}),e.j.append(w),e.g==null&&(e.g=Math.max(n,e.l)),e.h=Math.min(i,e.m),F(C)})}To.prototype.remove=function(e,t){var n=this;return $(function(i){if(i.g==1)return E(i,Promise.resolve(),2);!n.j||!n.j.remove(e,t)||n.g==null||t<=n.g||e>=n.h||(e<=n.g&&t>=n.h?n.g=n.h=null:e<=n.g&&t<n.h?n.g=t:e>n.g&&t>=n.h&&(n.h=e)),F(i)})};function bT(e,t,n){e.l=t,e.m=n}function Ug(e,t,n){if(e.C=t,t=e.o.get(t))for(var i=x(t.keys()),s=i.next();!s.done;s=i.next())(s=t.get(s.value).filter(function(l){return l.endTime<=n}))&&e.j.append(s)}function Bg(e,t,n){t.startTime+=n,t.endTime+=n,t=x(t.nestedCues);for(var i=t.next();!i.done;i=t.next())Bg(e,i.value,n)}function IT(e,t,n,i,s){var l=n+" "+i,u=new Map;t=x(t);for(var c=t.next();!c.done;c=t.next()){var d=c.value;c=d.stream,d=d.cue,u.has(c)||u.set(c,new Map),u.get(c).has(l)||u.get(c).set(l,[]),Bg(e,d,s),d.startTime>=e.l&&d.startTime<e.m&&(u.get(c).get(l).push(d),c==e.C&&e.j.append([d]))}for(s=x(u.keys()),l=s.next();!l.done;l=s.next())for(l=l.value,e.o.has(l)||e.o.set(l,new Map),t=x(u.get(l).keys()),c=t.next();!c.done;c=t.next())c=c.value,d=u.get(l).get(c),e.o.get(l).set(c,d);e.g=e.g==null?Math.max(n,e.l):Math.min(e.g,Math.max(n,e.l)),e.h=Math.max(e.h,Math.min(i,e.m))}he("shaka.text.TextEngine",To),To.prototype.destroy=To.prototype.destroy,To.findParser=function(e){return ln[e]},To.unregisterParser=function(e){delete ln[e]},To.registerParser=function(e,t){ln[e]=t};var ln={};function MT(e,t){return e.concat(t)}function jg(){}function Ar(e){return e!=null}function Oi(){}function Qr(e,t){return e=It(e),t=It(t),e.split("-")[0]==t.split("-")[0]}function Aa(e,t){return e=It(e),t=It(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&e.length==1&&t.length==2}function bh(e,t){return e=It(e),t=It(t),e=e.split("-"),t=t.split("-"),e.length==2&&t.length==2&&e[0]==t[0]}function It(e){e=x(e.split("-x-"));var t=e.next().value;t=t===void 0?"":t,e=e.next().value,e=e===void 0?"":e;var n=x(t.split("-"));return t=n.next().value,t=t===void 0?"":t,n=n.next().value,n=n===void 0?"":n,e=e?"x-"+e:"",t=t.toLowerCase(),t=Fg.get(t)||t,n=n.toUpperCase(),(n?t+"-"+n:t)+(e?"-"+e:"")}function kr(e,t){return e=It(e),t=It(t),t==e?4:Aa(t,e)?3:bh(t,e)?2:Aa(e,t)?1:0}function Ih(e){var t=e.indexOf("-");return e=0<=t?e.substring(0,t):e,e=e.toLowerCase(),e=Fg.get(e)||e}function Mh(e){return e.language?It(e.language):e.audio&&e.audio.language?It(e.audio.language):e.video&&e.video.language?It(e.video.language):"und"}function du(e,t){e=It(e);var n=new Set;t=x(t);for(var i=t.next();!i.done;i=t.next())n.add(It(i.value));for(t=x(n),i=t.next();!i.done;i=t.next())if(i=i.value,i==e)return i;for(t=x(n),i=t.next();!i.done;i=t.next())if(i=i.value,Aa(i,e))return i;for(t=x(n),i=t.next();!i.done;i=t.next())if(i=i.value,bh(i,e))return i;for(n=x(n),t=n.next();!t.done;t=n.next())if(t=t.value,Aa(e,t))return t;return null}he("shaka.util.LanguageUtils",Oi),Oi.findClosestLocale=du,Oi.getLocaleForVariant=Mh,Oi.getLocaleForText=function(e){return It(e.language||"und")},Oi.getBase=Ih,Oi.relatedness=kr,Oi.areSiblings=function(e,t){var n=Ih(e),i=Ih(t);return e!=n&&t!=i&&n==i},Oi.normalize=It,Oi.isSiblingOf=bh,Oi.isParentOf=Aa,Oi.areLanguageCompatible=Qr,Oi.areLocaleCompatible=function(e,t){return e=It(e),t=It(t),e==t};var Fg=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function uo(e){function t(i){switch(typeof i){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return i;default:if(!i||i.buffer instanceof ArrayBuffer)return i;if(n.has(i))return null;var s=i.constructor==Array;if(i.constructor!=Object&&!s)return null;n.add(i);var l=s?[]:{},u;for(u in i)l[u]=t(i[u]);return s&&(l.length=i.length),l}}var n=new WeakSet;return t(e)}function Rh(e){var t={},n;for(n in e)t[n]=e[n];return t}function $g(){}function Vg(e,t,n,i){var s=e.variants;if((t.length||n.length)&&(s=RT(s,t,n)),i.length){for(t=new Sn,s=x(s),n=s.next();!n.done;n=s.next())n=n.value,t.push(String(n.video.width||0),n);var l=[];t.forEach(function(A,b){A=0;var k=[];b=x(b);for(var O=b.next(),D={};!O.done;D={Ae:void 0},O=b.next())D.Ae=O.value,O=i.filter(function(z){return function(P){return z.Ae.decodingInfos[0][P]}}(D)).length,O>A?(A=O,k=[D.Ae]):O==A&&k.push(D.Ae);l.push.apply(l,L(k))}),s=l}n=new Set,t=new Set,s=x(s);for(var u=s.next();!u.done;u=s.next())u=u.value,u.audio&&n.add(u.audio),u.video&&t.add(u.video);n=Array.from(n).sort(function(A,b){return A.bandwidth-b.bandwidth});var c=[];for(s=new Map,n=x(n),u=n.next();!u.done;u=n.next()){u=u.value;var d=u.language+(u.channelsCount||0)+(u.audioSamplingRate||0)+u.roles.join(",")+u.label+u.groupId+u.fastSwitching,g=s.get(d)||[];if(g.length){var y=g[g.length-1],w=Vn(y.codecs),C=Vn(u.codecs);w!=C||u.bandwidth&&y.bandwidth&&!(u.bandwidth>y.bandwidth)||(g.push(u),c.push(u.id))}else g.push(u),c.push(u.id);s.set(d,g)}n=Array.from(t).sort(function(A,b){return A.bandwidth&&b.bandwidth?A.bandwidth-b.bandwidth:A.width-b.width}),t=ut();var T=[];for(s=new Map,n=x(n),u=n.next();!u.done;u=n.next()){if(u=u.value,d=Math.round(u.frameRate||0)+(u.hdr||"")+u.fastSwitching,g=s.get(d)||[],g.length){if(y=g[g.length-1],!t&&(w=Vn(y.codecs),C=Vn(u.codecs),w!==C))continue;u.width>y.width||u.height>y.height?(g.push(u),T.push(u.id)):u.width==y.width&&u.height==y.height&&(w=Vn(y.codecs),C=Vn(u.codecs),w!=C||u.bandwidth&&y.bandwidth&&!(u.bandwidth>y.bandwidth)||(g.push(u),T.push(u.id)))}else g.push(u),T.push(u.id);s.set(d,g)}e.variants=e.variants.filter(function(A){var b=A.audio;return A=A.video,!(b&&!c.includes(b.id)||A&&!T.includes(A.id))})}function RT(e,t,n){t=x(t);for(var i=t.next(),s={};!i.done;s={oh:void 0},i=t.next())if(s.oh=i.value,i=e.filter(function(l){return function(u){return u.video&&u.video.codecs.startsWith(l.oh)}}(s)),i.length){e=i;break}for(n=x(n),t=n.next(),i={};!t.done;i={ig:void 0},t=n.next())if(i.ig=t.value,t=e.filter(function(l){return function(u){return u.audio&&u.audio.codecs.startsWith(l.ig)}}(i)),t.length){e=t;break}return e}function _T(e,t,n){e.variants=e.variants.filter(function(i){return pu(i,t,n)})}function pu(e,t,n){function i(c,d,g){return c>=d&&c<=g}var s=e.video;if(s&&s.width&&s.height){var l=s.width,u=s.height;if(u>l&&(u=x([u,l]),l=u.next().value,u=u.next().value),!i(l,t.minWidth,Math.min(t.maxWidth,n.width))||!i(u,t.minHeight,Math.min(t.maxHeight,n.height))||!i(s.width*s.height,t.minPixels,t.maxPixels))return!1}return!(e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||e&&e.audio&&e.audio.channelsCount&&!i(e.audio.channelsCount,t.minChannelsCount,t.maxChannelsCount)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function Hg(e,t,n){var i=!1;e=x(e);for(var s=e.next();!s.done;s=e.next()){s=s.value;var l=s.allowedByApplication;s.allowedByApplication=pu(s,t,n),l!=s.allowedByApplication&&(i=!0)}return i}function LT(e,t,n){return n=n===void 0?[]:n,$(function(i){return i.g==1?E(i,zg(e,t,0<t.offlineSessionIds.length,n),2):(OT(t),E(i,UT(t),0))})}function zg(e,t,n,i){var s,l;return $(function(u){if(u.g==1)return ro()&&PT(t.variants),E(u,Wg(t.variants,n,!1,i),2);s=null,e&&(l=e.g)&&(s=l.keySystem),t.variants=t.variants.filter(function(c){var d=DT(c,s);if(!d){var g=[];c.audio&&g.push(Qg(c.audio)),c.video&&g.push(Qg(c.video))}return d}),F(u)})}function PT(e){var t={dvav:"avc3",dva1:"avc1",dvhe:"hev1",dvh1:"hvc1",dvc1:"vvc1",dvi1:"vvi1"},n=new Set;e=x(e);for(var i=e.next();!i.done;i=e.next())i=i.value,i.video&&n.add(i.video);for(n=x(n),e=n.next();!e.done;e=n.next()){e=e.value,i=x(Object.keys(t));for(var s=i.next();!s.done;s=i.next())if(s=s.value,e.codecs.includes(s)){e.codecs=e.codecs.replace(s,t[s]);break}}}function DT(e,t){var n=ro(),i=Rt("Firefox")&&fu(),s=e.video,l=s&&s.width||0,u=s&&s.height||0;if(n&&s&&(1920<l||1080<u)&&(s.codecs.includes("avc1.")||s.codecs.includes("avc3.")))return!1;if(s){if(n=ka(s.codecs),s.codecs.includes(",")){if(l=s.codecs.split(","),n=Yr("video",l),n=ka(n),l=Yr("audio",l),l=Jr(l,s.mimeType),u=Kr(s.mimeType,l,"audio"),!Lt(u))return!1;n=[n,l].join()}if(l=Kr(s.mimeType,n,"video"),!Lt(l))return!1;s.codecs=n}if(s=e.audio,i&&s&&s.encrypted&&s.codecs.toLowerCase().includes("opus"))return!1;if(s){if(i=Jr(s.codecs,s.mimeType),n=Kr(s.mimeType,i,"audio"),!Lt(n))return!1;s.codecs=i}return e.decodingInfos.some(function(c){return!(!c.supported||t&&(c=c.keySystemAccess)&&c.keySystem!=t)})}function Gg(e){var t=[];for(n in e)t.push(n);t.sort();var n=[];t=x(t);for(var i=t.next();!i.done;i=t.next()){var s=i.value;i=JSON.stringify(s),s=e[s],s instanceof Object?(s=Gg(s),n.push(i+":"+s)):(s=JSON.stringify(s),n.push(i+":"+s))}return"{"+n.join(",")+"}"}function Xg(e,t){var n,i,s,l,u,c,d;return $(function(g){if(g.g==1){for(n=function(y,w){if(y){var C=Rh(y);return C.supported=y.supported&&w.supported,C.powerEfficient=y.powerEfficient&&w.powerEfficient,C.smooth=y.smooth&&w.smooth,w.keySystemAccess&&!C.keySystemAccess&&(C.keySystemAccess=w.keySystemAccess),C}return w},i=null,s=[],l=x(t),u=l.next(),c={};!u.done;c={cache:void 0,Dd:void 0},u=l.next())d=u.value,c.Dd=Gg(d),c.cache=Jg,c.cache[c.Dd]?i=n(i,c.cache[c.Dd]):s.push(NT(d).then(function(y){return function(w){var C=null;w=x(w||[]);for(var T=w.next();!T.done;T=w.next())C=n(C,T.value);C&&(y.cache[y.Dd]=C,i=n(i,C))}}(c)));return E(g,Promise.all(s),2)}i&&e.decodingInfos.push(i),F(g)})}function NT(e){var t=[""];e.video&&(t=di(e.video.contentType).split(","));var n=[""];e.audio&&(n=di(e.audio.contentType).split(","));var i=[];t=x(t);for(var s=t.next();!s.done;s=t.next()){s=s.value;for(var l=x(n),u=l.next(),c={};!u.done;c={xc:void 0},u=l.next())u=u.value,c.xc=uo(e),e.video&&(c.xc.video.contentType=an(Ni(c.xc.video.contentType),s)),e.audio&&(c.xc.audio.contentType=an(Ni(c.xc.audio.contentType),u)),i.push(new Promise(function(d){return function(g,y){navigator.mediaCapabilities.decodingInfo(d.xc).then(function(w){g(w)}).catch(y)}}(c)))}return Promise.all(i).catch(function(){return JSON.stringify(e),null})}function Wg(e,t,n,i){var s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B;return $(function(G){switch(G.g){case 1:if(e.some(function(q){return q.decodingInfos.length}))return G.return();s=x(i),l=s.next(),u={};case 2:if(l.done){G.u(4);break}u.Qg=l.value,c=!1,d=x(e),g=d.next();case 5:if(g.done){G.u(7);break}y=g.value,w=qg(y,t,n).filter(function(q){return function(J){return J=J[0],(J.keySystemConfiguration&&J.keySystemConfiguration.keySystem)===q.Qg}}(u)),C=x(w),T=C.next();case 8:if(T.done){G.u(10);break}return A=T.value,E(G,Xg(y,A),9);case 9:T=C.next(),G.u(8);break;case 10:y.decodingInfos.length&&(c=!0),g=d.next(),G.u(5);break;case 7:if(c)return G.return();u={Qg:void 0},l=s.next(),G.u(2);break;case 4:b=x(e),k=b.next();case 12:if(k.done){G.u(0);break}O=k.value,D=qg(O,t,n).filter(function(q){return q=q[0],q=q.keySystemConfiguration&&q.keySystemConfiguration.keySystem,!q||!i.includes(q)}),z=x(D),P=z.next();case 15:if(P.done){k=b.next(),G.u(12);break}return B=P.value,E(G,Xg(O,B),16);case 16:P=z.next(),G.u(15)}})}function qg(e,t,n){var i=e.audio,s=e.video,l=[],u=[];if(s)for(var c=x(s.fullMimeTypes),d=c.next();!d.done;d=c.next()){d=d.value;var g=di(d);if(g.includes(",")&&!i){var y=g.split(","),w=Ni(d);g=Yr("video",y),y=Yr("audio",y),y=Jr(y,w),w=Kr(w,y,"audio"),u.push({contentType:w,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1})}if(g=ka(g),d={contentType:Kr(Ni(d),g,"video"),width:s.width||64,height:s.height||64,bitrate:s.bandwidth||e.bandwidth||1,framerate:s.frameRate||1},s.hdr)switch(s.hdr){case"SDR":d.transferFunction="srgb";break;case"PQ":d.transferFunction="pq";break;case"HLG":d.transferFunction="hlg"}s.colorGamut&&(d.colorGamut=s.colorGamut),l.push(d)}if(i)for(c=x(i.fullMimeTypes),d=c.next();!d.done;d=c.next())g=d.value,d=Ni(g),g=Jr(di(g),d),d=Kr(d,g,"audio"),u.push({contentType:d,channels:i.channelsCount||2,bitrate:i.bandwidth||e.bandwidth||1,samplerate:i.audioSamplingRate||1,spatialRendering:i.spatialAudio});for(c=[],l.length==0&&l.push(null),u.length==0&&u.push(null),l=x(l),d=l.next();!d.done;d=l.next())for(d=d.value,g=x(u),w=g.next();!w.done;w=g.next())w=w.value,y={type:n?"file":"media-source"},d&&(y.video=d),w&&(y.audio=w),c.push(y);if(u=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]),!u.length)return[c];for(e=[],n=new Map,u=x(u),l=u.next();!l.done;l=u.next())l=l.value,n.get(l.keySystem)||n.set(l.keySystem,[]),n.get(l.keySystem).push(l);for(u=t?"required":"optional",t=t?["persistent-license"]:["temporary"],l=x(n.keys()),d=l.next();!d.done;d=l.next()){for(d=d.value,g=[],w=x(c),y=w.next();!y.done;y=w.next()){y=Object.assign({},y.value);var C=n.get(d),T={keySystem:d,initDataType:"cenc",persistentState:u,distinctiveIdentifier:"optional",sessionTypes:t};C=x(C);for(var A=C.next();!A.done;A=C.next()){if(A=A.value,A.initData&&A.initData.length){for(var b=new Set,k=x(A.initData),O=k.next();!O.done;O=k.next())b.add(O.value.initDataType);T.initDataType=A.initData[0].initDataType}A.distinctiveIdentifierRequired&&(T.distinctiveIdentifier="required"),A.persistentStateRequired&&(T.persistentState="required"),A.sessionType&&(T.sessionTypes=[A.sessionType]),i&&(T.audio?(A.encryptionScheme&&(T.audio.encryptionScheme=T.audio.encryptionScheme||A.encryptionScheme),T.audio.robustness=T.audio.robustness||A.audioRobustness):(T.audio={robustness:A.audioRobustness},A.encryptionScheme&&(T.audio.encryptionScheme=A.encryptionScheme)),T.audio.robustness==""&&delete T.audio.robustness),s&&(T.video?(A.encryptionScheme&&(T.video.encryptionScheme=T.video.encryptionScheme||A.encryptionScheme),T.video.robustness=T.video.robustness||A.videoRobustness):(T.video={robustness:A.videoRobustness},A.encryptionScheme&&(T.video.encryptionScheme=A.encryptionScheme)),T.video.robustness==""&&delete T.video.robustness)}y.keySystemConfiguration=T,g.push(y)}e.push(g)}return e}function Jr(e,t){return e.toLowerCase()=="flac"?Wr()?"fLaC":"flac":e.toLowerCase()==="opus"?Wr()&&hu(t)=="mp4"?"Opus":"opus":e}function ka(e){if(e.includes("avc1")){var t=e.split(".");if(t.length==3)return e=t.shift()+".",e+=parseInt(t.shift(),10).toString(16),e+=("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if(e=="vp9")return"vp09.00.41.08";return e}function OT(e){e.textStreams=e.textStreams.filter(function(t){return t=an(t.mimeType,t.codecs),Ea(t)})}function UT(e){var t,n,i,s,l,u,c;return $(function(d){switch(d.g){case 1:t=[],n=x(e.imageStreams),i=n.next();case 2:if(i.done){d.u(4);break}if(s=i.value,l=s.mimeType,l=="application/mp4"&&s.codecs=="mjpg"&&(l="image/jpg"),yu.has(l)){d.u(5);break}if(u=FT.get(l),!u){yu.set(l,!1),d.u(5);break}return E(d,BT(u),7);case 7:c=d.h,yu.set(l,c);case 5:yu.get(l)&&t.push(s),i=n.next(),d.u(2);break;case 4:e.imageStreams=t,F(d)}})}function BT(e){return new Promise(function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then(function(){t(!0)}).catch(function(){t(!1)}):n.onload=n.onerror=function(){t(n.height===2)}})}function es(e){var t=e.audio,n=e.video,i=t?t.mimeType:null,s=n?n.mimeType:null,l=t?t.codecs:null,u=n?n.codecs:null,c=[];u&&c.push(u),l&&c.push(l);var d=[];n&&d.push(n.mimeType),t&&d.push(t.mimeType),d=d[0]||null;var g=[];t&&g.push(t.kind),n&&g.push(n.kind),g=g[0]||null;var y=new Set;if(t)for(var w=x(t.roles),C=w.next();!C.done;C=w.next())y.add(C.value);if(n)for(w=x(n.roles),C=w.next();!C.done;C=w.next())y.add(C.value);return e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:g,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:d,audioMimeType:i,videoMimeType:s,codecs:c.join(", "),audioCodec:l,videoCodec:u,primary:e.primary,roles:Array.from(y),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null,e.hdr=n.hdr||null,e.colorGamut=n.colorGamut||null,e.videoLayout=n.videoLayout||null,u.includes(",")&&(e.channelsCount=n.channelsCount,e.audioSamplingRate=n.audioSamplingRate,e.spatialAudio=n.spatialAudio,e.originalLanguage=n.originalLanguage)),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage),e}function gu(e){return{id:e.id,active:!1,type:mt,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null,accessibilityPurpose:e.accessibilityPurpose,originalLanguage:e.originalLanguage}}function _h(e){var t=e.width||null,n=e.height||null,i=null;e.segmentIndex&&(i=e.segmentIndex.get(0));var s=e.tilesLayout;return i&&(s=i.tilesLayout||s),s&&t!=null&&(t/=Number(s.split("x")[0])),s&&n!=null&&(n/=Number(s.split("x")[1])),{id:e.id,active:!1,type:"image",bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:t,height:n,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:s||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId,accessibilityPurpose:null,originalLanguage:null}}function Lh(e){return e.__shaka_id||(e.__shaka_id=jT++),e.__shaka_id}function Yg(e){var t=Kg(e);return t.active=e.mode!="disabled",t.type="text",t.originalTextId=e.id,e.kind=="captions"&&(t.mimeType="unknown"),e.kind=="subtitles"&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),e.kind=="forced"&&(t.forced=!0),t}function Ph(e){var t=Kg(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,e.kind=="main"&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t}function Kg(e){var t=e.language;return{id:Lh(e),active:!1,type:"",bandwidth:0,language:It(t||"und"),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,colorGamut:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:t}}function ba(e){return e.allowedByApplication&&e.allowedByKeySystem&&e.disabledUntilTime==0}function mu(e){return e.filter(function(t){return ba(t)})}function Ia(e,t,n,i){var s=e,l=e.filter(function(d){return d.primary});l.length&&(s=l);var u=s.length?s[0].language:"";if(s=s.filter(function(d){return d.language==u}),t){var c=du(It(t),e.map(function(d){return d.language}));c&&(s=e.filter(function(d){return It(d.language)==c}))}if(s=s.filter(function(d){return d.forced==i}),n){if(e=Zg(s,n),e.length)return e}else if(e=s.filter(function(d){return d.roles.length==0}),e.length)return e;return e=s.map(function(d){return d.roles}).reduce(MT,[]),e.length?Zg(s,e[0]):s}function Zg(e,t){return e.filter(function(n){return n.roles.includes(t)})}function Qg(e){return e.type=="audio"?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:e.type=="video"?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}he("shaka.util.StreamUtils",$g),$g.meetsRestrictions=pu;var Jg={},jT=0,yu=new Map().set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),FT=new Map().set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function zt(){var e=this;this.A=null,this.j=!1,this.i=new be,this.F=new lt,navigator.connection&&navigator.connection.addEventListener&&this.F.D(navigator.connection,"change",function(){if(e.j&&e.g.useNetworkInformation){e.i=new be,e.g&&e.i.configure(e.g.advanced);var t=e.chooseVariant();t&&navigator.onLine&&e.A(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}}),this.s=[],this.B=1,this.G=!1,this.h=this.o=this.g=this.l=null,this.C=new ct(function(){if(e.j&&e.g.restrictToElementSize){var t=e.chooseVariant();t&&e.A(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch)}}),this.m=null}a=zt.prototype,a.stop=function(){this.A=null,this.j=!1,this.s=[],this.B=1,this.o=this.l=null,this.h&&(this.h.disconnect(),this.h=null),this.C.stop(),this.m=null},a.release=function(){this.F.release(),this.C=null},a.init=function(e){this.A=e},a.chooseVariant=function(){var e=1/0,t=1/0;if(this.g.restrictToScreenSize){var n=this.g.ignoreDevicePixelRatio?1:p.devicePixelRatio;e=p.screen.height*n,t=p.screen.width*n}this.h&&this.g.restrictToElementSize&&(n=this.g.ignoreDevicePixelRatio?1:p.devicePixelRatio,e=Math.min(e,this.o.clientHeight*n),t=Math.min(t,this.o.clientWidth*n)),n=this.s.filter(function(g){return g&&!(g.audio&&g.audio.fastSwitching||g.video&&g.video.fastSwitching)}),n.length||(n=this.s);var i=n;if(n.length!=this.s.length&&(i=this.s.filter(function(g){return g&&!!(g.audio&&g.audio.fastSwitching||g.video&&g.video.fastSwitching)})),n=Dh(this,this.g.restrictions,i,1/0,1/0),e!=1/0||t!=1/0){n=$T(n),n=x(n);for(var s=n.next();!s.done;s=n.next())if(s=s.value,s.height>=e&&s.width>=t){e=s.height,t=s.width;break}n=Dh(this,this.g.restrictions,i,e,t)}for(e=this.getBandwidthEstimate(),i.length&&!n.length&&(n=Dh(this,null,i,1/0,1/0),n=[n[0]]),t=n[0]||null,i=0;i<n.length;i++){s=n[i];for(var l=isNaN(this.B)?1:Math.abs(this.B),u=l*s.bandwidth/this.g.bandwidthDowngradeTarget,c={bandwidth:1/0},d=i+1;d<n.length;d++)if(s.bandwidth!=n[d].bandwidth){c=n[d];break}l=l*c.bandwidth/this.g.bandwidthUpgradeTarget,e>=u&&e<=l&&(t.bandwidth!=s.bandwidth||t.bandwidth==s.bandwidth&&t.video&&s.video&&(t.video.width<s.video.width||t.video.height<s.video.height))&&(t=s)}return this.l=Date.now(),t},a.enable=function(){this.j=!0},a.disable=function(){this.j=!1},a.segmentDownloaded=function(e,t,n){e<this.g.cacheLoadThreshold||(this.i.sample(e,t),n&&this.l!=null&&this.j&&em(this))},a.trySuggestStreams=function(){this.l!=null&&this.j&&em(this)},a.getBandwidthEstimate=function(){var e=this.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.g.useNetworkInformation&&(e=1e6*navigator.connection.downlink),e=this.i.getBandwidthEstimate(e),this.m?this.m.getBandwidthEstimate(e):e},a.setVariants=function(e){this.s=e},a.playbackRateChanged=function(e){this.B=e},a.setMediaElement=function(e){var t=this;this.o=e,this.h&&(this.h.disconnect(),this.h=null),this.o&&"ResizeObserver"in p&&(this.h=new ResizeObserver(function(){t.C.Y(VT)}),this.h.observe(this.o))},a.setCmsdManager=function(e){this.m=e},a.configure=function(e){this.g=e,this.i&&this.g&&this.i.configure(this.g.advanced)};function em(e){if(!e.G){var t=e.i;if(!(t.g>=t.i))return;e.G=!0,e.l-=1e3*(e.g.switchInterval-e.g.minTimeToSwitch)}Date.now()-e.l<1e3*e.g.switchInterval||(t=e.chooseVariant(),e.getBandwidthEstimate(),t&&e.A(t,e.g.clearBufferSwitch,e.g.safeMarginSwitch))}function Dh(e,t,n,i,s){if(e.m){var l=e.m.zg();l&&(n=n.filter(function(u){return u.bandwidth&&l?u.bandwidth<=l:!0}))}return t&&(n=n.filter(function(u){return pu(u,t,{width:s,height:i})})),n.sort(function(u,c){return u.bandwidth-c.bandwidth})}function $T(e){var t=[];e=x(e);for(var n=e.next();!n.done;n=e.next())(n=n.value.video)&&n.height&&n.width&&t.push({height:n.height,width:n.width});return t.sort(function(i,s){return i.width-s.width})}he("shaka.abr.SimpleAbrManager",zt),zt.prototype.configure=zt.prototype.configure,zt.prototype.setCmsdManager=zt.prototype.setCmsdManager,zt.prototype.setMediaElement=zt.prototype.setMediaElement,zt.prototype.playbackRateChanged=zt.prototype.playbackRateChanged,zt.prototype.setVariants=zt.prototype.setVariants,zt.prototype.getBandwidthEstimate=zt.prototype.getBandwidthEstimate,zt.prototype.trySuggestStreams=zt.prototype.trySuggestStreams,zt.prototype.segmentDownloaded=zt.prototype.segmentDownloaded,zt.prototype.disable=zt.prototype.disable,zt.prototype.enable=zt.prototype.enable,zt.prototype.chooseVariant=zt.prototype.chooseVariant,zt.prototype.init=zt.prototype.init,zt.prototype.release=zt.prototype.release,zt.prototype.stop=zt.prototype.stop;var VT=1;he("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),he("shaka.config.CodecSwitchingStrategy",{RELOAD:"reload",SMOOTH:"smooth"});function vu(e,t,n,i){for(n=n===void 0?!0:n,i=i===void 0?!1:i,this.h=e,this.g=new Set([e]),t=t||[],e=x(t),t=e.next();!t.done;t=e.next())this.add(t.value,n,i)}vu.prototype.add=function(e,t,n){return tm(this.h,e,t===void 0?!0:t,n===void 0?!1:n)?(this.g.add(e),!0):!1};function tm(e,t,n,i){var s;if(!(s=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(s=e.audio&&t.audio)){s=e.audio;var l=t.audio;s=!!((!s.channelsCount||!l.channelsCount||2<s.channelsCount||2<l.channelsCount)&&s.channelsCount!=l.channelsCount||s.spatialAudio!==l.spatialAudio||n&&!nm(s,l)||!im(s.roles,l.roles)||i&&s.groupId!==l.groupId)}return!(i=s)&&(i=e.video&&t.video)&&(e=e.video,t=t.video,i=!((!n||nm(e,t))&&im(e.roles,t.roles))),!i}vu.prototype.values=function(){return this.g.values()};function nm(e,t){if(e.mimeType!=t.mimeType||(e=e.codecs.split(",").map(function(i){return Zr(i)}),t=t.codecs.split(",").map(function(i){return Zr(i)}),e.length!=t.length))return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function im(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;e=x(e);for(var n=e.next();!n.done;n=e.next())if(!t.has(n.value))return!1;return!0}function om(e,t,n){t=t===void 0?"reload":t,n=n===void 0?!1:n,this.i=e,this.h=t,this.g=n,this.j=new ts(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"",!1,"","","",t,n)}om.prototype.create=function(e){var t=this,n=this.h=="smooth"&&ut(),i=e.filter(function(s){return tm(t.i,s,!n,t.g)});return i.length?new vu(i[0],i,!n,this.g):this.j.create(e)};function ts(e,t,n,i,s,l,u,c,d,g,y){this.A=e,this.B=t,this.i=n,this.j=i,this.C=s,this.m=l,this.h=u===void 0?"":u,this.l=c===void 0?"":c,this.o=d===void 0?"reload":d,this.s=g===void 0?!1:g,this.g=y===void 0?"":y}ts.prototype.create=function(e){var t=[];t=HT(e,this.A);var n=e.filter(function(i){return i.primary});return t=t.length?t:n.length?n:e,e=zT(t,this.B),e.length&&(t=e),this.m&&(e=YT(t,this.m),e.length&&(t=e)),this.j&&(e=qT(t,this.j),e.length&&(t=e)),this.i&&(e=WT(t,this.i),e.length&&(t=e)),this.h&&(e=GT(t,this.h),e.length&&(t=e)),this.l&&(e=XT(t,this.l),e.length&&(t=e)),e=KT(t,this.C),e.length&&(t=e),this.g&&(e=ZT(t,this.g),e.length&&(t=e)),new vu(t[0],t,!(this.o=="smooth"&&ut()),this.s)};function HT(e,t){t=It(t);var n=du(t,e.map(function(i){return Mh(i)}));return n?e.filter(function(i){return n==Mh(i)}):[]}function zT(e,t){return e.filter(function(n){return n.audio?t?n.audio.roles.includes(t):n.audio.roles.length==0:!1})}function GT(e,t){return e.filter(function(n){return n.audio&&n.audio.label?n.audio.label.toLowerCase()==t.toLowerCase():!1})}function XT(e,t){return e.filter(function(n){return n.video&&n.video.label?n.video.label.toLowerCase()==t.toLowerCase():!1})}function WT(e,t){return e.filter(function(n){return!(n.audio&&n.audio.channelsCount&&n.audio.channelsCount!=t)})}function qT(e,t){return t=="AUTO"&&(t=p.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR"),e.filter(function(n){return!(n.video&&n.video.hdr&&n.video.hdr!=t)})}function YT(e,t){return e.filter(function(n){return!(n.video&&n.video.videoLayout&&n.video.videoLayout!=t)})}function KT(e,t){return e.filter(function(n){return!(n.audio&&n.audio.spatialAudio!=t)})}function ZT(e,t){return e.filter(function(n){return!(n.audio&&n.audio.codecs!=t)})}function QT(){this.g=Ma,this.i=new Map().set(Ma,2).set(ns,1),this.h=0}function rm(e,t,n){e.i.set(Ma,n).set(ns,t)}var ns=0,Ma=1;function sm(e,t){var n=Yi();this.l=e.maxAttempts==null?n.maxAttempts:e.maxAttempts,this.j=e.baseDelay==null?n.baseDelay:e.baseDelay,this.o=e.fuzzFactor==null?n.fuzzFactor:e.fuzzFactor,this.m=e.backoffFactor==null?n.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=t===void 0?!1:t)&&(this.g=1)}function am(e){var t,n;return $(function(i){if(i.g==1){if(e.g>=e.l)if(e.i)e.g=1,e.h=e.j;else throw new K(2,7,1010);return t=e.g,e.g++,t==0?i.return():(n=e.h*(1+(2*Math.random()-1)*e.o),E(i,new Promise(function(s){new ct(s).Y(n/1e3)}),2))}e.h*=e.m,F(i)})}function Yi(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}}function _t(){var e,t,n=new Promise(function(i,s){e=i,t=s});return n.resolve=e,n.reject=t,n}_t.prototype.resolve=function(){},_t.prototype.reject=function(){};function nn(e,t){this.promise=e,this.i=t,this.g=!1}function br(e){return new nn(Promise.reject(e),function(){return Promise.resolve()})}function Nh(){var e=Promise.reject(new K(2,7,7001));return e.catch(function(){}),new nn(e,function(){return Promise.resolve()})}function is(e){return new nn(Promise.resolve(e),function(){return Promise.resolve()})}function lm(e){return new nn(e,function(){return e.catch(function(){})})}nn.prototype.abort=function(){return this.g=!0,this.i()};function um(e){return new nn(Promise.all(e.map(function(t){return t.promise})),function(){return Promise.all(e.map(function(t){return t.abort()}))})}nn.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},nn.prototype.Aa=function(e,t){function n(c){return function(d){if(s.g&&c)l.reject(u);else{var g=c?e:t;g?i=JT(g,d,l):(c?l.resolve:l.reject)(d)}}}function i(){return l.reject(u),s.abort()}var s=this,l=new _t,u=new K(2,7,7001);return this.promise.then(n(!0),n(!1)),new nn(l,function(){return i()})};function JT(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then(function(){},function(){})})}catch(s){return n.reject(s),function(){return Promise.resolve()}}}he("shaka.util.AbortableOperation",nn),nn.prototype.chain=nn.prototype.Aa,nn.prototype.finally=nn.prototype.finally,nn.all=um,nn.prototype.abort=nn.prototype.abort,nn.notAbortable=lm,nn.completed=is,nn.aborted=Nh,nn.failed=br;function Ue(e,t){if(t)if(t instanceof Map)for(var n=x(t.keys()),i=n.next();!i.done;i=n.next())i=i.value,Object.defineProperty(this,i,{value:t.get(i),writable:!0,enumerable:!0});else for(n in t)Object.defineProperty(this,n,{value:t[n],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=p.performance&&p.performance.now?p.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function fm(e){var t=new Ue(e.type),n;for(n in e)Object.defineProperty(t,n,{value:e[n],writable:!0,enumerable:!0});return t}Ue.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Ue.prototype.stopImmediatePropagation=function(){this.g=!0},Ue.prototype.stopPropagation=function(){},he("shaka.util.FakeEvent",Ue);var xu={ij:"abrstatuschanged",jj:"adaptation",kj:"audiotrackchanged",lj:"buffering",mj:"complete",nj:"downloadfailed",oj:"downloadheadersreceived",pj:"drmsessionupdate",rj:"emsg",Ij:"prft",Error:"error",sj:"expirationupdated",tj:"firstquartile",uj:"gapjumped",xj:"keystatuschanged",zj:"loaded",Aj:"loading",Cj:"manifestparsed",Dj:"manifestupdated",Ej:"mediaqualitychanged",Metadata:"metadata",Fj:"midpoint",Gj:"nospatialvideoinfo",Hj:"onstatechange",Jj:"ratechange",Lj:"segmentappended",Mj:"sessiondata",Nj:"spatialvideoinfo",Oj:"stalldetected",Pj:"started",Qj:"statechanged",Rj:"streaming",Sj:"textchanged",Tj:"texttrackvisibility",Uj:"thirdquartile",Vj:"timelineregionadded",Wj:"timelineregionenter",Xj:"timelineregionexit",Yj:"trackschanged",$j:"unloading",bk:"variantchanged"};function Et(){this.ya=new Sn,this.me=this}Et.prototype.addEventListener=function(e,t){this.ya&&this.ya.push(e,t)},Et.prototype.removeEventListener=function(e,t){this.ya&&this.ya.remove(e,t)},Et.prototype.dispatchEvent=function(e){if(!this.ya)return!0;var t=this.ya.get(e.type)||[],n=this.ya.get("All");for(n&&(t=t.concat(n)),t=x(t),n=t.next();!n.done;n=t.next()){n=n.value,e.target=this.me,e.currentTarget=this.me;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch{}if(e.g)break}return e.defaultPrevented},Et.prototype.release=function(){this.ya=null};function os(){this.g=[]}function Ir(e,t){e.g.push(t.finally(function(){Fn(e.g,t)}))}os.prototype.destroy=function(){for(var e=[],t=x(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.promise.catch(function(){}),e.push(n.abort());return this.g=[],Promise.all(e)};function Ut(e,t,n,i,s,l){Et.call(this),this.i=!1,this.m=new os,this.g=new Set,this.h=new Set,this.l=e||null,this.j=t||null,this.A=n||null,this.B=i||null,this.F=s||null,this.C=l||null,this.o=this.s=!1}le(Ut,Et),a=Ut.prototype,a.Pf=function(e){this.s=e},a.Qf=function(e){this.o=e};function Co(e,t,n,i){n=n||gm;var s=Su[e];(!s||n>=s.priority)&&(Su[e]={priority:n,ie:t,Di:i===void 0?!1:i})}function cm(e,t){for(var n=x(e.g),i=n.next();!i.done;i=n.next())t.g.add(i.value);for(e=x(e.h),n=e.next();!n.done;n=e.next())t.h.add(n.value)}a.Gi=function(e){this.g.add(e)},a.bj=function(e){this.g.delete(e)},a.mg=function(){this.g.clear()},a.Hi=function(e){this.h.add(e)},a.cj=function(e){this.h.delete(e)},a.ng=function(){this.h.clear()};function dn(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:n===void 0?null:n}}a.destroy=function(){return this.i=!0,this.g.clear(),this.h.clear(),Et.prototype.release.call(this),this.m.destroy()},a.request=function(e,t,n){var i=this,s=new pm;if(this.i){var l=Promise.reject(new K(2,7,7001));return l.catch(function(){}),new wu(l,function(){return Promise.resolve()},s)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?uo(t.retryParameters):Yi(),t.uris=uo(t.uris),l=eC(this,e,t,n);var u=l.Aa(function(){return hm(i,e,t,n,new sm(t.retryParameters,!1),0,null,s)}),c=u.Aa(function(C){return tC(i,e,C,n)}),d=Date.now(),g=0;l.promise.then(function(){g=Date.now()-d},function(){});var y=0;u.promise.then(function(){y=Date.now()},function(){});var w=c.Aa(function(C){var T=Date.now()-y,A=C.response;return A.timeMs+=g,A.timeMs+=T,C.ii||!i.l||A.fromCache||t.method=="HEAD"||e!=Ki||i.l(A.timeMs,A.data.byteLength,dm(n)),i.C&&i.C(e,A,n),A},function(C){throw C&&(C.severity=2),C});return l=new wu(w.promise,function(){return w.abort()},s),Ir(this.m,l),l};function eC(e,t,n,i){function s(c){l=l.Aa(function(){return n.body&&(n.body=Pt(n.body)),c(t,n,i)})}var l=is(void 0);e.B&&s(e.B),e=x(e.g);for(var u=e.next();!u.done;u=e.next())s(u.value);return l.Aa(void 0,function(c){throw c instanceof K&&c.code==7001?c:new K(2,1,1006,c)})}function hm(e,t,n,i,s,l,u,c){e.s&&(n.uris[l]=n.uris[l].replace("https://","http://")),e.o&&(n.uris[l]=n.uris[l].replace("http://","https://")),0<l&&e.F&&e.F(t,i,n.uris[l],n.uris[l-1]);var d=new tn(n.uris[l]),g=d.Bb,y=!1;g||(g=location.protocol,g=g.slice(0,-1),tu(d,g),n.uris[l]=d.toString()),g=g.toLowerCase();var w=(g=Su[g])?g.ie:null;if(!w)return br(new K(2,1,1e3,d));var C=g.Di,T=null,A=null,b=!1,k=!1,O;return lm(am(s)).Aa(function(){if(e.i)return Nh();O=Date.now();var D=0;n.requestStartTime=Date.now();var z=w(n.uris[l],n,t,function(G,q,J){T&&T.stop(),A&&A.Y(B/1e3),e.l&&t==Ki&&(D++,n.packetNumber=D,e.l(G,q,dm(i),n),y=!0,c.g=J)},function(G){e.j&&e.j(G,n,t),k=!0,n.timeToFirstByte=Date.now()-n.requestStartTime});if(!C)return z;var P=n.retryParameters.connectionTimeout;P&&(T=new ct(function(){b=!0,z.abort()}),T.Y(P/1e3));var B=n.retryParameters.stallTimeout;return B&&(A=new ct(function(){b=!0,z.abort()})),z}).Aa(function(D){T&&T.stop(),A&&A.stop(),D.timeMs==null&&(D.timeMs=Date.now()-O);var z={response:D,ii:y};return!k&&e.j&&e.j(D.headers,n,t),z},function(D){if(T&&T.stop(),A&&A.stop(),e.A){var z=null,P=0;D instanceof K&&(z=D,D.code==1001&&(P=D.data[1])),e.A(n,z,P,b)}if(e.i)return Nh();if(b&&(D=new K(1,1,1003,n.uris[l],t)),D instanceof K){if(D.code==7001)throw D;if(D.code==1010)throw u;if(D.severity==1)return z=new Map().set("error",D),z=new Ue("retry",z),e.dispatchEvent(z),l=(l+1)%n.uris.length,hm(e,t,n,i,s,l,D,c)}throw D})}function tC(e,t,n,i){var s=is(void 0);e=x(e.h);for(var l=e.next(),u={};!l.done;u={Vg:void 0},l=e.next())u.Vg=l.value,s=s.Aa(function(c){return function(){var d=n.response;return d.data&&(d.data=Pt(d.data)),(0,c.Vg)(t,d,i)}}(u));return s.Aa(function(){return n},function(c){var d=2;if(c instanceof K){if(c.code==7001)throw c;d=c.severity}throw new K(d,1,1007,c)})}function dm(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.s)return!1}return!0}he("shaka.net.NetworkingEngine",Ut),Ut.prototype.request=Ut.prototype.request,Ut.prototype.destroy=Ut.prototype.destroy,Ut.makeRequest=dn,Ut.defaultRetryParameters=function(){return Yi()},Ut.prototype.clearAllResponseFilters=Ut.prototype.ng,Ut.prototype.unregisterResponseFilter=Ut.prototype.cj,Ut.prototype.registerResponseFilter=Ut.prototype.Hi,Ut.prototype.clearAllRequestFilters=Ut.prototype.mg,Ut.prototype.unregisterRequestFilter=Ut.prototype.bj,Ut.prototype.registerRequestFilter=Ut.prototype.Gi,Ut.unregisterScheme=function(e){delete Su[e]},Ut.registerScheme=Co,Ut.prototype.setForceHTTPS=Ut.prototype.Qf,Ut.prototype.setForceHTTP=Ut.prototype.Pf;function pm(){this.g=0}Ut.NumBytesRemainingClass=pm;function wu(e,t,n){nn.call(this,e,t),this.h=n}le(wu,nn),Ut.PendingRequest=wu;var Ki=1;Ut.RequestType={MANIFEST:0,SEGMENT:Ki,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8},Ut.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5,MPD_PATCH:6};var gm=3;Ut.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:gm};var Su={};function rs(e){this.g=!1,this.h=new _t,this.i=e}rs.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then(function(){e.h.resolve()},function(){e.h.resolve()}))};function Dt(e,t){if(e.g)throw t instanceof K&&t.code==7003?t:new K(2,7,7003,t)}function Oh(e,t){var n=[];e=x(e);for(var i=e.next();!i.done;i=e.next())n.push(t(i.value));return n}function nC(e,t){e=x(e);for(var n=e.next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}function Ra(e){for(var t=new Map,n=x(Object.keys(e)),i=n.next();!i.done;i=n.next())i=i.value,t.set(i,e[i]);return t}function Uh(e){var t={};return e.forEach(function(n,i){t[i]=n}),t}function Nt(e,t){this.h=xn(e),this.i=t==mm,this.g=0}a=Nt.prototype,a.na=function(){return this.g<this.h.byteLength},a.va=function(){return this.g},a.getLength=function(){return this.h.byteLength},a.T=function(){try{var e=this.h.getUint8(this.g);return this.g+=1,e}catch{throw Eo()}},a.la=function(){try{var e=this.h.getUint16(this.g,this.i);return this.g+=2,e}catch{throw Eo()}},a.P=function(){try{var e=this.h.getUint32(this.g,this.i);return this.g+=4,e}catch{throw Eo()}},a.Sg=function(){try{var e=this.h.getInt32(this.g,this.i);return this.g+=4,e}catch{throw Eo()}},a.Nc=function(){try{if(this.i)var e=this.h.getUint32(this.g,!0),t=this.h.getUint32(this.g+4,!0);else t=this.h.getUint32(this.g,!1),e=this.h.getUint32(this.g+4,!1)}catch{throw Eo()}if(2097151<t)throw new K(2,3,3001);return this.g+=8,t*Math.pow(2,32)+e},a.qb=function(e){if(this.g+e>this.h.byteLength)throw Eo();var t=Ze(this.h,this.g,e);return this.g+=e,t},a.skip=function(e){if(this.g+e>this.h.byteLength)throw Eo();this.g+=e},a.Oi=function(e){if(this.g<e)throw Eo();this.g-=e},a.seek=function(e){if(0>e||e>this.h.byteLength)throw Eo();this.g=e},a.oc=function(){for(var e=this.g;this.na()&&this.h.getUint8(this.g)!=0;)this.g+=1;return e=Ze(this.h,e,this.g-e),this.g+=1,Vt(e)};function Eo(){return new K(2,3,3e3)}he("shaka.util.DataViewReader",Nt),Nt.prototype.readTerminatedString=Nt.prototype.oc,Nt.prototype.seek=Nt.prototype.seek,Nt.prototype.rewind=Nt.prototype.Oi,Nt.prototype.skip=Nt.prototype.skip,Nt.prototype.readBytes=Nt.prototype.qb,Nt.prototype.readUint64=Nt.prototype.Nc,Nt.prototype.readInt32=Nt.prototype.Sg,Nt.prototype.readUint32=Nt.prototype.P,Nt.prototype.readUint16=Nt.prototype.la,Nt.prototype.readUint8=Nt.prototype.T,Nt.prototype.getLength=Nt.prototype.getLength,Nt.prototype.getPosition=Nt.prototype.va,Nt.prototype.hasMoreData=Nt.prototype.na;var mm=1;Nt.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:mm};function Ot(){this.i=[],this.h=[],this.g=!1}a=Ot.prototype,a.box=function(e,t){return e=ym(e),this.i[e]=iC,this.h[e]=t,this},a.S=function(e,t){return e=ym(e),this.i[e]=vm,this.h[e]=t,this},a.stop=function(){this.g=!0},a.parse=function(e,t,n){for(e=new Nt(e,0),this.g=!1;e.na()&&!this.g;)this.Kc(0,e,t,n)},a.Kc=function(e,t,n,i){var s=t.va();if(i&&s+8>t.getLength())this.g=!0;else{var l=t.P(),u=t.P(),c=Tu(u),d=!1;switch(l){case 0:l=t.getLength()-s;break;case 1:if(i&&t.va()+8>t.getLength()){this.g=!0;return}l=t.Nc(),d=!0}var g=this.h[u];if(g){var y=null,w=null;if(this.i[u]==vm){if(i&&t.va()+4>t.getLength()){this.g=!0;return}w=t.P(),y=w>>>24,w&=16777215}u=s+l,n&&u>t.getLength()&&(u=t.getLength()),i&&u>t.getLength()?this.g=!0:(i=u-t.va(),t=0<i?t.qb(i):new Uint8Array(0),t=new Nt(t,0),g({name:c,parser:this,partialOkay:n||!1,version:y,flags:w,reader:t,size:l,start:s+e,has64BitSize:d}))}else t.skip(Math.min(s+l-t.va(),t.getLength()-t.va()))}};function dt(e){for(var t=as(e);e.reader.na()&&!e.parser.g;)e.parser.Kc(e.start+t,e.reader,e.partialOkay)}function Wo(e){for(var t=as(e),n=e.reader.P(),i=0;i<n&&(e.parser.Kc(e.start+t,e.reader,e.partialOkay),!e.parser.g);i++);}function Yn(e){var t=as(e);for(e.reader.skip(78);e.reader.na()&&!e.parser.g;)e.parser.Kc(e.start+t,e.reader,e.partialOkay)}function Bh(e){var t=as(e);e.reader.skip(8);var n=e.reader.la();for(e.reader.skip(6),n==2?e.reader.skip(48):e.reader.skip(12),n==1&&e.reader.skip(16);e.reader.na()&&!e.parser.g;)e.parser.Kc(e.start+t,e.reader,e.partialOkay)}function ss(e){return function(t){e(t.reader.qb(t.reader.getLength()-t.reader.va()))}}function ym(e){var t=0;e=x(e);for(var n=e.next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function Tu(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,e&255)}function as(e){return 8+(e.has64BitSize?8:0)+(e.flags!=null?4:0)}he("shaka.util.Mp4Parser",Ot),Ot.headerSize=as,Ot.typeToString=Tu,Ot.allData=ss,Ot.audioSampleEntry=Bh,Ot.visualSampleEntry=Yn,Ot.sampleDescription=Wo,Ot.children=dt,Ot.prototype.parseNext=Ot.prototype.Kc,Ot.prototype.parse=Ot.prototype.parse,Ot.prototype.stop=Ot.prototype.stop,Ot.prototype.fullBox=Ot.prototype.S,Ot.prototype.box=Ot.prototype.box;var iC=0,vm=1;function xm(e){var t=this;this.g=[],this.h=[],this.data=[],new Ot().box("moov",dt).box("moof",dt).S("pssh",function(n){if(!(1<n.version)){var i=Ze(n.reader.h,-12,n.size);if(t.data.push(i),t.g.push(So(n.reader.qb(16))),0<n.version){i=n.reader.P();for(var s=0;s<i;s++){var l=So(n.reader.qb(16));t.h.push(l)}}}}).parse(e)}function Cu(e,t,n,i){var s=e.length,l=t.length+16+s;0<i&&(l+=4+16*n.size);var u=new Uint8Array(l),c=xn(u),d=0;if(c.setUint32(d,l),d+=4,c.setUint32(d,1886614376),d+=4,1>i?c.setUint32(d,0):c.setUint32(d,16777216),d+=4,u.set(t,d),d+=t.length,0<i)for(c.setUint32(d,n.size),d+=4,t=x(n),n=t.next();!n.done;n=t.next())n=Tr(n.value),u.set(n,d),d+=n.length;return c.setUint32(d,s),u.set(e,d+4),u}function jh(e,t){return e=wo(e),ls(e,t)}function ls(e,t){return e=oC(e),!t&&e.length?e[0]:(e=e.find(function(n){return n.tagName===t}))?e:null}function Fh(e){return Vh.has(e)?Vh.get(e):""}function oC(e){function t(s,l){l=l===void 0?!1:l;for(var u=[];e[i];)if(e.charCodeAt(i)==60){if(e.charCodeAt(i+1)===47){l=i+2,i=e.indexOf(">",i),l=e.substring(l,i);var c=l.indexOf(s);if(c==-1){var d=s.indexOf(".");0<d&&(c=l.indexOf(s.substring(0,d)))}if(c==-1)throw s=e.substring(0,i).split(`
`),Error(`Unexpected close tag
Line: `+(s.length-1)+`
Column: `+(s[s.length-1].length+1)+`
Char: `+e[i]);i+1&&(i+=1);break}else if(e.charCodeAt(i+1)===33){if(e.charCodeAt(i+2)==45){for(;i!==-1&&(e.charCodeAt(i)!==62||e.charCodeAt(i-1)!=45||e.charCodeAt(i-2)!=45||i==-1);)i=e.indexOf(">",i+1);i===-1&&(i=e.length)}else if(e.charCodeAt(i+2)===91&&e.charCodeAt(i+8)===91&&e.substr(i+3,5).toLowerCase()==="cdata"){c=e.indexOf("]]>",i),c==-1?(u.push(e.substr(i+9)),i=e.length):(u.push(e.substring(i+9,c)),i=c+3);continue}i++;continue}e:{d=l,i++;var g=n(),y={};for(c=[];e.charCodeAt(i)!==62&&e[i];){var w=e.charCodeAt(i);if(64<w&&91>w||96<w&&123>w){w=n();for(var C=e.charCodeAt(i);C&&C!==39&&C!==34&&!(64<C&&91>C||96<C&&123>C)&&C!==62;)i++,C=e.charCodeAt(i);var T=i+1;if(i=e.indexOf(e[i],T),T=e.slice(T,i),C===39||C===34){if(i===-1){for(d={tagName:g,attributes:y,children:c,parent:null},g=0;g<c.length;g++)typeof c[g]!="string"&&(c[g].parent=d);c=d;break e}}else T=null,i--;w.startsWith("xmlns:")&&Vh.set(T,w.split(":")[1]),g==="tt"&&w==="xml:space"&&T==="preserve"&&(d=!0),y[w]=T}i++}for(e.charCodeAt(i-1)!==47?(i++,c=t(g,d)):i++,d={tagName:g,attributes:y,children:c,parent:null},g=c.length,y=0;y<g;y++)w=c[y],typeof w!="string"?w.parent=d:y==g-1&&w==`
`&&c.pop();c=d}if(u.push(c),typeof c=="string")break;c.tagName[0]==="?"&&c.children&&(u.push.apply(u,L(c.children)),c.children=[])}else c=i,i=e.indexOf("<",i)-1,i===-2&&(i=e.length),c=e.slice(c,i+1),l?0<c.length&&u.push(c):(u.length&&c.length==1&&c[0]==`
`||0<c.trim().length)&&u.push(c),i++;return u}function n(){for(var s=i;`\r
	>/= `.indexOf(e[i])===-1&&e[i];)i++;return e.slice(s,i)}var i=0;return t("")}function Eu(e){return typeof e=="string"}function wm(e){var t=[];if(!e.children)return[];e=x(e.children);for(var n=e.next();!n.done;n=e.next())n=n.value,typeof n!="string"&&t.push(n);return t}function Bt(e,t){var n=[];if(!e.children)return[];e=x(e.children);for(var i=e.next();!i.done;i=e.next())i=i.value,i.tagName===t&&n.push(i);return n}function un(e){return typeof e=="string"?$n(e):(e=e.children.reduce(function(t,n){return typeof n=="string"?t+n:t},""),e===""?null:$n(e))}function Ui(e){return Array.from(e.children).every(function(t){return typeof t=="string"})?((e=un(e))&&(e=e.trim()),e):null}function Bi(e,t,n){if(n=n===void 0?[]:n,e.tagName===t&&n.push(e),e.children){e=x(e.children);for(var i=e.next();!i.done;i=e.next())Bi(i.value,t,n)}return n}function ji(e,t){return e=Bt(e,t),e.length!=1?null:e[0]}function Ao(e,t,n){return e=Sm(e,t,n),e.length!=1?null:e[0]}function yt(e,t,n,i){i=i===void 0?null:i;var s=null;return e=e.attributes[t],e!=null&&(s=n(e)),s??i}function ko(e,t,n){return t=Fh(t),e.attributes[t+":"+n]||null}function Sm(e,t,n){t=Fh(t);var i=[];if(e.children){e=x(e.children);for(var s=e.next();!s.done;s=e.next())(s=s.value)&&s.tagName===t+":"+n&&i.push(s)}return i}function fo(e,t,n){t=x(t);for(var i=t.next();!i.done;i=t.next())if(i=ko(e,i.value,n))return i;return null}function qo(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function co(e){return!e||(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e),!e)?null:(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null)}function Au(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return!t||(e=Number(t[1]),!isFinite(e))?null:(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null)}function ku(e){return e=Number(e),e%1===0?e:null}function bo(e){return e=Number(e),e%1===0&&0<e?e:null}function Ln(e){return e=Number(e),e%1===0&&0<=e?e:null}function bu(e){return e=Number(e),isNaN(e)?null:e}function $h(e){return e?e.toLowerCase()==="true":!1}function rC(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function Iu(e){var t=[];e=$n(e).split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/),e=x(e);for(var n=e.next();!n.done;n=e.next()){n=n.value;var i=n.match(/^([\w]+)/);if(i){var s=n.match(/(@id='(.*?)')/),l=n.match(/(@t='(\d+)')/),u=n.match(/(@n='(\d+)')/),c=n.match(/\[(\d+)\]/);t.push({name:i[0],id:s?s[0].match(/'(.*?)'/)[0].replace(/'/gm,""):null,t:l?Number(l[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,n:u?Number(u[0].match(/'(.*?)'/)[0].replace(/'/gm,"")):null,position:c?Number(c[1])-1:null,Sb:n.split("/@")[1]||null})}else n.startsWith("@")&&t.length&&(t[t.length-1].Sb=n.slice(1))}return t}function Tm(e,t){var n=Iu(t.attributes.sel||"");if(n.length){var i=n[n.length-1],s=t.attributes.pos||null;n=i.position,n==null&&(i.t!==null&&(n=Cm(e,"t",i.t)),i.n!==null&&(n=Cm(e,"n",i.n))),n===null?n=s==="prepend"?0:e.length:s==="prepend"?--n:s==="after"&&++n,s=t.tagName,(i=i.Sb)&&e[n]?Em(e[n],s,i,Ui(t)||""):(s!=="remove"&&s!=="replace"||e.splice(n,1),s!=="add"&&s!=="replace"||e.splice.apply(e,[n,0].concat(L(t.children))))}}function Cm(e,t,n){var i=0;e=x(e);for(var s=e.next();!s.done;s=e.next()){if(Number(s.value.attributes[t])===n)return i;i++}return null}function Em(e,t,n,i){t==="remove"?delete e.attributes[n]:(t==="add"||t==="replace")&&(e.attributes[n]=i)}function Am(e){var t=document.createElementNS("",e.tagName),n;for(n in e.attributes)t.setAttribute(n,e.attributes[n]);for(e=x(e.children),n=e.next();!n.done;n=e.next()){n=n.value;var i=void 0;typeof n=="string"?i=new Text(n):i=Am(n),t.appendChild(i)}return t}var Vh=new Map([]);function Mu(e){var t=this;this.C=e,this.H=new Set,this.m=this.s=null,this.fa=this.da=!1,this.I=0,this.g=null,this.B=new lt,this.i=new Map,this.A=new Map,this.l=new _t,this.h=null,this.o=function(n){n.severity==2&&t.l.reject(n),e.onError(n)},this.Z=new Map,this.ea=new Map,this.L=new ct(function(){return mC(t)}),this.R=!1,this.N=[],this.U=!1,this.K=new ct(function(){xC(t)}),this.l.catch(function(){}),this.j=new rs(function(){return sC(t)}),this.ba=!1,this.F=this.G=null}a=Mu.prototype,a.destroy=function(){return this.j.destroy()};function sC(e){return $(function(t){switch(t.g){case 1:return e.B.release(),e.B=null,e.l.reject(),e.K.stop(),e.K=null,e.L.stop(),e.L=null,E(t,Nm(e),2);case 2:if(!e.m){t.u(3);break}return ue(t,4),E(t,e.m.setMediaKeys(null),6);case 6:ge(t,5);break;case 4:ie(t);case 5:e.m=null;case 3:e.g=null,e.H.clear(),e.s=null,e.A=new Map,e.h=null,e.o=function(){},e.C=null,e.ba=!1,e.G=null,F(t)}})}a.configure=function(e){this.h=e,this.K&&this.K.Sa(this.h.updateExpirationTime)};function aC(e,t,n){return e.fa=!0,e.A=new Map,e.R=n,bm(e,t)}function km(e,t,n){e.A=new Map,n=x(n);for(var i=n.next();!i.done;i=n.next())e.A.set(i.value,{initData:null,initDataType:null});for(n=x(e.h.persistentSessionsMetadata),i=n.next();!i.done;i=n.next())i=i.value,e.A.set(i.sessionId,{initData:i.initData,initDataType:i.initDataType});return e.R=0<e.A.size,bm(e,t)}function lC(e,t,n,i,s,l){var u=new Map;return s={audioCapabilities:s,videoCapabilities:l,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t},s.drmInfos=[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:i,serverCertificateUri:"",initData:null,keyIds:null}],u.set(t,s),_m(e,u,[])}function bm(e,t){var n,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P;return $(function(B){if(B.g==1){if(n=pC(e))for(i=x(t),s=i.next();!s.done;s=i.next())l=s.value,l.video&&(l.video.drmInfos=[n]),l.audio&&(l.audio.drmInfos=[n]);for(u=t.some(function(G){return!!(G.video&&G.video.drmInfos.length||G.audio&&G.audio.drmInfos.length)}),u||(c=Ra(e.h.servers),SC(t,c)),d=new Set,g=x(t),y=g.next();!y.done;y=g.next())for(w=y.value,C=Om(w),T=x(C),A=T.next();!A.done;A=T.next())b=A.value,d.add(b);for(k=x(d),O=k.next();!O.done;O=k.next())D=O.value,TC(D,Ra(e.h.servers),Ra(e.h.advanced||{}),e.h.keySystemsMapping);return E(B,Wg(t,e.R,e.ba,e.h.preferredKeySystems),2)}return Dt(e.j),z=u||Object.keys(e.h.servers).length,z?(P=_m(e,void 0,t),B.return(u?P:P.catch(function(){}))):(e.da=!0,B.return(Promise.resolve()))})}function Im(e){var t;return $(function(n){switch(n.g){case 1:if(e.m.mediaKeys)return n.return();if(!e.G){n.u(2);break}return E(n,e.G,3);case 3:return Dt(e.j),n.return();case 2:return ue(n,4),e.G=e.m.setMediaKeys(e.s),E(n,e.G,6);case 6:ge(n,5);break;case 4:t=ie(n),e.o(new K(2,6,6003,t.message));case 5:Dt(e.j),F(n)}})}function uC(e,t){return $(function(n){if(n.g==1)return E(n,Im(e),2);_a(e,t.initDataType,Ze(t.initData)),F(n)})}a.Rb=function(e){var t=this;return $(function(n){if(n.g==1)return t.s?(t.m=e,t.B.ha(t.m,"play",function(){for(var i=x(t.N),s=i.next();!s.done;s=i.next())zh(t,s.value);t.U=!0,t.N=[]}),"webkitCurrentPlaybackTargetIsWireless"in t.m&&t.B.D(t.m,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Nm(t)}),t.F=t.g&&t.g.initData.find(function(i){return 0<i.initData.length})||null,t.F||t.g.keySystem!=="com.apple.fps"||t.A.size?E(n,Im(t),2):n.u(2)):(t.B.ha(e,"encrypted",function(){t.o(new K(2,6,6010))}),n.return());Mm(t).catch(function(){}),t.F||t.A.size||t.h.parseInbandPsshEnabled||t.B.D(t.m,"encrypted",function(i){return uC(t,i)}),F(n)})};function fC(e){var t,n,i,s,l;return $(function(u){switch(u.g){case 1:if(!e.s||!e.g)return u.return();if(!e.g.serverCertificateUri||e.g.serverCertificate&&e.g.serverCertificate.length){u.u(2);break}return t=dn([e.g.serverCertificateUri],e.h.retryParameters),ue(u,3),n=e.C.Lb.request(5,t),E(u,n.promise,5);case 5:i=u.h,e.g.serverCertificate=Ze(i.data),ge(u,4);break;case 3:throw s=ie(u),new K(2,6,6017,s);case 4:if(e.j.g)return u.return();case 2:return!e.g.serverCertificate||!e.g.serverCertificate.length?u.return():(ue(u,6),E(u,e.s.setServerCertificate(e.g.serverCertificate),8));case 8:ge(u,0);break;case 6:throw l=ie(u),new K(2,6,6004,l.message)}})}function cC(e,t){var n,i,s;return $(function(l){if(l.g==1)return E(l,Pm(e,t,{initData:null,initDataType:null}),2);if(l.g!=3)return n=l.h,n?(i=[],(s=e.i.get(n))&&(s.kb=new _t,i.push(s.kb)),i.push(n.remove()),E(l,Promise.all(i),3)):l.return();e.i.delete(n),F(l)})}function Mm(e){var t,n,i,s,l;return $(function(u){if(u.g==1)return e.A.size?(e.A.forEach(function(c,d){Pm(e,d,c)}),E(u,e.l,3)):u.u(2);if(u.g!=2){if(t=e.g&&e.g.keyIds||new Set([]),0<t.size&&wC(e))return u.return(e.l);e.l=new _t,e.l.catch(function(){})}for(n=(e.g?e.g.initData:[])||[],i=x(n),s=i.next();!s.done;s=i.next())l=s.value,_a(e,l.initDataType,l.initData);return La(e)&&e.l.resolve(),u.return(e.l)})}function _a(e,t,n){if(n.length){if(e.h.ignoreDuplicateInitData){var i=e.i.values();i=x(i);for(var s=i.next();!s.done;s=i.next())if(Zt(n,s.value.initData))return}0<e.i.size&&La(e)&&(e.l.resolve(),e.l=new _t,e.l.catch(function(){})),gC(e,t,n,e.g.sessionType)}}function Rm(e){return e=e.i.keys(),e=Oh(e,function(t){return t.sessionId}),Array.from(e)}a.ff=function(){var e=this,t=this.i.keys();return t=Oh(t,function(n){var i=e.i.get(n);return{sessionId:n.sessionId,sessionType:i.type,initData:i.initData,initDataType:i.initDataType}}),Array.from(t)},a.ad=function(){var e=1/0,t=this.i.keys();t=x(t);for(var n=t.next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},a.Ld=function(){return Uh(this.ea)};function _m(e,t,n){var i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D;return $(function(z){switch(z.g){case 1:if(i=new Map,n.length){s=hC(e,n,i),z.u(2);break}return E(z,dC(e,t),3);case 3:s=z.h;case 2:if(l=s,!l)throw new K(2,6,6001);for(Dt(e.j),ue(z,4),e.H.clear(),u=l.getConfiguration(),c=u.audioCapabilities||[],d=u.videoCapabilities||[],g=x(c),y=g.next();!y.done;y=g.next())w=y.value,e.H.add(w.contentType.toLowerCase());for(C=x(d),T=C.next();!T.done;T=C.next())A=T.value,e.H.add(A.contentType.toLowerCase());if(n.length){var P=l.keySystem,B=i.get(l.keySystem),G=[],q=[],J=[],fe=[],te=[],ne=new Set,oe=new Set;Um(B,G,q,fe,J,te,ne,oe);var xe=e.R?"persistent-license":"temporary";for(P={keySystem:P,encryptionScheme:G[0],licenseServerUri:q[0],distinctiveIdentifierRequired:B[0].distinctiveIdentifierRequired,persistentStateRequired:B[0].persistentStateRequired,sessionType:B[0].sessionType||xe,audioRobustness:B[0].audioRobustness||"",videoRobustness:B[0].videoRobustness||"",serverCertificate:fe[0],serverCertificateUri:J[0],initData:te,keyIds:ne},0<oe.size&&(P.keySystemUris=oe),B=x(B),oe=B.next();!oe.done;oe=B.next())oe=oe.value,oe.distinctiveIdentifierRequired&&(P.distinctiveIdentifierRequired=oe.distinctiveIdentifierRequired),oe.persistentStateRequired&&(P.persistentStateRequired=oe.persistentStateRequired);B=P}else B=l.keySystem,oe=t.get(l.keySystem),P=[],G=[],q=[],J=[],fe=[],te=new Set,Um(oe.drmInfos,P,G,J,q,fe,te),B={keySystem:B,encryptionScheme:P[0],licenseServerUri:G[0],distinctiveIdentifierRequired:oe.distinctiveIdentifier=="required",persistentStateRequired:oe.persistentState=="required",sessionType:oe.sessionTypes[0]||"temporary",audioRobustness:(oe.audioCapabilities?oe.audioCapabilities[0].robustness:"")||"",videoRobustness:(oe.videoCapabilities?oe.videoCapabilities[0].robustness:"")||"",serverCertificate:J[0],serverCertificateUri:q[0],initData:fe,keyIds:te};if(e.g=B,!e.g.licenseServerUri)throw new K(2,6,6012,e.g.keySystem);return E(z,l.createMediaKeys(),6);case 6:if(b=z.h,Dt(e.j),e.s=b,!(e.h.minHdcpVersion!=""&&"getStatusForPolicy"in e.s)){z.u(7);break}return ue(z,8),E(z,e.s.getStatusForPolicy({minHdcpVersion:e.h.minHdcpVersion}),10);case 10:if(k=z.h,k!="usable")throw new K(2,6,6018);Dt(e.j),ge(z,7,4);break;case 8:throw O=ie(z,4),O instanceof K?O:new K(2,6,6019,O.message);case 7:return e.da=!0,E(z,fC(e),11);case 11:Dt(e.j),ge(z,0);break;case 4:throw D=ie(z),Dt(e.j,D),e.g=null,e.H.clear(),D instanceof K?D:new K(2,6,6002,D.message)}})}function hC(e,t,n){for(var i=x(t),s=i.next();!s.done;s=i.next()){s=x(Om(s.value));for(var l=s.next();!l.done;l=s.next())l=l.value,n.has(l.keySystem)||n.set(l.keySystem,[]),n.get(l.keySystem).push(l)}if(n.size==1&&n.has(""))throw new K(2,6,6e3);for(e=x(e.h.preferredKeySystems),s=e.next(),i={};!s.done;i={Rg:void 0},s=e.next())for(i.Rg=s.value,s=x(t),l=s.next();!l.done;l=s.next())if(l=l.value.decodingInfos.find(function(g){return function(y){return y.supported&&y.keySystemAccess!=null&&y.keySystemAccess.keySystem==g.Rg}}(i)))return l.keySystemAccess;for(e=x([!0,!1]),i=e.next();!i.done;i=e.next())for(i=i.value,s=x(t),l=s.next();!l.done;l=s.next()){l=x(l.value.decodingInfos);for(var u=l.next();!u.done;u=l.next())if(u=u.value,u.supported&&u.keySystemAccess){var c=n.get(u.keySystemAccess.keySystem);c=x(c);for(var d=c.next();!d.done;d=c.next())if(!!d.value.licenseServerUri==i)return u.keySystemAccess}}return null}function dC(e,t){var n,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O;return $(function(D){switch(D.g){case 1:if(t.size==1&&t.has(""))throw new K(2,6,6e3);for(i=x(t.values()),s=i.next();!s.done;s=i.next())l=s.value,l.audioCapabilities.length==0&&delete l.audioCapabilities,l.videoCapabilities.length==0&&delete l.videoCapabilities;u=x(e.h.preferredKeySystems),c=u.next();case 2:if(c.done){D.u(4);break}if(d=c.value,!t.has(d)){D.u(3);break}return g=t.get(d),ue(D,6),E(D,navigator.requestMediaKeySystemAccess(d,[g]),8);case 8:return n=D.h,D.return(n);case 6:ie(D);case 7:Dt(e.j);case 3:c=u.next(),D.u(2);break;case 4:y=x([!0,!1]),w=y.next();case 9:if(w.done){D.u(11);break}C=w.value,T=x(t.keys()),A=T.next();case 12:if(A.done){w=y.next(),D.u(9);break}if(b=A.value,k=t.get(b),O=k.drmInfos.some(function(z){return!!z.licenseServerUri}),O!=C){D.u(13);break}return ue(D,15),E(D,navigator.requestMediaKeySystemAccess(b,[k]),17);case 17:return n=D.h,D.return(n);case 15:ie(D);case 16:Dt(e.j);case 13:A=T.next(),D.u(12);break;case 11:return D.return(n)}})}function pC(e){return e=Ra(e.h.clearKeys),e.size==0?null:Pg(e)}function Hh(e){La(e)&&e.l.resolve()}function Lm(e,t){new ct(function(){t.loaded=!0,Hh(e)}).Y(EC)}function Pm(e,t,n){var i,s,l,u,c,d,g;return $(function(y){switch(y.g){case 1:try{i=e.s.createSession("persistent-license")}catch(w){return s=new K(2,6,6005,w.message),e.o(s),y.return(Promise.reject(s))}return e.B.D(i,"message",function(w){e.m&&e.h.delayLicenseRequestUntilPlayed&&e.m.paused&&!e.U?e.N.push(w):zh(e,w)}),e.B.D(i,"keystatuseschange",function(w){return Dm(e,w)}),l={initData:n.initData,initDataType:n.initDataType,loaded:!1,zf:1/0,kb:null,type:"persistent-license"},e.i.set(i,l),ue(y,2),E(y,i.load(t),4);case 4:return u=y.h,Dt(e.j),u||(e.i.delete(i),c=e.h.persistentSessionOnlinePlayback?1:2,e.o(new K(c,6,6013)),l.loaded=!0),Lm(e,l),Hh(e),y.return(i);case 2:d=ie(y),Dt(e.j,d),e.i.delete(i),g=e.h.persistentSessionOnlinePlayback?1:2,e.o(new K(g,6,6005,d.message)),l.loaded=!0,Hh(e);case 3:return y.return(Promise.resolve())}})}function gC(e,t,n,i){try{var s=e.s.createSession(i)}catch(l){e.o(new K(2,6,6005,l.message));return}e.B.D(s,"message",function(l){e.m&&e.h.delayLicenseRequestUntilPlayed&&e.m.paused&&!e.U?e.N.push(l):zh(e,l)}),e.B.D(s,"keystatuseschange",function(l){return Dm(e,l)}),e.i.set(s,{initData:n,initDataType:t,loaded:!1,zf:1/0,kb:null,type:i});try{n=e.h.initDataTransform(n,t,e.g)}catch(l){t=l,l instanceof K||(t=new K(2,6,6016,l)),e.o(t);return}e.h.logLicenseExchange&&Sr(n),s.generateRequest(t,n).catch(function(l){if(!e.j.g){e.i.delete(s);var u=l.errorCode;if(u&&u.systemCode){var c=u.systemCode;0>c&&(c+=Math.pow(2,32)),c="0x"+c.toString(16)}e.o(new K(2,6,6006,l.message,l,c))}})}function zh(e,t){var n,i,s,l,u,c,d,g,y,w,C,T,A,b;$(function(k){switch(k.g){case 1:if(n=t.target,e.h.logLicenseExchange&&Sr(t.message),i=e.i.get(n),s=e.g.licenseServerUri,l=e.h.advanced[e.g.keySystem],t.messageType=="individualization-request"&&l&&l.individualizationServer&&(s=l.individualizationServer),u=dn([s],e.h.retryParameters),u.body=t.message,u.method="POST",u.licenseRequestType=t.messageType,u.sessionId=n.sessionId,u.drmInfo=e.g,i&&(u.initData=i.initData,u.initDataType=i.initDataType),l&&l.headers)for(c in l.headers)u.headers[c]=l.headers[c];if(vh(e.g.keySystem)){var O=xo(u.body,!0,!0);if(O.includes("PlayReadyKeyMessage")){O=ls(O,"PlayReadyKeyMessage");var D=Bi(O,"HttpHeader");D=x(D);for(var z=D.next();!z.done;z=D.next()){var P=z.value;z=Bi(P,"name")[0],P=Bi(P,"value")[0],u.headers[un(z)]=un(P)}O=Bi(O,"Challenge")[0],u.body=Ti(un(O))}else u.headers["Content-Type"]="text/xml; charset=utf-8"}return d=Date.now(),ue(k,2),y=e.C.Lb.request(2,u),E(k,y.promise,4);case 4:g=k.h,ge(k,3);break;case 2:return w=ie(k),e.j.g||(C=new K(2,6,6007,w),e.i.size==1?(e.o(C),i&&i.kb&&i.kb.reject(C)):(i&&i.kb&&i.kb.reject(C),e.i.delete(n),La(e)&&(e.l.resolve(),e.L.Y(.1)))),k.return();case 3:return e.j.g?k.return():(e.I+=(Date.now()-d)/1e3,e.h.logLicenseExchange&&Sr(g.data),ue(k,5),E(k,n.update(g.data),7));case 7:ge(k,6);break;case 5:return T=ie(k),A=new K(2,6,6008,T.message),e.o(A),i&&i.kb&&i.kb.reject(A),k.return();case 6:if(e.j.g)return k.return();b=new Ue("drmsessionupdate"),e.C.onEvent(b),i&&(i.kb&&i.kb.resolve(),Lm(e,i)),F(k)}})}function Dm(e,t){t=t.target;var n=e.i.get(t),i=!1;t.keyStatuses.forEach(function(l,u){if(typeof u=="string"){var c=u;u=l,l=c}if(vh(e.g.keySystem)&&u.byteLength==16&&(Ta()||lo())){c=xn(u);var d=c.getUint32(0,!0),g=c.getUint16(4,!0),y=c.getUint16(6,!0);c.setUint32(0,d,!1),c.setUint16(4,g,!1),c.setUint16(6,y,!1)}l!="status-pending"&&(n.loaded=!0),l=="expired"&&(i=!0),u=So(u).slice(0,32),e.Z.set(u,l)});var s=t.expiration-Date.now();(0>s||i&&1e3>s)&&n&&!n.kb&&(e.i.delete(t),t.close().catch(function(){})),La(e)&&(e.l.resolve(),e.L.Y(AC))}function mC(e){var t=e.Z,n=e.ea;n.clear(),t.forEach(function(i,s){return n.set(s,i)}),t=Array.from(n.values()),t.length&&t.every(function(i){return i=="expired"})&&e.o(new K(2,6,6014)),e.C.ee(Uh(n))}function yC(){var e,t,n,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne;return $(function(oe){if(oe.g==1){for(e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.hardware com.microsoft.playready.recommendation com.chromecast.playready com.apple.fps.1_0 com.apple.fps".split(" "),t=["SW_SECURE_CRYPTO","SW_SECURE_DECODE","HW_SECURE_CRYPTO","HW_SECURE_DECODE","HW_SECURE_ALL"],n=["150","2000","3000"],i={"com.widevine.alpha":t,"com.microsoft.playready.recommendation":n},s=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],l=[{contentType:'audio/mp4; codecs="mp4a.40.2"'},{contentType:'audio/webm; codecs="opus"'}],u={videoCapabilities:s,audioCapabilities:l,initDataTypes:["cenc","sinf","skd","keyids"]},c=[null,"cenc","cbcs","cbcs-1-9"],d=new Map,g=function(xe,pe){var we,Me,Te,Ne,rt,gt,Xt,wt;return $(function(Yt){switch(Yt.g){case 1:return ue(Yt,2),E(Yt,pe.createMediaKeys(),4);case 4:ge(Yt,3);break;case 2:return ie(Yt),Yt.return();case 3:Me=(we=pe.getConfiguration().sessionTypes)?we.includes("persistent-license"):!1,Ca()&&(Me=!1),Te=pe.getConfiguration().videoCapabilities,Ne=pe.getConfiguration().audioCapabilities,rt={persistentState:Me,encryptionSchemes:[],videoRobustnessLevels:[],audioRobustnessLevels:[]},d.has(xe)&&d.get(xe)?rt=d.get(xe):d.set(xe,rt),(gt=Te[0].encryptionScheme)&&!rt.encryptionSchemes.includes(gt)&&rt.encryptionSchemes.push(gt),(Xt=Te[0].robustness)&&!rt.videoRobustnessLevels.includes(Xt)&&rt.videoRobustnessLevels.push(Xt),(wt=Ne[0].robustness)&&!rt.audioRobustnessLevels.includes(wt)&&rt.audioRobustnessLevels.push(wt),F(Yt)}})},y=function(xe,pe,we,Me){var Te,Ne,rt,gt,Xt,wt,Yt,rn,Wt,At;return $(function(en){switch(en.g){case 1:for(ue(en,2),Te=uo(u),Ne=x(Te.videoCapabilities),rt=Ne.next();!rt.done;rt=Ne.next())gt=rt.value,gt.encryptionScheme=pe,gt.robustness=we;for(Xt=x(Te.audioCapabilities),wt=Xt.next();!wt.done;wt=Xt.next())Yt=wt.value,Yt.encryptionScheme=pe,Yt.robustness=Me;return rn=uo(Te),rn.persistentState="required",rn.sessionTypes=["persistent-license"],Wt=[rn,Te],E(en,navigator.requestMediaKeySystemAccess(xe,Wt),4);case 4:return At=en.h,E(en,g(xe,At),5);case 5:ge(en,0);break;case 2:ie(en),F(en)}})},w=function(xe,pe,we,Me){var Te,Ne,rt;return $(function(gt){switch(gt.g){case 1:return ue(gt,2),Te={type:"media-source",video:{contentType:s[0].contentType,width:640,height:480,bitrate:1,framerate:1},audio:{contentType:l[0].contentType,channels:2,bitrate:1,samplerate:1},keySystemConfiguration:{keySystem:xe,video:{encryptionScheme:pe,robustness:we},audio:{encryptionScheme:pe,robustness:Me}}},E(gt,navigator.mediaCapabilities.decodingInfo(Te),4);case 4:return Ne=gt.h,rt=Ne.keySystemAccess,E(gt,g(xe,rt),5);case 5:ge(gt,0);break;case 2:ie(gt),F(gt)}})},C=x(e),T=C.next();!T.done;T=C.next())A=T.value,d.set(A,null);for(b=[],k=x(c),O=k.next();!O.done;O=k.next())for(D=O.value,z=x(e),P=z.next();!P.done;P=z.next())B=P.value,B==="org.w3.clearkey"&&Wr()||(b.push(y(B,D,"","")),b.push(w(B,D,"","")));for(G=x(e),q=G.next();!q.done;q=G.next())for(J=q.value,fe=x(i[J]||[]),te=fe.next();!te.done;te=fe.next())ne=te.value,b.push(y(J,null,ne,"")),b.push(y(J,null,"",ne)),b.push(w(J,null,ne,"")),b.push(w(J,null,"",ne));return E(oe,Promise.all(b),2)}return oe.return(Uh(d))})}function vC(e){var t;return $(function(n){if(n.g==1)return t=new Promise(function(i,s){new ct(s).Y(CC)}),ue(n,2),E(n,Promise.race([Promise.all([e.close(),e.closed]),t]),4);if(n.g!=2)return ge(n,0);ie(n),F(n)})}function Nm(e){var t;return $(function(n){return t=Array.from(e.i.entries()),e.i.clear(),E(n,Promise.all(t.map(function(i){i=x(i);var s=i.next().value,l=i.next().value;return $(function(u){if(u.g==1)return ue(u,2),e.fa||e.A.has(s.sessionId)||l.type!=="persistent-license"||e.h.persistentSessionOnlinePlayback?E(u,vC(s),5):E(u,s.remove(),5);if(u.g!=2)return ge(u,0);ie(u),F(u)})})),0)})}function Om(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function xC(e){e.i.forEach(function(t,n){var i=t.zf,s=n.expiration;isNaN(s)&&(s=1/0),s!=i&&(e.C.onExpirationUpdated(n.sessionId,s),t.zf=s)})}function La(e){return e=e.i.values(),nC(e,function(t){return t.loaded})}function wC(e){for(var t=x(e.g&&e.g.keyIds||new Set([])),n=t.next();!n.done;n=t.next())if(e.Z.get(n.value)!=="usable")return!1;return!0}function SC(e,t){var n=[];for(t.forEach(function(i,s){n.push({keySystem:s,licenseServerUri:i,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})}),e=x(e),t=e.next();!t.done;t=e.next())t=t.value,t.video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}function Um(e,t,n,i,s,l,u,c){var d=[];e=x(e);for(var g=e.next(),y={};!g.done;y={ra:void 0},g=e.next()){if(y.ra=g.value,t.includes(y.ra.encryptionScheme)||t.push(y.ra.encryptionScheme),y.ra.keySystem=="org.w3.clearkey"&&y.ra.licenseServerUri.startsWith("data:application/json;base64,")?d.includes(y.ra.licenseServerUri)||d.push(y.ra.licenseServerUri):n.includes(y.ra.licenseServerUri)||n.push(y.ra.licenseServerUri),s.includes(y.ra.serverCertificateUri)||s.push(y.ra.serverCertificateUri),y.ra.serverCertificate&&(i.some(function(T){return function(A){return Zt(A,T.ra.serverCertificate)}}(y))||i.push(y.ra.serverCertificate)),y.ra.initData){g=x(y.ra.initData);for(var w=g.next(),C={};!w.done;C={mf:void 0},w=g.next())C.mf=w.value,l.some(function(T){return function(A){var b=T.mf;return A.keyId&&A.keyId==b.keyId?!0:A.initDataType==b.initDataType&&Zt(A.initData,b.initData)}}(C))||l.push(C.mf)}if(y.ra.keyIds)for(g=x(y.ra.keyIds),w=g.next();!w.done;w=g.next())u.add(w.value);if(y.ra.keySystemUris&&c)for(y=x(y.ra.keySystemUris),g=y.next();!g.done;g=y.next())c.add(g.value)}if(d.length==1)n.push(d[0]);else if(0<d.length){for(t=[],d=x(d),i=d.next();!i.done;i=d.next())i=p.atob(i.value.split("data:application/json;base64,").pop()),i=JSON.parse(i),t.push.apply(t,L(i.keys));d=JSON.stringify({keys:t}),n.push("data:application/json;base64,"+p.btoa(d))}}function TC(e,t,n,i){var s=e.keySystem;s&&(s!="org.w3.clearkey"||!e.licenseServerUri)&&(t.size&&(t=t.get(s)||"",e.licenseServerUri=t),e.keyIds||(e.keyIds=new Set),(n=n.get(s))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=n.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=n.persistentStateRequired),e.videoRobustness||(e.videoRobustness=n.videoRobustness),e.audioRobustness||(e.audioRobustness=n.audioRobustness),e.serverCertificate||(e.serverCertificate=n.serverCertificate),n.sessionType&&(e.sessionType=n.sessionType),e.serverCertificateUri||(e.serverCertificateUri=n.serverCertificateUri)),i[s]&&(e.keySystem=i[s]),p.cast&&p.cast.__platform__&&s=="com.microsoft.playready"&&(e.keySystem="com.chromecast.playready"))}var CC=1,EC=5,AC=.5;/*
 @license
 Shaka Player
 Copyright 2023 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function Gh(e,t,n){this.h=e,this.i=t,this.g=n}function Bm(e,t){return $(function(n){if(n.g==1)return E(n,LT(e.g,t,e.h.drm.preferredKeySystems),2);if(e.h.streaming.dontChooseCodecs||Vg(t,e.h.preferredVideoCodecs,e.h.preferredAudioCodecs,e.h.preferredDecodingAttributes),!t.variants.some(ba))throw new K(2,4,4032);return n.return(jm(e,t))})}function jm(e,t){var n=Hg(t.variants,e.h.restrictions,e.i);if(t){var i=e.g?e.g.g:null;if(i&&e.g.s)for(var s=x(t.variants),l=s.next();!l.done;l=s.next())l=l.value,Xh(e,i.keySystem,l.video),Xh(e,i.keySystem,l.audio);Fm(e,t)}return n}function Xh(e,t,n){if(n){n=x(n.drmInfos);for(var i=n.next();!i.done;i=n.next())if(i=i.value,i.keySystem==t){i=x(i.initData||[]);for(var s=i.next();!s.done;s=i.next())s=s.value,_a(e.g,s.initDataType,s.initData)}}}function Fm(e,t){e=e.g?e.g.Ld():{};var n=Object.keys(e);n=n.length&&n[0]=="00";var i=!1,s=!1,l=new Set,u=new Set;t=x(t.variants);for(var c=t.next();!c.done;c=t.next()){c=c.value;var d=[];c.audio&&d.push(c.audio),c.video&&d.push(c.video),d=x(d);for(var g=d.next();!g.done;g=d.next())if(g=g.value,g.keyIds.size){g=x(g.keyIds);for(var y=g.next();!y.done;y=g.next()){y=y.value;var w=e[n?"00":y];w?$m.includes(w)&&u.add(w):l.add(y)}}c.allowedByApplication?c.allowedByKeySystem&&(i=!0):s=!0}if(!i)throw e={hasAppRestrictions:s,missingKeys:Array.from(l),restrictedKeyStatuses:Array.from(u)},new K(2,4,4012,e)}var $m=["output-restricted","internal-error"];function Pa(){}function Vm(e,t){if(t){var n=Fi[t.toLowerCase()];if(n)return n}throw new K(2,4,4e3,e,t)}he("shaka.media.ManifestParser",Pa),Pa.unregisterParserByMime=function(e){delete Fi[e]},Pa.registerParserByMime=function(e,t){Fi[e]=t},Pa.registerParserByExtension=function(){vt("ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},Pa.AccessibilityPurpose={ak:"visually impaired",vj:"hard of hearing"};var Fi={};function kC(e,t){function n(){l=!0}function i(y){c.push(y),dt(y)}var s=e=Ze(e),l=!1,u,c=[],d=[];if(new Ot().box("moov",i).box("trak",i).box("mdia",i).box("minf",i).box("stbl",i).S("stsd",function(y){u=y,c.push(y),Wo(y)}).S("encv",n).S("enca",n).S("dvav",function(y){d.push({box:y,Oa:1701733238})}).S("dva1",function(y){d.push({box:y,Oa:1701733238})}).S("dvh1",function(y){d.push({box:y,Oa:1701733238})}).S("dvhe",function(y){d.push({box:y,Oa:1701733238})}).S("dvc1",function(y){d.push({box:y,Oa:1701733238})}).S("dvi1",function(y){d.push({box:y,Oa:1701733238})}).S("hev1",function(y){d.push({box:y,Oa:1701733238})}).S("hvc1",function(y){d.push({box:y,Oa:1701733238})}).S("avc1",function(y){d.push({box:y,Oa:1701733238})}).S("avc3",function(y){d.push({box:y,Oa:1701733238})}).S("ac-3",function(y){d.push({box:y,Oa:1701733217})}).S("ec-3",function(y){d.push({box:y,Oa:1701733217})}).S("ac-4",function(y){d.push({box:y,Oa:1701733217})}).S("mp4a",function(y){d.push({box:y,Oa:1701733217})}).parse(e),l)return e;if(d.length==0||!u)throw So(e),new K(2,3,3019,t);d.reverse(),t=x(d);for(var g=t.next();!g.done;g=t.next())g=g.value,s=bC(s,u,g.box,c,g.Oa);return Ta()&&Sh()?(t=new Uint8Array(e.byteLength+s.byteLength),t.set(s),t.set(e,s.byteLength),t):s}function bC(e,t,n,i,s){var l=IC.value(),u=e.subarray(n.start,n.start+n.size),c=xn(u),d=new Uint8Array(n.size+l.byteLength);for(d.set(u,0),u=xn(d),u.setUint32(4,s),d.set(l,n.size),s=c.getUint32(4),u.setUint32(n.size+16,s),Hm(d,0,d.byteLength),s=new Uint8Array(e.byteLength+d.byteLength),n=ro()||Ta()?n.start:n.start+n.size,l=e.subarray(n),s.set(e.subarray(0,n)),s.set(d,n),s.set(l,n+d.byteLength),e=x(i),i=e.next();!i.done;i=e.next())i=i.value,Hm(s,i.start,i.size+d.byteLength);return d=xn(s,t.start),t=as(t),e=d.getUint32(t),d.setUint32(t,e+1),s}function Hm(e,t,n){e=xn(e,t),t=e.getUint32(0),t!=0&&(t==1?(e.setUint32(8,n>>32),e.setUint32(12,n&4294967295)):e.setUint32(0,n))}var IC=new Gr(function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])});function Kn(e,t,n,i,s,l,u){this.M=e,this.Ha=t,this.sa=n,this.Hc=i===void 0?null:i,this.timescale=s===void 0?null:s,this.g=l===void 0?null:l,this.aesKey=u===void 0?null:u,this.mimeType=this.codecs=null}Kn.prototype.Xb=function(){return this.Ha},Kn.prototype.Ub=function(){return this.sa},Kn.prototype.cd=function(){return this.g};function Wh(e,t){return e===t?!0:e&&t?e.Xb()==t.Xb()&&e.Ub()==t.Ub()&&mr(e.M().sort(),t.M().sort())&&Zt(e.cd(),t.cd()):e==t}he("shaka.media.InitSegmentReference",Kn),Kn.prototype.getEndByte=Kn.prototype.Ub,Kn.prototype.getStartByte=Kn.prototype.Xb;function Je(e,t,n,i,s,l,u,c,d,g,y,w,C,T,A,b){for(g=g===void 0?[]:g,T=T===void 0?Yo:T,this.startTime=e,this.j=this.endTime=t,this.F=n,this.Ha=i,this.sa=s,this.$=l,this.timestampOffset=u,this.appendWindowStart=c,this.appendWindowEnd=d,this.g=g,this.tilesLayout=y===void 0?"":y,this.B=w===void 0?null:w,this.h=C===void 0?null:C,this.status=T,this.preload=!1,this.l=!0,this.m=!1,this.aesKey=A===void 0?null:A,this.A=null,this.i=0,this.o=b===void 0?!1:b,this.G=this.s=!1,e=x(this.g),t=e.next();!t.done;t=e.next())t.value.Kg();this.o&&this.g.length&&this.g[this.g.length-1].Jg(),this.C=this.mimeType=this.codecs=null}a=Je.prototype,a.M=function(){return this.F()},a.getStartTime=function(){return this.startTime},a.Mh=function(){return this.endTime},a.Xb=function(){return this.Ha},a.Ub=function(){return this.sa},a.di=function(){return this.tilesLayout},a.ci=function(){return this.B},a.Yb=function(){return this.status},a.xi=function(){this.status=Gm},a.wf=function(){this.preload=!0},a.ri=function(){return this.preload},a.Xd=function(){this.l=!1},a.ni=function(){return this.l},a.Kg=function(){this.s=!0},a.pi=function(){return this.s},a.Jg=function(){this.G=!0},a.oi=function(){return this.G},a.Ig=function(){this.m=!0},a.ji=function(){return this.m},a.fh=function(e){this.A=e},a.bi=function(){return this.A},a.offset=function(e){this.startTime+=e,this.endTime+=e,this.j+=e;for(var t=x(this.g),n=t.next();!n.done;n=t.next())n=n.value,n.startTime+=e,n.endTime+=e,n.j+=e},a.Vf=function(e){this.h==null?Xe("Sync attempted without sync time!"):(e=this.h-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},a.Zi=function(e){this.C=e},a.cd=function(){return this.C};function zm(e,t){e.$=t,e=x(e.g);for(var n=e.next();!n.done;n=e.next())zm(n.value,t)}he("shaka.media.SegmentReference",Je),Je.prototype.getSegmentData=Je.prototype.cd,Je.prototype.setSegmentData=Je.prototype.Zi,Je.prototype.syncAgainst=Je.prototype.Vf,Je.prototype.offset=Je.prototype.offset,Je.prototype.getThumbnailSprite=Je.prototype.bi,Je.prototype.setThumbnailSprite=Je.prototype.fh,Je.prototype.hasByterangeOptimization=Je.prototype.ji,Je.prototype.markAsByterangeOptimization=Je.prototype.Ig,Je.prototype.isLastPartial=Je.prototype.oi,Je.prototype.markAsLastPartial=Je.prototype.Jg,Je.prototype.isPartial=Je.prototype.pi,Je.prototype.markAsPartial=Je.prototype.Kg,Je.prototype.isIndependent=Je.prototype.ni,Je.prototype.markAsNonIndependent=Je.prototype.Xd,Je.prototype.isPreload=Je.prototype.ri,Je.prototype.markAsPreload=Je.prototype.wf,Je.prototype.markAsUnavailable=Je.prototype.xi,Je.prototype.getStatus=Je.prototype.Yb,Je.prototype.getTileDuration=Je.prototype.ci,Je.prototype.getTilesLayout=Je.prototype.di,Je.prototype.getEndByte=Je.prototype.Ub,Je.prototype.getStartByte=Je.prototype.Xb,Je.prototype.getEndTime=Je.prototype.Mh,Je.prototype.getStartTime=Je.prototype.getStartTime,Je.prototype.getUris=Je.prototype.M;var Yo=0,Gm=1;Je.Status={hj:Yo,Zj:Gm,Bj:2};function Da(e){return e.length==1&&1e-4>e.end(0)-e.start(0)}function qh(e){return!e||Da(e)?null:e.length?e.end(e.length-1):null}function Yh(e,t){return!e||!e.length||Da(e)||t>e.end(e.length-1)?!1:t>=e.start(0)}function Xm(e,t){if(!e||!e.length||Da(e))return 0;var n=0;e=x(Ko(e));for(var i=e.next();!i.done;i=e.next()){var s=i.value;i=s.start,s=s.end,s>t&&(n+=s-Math.max(i,t))}return n}function MC(e,t,n){return!e||!e.length||Da(e)?null:(e=Ko(e).findIndex(function(i,s,l){return i.start>t&&(s==0||l[s-1].end-t<=n)}),0<=e?e:null)}function Ko(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function Kh(){}function Wm(e,t){return t+10<=e.length&&e[t]===73&&e[t+1]===68&&e[t+2]===51&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function qm(e,t){return t+10<=e.length&&e[t]===51&&e[t+1]===68&&e[t+2]===73&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]}function Zh(e,t){var n=(e[t]&127)<<21;return n|=(e[t+1]&127)<<14,n|=(e[t+2]&127)<<7,n|=e[t+3]&127}function RC(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if(e.type==="APIC"){if(2>e.size||e.data[0]!==3)return null;var n=e.data.subarray(1).indexOf(0);if(n===-1)return null;var i=Vt(Ze(e.data,1,n)),s=e.data[2+n],l=e.data.subarray(3+n).indexOf(0);if(l===-1)return null;var u=Vt(Ze(e.data,3+n,l)),c;return i==="-->"?c=Vt(Ze(e.data,4+n+l)):c=Pt(e.data.subarray(4+n+l)),t.mimeType=i,t.pictureType=s,t.description=u,t.data=c,t}return e.type==="TXXX"?2>e.size||e.data[0]!==3||(i=e.data.subarray(1).indexOf(0),i===-1)?null:(n=Vt(Ze(e.data,1,i)),e=Vt(Ze(e.data,2+i)).replace(/\0*$/,""),t.description=n,t.data=e,t):e.type==="WXXX"?2>e.size||e.data[0]!==3||(i=e.data.subarray(1).indexOf(0),i===-1)?null:(n=Vt(Ze(e.data,1,i)),e=Vt(Ze(e.data,2+i)).replace(/\0*$/,""),t.description=n,t.data=e,t):e.type==="PRIV"?2>e.size||(n=e.data.indexOf(0),n===-1)?null:(n=Vt(Ze(e.data,0,n)),t.description=n,n=="com.apple.streaming.transportStreamTimestamp"?(n=e.data.subarray(n.length+1),e=n[3]&1,n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,e&&(n+=4772185884e-2),t.data=n):(e=Pt(e.data.subarray(n.length+1)),t.data=e),t):e.type[0]==="T"?2>e.size||e.data[0]!==3?null:(e=Vt(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):e.type[0]==="W"?(e=Vt(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=Pt(e.data),t):null}function Mr(e){for(var t=0,n=[];Wm(e,t);){var i=Zh(e,t+6);for(e[t+5]>>6&1&&(t+=10),t+=10,i=t+i;t+10<i;){var s=e.subarray(t),l=Zh(s,4);s={type:String.fromCharCode(s[0],s[1],s[2],s[3]),size:l,data:s.subarray(10,10+l)},(l=RC(s))&&n.push(l),t+=s.size+10}qm(e,t)&&(t+=10)}return n}function us(e,t){for(var n=t=t===void 0?0:t,i=0;Wm(e,t);)e[t+5]>>6&1&&(i+=10),i+=10,i+=Zh(e,t+6),qm(e,t+10)&&(i+=10),t+=i;return 0<i?e.subarray(n,n+i):new Uint8Array([])}he("shaka.util.Id3Utils",Kh),Kh.getID3Data=us,Kh.getID3Frames=Mr;function Ym(e,t){var n=null,i=null,s=null,l=e.P();return t&1&&(s=e.Nc()),t&2&&e.skip(4),t&8&&(n=e.P()),t&16&&(i=e.P()),{trackId:l,Yc:n,Id:i,ck:s}}function Ru(e,t){return t==1?(t=e.P(),e=e.P(),{baseMediaDecodeTime:t*Math.pow(2,32)+e}):{baseMediaDecodeTime:e.P()}}function _u(e,t){return t==1?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.P(),e.skip(4),e=e.la(),{timescale:t,language:String.fromCharCode((e>>10)+96)+String.fromCharCode(((e&960)>>5)+96)+String.fromCharCode((e&31)+96)}}function Km(e,t,n){var i=e.P(),s=[],l=null;n&1&&(l=e.P()),n&4&&e.skip(4);for(var u=0;u<i;u++){var c={Jf:null,sampleSize:null,ne:null};n&256&&(c.Jf=e.P()),n&512&&(c.sampleSize=e.P()),n&1024&&e.skip(4),n&2048&&(c.ne=t==0?e.P():e.Sg()),s.push(c)}return{gk:i,Wg:s,Fh:l}}function Zm(e){e.skip(6),e.skip(2),e.skip(8);var t=e.la();return e.skip(2),e.skip(2),e.skip(2),e=e.la()+e.la()/65536,{channelCount:t,sampleRate:e}}function Qm(e){return e=e.P(),{codec:Tu(e)}}function _C(e){var t=null,n=null,i=e.qb(4),s=String.fromCharCode(i[0]);if(s+=String.fromCharCode(i[1]),s+=String.fromCharCode(i[2]),s+=String.fromCharCode(i[3]),s==="nclx"){switch(e.la()){case 1:case 5:case 6:case 7:t="srgb";break;case 9:t="rec2020";break;case 11:case 12:t="p3"}switch(i=e.la(),e.la(),i){case 1:case 6:case 13:case 14:case 15:n="SDR";break;case 16:n="PQ";break;case 18:n="HLG"}}return{colorGamut:t,xd:n}}function Na(e,t){return t=t===void 0?!1:t,e=e.toString(16).toUpperCase(),t?e:("0"+e).slice(-2)}function Zn(e){return(10>e?"0":"")+e}function Io(e,t){if(this.j=e,t!==void 0&&t){t=new Uint8Array(e.byteLength);for(var n=0,i=0;i<e.byteLength;i++)2<=i&&e[i]==3&&e[i-1]==0&&e[i-2]==0||(t[n]=e[i],n++);this.j=Ze(t,0,n)}this.i=this.j.byteLength,this.g=this.h=0}function Qh(e){var t=e.j.byteLength-e.i,n=new Uint8Array(4),i=Math.min(4,e.i);i!==0&&(n.set(e.j.subarray(t,t+i)),e.h=new Nt(n,0).P(),e.g=8*i,e.i-=i)}function Qn(e,t){if(e.g<=t){t-=e.g;var n=Math.floor(t/8);t-=8*n,e.g-=n,Qh(e)}e.h<<=t,e.g-=t}function ht(e,t){var n=Math.min(e.g,t),i=e.h>>>32-n;return e.g-=n,0<e.g?e.h<<=n:0<e.i&&Qh(e),n=t-n,0<n?i<<n|ht(e,n):i}function Jh(e){var t;for(t=0;t<e.g;++t)if(e.h&2147483648>>>t)return e.h<<=t,e.g-=t,t;return Qh(e),t+Jh(e)}function Hn(e){Qn(e,1+Jh(e))}function $e(e){var t=Jh(e);return ht(e,t+1)-1}function fs(e){return e=$e(e),1&e?1+e>>>1:-1*(e>>>1)}function Ye(e){return ht(e,1)===1}function Tt(e){return ht(e,8)}function Lu(e,t){for(var n=8,i=8,s=0;s<t;s++)i!==0&&(i=fs(e),i=(n+i+256)%256),n=i===0?n:i}function LC(e){return Tt(e),$e(e),$e(e)}he("shaka.util.ExpGolomb",Io);function jt(){this.G=null,this.H=!1,this.m=this.I=null,this.j=[],this.g=[],this.A=this.B=null,this.i=[],this.h=[],this.C=null,this.l=[],this.F=this.o=this.s=null}a=jt.prototype,a.clearData=function(){this.j=[],this.g=[],this.i=[],this.h=[],this.l=[]},a.parse=function(e){if(564>e.length)return this;for(var t=Math.max(0,td(e)),n=e.length-(e.length+t)%188,i=!1,s=t;s<n;s+=188)if(e[s]==71){var l=!!(e[s+1]&64),u=((e[s+1]&31)<<8)+e[s+2];if(1<(e[s+3]&48)>>4){var c=s+5+e[s+4];if(c==s+188)continue}else c=s+4;switch(u){case 0:l&&(c+=e[c]+1),this.G=(e[c+10]&31)<<8|e[c+11];break;case 17:case 8191:break;case this.G:l&&(c+=e[c]+1),l=e,u={audio:-1,video:-1,Rd:-1,audioCodec:"",videoCodec:""};var d=c+3+((l[c+1]&15)<<8|l[c+2])-4;for(c+=12+((l[c+10]&15)<<8|l[c+11]);c<d;){var g=(l[c+1]&31)<<8|l[c+2],y=(l[c+3]&15)<<8|l[c+4];switch(l[c]){case 6:if(0<y)for(var w=c+5,C=y;2<C;){var T=l[w+1]+2;switch(l[w]){case 5:var A=Eh(l.subarray(w+2,w+T));u.audio==-1&&A==="Opus"?(u.audio=g,u.audioCodec="opus"):u.video==-1&&A==="AV01"&&(u.video=g,u.videoCodec="av1");break;case 106:u.audio==-1&&(u.audio=g,u.audioCodec="ac3");break;case 122:u.audio==-1&&(u.audio=g,u.audioCodec="ec3");break;case 124:u.audio==-1&&(u.audio=g,u.audioCodec="aac");break;case 127:u.audioCodec=="opus"&&(A=null,l[w+2]===128&&(A=l[w+3]),A!=null&&(this.F={channelCount:A&15?A&15:2,Ch:A,sampleRate:48e3}))}w+=T,C-=T}break;case 15:u.audio==-1&&(u.audio=g,u.audioCodec="aac");break;case 17:u.audio==-1&&(u.audio=g,u.audioCodec="aac-loas");break;case 21:u.Rd==-1&&(u.Rd=g);break;case 27:u.video==-1&&(u.video=g,u.videoCodec="avc");break;case 3:case 4:u.audio==-1&&(u.audio=g,u.audioCodec="mp3");break;case 36:u.video==-1&&(u.video=g,u.videoCodec="hvc");break;case 129:u.audio==-1&&(u.audio=g,u.audioCodec="ac3");break;case 132:case 135:u.audio==-1&&(u.audio=g,u.audioCodec="ec3")}c+=y+5}l=u,l.video!=-1&&(this.I=l.video,this.m=l.videoCodec),l.audio!=-1&&(this.B=l.audio,this.A=l.audioCodec),l.Rd!=-1&&(this.C=l.Rd),i&&!this.H&&(i=!1,s=t-188),this.H=!0;break;case this.I:c=e.subarray(c,s+188),l?this.j.push([c]):this.j.length&&this.j[this.j.length-1]&&this.j[this.j.length-1].push(c);break;case this.B:c=e.subarray(c,s+188),l?this.i.push([c]):this.i.length&&this.i[this.i.length-1]&&this.i[this.i.length-1].push(c);break;case this.C:c=e.subarray(c,s+188),l?this.l.push([c]):this.l.length&&this.l[this.l.length-1]&&this.l[this.l.length-1].push(c);break;default:i=!0}}return this};function ed(e,t){if((t[0]<<16|t[1]<<8|t[2])!==1)return null;var n={data:new Uint8Array(0),packetLength:t[4]<<8|t[5],pts:null,dts:null,nalus:[]};if(n.packetLength&&n.packetLength>t.byteLength-6)return null;var i=t[7];if(i&192){var s=536870912*(t[9]&14)+4194304*(t[10]&255)+16384*(t[11]&254)+128*(t[12]&255)+(t[13]&254)/2;e.s==null&&(e.s=s),n.pts=Jm(s,e.s),e.s=n.pts,n.dts=n.pts,i&64&&(i=536870912*(t[14]&14)+4194304*(t[15]&255)+16384*(t[16]&254)+128*(t[17]&255)+(t[18]&254)/2,e.o==null&&(e.o=i),n.dts=Jm(i,e.o)),e.o=n.dts}return e=t[8]+9,t.byteLength<=e?null:(n.data=t.subarray(e),n)}a.Ci=function(e){return vt("TsParser.parseAvcNalus","Please use parseNalus function instead."),this.Cf(e)},a.Cf=function(e,t,n){var i=e.pts?e.pts/9e4:null;e=e.data;var s=e.byteLength,l=1;this.m=="hvc"&&(l=2);for(var u=n||0,c=[],d=-1,g=0,y,w=0;w<s;++w){var C=e[w];if(C){if(2<=u&&C==1){if(t&&!c.length&&d==-1&&(C=w-(3<u?3:u),n&&C!=0&&(C=e.subarray(0,C),t.data=Qt(t.data,C),t.fullData=Qt(t.fullData,C))),0<=d?(u=w-((3<u?3:u)+1),c.push({data:e.subarray(d+l,u+1),fullData:e.subarray(d,u+1),type:g,time:i})):t&&!c.length&&(d=w-u,0<d&&(d=e.subarray(0,d),t.data=Qt(t.data,d),t.fullData=Qt(t.fullData,d))),w>=s-l)return c;w++,d=w,g=this.m=="hvc"?e[w]>>1&63:e[w]&31}u=0}else u++;w>=s-1&&0<=d&&0<=u&&(y={data:e.subarray(d+l,s),fullData:e.subarray(d,s),type:g,time:i})}return y&&c.push(y),!c.length&&t&&(t.data=Qt(t.data,e),t.fullData=Qt(t.fullData,e)),c},a.getMetadata=function(){for(var e=[],t=x(this.l),n=t.next();!n.done;n=t.next())n=Qt.apply(_n,L(n.value)),(n=ed(this,n))&&e.push({cueTime:n.pts?n.pts/9e4:null,data:n.data,frames:Mr(n.data),dts:n.dts,pts:n.pts});return e},a.Tb=function(){if(this.i.length&&!this.h.length){for(var e=!1,t=x(this.i),n=t.next();!n.done;n=t.next()){var i=Qt.apply(_n,L(n.value)),s=ed(this,i);n=this.h.length?this.h[this.h.length-1]:null,s&&s.pts!=null&&s.dts!=null&&(!n||n.pts!=s.pts&&n.dts!=s.dts)?(this.h.length&&s.dts<(n.dts||0)&&(e=!0),this.h.push(s)):this.h.length&&(i=s?s.data:i)&&(n=this.h.pop(),n.data=Qt(n.data,i),this.h.push(n))}e&&(this.h=this.h.sort(function(l,u){var c=(l.pts||0)-(u.pts||0);return(l.dts||0)-(u.dts||0)||c}))}return this.h},a.Fc=function(e){if(e=e===void 0?!0:e,this.j.length&&!this.g.length){for(var t=!1,n=x(this.j),i=n.next();!i.done;i=n.next()){var s=Qt.apply(_n,L(i.value)),l=ed(this,s);i=this.g.length?this.g[this.g.length-1]:null,l&&l.pts!=null&&l.dts!=null&&(!i||i.pts!=l.pts&&i.dts!=l.dts)?(this.g.length&&l.dts<(i.dts||0)&&(t=!0),this.g.push(l)):this.g.length&&(s=l?l.data:s)&&(i=this.g.pop(),i.data=Qt(i.data,s),this.g.push(i))}if(e){for(n=[],i=x(this.g),s=i.next();!s.done;s=i.next())if(s=s.value,s.nalus=this.Cf(s,u,void 0),s.nalus.length){n.push(s);var u=s.nalus[s.nalus.length-1]}this.g=n}t&&(this.g=this.g.sort(function(c,d){var g=(c.pts||0)-(d.pts||0);return(c.dts||0)-(d.dts||0)||g}))}return e?this.g:(e=this.g,this.g=[],e)},a.getStartTime=function(e){if(e=="audio"){e=null;var t=this.Tb();return t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e}return e=="video"?(e=null,t=this.Fc(!1),t.length&&(e=t[0],e=Math.min(e.dts,e.pts)/9e4),e):null},a.$c=function(){return{audio:this.A,video:this.m}},a.Pd=function(){for(var e=[],t=x(this.Fc()),n=t.next();!n.done;n=t.next())e.push.apply(e,L(n.value.nalus));return e},a.gi=function(){vt("TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.kf();return{height:e.height,width:e.width}},a.kf=function(){return this.m=="hvc"?DC(this):PC(this)};function PC(e){var t={height:null,width:null,codec:null};if(e=e.Pd(),!e.length||(e=e.find(function(C){return C.type==7}),!e))return t;e=new Io(e.data);var n=Tt(e),i=Tt(e),s=Tt(e);if(Hn(e),NC.includes(n)){var l=$e(e);if(l===3&&Qn(e,1),Hn(e),Hn(e),Qn(e,1),Ye(e)){l=l!==3?8:12;for(var u=0;u<l;u++)Ye(e)&&(6>u?Lu(e,16):Lu(e,64))}}if(Hn(e),l=$e(e),l===0)$e(e);else if(l===1)for(Qn(e,1),Hn(e),Hn(e),l=$e(e),u=0;u<l;u++)Hn(e);Hn(e),Qn(e,1),l=$e(e),u=$e(e);var c=ht(e,1);c===0&&Qn(e,1),Qn(e,1);var d=0,g=0,y=0,w=0;return Ye(e)&&(d=$e(e),g=$e(e),y=$e(e),w=$e(e)),t.height=String((2-c)*(u+1)*16-2*y-2*w),t.width=String(16*(l+1)-2*d-2*g),t.codec="avc1."+("0"+n.toString(16).toUpperCase()).slice(-2)+("0"+i.toString(16).toUpperCase()).slice(-2)+("0"+s.toString(16).toUpperCase()).slice(-2),t}function DC(e){var t={height:null,width:null,codec:null};if(e=e.Pd(),!e.length||(e=e.find(function(P){return P.type==33}),!e))return t;var n=new Io(e.fullData,!0);Tt(n),Tt(n),ht(n,4);var i=ht(n,3);Ye(n);var s=ht(n,2),l=ht(n,1),u=ht(n,5),c=ht(n,32);e=Tt(n);for(var d=Tt(n),g=Tt(n),y=Tt(n),w=Tt(n),C=Tt(n),T=Tt(n),A=[],b=[],k=0;k<i;k++)A.push(Ye(n)),b.push(Ye(n));if(0<i)for(k=i;8>k;k++)ht(n,2);for(k=0;k<i;k++)A[k]&&ht(n,88),b[k]&&Tt(n);$e(n),i=$e(n),i==3&&ht(n,1),A=$e(n),b=$e(n);var O=k=0,D=0,z=0;return Ye(n)&&(k+=$e(n),O+=$e(n),D+=$e(n),z+=$e(n)),t.width=String(A-(k+O)*(i===1||i===2?2:1)),t.height=String(b-(D+z)*(i===1?2:1)),n=function(P){for(var B=0,G=0;32>G;G++)B|=(P>>G&1)<<31-G;return B>>>0}(c),l=l==1?"H":"L",s="hvc1"+("."+["","A","B","C"][s]+u),s+="."+n.toString(16).toUpperCase(),s+="."+l+T,C&&(s+="."+C.toString(16).toUpperCase()),w&&(s+="."+w.toString(16).toUpperCase()),y&&(s+="."+y.toString(16).toUpperCase()),g&&(s+="."+g.toString(16).toUpperCase()),d&&(s+="."+d.toString(16).toUpperCase()),e&&(s+="."+e.toString(16).toUpperCase()),t.codec=s,t}function Jm(e,t){var n=1;for(e>t&&(n=-1);4294967296<Math.abs(t-e);)e+=8589934592*n;return e}function Oa(e){return!(0>td(e))}function td(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(e[n]==71&&e[n+188]==71&&e[n+376]==71)return n;n++}return-1}he("shaka.util.TsParser",jt),jt.syncOffset=td,jt.probe=Oa,jt.prototype.getVideoInfo=jt.prototype.kf,jt.prototype.getVideoResolution=jt.prototype.gi,jt.prototype.getVideoNalus=jt.prototype.Pd,jt.prototype.getCodecs=jt.prototype.$c,jt.prototype.getStartTime=jt.prototype.getStartTime,jt.prototype.getVideoData=jt.prototype.Fc,jt.prototype.getAudioData=jt.prototype.Tb,jt.prototype.getMetadata=jt.prototype.getMetadata,jt.prototype.parseNalus=jt.prototype.Cf,jt.prototype.parseAvcNalus=jt.prototype.Ci,jt.prototype.parse=jt.prototype.parse,jt.prototype.clearData=jt.prototype.clearData,jt.Timescale=9e4;var NC=[100,110,122,244,44,83,86,118,128,138,139,134];function Ua(e,t,n){this.g=null,this.o=-1,this.l=e,this.i=t,this.m=n,this.j=!1;e:{if(typeof libDPIModule>"u"&&Fe("Could not find LCEVC Library dependencies on this page"),typeof LCEVCdec<"u")this.h=LCEVCdec;else if(typeof LcevcDil<"u")this.h=LcevcDil,this.j=!0,vt("LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead");else{Fe("Could not find LCEVC Library on this page"),e=!1;break e}typeof this.h.SupportObject>"u"?(Fe("Could not find LCEVC Library on this page"),e=!1):(this.h.SupportObject.SupportStatus||Fe(this.h.SupportObject.SupportError),e=typeof this.h<"u"&&typeof libDPIModule<"u"&&this.i instanceof HTMLCanvasElement&&this.h.SupportObject.SupportStatus)}e&&!this.g&&this.h.SupportObject.webGLSupport(this.i)&&(this.i.classList.remove("shaka-hidden"),this.g=this.j?new this.h.LcevcDil(this.l,this.i,this.m):new this.h.LCEVCdec(this.l,this.i,this.m))}function ey(e){e.g&&e.i.classList.add("shaka-hidden")}Ua.prototype.release=function(){this.g&&(this.g.close(),this.g=null)};function ty(e,t,n){var i=0,s=-1;switch(t.mimeType){case"video/webm":i=1;break;case"video/mp4":i=2}switch(n){case"DASH":s=1;break;case"HLS":s=0}e.g&&(e.o=t.id,e.g.setLevelSwitching(t.id,!0),e.g.setContainerFormat(i),e.j||e.g.setStreamingFormat(s))}he("shaka.lcevc.Dec",Ua),Ua.prototype.release=Ua.prototype.release;function ny(e,t,n,i){var s=this;this.i=e,this.da=n,this.A=null,this.F=t,this.h={},this.G={},this.Da={},this.g=null,this.fa=!1,this.Z=i||null,this.l={},this.s=new lt,this.j={},this.H=null,this.L=new _t,this.N="",this.qa=!1,this.m=iy(this,this.L),this.C=!1,this.I=new rs(function(){return UC(s)}),this.B=!1,this.ba="UNKNOWN",this.Ea=this.Fa=!1,this.za=new _t,this.o=!1,this.xa=!0,this.pa=this.R=this.ya=this.U=this.K=this.ea=null,this.oa=new _t}function iy(e,t){if(p.ManagedMediaSource){e.i.disableRemotePlayback=!0;var n=new ManagedMediaSource;return e.s.D(n,"startstreaming",function(){e.xa=!0}),e.s.D(n,"endstreaming",function(){e.xa=!1}),e.s.ha(n,"sourceopen",function(){URL.revokeObjectURL(e.N),t.resolve()}),e.s.ha(e.i,"playing",function(){e.qa=!0}),e.N=Uu(n),e.i.src=e.N,n}return n=new MediaSource,e.s.ha(n,"sourceopen",function(){URL.revokeObjectURL(e.N),t.resolve()}),e.s.ha(e.i,"playing",function(){e.qa=!0}),e.N=Uu(n),e.i.src=e.N,n}function OC(e,t){var n,i,s,l,u,c,d,g,y,w,C;return $(function(T){if(T.g==1)return e.createSegmentIndex?E(T,e.createSegmentIndex(),2):T.u(2);if(!e.segmentIndex)return T.return(!1);if(e.segmentIndex.getNumReferences()==0)return T.return(!0);for(n=sn,i=new Set,s=x(e.segmentIndex),l=s.next();!l.done;l=s.next())if(u=l.value,c=u.mimeType||e.mimeType||"",d=u.codecs||e.codecs||"",g=c+":"+d,!i.has(g)){if(i.add(g),t==n.ua){if(y=an(c,d),!Ea(y))return T.return(!1)}else if(t==n.ga?d=ka(d):t==n.X&&(d=Jr(d,c)),w=ET(e,c,d),C=Er(c,d),!Lt(w)&&!zo(C))return T.return(!1)}return T.return(!0)})}a=ny.prototype,a.destroy=function(){return this.I.destroy()};function UC(e){var t,n,i,s,l,u,c,d;return $(function(g){if(g.g==1){t=[];for(n in e.l)for(i=e.l[n],s=i[0],e.l[n]=i.slice(0,1),s&&t.push(s.p.catch(jg)),l=x(i.slice(1)),u=l.next();!u.done;u=l.next())c=u.value,c.p.reject(new K(2,7,7003,void 0));e.g&&t.push(e.g.destroy()),e.F&&t.push(e.F.destroy());for(d in e.j)t.push(e.j[d].destroy());return E(g,Promise.all(t),2)}e.s&&(e.s.release(),e.s=null),e.i&&(e.i.removeAttribute("src"),e.i.load(),e.i=null),e.A=null,e.m=null,e.g=null,e.F=null,e.h={},e.j={},e.H=null,e.l={},e.Z=null,e.K=null,e.da=null,F(g)})}a.init=function(e,t,n,i){t=t===void 0?!1:t,n=n===void 0?"UNKNOWN":n,i=i===void 0?!1:i;var s=this,l,u,c,d,g;return $(function(y){switch(y.g){case 1:return l=sn,E(y,s.L,2);case 2:s.B=t,s.ba=n,s.Fa=i,s.Ea=!s.B&&s.ba=="HLS"&&!s.Fa,s.K=null,u=x(e.keys()),c=u.next();case 3:if(c.done){y.u(0);break}return d=c.value,g=e.get(d),E(y,Pu(s,d,g,g.codecs),6);case 6:s.o?(s.l[l.X]=[],s.l[l.ga]=[]):s.l[d]=[],c=u.next(),y.u(3)}})};function Pu(e,t,n,i){var s,l,u,c,d,g,y,w,C,T,A,b;return $(function(k){switch(k.g){case 1:return s=sn,l=Re,u=Ve,E(k,OC(n,t),2);case 2:if(u.call(l,k.h,"Type negotiation should happen before MediaSourceEngine.init!"),c=an(n.mimeType,i),t==s.ua){Du(e,c,e.B,n.external),k.u(0);break}if(d=e.A.forceTransmux,(!Lt(c)||!e.B&&Xo.includes(c))&&(d=!0),g=Er(n.mimeType,i),!d){k.u(4);break}if(y=qn(s.X,(i||"").split(",")),w=qn(s.ga,(i||"").split(",")),!y||!w){k.u(5);break}return e.o=!0,E(k,Pu(e,s.X,n,y),6);case 6:return E(k,Pu(e,s.ga,n,w),7);case 7:return k.return();case 5:(C=zo(g))&&(T=C(),e.j[t]=T,c=T.convertCodecs(t,g));case 4:A=c+e.A.addExtraFeaturesToSourceBuffer(c),Dt(e.I);try{b=e.m.addSourceBuffer(A)}catch(O){throw new K(2,3,3015,O,"The mediaSource_ status was "+e.m.readyState+" expected 'open'",null)}e.B&&(b.mode=YC),e.s.D(b,"error",function(){var O=e.l[t][0];O.p.reject(new K(2,3,3014,e.i.error?e.i.error.code:0,O.uri))}),e.s.D(b,"updateend",function(){return Mo(e,t)}),e.h[t]=b,e.G[t]=c,e.Da[t]=!!n.drmInfos.length,F(k)}})}a.configure=function(e){this.A=e,this.g&&(this.g.A=e.modifyCueCallback)};function Du(e,t,n,i){e.g||(e.g=new To(e.F),e.g&&(e.g.A=e.A.modifyCueCallback));var s=e.g;i=i||e.fa,e=e.ba,t=="application/cea-608"||t=="application/cea-708"?s.i=null:(s.i=(0,ln[t])(),s.i.setSequenceMode?s.i.setSequenceMode(n):vt("Text parsers w/ setSequenceMode",'Text parsers should have a "setSequenceMode" method!'),s.i.setManifestType?s.i.setManifestType(e):vt("Text parsers w/ setManifestType",'Text parsers should have a "setManifestType" method!'),s.B=i)}function oy(e){return e.C?!1:e.m?e.m.readyState=="ended":!0}function nd(e,t){return e.C||!Object.keys(e.h).length?e=null:t==mt?e=e.g.g:(e=cs(e,t),e=!e||Da(e)?null:e.length==1&&0>e.start(0)?0:e.length?e.start(0):null),e}function Ba(e,t){return e.C?null:t==mt?e.g.h:qh(cs(e,t))}function BC(e,t,n){return e.C?0:t==mt?(e=e.g,e.h==null||e.h<n?0:e.h-Math.max(n,e.g)):(e=cs(e,t),Xm(e,n))}a.wb=function(){var e={total:this.C?[]:Ko(this.i.buffered),audio:this.C?[]:Ko(cs(this,"audio")),video:this.C?[]:Ko(cs(this,"video")),text:[]};if(this.g){var t=this.g.g,n=this.g.h;t!=null&&n!=null&&e.text.push({start:t,end:n})}return e};function cs(e,t){try{return e.h[t].buffered}catch{return null}}function jC(e,t,n,i,s,l){var u=null,c=Ze(n);if(Xo.includes(s))l=Mr(c),l.length&&i&&((t=l.find(function(w){return w.description==="com.apple.streaming.transportStreamTimestamp"}))&&t.data&&(u=Math.round(t.data)/1e3),e.da.onMetadata([{cueTime:i.startTime,data:c,frames:l,dts:i.startTime,pts:i.startTime}],0,i.endTime));else if(s.includes("/mp4")&&i&&i.timestampOffset==0&&i.$&&i.$.timescale){var d=i.$.timescale;if(!isNaN(d)){var g=0,y=!1;new Ot().box("moof",dt).box("traf",dt).S("tfdt",function(w){g=Ru(w.reader,w.version).baseMediaDecodeTime/d,y=!0,w.parser.stop()}).parse(n,!0),y&&(u=g)}}else!s.includes("/mp4")&&!s.includes("/webm")&&Oa(c)&&(e.K?e.K.clearData():e.K=new jt,c=e.K.parse(c),t=c.getStartTime(t),t!=null&&(u=t),c=c.getMetadata(),c.length)&&e.da.onMetadata(c,l,i?i.endTime:null);return u}function Nu(e,t,n,i,s,l,u,c,d,g){u=u===void 0?!1:u,c=c===void 0?!1:c,d=d===void 0?!1:d,g=g===void 0?!1:g;var y,w,C,T,A,b,k,O,D,z,P,B,G,q;return $(function(J){switch(J.g){case 1:if(y=sn,t!=y.ua){J.u(2);break}if(!e.B){J.u(3);break}return E(J,e.za,4);case 4:w=J.h,e.g.s=w;case 3:return E(J,kT(e.g,n,i?i.startTime:null,i?i.endTime:null,i?i.M()[0]:null),5);case 5:return J.return();case 2:if(g||!e.o){J.u(6);break}return E(J,Nu(e,y.X,n,i,s,l,u,c,d,!0),7);case 7:return E(J,Nu(e,y.ga,n,i,s,l,u,c,d,!0),8);case 8:return J.return();case 6:if(!e.h[t])return J.return();if(C=e.h[t].timestampOffset,T=e.G[t],e.j[t]&&(T=e.j[t].getOriginalMimeType()),i&&(A=jC(e,t,n,i,T,C),A!=null&&(e.U==null&&t==y.ga&&(e.U=A,e.ya=i.startTime,e.R!=null&&(b=0,e.ya==e.pa&&(b=e.U-e.R),e.oa.resolve(b))),e.R==null&&t==y.X&&(e.R=A,e.pa=i.startTime,e.U!=null&&(k=0,e.ya==e.pa&&(k=e.U-e.R),e.oa.resolve(k))),O=i.startTime-A,D=Math.abs(C-O),(.001<=D||u||c)&&(!d||0<O||!C)&&(C=O,e.Ea&&(pn(e,t,function(){return hs(e,t)},null),pn(e,t,function(){return ds(e,t,C)},null))),z=t==y.ga||!(y.ga in e.h),e.B&&z&&e.za.resolve(C))),l&&t==y.ga&&(e.g||Du(e,"application/cea-608",e.B,!1),e.H||(P=T.split(";",1)[0],e.H=new fn(P)),i?(B=e.H.i(n),B.length&&IT(e.g,B,i.startTime,i.endTime,C)):e.H.init(n,c)),!e.j[t]){J.u(9);break}return E(J,e.j[t].transmux(n,s,i,e.m.duration,t),10);case 10:n=J.h;case 9:if(n=zC(e,n,i?i.startTime:null,t,i?i.M()[0]:null),!i||!e.B||t==y.ua){J.u(11);break}if(!u&&!c){J.u(11);break}if(G=i.startTime,e.ba!="HLS"||e.o||t!=y.X||!e.h[y.ga]){J.u(13);break}return E(J,e.oa,14);case 14:q=J.h,.1<Math.abs(q)&&(G-=q);case 13:pn(e,t,function(){return hs(e,t)},null),pn(e,t,function(){return ds(e,t,G)},null);case 11:return E(J,pn(e,t,function(){var fe=n;if(t=="video"&&e.Z){var te=e.Z;te.g&&te.g.appendBuffer(fe,"video",te.o,-C)}e.h[t].appendBuffer(fe)},i?i.M()[0]:null),15);case 15:F(J)}})}function FC(e,t){var n=Ba(e,"video")||0;Ug(e.g,t,n)}function $C(e){e.g&&Ug(e.g,"",0)}a.remove=function(e,t,n){var i=this,s;return $(function(l){return l.g==1?(s=sn,e==s.ua?E(l,i.g.remove(t,n),0):E(l,pn(i,e,function(){return Ou(i,e,t,n)},null),4)):i.o?E(l,pn(i,s.X,function(){return Ou(i,s.X,t,n)},null),0):l.u(0)})};function ry(e,t){var n;return $(function(i){return i.g==1?(n=sn,t==n.ua?e.g?E(i,e.g.remove(0,1/0),0):i.return():E(i,pn(e,t,function(){return Ou(e,t,0,e.m.duration)},null),4)):e.o?E(i,pn(e,n.X,function(){return Ou(e,n.X,0,e.m.duration)},null),0):i.u(0)})}a.flush=function(e){var t=this,n;return $(function(i){return i.g==1?(n=sn,e==n.ua?i.return():E(i,pn(t,e,function(){t.i.currentTime-=.001,Mo(t,e)},null),2)):t.o?E(i,pn(t,n.X,function(){var s=n.X;t.i.currentTime-=.001,Mo(t,s)},null),0):i.u(0)})};function VC(e,t,n,i,s,l,u,c,d){var g,y,w;return $(function(C){return C.g==1?(g=sn,t==g.ua?(l||(e.g.s=n),bT(e.g,i,s),C.return()):(y=[],E(C,WC(e,t,u,c,d),2))):(w=C.h,w||(y.push(pn(e,t,function(){return hs(e,t)},null)),e.o&&y.push(pn(e,g.X,function(){return hs(e,g.X)},null))),l||(y.push(pn(e,t,function(){return ds(e,t,n)},null)),e.o&&y.push(pn(e,g.X,function(){return ds(e,g.X,n)},null))),y.push(pn(e,t,function(){e.h[t].appendWindowStart=0,e.h[t].appendWindowEnd=s,e.h[t].appendWindowStart=i,Mo(e,t)},null)),e.o&&y.push(pn(e,g.X,function(){var T=g.X;e.h[T].appendWindowStart=0,e.h[T].appendWindowEnd=s,e.h[T].appendWindowStart=i,Mo(e,T)},null)),E(C,Promise.all(y),0))})}function HC(e,t,n){var i;return $(function(s){return s.g==1?(i=sn,t==i.ua?s.return():(t==i.ga&&(e.za=new _t),pn(e,t,function(){return hs(e,t)},null),e.o&&pn(e,i.X,function(){return hs(e,i.X)},null),E(s,pn(e,t,function(){return ds(e,t,n)},null),2))):e.o?E(s,pn(e,i.X,function(){return ds(e,i.X,n)},null),0):s.u(0)})}a.endOfStream=function(e){var t=this;return $(function(n){return E(n,id(t,function(){oy(t)||t.m.readyState==="closed"||(e?t.m.endOfStream(e):t.m.endOfStream())}),0)})},a.Za=function(e){var t=this;return $(function(n){return E(n,id(t,function(){if(e<t.m.duration)for(var i in t.h){var s={start:function(){},p:new _t,uri:null};t.l[i].unshift(s)}t.m.duration=e,t.ea=e}),0)})},a.getDuration=function(){return this.m.duration};function Ou(e,t,n,i){i<=n?Mo(e,t):e.h[t].remove(n,i)}function hs(e,t){var n=e.h[t].appendWindowStart,i=e.h[t].appendWindowEnd;e.h[t].abort(),e.h[t].appendWindowStart=n,e.h[t].appendWindowEnd=i,Mo(e,t)}function ds(e,t,n){0>n&&(n+=.001),e.h[t].timestampOffset=n,Mo(e,t)}function Mo(e,t){if(!e.C){var n=e.l[t][0];n&&(n.p.resolve(),od(e,t))}}function pn(e,t,n,i){return Dt(e.I),n={start:n,p:new _t,uri:i},e.l[t].push(n),e.l[t].length==1&&sy(e,t),n.p}function id(e,t){var n,i,s,l,u,c,d;return $(function(g){switch(g.g){case 1:Dt(e.I),n=[],i={};for(s in e.h)i={ready:void 0},i.ready=new _t,l={start:function(y){return function(){return y.ready.resolve()}}(i),p:i.ready,uri:null},e.l[s].push(l),n.push(i.ready),e.l[s].length==1&&l.start();return ue(g,2),E(g,Promise.all(n),4);case 4:ge(g,3);break;case 2:throw u=ie(g),u;case 3:return ue(g,5,6),E(g,t(),6);case 6:ee(g);for(c in e.h)od(e,c);de(g,0);break;case 5:throw d=ie(g),new K(2,3,3015,d,e.i.error||"No error in the media element",null)}})}function od(e,t){e.l[t].shift(),sy(e,t)}function sy(e,t){var n=e.l[t][0];if(n)try{n.start()}catch(i){i.name=="QuotaExceededError"?n.p.reject(new K(2,3,3017,t)):n.p.reject(new K(2,3,3015,i,e.i.error||"No error in the media element",n.uri)),od(e,t)}}function zC(e,t,n,i,s){var l=n==null,u=e.Da[i];return n=e.da.Qh(),(l=e.A.insertFakeEncryptionInInit&&l&&u)&&(n=vh(n),l=so()||ro()||wh()||Ta()&&Sh()&&n),l&&hu(e.G[i])=="mp4"&&(t=kC(t,s)),t}function GC(e,t,n,i){return pn(e,t,function(){t!==mt&&(ut()&&(e.j[t]&&(e.j[t].destroy(),delete e.j[t]),i&&(e.j[t]=i),e.h[t].changeType(n+e.A.addExtraFeaturesToSourceBuffer(n)),e.G[t]=n),Mo(e,t))},null)}function XC(e,t){var n,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe;return $(function(te){switch(te.g){case 1:n=sn,e.C=!0,e.o=!1,i=e.i.currentTime,s=e.i.autoplay,l=e.i.paused,e.qa&&(e.i.autoplay=!1),ye(te,2),e.s.Ra(),u=[];for(c in e.j)u.push(e.j[c].destroy());for(d in e.l)for(g=e.l[d],y=g[0],e.l[d]=g.slice(0,1),y&&u.push(y.p.catch(jg)),w=x(g.slice(1)),C=w.next();!C.done;C=w.next())T=C.value,T.p.reject(new K(2,7,7003,void 0));for(A in e.h){b=e.h[A];try{e.m.removeSourceBuffer(b)}catch{}}return E(te,Promise.all(u),4);case 4:return e.j={},e.h={},k=e.m.duration,e.L=new _t,e.m=iy(e,e.L),E(te,e.L,5);case 5:!isNaN(k)&&k?e.m.duration=k:!isNaN(e.ea)&&e.ea&&(e.m.duration=e.ea),O=new _t,D=e.m.sourceBuffers,z=t.size,P=0,B=function(){P++,P===z&&(O.resolve(),e.s.jb(D,"addsourcebuffer",B))},e.s.D(D,"addsourcebuffer",B),G=x(t.keys()),q=G.next();case 6:return q.done?(e.i.currentTime=i,E(te,O,2)):(J=q.value,fe=t.get(J),E(te,Pu(e,J,fe,fe.codecs),9));case 9:e.o?(e.l[n.X]=[],e.l[n.ga]=[]):e.l[J]=[],q=G.next(),te.u(6);break;case 2:ee(te),e.C=!1,Dt(e.I),e.s.ha(e.i,"canplaythrough",function(){e.I.g||(e.i.autoplay=s,l||e.i.play())}),de(te,0)}})}function ay(e,t){return id(e,function(){return XC(e,t)})}function WC(e,t,n,i,s){var l,u,c,d,g,y,w,C,T,A,b,k,O,D,z;return $(function(P){return P.g==1?(l=sn,t==l.ua?P.return(!1):(u=Vn(di(e.G[t])),c=Ni(e.G[t]),g=!1,y=an(n,i),w=e.A.forceTransmux,(!Lt(y)||!e.B&&Xo.includes(y))&&(w=!0),w&&(C=Er(n,i),T=zo(C))&&(d=T(),A=qn(l.X,(i||"").split(",")),b=qn(l.ga,(i||"").split(",")),A&&b?(g=!0,k=b,t==l.X&&(k=A),y=d.convertCodecs(t,Er(n,k))):y=d.convertCodecs(t,C)),O=Vn(di(y)),D=Ni(y),u===O&&c===D?(e.j[t]&&!d?(e.j[t].destroy(),delete e.j[t]):!e.j[t]&&d?e.j[t]=d:d&&(e.j[t]&&e.j[t].transmux!=d.transmux?(e.j[t].destroy(),delete e.j[t],e.j[t]=d):d.destroy()),P.return(!1)):(z=!0,(e.o||g&&d&&!e.j[t])&&(z=!1),z&&e.A.codecSwitchingStrategy==="smooth"&&ut()?E(P,GC(e,t,y,d),3):(d&&d.destroy(),E(P,ay(e,s),3))))):P.return(!0)})}function qC(e,t,n,i){if(t==mt)var s=!1;else{s=Vn(di(e.G[t]));var l=Ni(e.G[t]),u=an(n,i),c=e.A.forceTransmux;(!Lt(u)||!e.B&&Xo.includes(u))&&(c=!0),n=Er(n,i),c&&(c=zo(n))&&(c=c(),u=c.convertCodecs(t,n),c.destroy()),t=Vn(di(u)),u=Ni(u),s=s!==t||l!==u}return s?e.A.codecSwitchingStrategy!=="smooth"||!ut()||e.o:!1}var Uu=p.URL.createObjectURL,YC="sequence";function Qe(e,t,n){this.i=e,this.A=t,this.o=this.j=1/0,this.g=1,this.h=this.l=null,this.B=0,this.G=!0,this.H=0,this.C=n===void 0?!0:n,this.F=0,this.s=!1,this.m=e}a=Qe.prototype,a.getDuration=function(){return this.j},a.Sh=function(){return this.g},a.dh=function(e){this.i=e},a.Za=function(e){this.j=e},a.Xh=function(){return this.i},a.ah=function(e){this.B=e},a.sc=function(e){this.G=e},a.pe=function(e){this.o=e},a.Od=function(){return this.o},a.Of=function(e){this.A=e},a.Lh=function(){return this.A},a.Ng=function(e,t){if(e.length!=0){var n=(Date.now()+this.B)/1e3;if(e=e.filter(function(s){return s.start+t<n}),e.length!=0){var i=e[e.length-1].end+t;this.ce(e[0].start+t),this.g=e.reduce(function(s,l){return Math.max(s,l.end-l.start)},this.g),this.h=Math.max(this.h,i),this.i!=null&&this.C&&!this.s&&(this.i=n-this.h-this.g)}}},a.sd=function(e){if(e.length!=0){var t=e[0].startTime,n=e[0].endTime,i=(Date.now()+this.B)/1e3;e=x(e);for(var s=e.next();!s.done;s=e.next())s=s.value,i<s.startTime||(t=Math.min(t,s.startTime),n=Math.max(n,s.endTime),this.g=Math.max(this.g,s.endTime-s.startTime));this.ce(t),this.h=Math.max(this.h,n),this.i!=null&&this.C&&!this.s&&(this.i=i-this.h-this.g)}},a.Th=function(){return this.h},a.Wd=function(){this.s=!0},a.si=function(){return this.s},a.bh=function(e){this.m=e},a.Ph=function(){return this.m},a.ce=function(e){this.l=this.l==null?e:Math.min(this.l,e)},a.xf=function(e){this.g=Math.max(this.g,e)},a.offset=function(e){this.l!=null&&(this.l+=e),this.h!=null&&(this.h+=e)},a.V=function(){return this.j==1/0&&!this.G},a.kc=function(){return this.j!=1/0&&!this.G},a.mb=function(){return Math.max(this.H,this.Wb()-this.o)},a.hh=function(e){this.H=e},a.Wb=function(){return this.V()||this.kc()?Math.min(Math.max(0,(Date.now()+this.B)/1e3-this.g-this.i)+this.F,this.j):this.h?Math.min(this.h,this.j):this.j},a.bd=function(e){var t=Math.max(this.l,this.H);return this.o==1/0?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.Wb()-this.o+e,this.yb()))},a.Vb=function(){return this.bd(0)},a.yb=function(){return Math.max(0,this.Wb()-(this.V()||this.kc()?this.A:0))},a.nh=function(){return!(this.i==null||this.h!=null&&this.C)},a.$g=function(e){this.F=e},a.Jh=function(){return this.F},he("shaka.media.PresentationTimeline",Qe),Qe.prototype.getAvailabilityTimeOffset=Qe.prototype.Jh,Qe.prototype.setAvailabilityTimeOffset=Qe.prototype.$g,Qe.prototype.usingPresentationStartTime=Qe.prototype.nh,Qe.prototype.getSeekRangeEnd=Qe.prototype.yb,Qe.prototype.getSeekRangeStart=Qe.prototype.Vb,Qe.prototype.getSafeSeekRangeStart=Qe.prototype.bd,Qe.prototype.getSegmentAvailabilityEnd=Qe.prototype.Wb,Qe.prototype.setUserSeekStart=Qe.prototype.hh,Qe.prototype.getSegmentAvailabilityStart=Qe.prototype.mb,Qe.prototype.isInProgress=Qe.prototype.kc,Qe.prototype.isLive=Qe.prototype.V,Qe.prototype.offset=Qe.prototype.offset,Qe.prototype.notifyMaxSegmentDuration=Qe.prototype.xf,Qe.prototype.notifyMinSegmentStartTime=Qe.prototype.ce,Qe.prototype.getInitialProgramDateTime=Qe.prototype.Ph,Qe.prototype.setInitialProgramDateTime=Qe.prototype.bh,Qe.prototype.isStartTimeLocked=Qe.prototype.si,Qe.prototype.lockStartTime=Qe.prototype.Wd,Qe.prototype.getMaxSegmentEndTime=Qe.prototype.Th,Qe.prototype.notifySegments=Qe.prototype.sd,Qe.prototype.notifyTimeRange=Qe.prototype.Ng,Qe.prototype.getDelay=Qe.prototype.Lh,Qe.prototype.setDelay=Qe.prototype.Of,Qe.prototype.getSegmentAvailabilityDuration=Qe.prototype.Od,Qe.prototype.setSegmentAvailabilityDuration=Qe.prototype.pe,Qe.prototype.setStatic=Qe.prototype.sc,Qe.prototype.setClockOffset=Qe.prototype.ah,Qe.prototype.getPresentationStartTime=Qe.prototype.Xh,Qe.prototype.setDuration=Qe.prototype.Za,Qe.prototype.setPresentationStartTime=Qe.prototype.dh,Qe.prototype.getMaxSegmentDuration=Qe.prototype.Sh,Qe.prototype.getDuration=Qe.prototype.getDuration;function ly(e,t,n){this.j=n,this.l=e,this.s=uy(e),this.g=e.g.currentTime,this.m=Date.now()/1e3,this.h=!1,this.o=0,this.A=t,this.i=function(){}}ly.prototype.release=function(){this.j=this.l=null,this.i=function(){}};function KC(e,t){e.i=t}function ZC(e){this.g=e}function uy(e){if(e.g.paused||e.g.playbackRate==0||e.g.buffered.length==0)var t=!1;else e:{t=e.g.currentTime,e=x(Ko(e.g.buffered));for(var n=e.next();!n.done;n=e.next())if(n=n.value,!(t<n.start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function rd(e,t,n,i,s){var l=this;this.A=s,this.g=e,this.B=t,this.s=n,this.l=new lt,this.j=!1,this.F=e.readyState,this.C=this.i=0,this.h=i,this.o=!1,this.l.D(e,"waiting",function(){return sd(l)}),this.m=new ct(function(){sd(l)}).Sa(this.s.gapJumpTimerTime)}rd.prototype.release=function(){this.l&&(this.l.release(),this.l=null),this.m!=null&&(this.m.stop(),this.m=null),this.h&&(this.h.release(),this.h=null),this.g=this.B=this.A=null},rd.prototype.Af=function(){this.o=!0,sd(this)};function sd(e){if(e.g.readyState!=0){if(e.g.seeking){if(!e.j)return}else e.j=!1;if(!e.g.paused||e.g.currentTime==e.i&&(e.g.autoplay||e.g.currentTime!=e.i)){e.g.readyState!=e.F&&(e.F=e.g.readyState);var t;if(!(t=!e.h)){t=e.h;var n=t.l,i=uy(n),s=n.g.currentTime,l=Date.now()/1e3;(t.g!=s||t.s!=i)&&(t.m=l,t.g=s,t.s=i,t.h=!1),s=l-t.m,(i=s>=t.A&&i&&!t.h)&&(t.i(t.g,s),t.h=!0,t.g=n.g.currentTime,t.o++,t.j(new Ue("stalldetected"))),t=!i}t&&(t=e.g.currentTime,n=e.g.buffered,i=MC(n,t,e.s.gapDetectionThreshold),i!=null&&(i!=0||e.o))&&(s=n.start(i),(navigator.userAgent.match(/Edge\//)||ro())&&(s=Math.ceil(100*(s+.01))/100),s>=e.B.yb()||.001>s-t||(i!=0&&n.end(i-1),e.g.currentTime=s,t==e.i&&(e.i=s),e.C++,e.A(new Ue("gapjumped"))))}}}function ps(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=QC.value().get(t),n.ha(e,t,i))}var QC=new Gr(function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])});function fy(e,t,n,i){var s=this;this.g=e,this.m=t,this.s=n,this.l=null,this.j=function(){return s.l==null&&(s.l=i()),s.l},this.o=!1,this.h=new lt,this.i=new py(e),ps(this.g,HTMLMediaElement.HAVE_METADATA,this.h,function(){hy(s,s.j())})}fy.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.i!=null&&(this.i.release(),this.i=null),this.m=function(){},this.g=null};function ad(e){return e.o?e.g.currentTime:e.j()}function cy(e,t){0<e.g.readyState?gy(e.i,t):ps(e.g,HTMLMediaElement.HAVE_METADATA,e.h,function(){hy(e,e.j())})}function hy(e,t){.001>Math.abs(e.g.currentTime-t)?dy(e):(e.h.ha(e.g,"seeking",function(){dy(e)}),gy(e.i,e.g.currentTime&&e.g.currentTime!=0?e.g.currentTime:t))}function dy(e){e.o=!0,e.h.D(e.g,"seeking",function(){return e.m()}),e.s(e.g.currentTime)}function py(e){var t=this;this.g=e,this.m=10,this.j=this.l=this.i=0,this.h=new ct(function(){0>=t.i||t.g.currentTime!=t.l||t.g.currentTime===t.j?t.h.stop():(t.g.currentTime=t.j,t.i--)})}py.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null};function gy(e,t){e.l=e.g.currentTime,e.j=t,e.i=e.m,e.g.currentTime=t,e.h.Sa(.1)}function my(e){this.h=e,this.j=!1,this.g=null,this.i=new lt}a=my.prototype,a.ready=function(){function e(){if(t.g==null||t.g==0&&t.h.duration!=1/0)t.j=!0;else{var n=t.h.currentTime,i=t.g;0>t.g&&(i=Math.max(0,n+t.g)),n!=i?(t.i.ha(t.h,"seeking",function(){t.j=!0}),t.h.currentTime=i):t.j=!0}}var t=this;ps(this.h,HTMLMediaElement.HAVE_CURRENT_DATA,this.i,function(){e()})},a.release=function(){this.i&&(this.i.release(),this.i=null),this.h=null},a.Ee=function(e){this.g=this.j?this.g:e},a.yd=function(){return(this.j?this.h.currentTime:this.g)||0},a.gg=function(){return 0},a.fg=function(){return 0},a.Mg=function(){};function yy(e,t,n,i,s,l){var u=this;this.i=e,this.g=t.presentationTimeline,this.B=t.minBufferTime||0,this.l=n,this.A=s,this.s=null,this.o=JC(e,n,l),this.j=new rd(e,t.presentationTimeline,n,this.o,l),this.h=new fy(e,function(){e:{var c=u.j;c.j=!0,c.o=!1;var d=ad(u.h);if(c=xy(u,d),.001<Math.abs(c-d)){if(d=!1,!hi()||hi()&&fu())d=!0;else{var g=Date.now()/1e3;(!u.s||u.s<g-1)&&(u.s=g,d=!0)}if(d){cy(u.h,c),c=void 0;break e}}u.A(),c=void 0}return c},function(c){var d=u.j;d.g.seeking&&!d.j&&(d.j=!0,d.i=c)},function(){var c=i;return c==null?c=1/0>u.g.getDuration()?u.g.Vb():u.g.yb():0>c&&(c=u.g.yb()+c),vy(u,wy(u,c))}),this.m=new ct(function(){if(u.i.readyState!=0&&!u.i.paused){var c=ad(u.h),d=u.g.Vb(),g=u.g.yb();3>g-d&&(d=g-3),c<d&&(c=xy(u,c),u.i.currentTime=c)}})}a=yy.prototype,a.ready=function(){this.m.Sa(.25)},a.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.m&&(this.m.stop(),this.m=null),this.i=this.h=this.g=this.l=null,this.A=function(){}},a.Ee=function(e){cy(this.h,e)},a.yd=function(){var e=ad(this.h);return 0<this.i.readyState&&!this.i.paused?wy(this,e):e},a.gg=function(){return this.o?this.o.o:0},a.fg=function(){return this.j.C},a.Mg=function(){this.j.Af()};function vy(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function xy(e,t){var n=Math.max(e.B,e.l.rebufferingGoal),i=e.l.safeSeekOffset,s=e.g.Vb(),l=e.g.yb(),u=e.g.getDuration();3>l-s&&(s=l-3);var c=e.g.bd(n),d=e.g.bd(i);return n=e.g.bd(n+i),t>=u?vy(e,t):t>l?l:t<s?Yh(e.i.buffered,d)?d:n:t>=c||Yh(e.i.buffered,t)?t:n}function wy(e,t){var n=e.g.Vb();return t<n?n:(e=e.g.yb(),t>e?e:t)}function JC(e,t,n){if(!t.stallEnabled)return null;var i=t.stallSkip;return t=new ly(new ZC(e),t.stallThreshold,n),KC(t,function(){i?e.currentTime+=i:(e.pause(),e.play())}),t}function xt(e){this.O=e,this.l=null,this.i=0,this.m=!1}a=xt.prototype,a.getNumReferences=function(){return this.O.length},a.getNumEvicted=function(){return this.i},a.release=function(){this.m||(this.O=[],this.l&&this.l.stop(),this.l=null)},a.yi=function(){this.m=!0},a.Hb=function(e){for(var t=x(this.O),n=t.next();!n.done;n=t.next())e(n.value)},a.find=function(e){for(var t=this.O.length-1,n=t;0<=n;--n){var i=this.O[n],s=n<t?this.O[n+1].startTime:i.endTime;if(e>=i.startTime&&e<s)return n+this.i}return this.O.length&&e<this.O[0].startTime?this.i:null},a.get=function(e){return this.O.length==0?null:(e-=this.i,0>e||e>=this.O.length?null:this.O[e])},a.offset=function(e){if(!this.m)for(var t=x(this.O),n=t.next();!n.done;n=t.next())n.value.offset(e)},a.Zd=function(e){if(!this.m&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.O=this.O.filter(function(n){return Math.round(1e3*n.startTime)/1e3<t}),this.O.push.apply(this.O,L(e))}},a.rd=function(e,t){var n=this;e=e.filter(function(i){return i.endTime>t&&(n.O.length==0||i.endTime>n.O[0].startTime)}),this.Zd(e),this.Ma(t)},a.Ma=function(e){if(!this.m){var t=this.O.length;this.O=this.O.filter(function(n){return n.endTime>e}),this.i+=t-this.O.length}},a.Bc=function(e,t,n){if(n=n===void 0?!1:n,!this.m){for(;this.O.length&&this.O[this.O.length-1].startTime>=t;)this.O.pop();for(;this.O.length&&this.O[0].endTime<=e;)this.O.shift(),n||this.i++;this.O.length!=0&&(e=this.O[this.O.length-1],t=new Je(e.startTime,t,e.F,e.Ha,e.sa,e.$,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.g,e.tilesLayout,e.B,e.h,e.status,e.aesKey),t.mimeType=e.mimeType,t.codecs=e.codecs,t.i=e.i,this.O[this.O.length-1]=t)}},a.ue=function(e,t){var n=this;this.m||(this.l&&this.l.stop(),this.l=new ct(function(){var i=t();i?n.O.push.apply(n.O,L(i)):(n.l.stop(),n.l=null)}),this.l.Sa(e))},xt.prototype[Symbol.iterator]=function(){return this.Ib(0)},xt.prototype.Ib=function(e,t,n){t=t===void 0?!1:t,n=n===void 0?!1:n;var i=this.find(e);if(i==null)return null;var s=this.get(i);n?i++:i--;var l=-1;if(s&&0<s.g.length)for(var u=s.g.length-1;0<=u;--u){var c=s.g[u];if(e>=c.startTime&&e<c.endTime){if(!t){for(;u&&!c.l;)u--,c=s.g[u];if(!c.l)return Xe("No independent partial segment found!"),null}n?i--:i++,l=u-1;break}}return new pi(this,i,l,n)};function ld(e,t,n){return e=new Je(e,e+t,function(){return n},0,null,null,e,e,e+t),new xt([e])}he("shaka.media.SegmentIndex",xt),xt.forSingleSegment=ld,xt.prototype.getIteratorForTime=xt.prototype.Ib,xt.prototype.updateEvery=xt.prototype.ue,xt.prototype.fit=xt.prototype.Bc,xt.prototype.evict=xt.prototype.Ma,xt.prototype.mergeAndEvict=xt.prototype.rd,xt.prototype.offset=xt.prototype.offset,xt.prototype.get=xt.prototype.get,xt.prototype.find=xt.prototype.find,xt.prototype.markImmutable=xt.prototype.yi,xt.prototype.release=xt.prototype.release,xt.prototype.getNumEvicted=xt.prototype.getNumEvicted,xt.prototype.getNumReferences=xt.prototype.getNumReferences;function pi(e,t,n,i){this.i=e,this.h=t,this.g=n,this.reverse=i}pi.prototype.Sc=function(e){this.reverse=e},pi.prototype.Eh=function(){return this.h},pi.prototype.current=function(){var e=this.i.get(this.h);return e&&0<e.g.length&&e.o&&this.g>=e.g.length&&(this.h++,this.g=0,e=this.i.get(this.h)),e&&0<e.g.length?e.g[this.g]:e},pi.prototype.next=function(){var e=this.i.get(this.h);return this.reverse?e&&0<e.g.length?(this.g--,0>this.g&&(this.h--,this.g=(e=this.i.get(this.h))&&0<e.g.length?e.g.length-1:0)):(this.h--,this.g=0):e&&0<e.g.length?(this.g++,e.o&&this.g==e.g.length&&(this.h++,this.g=0)):(this.h++,this.g=0),e=this.current(),{value:e,done:!e}},he("shaka.media.SegmentIterator",pi),pi.prototype.next=pi.prototype.next,pi.prototype.current=pi.prototype.current,pi.prototype.currentPosition=pi.prototype.Eh,pi.prototype.setReverse=pi.prototype.Sc;function Jt(){xt.call(this,[]),this.g=[]}le(Jt,xt),a=Jt.prototype,a.clone=function(){var e=new Jt;return e.g=this.g.slice(),e},a.release=function(){for(var e=x(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g=[]},a.Hb=function(e){for(var t=x(this.g),n=t.next();!n.done;n=t.next())n.value.Hb(e)},a.find=function(e){for(var t=0,n=x(this.g),i=n.next();!i.done;i=n.next()){i=i.value;var s=i.find(e);if(s!=null)return s+t;t+=i.getNumEvicted()+i.getNumReferences()}return null},a.get=function(e){for(var t=0,n=x(this.g),i=n.next();!i.done;i=n.next()){i=i.value;var s=i.get(e-t);if(s)return s;s=i.getNumReferences(),t+=i.getNumEvicted()+s}return null},a.offset=function(){},a.Zd=function(){},a.Ma=function(){},a.rd=function(){},a.Bc=function(){},a.ue=function(){},he("shaka.media.MetaSegmentIndex",Jt),Jt.prototype.updateEvery=Jt.prototype.ue,Jt.prototype.fit=Jt.prototype.Bc,Jt.prototype.mergeAndEvict=Jt.prototype.rd,Jt.prototype.evict=Jt.prototype.Ma,Jt.prototype.merge=Jt.prototype.Zd,Jt.prototype.offset=Jt.prototype.offset,Jt.prototype.get=Jt.prototype.get,Jt.prototype.find=Jt.prototype.find,Jt.prototype.forEachTopLevelReference=Jt.prototype.Hb,Jt.prototype.release=Jt.prototype.release;function ja(e){var t=this;this.g=e,this.j=!1,this.i=this.g.Nd(),this.h=new ct(function(){t.g.Lg(.25*t.i)})}ja.prototype.release=function(){this.set(this.hc()),this.h&&(this.h.stop(),this.h=null),this.g=null},ja.prototype.set=function(e){this.i=e,Sy(this)},ja.prototype.hc=function(){return this.g.hc()};function Sy(e){e.h.stop();var t=e.j?0:e.i;if(0<=t)try{e.g.Nd()!=t&&e.g.Rf(t);return}catch{}e.h.Sa(.25),e.g.Nd()!=0&&e.g.Rf(0)}function Ty(e){var t=this;this.h=e,this.g=new Set,this.i=new ct(function(){Cy(t,!1)}).Sa(.25)}Ty.prototype.release=function(){this.i.stop();for(var e=x(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()};function Cy(e,t){for(var n=x(e.g),i=n.next();!i.done;i=n.next())i.value.j(e.h.currentTime,t)}function eE(){this.g=null,this.h=[]}function ud(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration),e=x(e.h);for(var i=e.next();!i.done;i=e.next())i=i.value,n+=i.state==t?i.duration:0;return n}function tE(e){function t(l){return{timestamp:l.timestamp,state:l.state,duration:l.duration}}for(var n=[],i=x(e.h),s=i.next();!s.done;s=i.next())n.push(t(s.value));return e.g&&n.push(t(e.g)),n}function nE(){this.i=this.h=null,this.g=[]}function fd(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function Bu(){this.Cd=this.Hg=this.A=this.B=this.I=this.C=this.s=this.j=this.H=this.m=this.i=this.U=this.Z=this.L=this.N=this.R=this.l=this.o=NaN,this.K=0,this.F=this.G=NaN,this.g=new eE,this.h=new nE}function ju(e,t,n,i){this.m=e,this.i=t,this.l=n,this.h=new Map,this.j=new Map,this.g=null,this.o=i}function iE(e,t){e.l=t,e=x(e.h.values());for(var n=e.next();!n.done;n=e.next())n.value.g=t}function Fa(e,t,n){if(n=n===void 0?!1:n,e.i.segmentIndex&&(e.g||(e.g=e.i.segmentIndex.Ib(t,!0,e.o)),e.g)){for(n&&e.g.next();e.h.size<e.m&&(t=e.g.next().value,!!t);)n=!0,t.preload&&t.sa!=null&&(n=!1),t.Yb()==2&&(n=!1),n&&t.$&&Ey(e,t.$),n&&!e.h.has(t)&&(n=new hd(e.l),by(n,t,e.i),e.h.set(t,n));cd(e)}}function Ey(e,t){if(e.i.segmentIndex&&!Array.from(e.j.keys()).some(function(i){return Wh(i,t)})){var n=new hd(e.l);by(n,t,e.i),e.j.set(t,n)}}function Ay(e,t){t=x(t.keys());for(var n=t.next();!n.done;n=t.next())(n=n.value)&&$a(e,n)}function Zi(e){Ay(e,e.h),Ay(e,e.j),e.g=null}ju.prototype.Ma=function(e,t){t=t===void 0?!1:t;for(var n=x(this.h.keys()),i=n.next();!i.done;i=n.next())i=i.value,e>i.endTime&&$a(this,i);t&&cd(this)},ju.prototype.Sc=function(e){this.o=e,this.g&&this.g.Sc(e)};function cd(e){for(var t=Array.from(e.h.keys()),n=x(e.j.keys()),i=n.next(),s={};!i.done;s={nf:void 0},i=n.next())s.nf=i.value,t.some(function(l){return function(u){return Wh(u.$,l.nf)}}(s))||$a(e,s.nf)}function ky(e,t){e.m=t;for(var n=Array.from(e.h.keys());n.length>t;){var i=n.pop();i&&$a(e,i)}cd(e)}function oE(e,t){t&&t!==e.i&&(Zi(e),e.i=t)}function $a(e,t){var n=e.h;t instanceof Kn&&(n=e.j),e=n.get(t),n.delete(t),e&&e.abort()}function hd(e){this.g=e,this.fe=this.Uf=null}function by(e,t,n){var i=new Uint8Array(0);e.fe=e.g(t,n,function(s){return $(function(l){if(l.g==1)return 0<i.byteLength?i=Qt(i,s):i=s,e.Uf?E(l,e.Uf(i),3):l.u(0);i=new Uint8Array(0),F(l)})})}hd.prototype.abort=function(){this.fe&&this.fe.abort()};function dd(e){Et.call(this);var t=this;this.g=new Set,this.i=e,this.h=new ct(function(){for(var n=t.i(),i=x(t.g),s=i.next();!s.done;s=i.next())s=s.value,s.endTime<n.start&&(t.g.delete(s),s=new Ue("regionremove",new Map([["region",s]])),t.dispatchEvent(s))}).Sa(2)}le(dd,Et),dd.prototype.release=function(){this.g.clear(),this.h.stop(),Et.prototype.release.call(this)};function Fu(e){Et.call(this),this.g=new Map,this.h=e}le(Fu,Et),Fu.prototype.release=function(){this.g.clear(),Et.prototype.release.call(this)};function rE(e,t){var n=e.g.get(t);return n||(n={ud:[],Pe:null,contentType:t},e.g.set(t,n)),n}function sE(e,t,n){var i=rE(e,t.contentType);aE(e,i),e={Hc:t,position:n},i=i.ud,t=i.findIndex(function(s){return s.position>=n}),0<=t?i.splice(t,i[t].position==n?1:0,e):i.push(e)}Fu.prototype.j=function(e){for(var t=x(this.g.values()),n=t.next();!n.done;n=t.next()){n=n.value;var i=n.Pe;e:{for(var s=n.ud,l=s.length-1;0<=l;l--){var u=s[l];if(u.position<=e){s=u.Hc;break e}}s=null}l=s&&!(i===s||i&&s&&i.bandwidth==s.bandwidth&&i.audioSamplingRate==s.audioSamplingRate&&i.codecs==s.codecs&&i.contentType==s.contentType&&i.frameRate==s.frameRate&&i.height==s.height&&i.mimeType==s.mimeType&&i.channelsCount==s.channelsCount&&i.pixelAspectRatio==s.pixelAspectRatio&&i.width==s.width),u=s&&i&&s.label&&i.label&&i.label!==s.label;var c=s&&i&&s.language&&i.language&&i.language!==s.language;i=s&&i&&s.roles&&i.roles&&!mr(i.roles,s.roles),(u||c||i)&&Iy(this,e,s.contentType)&&(n.Pe=s,i=new Ue("audiotrackchange",new Map([["quality",s],["position",e]])),this.dispatchEvent(i)),l&&Iy(this,e,s.contentType)&&(n.Pe=s,JSON.stringify(s),n=new Ue("qualitychange",new Map([["quality",s],["position",e]])),this.dispatchEvent(n))}};function Iy(e,t,n){return!!((e=e.h()[n])&&0<e.length&&(n=e[e.length-1].end,t>=e[0].start&&t<n))}function aE(e,t){if((e=e.h()[t.contentType])&&0<e.length){var n=e[0].start,i=e[e.length-1].end,s=t.ud;t.ud=s.filter(function(l,u){return!(l.position<=n&&u+1<s.length&&s[u+1].position<=n||l.position>=i)})}else t.ud=[]}function $u(e){var t={bandwidth:e.bandwidth||0,audioSamplingRate:null,codecs:e.codecs,contentType:e.type,frameRate:null,height:null,mimeType:e.mimeType,channelsCount:null,pixelAspectRatio:null,width:null,label:null,roles:e.roles,language:null};return e.type=="video"&&(t.frameRate=e.frameRate||null,t.height=e.height||null,t.pixelAspectRatio=e.pixelAspectRatio||null,t.width=e.width||null),e.type=="audio"&&(t.audioSamplingRate=e.audioSamplingRate,t.channelsCount=e.channelsCount,t.label=e.label||null,t.language=e.language),t}function Vu(e){var t=Ni(e),n=t.split("/")[0];return e=di(e),{type:n,mimeType:t,codecs:e,language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map,xd:null,colorGamut:null}}function lE(e,t){function n(P){k=P.name;var B=P.reader;B.skip(24);var G=B.la(),q=B.la();B.skip(50),w=String(G),y=String(q),P.reader.na()&&dt(P)}function i(P){var B=Zm(P.reader);C=B.channelCount,T=B.sampleRate,s(P.name)}function s(P){switch(P=P.toLowerCase(),P){case"avc1":case"avc3":u.push(P+".42E01E"),d=!0;break;case"hev1":case"hvc1":u.push(P+".1.6.L93.90"),d=!0;break;case"dvh1":case"dvhe":u.push(P+".05.04"),d=!0;break;case"vp09":u.push(P+".00.10.08"),d=!0;break;case"av01":u.push(P+".0.01M.08"),d=!0;break;case"mp4a":l.push("mp4a.40.2"),c=!0;break;case"ac-3":case"ec-3":case"ac-4":case"opus":case"flac":l.push(P),c=!0}}var l=[],u=[],c=!1,d=!1,g=null,y=null,w=null,C=null,T=null,A=null,b=null,k;if(new Ot().box("moov",dt).box("trak",dt).box("mdia",dt).S("mdhd",function(P){g=_u(P.reader,P.version).language}).box("minf",dt).box("stbl",dt).S("stsd",Wo).box("mp4a",function(P){var B=Zm(P.reader);C=B.channelCount,T=B.sampleRate,P.reader.na()?dt(P):s(P.name)}).box("esds",function(P){P=P.reader;for(var B="mp4a",G,q;P.na();){G=P.T();for(var J=P.T();J&128;)J=P.T();if(G==3)P.la(),J=P.T(),J&128&&P.la(),J&64&&P.skip(P.T()),J&32&&P.la();else if(G==4)q=P.T(),P.skip(12);else if(G==5)break}q&&(B+="."+Na(q),G==5&&P.na()&&(G=P.T(),q=(G&248)>>3,q===31&&P.na()&&(q=32+((G&7)<<3)+((P.T()&224)>>5)),B+="."+q)),l.push(B),c=!0}).box("ac-3",i).box("ec-3",i).box("ac-4",i).box("Opus",i).box("fLaC",i).box("avc1",n).box("avc3",n).box("hev1",n).box("hvc1",n).box("dva1",n).box("dvav",n).box("dvh1",n).box("dvhe",n).box("vp09",n).box("av01",n).box("avcC",function(P){var B=k||"";switch(k){case"dvav":B="avc3";break;case"dva1":B="avc1"}P=P.reader,P.skip(1),P=B+"."+Na(P.T())+Na(P.T())+Na(P.T()),u.push(P),d=!0}).box("hvcC",function(P){var B=k||"";switch(k){case"dvh1":B="hvc1";break;case"dvhe":B="hev1"}var G=P.reader;G.skip(1),P=G.T();var q=["","A","B","C"][P>>6],J=P&31,fe=G.P(),te=(P&32)>>5?"H":"L";P=[G.T(),G.T(),G.T(),G.T(),G.T(),G.T()],G=G.T();for(var ne=0,oe=0;32>oe&&(ne|=fe&1,oe!=31);oe++)ne<<=1,fe>>=1;for(B=B+("."+q+J)+("."+Na(ne,!0)),B+="."+te+G,q="",J=P.length;J--;)((te=P[J])||q)&&(q="."+te.toString(16).toUpperCase()+q);B+=q,u.push(B),d=!0}).box("dvcC",function(P){var B=k||"";switch(k){case"hvc1":B="dvh1";break;case"hev1":B="dvhe";break;case"avc1":B="dva1";break;case"avc3":B="dvav";break;case"av01":B="dav1"}var G=P.reader;G.skip(2),P=G.T(),G=G.T(),u.push(B+"."+Zn(P>>1&127)+"."+Zn(P<<5&32|G>>3&31)),d=!0}).box("dvvC",function(P){var B=k||"";switch(k){case"hvc1":B="dvh1";break;case"hev1":B="dvhe";break;case"avc1":B="dva1";break;case"avc3":B="dvav";break;case"av01":B="dav1"}var G=P.reader;G.skip(2),P=G.T(),G=G.T(),u.push(B+"."+Zn(P>>1&127)+"."+Zn(P<<5&32|G>>3&31)),d=!0}).S("vpcC",function(P){var B=k||"",G=P.reader;P=G.T();var q=G.T();G=G.T()>>4&15,u.push(B+"."+Zn(P)+"."+Zn(q)+"."+Zn(G)),d=!0}).box("av1C",function(P){var B=k||"";switch(k){case"dav1":B="av01"}var G=P.reader;G.skip(1),P=G.T(),G=G.T();var q=P>>>5,J=(G&64)>>6;u.push(B+"."+q+"."+Zn(P&31)+(G>>>7?"H":"M")+"."+Zn(q===2&&J?(G&32)>>5?12:10:J?10:8)+"."+((G&16)>>4)+"."+((G&8)>>3)+((G&4)>>2)+(G&3)+"."+Zn(1)+"."+Zn(1)+"."+Zn(1)+".0"),d=!0}).box("enca",Bh).box("encv",Yn).box("sinf",dt).box("frma",function(P){P=Qm(P.reader).codec,s(P)}).box("colr",function(P){u=u.map(function(q){if(q.startsWith("av01.")){var J=P.reader,fe=J.va(),te=J.qb(4),ne=String.fromCharCode(te[0]);if(ne+=String.fromCharCode(te[1]),ne+=String.fromCharCode(te[2]),ne+=String.fromCharCode(te[3]),ne==="nclx"){te=J.la(),ne=J.la();var oe=J.la(),xe=J.T()>>7,pe=q.split(".");pe.length==10&&(pe[6]=Zn(te),pe[7]=Zn(ne),pe[8]=Zn(oe),pe[9]=String(xe),q=pe.join("."))}J.seek(fe)}return q});var B=_C(P.reader),G=B.colorGamut;A=B.xd,b=G}).parse(e||t,!0),!l.length&&!u.length)return null;var O=c&&!d,D=new Map;if(d){var z=new fn("video/mp4");for(e&&z.init(e),z.i(t),e=x(z.j()),t=e.next();!t.done;t=e.next())t=t.value,D.set(t,t);z.g()}return{type:O?"audio":"video",mimeType:O?"audio/mp4":"video/mp4",codecs:pd(l.concat(u)).join(", "),language:g,height:y,width:w,channelCount:C,sampleRate:T,closedCaptions:D,xd:A,colorGamut:b}}function pd(e){var t=new Set,n=[];e=x(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;var s=Zr(i);t.has(s)||(n.push(i),t.add(s))}return t=Ah("audio",n),i=Ah("video",n),e=Ah(mt,n),i=uE(i),t=t.concat(i).concat(e),n.length&&!t.length?n:t}function uE(e){if(1>=e.length)return e;var t=e.find(function(n){return n.startsWith("dvav.")||n.startsWith("dva1.")||n.startsWith("dvh1.")||n.startsWith("dvhe.")||n.startsWith("dav1.")||n.startsWith("dvc1.")||n.startsWith("dvi1.")});return t?Lt('video/mp4; codecs="'+t+'"')?[t]:e.filter(function(n){return n!=t}):e}function fE(e){var t=null;return new Ot().box("moov",dt).box("trak",dt).box("mdia",dt).box("minf",dt).box("stbl",dt).S("stsd",Wo).box("encv",Yn).box("enca",Bh).box("sinf",dt).box("schi",dt).S("tenc",function(n){n=n.reader,n.T(),n.T(),n.T(),n.T(),t=So(n.qb(16))}).parse(e,!0),t}function gd(e,t,n){var i,s,l,u,c;return $(function(d){if(d.g==1)return i=t,i.cryptoKey?d.u(2):E(d,i.fetchKey(),3);if(s=i.iv,!s)for(s=Ze(new ArrayBuffer(16)),l=i.firstMediaSequenceNumber+n,u=s.byteLength-1;0<=u;u--)s[u]=l&255,l>>=8;return t.blockCipherMode=="CBC"?c={name:"AES-CBC",iv:s}:c={name:"AES-CTR",counter:s,length:64},d.return(p.crypto.subtle.decrypt(c,i.cryptoKey,e))})}function gs(e,t,n,i,s){return e=dn(e,i,s),(t!=0||n!=null)&&(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function My(e,t){var n=this;this.g=t,this.l=e,this.h=null,this.B=1,this.s=this.j=null,this.H=0,this.F=!1,this.i=new Map,this.C=!1,this.I=null,this.A=!1,this.m=new rs(function(){return cE(n)}),this.K=Date.now()/1e3,this.o=new Map,this.G={projection:null,hfov:null},this.N=0,this.L=1/0}a=My.prototype,a.destroy=function(){return this.m.destroy()};function cE(e){var t,n,i,s,l,u,c;return $(function(d){if(d.g==1){for(t=[],n=x(e.i.values()),i=n.next();!i.done;i=n.next())s=i.value,Va(s),t.push(Ha(s)),s.W&&(Zi(s.W),s.W=null);for(l=x(e.o.values()),u=l.next();!u.done;u=l.next())c=u.value,Zi(c);return E(d,Promise.all(t),2)}e.i.clear(),e.o.clear(),e.g=null,e.l=null,e.h=null,F(d)})}a.configure=function(e){if(this.h=e,this.I=new sm({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0),e.disableAudioPrefetch){var t=this.i.get("audio");t&&t.W&&(Zi(t.W),t.W=null),t=x(this.o.keys());for(var n=t.next();!n.done;n=t.next())n=n.value,Zi(this.o.get(n)),this.o.delete(n)}for(e.disableTextPrefetch&&(t=this.i.get(mt))&&t.W&&(Zi(t.W),t.W=null),e.disableVideoPrefetch&&(t=this.i.get("video"))&&t.W&&(Zi(t.W),t.W=null),t=x(this.i.keys()),n=t.next();!n.done;n=t.next())n=this.i.get(n.value),n.W?(ky(n.W,e.segmentPrefetchLimit),0<e.segmentPrefetchLimit||(Zi(n.W),n.W=null)):0<e.segmentPrefetchLimit&&(n.W=md(this,n.stream));e.disableAudioPrefetch||yE(this)};function hE(e,t,n){e.l.presentationTimeline.V()||(e.N=t,e.L=n)}a.start=function(e){var t=this;return $(function(n){if(n.g==1)return E(n,mE(t,e||new Map),2);Dt(t.m),t.C=!0,F(n)})};function dE(e,t){var n,i,s,l,u,c;$(function(d){switch(d.g){case 1:return n=sn,e.H++,i=e.H,ue(d,2),E(d,ry(e.g.aa,n.ua),4);case 4:ge(d,3);break;case 2:s=ie(d),e.g&&e.g.onError(s);case 3:l=an(t.mimeType,t.codecs),Du(e.g.aa,l,e.l.sequenceMode,t.external),u=e.g.aa.F,(u.isTextVisible()||e.h.alwaysStreamText)&&e.H==i&&(c=Ly(e,t),e.i.set(n.ua,c),Ci(e,c,0)),F(d)}})}function pE(e){var t=e.i.get(mt);t&&(Va(t),Ha(t).catch(function(){}),e.i.delete(mt)),e.s=null}function Ry(e,t){for(var n=0>e.g.eb(),i=x(e.i.values()),s=i.next();!s.done;s=i.next())s=s.value,s.ia&&s.ia.Sc(n),s.W&&s.W.Sc(n);for(i=x(e.o.values()),s=i.next();!s.done;s=i.next())s.value.Sc(n);(n=e.i.get("video"))&&(i=n.stream)&&(t?(t=i.trickModeVideo)&&!n.rc&&(ms(e,t,!1,0,!1),n.rc=i):(t=n.rc)&&(n.rc=null,ms(e,t,!0,0,!1)))}function _y(e,t,n,i,s,l){n=n===void 0?!1:n,i=i===void 0?0:i,s=s===void 0?!1:s,l=l===void 0?!1:l,e.j=t,e.C&&(t.video&&ms(e,t.video,n,i,s,l),t.audio&&ms(e,t.audio,n,i,s,l))}function Hu(e,t){$(function(n){if(n.g==1)return e.s=t,e.C?t.segmentIndex?n.u(2):E(n,t.createSegmentIndex(),2):n.return();ms(e,t,!0,0,!1),F(n)})}function ms(e,t,n,i,s,l){var u=e.i.get(t.type);u||t.type!=mt?u&&(u.rc&&(t.trickModeVideo?(u.rc=t,t=t.trickModeVideo):u.rc=null),u.stream!=t||s)&&(e.o.has(t)?u.W=e.o.get(t):u.W&&oE(u.W,t),t.type==mt&&(s=an(t.mimeType,t.codecs),Du(e.g.aa,s,e.l.sequenceMode,t.external)),e.o.has(u.stream)||u.stream.closeSegmentIndex&&u.stream.closeSegmentIndex(),u.stream=t,u.ia=null,u.hg=!!l,n?u.Vc?u.Be=!0:u.Qa?(u.cc=!0,u.Hd=i,u.Be=!0):(Va(u),wd(e,u,!0,i).catch(function(c){e.g&&e.g.onError(c)})):u.Qa||u.sb||Ci(e,u,0),gE(e,u).catch(function(c){e.g&&e.g.onError(c)})):dE(e,t)}function gE(e,t){var n,i;return $(function(s){if(s.g==1)return t.ib?(n=t.stream,i=t.ib,n.segmentIndex?s.u(2):E(s,n.createSegmentIndex(),2)):s.return();if(t.ib!=i||t.stream!=n)return s.return();var l=e.g.Md(),u=Ba(e.g.aa,t.type),c=t.stream.segmentIndex.find(t.Na?t.Na.endTime:l),d=c==null?null:t.stream.segmentIndex.get(c);c=d&&d.sa?d.sa-d.Ha:null,d&&!c&&(c=(d.endTime-d.getStartTime())*(t.stream.bandwidth||0)/8),c?((d=d.$)&&(c+=(d.sa?d.sa-d.Ha:null)||0),d=e.g.getBandwidthEstimate(),l=8*c/d<(u||0)-l-Math.max(e.l.minBufferTime||0,e.h.rebufferingGoal)||t.ib.h.g>c):l=!1,l&&t.ib.abort(),F(s)})}a.Qc=function(){if(this.g)for(var e=this.g.Md(),t=x(this.i.keys()),n=t.next();!n.done;n=t.next()){var i=n.value;n=this.i.get(i);var s=this.g.aa;if(s.C?s=!1:i==mt?(s=s.g,s=s.g==null||s.h==null?!1:e>=s.g&&e<s.h):(s=cs(s,i),s=Yh(s,e)),!s){if(n.W&&(n.W.g=null),n.type==="audio"){s=x(this.o.values());for(var l=s.next();!l.done;l=s.next())l.value.g=null}n.ia=null,(Ba(this.g.aa,i)!=null||n.Qa)&&zu(this,n),n.ib&&(n.ib.abort(),n.ib=null),i===mt&&(i=this.g.aa,i.H&&i.H.g()),n.Qc=!0}}};function zu(e,t){t.Vc||t.cc||(t.Qa?(t.cc=!0,t.Hd=0):nd(e.g.aa,t.type)==null?t.sb==null&&Ci(e,t,0):(Va(t),wd(e,t,!1,0).catch(function(n){e.g&&e.g.onError(n)})))}function mE(e,t){var n,i,s,l,u,c,d,g,y,w;return $(function(C){if(C.g==1){if(n=sn,!e.j)throw new K(2,5,5006);return i=new Map,s=new Set,e.j.audio&&(i.set(n.X,e.j.audio),s.add(e.j.audio)),e.j.video&&(i.set(n.ga,e.j.video),s.add(e.j.video)),e.s&&(i.set(n.ua,e.s),s.add(e.s)),l=e.g.aa,E(C,l.init(i,e.l.sequenceMode,e.l.type,e.l.ignoreManifestTimestampsInSegmentsMode),2)}for(Dt(e.m),e.updateDuration(),u=x(i.keys()),c=u.next();!c.done;c=u.next())d=c.value,g=i.get(d),e.i.has(d)||(y=Ly(e,g),t.has(g.id)&&(w=t.get(g.id),iE(w,function(T,A,b){return Gu(T,A,b||null,e.h.retryParameters,e.g.Lb)}),y.W=w),e.i.set(d,y),Ci(e,y,0));F(C)})}function Ly(e,t){return{stream:t,type:t.type,ia:null,W:md(e,t),Na:null,lc:null,Vd:null,Ud:null,Td:null,rc:null,endOfStream:!1,Qa:!1,sb:null,cc:!1,Hd:0,Be:!1,Vc:!1,Qc:!0,Gf:!1,fd:!1,ib:null}}function md(e,t){if(t.type==="video"&&e.h.disableVideoPrefetch||t.type==="audio"&&e.h.disableAudioPrefetch||t.type===mt&&(t.mimeType=="application/cea-608"||t.mimeType=="application/cea-708")||t.type===mt&&e.h.disableTextPrefetch)return null;if(e.o.has(t))return e.o.get(t);var n=e.i.get(t.type);return(n=n&&n.W)&&t===n.i?n:0<e.h.segmentPrefetchLimit?new ju(e.h.segmentPrefetchLimit,t,function(i,s,l){return Gu(i,s,l||null,e.h.retryParameters,e.g.Lb)},0>e.g.eb()):null}function yE(e){for(var t=e.h.segmentPrefetchLimit,n=e.h.prefetchAudioLanguages,i=x(e.l.variants),s=i.next(),l={};!s.done;l={lb:void 0},s=i.next())if(l.lb=s.value,l.lb.audio)if(e.o.has(l.lb.audio)){if(s=e.o.get(l.lb.audio),ky(s,t),!(0<t&&n.some(function(c){return function(d){return Qr(c.lb.audio.language,d)}}(l)))){var u=e.i.get(l.lb.audio.type);s!==(u&&u.W)&&Zi(s),e.o.delete(l.lb.audio)}}else 0>=t||!n.some(function(c){return function(d){return Qr(c.lb.audio.language,d)}}(l))||!(s=md(e,l.lb.audio))||(l.lb.audio.segmentIndex||l.lb.audio.createSegmentIndex(),e.o.set(l.lb.audio,s))}a.updateDuration=function(){var e=this.l.presentationTimeline.getDuration();1/0>e?this.g.aa.Za(e):this.g.aa.Za(this.h.infiniteLiveStreamDuration?1/0:Math.pow(2,32))};function vE(e,t){var n,i,s,l,u,c;return $(function(d){switch(d.g){case 1:if(Dt(e.m),t.Qa||t.sb==null||t.Vc)return d.return();if(t.sb=null,!t.cc){d.u(2);break}return E(d,wd(e,t,t.Be,t.Hd),3);case 3:return d.return();case 2:if(t.stream.segmentIndex){d.u(4);break}return n=t.stream,ue(d,5),E(d,t.stream.createSegmentIndex(),7);case 7:ge(d,6);break;case 5:return i=ie(d),E(d,Sd(e,t,i),8);case 8:return d.return();case 6:if(n!=t.stream)return n.closeSegmentIndex&&n.closeSegmentIndex(),t.Qa||t.sb||Ci(e,t,0),d.return();case 4:ue(d,9),s=xE(e,t),s!=null&&(Ci(e,t,s),t.fd=!1),ge(d,10);break;case 9:return l=ie(d),E(d,Sd(e,t,l),11);case 11:return d.return();case 10:if(u=Array.from(e.i.values()),!e.C||!u.every(function(g){return g.endOfStream})){d.u(0);break}return E(d,e.g.aa.endOfStream(),13);case 13:Dt(e.m),c=e.g.aa.getDuration(),c!=0&&c<e.l.presentationTimeline.getDuration()&&e.l.presentationTimeline.Za(c),F(d)}})}function xE(e,t){if(vd(t))return FC(e.g.aa,t.stream.originalId||""),null;if(t.type==mt&&$C(e.g.aa),!e.g.aa.xa&&t.type!=mt)return e.h.updateIntervalSeconds/2;var n=e.g.Md();if(t.type==="audio")for(var i=x(e.o.keys()),s=i.next();!s.done;s=i.next())s=e.o.get(s.value),s.Ma(n,!0),Fa(s,n);i=t.Na?t.Na.endTime:n;var l=BC(e.g.aa,t.type,n),u=Math.max(1,Math.max(e.l.minBufferTime||0,e.h.rebufferingGoal,e.h.bufferingGoal)*e.B),c=e.l.presentationTimeline.getDuration()-i;if(s=Ba(e.g.aa,t.type),1e-6>c&&s)return t.endOfStream=!0,t.type=="video"&&(e=e.i.get(mt))&&vd(e)&&(e.endOfStream=!0),null;if(t.endOfStream=!1,l>=u)return e.h.updateIntervalSeconds/2;if(u=!t.ia,s=wE(e,t,n,s),!s)return e.h.updateIntervalSeconds;l=!1,u&&t.hg&&(l=!0,t.hg=!1),u=1/0,c=Array.from(e.i.values()),c=x(c);for(var d=c.next();!d.done;d=c.next())d=d.value,vd(d)||d.ia&&!d.ia.current()||(u=Math.min(u,d.Na?d.Na.endTime:n));return i>=u+e.l.presentationTimeline.g?e.h.updateIntervalSeconds:(t.W&&t.ia&&!e.o.has(t.stream)&&(t.W.Ma(s.startTime),Fa(t.W,s.startTime)),SE(e,t,n,s,l).catch(function(){}),null)}function wE(e,t,n,i){var s=t.ia?t.ia.current():null;if(s)return s;if(t.Na||i)return t.ia=t.stream.segmentIndex.Ib(t.Na?t.Na.endTime:i,!1,0>e.g.eb()),t.ia&&t.ia.next().value;i=e.l.sequenceMode?0:e.h.inaccurateManifestTolerance,s=Math.max(n-i,0),e=0>e.g.eb();var l=null;return i&&(t.ia=t.stream.segmentIndex.Ib(s,!1,e),l=t.ia&&t.ia.next().value),l||(t.ia=t.stream.segmentIndex.Ib(n,!1,e),l=t.ia&&t.ia.next().value),l}function SE(e,t,n,i,s){var l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P;return $(function(B){switch(B.g){case 1:if(l=sn,u=t.stream,c=t.ia,t.Qa=!0,ue(B,2),i.Yb()==2)throw new K(1,1,1011);return E(B,EE(e,t,i,s),4);case 4:return Dt(e.m),e.A?B.return():(d=u.mimeType=="video/mp4"||u.mimeType=="audio/mp4",g=p.ReadableStream,e.h.lowLatencyMode&&e.l.isLowLatency&&g&&d&&(e.l.type!="HLS"||i.m)?(C=new Uint8Array(0),A=T=!1,k=function(G){var q,J,fe;return $(function(te){switch(te.g){case 1:if(T||(A=!0,Dt(e.m),e.A))return te.return();if(ue(te,2),C=TE(C,G),q=!1,J=0,new Ot().box("mdat",function(ne){J=ne.size+ne.start,q=!0}).parse(C,!1,!0),!q){te.u(4);break}return fe=C.subarray(0,J),C=C.subarray(J),E(te,yd(e,t,n,u,i,fe,!0,s),5);case 5:t.W&&t.ia&&Fa(t.W,i.startTime,!0);case 4:ge(te,0);break;case 2:b=ie(te),F(te)}})},E(B,xd(e,t,i,k),9)):(y=xd(e,t,i),E(B,y,7)));case 7:return w=B.h,Dt(e.m),e.A?B.return():(Dt(e.m),t.cc?(t.Qa=!1,Ci(e,t,0),B.return()):E(B,yd(e,t,n,u,i,w,!1,s),6));case 9:if(O=B.h,b)throw b;if(A){B.u(10);break}return T=!0,Dt(e.m),e.A?B.return():t.cc?(t.Qa=!1,Ci(e,t,0),B.return()):E(B,yd(e,t,n,u,i,O,!1,s),10);case 10:t.W&&t.ia&&Fa(t.W,i.startTime,!0);case 6:if(Dt(e.m),e.A)return B.return();t.Na=i,c.next(),t.Qa=!1,t.Gf=!1,D=e.g.aa.wb(),z=D[t.type],JSON.stringify(z),t.cc||e.g.Af(i,t.stream),Ci(e,t,0),ge(B,0);break;case 2:if(P=ie(B),Dt(e.m,P),e.A)return B.return();if(t.Qa=!1,P.code==7001)t.Qa=!1,Va(t),Ci(e,t,0),B.u(0);else if(t.type==l.ua&&e.h.ignoreTextStreamFailures)e.i.delete(l.ua),B.u(0);else if(P.code==3017)CE(e,t,P),B.u(0);else return t.fd=!0,P.category==1&&t.W&&$a(t.W,i),P.severity=2,E(B,Sd(e,t,P),0)}})}function TE(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function CE(e,t,n){if(!Array.from(e.i.values()).some(function(s){return s!=t&&s.Gf})){if(e.g.disableStream(t.stream,e.h.maxDisabledTime))return;var i=Math.round(100*e.B);if(20<i)e.B-=.2;else if(4<i)e.B-=.04;else{t.fd=!0,e.A=!0,e.g.onError(n);return}t.Gf=!0}Ci(e,t,4)}function EE(e,t,n,i){var s,l,u,c,d,g,y,w,C,T,A,b,k,O,D;return $(function(z){switch(z.g){case 1:if(s=sn,l=t.Na==null&&t.lc==null,u=[],c=Math.max(0,Math.max(n.appendWindowStart,e.N)-.1),d=Math.min(n.appendWindowEnd,e.L)+.01,g=Zr(n.codecs||t.stream.codecs),y=Ni(n.mimeType||t.stream.mimeType),w=n.timestampOffset,w==t.Vd&&c==t.Ud&&d==t.Td&&g==t.tf&&y==t.uf){z.u(2);break}if(C=t.tf&&t.uf&&qC(e.g.aa,t.type,y,g),!C){z.u(3);break}if(T=null,t.type===s.ga?T=e.i.get(s.X):t.type===s.X&&(T=e.i.get(s.ga)),!T){z.u(3);break}return E(z,Ha(T).catch(function(){}),5);case 5:T.lc=null,zu(e,T);case 3:return E(z,Py(e,t,w,c,d,n,g,y),2);case 2:return Wh(n.$,t.lc)||(t.lc=n.$,n.l&&n.$&&(A=xd(e,t,n.$),b=function(){var P,B,G,q,J,fe,te;return $(function(ne){switch(ne.g){case 1:return ue(ne,2),E(ne,A,4);case 4:return P=ne.h,Dt(e.m),B=null,G=new Map,q={projection:null,hfov:null},J=new Ot,J.box("moov",dt).box("trak",dt).box("mdia",dt).S("mdhd",function(oe){B=_u(oe.reader,oe.version).timescale}).box("hdlr",function(oe){switch(oe=oe.reader,oe.skip(8),oe.oc()){case"soun":G.set(s.X,B);break;case"vide":G.set(s.ga,B)}B=null}).box("minf",dt).box("stbl",dt).S("stsd",Wo).box("encv",Yn).box("avc1",Yn).box("avc3",Yn).box("hev1",Yn).box("hvc1",Yn).box("dvav",Yn).box("dva1",Yn).box("dvh1",Yn).box("dvhe",Yn).box("dvc1",Yn).box("dvi1",Yn).box("vexu",dt).box("proj",dt).S("prji",function(oe){oe=oe.reader.oc(),q.projection=oe}).box("hfov",function(oe){oe=oe.reader.P()/1e3,q.hfov=oe}).parse(P),bE(e,q),G.has(t.type)?n.$.timescale=G.get(t.type):B!=null&&(n.$.timescale=B),fe=t.stream.closedCaptions&&0<t.stream.closedCaptions.size,E(ne,e.g.kg(t.type,P),5);case 5:return E(ne,Nu(e.g.aa,t.type,P,null,t.stream,fe,t.Qc,i),6);case 6:ge(ne,0);break;case 2:throw te=ie(ne),t.lc=null,te}})},k=n.startTime,l&&(O=Ba(e.g.aa,t.type),O!=null&&(k=O)),e.g.Ai(k,n.$),u.push(b()))),e.l.sequenceMode&&(D=t.Na?t.Na.i:null,n.i!=D&&u.push(HC(e.g.aa,t.type,n.startTime))),E(z,Promise.all(u),0)}})}function Py(e,t,n,i,s,l,u,c){var d,g,y,w;return $(function(C){if(C.g==1)return d=sn,g=new Map,e.j.audio&&g.set(d.X,e.j.audio),e.j.video&&g.set(d.ga,e.j.video),ue(C,2),t.Ud=i,t.Td=s,u&&(t.tf=u),c&&(t.uf=c),t.Vd=n,y=e.l.sequenceMode||e.l.type=="HLS",E(C,VC(e.g.aa,t.type,n,i,s,y,l.mimeType||t.stream.mimeType,l.codecs||t.stream.codecs,g),4);if(C.g!=2)return ge(C,0);throw w=ie(C),t.Ud=null,t.Td=null,t.tf=null,t.uf=null,t.Vd=null,w})}function yd(e,t,n,i,s,l,u,c){u=u===void 0?!1:u,c=c===void 0?!1:c;var d,g,y,w,C,T,A,b;return $(function(k){switch(k.g){case 1:return d=i.closedCaptions&&0<i.closedCaptions.size,y=i.emsgSchemeIdUris!=null&&0<i.emsgSchemeIdUris.length||e.h.dispatchAllEmsgBoxes,w=e.h.parsePrftBox&&!e.F,C=i.mimeType=="video/mp4"||i.mimeType=="audio/mp4",T=null,s.$&&(T=s.$.timescale),A=C&&T&&i.type==="video"&&e.l.type=="DASH"&&e.h.shouldFixTimestampOffset,(y||w||A)&&(g=new Ot),y&&g.S("emsg",function(O){var D=i.emsgSchemeIdUris;if(O.version===0)var z=O.reader.oc(),P=O.reader.oc(),B=O.reader.P(),G=O.reader.P(),q=O.reader.P(),J=O.reader.P(),fe=s.startTime+G/B;else B=O.reader.P(),fe=O.reader.Nc()/B+s.timestampOffset,G=fe-s.startTime,q=O.reader.P(),J=O.reader.P(),z=O.reader.oc(),P=O.reader.oc();O=O.reader.qb(O.reader.getLength()-O.reader.va()),(D&&D.includes(z)||e.h.dispatchAllEmsgBoxes)&&(z=="urn:mpeg:dash:event:2012"?e.g.Bi():(D=fe+q/B,B=new Map().set("detail",{startTime:fe,endTime:D,schemeIdUri:z,value:P,timescale:B,presentationTimeDelta:G,eventDuration:q,id:J,messageData:O}),B=new Ue("emsg",B),B.cancelable=!0,e.g.onEvent(B),!B.defaultPrevented&&(z=="https://aomedia.org/emsg/ID3"||z=="https://developer.apple.com/streaming/emsg-id3")&&(z=Mr(O),z.length)&&e.g.onMetadata([{cueTime:fe,data:O,frames:z,dts:fe,pts:fe}],0,D)))}),w&&g.S("prft",function(O){if(!e.F&&s.$.timescale){var D=O.reader,z=O.version;D.P(),O=D.P();var P=D.P();O=1e3*O+P/Math.pow(2,32)*1e3,z===0?D=D.P():(z=D.P(),D=D.P(),D=z*Math.pow(2,32)+D),O=new Date(new Date(Date.UTC(1900,0,1,0,0,0)).getTime()+O).getTime(),D=new Map().set("detail",{wallClockTime:O,programStartDate:new Date(O-D/s.$.timescale*1e3)}),D=new Ue("prft",D),e.g.onEvent(D),e.F=!0}}),A&&g.box("moof",dt).box("traf",dt).S("tfdt",function(O){var D,z,P,B,G,q;return $(function(J){return D=Ru(O.reader,O.version),z=D.baseMediaDecodeTime,z?(P=-z/T,B=Number(t.Vd)||0,B<P?(G=t.Ud,q=t.Td,E(J,Py(e,t,P,G,q,s),0)):J.u(0)):J.return()})}),(y||w||A)&&g.parse(l,!1,u),E(k,AE(e,t,n),2);case 2:return Dt(e.m),b=t.Qc,t.Qc=!1,E(k,e.g.kg(t.type,l),3);case 3:return E(k,Nu(e.g.aa,t.type,l,s,i,d,b,c,u),4);case 4:Dt(e.m),F(k)}})}function AE(e,t,n){var i,s,l,u;return $(function(c){if(c.g==1)return i=Math.max(e.h.bufferBehind,e.l.presentationTimeline.g),s=nd(e.g.aa,t.type),s==null?c.return():(l=n-s,u=l-i,u<=e.h.evictionGoal?c.return():E(c,e.g.aa.remove(t.type,s,s+u),2));Dt(e.m),F(c)})}function vd(e){return e&&e.type==mt&&(e.stream.mimeType=="application/cea-608"||e.stream.mimeType=="application/cea-708")}function xd(e,t,n,i){var s,l,u,c,d;return $(function(g){switch(g.g){case 1:if(s=n.cd())return g.return(s);if(l=null,t.W){var y=t.W,w=y.h;n instanceof Kn&&(w=y.j),w.has(n)?(y=w.get(n),i&&(y.Uf=i),l=y.fe):l=null}return l||(l=Gu(n,t.stream,i||null,e.h.retryParameters,e.g.Lb)),u=0,t.ia&&(u=t.ia.h),t.ib=l,E(g,l.promise,2);case 2:if(c=g.h,t.ib=null,d=c.data,!n.aesKey){g.u(3);break}return E(g,gd(d,n.aesKey,u),4);case 4:d=g.h;case 3:return g.return(d)}})}function Gu(e,t,n,i,s){var l=e instanceof Je?e:void 0,u=l?1:0;return e=gs(e.M(),e.Ha,e.sa,i,n),e.contentType=t.type,s.request(Ki,e,{type:u,stream:t,segment:l})}function wd(e,t,n,i){var s,l;return $(function(u){if(u.g==1)return t.cc=!1,t.Be=!1,t.Hd=0,t.Vc=!0,t.Na=null,t.ia=null,t.W&&!e.o.has(t.stream)&&Zi(t.W),i?(s=e.g.Md(),l=e.g.aa.getDuration(),E(u,e.g.aa.remove(t.type,s+i,l),3)):E(u,ry(e.g.aa,t.type),4);if(u.g!=3)return Dt(e.m),n?E(u,e.g.aa.flush(t.type),3):u.u(3);Dt(e.m),t.Vc=!1,t.endOfStream=!1,t.Qa||t.sb||Ci(e,t,0),F(u)})}function Ci(e,t,n){var i=t.type;(i!=mt||e.i.has(i))&&(t.sb=new wa(function(){var s;return $(function(l){if(l.g==1)return ue(l,2),E(l,vE(e,t),4);if(l.g!=2)return ge(l,0);s=ie(l),e.g&&e.g.onError(s),F(l)})}).Y(n))}function Va(e){e.sb!=null&&(e.sb.stop(),e.sb=null)}function Ha(e){return $(function(t){return e.ib?E(t,e.ib.abort(),0):t.u(0)})}function Sd(e,t,n){var i;return $(function(s){if(s.g==1)return E(s,am(e.I),2);Dt(e.m),n.category===1&&(i=e.h.maxDisabledTime===0&&n.code==1011?1:e.h.maxDisabledTime,n.handled=e.g.disableStream(t.stream,i),n.handled&&(n.severity=1)),(!n.handled||n.code!=1011)&&e.g.onError(n),n.handled||e.h.failureCallback(n),F(s)})}function kE(e){var t,n,i,s,l,u;return $(function(c){return c.g==1?(t=Date.now()/1e3,n=e.h.minTimeBetweenRecoveries,!e.h.allowMediaSourceRecoveries||t-e.K<n?c.return(!1):(e.K=t,i=sn,(s=e.i.get(i.X))&&(s.lc=null,zu(e,s),Ha(s).catch(function(){})),(l=e.i.get(i.ga))&&(l.lc=null,zu(e,l),Ha(l).catch(function(){})),u=new Map,e.j.audio&&u.set(i.X,e.j.audio),e.j.video&&u.set(i.ga,e.j.video),E(c,ay(e.g.aa,u),2))):c.return(!0)})}function bE(e,t){if(e.G.projection!=t.projection||e.G.hfov!=t.hfov){if(t.projection!=null||t.hfov!=null){var n=new Map().set("detail",t);n=new Ue("spatialvideoinfo",n)}else n=new Ue("nospatialvideoinfo");n.cancelable=!0,e.g.onEvent(n),e.G=t}}function Xu(){}function Td(e,t,n,i,s){var l=s in i,u=l?n.constructor==Object&&Object.keys(i).length==0:n.constructor==Object&&Object.keys(n).length==0,c=l||u,d=!0,g;for(g in t){var y=s+"."+g,w=l?i[s]:n[g];c||g in n?t[g]===void 0?w===void 0||c?delete e[g]:e[g]=uo(w):u?e[g]=t[g]:w.constructor==Object&&t[g]&&t[g].constructor==Object?(e[g]||(e[g]=uo(w)),y=Td(e[g],t[g],w,i,y),d=d&&y):typeof t[g]!=typeof w||t[g]==null||typeof t[g]!="function"&&t[g].constructor!=w.constructor?(Xe("Invalid config, wrong type for "+y),d=!1):(typeof n[g]=="function"&&n[g].length!=t[g].length&&Fe("Unexpected number of arguments for "+y),e[g]=t[g]):(Xe("Invalid config, unrecognized key "+y),d=!1)}return d}function Wu(e,t){for(var n={},i=n,s=0,l=0;s=e.indexOf(".",s),!(0>s);)(s==0||e[s-1]!="\\")&&(l=e.substring(l,s).replace(/\\\./g,"."),i[l]={},i=i[l],l=s+1),s+=1;return i[e.substring(l).replace(/\\\./g,".")]=t,n}function ys(e,t){return e&&t}function Dy(e,t){function n(u){for(var c=x(Object.keys(u)),d=c.next();!d.done;d=c.next())d=d.value,l(u[d])&&Object.keys(u[d]).length===0||s(u[d])||typeof u[d]=="function"?delete u[d]:l(u[d])&&(n(u[d]),Object.keys(u[d]).length===0&&delete u[d])}function i(u,c){return Object.keys(u).reduce(function(d,g){var y=u[g];return c.hasOwnProperty(g)?l(y)&&l(c[g])?(y=i(y,c[g]),(0<Object.keys(y).length||!l(y))&&(d[g]=y)):s(y)&&s(c[g])||Number.isNaN(y)&&Number.isNaN(c[g])||y!==c[g]&&(d[g]=y):d[g]=y,d},{})}function s(u){return Array.isArray(u)&&u.length===0}function l(u){return u&&typeof u=="object"&&!Array.isArray(u)}return e=i(e,t),n(e),e}he("shaka.util.ConfigUtils",Xu),Xu.getDifferenceFromConfigObjects=Dy,Xu.convertToConfigObject=Wu,Xu.mergeConfigObjects=Td;function Ei(){}function Ny(e){return e=wo(e),new tn(e).Eb}function za(e,t,n){function i(c){xn(l).setUint32(u,c.byteLength,!0),u+=4,l.set(Ze(c),u),u+=c.byteLength}if(!n||!n.byteLength)throw new K(2,6,6015);var s;typeof t=="string"?s=Ch(t,!0):s=t,e=wo(e),e=Ch(e,!0);var l=new Uint8Array(12+e.byteLength+s.byteLength+n.byteLength),u=0;return i(e),i(s),i(n),l}function Oy(e,t,n){return t!=="skd"?e:(t=n.serverCertificate,n=wo(e).split("skd://").pop(),za(e,n,t))}function Cd(e,t){e===2&&(t.headers["Content-Type"]="application/octet-stream")}he("shaka.util.FairPlayUtils",Ei),Ei.commonFairPlayResponse=function(e,t){if(e===2){try{var n=Vt(t.data)}catch{return}e=!1,n=n.trim(),n.substr(0,5)==="<ckc>"&&n.substr(-6)==="</ckc>"&&(n=n.slice(5,-6),e=!0);try{var i=JSON.parse(n);i.ckc&&(n=i.ckc,e=!0),i.CkcMessage&&(n=i.CkcMessage,e=!0),i.License&&(n=i.License,e=!0)}catch{}e&&(t.data=Pt(Ti(n)))}},Ei.expressplayFairPlayRequest=function(e,t){Cd(e,t)},Ei.conaxFairPlayRequest=function(e,t){Cd(e,t)},Ei.ezdrmFairPlayRequest=function(e,t){Cd(e,t)},Ei.verimatrixFairPlayRequest=function(e,t){e===2&&(e=Ze(t.body),e=Sr(e),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=qi("spc="+e))},Ei.expressplayInitDataTransform=function(e,t,n){return Oy(e,t,n)},Ei.conaxInitDataTransform=function(e,t,n){if(t!=="skd")return e;t=n.serverCertificate,n=wo(e).split("skd://").pop().split("?").shift(),n=p.atob(n);var i=new ArrayBuffer(2*n.length);i=ci(i);for(var s=0,l=n.length;s<l;s++)i[s]=n.charCodeAt(s);return za(e,i,t)},Ei.ezdrmInitDataTransform=function(e,t,n){return t!=="skd"?e:(t=n.serverCertificate,n=wo(e).split(";").pop(),za(e,n,t))},Ei.verimatrixInitDataTransform=function(e,t,n){return Oy(e,t,n)},Ei.initDataTransform=za,Ei.defaultGetContentId=Ny,Ei.isFairPlaySupported=function(){var e;return $(function(t){return t.g==1?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},ue(t,2),E(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):t.g!=2?t.return(!0):(ie(t),t.return(!1))})};function Ed(){}function vs(){var e=1/0;navigator.connection&&navigator.connection.saveData&&(e=360);var t={retryParameters:Yi(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(y,w,C){return cu()&&w=="skd"&&(w=C.serverCertificate,C=Ny(y),y=za(y,C,w)),y},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:ro(),minHdcpVersion:"",ignoreDuplicateInitData:!su()};(ro()||lo())&&t.preferredKeySystems.push("com.microsoft.playready");var n="reload",i=!1;su()||Ca()||Rt("Tizen 4")||Rt("Tizen 5")||Rt("Tizen 6")||au()||ao()&&xh()===53||ao()&&xh()===68||!(!hi()||hi()&&fu()||hi()&&Rt("Fuchsia"))||Sh()&&Ta()||(n="smooth",i=!0),i={retryParameters:Yi(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,continueLoadingWhenPaused:!0,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"},manifestPreprocessor:qu,manifestPreprocessorTXml:Yu,sequenceMode:!1,enableAudioGroups:!1,multiTypeVariantsAllowed:i,useStreamOnceInPeriodFlattening:!1,updatePeriod:-1,enableFastSwitching:!0},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,ignoreManifestProgramDateTimeForTypes:[],mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',useSafariBehaviorForLive:!0,liveSegmentsDelay:3,sequenceMode:!(Ca()||su()||au()||lo()),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,disableClosedCaptionsDetection:!1,allowLowLatencyByteRangeOptimization:!0},mss:{manifestPreprocessor:qu,manifestPreprocessorTXml:Yu,sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}};var s={retryParameters:Yi(),failureCallback:function(y){return ys([y])},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,evictionGoal:1,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsForFairPlay:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTP:!1,forceHTTPS:!1,preferNativeHls:!1,updateIntervalSeconds:1,dispatchAllEmsgBoxes:!1,observeQualityChanges:!1,maxDisabledTime:30,parsePrftBox:!1,segmentPrefetchLimit:0,prefetchAudioLanguages:[],disableAudioPrefetch:!1,disableTextPrefetch:!1,disableVideoPrefetch:!1,liveSync:{enabled:!1,targetLatency:.5,targetLatencyTolerance:.5,maxPlaybackRate:1.1,minPlaybackRate:.95,panicMode:!1,panicThreshold:60,dynamicTargetLatency:{enabled:!1,stabilityThreshold:60,rebufferIncrement:.5,maxAttempts:10,maxLatency:4,minLatency:1}},allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5,vodDynamicPlaybackRate:!1,vodDynamicPlaybackRateLowBufferRate:.95,vodDynamicPlaybackRateBufferRatio:.5,infiniteLiveStreamDuration:!1,preloadNextUrlWindow:30,loadTimeout:30,clearDecodingCache:lo()||lu(),dontChooseCodecs:!1,shouldFixTimestampOffset:ao()||so()};(ao()||so()||hi()||uu())&&(s.stallSkip=0);var l={trackSelectionCallback:function(y){return $(function(w){return w.return(y)})},downloadSizeCallback:function(y){var w;return $(function(C){return C.g==1?navigator.storage&&navigator.storage.estimate?E(C,navigator.storage.estimate(),3):C.return(!0):(w=C.h,C.return(w.usage+y<.95*w.quota))})},progressCallback:function(y,w){return ys([y,w])},usePersistentLicense:!0,numberOfParallelDownloads:5};e={enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0,cacheLoadThreshold:20,minTimeToSwitch:Xr()?.5:0},n={codecSwitchingStrategy:n,addExtraFeaturesToSourceBuffer:function(y){return ys([y],"")},forceTransmux:!1,insertFakeEncryptionInInit:!0,modifyCueCallback:function(y,w){return ys([y,w])}};var u=!1,c=!1,d=!0;Ig()&&(c=u=!0,d=!1);var g={drm:t,manifest:i,streaming:s,mediaSource:n,offline:l,abrFactory:function(){return new zt},abr:e,autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayer:{captionsUpdatePeriod:.25},textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",rtpSafetyFactor:5,useHeaders:!1,includeKeys:[]},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1},ads:{customPlayheadTracker:u,skipPlayDetection:c,supportsMultipleMediaElements:d}};return l.trackSelectionCallback=function(y){return $(function(w){return w.return(IE(y,g.preferredAudioLanguage,g.preferredVideoHdrLevel))})},g}function Zo(e,t,n){var i={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:"",headers:{}}};return Td(e,t,n||vs(),i,"")}function IE(e,t,n){var i=n;i=="AUTO"&&(i=p.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR");var s=e.filter(function(c){return!(c.type!="variant"||c.hdr&&c.hdr!=i)});n=[];var l=du(t,s.map(function(c){return c.language}));l&&(n=s.filter(function(c){return It(c.language)==l})),n.length==0&&(n=s.filter(function(c){return c.primary})),n.length==0&&(s.map(function(c){return c.language}),n=s);var u=n.filter(function(c){return c.height&&480>=c.height});for(u.length&&(u.sort(function(c,d){return d.height-c.height}),n=u.filter(function(c){return c.height==u[0].height})),t=[],n.length&&(s=Math.floor(n.length/2),n.sort(function(c,d){return c.bandwidth-d.bandwidth}),t.push(n[s])),e=x(e),n=e.next();!n.done;n=e.next())n=n.value,n.type!=mt&&n.type!="image"||t.push(n);return t}function qu(e){return ys([e],e)}function Yu(e){return ys([e],e)}he("shaka.util.PlayerConfiguration",Ed),Ed.mergeConfigObjects=Zo,Ed.createDefault=vs;function Ro(e,t,n,i){Et.call(this),this.L=e,this.U=t,this.xa=i.networkingEngine,this.A=n,this.o=null,this.qa=0,this.Fa=i.yc,this.C=i.vi,this.ab=i.wi,this.g=i.config,this.j=this.F=this.h=null,this.ea=!1,this.G=i.Fi,this.oa=!1,this.l=null,this.da=!1,this.i=this.B=null,this.ba=!1,this.K=new Map,this.pa=!1,this.za=i.Ei,this.Z=new Bu,this.m=new _t,this.N=null,this.s=!1,this.Da=i.yh,this.fa=null,this.Ea=i.xh,this.R=!1,this.I=[],this.H=[]}le(Ro,Et);function Ga(e,t,n){(e=t?e.H:e.I)?e.push(n):n()}function ME(e){if(e.H)for(var t=x(e.H),n=t.next();!n.done;n=t.next())n=n.value,n();e.H=null}function Uy(e,t){if(e.N=t,e.R=!0,e.I){t=x(e.I);for(var n=t.next();!n.done;n=t.next())n=n.value,n()}e.I=null}a=Ro.prototype,a.getStartTime=function(){return this.A},a.Dc=function(){return this.L},a.gf=function(){return this.h};function RE(e){return e.ba=!0,e.i}function _E(e){return e.ea=!0,e.j}function LE(e){return e.oa=!0,e.G}a.getStats=function(){return this.Z};function PE(e){return e.da=!0,e.l}function DE(e){return e.pa=!0,e.K}a.start=function(){var e=this;(function(){var t;return $(function(n){switch(n.g){case 1:return E(n,Promise.resolve(),2);case 2:return ue(n,3),E(n,NE(e),5);case 5:return Xa(e),E(n,OE(e),6);case 6:if(Xa(e),e.o||(e.o=new ts(e.g.preferredAudioLanguage,e.g.preferredVariantRole,e.g.preferredAudioChannelCount,e.g.preferredVideoHdrLevel,e.g.preferSpatialAudio,e.g.preferredVideoLayout,e.g.preferredAudioLabel,e.g.preferredVideoLabel,e.g.mediaSource.codecSwitchingStrategy,e.g.manifest.dash.enableAudioGroups)),e.Ea){var i=e.g.abrFactory;e.B=i,e.i=i(),e.i.configure(e.g.abr)}if(e.Da){i=e.h.presentationTimeline.V();var s=mu(e.h.variants);s=e.o.create(s),e.i.configure(e.g.abr),e.i.setVariants(Array.from(s.values())),(s=e.i.chooseVariant())&&(e.fa=s,s.video&&By(e,s.video,i),s.audio&&By(e,s.audio,i))}return E(n,void 0,7);case 7:Xa(e),e.m.resolve(),ge(n,0);break;case 3:t=ie(n),e.m.reject(t),F(n)}})})()},a.dispatchEvent=function(e){return this.N?this.N.dispatchEvent(e):Et.prototype.dispatchEvent.call(this,e)},a.onError=function(e){e.severity===2&&(this.m.reject(e),this.destroy());var t=new Map().set("detail",e);t=new Ue("error",t),this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)};function Xa(e){if(e.s)throw new K(2,7,7003)}function Ad(e,t){e.dispatchEvent(new Ue("onstatechange",new Map().set("state",t)))}function NE(e){var t,n,i,s;return $(function(l){if(l.g==1)return Ad(e,"manifest-parser"),e.j||(e.F=Vm(e.L,e.U),e.j=e.F(),e.j.configure(e.g.manifest)),t=Date.now()/1e3,Ad(e,"manifest"),e.h?l.u(2):E(l,e.j.start(e.L,e.ab),3);if(l.g!=2&&(e.h=l.h),n=new Ue("manifestparsed",void 0),e.dispatchEvent(n),e.h.variants.length==0)throw new K(2,4,4036);UE(e.h),i=Date.now()/1e3,s=i-t,e.Z.H=s,F(l)})}function OE(e){var t,n,i,s,l;return $(function(u){switch(u.g){case 1:Ad(e,"drm-engine"),e.qa=Date.now()/1e3,e.l=e.Fa(),e.C.g=e.l,e.l.configure(e.g.drm);var c=e.C;if(t=Hg(e.h.variants,c.h.restrictions,c.i),!t){u.u(2);break}return n=new Ue("trackschanged",void 0),E(u,Promise.resolve(),3);case 3:Xa(e),e.dispatchEvent(n);case 2:return i=mu(e.h.variants),E(u,km(e.l,i,e.h.offlineSessionIds),4);case 4:return Xa(e),E(u,Bm(e.C,e.h),5);case 5:if(s=u.h,!s){u.u(0);break}return l=new Ue("trackschanged",void 0),E(u,Promise.resolve(),7);case 7:e.dispatchEvent(l),F(u)}})}a.configure=function(e,t){e=Wu(e,t),Zo(this.g,e)},a.getConfiguration=function(){return uo(this.g)};function By(e,t,n){var i,s,l,u,c;$(function(d){if(d.g==1)return i=e.g.streaming.segmentPrefetchLimit||2,s=new ju(i,t,function(g,y,w){return Gu(g,y,w||null,e.g.streaming.retryParameters,e.xa)},!1),e.K.set(t.id,s),E(d,t.createSegmentIndex(),2);l=e.A||0,(c=(u=t.segmentIndex.Ib(l))?u.current():null)||(c=t.segmentIndex.get(0)),c&&(n?c.$&&Ey(s,c.$):Fa(s,c.startTime)),F(d)})}a.fj=function(){return this.m},a.destroy=function(){var e=this,t,n,i;return $(function(s){switch(s.g){case 1:if(e.s=!0,!e.j||e.ea){s.u(2);break}return E(s,e.j.stop(),2);case 2:if(!e.i||e.ba){s.u(4);break}return E(s,e.i.stop(),4);case 4:if(e.G&&!e.oa&&e.G.release(),!e.l||e.da){s.u(6);break}return E(s,e.l.destroy(),6);case 6:if(0<e.K.size&&!e.pa)for(t=x(e.K.values()),n=t.next();!n.done;n=t.next())i=n.value,Zi(i);F(s)}})};function UE(e){function t(n){return n.video&&n.audio||n.video&&n.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}he("shaka.media.PreloadManager",Ro),Ro.prototype.destroy=Ro.prototype.destroy,Ro.prototype.waitForFinish=Ro.prototype.fj;function Ku(e,t){Et.call(this);var n=this;this.i=e,this.l=t,this.g=new Map,this.m=[{wc:null,vc:xs,jc:function(i,s){return Rr(n,"enter",i,s)}},{wc:Wa,vc:xs,jc:function(i,s){return Rr(n,"enter",i,s)}},{wc:qa,vc:xs,jc:function(i,s){return Rr(n,"enter",i,s)}},{wc:xs,vc:Wa,jc:function(i,s){return Rr(n,"exit",i,s)}},{wc:xs,vc:qa,jc:function(i,s){return Rr(n,"exit",i,s)}},{wc:Wa,vc:qa,jc:function(i,s){return Rr(n,"skip",i,s)}},{wc:qa,vc:Wa,jc:function(i,s){return Rr(n,"skip",i,s)}}],this.h=new lt,this.h.D(this.i,"regionremove",function(i){n.g.delete(i.region)})}le(Ku,Et),Ku.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,Et.prototype.release.call(this)},Ku.prototype.j=function(e,t){if(!this.l||e!=0){this.l=!1;for(var n=x(this.i.g),i=n.next();!i.done;i=n.next()){i=i.value;var s=this.g.get(i),l=e<i.startTime?Wa:e>i.endTime?qa:xs;this.g.set(i,l);for(var u=x(this.m),c=u.next();!c.done;c=u.next())c=c.value,c.wc==s&&c.vc==l&&c.jc(i,t)}}};function Rr(e,t,n,i){t=new Ue(t,new Map([["region",n],["seeking",i]])),e.dispatchEvent(t)}var Wa=1,xs=2,qa=3;function kd(e,t,n){var i,s,l,u,c,d,g;return $(function(y){switch(y.g){case 1:var w=new tn(e).Pa.split("/").pop().split(".");return i=w.length==1?"":w.pop().toLowerCase(),(s=BE[i])?y.return(s):(l=0,u=dn([e],n),ue(y,2),u.method="HEAD",E(y,t.request(l,u).promise,4));case 4:c=y.h,s=c.headers["content-type"],ge(y,3);break;case 2:if(d=ie(y),!d||d.code!=1002&&d.code!=1001){y.u(3);break}return u.method="GET",E(y,t.request(l,u).promise,6);case 6:g=y.h,s=g.headers["content-type"];case 3:return y.return(s?s.toLowerCase().split(";").shift():"")}})}var BE={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mpd:"application/dash+xml",ism:"application/vnd.ms-sstr+xml",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav",sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"};function jy(e,t){if(e.lineBreak)return`
`;if(e.nestedCues.length)return e.nestedCues.map(function(u){return jy(u,e)}).join("");var n=[],i=700<=e.fontWeight,s=e.fontStyle=="italic",l=e.textDecoration.includes("underline");return i&&n.push(["b"]),s&&n.push(["i"]),l&&n.push(["u"]),s=e.color,s==""&&t&&(s=t.color),i="",(s=Fy(s))&&(i+="."+s),s=e.backgroundColor,s==""&&t&&(s=t.backgroundColor),(t=Fy(s))&&(i+=".bg_"+t),i&&n.push(["c",i]),n.reduceRight(function(u,c){var d=x(c);return c=d.next().value,d=d.next().value,"<"+c+(d===void 0?"":d)+">"+u+"</"+c+">"},e.payload)}function Fy(e){e=e.toLowerCase();var t=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(parseInt(t[1],10)|256).toString(16).slice(1)+(parseInt(t[2],10)|256).toString(16).slice(1)+(parseInt(t[3],10)|256).toString(16).slice(1):e.startsWith("#")&&7<e.length&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function bd(e,t){var n=[];e=x($y(e));for(var i=e.next();!i.done;i=e.next())if(i=i.value,i.isContainer)n.push.apply(n,L(bd(i.nestedCues,i)));else{var s=i.clone();s.nestedCues=[],s.payload=jy(i,t),n.push(s)}return n}function $y(e){var t=[];e=x(e);for(var n=e.next(),i={};!n.done;i={Me:void 0},n=e.next())i.Me=n.value,t.some(function(s){return function(l){return ft(s.Me,l)}}(i))||t.push(i.Me);return t}function jE(e){function t(i){for(var s=5381,l=i.length;l;)s=33*s^i.charCodeAt(--l);return(s>>>0).toString()}if(e.startTime>=e.endTime)return null;var n=new VTTCue(e.startTime,e.endTime,e.payload);n.id=t(e.startTime.toString())+t(e.endTime.toString())+t(e.payload),n.lineAlign=e.lineAlign,n.positionAlign=e.positionAlign,e.size&&(n.size=e.size);try{n.align=e.textAlign}catch{}return e.textAlign=="center"&&n.align!="center"&&(n.align="middle"),e.writingMode=="vertical-lr"?n.vertical="lr":e.writingMode=="vertical-rl"&&(n.vertical="rl"),e.lineInterpretation==1&&(n.snapToLines=!1),e.line!=null&&(n.line=e.line),e.position!=null&&(n.position=e.position),n}function Jn(e,t){this.g=null;for(var n=x(Array.from(e.textTracks)),i=n.next();!i.done;i=n.next())i=i.value,i.kind!=="metadata"&&i.kind!=="chapters"&&(i.mode="disabled",i.label==t&&(this.g=i));this.g||(this.g=e.addTextTrack("subtitles",t)),this.g.mode="hidden"}a=Jn.prototype,a.configure=function(){},a.remove=function(e,t){return this.g?(Vy(this.g,function(n){return n.startTime<t&&n.endTime>e}),!0):!1},a.append=function(e){var t=bd(e),n=[];e=this.g.cues?Array.from(this.g.cues):[],t=x(t);for(var i=t.next(),s={};!i.done;s={hd:void 0},i=t.next())s.hd=i.value,e.some(function(l){return function(u){return u.startTime==l.hd.startTime&&u.endTime==l.hd.endTime&&u.text==l.hd.payload}}(s))||(i=jE(s.hd))&&n.push(i);for(e=n.slice().sort(function(l,u){return l.startTime!=u.startTime?l.startTime-u.startTime:l.endTime!=u.endTime?l.endTime-u.startTime:"line"in VTTCue.prototype?n.indexOf(u)-n.indexOf(l):n.indexOf(l)-n.indexOf(u)}),e=x(e),t=e.next();!t.done;t=e.next())this.g.addCue(t.value)},a.destroy=function(){return this.g&&(Vy(this.g,function(){return!0}),this.g.mode="disabled"),this.g=null,Promise.resolve()},a.isTextVisible=function(){return this.g.mode=="showing"},a.setTextVisibility=function(e){this.g.mode=e?"showing":"hidden"};function Vy(e,t){var n=e.mode;e.mode=n=="showing"?"showing":"hidden";for(var i=x(Array.from(e.cues)),s=i.next();!s.done;s=i.next())(s=s.value)&&t(s)&&e.removeCue(s);e.mode=n}he("shaka.text.SimpleTextDisplayer",Jn),Jn.prototype.setTextVisibility=Jn.prototype.setTextVisibility,Jn.prototype.isTextVisible=Jn.prototype.isTextVisible,Jn.prototype.destroy=Jn.prototype.destroy,Jn.prototype.append=Jn.prototype.append,Jn.prototype.remove=Jn.prototype.remove,Jn.prototype.configure=Jn.prototype.configure;function ei(){}a=ei.prototype,a.configure=function(){},a.remove=function(){},a.append=function(){},a.destroy=function(){},a.isTextVisible=function(){return!1},a.setTextVisibility=function(){},he("shaka.text.StubTextDisplayer",ei),ei.prototype.setTextVisibility=ei.prototype.setTextVisibility,ei.prototype.isTextVisible=ei.prototype.isTextVisible,ei.prototype.destroy=ei.prototype.destroy,ei.prototype.append=ei.prototype.append,ei.prototype.remove=ei.prototype.remove,ei.prototype.configure=ei.prototype.configure;function Hy(){}function ws(e){for(;e.firstChild;)e.removeChild(e.firstChild)}he("shaka.util.Dom",Hy),Hy.removeAllChildren=ws;function ti(e,t,n){var i=this;this.m=!1,this.h=[],this.A=e,this.s=t,this.l=null,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.s.appendChild(this.g),n&&n.captionsUpdatePeriod||vt("UITextDisplayer w/ config","Please migrate to initializing UITextDisplayer with a config."),this.C=new ct(function(){i.A.paused||Ss(i)}).Sa(n&&n.captionsUpdatePeriod?n.captionsUpdatePeriod:.25),this.i=new Map,this.j=new lt,this.j.D(document,"fullscreenchange",function(){Ss(i,!0)}),this.j.D(this.A,"seeking",function(){Ss(i,!0)}),this.j.D(this.A,"resize",function(){var s=i.A,l=s.videoWidth;s=s.videoHeight,l&&s?i.l=l/s:i.l=null}),this.o=null,"ResizeObserver"in p&&(this.o=new ResizeObserver(function(){Ss(i,!0)}),this.o.observe(this.g)),this.B=new Map}a=ti.prototype,a.configure=function(e){this.C&&this.C.Sa(e.captionsUpdatePeriod)},a.append=function(e){var t=[].concat(L(this.h));e=x($y(e));for(var n=e.next(),i={};!n.done;i={Ne:void 0},n=e.next())i.Ne=n.value,t.some(function(s){return function(l){return ft(l,s.Ne)}}(i))||this.h.push(i.Ne);Ss(this)},a.destroy=function(){return this.g&&(this.s.removeChild(this.g),this.g=null,this.m=!1,this.h=[],this.C&&this.C.stop(),this.i.clear(),this.j&&(this.j.release(),this.j=null),this.o&&(this.o.disconnect(),this.o=null)),Promise.resolve()},a.remove=function(e,t){if(!this.g)return!1;var n=this.h.length;return this.h=this.h.filter(function(i){return i.startTime<e||i.endTime>=t}),Ss(this,n>this.h.length),!0},a.isTextVisible=function(){return this.m},a.setTextVisibility=function(e){this.m=e};function FE(e,t){for(;t!=null;){if(t==e.g)return!0;t=t.parentElement}return!1}function zy(e,t,n,i,s){var l=!1,u=[],c=[];t=x(t);for(var d=t.next();!d.done;d=t.next()){d=d.value,s.push(d);var g=e.i.get(d),y=d.startTime<=i&&d.endTime>i,w=g?g.qh:null;g&&(u.push(g.Oe),g.qc&&u.push(g.qc),y||(l=!0,e.i.delete(d),g=null)),y&&(c.push(d),g?FE(e,w)||(l=!0):($E(e,d,s),g=e.i.get(d),w=g.qh,l=!0)),0<d.nestedCues.length&&w&&zy(e,d.nestedCues,w,i,s),s.pop()}if(l){for(i=x(u),s=i.next();!s.done;s=i.next())s=s.value,s.parentElement&&s.parentElement.removeChild(s);for(c.sort(function(C,T){return C.startTime!=T.startTime?C.startTime-T.startTime:C.endTime-T.endTime}),c=x(c),i=c.next();!i.done;i=c.next())i=e.i.get(i.value),i.qc?(i.qc.contains(n)&&i.qc.removeChild(n),n.appendChild(i.qc),i.qc.appendChild(i.Oe)):n.appendChild(i.Oe)}}function Ss(e,t){if(e.g){var n=e.A.currentTime;if(!e.m||t!==void 0&&t){t=x(e.B.values());for(var i=t.next();!i.done;i=t.next())ws(i.value);ws(e.g),e.i.clear(),e.B.clear()}e.m&&zy(e,e.h,e.g,n,[])}}function $E(e,t,n){var i=1<n.length,s=i?"span":"div";t.lineBreak&&(s="br"),t.rubyTag&&(s=t.rubyTag),i=!i&&0<t.nestedCues.length;var l=document.createElement(s);if(s!="br"&&HE(e,l,t,n,i),n=null,t.region&&t.region.id){var u=t.region,c=e.l===4/3?2.5:1.9;if(n=u.id+"_"+u.width+"x"+u.height+(u.heightUnits==Wn?"%":"px")+"-"+u.viewportAnchorX+"x"+u.viewportAnchorY+(u.viewportAnchorUnits==Wn?"%":"px"),e.B.has(n))n=e.B.get(n);else{s=document.createElement("span");var d=u.heightUnits==Wn?"%":"px",g=u.widthUnits==Wn?"%":"px",y=u.viewportAnchorUnits==Wn?"%":"px";s.id="shaka-text-region---"+n,s.classList.add("shaka-text-region"),s.style.position="absolute";var w=u.height,C=u.width;u.heightUnits===2&&(w=5.33*u.height,d="%"),u.widthUnits===2&&(C=u.width*c,g="%"),s.style.height=w+d,s.style.width=C+g,u.viewportAnchorUnits===2?(c=u.viewportAnchorY/75*100,d=u.viewportAnchorX/(e.l===4/3?160:210)*100,c-=u.regionAnchorY*w/100,d-=u.regionAnchorX*C/100,s.style.top=c+"%",s.style.left=d+"%"):(s.style.top=u.viewportAnchorY-u.regionAnchorY*w/100+y,s.style.left=u.viewportAnchorX-u.regionAnchorX*C/100+y),u.heightUnits!==0&&u.widthUnits!==0&&u.viewportAnchorUnits!==0&&(u=Math.max(0,Math.min(100-(parseInt(s.style.width.slice(0,-1),10)||0),parseInt(s.style.left.slice(0,-1),10)||0)),s.style.top=Math.max(0,Math.min(100-(parseInt(s.style.height.slice(0,-1),10)||0),parseInt(s.style.top.slice(0,-1),10)||0))+"%",s.style.left=u+"%"),s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="center",s.style.justifyContent=t.displayAlign=="before"?"flex-start":t.displayAlign=="center"?"center":"flex-end",e.B.set(n,s),n=s}}s=l,i&&(s=document.createElement("span"),s.classList.add("shaka-text-wrapper"),s.style.backgroundColor=t.backgroundColor,s.style.lineHeight="normal",l.appendChild(s)),e.i.set(t,{Oe:l,qh:s,qc:n})}function VE(e){var t=e.direction,n=e.positionAlign;return e=e.textAlign,n!==Jl?n:e==="left"||e==="start"&&t===ga||e==="end"&&t==="rtl"?"line-left":e==="right"||e==="start"&&t==="rtl"||e==="end"&&t===ga?"line-right":"center"}function HE(e,t,n,i,s){var l=t.style,u=n.nestedCues.length==0,c=1<i.length;l.whiteSpace="pre-wrap";var d=n.payload.replace(/\s+$/g,function(y){return" ".repeat(y.length)});if(l.webkitTextStrokeColor=n.textStrokeColor,l.webkitTextStrokeWidth=n.textStrokeWidth,l.color=n.color,l.direction=n.direction,l.opacity=n.opacity,l.paddingLeft=Id(n.linePadding,n,e.s),l.paddingRight=Id(n.linePadding,n,e.s),l.textCombineUpright=n.textCombineUpright,l.textShadow=n.textShadow,n.backgroundImage)l.backgroundImage="url('"+n.backgroundImage+"')",l.backgroundRepeat="no-repeat",l.backgroundSize="contain",l.backgroundPosition="center",n.backgroundColor&&(l.backgroundColor=n.backgroundColor),l.width="100%",l.height="100%";else{if(n.nestedCues.length)var g=t;else g=document.createElement("span"),t.appendChild(g);n.border&&(g.style.border=n.border),!s&&((t=Gy(i,function(y){return y.backgroundColor}))?g.style.backgroundColor=t:d&&(g.style.backgroundColor="rgba(0, 0, 0, 0.8)"),t=Gy(i,function(y){return y.fontFamily}))&&(g.style.fontFamily=t),d&&(g.textContent=d)}c&&!i[i.length-1].isContainer?l.display="inline":(l.display="flex",l.flexDirection="column",l.alignItems="center",n.textAlign=="left"||n.textAlign=="start"?(l.width="100%",l.alignItems="start"):(n.textAlign=="right"||n.textAlign=="end")&&(l.width="100%",l.alignItems="end"),l.justifyContent=n.displayAlign=="before"?"flex-start":n.displayAlign=="center"?"center":"flex-end"),u||(l.margin="0"),l.fontFamily=n.fontFamily,l.fontWeight=n.fontWeight.toString(),l.fontStyle=n.fontStyle,l.letterSpacing=n.letterSpacing,l.fontSize=Id(n.fontSize,n,e.s),i=n.line,i!=null&&(u=n.lineInterpretation,u==eu&&(u=1,c=16,e.l&&1>e.l&&(c=32),i=0>i?100+i/c*100:i/c*100),u==1&&(l.position="absolute",n.writingMode==vr?(l.width="100%",n.lineAlign==xr?l.top=i+"%":n.lineAlign=="end"&&(l.bottom=100-i+"%")):n.writingMode=="vertical-lr"?(l.height="100%",n.lineAlign==xr?l.left=i+"%":n.lineAlign=="end"&&(l.right=100-i+"%")):(l.height="100%",n.lineAlign==xr?l.right=i+"%":n.lineAlign=="end"&&(l.left=100-i+"%")))),l.lineHeight=n.lineHeight,e=VE(n),e=="line-left"?(l.cssFloat="left",n.position!==null&&(l.position="absolute",n.writingMode==vr?(l.left=n.position+"%",l.width="auto"):l.top=n.position+"%")):e=="line-right"?(l.cssFloat="right",n.position!==null&&(l.position="absolute",n.writingMode==vr?(l.right=100-n.position+"%",l.width="auto"):l.bottom=n.position+"%")):n.position!==null&&n.position!=50&&(l.position="absolute",n.writingMode==vr?(l.left=n.position+"%",l.width="auto"):l.top=n.position+"%"),l.textAlign=n.textAlign,l.textDecoration=n.textDecoration.join(" "),l.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&l.writingMode==n.writingMode||(l.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==vr?l.width=n.size+"%":l.height=n.size+"%")}function Id(e,t,n){var i=(i=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(i[1]),unit:i[2]}:null;if(!i)return e;var s=i.value;switch(i.unit){case"%":return s/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*s/t.cellResolution.rows+"px";default:return e}}function Gy(e,t){for(var n=e.length-1;0<=n;n--){var i=t(e[n]);if(i||i===0)return i}return null}he("shaka.text.UITextDisplayer",ti),ti.prototype.setTextVisibility=ti.prototype.setTextVisibility,ti.prototype.isTextVisible=ti.prototype.isTextVisible,ti.prototype.remove=ti.prototype.remove,ti.prototype.destroy=ti.prototype.destroy,ti.prototype.append=ti.prototype.append,ti.prototype.configure=ti.prototype.configure;function zE(e,t){function n(l){for(var u=l,c=x(t),d=c.next();!d.done;d=c.next())d=d.value,d.end&&d.start<l&&(u+=d.end-d.start);return l=Math.floor(u/3600),c=Math.floor(u/60%60),d=Math.floor(u%60),u=Math.floor(1e3*u%1e3),(10>l?"0":"")+l+":"+(10>c?"0":"")+c+":"+(10>d?"0":"")+d+"."+(100>u?10>u?"00":"0":"")+u}var i=bd(e);e=`WEBVTT

`,i=x(i);for(var s=i.next();!s.done;s=i.next())s=s.value,e+=n(s.startTime)+" --> "+n(s.endTime)+function(l){var u=[];switch(l.textAlign){case"left":u.push("align:left");break;case"right":u.push("align:right");break;case yo:u.push("align:middle");break;case"start":u.push("align:start");break;case"end":u.push("align:end")}switch(l.writingMode){case"vertical-lr":u.push("vertical:lr");break;case"vertical-rl":u.push("vertical:rl")}return u.length?" "+u.join(" "):""}(s)+`
`,e+=s.payload+`

`;return e}he("shaka.text.WebVttGenerator",function(){});function Xy(e,t){this.h=e,this.g=t,this.m=void 0,this.i=!1,this.l=!0,this.j=!1}Xy.prototype.configure=function(e){this.g=e};function GE(e){e.i=!1,e.l=!0,e.j=!1}function XE(e,t,n){try{if(!e.g.enabled)return t;var i=Md(e);e:{switch(n.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":var s=Qu;break e;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":s=ef;break e;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":s=qy;break e}s=void 0}i.ot=s,i.su=!0;var l=Zu(i);return Rd(t,l)}catch(u){return Ke("CMCD_SRC_ERROR","Could not generate src CMCD data.",u),t}}function Md(e){return e.g.sessionId||(e.g.sessionId=p.crypto.randomUUID()),{v:1,sf:e.m,sid:e.g.sessionId,cid:e.g.contentId,mtp:e.h.getBandwidthEstimate()/1e3}}function Ts(e,t,n){n=n===void 0?{}:n;var i=i===void 0?e.g.useHeaders:i;if(e.g.enabled){Object.assign(n,Md(e)),n.pr=e.h.eb();var s=n.ot===Ju||n.ot===ef;if(e.j&&s&&(n.bs=!0,n.su=!0,e.j=!1),n.su==null&&(n.su=e.l),e=WE(e,n),i)i=ZE(e),Object.keys(i).length&&Object.assign(t.headers,i);else{var l=Zu(e);l&&(t.uris=t.uris.map(function(u){return Rd(u,l)}))}}}function WE(e,t){var n=e.g.includeKeys;return n.length?Object.keys(t).reduce(function(i,s){return n.includes(s)&&(i[s]=t[s]),i},{}):t}function qE(e){if(e.type===0)return QE;if(e=e.stream){var t=e.type;if(t=="video")return e.codecs&&e.codecs.includes(",")?ef:Ju;if(t=="audio")return Qu;if(t=="text")return e.mimeType==="application/mp4"?tf:_d}}function YE(e,t){if(t=e.h.wb()[t],!t.length)return NaN;var n=e.h.getCurrentTime();return(e=t.find(function(i){return i.start<=n&&i.end>=n}))?1e3*(e.end-n):NaN}function Wy(e,t){if(t=e.h.wb()[t],!t.length)return 0;var n=e.h.getCurrentTime();return(e=t.find(function(i){return i.start<=n&&i.end>=n}))?1e3*(e.end-n):0}function KE(e,t){var n=e.h.ic();if(!n.length)return NaN;e=n[0],n=x(n);for(var i=n.next();!i.done;i=n.next())i=i.value,i.type==="variant"&&i.bandwidth>e.bandwidth&&(e=i);switch(t){case Ju:return e.videoBandwidth||NaN;case Qu:return e.audioBandwidth||NaN;default:return e.bandwidth}}function Zu(e){function t(w){return 100*n(w/100)}function n(w){return Math.round(w)}function i(w){return!Number.isNaN(w)&&w!=null&&w!==""&&w!==!1}var s=[],l={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(w){return encodeURIComponent(w)},rtp:t,tb:n},u=Object.keys(e||{}).sort();u=x(u);for(var c=u.next();!c.done;c=u.next()){c=c.value;var d=e[c];if(i(d)&&(c!=="v"||d!==1)&&(c!="pr"||d!==1)){var g=l[c];g&&(d=g(d)),g=typeof d;var y=void 0;y=g==="string"&&c!=="ot"&&c!=="sf"&&c!=="st"?c+"="+JSON.stringify(d):g==="boolean"?c:g==="symbol"?c+"="+d.description:c+"="+d,s.push(y)}}return s.join(",")}function ZE(e){var t=Object.keys(e),n={},i=["Object","Request","Session","Status"],s=[{},{},{},{}],l={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};t=x(t);for(var u=t.next();!u.done;u=t.next())u=u.value,s[l[u]!=null?l[u]:1][u]=e[u];for(e=0;e<s.length;e++)(l=Zu(s[e]))&&(n["CMCD-"+i[e]]=l);return n}function Rd(e,t){return!t||e.includes("offline:")?e:(e=new tn(e),e.g.set("CMCD",t),e.toString())}var qy="m",Qu="a",Ju="v",ef="av",QE="i",_d="c",tf="tt";he("shaka.util.CmcdManager.StreamingFormat",{DASH:"d",HLS:"h",Kj:"s",OTHER:"o"});function Ai(e){this.h=e,this.g=null}a=Ai.prototype,a.configure=function(e){this.h=e},a.zg=function(){return this.h.enabled&&this.h.applyMaximumSuggestedBitrate&&this.g&&this.g.has(Zy)?1e3*this.g.get(Zy):null},a.xg=function(){return this.h.enabled&&this.g&&this.g.has(Ky)?1e3*this.g.get(Ky):null},a.Yh=function(){return this.h.enabled&&this.g&&this.g.has(Qy)?this.g.get(Qy):null},a.Zh=function(){return this.h.enabled&&this.g&&this.g.has(Jy)?this.g.get(Jy):null},a.getBandwidthEstimate=function(e){var t=this.xg();if(!t)return e;var n=this.h.estimatedThroughputWeightRatio;return 0<n&&1>=n?e*(1-n)+t*n:e};function Yy(e){return e?e.toLowerCase()==="false"?!1:/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""):!0}he("shaka.util.CmsdManager",Ai),Ai.prototype.getBandwidthEstimate=Ai.prototype.getBandwidthEstimate,Ai.prototype.getRoundTripTime=Ai.prototype.Zh,Ai.prototype.getResponseDelay=Ai.prototype.Yh,Ai.prototype.getEstimatedThroughput=Ai.prototype.xg,Ai.prototype.getMaxBitrate=Ai.prototype.zg;var Ky="etp",Zy="mb",Qy="rd",Jy="rtt";function e1(){this.g=null,this.h=[]}function Ld(e,t){return $(function(n){if(n.g==1)return e.g?E(n,new Promise(function(i){return e.h.push(i)}),2):n.u(2);e.g=t,F(n)})}e1.prototype.release=function(){0<this.h.length?this.h.shift()():this.g=null};function ve(e,t){Et.call(this);var n=this;this.l=Vd,this.de=this.h=null,this.oa=!1,this.qe=new lt,this.gd=new lt,this.m=new lt,this.Fa=new lt,this.ub=new lt,this.C=this.G=this.B=this.H=null,this.te=0,this.Z=new e1,this.pa=this.ag=this.da=this.i=this.ab=this.F=this.j=this.Zc=this.K=this.eg=this.ea=this.N=this.dd=this.L=this.he=this.I=this.Fb=null,this.Ea=!1,this.xa=this.o=null,this.cg=1e9,this.qd=[],this.U=NaN,this.g=_o(this),this.R=null,this.ze=-1,this.Da=null,this.fa={width:1/0,height:1/0},this.be=new Gh(this.g,this.fa,null),this.ke=[],this.s=null,this.za=new ts(this.g.preferredAudioLanguage,this.g.preferredVariantRole,this.g.preferredAudioChannelCount,this.g.preferredVideoHdrLevel,this.g.preferSpatialAudio,this.g.preferredVideoLayout,this.g.preferredAudioLabel,this.g.preferredVideoLabel,this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),this.Db=this.g.preferredTextLanguage,this.pd=this.g.preferredTextRole,this.od=this.g.preferForcedSubs,this.md=[],t&&t(this),this.N=cA(this),this.ea=new Ai(this.g.cmsd),this.H=a1(this),this.H.Pf(this.g.streaming.forceHTTP),this.H.Qf(this.g.streaming.forceHTTPS),this.Gb=this.ba=this.A=null,this.Ce=!1,this.dg=new ct(function(){return $(function(i){if(i.g==1)return n.ba?E(i,n.Rb(n.Gb,!0),3):i.u(0);if(i.g!=4)return E(i,n.load(n.ba),4);n.Ce?n.Gb.pause():n.Gb.play(),n.ba=null,n.Ce=!1,F(i)})}),lf&&(this.A=lf(),this.A.configure(this.g.ads),this.ub.D(this.A,"ad-content-pause-requested",function(i){var s;return $(function(l){if(l.g==1)return n.dg.stop(),n.ba?l.u(0):(n.Gb=n.h,n.Ce=n.h.ended,s=i.saveLivePosition||!1,E(l,n.qg(!0,s),3));n.ba=l.h,F(l)})}),this.ub.D(this.A,"ad-content-resume-requested",function(i){if(i=i.offset||0,n.ba){var s=n.ba;s.A&&i&&(s.A+=i)}n.dg.Y(.1)}),this.ub.D(this.A,"ad-content-attach-requested",function(){return $(function(i){return n.h||!n.Gb?i.u(0):E(i,n.Rb(n.Gb,!0),0)})})),this.qe.D(p,"online",function(){jd(n),n.If()}),this.je=new ct(function(){for(var i=Date.now()/1e3,s=!1,l=!0,u=x(n.i.variants),c=u.next();!c.done;c=u.next())c=c.value,0<c.disabledUntilTime&&c.disabledUntilTime<=i&&(c.disabledUntilTime=0,s=!0),0<c.disabledUntilTime&&(l=!1);l&&n.je.stop(),s&&Es(n,!1,void 0,!1,!1)}),this.qa=null,e&&(vt("Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.Rb(e,!0))}le(ve,Et);function nf(e){e.K!=null&&(ey(e.K),e.K.release(),e.K=null)}function JE(e,t){t.lcevc.enabled?(nf(e),e.K==null&&(e.K=new Ua(e.h,e.eg,t.lcevc),e.G&&(e.G.Z=e.K))):nf(e)}function Ht(e,t){return new Ue(e,t)}a=ve.prototype,a.destroy=function(){var e=this,t;return $(function(n){switch(n.g){case 1:return e.l==Qi?n.return():(nf(e),t=e.detach(),e.l=Qi,E(n,t,2));case 2:return E(n,e.Qe(),3);case 3:if(e.qe&&(e.qe.release(),e.qe=null),e.gd&&(e.gd.release(),e.gd=null),e.m&&(e.m.release(),e.m=null),e.Fa&&(e.Fa.release(),e.Fa=null),e.ub&&(e.ub.release(),e.ub=null),e.xa=null,e.g=null,e.s=null,e.de=null,e.N=null,e.ea=null,!e.H){n.u(4);break}return E(n,e.H.destroy(),5);case 5:e.H=null;case 4:e.o&&(e.o.release(),e.o=null),Et.prototype.release.call(e),F(n)}})};function Cs(e,t){e.dispatchEvent(Ht("onstatechange",new Map().set("state",t)))}a.Rb=function(e,t){t=t===void 0?!0:t;var n=this,i,s,l;return $(function(u){switch(u.g){case 1:if(n.l==Qi)throw new K(2,7,7e3);if(i=n.h&&n.h==e,!n.h||n.h==e){u.u(2);break}return E(u,n.detach(),2);case 2:return E(u,Pd(n,"attach"),4);case 4:if(u.h)return u.return();if(ue(u,5,6),i||(Cs(n,"attach"),s=function(){var c=Fd(n,!1);c&&As(n,c)},n.gd.D(e,"error",s),n.h=e),!t||!Wi()||n.G){u.u(6);break}return E(u,Dd(n),6);case 6:ee(u),n.Z.release(),de(u,0);break;case 5:return l=ie(u),E(u,n.detach(),10);case 10:throw l}})},a.zh=function(e){this.eg=e},a.detach=function(e){e=e===void 0?!1:e;var t=this;return $(function(n){if(n.g==1){if(t.l==Qi)throw new K(2,7,7e3);return E(n,t.bc(!1,e),2)}if(n.g!=3)return E(n,Pd(t,"detach"),3);if(n.h)return n.return();try{t.h&&(t.gd.Ra(),t.h=null),Cs(t,"detach"),t.A&&!e&&t.A.release()}finally{t.Z.release()}F(n)})};function Pd(e,t){var n;return $(function(i){return i.g==1?(n=++e.te,E(i,Ld(e.Z,t),2)):n!=e.te?(e.Z.release(),i.return(!0)):i.return(!1)})}a.bc=function(e,t){e=e===void 0?!0:e,t=t===void 0?!1:t;var n=this,i,s,l,u,c,d,g,y,w,C;return $(function(T){switch(T.g){case 1:return n.l!=Qi&&(n.l=Vd),E(T,Pd(n,"unload"),2);case 2:return T.h?T.return():(ye(T,3),n.Ea=!1,Cs(n,"unload"),e&&!Wi()&&(e=!1),nf(n),i=n.md.map(function(A){return A()}),n.md=[],E(T,Promise.all(i),5));case 5:if(n.dispatchEvent(Ht("unloading")),n.dd&&(n.dd.release(),n.dd=null),n.h&&(n.m.Ra(),n.Fa.Ra()),n.je.stop(),n.Fb&&(n.Fb.release(),n.Fb=null),n.he&&(n.he.stop(),n.he=null),!n.F){T.u(6);break}return E(T,n.F.stop(),7);case 7:n.F=null,n.ab=null;case 6:if(!n.o){T.u(8);break}return E(T,n.o.stop(),8);case 8:if(!n.j){T.u(10);break}return E(T,n.j.destroy(),11);case 11:n.j=null;case 10:if(n.I&&(n.I.release(),n.I=null),n.C&&(n.C.release(),n.C=null),!cu("webkit")||!n.B){T.u(12);break}return E(T,n.B.destroy(),13);case 13:n.B=null;case 12:if(!n.G){T.u(14);break}return E(T,n.G.destroy(),15);case 15:n.G=null;case 14:if(n.A&&!t&&n.A.onAssetUnload(),n.ba&&!t&&(n.ba.destroy(),n.ba=null),t||n.dg.stop(),n.N&&GE(n.N),n.ea&&(n.ea.g=null),n.h&&ws(n.h),!n.h||!n.h.src){T.u(16);break}return E(T,new Promise(function(A){return new ct(A).Y(.1)}),17);case 17:n.h.removeAttribute("src"),n.h.load();case 16:if(!n.B){T.u(18);break}return E(T,n.B.destroy(),19);case 19:n.B=null;case 18:if(n.qa&&n.da!=n.qa.Dc()&&(n.qa.s||n.qa.destroy(),n.qa=null),n.da=null,n.ag=null,n.L=null,n.i){for(s=x(n.i.variants),l=s.next();!l.done;l=s.next())for(u=l.value,c=x([u.audio,u.video]),d=c.next();!d.done;d=c.next())(g=d.value)&&g.segmentIndex&&g.segmentIndex.release();for(y=x(n.i.textStreams),w=y.next();!w.done;w=y.next())C=w.value,C.segmentIndex&&C.segmentIndex.release()}n.g.streaming.clearDecodingCache&&(Jg={},ru.clear()),n.i=null,n.s=new Bu,n.bg=null,n.Da=null,n.R=null,n.ze=-1,n.qd=[],n.U=NaN,Bd(n);case 3:ee(T),n.Z.release(),de(T,4);break;case 4:if(e&&Wi()&&!n.G&&n.h)return E(T,Dd(n),0);T.u(0)}})},a.ej=function(e){this.pa=e},a.load=function(e,t,n){t=t===void 0?null:t;var i=this,s,l,u,c,d,g,y,w,C,T,A,b,k;return $(function(O){switch(O.g){case 1:if(i.l==Qi)throw new K(2,7,7e3);return s=null,l="",e instanceof Ro?(s=e,l=s.Dc()||""):l=e||"",E(O,Ld(i.Z,"load"),2);case 2:if(i.Z.release(),!i.h)throw new K(2,7,7002);if(!i.da){O.u(3);break}return i.da=l,E(O,i.bc(!1),3);case 3:if(u=++i.te,c=function(){return $(function(D){if(D.g==1)return i.te==u?D.u(0):s?E(D,s.destroy(),3):D.u(3);throw new K(2,7,7e3)})},d=function(D,z){return $(function(P){switch(P.g){case 1:return ye(P,2),E(P,Ld(i.Z,z),4);case 4:return E(P,c(),5);case 5:return E(P,D(),6);case 6:return E(P,c(),7);case 7:s&&i.g&&(s.g=i.g);case 2:ee(P),i.Z.release(),de(P,0)}})},ue(O,5,6),t==null&&s&&(t=s.getStartTime()),i.pa=t,i.Ea=!1,i.dispatchEvent(Ht("loading")),s){n=s.U,O.u(8);break}if(n){O.u(8);break}return E(O,d(function(){return $(function(D){if(D.g==1)return E(D,o1(i,l),2);n=D.h,F(D)})},"guessMimeType_"),8);case 8:if(g=!!s,s){Uy(s,i),i.s=s.getStats(),O.u(11);break}return E(O,n1(i,l,t,n,!0),12);case 12:(s=O.h)?(Uy(s,i),i.s=s.getStats(),s.start(),s.m.catch(function(){})):i.s=new Bu;case 11:if(y=!s,w=Date.now()/1e3,i.s=s?s.getStats():new Bu,i.da=l,i.ag=n||null,y)return E(O,d(function(){return $(function(D){return E(D,iA(i,n),0)})},"initializeSrcEqualsDrmInner_"),20);if(i.G){O.u(15);break}return E(O,d(function(){return $(function(D){return E(D,Dd(i),0)})},"initializeMediaSourceEngineInner_"),15);case 15:return E(O,d(function(){return $(function(D){return E(D,s.m,0)})},"waitForFinish"),17);case 17:return i.g=s.getConfiguration(),i.be=s.C,i.ab=s.F,i.F=_E(s),i.F&&i.F.setMediaElement&&i.h&&i.F.setMediaElement(i.h),i.dd=LE(s),i.Zc=s.za,i.i=s.gf(),(C=s.o)&&(i.za=C),g&&i.h&&i.h.nodeName==="AUDIO"&&(eA(i),i.configure("manifest.disableVideo",!0)),i.B=PE(s),E(O,d(function(){return $(function(D){return E(D,i.B.Rb(i.h),0)})},"drmEngine_.attach"),18);case 18:return!(T=s.B)||i.xa&&i.xa==T||(i.o=RE(s),i.xa=s.B,typeof i.o.setMediaElement!="function"&&(vt("AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),i.o.setMediaElement=function(){}),typeof i.o.setCmsdManager!="function"&&(vt("AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),i.o.setCmsdManager=function(){}),typeof i.o.trySuggestStreams!="function"&&(vt("AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),i.o.trySuggestStreams=function(){})),A=DE(s),b=s.fa,E(O,d(function(){return $(function(D){return E(D,nA(i,w,b,A),0)})},"loadInner_"),19);case 19:ME(s),O.u(14);break;case 20:return E(O,d(function(){return $(function(D){return E(D,oA(i,w,n),0)})},"srcEqualsInner_"),14);case 14:i.dispatchEvent(Ht("loaded"));case 6:if(ee(O),!s){O.u(22);break}return E(O,s.destroy(),22);case 22:i.qa=null,de(O,0);break;case 5:if(k=ie(O),!k||k.code==7e3){O.u(24);break}return E(O,i.bc(!1),24);case 24:throw k}})};function eA(e){for(var t=x(e.i.variants),n=t.next();!n.done;n=t.next())n=n.value,n.video&&(n.video.closeSegmentIndex(),n.video=null),n.bandwidth=n.audio&&n.audio.bandwidth?n.audio.bandwidth:0;e.i.variants=e.i.variants.filter(function(i){return i.audio})}a.aj=function(e,t){e=e===void 0?!0:e,t=t===void 0?!1:t;var n=this,i;return $(function(s){return s.g==1?E(s,t1(n),2):s.g!=3?(i=s.h,E(s,n.bc(e,t),3)):s.return(i)})},a.qg=function(e,t){e=e===void 0?!1:e,t=t===void 0?!1:t;var n=this,i;return $(function(s){return s.g==1?E(s,t1(n,t),2):s.g!=3?(i=s.h,E(s,n.detach(e),3)):s.return(i)})};function t1(e,t){t=t===void 0?!1:t;var n,i;return $(function(s){if(s.g==1)return n=null,e.i&&e.F&&e.ab&&e.da?(i=e.h.currentTime,e.V()&&!t&&(i=null),E(s,i1(e,e.da,i,e.ag,!0,!1,!1),3)):s.u(2);if(s.g!=2){n=s.h,e.ke.push(n),e.F&&e.F.setMediaElement&&e.F.setMediaElement(null);var l=n,u=e.F,c=e.ab;l.h=e.i,l.j=u,l.F=c,l=n,u=e.xa,l.i=e.o,l.B=u,n.o=e.za,n.start(),e.i=null,e.F=null,e.ab=null,e.o=null,e.xa=null}return s.return(n)})}a.preload=function(e,t,n){t=t===void 0?null:t;var i=this,s;return $(function(l){return l.g==1?E(l,n1(i,e,t,n),2):((s=l.h)?s.start():As(i,new K(2,7,7005)),l.return(s))})},a.Qe=function(){var e=this,t,n,i,s;return $(function(l){for(t=[],n=x(e.ke),i=n.next();!i.done;i=n.next())s=i.value,s.s||t.push(s.destroy());return e.ke=[],E(l,Promise.all(t),0)})};function n1(e,t,n,i,s){s=s===void 0?!1:s;var l,u,c;return $(function(d){return d.g==1?i?d.u(2):E(d,o1(e,t),3):(d.g!=2&&(i=d.h),tA(e,i)?d.return(null):(l=!1,u=!0,s&&(e.o&&e.xa==e.g.abrFactory&&(u=!1),e.h&&e.h.nodeName==="AUDIO"&&(l=!0)),c=i1(e,t,n,i||null,!s,l,u),s||(c=c.then(function(g){return e.ke.push(g),g})),d.return(c)))})}function i1(e,t,n,i,s,l,u){s=s===void 0?!0:s,l=l===void 0?!1:l,u=u===void 0?!0:u;var c,d,g,y,w,C,T,A,b,k,O,D,z,P,B;return $(function(G){return G.g==1?(c=null,d=uo(e.g),l&&(d.manifest.disableVideo=!0),g=function(){return c.R&&c.s?null:c},y=function(){return g()?g().getConfiguration():e.g},w=function(q,J){g()?c.configure(q,J):e.configure(q,J)},e.fa.width!=1/0||e.fa.height!=1/0?G.u(2):E(G,Rg(),3)):(G.g!=2&&(C=G.h,e.fa.width=C.width,e.fa.height=C.height),T=new Gh(d,e.fa,null),A={networkingEngine:e.H,filter:function(q){var J,fe;return $(function(te){if(te.g==1)return E(te,Bm(T,q),2);if(te.g!=4)return J=te.h,J?(fe=Ht("trackschanged"),E(te,Promise.resolve(),4)):te.u(0);c.dispatchEvent(fe),F(te)})},makeTextStreamsForClosedCaptions:function(q){return pA(e,q)},onTimelineRegionAdded:function(q){var J=c.G;e:{for(var fe=x(J.g),te=fe.next();!te.done;te=fe.next())if(te=te.value,te.schemeIdUri==q.schemeIdUri&&te.id==q.id&&te.startTime==q.startTime&&te.endTime==q.endTime){fe=te;break e}fe=null}fe==null&&(J.g.add(q),q=new Ue("regionadd",new Map([["region",q]])),J.dispatchEvent(q))},onEvent:function(q){return c.dispatchEvent(q)},onError:function(q){return c.onError(q)},isLowLatencyMode:function(){return y().streaming.lowLatencyMode},isAutoLowLatencyMode:function(){return y().streaming.autoLowLatencyMode},enableLowLatencyMode:function(){w("streaming.lowLatencyMode",!0)},updateDuration:function(){e.j&&c.R&&e.j.updateDuration()},newDrmInfo:function(q){var J=c.l,fe=J?J.g:null;fe&&J.s&&Xh(T,fe.keySystem,q)},onManifestUpdated:function(){var q=new Map().set("isLive",e.V());c.dispatchEvent(Ht("manifestupdated",q)),Ga(c,!1,function(){e.A&&e.A.onManifestUpdated(e.V())})},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},onMetadata:function(q,J,fe,te){var ne=q;q=="com.apple.hls.interstitial"&&(ne="com.apple.quicktime.HLS",q={startTime:J,endTime:fe,values:te},e.A)&&e.A.onInterstitialMetadata(e,e.h,q),te=x(te),q=te.next();for(var oe={};!q.done;oe={Pg:void 0},q=te.next())oe.Pg=q.value,Ga(c,!1,function(xe){return function(){Nd(e,J,fe,ne,xe.Pg)}}(oe))},disableStream:function(q){return e.disableStream(q,e.g.streaming.maxDisabledTime)}},b=new dd(function(){return e.Ob()}),b.addEventListener("regionadd",function(q){var J=q.region;Ka(e,"timelineregionadded",J,c),Ga(c,!1,function(){e.A&&e.A.onDashTimedMetadata(J)})}),k=null,d.streaming.observeQualityChanges&&(k=new Fu(function(){return e.wb()}),k.addEventListener("qualitychange",function(q){w1(e,q.quality,q.position)}),k.addEventListener("audiotrackchange",function(q){w1(e,q.quality,q.position,!0)})),O=!0,D={Lb:e.H,onError:function(q){return c.onError(q)},ee:function(q){Ga(c,!0,function(){e:{var J=q,fe=Ht("keystatuschanged");e.dispatchEvent(fe);var te=Object.keys(J);te.length==1&&te[0]==""&&(te=["00"],J={"00":J[""]}),fe=te.length==1&&te[0]=="00";var ne=!1;if(te.length){te=x(e.i.variants);for(var oe=te.next();!oe.done;oe=te.next()){oe=oe.value;var xe=[];oe.audio&&xe.push(oe.audio),oe.video&&xe.push(oe.video),xe=x(xe);for(var pe=xe.next();!pe.done;pe=xe.next()){var we=pe.value;if(pe=oe.allowedByKeySystem,we.keyIds.size){oe.allowedByKeySystem=!0,we=x(we.keyIds);for(var Me=we.next();!Me.done;Me=we.next())Me=Me.value,((Me=J[fe?"00":Me])||e.B.F)&&(oe.allowedByKeySystem=oe.allowedByKeySystem&&!!Me&&!$m.includes(Me))}pe!=oe.allowedByKeySystem&&(ne=!0)}}}if(ne&&(ki(e),!Lr(e)))break e;(J=e.j.j)&&!J.allowedByKeySystem&&Es(e)}})},onExpirationUpdated:function(q,J){var fe=Ht("expirationupdated");c.dispatchEvent(fe),(fe=c.j)&&fe.onExpirationUpdated&&fe.onExpirationUpdated(q,J)},onEvent:function(q){c.dispatchEvent(q),q.type=="drmsessionupdate"&&O&&(O=!1,q=Date.now()/1e3-c.qa,(e.s||c.getStats()).j=q,e.K&&ey(e.K))}},z=a1(e,g),cm(e.H,z),P=function(){return e.yc(D)},B={config:d,wi:A,Fi:b,Ei:k,yc:P,vi:T,networkingEngine:z,yh:s,xh:u},c=new Ro(t,i,n,B),G.return(c))})}function o1(e,t){var n,i;return $(function(s){return s.g==1?(n=e.g.manifest.retryParameters,E(s,kd(t,e.H,n),2)):(i=s.h,i=="application/x-mpegurl"&&Xr()&&(i="application/vnd.apple.mpegurl"),s.return(i))})}function tA(e,t){if(!Wi())return!0;if(t){if((e.h||Mg()).canPlayType(t)=="")return!1;if(!(Wi()&&t in Fi))return!0;if(Ng(t))return Xr()&&(e.g.drm.servers["com.apple.fps"]||e.g.drm.servers["com.apple.fps.1_0"])?e.g.streaming.useNativeHlsForFairPlay:e.g.streaming.preferNativeHls}return!1}function Dd(e){var t,n,i,s,l;return $(function(u){if(u.g==1)return Cs(e,"media-source"),t=e.g.textDisplayFactory,n=t(),n.configure?n.configure(e.g.textDisplayer):vt("Text displayer w/ configure",'Text displayer should have a "configure" method!'),e.bg=t,i=fA(e.h,n,{Qh:function(){return e.keySystem()},onMetadata:function(c,d,g){r1(e,c,d,g)}},e.K),i.configure(e.g.mediaSource),s=e.g.manifest,l=s.segmentRelativeVttTiming,i.fa=l,E(u,i.L,2);e.G=i,F(u)})}function nA(e,t,n,i){var s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe;return $(function(te){switch(te.g){case 1:Cs(e,"load"),s=e.h,e.I=new ja({Nd:function(){return s.playbackRate},hc:function(){return s.defaultPlaybackRate},Rf:function(ne){s.playbackRate=ne},Lg:function(ne){s.currentTime+=ne}}),l=function(){return of(e)},u=function(){return p1(e)},e.m.D(s,"playing",l),e.m.D(s,"pause",l),e.m.D(s,"ended",l),e.m.D(s,"ratechange",u),JE(e,e.g),e.Db=e.g.preferredTextLanguage,e.pd=e.g.preferredTextRole,e.od=e.g.preferForcedSubs,$d(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.o.init(function(ne,oe,xe){e.i&&e.j&&ne!=e.j.j&&sf(e,ne,!0,oe===void 0?!1:oe,xe===void 0?0:xe)}),e.o.setMediaElement(s),e.o.setCmsdManager(e.ea),e.j=hA(e),e.j.configure(e.g.streaming),e.l=Pn,s.textTracks&&e.m.D(s.textTracks,"addtrack",function(ne){if(ne.track)switch(ne=ne.track,ne.kind){case"chapters":s1(e,ne)}}),e.dispatchEvent(Ht("streaming")),c=n;case 2:for((g=e.j.j)||c||(c=Lr(e)?e.o.chooseVariant():null),y=[],d=g||c,w=x([d.video,d.audio]),C=w.next();!C.done;C=w.next())(T=C.value)&&!T.segmentIndex&&y.push(T.createSegmentIndex());if(!(0<y.length)){te.u(4);break}return E(te,Promise.all(y),4);case 4:if(!d||d.disabledUntilTime!=0){te.u(2);break}if(e.F&&e.F.onInitialVariantChosen&&e.F.onInitialVariantChosen(d),e.i.isLowLatency&&!e.g.streaming.lowLatencyMode&&Fe("Low-latency live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),$d(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),hE(e.j,e.g.playRangeStart,e.g.playRangeEnd),A=function(ne){e.C=lA(e,ne),e.Fb=uA(e,ne),l1(e,s,Math.max(e.i.minBufferTime,e.g.streaming.rebufferingGoal))},e.g.streaming.startAtSegmentBoundary||A(e.pa),g){te.u(7);break}if(!e.g.streaming.startAtSegmentBoundary){te.u(8);break}return b=e.i.presentationTimeline,k=e.pa||e.h.currentTime,O=b.Vb(),D=b.yb(),k<O?k=O:k>D&&(k=D),E(te,gA(c,k),9);case 9:z=te.h,A(z);case 8:sf(e,c,!0,!1,0);case 7:return e.C.ready(),P=e.Ec().find(function(ne){return ne.active}),P||((B=Ia(e.i.textStreams,e.Db,e.pd,e.od)[0]||null)&&fd(e.s.h,B,!0),c&&(B?(mA(e,c.audio,B)&&(e.oa=!0),e.oa&&e.G.F.setTextVisibility(!0),v1(e)):e.oa=!1),B&&(e.g.streaming.alwaysStreamText||e.qf())&&Hu(e.j,B)),E(te,e.j.start(i),10);case 10:e.g.abr.enabled&&(e.o.enable(),x1(e)),ki(e),Lr(e),e.i.variants.some(function(ne){return ne.primary}),((G=e.V())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.i.serviceDescription||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(q=function(){return g1(e)},e.m.D(s,"timeupdate",q)),G||(J=function(){return rf(e)},e.m.D(s,"timeupdate",J),rf(e),e.i.nextUrl&&(0<e.g.streaming.preloadNextUrlWindow&&(fe=function(){var ne;return $(function(oe){if(oe.g==1)return ne=e.h.duration-e.h.currentTime,isNaN(ne)||!(ne<=e.g.streaming.preloadNextUrlWindow)?oe.u(0):(e.m.jb(s,"timeupdate",fe),E(oe,e.preload(e.i.nextUrl),4));e.qa=oe.h,F(oe)})},e.m.D(s,"timeupdate",fe)),e.m.D(s,"ended",function(){e.load(e.qa||e.i.nextUrl)}))),e.A&&e.A.onManifestUpdated(G),e.Ea=!0,e.m.ha(s,"loadedmetadata",function(){e.s.m=Date.now()/1e3-t}),F(te)}})}function iA(e,t){var n,i,s,l,u;return $(function(c){return c.g==1?(n=sn,i=Date.now()/1e3,s=!0,e.B=e.yc({Lb:e.H,onError:function(d){As(e,d)},ee:function(){},onExpirationUpdated:function(){var d=Ht("expirationupdated");e.dispatchEvent(d)},onEvent:function(d){e.dispatchEvent(d),d.type=="drmsessionupdate"&&s&&(s=!1,e.s.j=Date.now()/1e3-i)}}),e.B.configure(e.g.drm),l={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},u={id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:t?Ni(t):"",codecs:t?di(t):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:n.ga,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set},u.fullMimeTypes.add(an(u.mimeType,u.codecs)),t.startsWith("audio/")?(u.type=n.X,l.audio=u):l.video=u,e.B.ba=!0,E(c,km(e.B,[l],[]),2)):E(c,e.B.Rb(e.h),0)})}function oA(e,t,n){var i,s,l,u,c,d,g,y,w,C,T,A;return $(function(b){if(b.g==1)return Cs(e,"src-equals"),i=e.h,e.C=new my(i),s=!1,e.md.push(function(){s=!0}),e.pa!=null&&e.C.Ee(e.pa),e.I=new ja({Nd:function(){return i.playbackRate},hc:function(){return i.defaultPlaybackRate},Rf:function(k){i.playbackRate=k},Lg:function(k){i.currentTime+=k}}),l=e.g.streaming.rebufferingGoal,l1(e,i,l),u=function(){return of(e)},c=function(){return p1(e)},e.m.D(i,"playing",u),e.m.D(i,"pause",u),e.m.D(i,"ended",u),e.m.D(i,"ratechange",c),i.preload!="none"&&e.m.ha(i,"loadedmetadata",function(){e.s.m=Date.now()/1e3-t}),i.audioTracks&&(e.m.D(i.audioTracks,"addtrack",function(){return ki(e)}),e.m.D(i.audioTracks,"removetrack",function(){return ki(e)}),e.m.D(i.audioTracks,"change",function(){return ki(e)})),i.textTracks&&(e.m.D(i.textTracks,"addtrack",function(k){if(k.track)switch(k=k.track,k.kind){case"metadata":aA(e,k);break;case"chapters":s1(e,k);break;default:ki(e)}}),e.m.D(i.textTracks,"removetrack",function(){return ki(e)}),e.m.D(i.textTracks,"change",function(){return ki(e)})),d=XE(e.N,e.da,n),!d.includes("#t=")&&(0<e.g.playRangeStart||isFinite(e.g.playRangeEnd))&&(d+="#t=",0<e.g.playRangeStart&&(d+=e.g.playRangeStart),isFinite(e.g.playRangeEnd)&&(d+=","+e.g.playRangeEnd)),i.src=d,(so()||ao())&&i.load(),i.preload!="none"&&!i.autoplay&&Ng(n)&&Wr()&&i.load(),e.l=zn,e.dispatchEvent(Ht("streaming")),g=new _t,ps(i,HTMLMediaElement.HAVE_METADATA,e.m,function(){e.C.ready(),g.resolve()}),ps(i,HTMLMediaElement.HAVE_CURRENT_DATA,e.m,function(){var k;return $(function(O){if(O.g==1)return rA(e),k=Ya(e),k.find(function(D){return D.mode!="disabled"})?(0<k.length&&(e.oa=!0),O.u(2)):E(O,new Promise(function(D){e.m.ha(i.textTracks,"change",D),new ct(D).Y(1)}),2);if(s)return O.return();sA(e),F(O)})}),i.error?g.reject(Fd(e)):i.preload=="none"&&(Fe('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),g.resolve()),e.m.ha(i,"error",function(){g.reject(Fd(e))}),y=new Promise(function(k,O){new ct(O).Y(e.g.streaming.loadTimeout)}),E(b,Promise.race([g,y]),2);((w=e.V())&&(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled||e.g.streaming.liveSync.panicMode)||e.g.streaming.vodDynamicPlaybackRate)&&(C=function(){return g1(e)},e.m.D(i,"timeupdate",C)),w||(T=function(){return rf(e)},e.m.D(i,"timeupdate",T),rf(e)),e.A&&(e.A.onManifestUpdated(w),w&&(A=e.Ob().end,e.m.D(i,"progress",function(){var k=e.Ob().end;A!=k&&(e.A.onManifestUpdated(e.V()),A=k)}))),e.Ea=!0,F(b)})}function rA(e){var t=e.g.preferredAudioLanguage;t!=""&&e.Xg(t,e.g.preferredVariantRole)}function sA(e){var t=e.g.preferredTextLanguage;t!=""&&e.Lf(t,e.g.preferredTextRole,e.g.preferForcedSubs)}function aA(e,t){if(t.kind=="metadata"){t.mode="hidden",e.m.D(t,"cuechange",function(){if(t.activeCues){for(var i=[],s=x(t.activeCues),l=s.next(),u={};!l.done;u={Ta:void 0},l=s.next())u.Ta=l.value,Nd(e,u.Ta.startTime,u.Ta.endTime,u.Ta.type,u.Ta.value),e.A&&e.A.onCueMetadataChange(u.Ta.value),u.Ta.type=="com.apple.quicktime.HLS"&&u.Ta.startTime!=null&&(l=i.find(function(c){return function(d){return d.startTime==c.Ta.startTime&&d.endTime==c.Ta.endTime}}(u)),l||(l={startTime:u.Ta.startTime,endTime:u.Ta.endTime,values:[]},i.push(l)),l.values.push(u.Ta.value));for(i=x(i),s=i.next();!s.done;s=i.next())s=s.value,s.values.some(function(c){return c.key=="X-ASSET-URI"||c.key=="X-ASSET-LIST"})&&e.A&&(s.values.push({key:"CUE",description:"",data:"ONCE",mimeType:null,pictureType:null}),e.A.onInterstitialMetadata(e,e.h,s))}});var n=new ct(function(){var i=dA(e);i=x(i);for(var s=i.next();!s.done;s=i.next())s.value.mode="hidden"}).tc().Y(.5);e.md.push(function(){n.stop()})}}function r1(e,t,n,i){t=x(t);for(var s=t.next();!s.done;s=t.next())if(s=s.value,s.data&&typeof s.cueTime=="number"&&s.frames){var l=s.cueTime+n,u=i;u&&l>u&&(u=l);for(var c=x(s.frames),d=c.next();!d.done;d=c.next())Nd(e,l,u,"org.id3",d.value);e.A&&e.A.onHlsTimedMetadata(s,l)}}function Nd(e,t,n,i,s){t=new Map().set("startTime",t).set("endTime",n).set("metadataType",i).set("payload",s),e.dispatchEvent(Ht("metadata",t))}function s1(e,t){if(t&&t.kind=="chapters"){t.mode="hidden";var n=new ct(function(){t.mode="hidden"}).tc().Y(.5);e.md.push(function(){n.stop()})}}a.Ji=function(){for(var e=this.Z;e.g;)e.release()},a.yc=function(e){return new Mu(e)};function a1(e,t){function n(s){t()?t().dispatchEvent(s):e.dispatchEvent(s)}function i(s){t()?Ga(t(),!0,s):s()}return t||(t=function(){return null}),new Ut(function(s,l,u,c){var d=t()?t().i:e.o;d&&d.segmentDownloaded(s,l,u,c)},function(s,l,u){l=new Map().set("headers",s).set("request",l).set("requestType",u),n(Ht("downloadheadersreceived",l)),i(function(){if(e.ea){var c=e.ea;if(c.h.enabled){var d=s["cmsd-static"];if(d)try{var g=new Map,y=d.split(",");for(d=0;d<y.length;d++){var w=y[d].split("=");g.set(w[0],Yy(w[1]))}}catch{}if(g=s["cmsd-dynamic"]){try{var C=new Map,T=g.split(";");for(g=1;g<T.length;g++){var A=T[g].split("=");C.set(A[0],Yy(A[1]))}var b=C}catch{b=null}b&&(c.g=b)}}}})},function(s,l,u,c){s=new Map().set("request",s).set("error",l).set("httpResponseCode",u).set("aborted",c),n(Ht("downloadfailed",s))},function(s,l,u){i(function(){var c=e.N,d=u;if(d=d===void 0?{}:d,c.g.enabled)if(l.method==="HEAD")Ts(c,l);else switch(s){case 0:try{if(c.g.enabled){if(d.type){e:{switch(d.type){case 4:var g="d";break e;case 3:case 2:g="h";break e;case 5:g="s";break e}g=void 0}c.m=g}Ts(c,l,{ot:qy,su:!c.i})}}catch(pe){Ke("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",pe)}break;case Ki:try{if(c.g.enabled){var y=d.segment;g=0,y&&(g=y.endTime-y.startTime);var w={d:1e3*g,st:c.h.V()?"l":"v"};w.ot=qE(d);var C=w.ot===Ju||w.ot===Qu||w.ot===ef||w.ot===tf,T=d.stream;if(T){var A=c.h.eb();if(C&&(w.bl=YE(c,T.type),w.ot!==tf)){var b=Wy(c,T.type);w.dl=A?b/Math.abs(A):b}if(T.bandwidth&&(w.br=T.bandwidth/1e3),T.segmentIndex&&y){var k=T.segmentIndex.Ib(y.endTime,!0,0>A);if(k){var O=k.next().value;if(O&&O!=y){if(!mr(y.M(),O.M())){var D=O.M()[0],z=l.uris[0],P=new URL(D),B=new URL(z);if(P.origin!==B.origin)var G=D;else{for(var q=P.pathname.split("/").slice(1),J=B.pathname.split("/").slice(1,-1);q[0]===J[0];)q.shift(),J.shift();for(;J.length;)J.shift(),q.unshift("..");G=q.join("/")}w.nor=G}if((O.Ha||O.sa)&&(y.Ha!=O.Ha||y.sa!=O.sa)){var fe=O.Ha+"-";O.sa&&(fe+=O.sa),w.nrr=fe}}}var te=c.h.eb()||1,ne=Wy(c,T.type)||500,oe=T.bandwidth,xe=oe?oe*(y.endTime-y.startTime)/1e3/(ne/te/1e3)*c.g.rtpSafetyFactor:NaN;isNaN(xe)||(w.rtp=xe)}}C&&w.ot!==tf&&(w.tb=KE(c,w.ot)/1e3),Ts(c,l,w)}}catch(pe){Ke("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",pe)}break;case 2:case 5:case 6:Ts(c,l,{ot:"k"});break;case 4:Ts(c,l,{ot:"o"})}})},function(s,l,u,c){(s=t()?t().j:e.F)&&s.banLocation&&s.banLocation(c)},function(s,l){if(l.data){l=l.data.byteLength;var u=t()?t().getStats():e.s;u&&(u.Cd=isNaN(u.Cd)?l:u.Cd+l,s===0&&(u.Hg=l))}})}function lA(e,t){return new yy(e.h,e.i,e.g.streaming,t,function(){e.Fb&&Cy(e.Fb,!0),e.j&&e.j.Qc(),e.L&&_r(e)},function(n){return e.dispatchEvent(n)})}function uA(e,t){t=new Ku(e.dd,e.V()||0<t),t.addEventListener("enter",function(i){Ka(e,"timelineregionenter",i.region)}),t.addEventListener("exit",function(i){Ka(e,"timelineregionexit",i.region)}),t.addEventListener("skip",function(i){var s=i.region;i.seeking||(Ka(e,"timelineregionenter",s),Ka(e,"timelineregionexit",s))});var n=new Ty(e.h);return n.g.add(t),e.Zc&&n.g.add(e.Zc),n}function l1(e,t,n){e.L=new QT,e.L.g=ns,rm(e.L,n,Math.min(.5,n/2)),Bd(e),e.he=new ct(function(){_r(e)}).Sa(.25),e.m.D(t,"waiting",function(){return _r(e)}),e.m.D(t,"stalled",function(){return _r(e)}),e.m.D(t,"canplaythrough",function(){return _r(e)}),e.m.D(t,"progress",function(){return _r(e)})}function _r(e){switch(e.l){case zn:if(e.h.ended)var t=!0;else{var n=qh(e.h.buffered);t=n!=null&&n>=e.h.duration-1}break;case Pn:e:if(e.h.ended||oy(e.G))t=!0;else{if(e.i.presentationTimeline.V()){n=e.i.presentationTimeline.Wb();var i=qh(e.h.buffered);if(i!=null&&i>=n){t=!0;break e}}t=!1}break;default:t=!1}i=Xm(e.h.buffered,e.h.currentTime),n=e.L;var s=t,l=n.i.get(n.g);t=n.g,i=s||i>=l?Ma:ns,n.g=i,(t=t!=i)&&i===Ma&&(n.h=Date.now()),t&&Bd(e)}function fA(e,t,n,i){return new ny(e,t,n,i)}function cA(e){return new Xy({getBandwidthEstimate:function(){return e.o?e.o.getBandwidthEstimate():NaN},wb:function(){return e.wb()},getCurrentTime:function(){return e.h?e.h.currentTime:0},eb:function(){return e.eb()},xb:function(){return e.xb()},ic:function(){return e.ic()},V:function(){return e.V()}},e.g.cmcd)}function hA(e){return new My(e.i,{Md:function(){return e.C?e.C.yd():0},getBandwidthEstimate:function(){return e.o.getBandwidthEstimate()},eb:function(){return e.eb()},aa:e.G,Lb:e.H,onError:function(t){return As(e,t)},onEvent:function(t){return e.dispatchEvent(t)},Bi:function(){e.F&&e.F.update&&e.F.update()},Af:function(t,n){var i=t.startTime;t=t.endTime;var s=n.type;if(n=n.codecs.includes(","),e.C){e.C.Mg();var l=nd(e.G,s);!e.V()&&e.h.paused&&l!=null&&0<l&&e.C.yd()<l&&e.C.Ee(l)}_r(e),i=new Map().set("start",i).set("end",t).set("contentType",s).set("isMuxed",n),e.dispatchEvent(Ht("segmentappended",i))},Ai:function(t,n){(n=n.Hc)&&e.Zc&&sE(e.Zc,n,t)},kg:function(t,n){var i=e.B;if(i.h.parseInbandPsshEnabled&&!i.F&&["audio","video"].includes(t)){t=new xm(Ze(n)),n=0;for(var s=x(t.data),l=s.next();!l.done;l=s.next())n+=l.value.length;if(n==0)i=Promise.resolve();else{for(n=new Uint8Array(n),s=0,t=x(t.data),l=t.next();!l.done;l=t.next())l=l.value,n.set(l,s),s+=l.length;_a(i,"cenc",n),i=i.l}}else i=Promise.resolve();return i},onMetadata:function(t,n,i){r1(e,t,n,i)},disableStream:function(t,n){return e.disableStream(t,n)}})}a.configure=function(e,t){if(arguments.length==2&&typeof e=="string"&&(e=Wu(e,t)),e.streaming&&"forceTransmuxTS"in e.streaming&&(vt("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(vt("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&"useNativeHlsOnSafari"in e.streaming&&(vt("streaming.useNativeHlsOnSafari configuration","Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead."),e.streaming.preferNativeHls=e.streaming.useNativeHlsOnSafari&&Xr(),delete e.streaming.useNativeHlsOnSafari),e.streaming&&typeof e.streaming.liveSync=="boolean"){vt("streaming.liveSync","Please Use streaming.liveSync.enabled instead.");var n=e.streaming.liveSync;e.streaming.liveSync={},e.streaming.liveSync.enabled=n}if(e.streaming&&!(e.streaming.liveSync&&"targetLatency"in e.streaming.liveSync)&&("liveSyncMinLatency"in e.streaming||"liveSyncMaxLatency"in e.streaming)){n=e.streaming.liveSyncMinLatency||0;var i=Math.abs((e.streaming.liveSyncMaxLatency||1)-n)/2;e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=n+i,e.streaming.liveSync.targetLatencyTolerance=i}if(e.streaming&&"liveSyncMaxLatency"in e.streaming&&(vt("streaming.liveSyncMaxLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMaxLatency),e.streaming&&"liveSyncMinLatency"in e.streaming&&(vt("streaming.liveSyncMinLatency","Please Use streaming.liveSync.targetLatency and streaming.liveSync.targetLatencyTolerance instead. Or, set the values in your DASH manifest"),delete e.streaming.liveSyncMinLatency),e.streaming&&"liveSyncTargetLatency"in e.streaming&&(vt("streaming.liveSyncTargetLatency","Please Use streaming.liveSync.targetLatency instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatency=e.streaming.liveSyncTargetLatency,delete e.streaming.liveSyncTargetLatency),e.streaming&&"liveSyncTargetLatencyTolerance"in e.streaming&&(vt("streaming.liveSyncTargetLatencyTolerance","Please Use streaming.liveSync.targetLatencyTolerance instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.targetLatencyTolerance=e.streaming.liveSyncTargetLatencyTolerance,delete e.streaming.liveSyncTargetLatencyTolerance),e.streaming&&"liveSyncPlaybackRate"in e.streaming&&(vt("streaming.liveSyncPlaybackRate","Please Use streaming.liveSync.maxPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.maxPlaybackRate=e.streaming.liveSyncPlaybackRate,delete e.streaming.liveSyncPlaybackRate),e.streaming&&"liveSyncMinPlaybackRate"in e.streaming&&(vt("streaming.liveSyncMinPlaybackRate","Please Use streaming.liveSync.minPlaybackRate instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.minPlaybackRate=e.streaming.liveSyncMinPlaybackRate,delete e.streaming.liveSyncMinPlaybackRate),e.streaming&&"liveSyncPanicMode"in e.streaming&&(vt("streaming.liveSyncPanicMode","Please Use streaming.liveSync.panicMode instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicMode=e.streaming.liveSyncPanicMode,delete e.streaming.liveSyncPanicMode),e.streaming&&"liveSyncPanicThreshold"in e.streaming&&(vt("streaming.liveSyncPanicThreshold","Please Use streaming.liveSync.panicThreshold instead."),e.streaming.liveSync=e.streaming.liveSync||{},e.streaming.liveSync.panicThreshold=e.streaming.liveSyncPanicThreshold,delete e.streaming.liveSyncPanicThreshold),e.mediaSource&&"sourceBufferExtraFeatures"in e.mediaSource){vt("mediaSource.sourceBufferExtraFeatures configuration","Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.");var s=e.mediaSource.sourceBufferExtraFeatures;e.mediaSource.addExtraFeaturesToSourceBuffer=function(){return s},delete e.mediaSource.sourceBufferExtraFeatures}return e.streaming&&e.streaming.lowLatencyMode&&(e.streaming.inaccurateManifestTolerance==null&&(e.streaming.inaccurateManifestTolerance=0),e.streaming.rebufferingGoal==null&&(e.streaming.rebufferingGoal=.01),e.streaming.segmentPrefetchLimit==null&&(e.streaming.segmentPrefetchLimit=2),e.streaming.updateIntervalSeconds==null&&(e.streaming.updateIntervalSeconds=.1),e.streaming.maxDisabledTime==null&&(e.streaming.maxDisabledTime=1),e.streaming.retryParameters==null&&(e.streaming.retryParameters={}),e.streaming.retryParameters.baseDelay==null&&(e.streaming.retryParameters.baseDelay=100),e.manifest==null&&(e.manifest={}),e.manifest.dash==null&&(e.manifest.dash={}),e.manifest.dash.autoCorrectDrift==null&&(e.manifest.dash.autoCorrectDrift=!1),e.manifest.retryParameters==null&&(e.manifest.retryParameters={}),e.manifest.retryParameters.baseDelay==null&&(e.manifest.retryParameters.baseDelay=100),e.drm==null&&(e.drm={}),e.drm.retryParameters==null&&(e.drm.retryParameters={}),e.drm.retryParameters.baseDelay==null&&(e.drm.retryParameters.baseDelay=100)),n=Zo(this.g,e,_o(this)),u1(this),n};function u1(e){if(e.be=new Gh(e.g,e.fa,e.B),e.F){var t=uo(e.g.manifest);e.h&&e.h.nodeName==="AUDIO"&&(t.disableVideo=!0),e.F.configure(t)}if(e.B&&e.B.configure(e.g.drm),e.j){e.j.configure(e.g.streaming);try{e.l!=Qi&&jm(e.be,e.i)&&ki(e)}catch(l){As(e,l)}e.o&&Lr(e),t=e.j.j,!t||t.allowedByApplication&&t.allowedByKeySystem||Es(e)}if(e.H&&(e.H.Pf(e.g.streaming.forceHTTP),e.H.Qf(e.g.streaming.forceHTTPS)),e.G)if(e.G.configure(e.g.mediaSource),e.G.fa=e.g.manifest.segmentRelativeVttTiming,t=e.g.textDisplayFactory,e.bg!=t){var n=t();n.configure?n.configure(e.g.textDisplayer):vt("Text displayer w/ configure",'Text displayer should have a "configure" method!');var i=e.G,s=i.F;i.F=n,s&&(n.setTextVisibility(s.isTextVisible()),s.destroy()),i.g&&(i.g.j=n),e.bg=t,e.j&&(t=e.j,(n=t.i.get(mt))&&ms(t,n.stream,!0,0,!0))}else t=e.G.F,t.configure&&t.configure(e.g.textDisplayer);e.o&&(e.o.configure(e.g.abr),e.g.abr.enabled?e.o.enable():e.o.disable(),x1(e)),e.L&&(t=e.g.streaming.rebufferingGoal,e.i&&(t=Math.max(t,e.i.minBufferTime)),rm(e.L,t,Math.min(.5,t/2))),e.i&&$d(e.i.presentationTimeline,e.g.playRangeStart,e.g.playRangeEnd),e.A&&e.A.configure(e.g.ads),e.N&&e.N.configure(e.g.cmcd),e.ea&&e.ea.configure(e.g.cmsd)}a.getConfiguration=function(){var e=_o(this);return Zo(e,this.g,_o(this)),e},a.Ag=function(){var e=_o(this);return Zo(e,this.g,_o(this)),Dy(this.g,_o(this))},a.vg=function(){if(this.h){var e=this.h.buffered.length;e=e?this.h.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(t=Math.min(this.h.currentTime+t,this.Ob().end),e>=t)return 1;if(!(e<=this.h.currentTime)&&e<t)return(e-this.h.currentTime)/(t-this.h.currentTime)}return 0},a.Ni=function(){for(var e in this.g)delete this.g[e];Zo(this.g,_o(this),_o(this)),u1(this)},a.yg=function(){return this.l},a.hf=function(){return this.i?this.i.type:null},a.Uh=function(){return this.h},a.xb=function(){return this.H},a.Dc=function(){return this.da},a.ug=function(){return this.A?this.A:null},a.V=function(){return this.i?this.i.presentationTimeline.V():this.h&&this.h.src?this.h.duration==1/0:!1},a.kc=function(){return this.i?this.i.presentationTimeline.kc():!1},a.ki=function(){if(this.i){var e=this.i.variants;return e.length?!e[0].video:!1}return this.h&&this.h.src?this.h.videoTracks?this.h.videoTracks.length==0:this.h.videoHeight==0:!1},a.Ob=function(){if(this.i){if(!this.Ea&&this.i.type=="HLS")return{start:0,end:0};var e=this.i.presentationTimeline;return{start:e.Vb(),end:e.yb()}}return this.h&&this.h.src&&(e=this.h.seekable,e.length)?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},a.hi=function(){this.V()&&(this.h.currentTime=this.Ob().end)},a.li=function(){return this.Ea},a.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},a.drmInfo=function(){return this.B?this.B.g:null},a.ad=function(){return this.B?this.B.ad():1/0},a.ff=function(){return this.B?this.B.ff():[]},a.Ld=function(){return this.B?this.B.Ld():{}},a.pf=function(){return this.L?this.L.g==ns:!1},a.eb=function(){return this.h?this.I?this.I.i:1:0},a.wd=function(e){var t=this;e==0?Fe("A trick play rate of 0 is unsupported!"):(this.Fa.Ra(),this.h.paused&&this.h.play(),this.I.set(e),this.l==Pn&&(this.o.playbackRateChanged(e),Ry(this.j,1<Math.abs(e))),this.V()&&this.Fa.D(this.h,"timeupdate",function(){var n=t.h.currentTime,i=t.Ob(),s=t.g.streaming.safeSeekOffset;0<e?Math.floor(n)>=Math.floor(i.end)&&t.Tc():Math.floor(n)<=Math.floor(i.start+s)&&t.Tc()}))},a.Tc=function(){var e=this.I.hc();this.l==zn&&this.I.set(e),this.l==Pn&&(this.I.set(e),this.o.playbackRateChanged(e),Ry(this.j,!1)),this.Fa.Ra()},a.ic=function(){if(this.i){for(var e=this.j?this.j.j:null,t=[],n=0,i=x(this.i.variants),s=i.next();!s.done;s=i.next())if(s=s.value,ba(s)){var l=es(s);l.active=s==e,l.active||n==1||e==null||s.video!=e.video||s.audio!=e.audio||(l.active=!0),l.active&&n++,t.push(l)}return t}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map(function(u){return Ph(u)}):[]},a.Ec=function(){if(this.i){for(var e=this.j?this.j.s:null,t=[],n=x(this.i.textStreams),i=n.next();!i.done;i=n.next()){i=i.value;var s=gu(i);s.active=i==e,t.push(s)}return t}return this.h&&this.h.src&&this.h.textTracks?Ya(this).map(function(l){return Yg(l)}):[]},a.Oh=function(){var e=this.qd;return this.i&&(e=this.i.imageStreams),e.map(function(t){return _h(t)})},a.Gh=function(e){var t=this,n,i,s,l;return $(function(u){return u.g==1?t.l!=Pn&&t.l!=zn?u.return(null):(n=t.qd,t.i&&(n=t.i.imageStreams),(i=n.find(function(c){return c.id==e}))?i.segmentIndex?u.u(2):E(u,i.createSegmentIndex(),2):u.return(null)):u.g!=4?(s=[],i.segmentIndex.Hb(function(c){var d=f1(c.tilesLayout||i.tilesLayout);if(d){d=d.rows*d.dc;for(var g=c.j-c.startTime,y=0;y<d;y++)s.push(t.Cg(e,c.startTime+g*y/d))}}),E(u,Promise.all(s),4)):(l=u.h,u.return(l.filter(function(c){return c})))})};function f1(e){return e&&(e=/(\d+)x(\d+)/.exec(e))?{dc:parseInt(e[1],10),rows:parseInt(e[2],10)}:null}a.Cg=function(e,t){var n=this,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P;return $(function(B){return B.g==1?n.l!=Pn&&n.l!=zn?B.return(null):(i=n.qd,n.i&&(i=n.i.imageStreams),(s=i.find(function(G){return G.id==e}))?s.segmentIndex?B.u(2):E(B,s.createSegmentIndex(),2):B.return(null)):(l=s.segmentIndex.find(t),l==null||(u=s.segmentIndex.get(l),c=f1(u.tilesLayout||s.tilesLayout),!c)?B.return(null):(d=s.width||0,g=s.height||0,y=d/c.dc,w=g/c.rows,C=c.dc*c.rows,T=u.j-u.startTime,A=u.B||T/C,b=u.startTime,O=k=0,1<C&&(D=Math.floor((t-u.startTime)/A),b=u.startTime+D*A,k=D%c.dc*y,O=Math.floor(D/c.dc)*w),z=!1,(P=u.A)&&(z=!0,w=P.height,k=P.positionX,O=P.positionY,y=P.width),B.return({segment:u,imageHeight:g,imageWidth:d,height:w,positionX:k,positionY:O,startTime:b,duration:A,uris:u.M(),width:y,sprite:z})))})},a.Yg=function(e){if(this.i&&this.j){var t=this.i.textStreams.find(function(i){return i.id==e.id});t&&t!=this.j.s&&(fd(this.s.h,t,!1),Hu(this.j,t),af(this),this.Db=t.language)}else if(this.h&&this.h.src&&this.h.textTracks){t=Ya(this),t=x(t);for(var n=t.next();!n.done;n=t.next())n=n.value,Lh(n)==e.id?n.mode=this.oa?"showing":"hidden":n.mode="disabled";af(this)}},a.Mf=function(e,t,n){if(t=t===void 0?!1:t,n=n===void 0?0:n,this.i&&this.j){var i=this.i.variants.find(function(l){return l.id==e.id});if(i&&ba(i)){var s=this.j.j;this.g.abr.enabled&&(s.video!=i.video||s.audio&&i.audio&&s.audio.language==i.audio.language&&s.audio.channelsCount==i.audio.channelsCount)&&Fe("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack()."),sf(this,i,!1,t,n),this.za=new om(i,this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),Lr(this)}}else if(this.h&&this.h.audioTracks){for(t=Array.from(this.h.audioTracks),t=x(t),n=t.next();!n.done;n=t.next())if(n=n.value,Lh(n)==e.id){m1(this,n);break}}},a.Ih=function(){return T1(this.ic())},a.ai=function(){return T1(this.Ec())},a.Hh=function(){return Array.from(S1(this.ic()))},a.$h=function(){return Array.from(S1(this.Ec()))},a.Xg=function(e,t,n,i,s){if(n=n===void 0?0:n,i=i===void 0?0:i,s=s===void 0?"":s,this.i&&this.C){this.za=new ts(e,t||"",n,"",!1,"","","",this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups,s),e=function(u,c){return u.video||c.video?u.video&&c.video?Math.abs((u.video.height||0)-(c.video.height||0))+Math.abs((u.video.width||0)-(c.video.width||0)):1/0:0},t=this.j.j,s=this.za.create(this.i.variants),n=null,s=x(s.values());for(var l=s.next();!l.done;l=s.next())l=l.value,ba(l)&&(!n||e(n,t)>e(l,t))&&(n=l);n!=t&&(n?(e=es(n),this.Mf(e,!0,i)):Es(this))}else this.h&&this.h.audioTracks&&(i=Ia(this.ic(),e,t||"",!1)[0])&&this.Mf(i)},a.Lf=function(e,t,n){n=n===void 0?!1:n,this.i&&this.C?(this.Db=e,this.pd=t||"",this.od=n,(e=Ia(this.i.textStreams,this.Db,this.pd,this.od)[0]||null)&&e!=this.j.s&&(fd(this.s.h,e,!1),this.g.streaming.alwaysStreamText||this.qf())&&(Hu(this.j,e),af(this))):(e=Ia(this.Ec(),e,t||"",n)[0])&&this.Yg(e)},a.Ti=function(e,t,n){if(t=t===void 0?!0:t,n=n===void 0?0:n,this.i&&this.C){for(var i=null,s=x(this.i.variants),l=s.next();!l.done;l=s.next())if(l=l.value,l.audio.label==e){i=l;break}i!=null&&(this.za=new ts(i.language,"",0,"",!1,"",e,"",this.g.mediaSource.codecSwitchingStrategy,this.g.manifest.dash.enableAudioGroups),Es(this,t,n))}else if(this.h&&this.h.audioTracks){for(n=Array.from(this.h.audioTracks),t=null,n=x(n),i=n.next();!i.done;i=n.next())i=i.value,i.label==e&&(t=i);t&&m1(this,t)}},a.qf=function(){var e=this.oa;return this.G&&this.l==Pn?this.G.F.isTextVisible():this.h&&this.h.src&&this.h.textTracks?Ya(this).some(function(t){return t.mode=="showing"}):e},a.wg=function(){return this.h&&this.h.src&&this.h.textTracks?c1(this).map(function(e){return Yg(e)}):[]},a.Kh=function(e){if(!this.h||!this.h.src||!this.h.textTracks)return[];var t=It(e),n=c1(this).filter(function(c){return It(c.language)==t});if(!n||!n.length)return[];e=[];var i=new Set;n=x(n);for(var s=n.next();!s.done;s=n.next())if((s=s.value)&&s.cues){s=x(s.cues);for(var l=s.next();!l.done;l=s.next()){var u=l.value;(l=u.id)&&l!=""||(l=u.startTime+"-"+u.endTime+"-"+u.text),u={id:l,title:u.text,startTime:u.startTime,endTime:u.endTime},i.has(l)||(e.push(u),i.add(l))}}return e};function Ya(e){return Array.from(e.h.textTracks).filter(function(t){return t.kind!="metadata"&&t.kind!="chapters"&&t.label!="Shaka Player TextTrack"})}function dA(e){return Array.from(e.h.textTracks).filter(function(t){return t.kind=="metadata"})}function c1(e){return Array.from(e.h.textTracks).filter(function(t){return t.kind=="chapters"})}a.eh=function(e){if(e=!!e,this.oa!=e){if(this.oa=e,this.l==Pn)this.G.F.setTextVisibility(e),this.g.streaming.alwaysStreamText||(e?this.j.s||(e=Ia(this.i.textStreams,this.Db,this.pd,this.od),0<e.length&&(Hu(this.j,e[0]),af(this))):pE(this.j));else if(this.h&&this.h.src&&this.h.textTracks){var t=Ya(this);t=x(t);for(var n=t.next();!n.done;n=t.next())n=n.value,n.mode!="disabled"&&(n.mode=e?"showing":"hidden")}v1(this)}},a.Wh=function(){if(this.C)var e=this.C.yd();else{if(this.pa==null)return new Date;e=this.pa}if(this.i){var t=this.i.presentationTimeline;return new Date(1e3*((t.m||t.i)+e))}return this.h&&this.h.getStartDate?(t=this.h.getStartDate(),isNaN(t.getTime())?null:new Date(t.getTime()+1e3*e)):null},a.Bg=function(){if(this.i){var e=this.i.presentationTimeline;return new Date(1e3*(e.m||e.i))}return this.h&&this.h.getStartDate?(e=this.h.getStartDate(),isNaN(e.getTime())?null:e):null},a.Od=function(){return this.V()&&this.i?this.i.presentationTimeline.Od():null},a.wb=function(){if(this.l==Pn)return this.G.wb();var e={total:[],audio:[],video:[],text:[]};return this.l==zn&&(e.total=Ko(this.h.buffered)),e},a.getStats=function(){if(this.l!=Pn&&this.l!=zn)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,manifestSizeBytes:NaN,bytesDownloaded:NaN,nonFatalErrorCount:NaN,manifestPeriodCount:NaN,manifestGapCount:NaN,switchHistory:[],stateHistory:[]};of(this);var e=this.h,t=e.currentTime/e.duration;if(!isNaN(t)&&!this.V()){var n=this.s;t=Math.round(100*t),n.i=isNaN(n.i)?t:Math.max(n.i,t)}if(this.C&&(this.s.U=this.C.fg(),this.s.Z=this.C.gg()),e.getVideoPlaybackQuality){n=e.getVideoPlaybackQuality(),t=this.s;var i=Number(n.totalVideoFrames);t.R=Number(n.droppedVideoFrames),t.N=i,this.s.L=Number(n.corruptedVideoFrames)}if(this.B?(n=this.B,n=n.I?n.I:NaN):n=NaN,this.s.s=n,this.l==Pn){if(n=this.j.j,t=this.j.s,n){i=this.I?this.I.i:1;var s=i*n.bandwidth;t&&t.bandwidth&&(s+=i*t.bandwidth),this.s.B=s}n&&n.video&&(t=this.s,i=n.video.height||NaN,t.o=n.video.width||NaN,t.l=i),this.V()&&(n=this.Bg().valueOf()+1e3*e.currentTime,this.s.C=(Date.now()-n)/1e3),this.i&&(this.s.G=this.i.periodCount,this.s.F=this.i.gapCount,this.i.presentationTimeline&&(this.s.I=this.i.presentationTimeline.g)),n=this.o.getBandwidthEstimate(),this.s.A=n}this.l==zn&&(n=this.s,t=e.videoHeight||NaN,n.o=e.videoWidth||NaN,n.l=t);var l=this.s;e=l.o,n=l.l,t=l.B,i=l.N,s=l.R;var u=l.L,c=l.Z,d=l.U,g=l.A,y=l.i,w=l.m,C=l.H,T=l.j,A=ud(l.g,"playing"),b=ud(l.g,"paused"),k=ud(l.g,"buffering"),O=l.s,D=l.C,z=l.I,P=l.Hg,B=l.Cd,G=l.K,q=l.G,J=l.F,fe=tE(l.g),te=[];l=x(l.h.g);for(var ne=l.next();!ne.done;ne=l.next())ne=ne.value,te.push({timestamp:ne.timestamp,id:ne.id,type:ne.type,fromAdaptation:ne.fromAdaptation,bandwidth:ne.bandwidth});return{width:e,height:n,streamBandwidth:t,decodedFrames:i,droppedFrames:s,corruptedFrames:u,stallsDetected:c,gapsJumped:d,estimatedBandwidth:g,completionPercent:y,loadLatency:w,manifestTimeSeconds:C,drmTimeSeconds:T,playTime:A,pauseTime:b,bufferingTime:k,licenseTime:O,liveLatency:D,maxSegmentDuration:z,manifestSizeBytes:P,bytesDownloaded:B,nonFatalErrorCount:G,manifestPeriodCount:q,manifestGapCount:J,stateHistory:fe,switchHistory:te}},a.uh=function(e,t,n,i,s,l,u){u=u===void 0?!1:u;var c=this,d,g,y,w,C,T,A,b,k,O,D,z;return $(function(P){switch(P.g){case 1:if(c.l!=Pn&&c.l!=zn)throw new K(1,7,7004);if(n!="subtitles"&&n!="captions"&&Fe("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),i){P.u(2);break}return E(P,Od(c,e),3);case 3:i=P.h;case 2:if(d=[],c.A&&(d=c.A.getCuePoints()),c.l!=zn){P.u(4);break}return u&&(n="forced"),E(P,h1(c,e,t,n,i,l||"",d),5);case 5:if(g=It(t),y=c.Ec(),w=y.find(function(B){return It(B.language)==g&&B.label==(l||"")&&B.kind==n}))return ki(c),P.return(w);throw new K(1,2,2012);case 4:if(C=sn,T=c.h.duration,c.i&&(T=c.i.presentationTimeline.getDuration()),T==1/0)throw new K(1,4,4033);if(!d.length){P.u(6);break}return E(P,Ud(c,e,c.H,c.g.streaming.retryParameters),7);case 7:A=P.h,b=d1(c,A,i,d),k=new Blob([b],{type:"text/vtt"}),e=Uu(k),i="text/vtt";case 6:if(O={id:c.cg++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:ld(0,T,[e]),mimeType:i||"",codecs:s||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:l||null,type:C.ua,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!u,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([an(i||"",s||"")])},D=an(O.mimeType,O.codecs),z=Ea(D),!z)throw new K(2,2,2014,i);return c.i.textStreams.push(O),ki(c),P.return(gu(O))}})},a.vh=function(e,t){var n=this,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D;return $(function(z){switch(z.g){case 1:if(n.l!=Pn&&n.l!=zn)throw new K(1,7,7004);if(t){z.u(2);break}return E(z,Od(n,e),3);case 3:t=z.h;case 2:if(t!="text/vtt")throw new K(1,2,2017,e);if(i=sn,s=n.h.duration,n.i&&(s=n.i.presentationTimeline.getDuration()),s==1/0)throw new K(1,4,4045);return E(z,Ud(n,e,n.H,n.g.streaming.retryParameters),4);case 4:if(l=z.h,u=ln[t],!u)throw new K(2,2,2014,t);for(c=u(),d={periodStart:0,segmentStart:0,segmentEnd:s,vttOffset:0},g=Ze(l),y=c.parseMedia(g,d,e),w=[],C=x(y),T=C.next(),A={};!T.done;A={ye:void 0,zc:void 0},T=C.next())A.zc=T.value,A.ye=null,b=function(P){return function(){return P.ye==null&&(P.ye=Cn([e],[P.zc.payload])),P.ye||[]}}(A),k=new Je(A.zc.startTime,A.zc.endTime,b,0,null,null,0,0,1/0),A.zc.payload.includes("#xywh")&&(O=A.zc.payload.split("#xywh=")[1].split(","),O.length===4&&k.fh({height:parseInt(O[3],10),positionX:parseInt(O[0],10),positionY:parseInt(O[1],10),width:parseInt(O[2],10)})),w.push(k);return D={id:n.cg++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new xt(w),mimeType:t||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:i.De,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([an(t||"","")])},n.l==zn?n.qd.push(D):n.i.imageStreams.push(D),ki(n),z.return(_h(D))}})},a.th=function(e,t,n){var i=this,s,l,u,c;return $(function(d){switch(d.g){case 1:if(i.l!=Pn&&i.l!=zn)throw new K(1,7,7004);if(n){d.u(2);break}return E(d,Od(i,e),3);case 3:n=d.h;case 2:return s=[],i.A&&(s=i.A.getCuePoints()),E(d,h1(i,e,t,"chapters",n,"",s),4);case 4:if(l=d.h,u=i.wg(),c=u.find(function(g){return g.language==t}),!c){d.u(5);break}return E(d,new Promise(function(g,y){i.m.ha(l,"load",g),i.m.ha(l,"error",function(){y(new K(1,2,2015))})}),6);case 6:return ki(i),d.return(c);case 5:throw new K(1,2,2012)}})};function Od(e,t){var n;return $(function(i){switch(i.g){case 1:return ue(i,2),E(i,kd(t,e.H,e.g.streaming.retryParameters),4);case 4:n=i.h,ge(i,3);break;case 2:ie(i);case 3:if(n)return i.return(n);throw new K(1,2,2011,t)}})}function h1(e,t,n,i,s,l,u){var c,d,g,y;return $(function(w){if(w.g==1)return s!="text/vtt"||u.length?E(w,Ud(e,t,e.H,e.g.streaming.retryParameters),3):w.u(2);w.g!=2&&(c=w.h,d=d1(e,c,s,u),g=new Blob([d],{type:"text/vtt"}),t=Uu(g),s="text/vtt"),y=document.createElement("track");var C=e.N,T=t;try{if(C.g.enabled){var A=Md(C);A.ot=_d,A.su=!0;var b=Zu(A),k=Rd(T,b)}else k=T}catch(O){Ke("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",O),k=T}return y.src=k,y.label=l,y.kind=i,y.srclang=n,e.h.getAttribute("crossorigin")||e.h.setAttribute("crossorigin","anonymous"),e.h.appendChild(y),w.return(y)})}function Ud(e,t,n,i){var s,l,u;return $(function(c){if(c.g==1){s=Ki,l=dn([t],i),l.method="GET";var d=e.N;try{d.g.enabled&&Ts(d,l,{ot:_d,su:!0})}catch(g){Ke("CMCD_TEXT_ERROR","Could not generate text CMCD data.",g)}return E(c,n.request(s,l).promise,2)}return u=c.h,c.return(u.data)})}function d1(e,t,n,i){var s=ln[n];if(s)return n=s(),e={periodStart:0,segmentStart:0,segmentEnd:e.h.duration,vttOffset:0},t=Ze(t),t=n.parseMedia(t,e,null),zE(t,i);throw new K(2,2,2014,n)}a.Yi=function(e,t){this.fa.width=e,this.fa.height=t},a.If=function(e){if(this.l==Pn){var t=this.j;if(e=e===void 0?.1:e,t.m.g)t=!1;else if(t.A)t=!1;else{for(var n=x(t.i.values()),i=n.next();!i.done;i=n.next())i=i.value,!i.fd||i.Qa||i.sb||(i.fd=!1,Ci(t,i,e));t=!0}}else t=!1;return t},a.gf=function(){return Fe("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},a.Rh=function(){return this.ab};function _o(e){var t=vs();return t.streaming.failureCallback=function(n){if(e.V()){var i=null;n.code==1001||n.code==1002?(i=1,e.g.streaming.lowLatencyMode&&(i=.1)):n.code==1003&&(i=.1),i!=null&&(n.severity=1,e.If(i))}},t.textDisplayFactory=function(){if(e.de){var n=e.getConfiguration();return new ti(e.h,e.de,n.textDisplayer)}return HTMLMediaElement.prototype.addTextTrack?new Jn(e.h,"Shaka Player TextTrack"):new ei},t}a.ih=function(e){this.de=e};function pA(e,t){for(var n=new Set,i=x(t.textStreams),s=i.next();!s.done;s=i.next())s=s.value,s.mimeType!="application/cea-608"&&s.mimeType!="application/cea-708"||n.add(s.originalId);for(i=x(t.variants),s=i.next();!s.done;s=i.next())if((s=s.value.video)&&s.closedCaptions){for(var l=x(s.closedCaptions.keys()),u=l.next();!u.done;u=l.next())if(u=u.value,!n.has(u)){var c=u.startsWith("CC")?"application/cea-608":"application/cea-708",d=new Jt,g=s.closedCaptions.get(u);c={id:e.cg++,originalId:u,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:d,mimeType:c,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:g,originalLanguage:g,label:null,type:mt,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:s.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set([an(c,"")])},t.textStreams.push(c),n.add(u)}}}function gA(e,t){var n,i,s,l,u;return $(function(c){return c.g==1?(n=e.audio,i=e.video,s=function(d,g){var y,w,C;return $(function(T){return T.g==1?d?E(T,d.createSegmentIndex(),2):T.return(null):(w=(y=d.segmentIndex.Ib(g))?y.next().value:null,w?(C=w.startTime,T.return(C)):T.return(null))})},E(c,s(n,t),2)):c.g!=3?(l=c.h,E(c,s(i,t),3)):(u=c.h,u!=null&&l!=null?c.return(Math.max(u,l)):u!=null?c.return(u):l!=null?c.return(l):c.return(t))})}function Bd(e){var t=e.pf();if(e.s&&e.L&&e.C){var n=e.I;if(n.j=t,Sy(n),e.N&&(n=e.N,t||n.i||(n.i=!0),n.i&&t&&(n.j=!0),n.l=t),of(e),n=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts,e.g.streaming.liveSync.dynamicTargetLatency.enabled&&t&&e.ze<n){n=e.g.streaming.liveSync.dynamicTargetLatency.maxLatency;var i=e.g.streaming.liveSync.targetLatencyTolerance,s=e.g.streaming.liveSync.dynamicTargetLatency.rebufferIncrement;e.R&&(e.R=Math.min(e.R+ ++e.ze*s,n-i))}}t=new Map().set("buffering",t),e.dispatchEvent(Ht("buffering",t))}function p1(e){var t=e.h.playbackRate;t!=0&&(e.I&&e.I.set(t),t=Ht("ratechange"),e.dispatchEvent(t))}function of(e){if(e.s&&e.L){var t=e.s.g,n="playing";e.L.g==ns?n="buffering":e.h.ended?n="ended":e.h.paused&&(n="paused");var i=n;if(t.g==null)t.g={timestamp:Date.now()/1e3,state:i,duration:0},t=!0;else{var s=Date.now()/1e3;t.g.duration=s-t.g.timestamp,t.g.state==i?t=!1:(t.h.push(t.g),t.g={timestamp:s,state:i,duration:0},t=!0)}t&&(n=new Map().set("newstate",n),e.dispatchEvent(Ht("statechanged",n)))}}function g1(e){var t=e.h.playbackRate,n=e.V();if(e.g.streaming.vodDynamicPlaybackRate&&!n){var i=e.g.streaming.vodDynamicPlaybackRateLowBufferRate,s=e.vg();s<=e.g.streaming.vodDynamicPlaybackRateBufferRatio?t!=i&&e.wd(i):s==1&&t!==e.I.hc()&&e.Tc()}if(n&&(n=e.Ob(),Number.isFinite(n.end)&&!(e.h.currentTime<n.start))){i=e.g.streaming.liveSync.targetLatencyTolerance,s=e.g.streaming.liveSync.dynamicTargetLatency.enabled;var l=e.g.streaming.liveSync.dynamicTargetLatency.stabilityThreshold;if(e.g.streaming.liveSync&&e.g.streaming.liveSync.enabled)var u=e.g.streaming.liveSync.targetLatency,c=u+i,d=Math.max(0,u-i),g=e.g.streaming.liveSync.maxPlaybackRate,y=e.g.streaming.liveSync.minPlaybackRate;else e.i&&e.i.serviceDescription&&(u=e.i.serviceDescription.targetLatency,e.i.serviceDescription.targetLatency!=null?c=e.i.serviceDescription.targetLatency+i:e.i.serviceDescription.maxLatency!=null&&(c=e.i.serviceDescription.maxLatency),e.i.serviceDescription.targetLatency!=null?d=Math.max(0,e.i.serviceDescription.targetLatency-i):e.i.serviceDescription.minLatency!=null&&(d=e.i.serviceDescription.minLatency),g=e.i.serviceDescription.maxPlaybackRate||e.g.streaming.liveSync.maxPlaybackRate,y=e.i.serviceDescription.minPlaybackRate||e.g.streaming.liveSync.minPlaybackRate);e.R||typeof u!="number"||(e.R=u);var w=e.g.streaming.liveSync.dynamicTargetLatency.maxAttempts;s&&e.Da&&e.R!==null&&typeof u=="number"&&e.ze<w&&Date.now()-e.Da>1e3*l&&(l=e.g.streaming.liveSync.dynamicTargetLatency.minLatency,e.R=Math.max(e.R-(u-l)/2,l+i),e.Da=Date.now()),s&&e.R!==null&&(c=e.R+i,d=e.R-i),u=n.end-e.h.currentTime,i=0,e.l==zn&&(s=e.h.buffered,0<s.length&&(i=s.end(s.length-1),i=Math.max(g,i-n.end))),n=e.g.streaming.liveSync.panicMode,s=1e3*e.g.streaming.liveSync.panicThreshold,l=Date.now()-e.L.h,n&&!y&&(y=e.g.streaming.liveSync.minPlaybackRate),n&&y&&l<=s?t!=y&&e.wd(y):c&&g&&u-i>c?(t!=g&&e.wd(g),e.Da=null):d&&y&&u-i<d?(t!=y&&e.wd(y),e.Da=null):t!==e.I.hc()&&(e.Tc(),e.Da=Date.now())}}function rf(e){if(e.h){var t=!1,n=e.h.currentTime/e.h.duration;if(isNaN(n)||(n=Math.round(100*n),isNaN(e.U)?(e.U=n,t=!0):(n=Math.max(e.U,n),e.U!=n&&(e.U=n,t=!0))),t){var i;e.U==0?i=Ht("started"):e.U==25?i=Ht("firstquartile"):e.U==50?i=Ht("midpoint"):e.U==75?i=Ht("thirdquartile"):e.U==100&&(i=Ht("complete")),i&&e.dispatchEvent(i)}}}function Lr(e){try{Fm(e.be,e.i)}catch(n){return As(e,n),!1}var t=mu(e.i.variants);return t=e.za.create(t),e.o.setVariants(Array.from(t.values())),!0}function Es(e,t,n,i,s){t=t===void 0?!0:t,n=n===void 0?0:n,i=i===void 0?!1:i,s=s===void 0?!0:s;var l;(l=Lr(e)?e.o.chooseVariant():null)&&sf(e,l,s,t,n,i)}function sf(e,t,n,i,s,l){l=l===void 0?!1:l;var u=e.j.j;if(t==u)i&&_y(e.j,t,i,s,!0);else{var c=e.s.h;c.h!=t&&(c.h=t,c.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),_y(e.j,t,i,s,l,n),i=null,u&&(i=es(u)),t=es(t),n?(n=new Map().set("oldTrack",i).set("newTrack",t),e.K&&ty(e.K,t,e.hf()),n=Ht("adaptation",n),ks(e,n)):y1(e,i,t)}}function m1(e,t){var n=Array.from(e.h.audioTracks).find(function(i){return i.enabled});t.enabled=!0,n&&(t.id!==n.id&&(n.enabled=!1),n=Ph(n),t=Ph(t),y1(e,n,t))}function mA(e,t,n){if(e.g.autoShowText==0)return!1;if(e.g.autoShowText==1)return!0;var i=It(e.g.preferredTextLanguage);return n=It(n.language),e.g.autoShowText==2?Qr(n,i):e.g.autoShowText==3?t?(e=It(t.language),Qr(n,i)&&!Qr(e,n)):!1:(Fe("Invalid autoShowText setting!"),!1)}function ki(e){var t=Ht("trackschanged");ks(e,t)}function y1(e,t,n){t=new Map().set("oldTrack",t).set("newTrack",n),e.K&&ty(e.K,n,e.hf()),n=Ht("variantchanged",t),ks(e,n)}function af(e){var t=Ht("textchanged");ks(e,t)}function v1(e){var t=Ht("texttrackvisibility");ks(e,t)}function x1(e){e.g.abr.enabled||jd(e);var t=new Map().set("newStatus",e.g.abr.enabled);ks(e,Ht("abrstatuschanged",t))}function jd(e,t){if(t=t===void 0?!0:t,e.l==Pn){e.je.stop();for(var n=x(e.i.variants),i=n.next();!i.done;i=n.next())i.value.disabledUntilTime=0;t&&Lr(e)}}a.disableStream=function(e,t){if(!this.g.abr.enabled||this.l===Qi||!navigator.onLine||t==0)return!1;if(this.i.variants.some(function(l){var u=l[e.type];return u&&u.id!==e.id&&!l.disabledUntilTime?e.type=="audio"?e.language===u.language:!0:!1})){for(var n=x(this.i.variants),i=n.next();!i.done;i=n.next()){i=i.value;var s=i[e.type];s&&s.id===e.id&&(i.disabledUntilTime=Date.now()/1e3+t)}return this.je.Sa(1),t=this.wb().video.reduce(function(l,u){return l+u.end-u.start},0),Es(this,!1,t,!0,!1),!0}return!1};function As(e,t){var n,i,s;return $(function(l){switch(l.g){case 1:if(e.l==Qi)return l.return();if(t.severity===1&&e.s.K++,n=!0,!(e.Ea&&e.i&&e.j)||t.code!=3016&&t.code!=3014&&t.code!=3015&&t.code!=3018){l.u(2);break}return ue(l,3),E(l,kE(e.j),5);case 5:i=l.h,n=!i,ge(l,2);break;case 3:ie(l),n=!0;case 2:if(!n)return l.return();t.severity===2&&jd(e,!1),s=Ht("error",new Map().set("detail",t)),e.dispatchEvent(s),s.defaultPrevented&&(t.handled=!0),F(l)}})}function Ka(e,t,n,i){i=i===void 0?e:i,e=new Map().set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement,eventNode:n.eventNode}),i.dispatchEvent(Ht(t,e))}function w1(e,t,n,i){i=i===void 0?!1:i,t=new Map().set("mediaQuality",{bandwidth:t.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate,height:t.height,mimeType:t.mimeType,channelsCount:t.channelsCount,pixelAspectRatio:t.pixelAspectRatio,width:t.width,label:t.label,roles:t.roles,language:t.language}).set("position",n),e.dispatchEvent(Ht(i?"audiotrackchanged":"mediaqualitychanged",t))}function Fd(e,t){if(t=t===void 0?!0:t,!e.h.error)return t?new K(2,3,3016):null;var n=e.h.error.code;return!t&&n==1?null:((t=e.h.error.msExtendedCode)&&(0>t&&(t+=Math.pow(2,32)),t=t.toString(16)),new K(2,3,3016,n,t,e.h.error.message))}function $d(e,t,n){0<t&&(e.V()||e.hh(t)),t=e.getDuration(),n<t&&(e.V()||e.Za(n))}function ks(e,t){$(function(n){if(n.g==1)return E(n,Promise.resolve(),2);e.l!=Qi&&e.dispatchEvent(t),F(n)})}function S1(e){var t=new Set;e=x(e);for(var n=e.next();!n.done;n=e.next())n=n.value,n.language?t.add(It(n.language)):t.add("und");return t}function T1(e){var t=new Map,n=new Map;e=x(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;var s="und",l=[];i.language&&(s=It(i.language)),i.type=="variant"?l=i.audioRoles:l=i.roles,l&&l.length||(l=[""]),t.has(s)||t.set(s,new Set),l=x(l);for(var u=l.next();!u.done;u=l.next())u=u.value,t.get(s).add(u),i.label&&(n.has(s)||n.set(s,new Map),n.get(s).set(u,i.label))}var c=[];return t.forEach(function(d,g){d=x(d);for(var y=d.next();!y.done;y=d.next()){y=y.value;var w=null;n.has(g)&&n.get(g).has(y)&&(w=n.get(g).get(y)),c.push({language:g,role:y,label:w})}}),c}he("shaka.Player",ve),ve.prototype.setVideoContainer=ve.prototype.ih,ve.prototype.getManifestParserFactory=ve.prototype.Rh,ve.prototype.getManifest=ve.prototype.gf,ve.prototype.retryStreaming=ve.prototype.If,ve.prototype.setMaxHardwareResolution=ve.prototype.Yi,ve.prototype.addChaptersTrack=ve.prototype.th,ve.prototype.addThumbnailsTrack=ve.prototype.vh,ve.prototype.addTextTrackAsync=ve.prototype.uh,ve.prototype.getStats=ve.prototype.getStats,ve.prototype.getBufferedInfo=ve.prototype.wb,ve.prototype.getSegmentAvailabilityDuration=ve.prototype.Od,ve.prototype.getPresentationStartTimeAsDate=ve.prototype.Bg,ve.prototype.getPlayheadTimeAsDate=ve.prototype.Wh,ve.prototype.setTextTrackVisibility=ve.prototype.eh,ve.prototype.getChapters=ve.prototype.Kh,ve.prototype.getChaptersTracks=ve.prototype.wg,ve.prototype.isTextTrackVisible=ve.prototype.qf,ve.prototype.selectVariantsByLabel=ve.prototype.Ti,ve.prototype.selectTextLanguage=ve.prototype.Lf,ve.prototype.selectAudioLanguage=ve.prototype.Xg,ve.prototype.getTextLanguages=ve.prototype.$h,ve.prototype.getAudioLanguages=ve.prototype.Hh,ve.prototype.getTextLanguagesAndRoles=ve.prototype.ai,ve.prototype.getAudioLanguagesAndRoles=ve.prototype.Ih,ve.prototype.selectVariantTrack=ve.prototype.Mf,ve.prototype.selectTextTrack=ve.prototype.Yg,ve.prototype.getThumbnails=ve.prototype.Cg,ve.prototype.getAllThumbnails=ve.prototype.Gh,ve.prototype.getImageTracks=ve.prototype.Oh,ve.prototype.getTextTracks=ve.prototype.Ec,ve.prototype.getVariantTracks=ve.prototype.ic,ve.prototype.cancelTrickPlay=ve.prototype.Tc,ve.prototype.trickPlay=ve.prototype.wd,ve.prototype.getPlaybackRate=ve.prototype.eb,ve.prototype.isBuffering=ve.prototype.pf,ve.prototype.getKeyStatuses=ve.prototype.Ld,ve.prototype.getActiveSessionsMetadata=ve.prototype.ff,ve.prototype.getExpiration=ve.prototype.ad,ve.prototype.drmInfo=ve.prototype.drmInfo,ve.prototype.keySystem=ve.prototype.keySystem,ve.prototype.isFullyLoaded=ve.prototype.li,ve.prototype.goToLive=ve.prototype.hi,ve.prototype.seekRange=ve.prototype.Ob,ve.prototype.isAudioOnly=ve.prototype.ki,ve.prototype.isInProgress=ve.prototype.kc,ve.prototype.isLive=ve.prototype.V,ve.prototype.getAdManager=ve.prototype.ug,ve.prototype.getAssetUri=ve.prototype.Dc,ve.prototype.getNetworkingEngine=ve.prototype.xb,ve.prototype.getMediaElement=ve.prototype.Uh,ve.prototype.getManifestType=ve.prototype.hf,ve.prototype.getLoadMode=ve.prototype.yg,ve.prototype.resetConfiguration=ve.prototype.Ni,ve.prototype.getBufferFullness=ve.prototype.vg,ve.prototype.getNonDefaultConfiguration=ve.prototype.Ag,ve.prototype.getConfiguration=ve.prototype.getConfiguration,ve.prototype.configure=ve.prototype.configure,ve.prototype.releaseAllMutexes=ve.prototype.Ji,ve.prototype.destroyAllPreloads=ve.prototype.Qe,ve.prototype.preload=ve.prototype.preload,ve.prototype.detachAndSavePreload=ve.prototype.qg,ve.prototype.unloadAndSavePreload=ve.prototype.aj,ve.prototype.load=ve.prototype.load,ve.prototype.updateStartTime=ve.prototype.ej,ve.prototype.unload=ve.prototype.bc,ve.prototype.detach=ve.prototype.detach,ve.prototype.attachCanvas=ve.prototype.zh,ve.prototype.attach=ve.prototype.Rb,ve.probeSupport=function(e){e=e===void 0?!0:e;var t,n,i,s,l,u,c;return $(function(d){switch(d.g){case 1:if(t={},!e){d.u(2);break}return E(d,yC(),3);case 3:t=d.h;case 2:var g={};if(Wi())for(var y in Fi)g[y]=!0;y=x(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var w=y.next();!w.done;w=y.next())w=w.value,g[w]=Wi()?!!Fi[w]:Sa(w);for(n=g,y='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4.02.01.01",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(L(Xo)),g={},y=x(y),w=y.next();!w.done;w=y.next()){w=w.value,g[w]=Ea(w)?!0:Wi()?Lt(w)||!!zo(w):Sa(w);var C=w.split(";")[0];g[C]=g[C]||g[w]}return i=g,E(d,Rg(),4);case 4:s=d.h,l={manifest:n,media:i,drm:t,hardwareResolution:s},u=Hd;for(c in u)l[c]=u[c]();return d.return(l)}})},ve.isBrowserSupported=function(){if(p.Promise||Fe("A Promise implementation or polyfill is required"),!(p.Promise&&p.Uint8Array&&Array.prototype.forEach)||Rt("Trident/"))return!1;var e=Wr();return e&&9>e||!(p.MediaKeys&&p.navigator&&p.navigator.requestMediaKeySystemAccess&&p.MediaKeySystemAccess&&p.MediaKeySystemAccess.prototype.getConfiguration)?!1:Wi()?!0:Sa("application/x-mpegurl")},ve.setAdManagerFactory=function(e){lf=e},ve.registerSupportPlugin=function(e,t){Hd[e]=t},ve.prototype.destroy=ve.prototype.destroy;var Qi=0,Vd=1,Pn=2,zn=3;ve.LoadMode={DESTROYED:Qi,NOT_LOADED:Vd,MEDIA_SOURCE:Pn,SRC_EQUALS:zn},ve.version="v4.10.12";var C1=["4","10"];Tn=new function(e){this.g=e,this.i=Bn,this.h=mo}(new vn(Number(C1[0]),Number(C1[1])));var Hd={},lf=null;function E1(){this.g=[],this.i=this.l=this.j=this.h=0}function yA(e){return e.g.length?e.g.reduce(function(t,n){return t+n},0)/e.g.length:0}function nt(e,t,n){var i=this;this.g=e,this.h=t,this.j=n,this.i=!1,this.l=this.h.getVolume(),this.m=new lt,this.m.D(this.h,google.ima.AdEvent.Type.PAUSED,function(){i.i=!0}),this.m.D(this.h,google.ima.AdEvent.Type.RESUMED,function(){i.i=!1})}a=nt.prototype,a.needsSkipUI=function(){return!1},a.getDuration=function(){return this.g.getDuration()},a.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},a.getRemainingTime=function(){return this.h.getRemainingTime()},a.isPaused=function(){return this.i},a.isSkippable=function(){return 0<=this.g.getSkipTimeOffset()},a.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},a.canSkipNow=function(){return this.h.getAdSkippableState()},a.skip=function(){return this.h.skip()},a.pause=function(){return this.h.pause()},a.play=function(){return this.h.resume()},a.getVolume=function(){return this.h.getVolume()},a.setVolume=function(e){return this.j.volume=e,this.h.setVolume(e)},a.isMuted=function(){return this.h.getVolume()==0},a.isLinear=function(){return this.g.isLinear()},a.resize=function(e,t){var n=!1,i=this.j;document.fullscreenEnabled?n=!!document.fullscreenElement:i.webkitSupportsFullscreen&&(n=i.webkitDisplayingFullscreen),this.h.resize(e,t,n?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},a.setMuted=function(e){(this.j.muted=e)?(this.l=this.getVolume(),this.h.setVolume(0)):this.h.setVolume(this.l)},a.getSequenceLength=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getTotalAds()},a.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getAdPosition()},a.getTitle=function(){return this.g.getTitle()},a.getDescription=function(){return this.g.getDescription()},a.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},a.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},a.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},a.getAdId=function(){return this.g.getAdId()},a.getCreativeAdId=function(){return this.g.getCreativeAdId()},a.getAdvertiserName=function(){return this.g.getAdvertiserName()},a.getMediaUrl=function(){return this.g.getMediaUrl()},a.getTimeOffset=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getTimeOffset()},a.getPodIndex=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getPodIndex()},a.release=function(){this.h=this.g=null},he("shaka.ads.ClientSideAd",nt),nt.prototype.release=nt.prototype.release,nt.prototype.getPodIndex=nt.prototype.getPodIndex,nt.prototype.getTimeOffset=nt.prototype.getTimeOffset,nt.prototype.getMediaUrl=nt.prototype.getMediaUrl,nt.prototype.getAdvertiserName=nt.prototype.getAdvertiserName,nt.prototype.getCreativeAdId=nt.prototype.getCreativeAdId,nt.prototype.getAdId=nt.prototype.getAdId,nt.prototype.getVastMediaWidth=nt.prototype.getVastMediaWidth,nt.prototype.getVastMediaHeight=nt.prototype.getVastMediaHeight,nt.prototype.getVastMediaBitrate=nt.prototype.getVastMediaBitrate,nt.prototype.getDescription=nt.prototype.getDescription,nt.prototype.getTitle=nt.prototype.getTitle,nt.prototype.getPositionInSequence=nt.prototype.getPositionInSequence,nt.prototype.getSequenceLength=nt.prototype.getSequenceLength,nt.prototype.setMuted=nt.prototype.setMuted,nt.prototype.resize=nt.prototype.resize,nt.prototype.isLinear=nt.prototype.isLinear,nt.prototype.isMuted=nt.prototype.isMuted,nt.prototype.setVolume=nt.prototype.setVolume,nt.prototype.getVolume=nt.prototype.getVolume,nt.prototype.play=nt.prototype.play,nt.prototype.pause=nt.prototype.pause,nt.prototype.skip=nt.prototype.skip,nt.prototype.canSkipNow=nt.prototype.canSkipNow,nt.prototype.getTimeUntilSkippable=nt.prototype.getTimeUntilSkippable,nt.prototype.isSkippable=nt.prototype.isSkippable,nt.prototype.isPaused=nt.prototype.isPaused,nt.prototype.getRemainingTime=nt.prototype.getRemainingTime,nt.prototype.getMinSuggestedDuration=nt.prototype.getMinSuggestedDuration,nt.prototype.getDuration=nt.prototype.getDuration,nt.prototype.needsSkipUI=nt.prototype.needsSkipUI;function Ft(){}he("shaka.ads.Utils",Ft),Ft.ADS_LOADED="ads-loaded",Ft.AD_STARTED="ad-started",Ft.AD_FIRST_QUARTILE="ad-first-quartile",Ft.AD_MIDPOINT="ad-midpoint",Ft.AD_THIRD_QUARTILE="ad-third-quartile",Ft.AD_COMPLETE="ad-complete",Ft.AD_STOPPED="ad-stopped",Ft.AD_SKIPPED="ad-skipped",Ft.AD_VOLUME_CHANGED="ad-volume-changed",Ft.AD_MUTED="ad-muted",Ft.AD_PAUSED="ad-paused",Ft.AD_RESUMED="ad-resumed",Ft.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",Ft.CUEPOINTS_CHANGED="ad-cue-points-changed",Ft.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",Ft.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",Ft.AD_CLICKED="ad-clicked",Ft.AD_PROGRESS="ad-progress",Ft.AD_BUFFERING="ad-buffering",Ft.AD_IMPRESSION="ad-impression",Ft.AD_DURATION_CHANGED="ad-duration-changed",Ft.AD_CLOSED="ad-closed",Ft.AD_LOADED="ad-loaded",Ft.ALL_ADS_COMPLETED="all-ads-completed",Ft.AD_LINEAR_CHANGED="ad-linear-changed",Ft.AD_METADATA="ad-metadata",Ft.AD_RECOVERABLE_ERROR="ad-recoverable-error",Ft.AD_ERROR="ad-error",Ft.AD_BREAK_READY="ad-break-ready",Ft.AD_INTERACTION="ad-interaction",Ft.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",Ft.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",Ft.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested";function uf(e,t,n,i,s){var l=this;this.s=e,this.i=t,this.F=!1,this.A=this.o=null,this.G=NaN,this.l=s,this.j=null,this.h=new lt,google.ima.settings.setLocale(n),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.C=new google.ima.AdDisplayContainer(this.s,this.i),this.C.initialize(),this.m=new google.ima.AdsLoader(this.C),this.m.getSettings().setPlayerType("shaka-player"),this.m.getSettings().setPlayerVersion("v4.10.12"),this.g=null,this.B=i||new google.ima.AdsRenderingSettings,this.h.D(this.m,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(u){vA(l,u)}),this.h.D(this.m,google.ima.AdErrorEvent.Type.AD_ERROR,function(u){A1(l,u)}),this.h.D(this.i,"ended",function(){l.m.contentComplete()}),this.h.ha(this.i,"play",function(){l.F=!0})}uf.prototype.configure=function(e){this.o=e},uf.prototype.stop=function(){this.g&&this.g.stop(),this.s&&ws(this.s)},uf.prototype.release=function(){this.stop(),this.A&&this.A.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.m.destroy(),this.C.destroy()};function A1(e,t){t.getError(),t=new Map().set("originalEvent",t),e.l(new Ue("ad-error",t)),cf(e,null),e.l(new Ue("ad-cue-points-changed",new Map().set("cuepoints",[])))}function vA(e,t){if(e.l(new Ue("ads-loaded",new Map().set("loadTime",Date.now()/1e3-e.G))),e.o.customPlayheadTracker){var n={currentTime:e.i.currentTime};e.g=t.getAdsManager(n,e.B),e.i.muted?e.g.setVolume(0):e.g.setVolume(e.i.volume),e.h.D(e.i,"timeupdate",function(){e.i.duration&&(n.currentTime=e.i.currentTime)}),e.h.D(e.i,"volumechange",function(){e.j&&(e.j.setVolume(e.i.volume),e.i.muted&&e.j.setMuted(!0))})}else e.g=t.getAdsManager(e.i,e.B);e.l(new Ue("ima-ad-manager-loaded",new Map().set("imaAdManager",e.g)));var i=e.g.getCuePoints();if(i.length){t=[],i=x(i);for(var s=i.next();!s.done;s=i.next())t.push({start:s.value,end:null});e.l(new Ue("ad-cue-points-changed",new Map().set("cuepoints",t)))}xA(e);try{e.g.init(e.i.offsetWidth,e.i.offsetHeight,ff(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),e.h.D(e.i,"loadeddata",function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight,ff(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),"ResizeObserver"in p?(e.A=new ResizeObserver(function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight,ff(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),e.A.observe(e.i)):e.h.D(document,"fullscreenchange",function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight,ff(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),e.F||e.o.skipPlayDetection?e.g.start():e.h.ha(e.i,"play",function(){e.F=!0,e.g.start()})}catch{cf(e,null)}}function ff(e){return document.fullscreenEnabled?!!document.fullscreenElement:(e=e.i,e.webkitSupportsFullscreen?e.webkitDisplayingFullscreen:!1)}function xA(e){function t(n,i){n=new Map().set("originalEvent",n),e.l(new Ue(i,n))}e.h.D(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,function(n){A1(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(n){k1(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.STARTED,function(n){k1(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,function(n){t(n,"ad-first-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.MIDPOINT,function(n){t(n,"ad-midpoint")}),e.h.D(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,function(n){t(n,"ad-third-quartile")}),e.h.D(e.g,google.ima.AdEvent.Type.COMPLETE,function(n){t(n,"ad-complete")}),e.h.D(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(n){cf(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(n){cf(e,n)}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPED,function(n){t(n,"ad-skipped")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,function(n){t(n,"ad-volume-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,function(n){t(n,"ad-muted")}),e.h.D(e.g,google.ima.AdEvent.Type.PAUSED,function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))}),e.h.D(e.g,google.ima.AdEvent.Type.RESUMED,function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))}),e.h.D(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,function(n){e.j&&t(n,"ad-skip-state-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.CLICK,function(n){t(n,"ad-clicked")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_PROGRESS,function(n){t(n,"ad-progress")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BUFFERING,function(n){t(n,"ad-buffering")}),e.h.D(e.g,google.ima.AdEvent.Type.IMPRESSION,function(n){t(n,"ad-impression")}),e.h.D(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,function(n){t(n,"ad-duration-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.USER_CLOSE,function(n){t(n,"ad-closed")}),e.h.D(e.g,google.ima.AdEvent.Type.LOADED,function(n){t(n,"ad-loaded")}),e.h.D(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(n){t(n,"all-ads-completed")}),e.h.D(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,function(n){t(n,"ad-linear-changed")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_METADATA,function(n){t(n,"ad-metadata")}),e.h.D(e.g,google.ima.AdEvent.Type.LOG,function(n){t(n,"ad-recoverable-error")}),e.h.D(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,function(n){t(n,"ad-break-ready")}),e.h.D(e.g,google.ima.AdEvent.Type.INTERACTION,function(n){t(n,"ad-interaction")})}function k1(e,t){var n=t.getAd();n?(e.j=new nt(n,e.g,e.i),t.type!=google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED||e.o.supportsMultipleMediaElements||e.l(new Ue("ad-content-pause-requested")),t=new Map().set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.l(new Ue("ad-started",t)),e.j.isLinear()&&(e.s.setAttribute("ad-active","true"),e.o.customPlayheadTracker||e.i.pause(),e.i.muted?(t=e.j,t.l=e.i.volume,t.h.setVolume(0)):e.j.setVolume(e.i.volume))):Fe("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function cf(e,t){t&&t.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED&&!e.o.supportsMultipleMediaElements&&e.l(new Ue("ad-content-resume-requested")),e.l(new Ue("ad-stopped",new Map().set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.s.removeAttribute("ad-active"),e.o.customPlayheadTracker||e.i.ended||e.i.play())}function it(e,t,n,i,s){this.g=e,this.h=t,this.j=n,this.l=i,this.i=s}a=it.prototype,a.needsSkipUI=function(){return!0},a.getDuration=function(){var e=this.g.duration;return isNaN(e)?-1:e},a.getMinSuggestedDuration=function(){return this.getDuration()},a.getRemainingTime=function(){var e=this.g.duration;return isNaN(e)?-1:e-this.g.currentTime},a.isPaused=function(){return this.g.paused},a.isSkippable=function(){return this.h},a.getTimeUntilSkippable=function(){return this.h?0:Math.max(this.getRemainingTime(),0)},a.canSkipNow=function(){return this.getTimeUntilSkippable()==0},a.skip=function(){this.j()},a.pause=function(){return this.g.pause()},a.play=function(){return this.g.play()},a.getVolume=function(){return this.g.volume},a.setVolume=function(e){this.g.volume=e},a.isMuted=function(){return this.g.muted},a.isLinear=function(){return!0},a.resize=function(){},a.setMuted=function(e){this.g.muted=e},a.getSequenceLength=function(){return this.l},a.getPositionInSequence=function(){return this.i},a.getTitle=function(){return""},a.getDescription=function(){return""},a.getVastMediaBitrate=function(){return 0},a.getVastMediaHeight=function(){return 0},a.getVastMediaWidth=function(){return 0},a.getAdId=function(){return""},a.getCreativeAdId=function(){return""},a.getAdvertiserName=function(){return""},a.getMediaUrl=function(){return null},a.getTimeOffset=function(){return 0},a.getPodIndex=function(){return 0},a.release=function(){this.g=null},he("shaka.ads.InterstitialAd",it),it.prototype.release=it.prototype.release,it.prototype.getPodIndex=it.prototype.getPodIndex,it.prototype.getTimeOffset=it.prototype.getTimeOffset,it.prototype.getMediaUrl=it.prototype.getMediaUrl,it.prototype.getAdvertiserName=it.prototype.getAdvertiserName,it.prototype.getCreativeAdId=it.prototype.getCreativeAdId,it.prototype.getAdId=it.prototype.getAdId,it.prototype.getVastMediaWidth=it.prototype.getVastMediaWidth,it.prototype.getVastMediaHeight=it.prototype.getVastMediaHeight,it.prototype.getVastMediaBitrate=it.prototype.getVastMediaBitrate,it.prototype.getDescription=it.prototype.getDescription,it.prototype.getTitle=it.prototype.getTitle,it.prototype.getPositionInSequence=it.prototype.getPositionInSequence,it.prototype.getSequenceLength=it.prototype.getSequenceLength,it.prototype.setMuted=it.prototype.setMuted,it.prototype.resize=it.prototype.resize,it.prototype.isLinear=it.prototype.isLinear,it.prototype.isMuted=it.prototype.isMuted,it.prototype.setVolume=it.prototype.setVolume,it.prototype.getVolume=it.prototype.getVolume,it.prototype.play=it.prototype.play,it.prototype.pause=it.prototype.pause,it.prototype.skip=it.prototype.skip,it.prototype.canSkipNow=it.prototype.canSkipNow,it.prototype.getTimeUntilSkippable=it.prototype.getTimeUntilSkippable,it.prototype.isSkippable=it.prototype.isSkippable,it.prototype.isPaused=it.prototype.isPaused,it.prototype.getRemainingTime=it.prototype.getRemainingTime,it.prototype.getMinSuggestedDuration=it.prototype.getMinSuggestedDuration,it.prototype.getDuration=it.prototype.getDuration,it.prototype.needsSkipUI=it.prototype.needsSkipUI;function hf(e,t,n,i){var s=this;this.F=e,this.B=t,this.i=n,this.C=null,this.m=!0,this.s=this.i,this.g=i,this.G=new Set,this.A=new Set,this.o=new Map,this.h=new ve,Gd(this),this.I=new lt,this.j=new lt,this.H=!1,this.l=null,this.I.D(this.i,"timeupdate",function(){if(!s.H){var l=s.l==null||s.l==0;s.l=s.i.currentTime,(l=b1(s,l))&&I1(s,l,1,1,Date.now())}}),new ct(function(){var l,u,c,d,g,y,w,C,T,A;return $(function(b){switch(b.g){case 1:if(!s.A.size||s.H||s.l==null){b.u(0);break}l=!1,u=Array.from(s.A),c=s.B.Ob(),d=x(u),g=d.next();case 3:if(g.done){b.u(5);break}if(y=g.value,w=y.endTime||y.startTime,!(1<=c.start-w)){C=y.startTime-s.l,0<C&&10>=C&&(s.o.has(y)||s.o.set(y,s.h.preload(y.uri))),b.u(4);break}if(!s.o.has(y)){b.u(7);break}return E(b,s.o.get(y),8);case 8:(T=b.h)&&T.destroy(),s.o.delete(y);case 7:A=JSON.stringify(y),s.G.has(A)&&s.G.delete(A),s.A.delete(y),l=!0;case 4:g=d.next(),b.u(3);break;case 5:l&&zd(s),F(b)}})}).Sa(1)}hf.prototype.configure=function(e){this.F&&this.m==e.supportsMultipleMediaElements&&((this.m=!e.supportsMultipleMediaElements)?(this.s=this.i,this.C&&(this.C.parentElement&&this.F.removeChild(this.C),this.C=null)):(this.C||(e=document.createElement(this.i.tagName),e.autoplay=!0,e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgb(0, 0, 0)",e.setAttribute("playsinline",""),this.C=e),this.s=this.C))},hf.prototype.stop=function(){this.j&&this.j.Ra(),this.G.clear(),this.A.clear(),this.h.Qe(),this.o.clear(),this.h.detach(),this.H=!1,this.l=null},hf.prototype.release=function(){this.stop(),this.I&&this.I.release(),this.j&&this.j.release(),this.F&&ws(this.F),this.h.destroy()};function wA(e,t){var n,i,s,l,u,c,d,g;$(function(y){if(y.g==1)return e.B.yg()==zn&&e.m?(Fe("Unsupported interstitial when using single media element",t),y.return()):(Gd(e),n=!1,E(y,SA(e,t),2));if(i=y.h,i.length)for(s=x(i),l=s.next();!l.done;l=s.next())u=l.value,c=JSON.stringify(u),e.G.has(c)||(n=!0,e.G.add(c),e.A.add(u),d=!1,t.Ab&&e.l==null?d=!0:u.startTime!=0||u.Ie?e.l!=null&&(g=t.startTime-e.l,0<g&&10>=g&&(d=!0)):d=!0,d&&(e.o.has(u)||e.o.set(u,e.h.preload(u.uri))));else Fe("Unsupported interstitial",t);n&&zd(e),F(y)})}function b1(e,t,n){n=n===void 0?0:n;var i=0,s=null;if(e.A.size&&e.l!=null){var l=e.i.ended,u=Array.from(e.A).sort(function(g,y){return y.startTime-g.startTime});u=x(u);for(var c=u.next();!c.done;c=u.next()){c=c.value;var d=!1;if(t?d=c.Ab:l?d=c.nc:c.Ab||c.nc||(d=e.l-Math.round(1e3*c.startTime)/1e3,d=0<d&&(1>=d||!c.Ie)),d){if(i==n){s=c;break}i++}}}return s}function I1(e,t,n,i,s,l){l=l===void 0?0:l;var u,c,d,g,y,w,C,T,A,b,k,O,D,z;$(function(P){switch(P.g){case 1:if(u=Date.now(),!e.s.parentElement&&e.F&&e.F.appendChild(e.s),i==1&&n==1&&(n=Array.from(e.A).filter(function(B){return t.Ab?B.Ab==t.Ab:t.nc?B.nc==t.nc:.001>Math.abs(B.startTime-t.startTime)}).length),(t.once||t.Ab)&&(l++,e.A.delete(t),zd(e)),e.H=!0,!e.m||i!=1){P.u(2);break}return e.g(new Ue("ad-content-pause-requested",new Map().set("saveLivePosition",!0))),c=new _t,d=function(B){return $(function(G){if(G.g==1)return B.state!="detach"?G.u(0):Ig()?E(G,new Promise(function(q){return new ct(q).Y(.1)}),3):G.u(3);c.resolve(),e.j.jb(e.B,"onstatechange",d),F(G)})},e.j.D(e.B,"onstatechange",d),E(P,c,2);case 2:return e.m||(e.i.pause(),t.Oc!=null&&t.Oc!=0&&(e.i.currentTime+=t.Oc)),g=!1,y=null,w=function(){if(!e.m&&t.Oc==null)if(t.se&&t.endTime&&t.endTime!=1/0)e.i.currentTime!=t.endTime&&(e.i.currentTime=t.endTime);else{var B=Date.now();e.i.currentTime+=(B-s)/1e3,s=B}},C=function(){var B,G;return $(function(q){if(q.g==1)return w(),y&&y.stop(),(B=b1(e,t.Ab,i-l))?(e.g(new Ue("ad-stopped")),e.j.Ra(),I1(e,B,n,++i,s,l),q.u(0)):e.m?E(q,e.h.detach(),4):E(q,e.h.bc(),4);e.m&&(G=t.Oc,G==null&&(G=t.se&&t.endTime&&t.endTime!=1/0?t.endTime-(e.l||0):(Date.now()-s)/1e3),e.g(new Ue("ad-content-resume-requested",new Map().set("offset",G)))),e.g(new Ue("ad-stopped")),e.j.Ra(),e.H=!1,e.m||(w(),e.i.ended||e.i.play()),F(q)})},T=function(B){return $(function(G){return g?G.return():(g=!0,e.g(new Ue("ad-error",new Map().set("originalEvent",B))),E(G,C(),0))})},A=function(){return $(function(B){if(B.g==1)return g?B.return():(g=!0,E(B,C(),2));e.g(new Ue("ad-complete")),F(B)})},b=function(){return $(function(B){return g?B.return():(g=!0,e.g(new Ue("ad-skipped")),E(B,C(),0))})},k=new it(e.s,t.isSkippable,b,n,i),e.m||(k.setMuted(e.i.muted),k.setVolume(e.i.volume)),e.g(new Ue("ad-started",new Map().set("ad",k))),k.canSkipNow()&&e.g(new Ue("ad-skip-state-changed")),e.j.ha(e.h,"error",T),e.j.ha(e.h,"firstquartile",function(){w(),e.g(new Ue("ad-first-quartile"))}),e.j.ha(e.h,"midpoint",function(){w(),e.g(new Ue("ad-midpoint"))}),e.j.ha(e.h,"thirdquartile",function(){w(),e.g(new Ue("ad-third-quartile"))}),e.j.ha(e.h,"complete",A),e.j.D(e.s,"play",function(){e.g(new Ue("ad-resumed"))}),e.j.D(e.s,"pause",function(){e.g(new Ue("ad-paused"))}),e.j.D(e.s,"volumechange",function(){e.s.muted?e.g(new Ue("ad-muted")):e.g(new Ue("ad-volume-changed"))}),ue(P,4),t.Ef&&(y=new ct(function(){k.skip()}).Y(t.Ef)),Gd(e),E(P,e.h.Rb(e.s),6);case 6:return e.o.has(t)?E(P,e.o.get(t),10):E(P,e.h.load(t.uri),8);case 10:return O=P.h,e.o.delete(t),O?E(P,e.h.load(O),8):E(P,e.h.load(t.uri),8);case 8:D=(Date.now()-u)/1e3,e.g(new Ue("ads-loaded",new Map().set("loadTime",D))),e.m&&e.i.play(),ge(P,0);break;case 4:z=ie(P),T(z),F(P)}})}function SA(e,t){var n,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne,oe,xe,pe,we,Me;return $(function(Te){switch(Te.g){case 1:if(n=[],!t||(i=t.values.find(function(Ne){return Ne.key=="X-ASSET-URI"}),s=t.values.find(function(Ne){return Ne.key=="X-ASSET-LIST"}),!i&&!s))return Te.return(n);if(l=t.values.find(function(Ne){return Ne.key=="X-RESTRICT"}),c=u=!0,l&&l.data&&(d=l.data,u=!d.includes("SKIP"),c=!d.includes("JUMP")),g=null,(y=t.values.find(function(Ne){return Ne.key=="X-RESUME-OFFSET"}))&&(w=y.data,g=parseFloat(w),isNaN(g)&&(g=null)),C=null,(T=t.values.find(function(Ne){return Ne.key=="X-PLAYOUT-LIMIT"}))&&(A=T.data,C=parseFloat(A),isNaN(C)&&(C=null)),O=k=b=!1,(D=t.values.find(function(Ne){return Ne.key=="CUE"}))&&(z=D.data,b=z.includes("ONCE"),k=z.includes("PRE"),O=z.includes("POST")),P=!1,(B=t.values.find(function(Ne){return Ne.key=="X-TIMELINE-OCCUPIES"}))?(G=B.data,P=G.includes("RANGE")):!y&&e.B.V()&&(P=!k&&!O),i){if(q=i.data,!q)return Te.return(n);n.push({startTime:t.startTime,endTime:t.endTime,uri:q,isSkippable:u,Ie:c,Oc:g,Ef:C,once:b,Ab:k,nc:O,se:P}),Te.u(2);break}if(!s){Te.u(2);break}return J=s.data,J?(fe=dn([J],Yi()),te=e.B.xb().request(7,fe),ue(Te,4),E(Te,te.promise,6)):Te.return(n);case 6:for(ne=Te.h,oe=Vt(ne.data),xe=JSON.parse(oe),pe=x(xe.ASSETS),we=pe.next();!we.done;we=pe.next())Me=we.value,Me.URI&&n.push({startTime:t.startTime,endTime:t.endTime,uri:Me.URI,isSkippable:u,Ie:c,Oc:g,Ef:C,once:b,Ab:k,nc:O,se:P});ge(Te,2);break;case 4:ie(Te);case 2:return Te.return(n)}})}function zd(e){for(var t=[],n=x(e.A),i=n.next(),s={};!i.done;s={Qb:void 0},i=n.next())i=i.value,s.Qb={start:i.startTime,end:null},i.Ab?(s.Qb.start=0,s.Qb.end=null):i.nc?(s.Qb.start=-1,s.Qb.end=null):i.se&&(s.Qb.end=i.endTime),t.find(function(l){return function(u){return l.Qb.start==u.start&&l.Qb.end==u.end}}(s))||t.push(s.Qb);e.g(new Ue("ad-cue-points-changed",new Map().set("cuepoints",t)))}function Gd(e){e.h.configure(e.B.Ag());var t=e.h.xb();t.mg(),t.ng(),cm(e.B.xb(),t)}function Qo(e){this.h=e||"",this.g=0}function bs(e){Lo(e,/[ \t]+/gm)}function Lo(e,t){return t.lastIndex=e.g,t=t.exec(e.h),t=t==null?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||t==null||t.position!=e.g?null:(e.g+=t.length,t.results)}function Pr(e){return e.g==e.h.length?null:(e=Lo(e,/[^ \t\n]*/gm))?e[0]:null}function tt(e,t,n,i,s){if(this.h=e,e=this.h.skipOffset)if(e=Lo(new Qo(e),TA),e==null)e=null;else{var l=Number(e[2]),u=Number(e[3]);e=59<l||59<u?null:(Number(e[4])||0)/1e3+u+60*l+3600*(Number(e[1])||0)}else e=null;this.j=e,this.g=s,this.i=t,this.l=n,this.o=i,this.m=!1}a=tt.prototype,a.needsSkipUI=function(){return!0},a.getDuration=function(){return this.h.durationInSeconds},a.getMinSuggestedDuration=function(){return this.getDuration()},a.getRemainingTime=function(){return this.h.startTimeInSeconds+this.h.durationInSeconds-this.g.currentTime},a.isPaused=function(){return this.g.paused},a.isSkippable=function(){return typeof this.j=="number"},a.getTimeUntilSkippable=function(){if(typeof this.j!="number")return this.getRemainingTime();var e=this.getRemainingTime()+this.j-this.getDuration();return Math.max(e,0)},a.canSkipNow=function(){return this.getTimeUntilSkippable()==0},a.skip=function(){this.m=!0,this.g.currentTime+=this.getRemainingTime()},a.pause=function(){return this.g.pause()},a.play=function(){return this.g.play()},a.getVolume=function(){return this.g.volume},a.setVolume=function(e){this.g.volume=e},a.isMuted=function(){return this.g.muted},a.isLinear=function(){return this.o},a.resize=function(){},a.setMuted=function(e){this.g.muted=e},a.getSequenceLength=function(){return this.l?this.l:1},a.getPositionInSequence=function(){return this.i?this.i:1},a.getTitle=function(){return this.h.adTitle},a.getDescription=function(){return""},a.getVastMediaBitrate=function(){return 0},a.getVastMediaHeight=function(){return 0},a.getVastMediaWidth=function(){return 0},a.getAdId=function(){return this.h.adId},a.getCreativeAdId=function(){return this.h.creativeId},a.getAdvertiserName=function(){return""},a.getMediaUrl=function(){return null},a.getTimeOffset=function(){return 0},a.getPodIndex=function(){return 0},a.release=function(){this.l=this.i=this.g=this.h=null},he("shaka.ads.MediaTailorAd",tt),tt.prototype.release=tt.prototype.release,tt.prototype.getPodIndex=tt.prototype.getPodIndex,tt.prototype.getTimeOffset=tt.prototype.getTimeOffset,tt.prototype.getMediaUrl=tt.prototype.getMediaUrl,tt.prototype.getAdvertiserName=tt.prototype.getAdvertiserName,tt.prototype.getCreativeAdId=tt.prototype.getCreativeAdId,tt.prototype.getAdId=tt.prototype.getAdId,tt.prototype.getVastMediaWidth=tt.prototype.getVastMediaWidth,tt.prototype.getVastMediaHeight=tt.prototype.getVastMediaHeight,tt.prototype.getVastMediaBitrate=tt.prototype.getVastMediaBitrate,tt.prototype.getDescription=tt.prototype.getDescription,tt.prototype.getTitle=tt.prototype.getTitle,tt.prototype.getPositionInSequence=tt.prototype.getPositionInSequence,tt.prototype.getSequenceLength=tt.prototype.getSequenceLength,tt.prototype.setMuted=tt.prototype.setMuted,tt.prototype.resize=tt.prototype.resize,tt.prototype.isLinear=tt.prototype.isLinear,tt.prototype.isMuted=tt.prototype.isMuted,tt.prototype.setVolume=tt.prototype.setVolume,tt.prototype.getVolume=tt.prototype.getVolume,tt.prototype.play=tt.prototype.play,tt.prototype.pause=tt.prototype.pause,tt.prototype.skip=tt.prototype.skip,tt.prototype.canSkipNow=tt.prototype.canSkipNow,tt.prototype.getTimeUntilSkippable=tt.prototype.getTimeUntilSkippable,tt.prototype.isSkippable=tt.prototype.isSkippable,tt.prototype.isPaused=tt.prototype.isPaused,tt.prototype.getRemainingTime=tt.prototype.getRemainingTime,tt.prototype.getMinSuggestedDuration=tt.prototype.getMinSuggestedDuration,tt.prototype.getDuration=tt.prototype.getDuration,tt.prototype.needsSkipUI=tt.prototype.needsSkipUI;var TA=/(?:(\d{1,}):)?(\d{2}):(\d{2})((\.(\d{1,3})))?/g;function Za(e,t,n,i){this.B=e,this.K=t,this.h=n,this.l=null,this.U=NaN,this.i=i,this.I=!1,this.A=null,this.j=[],this.N=[],this.L=this.C=this.g=null,this.F=new Map,this.m=[],this.s=[],this.G="",this.R=!0,this.H="",this.o=new lt}Za.prototype.stop=function(){for(var e=x(this.m),t=e.next();!t.done;t=e.next())t=t.value,this.o.jb(t.target,t.type,t.listener);Is(this),this.m=[],this.s=[],this.G="",this.R=!0,this.H="",this.A=null,this.j=[],this.N=[],this.F.clear()},Za.prototype.release=function(){this.stop(),this.o&&this.o.release()},Za.prototype.onManifestUpdated=function(e){this.I=e,this.G!=""&&(EA(this,this.G,this.R),this.R=!1)},Za.prototype.getCuePoints=function(){for(var e=[],t=x(this.j),n=t.next();!n.done;n=t.next()){n=x(n.value.ads);for(var i=n.next();!i.done;i=n.next())i=i.value,e.push({start:i.startTimeInSeconds,end:i.startTimeInSeconds+i.durationInSeconds})}return e};function CA(e,t,n){var i,s,l,u,c,d,g,y,w,C,T;$(function(A){if(A.g==1)return i=dn([t],Yi()),i.method="POST",n&&(s=JSON.stringify(n),i.body=qi(s)),l=e.K.request(7,i),ue(A,2),E(A,l.promise,4);if(A.g!=2){if(u=A.h,c=Vt(u.data),d=JSON.parse(c),d.manifestUrl&&d.trackingUrl)g=new tn(t),y=new tn(d.trackingUrl),e.G=g.resolve(y).toString(),w=Date.now()/1e3,C=w-e.U,e.i(new Ue("ads-loaded",new Map().set("loadTime",C))),T=new tn(d.manifestUrl),e.l.resolve(g.resolve(T).toString()),e.l=null;else throw Error("Insufficient data from MediaTailor.");return ge(A,0)}if(ie(A),!e.H.length)return e.l.reject("MediaTailor request returned an error and there was no backup asset uri provided."),e.l=null,A.return();e.l.resolve(e.H),e.l=null,F(A)})}function EA(e,t,n){var i,s,l,u,c,d,g,y,w,C,T,A,b,k,O;$(function(D){if(D.g==1)return i=dn([t],Yi()),s=e.K.request(7,i),ue(D,2),E(D,s.promise,4);if(D.g!=2){if(l=D.h,u=[],c=Vt(l.data),d=JSON.parse(c),0<d.avails.length){if(JSON.stringify(e.j)!=JSON.stringify(d.avails)){for(e.j=d.avails,g=x(e.j),y=g.next();!y.done;y=g.next())for(w=y.value,C=x(w.nonLinearAdsList),T=C.next();!T.done;T=C.next())for(A=T.value,b=x(A.nonLinearAdList),k=b.next();!k.done;k=b.next())O=k.value,AA(e,O);u=e.getCuePoints(),e.i(new Ue("ad-cue-points-changed",new Map().set("cuepoints",u)))}}else e.j.length&&e.i(new Ue("ad-cue-points-changed",new Map().set("cuepoints",u))),Is(e),e.j=[];return n&&(e.I||0<u.length)&&kA(e),ge(D,0)}ie(D),F(D)})}function AA(e,t){var n,i,s,l,u,c,d;$(function(g){if(g.g==1)return!t.staticResource||(n=M1(t),e.F.get(n))?g.return():(i=dn([t.staticResource],Yi()),s=e.K.request(7,i),ue(g,2),e.F.set(n,[]),E(g,s.promise,4));if(g.g!=2)return l=g.h,u=Vt(l.data),c=JSON.parse(u),d=c.apps,e.F.set(n,d),ge(g,0);ie(g),e.F.delete(n),F(g)})}function M1(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")}function kA(e){_1(e),e.I||(R1(e),e.o.D(e.h,"seeked",function(){R1(e)}),e.o.D(e.h,"ended",function(){Is(e)})),e.o.D(e.h,"timeupdate",function(){_1(e)})}function R1(e){var t=e.h.currentTime;if(t!=0&&e.A==null){for(var n,i,s=x(e.j),l=s.next();!l.done;l=s.next()){l=l.value;for(var u=x(l.ads),c=u.next();!c.done;c=u.next())if(c=c.value,!i)c.startTimeInSeconds<t&&(i=c,n=l);else if(c.startTimeInSeconds<t&&c.startTimeInSeconds>i.startTimeInSeconds+i.durationInSeconds){i=c,n=l;break}}n&&i&&!e.N.includes(i.adId)&&(e.A=t,e.h.currentTime=n.startTimeInSeconds)}}function _1(e){if(e.h.duration&&(e.g||e.j.length)){var t=e.h.currentTime,n=!1;if(e.g){n=!0;var i=e.C,s=i.startTimeInSeconds+.5*i.durationInSeconds,l=i.startTimeInSeconds+.75*i.durationInSeconds;t>=i.startTimeInSeconds+.25*i.durationInSeconds&&!e.s.includes("firstQuartile")?(e.s.push("firstQuartile"),Dn(e,"firstQuartile")):t>=s&&!e.s.includes("midpoint")?(e.s.push("midpoint"),Dn(e,"midpoint")):t>=l&&!e.s.includes("thirdQuartile")&&(e.s.push("thirdQuartile"),Dn(e,"thirdQuartile")),i=e.g.getRemainingTime(),s=e.g.getDuration(),e.g.canSkipNow()&&0<i&&0<s&&Dn(e,"skipStateChanged"),0<s&&(0>=i||i>s)&&Is(e)}if(!e.g||!e.g.isLinear()){e:for(i=x(e.j),s=i.next();!s.done&&(s=s.value,!(e.g&&e.g.isLinear()));s=i.next())for(l=0;l<s.ads.length;l++){var u=s.ads[l],c=u.startTimeInSeconds+u.durationInSeconds;if(u.startTimeInSeconds<=t&&c>t){if(e.N.includes(u.adId)){if(e.h.ended)continue;e.h.currentTime=c;break e}Is(e),e.L=s,e.g=new tt(u,l+1,s.ads.length,!0,e.h),e.C=u,l===0&&Dn(e,"breakStart"),L1(e);break}}if(!e.g){for(i=x(e.j),s=i.next();!s.done&&(s=s.value,!e.g);s=i.next())for(l=0;l<s.nonLinearAdsList.length;l++)if(u=s.nonLinearAdsList[l],u.nonLinearAdList.length){c=s.startTimeInSeconds;var d=e.F.get(M1(u.nonLinearAdList[0]));if(c<=t&&d&&d.length){Is(e),c=e,d=x(d);for(var g=d.next();!g.done;g=d.next())if(g=g.value,g.data.source.length){var y=document.createElement("img");y.src=g.data.source[0].url,y.style.top=(g.placeholder.top||0)+"%",y.style.height=100-(g.placeholder.top||0)+"%",y.style.left=(g.placeholder.left||0)+"%",y.style.maxWidth=100-(g.placeholder.left||0)+"%",y.style.objectFit="contain",y.style.position="absolute",c.B.appendChild(y)}e.L=s,e.g=new tt(u,l+1,s.ads.length,!1,e.h),e.C=u,l===0&&Dn(e,"breakStart"),L1(e);break}}}n&&!e.g&&(t=e.h.currentTime,e.A&&e.A>t&&(e.h.currentTime=e.A),e.A=null)}}}function Is(e){if(e.g){for(;e.B.lastChild;)e.B.removeChild(e.B.firstChild);e.I||e.N.push(e.C.adId);var t=e.g.m;t!==void 0&&t?Dn(e,"skip"):Dn(e,"complete"),t=x(e.m);for(var n=t.next();!n.done;n=t.next())n=n.value,e.o.jb(n.target,n.type,n.listener);e.m=[],e.s=[],t=e.g.getPositionInSequence(),n=e.g.getSequenceLength(),t===n&&Dn(e,"breakEnd"),e.g=null,e.C=null,e.L=null}}function L1(e){var t=!1;e.h.paused?t=!0:(Dn(e,"impression"),Dn(e,"start")),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted&&Dn(e,"mute")}}),e.m.push({target:e.h,type:"volumechange",listener:function(){e.h.muted||Dn(e,"unmute")}}),e.m.push({target:e.h,type:"play",listener:function(){t?(Dn(e,"impression"),Dn(e,"start"),t=!1):Dn(e,"resume")}}),e.m.push({target:e.h,type:"pause",listener:function(){Dn(e,"pause")}});for(var n=x(e.m),i=n.next();!i.done;i=n.next())i=i.value,e.o.D(i.target,i.type,i.listener)}function Dn(e,t){var n=e.C.trackingEvents.find(function(s){return s.eventType==t});if(n||(n=e.L.adBreakTrackingEvents.find(function(s){return s.eventType==t})),n){n=x(n.beaconUrls);for(var i=n.next();!i.done;i=n.next())(i=i.value)&&i!=""&&(i=dn([i],Yi()),i.method="POST",e.K.request(7,i))}switch(t){case"impression":e.i(new Ue("ad-impression"));break;case"start":e.i(new Ue("ad-started",new Map().set("ad",e.g)));break;case"mute":e.i(new Ue("ad-muted"));break;case"unmute":e.i(new Ue("ad-volume-changed"));break;case"resume":e.i(new Ue("ad-resumed"));break;case"pause":e.i(new Ue("ad-paused"));break;case"firstQuartile":e.i(new Ue("ad-first-quartile"));break;case"midpoint":e.i(new Ue("ad-midpoint"));break;case"thirdQuartile":e.i(new Ue("ad-third-quartile"));break;case"complete":e.i(new Ue("ad-complete")),e.i(new Ue("ad-stopped"));break;case"skip":e.i(new Ue("ad-skipped")),e.i(new Ue("ad-stopped"));break;case"breakStart":e.B.setAttribute("ad-active","true");break;case"breakEnd":e.B.removeAttribute("ad-active");break;case"skipStateChanged":e.i(new Ue("ad-skip-state-changed"))}}function ot(e,t){this.g=e,this.i=null,this.h=t}a=ot.prototype,a.needsSkipUI=function(){return!0},a.getDuration=function(){return this.i?this.i.duration:-1},a.getMinSuggestedDuration=function(){return this.getDuration()},a.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},a.isPaused=function(){return this.h.paused},a.isSkippable=function(){return this.g.isSkippable()},a.getTimeUntilSkippable=function(){var e=this.g.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},a.canSkipNow=function(){return this.getTimeUntilSkippable()==0},a.skip=function(){this.h.currentTime+=this.getRemainingTime()},a.pause=function(){return this.h.pause()},a.play=function(){return this.h.play()},a.getVolume=function(){return this.h.volume},a.setVolume=function(e){this.h.volume=e},a.isMuted=function(){return this.h.muted},a.isLinear=function(){return!0},a.resize=function(){},a.setMuted=function(e){this.h.muted=e},a.getSequenceLength=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getTotalAds()},a.getPositionInSequence=function(){var e=this.g.getAdPodInfo();return e==null?1:e.getAdPosition()},a.getTitle=function(){return this.g.getTitle()},a.getDescription=function(){return this.g.getDescription()},a.getVastMediaBitrate=function(){return 0},a.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},a.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},a.getAdId=function(){return this.g.getAdId()},a.getCreativeAdId=function(){return this.g.getCreativeAdId()},a.getAdvertiserName=function(){return this.g.getAdvertiserName()},a.getMediaUrl=function(){return null},a.getTimeOffset=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getTimeOffset()},a.getPodIndex=function(){var e=this.g.getAdPodInfo();return e==null?0:e.getPodIndex()},a.release=function(){this.h=this.i=this.g=null},he("shaka.ads.ServerSideAd",ot),ot.prototype.release=ot.prototype.release,ot.prototype.getPodIndex=ot.prototype.getPodIndex,ot.prototype.getTimeOffset=ot.prototype.getTimeOffset,ot.prototype.getMediaUrl=ot.prototype.getMediaUrl,ot.prototype.getAdvertiserName=ot.prototype.getAdvertiserName,ot.prototype.getCreativeAdId=ot.prototype.getCreativeAdId,ot.prototype.getAdId=ot.prototype.getAdId,ot.prototype.getVastMediaWidth=ot.prototype.getVastMediaWidth,ot.prototype.getVastMediaHeight=ot.prototype.getVastMediaHeight,ot.prototype.getVastMediaBitrate=ot.prototype.getVastMediaBitrate,ot.prototype.getDescription=ot.prototype.getDescription,ot.prototype.getTitle=ot.prototype.getTitle,ot.prototype.getPositionInSequence=ot.prototype.getPositionInSequence,ot.prototype.getSequenceLength=ot.prototype.getSequenceLength,ot.prototype.setMuted=ot.prototype.setMuted,ot.prototype.resize=ot.prototype.resize,ot.prototype.isLinear=ot.prototype.isLinear,ot.prototype.isMuted=ot.prototype.isMuted,ot.prototype.setVolume=ot.prototype.setVolume,ot.prototype.getVolume=ot.prototype.getVolume,ot.prototype.play=ot.prototype.play,ot.prototype.pause=ot.prototype.pause,ot.prototype.skip=ot.prototype.skip,ot.prototype.canSkipNow=ot.prototype.canSkipNow,ot.prototype.getTimeUntilSkippable=ot.prototype.getTimeUntilSkippable,ot.prototype.isSkippable=ot.prototype.isSkippable,ot.prototype.isPaused=ot.prototype.isPaused,ot.prototype.getRemainingTime=ot.prototype.getRemainingTime,ot.prototype.getMinSuggestedDuration=ot.prototype.getMinSuggestedDuration,ot.prototype.getDuration=ot.prototype.getDuration,ot.prototype.needsSkipUI=ot.prototype.needsSkipUI;function P1(e,t,n,i){var s=this;this.s=e,this.l=t,this.j=null,this.F=NaN,this.i=i,this.G=!1,this.A=this.m=this.o=null,this.B="",this.C=[],this.h=new lt,e=new google.ima.dai.api.UiSettings,e.setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.s,e),this.i(new Ue("ima-stream-manager-loaded",new Map().set("imaStreamManager",this.g))),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,function(l){bA(s,l)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,function(){s.B.length?s.j.resolve(s.B):s.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),s.j=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,function(){}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,function(l){l=l.getAd(),s.m=new ot(l,s.l),s.A&&(s.m.i=s.A),s.i(new Ue("ad-started",new Map().set("ad",s.m))),s.s.setAttribute("ad-active","true")}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,function(){s.s.removeAttribute("ad-active");var l=s.l.currentTime;s.o&&s.o>l&&(s.l.currentTime=s.o,s.o=null)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,function(l){s.A=l.getStreamData().adProgressData,s.m&&(s.m.i=s.A)}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,function(){s.i(new Ue("ad-first-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,function(){s.i(new Ue("ad-midpoint"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,function(){s.i(new Ue("ad-third-quartile"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,function(){s.i(new Ue("ad-complete")),s.i(new Ue("ad-stopped")),s.s.removeAttribute("ad-active"),s.m=null}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,function(){s.i(new Ue("ad-skipped")),s.i(new Ue("ad-stopped"))}),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,function(l){var u=l.getStreamData();l=[],u=x(u.cuepoints);for(var c=u.next();!c.done;c=u.next())c=c.value,l.push({start:c.start,end:c.end});s.C=l,s.i(new Ue("ad-cue-points-changed",new Map().set("cuepoints",l)))})}a=P1.prototype,a.configure=function(){},a.stop=function(){this.B="",this.o=null,this.C=[]},a.release=function(){this.stop(),this.h&&this.h.release()},a.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},a.getCuePoints=function(){return this.C};function bA(e,t){e.i(new Ue("ads-loaded",new Map().set("loadTime",Date.now()/1e3-e.F))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.G||e.h.D(e.l,"seeked",function(){var n=e.l.currentTime;if(n!=0){e.g.streamTimeForContentTime(n);var i=e.g.previousCuePointForStreamTime(n);i&&!i.played&&(e.o=n,e.l.currentTime=i.start)}})}function Ge(){Et.call(this),this.g=this.h=this.i=this.j=null,this.m=new E1,this.o=navigator.language,this.l=null}le(Ge,Et),a=Ge.prototype,a.setLocale=function(e){this.o=e},a.configure=function(e){this.l=e,this.j&&this.j.configure(this.l),this.i&&this.i.configure(this.l),this.g&&this.g.configure(this.l)},a.initInterstitial=function(e,t,n){var i=this;this.j&&this.j.release(),this.j=new hf(e,t,n,function(s){return df(i,s)}),this.j.configure(this.l)},a.initClientSide=function(e,t,n){var i=this;if(!p.google||!google.ima||!google.ima.AdsLoader)throw new K(2,10,1e4);this.i&&this.i.release(),this.i=new uf(e,t,this.o,n,function(s){return df(i,s)}),this.i.configure(this.l)},a.release=function(){this.j&&(this.j.release(),this.j=null),this.i&&(this.i.release(),this.i=null),this.h&&(this.h.release(),this.h=null),this.g&&(this.g.release(),this.g=null),Et.prototype.release.call(this)},a.onAssetUnload=function(){this.j&&this.j.stop(),this.i&&this.i.stop(),this.h&&this.h.stop(),this.g&&this.g.stop(),this.dispatchEvent(new Ue("ad-stopped")),this.dispatchEvent(new Ue("ad-content-attach-requested")),this.m=new E1},a.requestClientSideAds=function(e){if(!this.i)throw new K(1,10,10001);var t=this.i;t.g&&t.g.destroy(),t.m&&t.m.contentComplete(),t.G=Date.now()/1e3,t.m.requestAds(e)},a.updateClientSideAdsRenderingSettings=function(e){if(!this.i)throw new K(1,10,10001);var t=this.i;t.B=e,t.g&&t.g.updateAdsRenderingSettings(t.B)},a.initMediaTailor=function(e,t,n){var i=this;this.h&&this.h.release(),this.h=new Za(e,t,n,function(s){return df(i,s)})},a.requestMediaTailorStream=function(e,t,n){if(!this.h)throw new K(1,10,10005);var i=this.h;return n=n===void 0?"":n,i.l?e=Promise.reject(new K(1,10,10004)):(i.l=new _t,CA(i,e,t),i.H=n||"",i.U=Date.now()/1e3,e=i.l),e},a.addMediaTailorTrackingUrl=function(e){if(!this.h)throw new K(1,10,10005);var t=this.h;t.G=e,t.i(new Ue("ads-loaded",new Map().set("loadTime",0)))},a.initServerSide=function(e,t){var n=this;if(!p.google||!google.ima||!google.ima.dai)throw new K(2,10,10002);this.g&&this.g.release(),this.g=new P1(e,t,this.o,function(i){return df(n,i)}),this.g.configure(this.l)},a.requestServerSideStream=function(e,t){if(t=t===void 0?"":t,!this.g)throw new K(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&Fe('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.10.12",n=this.g,n.j?e=Promise.reject(new K(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.G=!0),n.j=new _t,n.g.requestStream(e),n.B=t||"",n.F=Date.now()/1e3,e=n.j),e},a.replaceServerSideAdTagParameters=function(e){if(!this.g)throw new K(1,10,10003);(e.mpt||e.mpv)&&Fe('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.mpt="Shaka Player",e.mpv="v4.10.12",this.g.g.replaceAdTagParameters(e)},a.getServerSideCuePoints=function(){return vt("AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},a.getCuePoints=function(){var e=[];return this.g&&(e=e.concat(this.g.getCuePoints())),this.h&&(e=e.concat(this.h.getCuePoints())),e},a.getStats=function(){var e=this.m;return{loadTimes:e.g,averageLoadTime:yA(e),started:e.h,playedCompletely:e.j,skipped:e.l,errors:e.i}},a.onManifestUpdated=function(e){this.h&&this.h.onManifestUpdated(e)},a.onDashTimedMetadata=function(e){this.g&&e.schemeIdUri=="urn:google:dai:2018"&&this.g.g.processMetadata(e.schemeIdUri,e.eventNode?e.eventNode.attributes.messageData:null,e.startTime)},a.onHlsTimedMetadata=function(e,t){this.g&&this.g.g.processMetadata("ID3",e.data,t)},a.onCueMetadataChange=function(e){this.g&&this.g.onCueMetadataChange(e)},a.onInterstitialMetadata=function(e,t,n){this.j||this.initInterstitial(null,e,t),this.j&&wA(this.j,n)};function df(e,t){if(t&&t.type)switch(t.type){case"ads-loaded":e.m.g.push(t.loadTime);break;case"ad-started":e.m.h++;break;case"ad-complete":e.m.j++;break;case"ad-skipped":e.m.l++;break;case"ad-error":e.m.i++}e.dispatchEvent(t)}he("shaka.ads.AdManager",Ge),Ge.prototype.onInterstitialMetadata=Ge.prototype.onInterstitialMetadata,Ge.prototype.onCueMetadataChange=Ge.prototype.onCueMetadataChange,Ge.prototype.onHlsTimedMetadata=Ge.prototype.onHlsTimedMetadata,Ge.prototype.onDashTimedMetadata=Ge.prototype.onDashTimedMetadata,Ge.prototype.onManifestUpdated=Ge.prototype.onManifestUpdated,Ge.prototype.getStats=Ge.prototype.getStats,Ge.prototype.getCuePoints=Ge.prototype.getCuePoints,Ge.prototype.getServerSideCuePoints=Ge.prototype.getServerSideCuePoints,Ge.prototype.replaceServerSideAdTagParameters=Ge.prototype.replaceServerSideAdTagParameters,Ge.prototype.requestServerSideStream=Ge.prototype.requestServerSideStream,Ge.prototype.initServerSide=Ge.prototype.initServerSide,Ge.prototype.addMediaTailorTrackingUrl=Ge.prototype.addMediaTailorTrackingUrl,Ge.prototype.requestMediaTailorStream=Ge.prototype.requestMediaTailorStream,Ge.prototype.initMediaTailor=Ge.prototype.initMediaTailor,Ge.prototype.updateClientSideAdsRenderingSettings=Ge.prototype.updateClientSideAdsRenderingSettings,Ge.prototype.requestClientSideAds=Ge.prototype.requestClientSideAds,Ge.prototype.onAssetUnload=Ge.prototype.onAssetUnload,Ge.prototype.release=Ge.prototype.release,Ge.prototype.initClientSide=Ge.prototype.initClientSide,Ge.prototype.initInterstitial=Ge.prototype.initInterstitial,Ge.prototype.configure=Ge.prototype.configure,Ge.prototype.setLocale=Ge.prototype.setLocale,Ge.ADS_LOADED="ads-loaded",Ge.AD_STARTED="ad-started",Ge.AD_FIRST_QUARTILE="ad-first-quartile",Ge.AD_MIDPOINT="ad-midpoint",Ge.AD_THIRD_QUARTILE="ad-third-quartile",Ge.AD_COMPLETE="ad-complete",Ge.AD_STOPPED="ad-stopped",Ge.AD_SKIPPED="ad-skipped",Ge.AD_VOLUME_CHANGED="ad-volume-changed",Ge.AD_MUTED="ad-muted",Ge.AD_PAUSED="ad-paused",Ge.AD_RESUMED="ad-resumed",Ge.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",Ge.CUEPOINTS_CHANGED="ad-cue-points-changed",Ge.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",Ge.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",Ge.AD_CLICKED="ad-clicked",Ge.AD_PROGRESS="ad-progress",Ge.AD_BUFFERING="ad-buffering",Ge.AD_IMPRESSION="ad-impression",Ge.AD_DURATION_CHANGED="ad-duration-changed",Ge.AD_CLOSED="ad-closed",Ge.AD_LOADED="ad-loaded",Ge.ALL_ADS_COMPLETED="all-ads-completed",Ge.AD_LINEAR_CHANGED="ad-linear-changed",Ge.AD_METADATA="ad-metadata",Ge.AD_RECOVERABLE_ERROR="ad-recoverable-error",Ge.AD_ERROR="ad-error",Ge.AD_BREAK_READY="ad-break-ready",Ge.AD_INTERACTION="ad-interaction",Ge.AD_CONTENT_PAUSE_REQUESTED="ad-content-pause-requested",Ge.AD_CONTENT_RESUME_REQUESTED="ad-content-resume-requested",Ge.AD_CONTENT_ATTACH_REQUESTED="ad-content-attach-requested",lf=function(){return new Ge};function D1(e){return JSON.stringify(e,function(t,n){if(typeof n!="function"){if(n instanceof Event||n instanceof Ue){var i={};for(s in n)(t=n[s])&&typeof t=="object"?s=="detail"&&(i[s]=t):s in Event||(i[s]=t);return i}if(n instanceof Error){var s=new Set(["name","message","stack"]);for(i in n)s.add(i);for(i=x(Object.getOwnPropertyNames(n)),t=i.next();!t.done;t=i.next())s.add(t.value);for(i={},s=x(s),t=s.next();!t.done;t=s.next())t=t.value,i[t]=n[t];n={__type__:"Error",contents:i}}else if(n instanceof TimeRanges){for(s={__type__:"TimeRanges",length:n.length,start:[],end:[]},n=x(Ko(n)),i=n.next();!i.done;i=n.next())i=i.value,t=i.end,s.start.push(i.start),s.end.push(t);n=s}else n=n instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(n)}:typeof n=="number"?isNaN(n)?"NaN":isFinite(n)?n:0>n?"-Infinity":"Infinity":n;return n}})}function Xd(e){return JSON.parse(e,function(t,n){if(n=="NaN")var i=NaN;else if(n=="-Infinity")i=-1/0;else if(n=="Infinity")i=1/0;else if(n&&typeof n=="object"&&n.__type__=="TimeRanges")i=IA(n);else if(n&&typeof n=="object"&&n.__type__=="Uint8Array")i=new Uint8Array(n.entries);else if(n&&typeof n=="object"&&n.__type__=="Error"){t=n.contents,n=Error(t.message);for(i in t)n[i]=t[i];i=n}else i=n;return i})}function IA(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}var N1="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),MA="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Wd=["loop","playbackRate"],RA=["pause","play"],pf={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferFullness:1,getBufferedInfo:2,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10,getManifestType:10,isFullyLoaded:1},gf={getConfiguration:4,getStats:5,getTextTracks:2,getVariantTracks:2},qd={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20,getSegmentAvailabilityDuration:20},O1=[["getConfiguration","configure"]],U1=[["isTextTrackVisible","setTextTrackVisibility"]],_A="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),LA=["attach","attachCanvas","detach","load","unload"];function Yd(e,t,n,i,s,l,u){var c=this;this.G=e,this.K=u,this.l=new ct(t),this.L=n,this.s=!1,this.A=i,this.F=s,this.N=l,this.h=this.m=!1,this.I="",this.o=null,this.B=function(){return Kd(c)},this.C=function(d,g){switch(d=Xd(g),d.type){case"event":var y=d.targetName,w=fm(d.event);c.A(y,w);break;case"update":y=d.update;for(w in y){d=c.g[w]||{};for(var C in y[w])d[C]=y[w][C]}c.s&&(c.L(),c.s=!1);break;case"asyncComplete":if(w=d.id,C=d.error,d=c.i[w],delete c.i[w],d)if(C){w=new K(C.severity,C.category,C.code);for(y in C)w[y]=C[y];d.reject(w)}else d.resolve()}},this.g={video:{},player:{}},this.H=0,this.i={},this.j=null,Ja.add(this)}a=Yd.prototype,a.destroy=function(){return Ja.delete(this),Zd(this),$i&&j1(this),this.l&&(this.l.stop(),this.l=null),this.F=this.A=null,this.h=this.m=!1,this.C=this.B=this.j=this.i=this.g=this.o=null,Promise.resolve()},a.fb=function(){return this.h},a.Ff=function(){return this.I},a.init=function(){if(this.G.length)if(p.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.l.tc();var e=new chrome.cast.SessionRequest(this.G,[],null,this.K,null);e=new chrome.cast.ApiConfig(e,function(t){for(var n=x(Ja),i=n.next();!i.done;i=n.next()){i=i.value;var s=t;i.j=new _t,i.s=!0,mf(i,s)}},function(t){for(var n=x(Ja),i=n.next();!i.done;i=n.next())i=i.value,yf=t=="available",i.l.tc()},"origin_scoped"),chrome.cast.initialize(e,function(){},function(){}),yf&&this.l.Y(DA),(e=$i)&&e.status!=chrome.cast.SessionStatus.STOPPED?(this.j=new _t,this.s=!0,mf(this,e)):$i=null}else p.__onGCastApiAvailable!==F1&&(vf=p.__onGCastApiAvailable||null,p.__onGCastApiAvailable=F1)},a.Nf=function(e){this.o=e,this.h&&Qa(this,{type:"appData",appData:this.o})},a.cast=function(){var e=this;return $(function(t){if(!e.m)throw new K(1,8,8e3);if(!yf)throw new K(1,8,8001);if(e.h)throw new K(1,8,8002);return e.j=new _t,chrome.cast.requestSession(function(n){return mf(e,n)},function(n){return B1(e,n)}),E(t,e.j,0)})};function PA(e){e.h&&chrome.cast.requestSession(function(t){return mf(e,t)},function(t){return B1(e,t)})}a.Cc=function(){if(this.h){if(Zd(this),$i){j1(this);try{$i.stop(function(){},function(){})}catch{}$i=null}Kd(this)}},a.get=function(e,t){var n=this;if(e=="video"){if(RA.includes(t))return function(){return n.Ug.apply(n,[e,t].concat(L(Pe.apply(0,arguments))))}}else if(e=="player"){if(qd[t]&&!this.get("player","isLive")())return function(){};if(_A.includes(t))return function(){return n.Ug.apply(n,[e,t].concat(L(Pe.apply(0,arguments))))};if(LA.includes(t))return function(){return n.Ki.apply(n,[e,t].concat(L(Pe.apply(0,arguments))))};if(pf[t]||gf[t])return function(){return n.g[e][t]}}return this.g[e][t]},a.set=function(e,t,n){this.g[e][t]=n,Qa(this,{type:"set",targetName:e,property:t,value:n})};function mf(e,t){var n=e.N();$i=t,t.addUpdateListener(e.B),t.addMessageListener("urn:x-cast:com.google.shaka.v2",e.C),Kd(e),Qa(e,{type:"init",initState:n,appData:e.o}),e.j.resolve()}function B1(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.j.reject(new K(2,8,n,t))}a.Ug=function(e,t){Qa(this,{type:"call",targetName:e,methodName:t,args:Pe.apply(2,arguments)})},a.Ki=function(e,t){var n=Pe.apply(2,arguments),i=new _t,s=this.H.toString();this.H++,this.i[s]=i;try{Qa(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:s})}catch(l){i.reject(l)}return i};function j1(e){var t=$i;t.removeUpdateListener(e.B),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.C)}function Kd(e){var t=$i?$i.status=="connected":!1;if(e.h&&!t){e.F();for(var n in e.g)e.g[n]={};Zd(e)}e.h=t,e.I=t?$i.receiver.friendlyName:"",e.l.tc()}function Zd(e){for(var t in e.i){var n=e.i[t];delete e.i[t],n.reject(new K(1,7,7e3))}}function Qa(e,t){t=D1(t);var n=$i;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,function(){},kt)}catch(i){throw t=new K(2,8,8005,i),n=new Ue("error",new Map().set("detail",t)),e.A("player",n),e.Cc(),t}}var DA=.02,yf=!1,$i=null,vf=null,Ja=new Set;function F1(e){if(vf?p.__onGCastApiAvailable=vf:delete p.__onGCastApiAvailable,vf=null,e)for(var t=x(Ja),n=t.next();!n.done;n=t.next())n.value.init();typeof p.__onGCastApiAvailable=="function"&&p.__onGCastApiAvailable(e)}function on(e,t,n,i){i=i===void 0?!1:i,Et.call(this);var s=this;this.i=e,this.h=t,this.m=this.o=this.j=this.s=this.l=null,this.C=n,this.B=i,this.A=new Map,this.g=new Yd(n,function(){return H1(s)},function(){return z1(s)},function(l,u){return X1(s,l,u)},function(){return G1(s)},function(){return V1(s)},i),NA(this)}le(on,Et),a=on.prototype,a.destroy=function(e){return e&&this.g.Cc(),this.m&&(this.m.release(),this.m=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.s=this.l=this.i=null,Et.prototype.release.call(this),Promise.all(e)},a.fi=function(){return this.l},a.Vh=function(){return this.s},a.Ah=function(){return this.g.m&&yf},a.fb=function(){return this.g.fb()},a.Ff=function(){return this.g.Ff()},a.cast=function(){var e=this;return $(function(t){return t.g==1?E(t,e.g.cast(),2):e.h?E(t,e.h.bc(),0):t.return()})},a.Nf=function(e){this.g.Nf(e)},a.$i=function(){PA(this.g)},a.Cc=function(){this.g.Cc()},a.Bh=function(e,t){t=t===void 0?!1:t;var n=this;return $(function(i){if(i.g==1)return e==n.C&&t==n.B?i.return():(n.C=e,n.B=t,n.g.Cc(),E(i,n.g.destroy(),2));n.g=null,n.g=new Yd(e,function(){return H1(n)},function(){return z1(n)},function(s,l){return X1(n,s,l)},function(){return G1(n)},function(){return V1(n)},t),n.g.init(),F(i)})};function NA(e){e.g.init(),e.m=new lt;for(var t=x(N1),n=t.next();!n.done;n=t.next())e.m.D(e.i,n.value,function(l){e.g.fb()||(l=fm(l),e.j.dispatchEvent(l))});for(var i in xu)e.m.D(e.h,xu[i],function(l){e.g.fb()||e.o.dispatchEvent(l)});e.l={},t={};for(var s in e.i)t={nd:t.nd},t.nd=s,Object.defineProperty(e.l,t.nd,{configurable:!1,enumerable:!0,get:function(l){return function(){return UA(e,l.nd)}}(t),set:function(l){return function(u){var c=l.nd;e.g.fb()?e.g.set("video",c,u):e.i[c]=u}}(t)});e.s={},$1(e,function(l){Object.defineProperty(e.s,l,{configurable:!1,enumerable:!0,get:function(){return BA(e,l)}})}),OA(e),e.j=new Et,e.j.me=e.l,e.o=new Et,e.o.me=e.s}function OA(e){var t=new Map;$1(e,function(n,i){t.has(i)?(i=t.get(i),n.length<i.length?e.A.set(n,i):e.A.set(i,n)):t.set(i,n)})}function $1(e,t){function n(d){return d=="constructor"||typeof i[d]!="function"?!1:!s.has(d)}var i=e.h,s=new Set,l;for(l in i)n(l)&&(s.add(l),t(l,i[l]));for(e=Object.getPrototypeOf(i),l=Object.getPrototypeOf({});e&&e!=l;){for(var u=x(Object.getOwnPropertyNames(e)),c=u.next();!c.done;c=u.next())c=c.value,n(c)&&(s.add(c),t(c,i[c]));e=Object.getPrototypeOf(e)}}function V1(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.Dc(),startTime:null};e.i.pause();for(var n=x(Wd),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.i[i];for(e.i.ended||(t.startTime=e.i.currentTime),n=x(O1),i=n.next();!i.done;i=n.next()){var s=i.value;i=s[1],s=e.h[s[0]](),t.player[i]=s}for(n=x(U1),i=n.next();!i.done;i=n.next())s=i.value,i=s[1],s=e.h[s[0]](),t.playerAfterLoad[i]=s;return t}function H1(e){var t=new Ue("caststatuschanged");e.dispatchEvent(t)}function z1(e){var t=new Ue(e.l.paused?"pause":"play");e.j.dispatchEvent(t)}function G1(e){for(var t=x(O1),n=t.next();!n.done;n=t.next()){var i=n.value;n=i[1],i=e.g.get("player",i[0])(),e.h[n](i)}var s=e.g.get("player","getAssetUri")();i=e.g.get("video","ended"),t=Promise.resolve();var l=e.i.autoplay;n=null,i||(n=e.g.get("video","currentTime"));var u;(i=e.g.get("player","getTextTracks")())&&i.length&&(u=i.find(function(g){return g.active}));var c=e.g.get("player","isTextTrackVisible")();s&&(e.i.autoplay=!1,t=e.h.load(s,n));var d={};for(n=x(Wd),i=n.next();!i.done;i=n.next())i=i.value,d[i]=e.g.get("video",i);t.then(function(){if(e.i){for(var g=x(Wd),y=g.next();!y.done;y=g.next())y=y.value,e.i[y]=d[y];for(g=x(U1),y=g.next();!y.done;y=g.next()){var w=y.value;y=w[1],w=e.g.get("player",w[0])(),e.h[y](w)}e.h.eh(c),u&&e.h.Lf(u.language,u.roles,u.forced),e.i.autoplay=l,s&&e.i.play()}},function(g){g=new Map().set("detail",g),g=new Ue("error",g),e.h.dispatchEvent(g)})}function UA(e,t){if(t=="addEventListener")return function(i,s,l){return e.j.addEventListener(i,s,l)};if(t=="removeEventListener")return function(i,s,l){return e.j.removeEventListener(i,s,l)};if(e.g.fb()&&Object.keys(e.g.g.video).length==0){var n=e.i[t];if(typeof n!="function")return n}return e.g.fb()?e.g.get("video",t):(t=e.i[t],typeof t=="function"&&(t=t.bind(e.i)),t)}function BA(e,t){if(e.A.has(t)&&(t=e.A.get(t)),t=="addEventListener")return function(n,i,s){return e.o.addEventListener(n,i,s)};if(t=="removeEventListener")return function(n,i,s){return e.o.removeEventListener(n,i,s)};if(t=="getMediaElement")return function(){return e.l};if(t=="getSharedConfiguration")return e.g.get("player","getConfiguration");if(t=="getNetworkingEngine")return function(){return e.h.xb()};if(t=="getDrmEngine")return function(){return e.h.B};if(t=="getAdManager")return function(){return e.h.ug()};if(t=="setVideoContainer")return function(n){return e.h.ih(n)};if(e.g.fb()){if(t=="getManifest"||t=="drmInfo")return function(){return Fe(t+"() does not work while casting!"),null};if(t=="attach"||t=="detach")return function(){return Fe(t+"() does not work while casting!"),Promise.resolve()}}return e.g.fb()&&Object.keys(e.g.g.video).length==0&&(pf[t]||gf[t])||!e.g.fb()?e.h[t].bind(e.h):e.g.get("player",t)}function X1(e,t,n){e.g.fb()&&(t=="video"?e.j.dispatchEvent(n):t=="player"&&e.o.dispatchEvent(n))}he("shaka.cast.CastProxy",on),on.prototype.changeReceiverId=on.prototype.Bh,on.prototype.forceDisconnect=on.prototype.Cc,on.prototype.suggestDisconnect=on.prototype.$i,on.prototype.setAppData=on.prototype.Nf,on.prototype.cast=on.prototype.cast,on.prototype.receiverName=on.prototype.Ff,on.prototype.isCasting=on.prototype.fb,on.prototype.canCast=on.prototype.Ah,on.prototype.getPlayer=on.prototype.Vh,on.prototype.getVideo=on.prototype.fi,on.prototype.destroy=on.prototype.destroy;function En(e,t,n,i){Et.call(this);var s=this;this.g=e,this.h=t,this.j=new lt,this.H={video:e,player:t},this.F=n||function(){},this.I=i||function(l){return l},this.i=null,this.G=!1,this.o=!0,this.m=0,this.B=!1,this.A=!0,this.s=this.l=null,this.C=new ct(function(){Qd(s)}),jA(this)}le(En,Et),a=En.prototype,a.isConnected=function(){return this.G},a.mi=function(){return this.o},a.Wi=function(e){this.i=e},a.Dh=function(){this.i=null},a.Xi=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},a.Vi=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},a.Ui=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},a.destroy=function(){var e=this,t,n;return $(function(i){if(i.g==1)return e.j&&(e.j.release(),e.j=null),t=[],e.h&&(t.push(e.h.destroy()),e.h=null),e.C&&(e.C.stop(),e.C=null),e.g=null,e.H=null,e.F=null,e.G=!1,e.o=!0,e.l=null,e.s=null,Et.prototype.release.call(e),E(i,Promise.all(t),2);n=cast.receiver.CastReceiverManager.getInstance(),n.stop(),F(i)})};function jA(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return W1(e)},t.onSenderDisconnected=function(){return W1(e)},t.onSystemVolumeChanged=function(){var s=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();s&&Po(e,{type:"update",update:{video:{volume:s.level,muted:s.muted}}},e.l),Po(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.s=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.s.onMessage=function(s){return VA(e,s)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(s){return $A(e,s)},t.start(),t=x(N1);for(var n=t.next();!n.done;n=t.next())e.j.D(e.g,n.value,function(s){return q1(e,"video",s)});for(var i in xu)e.j.D(e.h,xu[i],function(s){return q1(e,"player",s)});e.j.D(e.g,"loadeddata",function(){e.B=!0}),e.j.D(e.h,"loading",function(){e.o=!1,Ms(e)}),e.j.D(e.g,"playing",function(){e.o=!1,Ms(e)}),e.j.D(e.g,"pause",function(){Ms(e)}),e.j.D(e.h,"unloading",function(){e.o=!0,Ms(e)}),e.j.D(e.g,"ended",function(){new ct(function(){e.g&&e.g.ended&&(e.o=!0,Ms(e))}).Y(zA)})}function W1(e){e.m=0,e.A=!0,e.G=cast.receiver.CastReceiverManager.getInstance().getSenders().length!=0,Ms(e)}function Ms(e){var t;$(function(n){if(n.g==1)return E(n,Promise.resolve(),2);if(!e.h)return n.return();t=new Ue("caststatuschanged"),e.dispatchEvent(t),Y1(e)||Do(e),F(n)})}function FA(e,t,n){var i,s,l,u,c,d,g,y,w,C;$(function(T){switch(T.g){case 1:for(i in t.player)s=t.player[i],e.h[i](s);return e.F(n),l=e.g.autoplay,t.manifest?(e.g.autoplay=!1,ue(T,5),E(T,e.h.load(t.manifest,t.startTime),7)):E(T,Promise.resolve(),3);case 7:ge(T,3);break;case 5:return u=ie(T),c=new Map().set("detail",u),d=new Ue("error",c),e.h&&e.h.dispatchEvent(d),T.return();case 3:if(!e.h)return T.return();for(g in t.video)y=t.video[g],e.g[g]=y;for(w in t.playerAfterLoad)C=t.playerAfterLoad[w],e.h[w](C);e.g.autoplay=l,t.manifest&&(e.g.play(),Do(e)),F(T)}})}function q1(e,t,n){e.h&&(Qd(e),Po(e,{type:"event",targetName:t,event:n},e.l))}function Qd(e){e.C.Y(HA);for(var t={video:{},player:{}},n=x(MA),i=n.next();!i.done;i=n.next())i=i.value,t.video[i]=e.g[i];if(e.h.V())for(var s in qd)e.m%qd[s]==0&&(t.player[s]=e.h[s]());for(var l in pf)e.m%pf[l]==0&&(t.player[l]=e.h[l]());(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),Po(e,{type:"update",update:t},e.l);for(var u in gf)e.m%gf[u]==0&&(t={player:{}},t.player[u]=e.h[u](),Po(e,{type:"update",update:t},e.l));e.B&&(e.m+=1),Y1(e)}function Y1(e){return e.A&&(e.g.duration||e.h.V())?(Jd(e),e.A=!1,!0):!1}function Jd(e,t){var n={contentId:e.h.Dc(),streamType:e.h.V()?"LIVE":"BUFFERED",contentType:""};e.h.V()||(n.duration=e.g.duration),e.i&&(n.metadata=e.i),Do(e,t===void 0?0:t,n)}function $A(e,t){var n=Xd(t.data);switch(n.type){case"init":e.m=0,e.B=!1,e.A=!0,FA(e,n.initState,n.appData),Qd(e);break;case"appData":e.F(n.appData);break;case"set":var i=n.targetName,s=n.property;if(n=n.value,i=="video"){if(t=cast.receiver.CastReceiverManager.getInstance(),s=="volume"){t.setSystemVolumeLevel(n);break}else if(s=="muted"){t.setSystemVolumeMuted(n);break}}e.H[i][s]=n;break;case"call":i=e.H[n.targetName],i[n.methodName].apply(i,n.args);break;case"asyncCall":i=n.targetName,s=n.methodName,i=="player"&&s=="load"&&(e.m=0,e.B=!1);var l=n.id,u=t.senderId;t=e.H[i],n=t[s].apply(t,n.args),i=="player"&&s=="load"&&(n=n.then(function(){e.A=!0})),n.then(function(){return K1(e,u,l,null)},function(c){return K1(e,u,l,c)})}}function VA(e,t){var n=Xd(t.data);switch(n.type){case"PLAY":e.g.play(),Do(e);break;case"PAUSE":e.g.pause(),Do(e);break;case"SEEK":t=n.currentTime;var i=n.resumeState;t!=null&&(e.g.currentTime=Number(t)),i&&i=="PLAYBACK_START"?(e.g.play(),Do(e)):i&&i=="PLAYBACK_PAUSE"&&(e.g.pause(),Do(e));break;case"STOP":e.h.bc().then(function(){e.h&&Do(e)});break;case"GET_STATUS":Jd(e,Number(n.requestId));break;case"VOLUME":i=n.volume,t=i.level,i=i.muted;var s=e.g.volume,l=e.g.muted;t!=null&&(e.g.volume=Number(t)),i!=null&&(e.g.muted=i),s==e.g.volume&&l==e.g.muted||Do(e);break;case"LOAD":e.m=0,e.B=!1,e.A=!1,t=n.media,i=n.currentTime,s=e.I(t.contentId),l=n.autoplay||!0,e.F(t.customData),l&&(e.g.autoplay=!0),e.h.load(s,i).then(function(){e.h&&Jd(e)}).catch(function(u){var c="LOAD_FAILED";u.category==7&&u.code==7e3&&(c="LOAD_CANCELLED"),Po(e,{requestId:Number(n.requestId),type:c},e.s)});break;default:Po(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.s)}}function K1(e,t,n,i){e.h&&Po(e,{type:"asyncComplete",id:n,error:i},e.l,t)}function Po(e,t,n,i){e.G&&(e=D1(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function Do(e,t,n){n=n===void 0?null:n;var i={mediaSessionId:0,playbackRate:e.g.playbackRate,playerState:e.o?GA:e.h.pf()?WA:e.g.paused?qA:XA,currentTime:e.g.currentTime,supportedMediaCommands:63,volume:{level:e.g.volume,muted:e.g.muted}};n&&(i.media=n),Po(e,{requestId:t===void 0?0:t,type:"MEDIA_STATUS",status:[i]},e.s)}he("shaka.cast.CastReceiver",En),En.prototype.destroy=En.prototype.destroy,En.prototype.setContentArtist=En.prototype.Ui,En.prototype.setContentImage=En.prototype.Vi,En.prototype.setContentTitle=En.prototype.Xi,En.prototype.clearContentMetadata=En.prototype.Dh,En.prototype.setContentMetadata=En.prototype.Wi,En.prototype.isIdle=En.prototype.mi,En.prototype.isConnected=En.prototype.isConnected;var HA=.5,zA=5,GA="IDLE",XA="PLAYING",WA="BUFFERING",qA="PAUSED";function Z1(e,t,n,i,s){if(i>=s)return null;for(var l=-1,u=-1,c=0;c<n.length;c++)if(n[c].some(function(P){return P!=null&&P.g.trim()!=""})){l=c;break}for(c=n.length-1;0<=c;c--)if(n[c].some(function(P){return P!=null&&P.g.trim()!=""})){u=c;break}if(l===-1||u===-1)return null;for(var d=c=!1,g="white",y="black",w=ep(i,s,c,d,g,y);l<=u;l++){for(var C=n[l],T=-1,A=-1,b=0;b<C.length;b++)if(C[b]!=null&&C[b].g.trim()!==""){T=b;break}for(b=C.length-1;0<=b;b--)if(C[b]!=null&&C[b].g.trim()!==""){A=b;break}if(T===-1||A===-1)C=Q1(i,s),e.nestedCues.push(C);else{for(;T<=A;T++)if(b=C[T]){var k=b.l,O=b.i,D=b.j,z=b.h;(k!=c||O!=d||D!=g||z!=y)&&(w.payload&&e.nestedCues.push(w),w=ep(i,s,k,O,D,z),c=k,d=O,g=D,y=z),w.payload+=b.g}else w.payload+=" ";w.payload&&e.nestedCues.push(w),l!==u&&(w=Q1(i,s),e.nestedCues.push(w)),w=ep(i,s,c,d,g,y)}}return e.nestedCues.length?{cue:e,stream:t}:null}function ep(e,t,n,i,s,l){return e=new St(e,t,""),n&&e.textDecoration.push("underline"),i&&(e.fontStyle="italic"),e.color=s,e.backgroundColor=l,e}function Q1(e,t){return e=new St(e,t,""),e.lineBreak=!0,e}function J1(e,t,n,i,s){this.g=e,this.l=t,this.i=n,this.h=i,this.j=s}function tp(e,t){this.i=[],this.g=1,this.h=0,this.A=e,this.s=t,this.j=this.m=!1,this.l="white",this.o="black",el(this)}function xf(e,t,n){var i="CC"+((e.A<<1|e.s)+1),s=new St(t,n,"");s.lineInterpretation=1;var l=nv.get(e.g);return l&&(s.line=l),(t=Z1(s,i,e.i,t,n))&&15<e.g+t.cue.nestedCues.length-3&&(l=nv.get(e.g+3-t.cue.nestedCues.length))&&(s.line=l),t}function el(e){No(e,0,15),e.g=1}function Rs(e,t,n){if(!(32>n||127<n)){var i="";switch(t){case 0:i=tv.has(n)?tv.get(n):String.fromCharCode(n);break;case 1:i=YA.get(n);break;case 2:e.i[e.g].pop(),i=KA.get(n);break;case 3:e.i[e.g].pop(),i=ZA.get(n)}i&&e.i[e.g].push(new J1(i,e.m,e.j,e.o,e.l))}}function ev(e,t,n,i){if(!(0>n||0>t))if(t>=n)for(--i;0<=i;i--)e.i[t+i]=e.i[n+i].map(function(l){return l});else for(var s=0;s<i;s++)e.i[t+s]=e.i[n+s].map(function(l){return l})}function No(e,t,n){for(var i=0;i<=n;i++)e.i[t+i]=[]}var tv=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),YA=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57," "],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),KA=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),ZA=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]),nv=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]);function wf(e,t){this.h=0,this.o=new tp(e,t),this.i=new tp(e,t),this.g=this.j=new tp(e,t),this.l=0,this.m=null}function np(e,t,n){e.g=e.i;var i=e.g,s=null;return e.h!==3&&e.h!==4&&(s=xf(i,e.l,n),n=e.i,n.g=0<n.h?n.h:0,No(n,0,15),n=e.j,n.g=0<n.h?n.h:0,No(n,0,15),i.g=15),e.h=3,i.h=t,s}function iv(e){e.h=1,e.g=e.j,e.g.h=0}function ov(e){Ke("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=4}var QA="black green blue cyan red yellow magenta black".split(" "),rv="white green blue cyan red yellow magenta white_italics".split(" ");function sv(e,t){this.I=t,this.N=e,this.K=this.l=!1,this.m=this.o=this.G=this.L=this.H=0,this.F=2,this.i=[],this.g=this.h=this.j=0,this.C=this.A=!1,this.B="white",this.s="black",ip(this)}function ip(e){e.i=[];for(var t=0;16>t;t++)e.i.push(op())}function op(){for(var e=[],t=0;42>t;t++)e.push(null);return e}function Dr(e,t){av(e)&&(e.i[e.h][e.g]=new J1(t,e.C,e.A,e.s,e.B),e.g++)}function av(e){var t=e.g<e.m&&0<=e.g;return e.h<e.o&&0<=e.h&&t}sv.prototype.isVisible=function(){return this.l};function Nr(e,t,n){var i=new St(e.j,t,"");i.textAlign=e.F===0?"left":e.F===1?"right":yo;var s=i.region;switch(e.I&&(s.id+="svc"+e.I),s.id+="win"+e.N,s.height=e.o,s.width=e.m,s.heightUnits=2,s.widthUnits=2,s.viewportAnchorX=e.H,s.viewportAnchorY=e.L,s.viewportAnchorUnits=e.K?Wn:2,e.G){case 0:s.regionAnchorX=0,s.regionAnchorY=0;break;case 1:s.regionAnchorX=50,s.regionAnchorY=0;break;case 2:s.regionAnchorX=100,s.regionAnchorY=0;break;case 3:s.regionAnchorX=0,s.regionAnchorY=50;break;case 4:s.regionAnchorX=50,s.regionAnchorY=50;break;case 5:s.regionAnchorX=100,s.regionAnchorY=50;break;case 6:s.regionAnchorX=0,s.regionAnchorY=100;break;case 7:s.regionAnchorX=50,s.regionAnchorY=100;break;case 8:s.regionAnchorX=100,s.regionAnchorY=100}return(n=Z1(i,"svc"+n,e.i,e.j,t))&&(e.j=t),n}function JA(){this.i=[],this.h=null,this.g=0}function ek(e,t){t.type===3?(e.g=2*(t.value&63)-1,e.h=[]):e.h&&(0<e.g&&(e.h.push(t),e.g--),e.g===0&&(e.i.push(new Sf(e.h)),e.h=null,e.g=0))}function Sf(e){this.g=0,this.h=e}Sf.prototype.na=function(){return this.g<this.h.length},Sf.prototype.va=function(){return this.g};function gn(e){if(!e.na())throw new K(2,2,3e3);return e.h[e.g++]}Sf.prototype.skip=function(e){if(this.g+e>this.h.length)throw new K(2,2,3e3);this.g+=e};function tk(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function nk(e,t,n,i){if(128<=n&&135>=n)i=n&7,e.h[i]&&(e.g=e.h[i]);else{if(n===136){n=gn(t).value,t=null,n=x(tl(e,n));for(var s=n.next();!s.done;s=n.next())s=e.h[s.value],s.isVisible()&&(t=Nr(s,i,e.i)),ip(s);return t}if(n===137)for(t=gn(t).value,t=x(tl(e,t)),n=t.next();!n.done;n=t.next())n=e.h[n.value],n.isVisible()||(n.j=i),n.l=!0;else{if(n===138){for(n=gn(t).value,t=null,n=x(tl(e,n)),s=n.next();!s.done;s=n.next())s=e.h[s.value],s.isVisible()&&(t=Nr(s,i,e.i)),s.l=!1;return t}if(n===139){for(n=gn(t).value,t=null,n=x(tl(e,n)),s=n.next();!s.done;s=n.next())s=e.h[s.value],s.isVisible()?t=Nr(s,i,e.i):s.j=i,s.l=!s.l;return t}if(n===140)return t=gn(t).value,lv(e,t,i);if(n===143)return i=lv(e,255,i),uv(e),i;if(n===144)t.skip(1),i=gn(t).value,e.g&&(e.g.A=0<(i&128),e.g.C=0<(i&64));else if(n===145)i=gn(t).value,n=gn(t).value,t.skip(1),e.g&&(t=fv((n&48)>>4,(n&12)>>2,n&3),e.g.B=fv((i&48)>>4,(i&12)>>2,i&3),e.g.s=t);else if(n===146)i=gn(t).value,t=gn(t).value,e.g&&(e=e.g,e.h=i&15,e.g=t&63);else if(n===151)t.skip(1),t.skip(1),i=gn(t).value,t.skip(1),e.g&&(e.g.F=i&3);else if(152<=n&&159>=n){if(n=(n&15)-8,s=e.h[n]!==null,!s){var l=new sv(n,e.i);l.j=i,e.h[n]=l}i=gn(t).value,l=gn(t).value;var u=gn(t).value,c=gn(t).value,d=gn(t).value;t=gn(t).value,s&&!(t&7)||(t=e.h[n],t.h=0,t.g=0,t.C=!1,t.A=!1,t.B="white",t.s="black"),t=e.h[n],t.l=0<(i&32),t.L=l&127,t.H=u,t.G=(c&240)>>4,t.K=0<(l&128),t.o=(c&15)+1,t.m=(d&63)+1,e.g=e.h[n]}}}return null}function tl(e,t){for(var n=[],i=0;8>i;i++)(t&1)===1&&e.h[i]&&n.push(i),t>>=1;return n}function lv(e,t,n){var i=null;t=x(tl(e,t));for(var s=t.next();!s.done;s=t.next()){s=s.value;var l=e.h[s];l.isVisible()&&(i=Nr(l,n,e.i)),e.h[s]=null}return i}function uv(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function fv(e,t,n){var i={0:0,1:0,2:1,3:1};return e=i[e],t=i[t],n=i[n],ik[e<<2|t<<1|n]}var cv=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),ik="black blue green cyan red magenta yellow white".split(" ");function _s(){this.h=[],this.g=[],this.i=new JA,this.l=0,this.m=new Map([["CC1",new wf(0,0)],["CC2",new wf(0,1)],["CC3",new wf(1,0)],["CC4",new wf(1,1)]]),this.s=this.o=0,this.j=new Map,this.B=!0,this.A=new Set,rp(this)}_s.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var e=this.i;e.i=[],e.h=[],e.g=0,rp(this),e=x(this.j.values());for(var t=e.next();!t.done;t=e.next())uv(t.value)};function rp(e){e.o=0,e.s=0;for(var t=x(e.m.values()),n=t.next();!n.done;n=t.next())n=n.value,n.h=0,n.g=n.j,n.m=null,el(n.i),el(n.j),el(n.o);e.B=!0}_s.prototype.extract=function(e,t){if(this.B){for(var n=x(this.m.values()),i=n.next();!i.done;i=n.next())i.value.l=t;this.B=!1}if(e=new Nt(e,0),!(8>e.getLength())&&e.T()===181&&e.la()===49&&e.P()===1195456820&&e.T()===3&&(n=e.T(),(n&64)!==0))for(n&=31,e.skip(1),i=0;i<n;i++){var s=e.T(),l=(s&4)>>2,u=e.T(),c=e.T();l&&(s&=3,s===0||s===1?this.h.push({pts:t,type:s,bb:u,Cb:c,order:this.h.length}):(this.g.push({pts:t,type:s,value:u,order:this.g.length}),this.g.push({pts:t,type:2,value:c,order:this.g.length})))}},_s.prototype.decode=function(){function e(s,l){return s.pts-l.pts||s.order-l.order}var t=[];this.h.sort(e),this.g.sort(e);for(var n=x(this.h),i=n.next();!i.done;i=n.next())(i=ok(this,i.value))&&t.push(i);for(n=x(this.g),i=n.next();!i.done;i=n.next())ek(this.i,i.value);for(n=x(this.i.i),i=n.next();!i.done;i=n.next())i=rk(this,i.value),t.push.apply(t,L(i));return this.i.i=[],this.h=[],this.g=[],t};function ok(e,t){var n=t.type;if((t.bb&112)===16){var i=t.bb>>3&1;n===0?e.o=i:e.s=i}if(i="CC"+((n<<1|(n?e.s:e.o))+1),n=e.m.get(i),t.bb===255&&t.Cb===255||!t.bb&&!t.Cb||!hv(t.bb)||!hv(t.Cb))return 45<=++e.l&&rp(e),null;e.l=0,t.bb&=127,t.Cb&=127;var s=t.bb;if(1<=s&&15>=s||!t.bb&&!t.Cb)return null;if(s=null,(t.bb&112)===16)e:{if(e.A.add(i),i=t.bb,e=t.Cb,n.m===(i<<8|e))n.m=null;else if(n.m=i<<8|e,(i&240)===16&&(e&192)===64){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(i&7)<<1|e>>5&1];var l=(e&30)>>1;i="white",s=!1,7>l?i=rv[l]:l===7&&(s=!0),e=(e&1)===1,n.h!==4&&(l=n.g,n.h===3&&t!==l.g&&(n=1+t-l.h,ev(l,n,1+l.g-l.h,l.h),No(l,0,n-1),No(l,t+1,15-t)),l.g=t,l.m=e,l.j=s,l.l=i,l.o="black")}else if((i&247)===17&&(e&240)===32)n.g.m=!1,n.g.j=!1,n.g.l="white",Rs(n.g,0,32),i=!1,t=rv[(e&14)>>1],t==="white_italics"&&(t="white",i=!0),n.g.m=(e&1)===1,n.g.j=i,n.g.l=t;else if((i&247)===16&&(e&240)===32||(i&247)===23&&(e&255)===45)t="black",!(i&7)&&(t=QA[(e&14)>>1]),n.g.o=t;else if((i&247)===17&&(e&240)===48)Rs(n.g,1,e);else if((i&246)===18&&(e&224)===32)Rs(n.g,i&1?3:2,e);else if((i&246)===20&&(e&240)===32){switch(e=t.pts,i=null,t.Cb){case 32:iv(n);break;case 33:n=n.g,n.i[n.g].pop();break;case 37:i=np(n,2,e);break;case 38:i=np(n,3,e);break;case 39:i=np(n,4,e);break;case 40:Rs(n.g,0,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.l=e;break;case 42:el(n.o),ov(n);break;case 43:ov(n);break;case 44:t=n.i,i=null,n.h!==4&&(i=xf(t,n.l,e)),No(t,0,15);break;case 45:t=n.g,n.h!==3?i=null:(i=xf(t,n.l,e),s=t.g-t.h+1,ev(t,s-1,s,t.h),No(t,0,s-1),No(t,t.g,15-t.g),n.l=e);break;case 46:No(n.j,0,15);break;case 47:t=null,n.h!==4&&(t=xf(n.i,n.l,e)),i=n.j,n.j=n.i,n.i=i,iv(n),n.l=e,i=t}s=i;break e}s=null}else e=t.Cb,Rs(n.g,0,t.bb),Rs(n.g,0,e);return s}function rk(e,t){var n=[];try{for(;t.na();){var i=gn(t).value,s=(i&224)>>5,l=i&31;if(s===7&&l!=0&&(s=gn(t).value&63),s!=0){e.A.add("svc"+s),e.j.has(s)||e.j.set(s,new tk(s));for(var u=e.j.get(s),c=t.va();t.va()-c<l;){s=u;var d=t,g=gn(d),y=g.value,w=g.pts;if(y===16){var C=gn(d);y=y<<16|C.value}if(0<=y&&31>=y){d=s;var T=y,A=w;if(d.g){var b=d.g;switch(s=null,T){case 8:!av(b)||0>=b.g&&0>=b.h||(0>=b.g?(b.g=b.m-1,b.h--):b.g--,b.i[b.h][b.g]=null);break;case 13:if(b.isVisible()&&(s=Nr(b,A,d.i)),b.h+1>=b.o){for(d=b,T=0,A=1;16>A;A++,T++)d.i[T]=d.i[A];for(A=0;1>A;A++,T++)d.i[T]=op()}else b.h++;b.g=0;break;case 14:b.isVisible()&&(s=Nr(b,A,d.i)),b.i[b.h]=op(),b.g=0;break;case 12:b.isVisible()&&(s=Nr(b,A,d.i)),ip(b),d=b,d.h=0,d.g=0}var k=s}else k=null}else if(128<=y&&159>=y)k=nk(s,d,y,w);else{if(4096<=y&&4127>=y)s=d,d=y&255,8<=d&&15>=d?s.skip(1):16<=d&&23>=d?s.skip(2):24<=d&&31>=d&&s.skip(3);else if(4224<=y&&4255>=y)s=d,d=y&255,128<=d&&135>=d?s.skip(4):136<=d&&143>=d&&s.skip(5);else if(32<=y&&127>=y)d=y,s.g&&(d===127?Dr(s.g,"♪"):Dr(s.g,String.fromCharCode(d)));else if(160<=y&&255>=y)s.g&&Dr(s.g,String.fromCharCode(y));else if(4128<=y&&4223>=y){if(d=y&255,s.g)if(cv.has(d)){var O=cv.get(d);Dr(s.g,O)}else Dr(s.g,"_")}else 4256<=y&&4351>=y&&s.g&&((y&255)!=160?Dr(s.g,"_"):Dr(s.g,"[CC]"));k=null}(s=k)&&n.push(s)}}}}catch(D){if(D instanceof K&&D.code===3e3)Ke("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.");else throw D}return n}function hv(e){for(var t=0;e;)t^=e&1,e>>=1;return t===1}_s.prototype.getStreams=function(){return Array.from(this.A)},he("shaka.cea.CeaDecoder",_s),zi=function(){return new _s};function dv(e){for(var t=[],n=e,i=e=0;i<n.length;)e==2&&n[i]==3?(e=0,n=[].concat(L(n)),n.splice(i,1),n=new Uint8Array(n)):n[i]==0?e++:e=0,i++;for(e=n,i=0;i<e.length;){for(n=0;e[i]==255;)n+=255,i++;n+=e[i++];for(var s=0;e[i]==255;)s+=255,i++;s+=e[i++],n==4&&t.push(e.subarray(i,i+s)),i+=s}return t}function Tf(){this.j=new Map,this.i=this.h=0,this.g=sp}Tf.prototype.init=function(e){function t(l){l=l.name,l in Cf&&(n.g=Cf[l])}var n=this,i=[],s=[];if(new Ot().box("moov",dt).box("mvex",dt).S("trex",function(l){var u=l.reader;u.skip(4),u.skip(4),l=u.P(),u=u.P(),n.h=l,n.i=u}).box("trak",dt).S("tkhd",function(l){var u=l.reader;l=l.version,l==1?(u.skip(8),u.skip(8)):(u.skip(4),u.skip(4));var c=u.P();l==1?u.skip(8):u.skip(4),u.skip(4),u.skip(8),u.skip(2),u.skip(2),u.skip(2),u.skip(2),u.skip(36),u.la(),u.la(),u.la(),u.la(),i.push(c)}).box("mdia",dt).S("mdhd",function(l){l=_u(l.reader,l.version),s.push(l.timescale)}).box("minf",dt).box("stbl",dt).S("stsd",Wo).box("avc1",t).box("avc3",t).box("dvav",t).box("dva1",t).box("hev1",t).box("hvc1",t).box("dvh1",t).box("dvhe",t).box("vvc1",t).box("vvi1",t).box("dvc1",t).box("dvi1",t).box("encv",Yn).box("sinf",dt).box("frma",function(l){l=Qm(l.reader).codec,l in Cf&&(n.g=Cf[l])}).parse(e,!0),!i.length||!s.length||i.length!=s.length)throw new K(2,2,2010);this.g==sp&&Fe("Unable to determine bitstream format for CEA parsing!"),i.forEach(function(l,u){n.j.set(l,s[u])})},Tf.prototype.parse=function(e){var t=this;if(this.g==sp)return[];var n=[],i=0,s=[];return new Ot().box("moof",function(l){i=l.start,s=[],dt(l)}).box("traf",function(l){s.push({baseMediaDecodeTime:null,Yc:t.h,Id:t.i,Og:[],timescale:9e4}),dt(l)}).S("trun",function(l){var u=s[s.length-1];l=Km(l.reader,l.version,l.flags),u.Og.push(l)}).S("tfhd",function(l){var u=s[s.length-1];l=Ym(l.reader,l.flags),u.Yc=l.Yc||t.h,u.Id=l.Id||t.i,l=l.trackId,t.j.has(l)&&(u.timescale=t.j.get(l))}).S("tfdt",function(l){var u=s[s.length-1];l=Ru(l.reader,l.version),u.baseMediaDecodeTime=l.baseMediaDecodeTime}).box("mdat",function(l){for(var u=i-l.start-8,c=l.reader.va(),d=x(s),g=d.next();!g.done;g=d.next()){if(g=g.value,g.baseMediaDecodeTime===null)throw Fe("Unable to find base media decode time for CEA captions!"),new K(2,2,2010);l.reader.seek(c),sk(t,l.reader,g.baseMediaDecodeTime,g.timescale,g.Yc,g.Id,u,g.Og,n)}}).parse(e,!1),n};function sk(e,t,n,i,s,l,u,c,d){var g=0,y=l,w=c.map(function(A){return A.Wg});for(w=[].concat.apply([],L(w)),w.length&&(y=w[0].sampleSize||l),t.skip(u+c[0].Fh);t.na();){u=t.P();var C=t.T(),T=null;switch(T=!1,c=1,e.g){case nl:T=C&31,T=T==6;break;case il:c=2,t.skip(1),T=C>>1&63,T=T==39||T==40;break;case ol:c=2,t.skip(1),T=C>>1&63,T=T==23||T==24;break;default:return}if(T)for(C=0,g<w.length&&(C=w[g].ne||0),C=(n+C)/i,c=x(dv(t.qb(u-c))),T=c.next();!T.done;T=c.next())d.push({packet:T.value,pts:C});else try{t.skip(u-c)}catch{break}y-=u+4,y==0&&(n=g<w.length?n+(w[g].Jf||s):n+s,g++,g<w.length?y=w[g].sampleSize||l:y=l)}}he("shaka.cea.Mp4CeaParser",Tf);var sp=0,nl=1,il=2,ol=3,Cf={avc1:nl,avc3:nl,dvav:nl,dva1:nl,hev1:il,hvc1:il,dvh1:il,dvhe:il,vvc1:ol,vvi1:ol,dvc1:ol,dvi1:ol};Hi["video/mp4"]=function(){return new Tf};function Ef(){this.g=null}Ef.prototype.init=function(){},Ef.prototype.parse=function(e){this.g?this.g.clearData():this.g=new jt;var t=[];if(e=Ze(e),!Oa(e))return t;e=this.g.parse(e);var n=e.$c(),i=e.Pd();switch(e=[],n.video){case"avc":e.push(6);break;case"hvc":e.push(39),e.push(40)}if(!e.length)return t;for(n=x(i),i=n.next();!i.done;i=n.next())if(i=i.value,e.includes(i.type)&&i.time!=null)for(var s=x(dv(i.data)),l=s.next();!l.done;l=s.next())t.push({packet:l.value,pts:i.time});return t},he("shaka.cea.TsCeaParser",Ef),Hi["video/mp2t"]=function(){return new Ef};function pv(e,t,n){var i=ck(e),s=null;e=[];var l=[],u=null,c=new Set(i.map(function(g){return g.keyId}));c.delete(null);var d="cenc";if(1<c.size)throw new K(2,4,4010);if(!t){if(l=i.filter(function(g){return g.Pc=="urn:mpeg:dash:sea:2012"}),1<l.length)throw new K(2,4,4050);l.length&&(u=dk(l[0])),(l=i.find(function(g){return g.Pc=="urn:mpeg:dash:mp4protection:2011"}))&&l.encryptionScheme&&(d=l.encryptionScheme),l=i.filter(function(g){return g.Pc=="urn:mpeg:dash:mp4protection:2011"?(s=g.init||s,!1):g.Pc!="urn:mpeg:dash:sea:2012"}),l.length&&(e=fk(s,d,l,n,c),e.length==0&&(e=[Cr("",d,s)]))}if(i.length&&!u&&(t||!l.length))for(e=[],t=x(Object.values(n)),n=t.next();!n.done;n=t.next())n=n.value,n!="org.w3.clearkey"&&e.push(Cr(n,d,s));if(c=Array.from(c)[0]||null)for(d=x(e),t=d.next();!t.done;t=d.next())for(t=x(t.value.initData),n=t.next();!n.done;n=t.next())n.value.keyId=c;return{pg:c,dk:s,drmInfos:e,Fe:u,tg:!0}}function ak(e,t,n,i){var s=pv(e,n,i);if(t.tg)e=t.drmInfos.length==1&&!t.drmInfos[0].keySystem,n=s.drmInfos.length==0,(t.drmInfos.length==0||e&&!n)&&(t.drmInfos=s.drmInfos),t.tg=!1;else if(0<s.drmInfos.length&&(t.drmInfos=t.drmInfos.filter(function(l){return s.drmInfos.some(function(u){return u.keySystem==l.keySystem})}),t.drmInfos.length==0))throw new K(2,4,4008);return s.pg||t.pg}function lk(e){var t=0,n=xn(e),i=n.getUint32(t,!0);if(i!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){i=n.getUint16(e,!0),e+=2;var s=n.getUint16(e,!0);if(e+=2,s&1||s+e>n.byteLength){n=[];break e}var l=Ze(n,e,s);t.push({type:i,value:l}),e+=s}n=t}return n}function uk(e){e=x(Bi(e,"DATA"));for(var t=e.next();!t.done;t=e.next())if(t=t.value,t.children){t=x(t.children);for(var n=t.next();!n.done;n=t.next())if(n=n.value,n.tagName=="LA_URL")return un(n)}return""}function Af(e){var t=Ao(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=un(t))?t:(e=Ao(e.node,"urn:microsoft:playready","pro"),!e||!un(e)||(e=un(e),e=Ti(e),e=lk(e).filter(function(n){return n.type===pk})[0],!e)?"":(e=xo(e.value,!0),(e=ls(e,"WRMHEADER"))?uk(e):""))}function fk(e,t,n,i,s){var l=[];n=x(n);for(var u=n.next();!u.done;u=n.next()){u=u.value;var c=i[u.Pc];if(c){var d;if((d=Ao(u.node,"urn:microsoft:playready","pro"))&&un(d)){d=un(d),d=Ti(d);var g=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);d=[{initData:Cu(d,g,new Set,0),initDataType:"cenc",keyId:u.keyId}]}else d=null;if(g=null,u.Pc==="urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"){g=u;var y=s;if(y.size==0)g=null;else{var w=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),C=new Uint8Array([]);g=[{initData:Cu(C,w,y,1),initDataType:"cenc",keyId:g.keyId}]}}d=Cr(c,t,u.init||e||d||g),(c=gk.get(c))&&(d.licenseServerUri=c(u)),l.push(d)}}return l}function ck(e){var t=[];e=x(e);for(var n=e.next();!n.done;n=e.next())(n=hk(n.value))&&t.push(n);return t}function hk(e){var t=e.attributes.schemeIdUri,n=ko(e,"urn:mpeg:cenc:2013","default_KID"),i=Sm(e,"urn:mpeg:cenc:2013","pssh").map(Ui),s=e.attributes.value;if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase(),n.includes(" ")))throw new K(2,4,4009);var l=[];try{l=i.map(function(u){return{initDataType:"cenc",initData:Ti(u),keyId:null}})}catch{throw new K(2,4,4007)}return{node:e,Pc:t,keyId:n,init:0<l.length?l:null,encryptionScheme:s}}function dk(e){if(!p.crypto||!p.crypto.subtle)throw Fe("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new K(2,4,4042);var t=Ao(e.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!t)throw new K(2,4,4051);if(t.attributes.schemeIdUri!="urn:mpeg:dash:sea:aes128-cbc:2013")throw new K(2,4,4051);if(t=Ao(e.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod"),!t)throw new K(2,4,4051);if(e=t.attributes.IV,t=$n(t.attributes.keyUriTemplate),!e||!t)throw new K(2,4,4051);if(e=Tr(e.substr(2)),e.byteLength!=16)throw new K(2,4,4048);return{ti:t,iv:e}}var pk=1,gk=new Map().set("com.widevine.alpha",function(e){var t=Ao(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=un(t))?t:(e=Ao(e.node,"urn:microsoft","laurl"))&&$n(e.attributes.licenseUrl)||""}).set("com.microsoft.playready",Af).set("com.microsoft.playready.recommendation",Af).set("com.microsoft.playready.software",Af).set("com.microsoft.playready.hardware",Af).set("org.w3.clearkey",function(e){var t=Ao(e.node,"https://dashif.org/CPS","Laurl");return t&&(t=un(t))?t:(e=Ao(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&e.attributes.Lic_type==="EME-1.0"&&e&&(e=un(e))?e:""});function kf(e,t,n,i,s,l){var u={RepresentationID:t,Number:n,SubNumber:i,Bandwidth:s,Time:l};return e.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(c,d,g,y){if(c=="$$")return"$";var w=u[d];if(w==null)return c;switch(d=="RepresentationID"&&g&&(g=void 0),d=="Time"&&typeof w!="bigint"&&(.2<=Math.abs(w-Math.round(w))&&Fe("Calculated $Time$ values must be close to integers"),w=Math.round(w)),y){case void 0:case"d":case"i":case"u":c=w.toString();break;case"o":c=w.toString(8);break;case"x":c=w.toString(16);break;case"X":c=w.toString(16).toUpperCase();break;default:c=w.toString()}return g=p.parseInt(g,10)||1,Array(Math.max(0,g-c.length)+1).join("0")+c})}function gv(e,t){var n=Ji(e,t,"timescale"),i=1;n&&(i=bo(n)||1),n=Ji(e,t,"duration"),(n=bo(n||""))&&(n/=i);var s=Ji(e,t,"startNumber"),l=Number(Ji(e,t,"presentationTimeOffset"))||0,u=Ln(s||"");if((s==null||u==null)&&(u=1),s=null,t=Ls(e,t,"SegmentTimeline")){t=Bt(t,"S"),s=i,e=e.ka.duration||1/0;for(var c=u,d=[],g=-l,y=0;y<t.length;++y){var w=t[y],C=t[y+1],T=yt(w,"t",Ln),A=yt(w,"d",Ln),b=yt(w,"r",ku);if(w=yt(w,"k",ku)||0,T!=null&&(T-=l),A){if(T=T??g,b=b||0,0>b)if(C){if(C=yt(C,"t",Ln),C==null)break;if(T>=C)break;b=Math.ceil((C-T)/A)-1}else{if(e==1/0)break;if(T/s>=e)break;b=Math.ceil((e*s-T)/A)-1}for(0<d.length&&T!=g&&(d[d.length-1].end=T/s),C=0;C<=b;++C)g=T+A,d.push({start:T/s,end:g/s,$f:T,zb:w,Si:d.length+c}),T=g}}s=d}return{timescale:i,La:n,vd:u,Nb:l/i||0,Zf:l,timeline:s}}function mv(e,t){return[t(e.J),t(e.ja),t(e.ta)].filter(Ar)}function Ji(e,t,n){t=mv(e,t),e=null,t=x(t);for(var i=t.next();!i.done&&!(e=i.value.attributes[n]);i=t.next());return e}function Ls(e,t,n){t=mv(e,t),e=null,t=x(t);for(var i=t.next();!i.done&&!(e=ji(i.value,n));i=t.next());return e}function mk(e,t,n,i,s,l){for(var u=ko(e,"http://www.w3.org/1999/xlink","href"),c=ko(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",d=x(Object.keys(e.attributes)),g=d.next();!g.done;g=d.next()){g=g.value;var y=g.split(":"),w=Fh("http://www.w3.org/1999/xlink");y[0]==w&&delete e.attributes[g]}if(5<=l)return br(new K(2,4,4028));if(c!="onLoad")return br(new K(2,4,4027));var C=Cn([i],[u]);return s.request(0,dn(C,t)).Aa(function(T){if(T=jh(T.data,e.tagName),!T)return br(new K(2,4,4001,u));for(e.children=[];T.children.length;){var A=T.children.shift();A.tagName&&(A.parent=e),e.children.push(A)}A=x(Object.keys(T.attributes));for(var b=A.next();!b.done;b=A.next())b=b.value,e.attributes[b]=T.attributes[b];return bf(e,t,n,C[0],s,l+1)})}function bf(e,t,n,i,s,l){if(l=l===void 0?0:l,ko(e,"http://www.w3.org/1999/xlink","href")){var u=mk(e,t,n,i,s,l);return n&&(u=u.Aa(void 0,function(){return bf(e,t,n,i,s,l)})),u}u=[];for(var c=x(wm(e)),d=c.next(),g={};!d.done;g={Uc:void 0},d=c.next())g.Uc=d.value,ko(g.Uc,"http://www.w3.org/1999/xlink","href")=="urn:mpeg:dash:resolve-to-zero:2013"?e.children=e.children.filter(function(y){return function(w){return w!==y.Uc}}(g)):g.Uc.tagName!="SegmentTimeline"&&u.push(bf(g.Uc,t,n,i,s,l));return um(u).Aa(function(){return e})}function yk(e,t,n,i,s,l,u){var c,d=new Ot().S("sidx",function(g){c=vk(t,i,s,l,u,n,g)});if(e&&d.parse(e),c)return c;throw new K(2,3,3004)}function vk(e,t,n,i,s,l,u){var c=[];u.reader.skip(4);var d=u.reader.P();if(d==0)throw new K(2,3,3005);if(u.version==0)var g=u.reader.P(),y=u.reader.P();else g=u.reader.Nc(),y=u.reader.Nc();u.reader.skip(2);var w=u.reader.la();for(e=e+u.size+y,y=0;y<w;y++){var C=u.reader.P(),T=(C&2147483648)>>>31;C&=2147483647;var A=u.reader.P();if(u.reader.skip(4),T==1)throw new K(2,3,3006);c.push(new Je(g/d+n,(g+A)/d+n,function(){return l},e,e+C-1,t,n,i,s)),g+=A,e+=C}return u.parser.stop(),c}function Jo(e){this.h=xn(e),this.g=new Nt(this.h,0)}Jo.prototype.na=function(){return this.g.na()};function Oo(e){var t=yv(e);if(7<t.length)throw new K(2,3,3002);var n=0;t=x(t);for(var i=t.next();!i.done;i=t.next())n=256*n+i.value;t=yv(e);e:{i=x(xk);for(var s=i.next();!s.done;s=i.next())if(Zt(t,new Uint8Array(s.value))){i=!0;break e}i=!1}if(i)t=e.h.byteLength-e.g.va();else{if(t.length==8&&t[1]&224)throw new K(2,3,3001);for(s=i=0;s<t.length;s++){var l=t[s];i=s==0?l&(1<<8-t.length)-1:256*i+l}t=i}return t=e.g.va()+t<=e.h.byteLength?t:e.h.byteLength-e.g.va(),i=xn(e.h,e.g.va(),t),e.g.skip(t),new wk(n,i)}function yv(e){var t=e.g.va(),n=e.g.T();if(n==0)throw new K(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),Ze(e.h,t,n)}var xk=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function wk(e,t){this.id=e,this.g=t}function ap(e){if(8<e.g.byteLength)throw new K(2,3,3002);if(e.g.byteLength==8&&e.g.getUint8(0)&224)throw new K(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++){var i=e.g.getUint8(n);t=256*t+i}return t}function Sk(e,t,n,i,s,l,u,c,d){function g(){return s}var y=[];e=new Jo(e.g);for(var w=null,C=null;e.na();){var T=Oo(e);if(T.id==187){var A=Tk(T);A&&(T=n*A.dj,A=t+A.Ii,w!=null&&y.push(new Je(w+u,T+u,g,C,A-1,l,u,c,d)),w=T,C=A)}}return w!=null&&y.push(new Je(w+u,i+u,g,C,null,l,u,c,d)),y}function Tk(e){var t=new Jo(e.g);if(e=Oo(t),e.id!=179)throw new K(2,3,3013);if(e=ap(e),t=Oo(t),t.id!=183)throw new K(2,3,3012);t=new Jo(t.g);for(var n=0;t.na();){var i=Oo(t);if(i.id==241){n=ap(i);break}}return{dj:e,Ii:n}}function vv(e,t,n){if(t=Ls(e,t,"Initialization"),!t)return null;var i=e.J.Ga(),s=t.attributes.sourceURL;s&&(i=Cn(i,[$n(s)])),s=0;var l=null;return(t=yt(t,"range",Au))&&(s=t.start,l=t.end),n=new Kn(function(){return i},s,l,Tv(e),null,null,n),n.codecs=e.J.codecs,n.mimeType=e.J.mimeType,n}function Ck(e,t,n){var i=Number(Ji(e,Ps,"presentationTimeOffset"))||0,s=Ji(e,Ps,"timescale"),l=1;s&&(l=bo(s)||1);var u=i/l||0,c=vv(e,Ps,n);Ek(e,c);var d=Rh(e);return{fc:function(){var g=Ls(d,Ps,"RepresentationIndex"),y=d.J.Ga();return g&&(g=$n(g.attributes.sourceURL))&&(y=Cn(y,[g])),g=wv(d),xv(d,t,c,y,g.start,g.end,u)}}}function xv(e,t,n,i,s,l,u){var c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J;return $(function(fe){if(fe.g==1)return c=e.presentationTimeline,d=!e.vb||!e.ka.ld,g=e.ka.start,y=e.ka.duration,w=e.J.mimeType.split("/")[1],C=t,T=null,A=[C(i,s,l,!1),w=="webm"?C(n.M(),n.Ha,n.sa,!0):null],C=null,E(fe,Promise.all(A),2);if(b=fe.h,k=b[0],O=b[1]||null,D=null,z=g-u,P=g,B=y?g+y:1/0,w=="mp4")var te=yk(k,s,i,n,z,P,B);else{te=k;var ne=new Jo(O);if(Oo(ne).id!=440786851)throw new K(2,3,3008);var oe=Oo(ne);if(oe.id!=408125543)throw new K(2,3,3009);ne=oe.g.byteOffset,oe=new Jo(oe.g);for(var xe=null;oe.na();){var pe=Oo(oe);if(pe.id==357149030){xe=pe;break}}if(!xe)throw new K(2,3,3010);for(xe=new Jo(xe.g),pe=1e6,oe=null;xe.na();){var we=Oo(xe);if(we.id==2807729)pe=ap(we);else if(we.id==17545)if(we.g.byteLength==4)oe=we.g.getFloat32(0);else if(we.g.byteLength==8)oe=we.g.getFloat64(0);else throw new K(2,3,3003)}if(oe==null)throw new K(2,3,3011);if(xe=pe/1e9,oe*=xe,te=Oo(new Jo(te)),te.id!=475249515)throw new K(2,3,3007);te=Sk(te,ne,xe,oe,i,n,z,P,B)}for(D=te,G=x(D),q=G.next();!q.done;q=G.next())J=q.value,J.codecs=e.J.codecs,J.mimeType=e.J.mimeType;return c.sd(D),T=new xt(D),d&&T.Bc(P,B,!0),fe.return(T)})}function Ps(e){return e.Rc}function wv(e){var t=Ls(e,Ps,"RepresentationIndex");return e=Ji(e,Ps,"indexRange"),e=Au(e||""),t&&(e=yt(t,"range",Au,e)),e}function Ek(e,t){if(Sv(e,t),!wv(e))throw new K(2,4,4002)}function Sv(e,t){var n=e.J.mimeType.split("/")[1];if(e.J.contentType!=mt&&n!="mp4"&&n!="webm")throw new K(2,4,4006);if(n=="webm"&&!t)throw new K(2,4,4005)}function Tv(e){var t=e.J;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.Jc,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null,label:e.ja.label||null,roles:e.roles||null,language:e.ja.language||null}}function Ak(e,t,n){var i=vv(e,Cv,n),s=kk(e);if(!s.La&&!s.timeline&&1<s.Ic.length)throw new K(2,4,4002);if(!s.La&&!e.ka.duration&&!s.timeline&&s.Ic.length==1)throw new K(2,4,4002);if(s.timeline&&s.timeline.length==0)throw new K(2,4,4002);var l=null,u=null;e.ta.id&&e.J.id&&(u=t[e.ta.id+","+e.J.id])&&(l=u.segmentIndex);var c=bk(e.ka.start,e.ka.duration,e.J.Ga,s,i,n,e.J.mimeType,e.J.codecs);return t=!l,l?l.rd(c,e.presentationTimeline.mb()):l=new xt(c),e.presentationTimeline.sd(c),e.vb&&e.ka.ld||l.Bc(e.ka.start,e.ka.duration?e.ka.start+e.ka.duration:1/0,t),u&&(u.segmentIndex=l),{fc:function(){return l&&l.getNumReferences()!=0||l.Zd(c),Promise.resolve(l)}}}function Cv(e){return e.Pb}function kk(e){var t=Ik(e);e=gv(e,Cv);var n=e.vd;n==0&&(n=1);var i=0;return e.La?i=e.La*(n-1):e.timeline&&0<e.timeline.length&&(i=e.timeline[0].start),{La:e.La,startTime:i,vd:n,Nb:e.Nb,timeline:e.timeline,Ic:t}}function bk(e,t,n,i,s,l,u,c){var d=i.Ic.length;i.timeline&&i.timeline.length!=i.Ic.length&&(d=Math.min(i.timeline.length,i.Ic.length));for(var g=e-i.Nb,y=t?e+t:1/0,w=[],C=i.startTime,T={},A=0;A<d;T={ve:void 0,oe:void 0},A++){T.oe=i.Ic[A];var b=C;C=void 0,C=i.La!=null?b+i.La:i.timeline?i.timeline[A].end:b+t,T.ve=null,T=new Je(e+b,e+C,function(k){return function(){return k.ve==null&&(k.ve=Cn(n(),[k.oe.zi])),k.ve}}(T),T.oe.start,T.oe.end,s,g,e,y,[],"",null,null,Yo,l),T.codecs=c,T.mimeType=u,w.push(T)}return w}function Ik(e){return[e.J.Pb,e.ja.Pb,e.ta.Pb].filter(Ar).map(function(t){return Bt(t,"SegmentURL")}).reduce(function(t,n){return 0<t.length?t:n}).map(function(t){t.attributes.indexRange&&!e.lf&&(e.lf=!0);var n=$n(t.attributes.media);return t=yt(t,"mediaRange",Au,{start:0,end:null}),{zi:n,start:t.start,end:t.end}})}function Ev(e,t,n,i,s,l,u,c,d){d||e.J.Gc||(e.J.Gc=Ji(e,Or,"initialization"));var g=e.J.Gc?Lk(e,u):null,y=Mk(e);Rk(y);var w=Rh(e);if(y.jd)return Sv(e,g),{fc:function(){var k=kf(y.jd,w.J.id,null,null,w.bandwidth||null,null);return k=Cn(w.J.Ga(),[k]),xv(w,t,g,k,0,null,y.Nb)}};if(y.La)return i||e.ja.contentType==="image"||(e.presentationTimeline.xf(y.La),e.presentationTimeline.ce(e.ka.start)),{fc:function(){return _k(w,y,s,g,l,u,c)}};var C=null;i=i=null,e.ta.id&&e.J.id&&(i=e.ta.id+","+e.J.id,i=n[i])&&(C=i.segmentIndex);var T=e.ka.start,A=e.ka.duration?T+e.ka.duration:1/0,b=!(e.vb&&e.ka.ld);return C?(n=C,Av(n,y,T,A,b,g),n.Ma(e.presentationTimeline.mb())):C=new If(y,e.J.id,e.bandwidth,e.J.Ga,T,A,g,b,u,e.J.Kf),y.timeline&&e.ja.contentType!=="image"&&e.presentationTimeline.Ng(y.timeline,T),i&&e.vb&&(i.segmentIndex=C),{fc:function(){return C instanceof If&&C.getNumReferences()==0&&Av(C,y,T,A,b,g),Promise.resolve(C)}}}function Or(e){return e.$b}function Mk(e){var t=gv(e,Or),n=Ji(e,Or,"media"),i=Ji(e,Or,"index");return{La:t.La,timescale:t.timescale,vd:t.vd,Nb:t.Nb,Zf:t.Zf,timeline:t.timeline,Zb:n&&$n(n),jd:i,mimeType:e.J.mimeType,codecs:e.J.codecs}}function Rk(e){var t=e.jd?1:0;if(t+=e.timeline?1:0,t+=e.La?1:0,t==0)throw new K(2,4,4002);if(t!=1&&(e.jd&&(e.timeline=null),e.La=null),!e.jd&&!e.Zb)throw new K(2,4,4002)}function _k(e,t,n,i,s,l,u){function c(ne){var oe=(ne-b)*A,xe=oe+t.Nb,pe=oe+w;oe=pe+A;var we=Math.min(oe,g());return pe=new Je(pe,we,function(){var Me=xe*k;return"BigInt"in p&&Me>Number.MAX_SAFE_INTEGER&&(Me=BigInt(xe)*BigInt(k)),Me=kf(O,z,ne,null,D,Me),Cn(P(),[Me])},0,null,i,B,w,g(),[],"",null,null,Yo,l),pe.codecs=e.J.codecs,pe.mimeType=e.J.mimeType,pe.j=oe,pe}function d(){var ne=[Math.max(y.mb(),w),Math.min(y.Wb(),g())].map(function(oe){return oe-w});return ne=[Math.ceil(ne[0]/A),Math.ceil(ne[1]/A)-1],e.J.Ia&&ne[1]++,ne.map(function(oe){return oe+b})}function g(){var ne=C!=null&&s[C]||T;return ne?w+ne:1/0}var y=e.presentationTimeline,w=e.ka.start,C=e.ta.id,T=e.ka.duration,A=t.La,b=t.vd,k=t.timescale,O=t.Zb,D=e.bandwidth||null,z=e.J.id,P=e.J.Ga,B=w-t.Nb,G=d();n=e.vb?Math.max(G[0],G[1]-n+1):G[0],u=u||G[1],G=[];for(var q=n;q<=u;++q){var J=c(q);G.push(J)}var fe=new xt(G);if(G=y.Wb()<g(),q=y.V(),G||q){var te=Math.max(n,u+1);n=A,e.J.Ia&&(n=.1),fe.ue(n,function(){var ne=y.mb();fe.Ma(ne);var oe=x(d());oe.next(),oe=oe.next().value;for(var xe=[];te<=oe;){var pe=c(te);xe.push(pe),te++}return ne>g()&&!xe.length?null:xe})}return Promise.resolve(fe)}function Lk(e,t){var n=e.J.Gc;if(n||(n=Ji(e,Or,"initialization")),!n)return null;n=$n(n);var i=e.J.id,s=e.bandwidth||null,l=e.J.Ga;return t=new Kn(function(){var u=kf(n,i,null,null,s,null);return Cn(l(),[u])},0,null,Tv(e),null,null,t),t.codecs=e.J.codecs,t.mimeType=e.J.mimeType,t}function If(e,t,n,i,s,l,u,c,d,g){xt.call(this,[]),this.g=e,this.C=t,this.A=n,this.B=i,this.h=s,this.j=l,this.o=u,this.s=d,this.F=g,c&&kv(this)}le(If,xt),a=If.prototype,a.getNumReferences=function(){return this.g?this.g.timeline.length:0},a.release=function(){xt.prototype.release.call(this),this.g=null},a.Ma=function(e){if(this.g){for(var t=0,n=this.g.timeline,i=0;i<n.length&&n[i].end+this.h<=e;i+=1)t+=1;0<t&&(this.g.timeline=n.slice(t),this.O.length>=t&&(this.O=this.O.slice(t)),this.i+=t,this.getNumReferences()===0&&this.release())}};function Av(e,t,n,i,s,l){if(Pk(e,l),e.g){if(n=e.g.timeline,e.g.Zb!==t.Zb&&(e.g.Zb=t.Zb),n.length){var u=n[n.length-1];t=t.timeline.filter(function(c){return c.start>=u.end})}else t=t.timeline.slice();0<t.length&&e.g.timeline.push.apply(e.g.timeline,L(t)),e.j!==i&&(e.j=i)}else e.g=t,e.h=n,e.j=i;s&&kv(e)}function Pk(e,t){if(e.o!==t){e.o=t,e=x(e.O);for(var n=e.next();!n.done;n=e.next())(n=n.value)&&zm(n,t)}}function kv(e){if(!e.m){for(var t=e.g.timeline;t.length&&t[t.length-1].start>=e.j;)t.pop();e.Ma(e.h)}}a.find=function(e){if(this.g&&this.g.timeline&&this.g.timeline.length&&e<this.g.timeline[0].start+this.h)return this.i;if(!this.g)return null;var t=this.g.timeline;if(e<this.h||e>=this.j)return null;for(var n=t.length-1,i=0;i<t.length;i++){var s=t[i],l=s.start+this.h;if(s=i<n?t[i+1].start+this.h:this.j===1/0?s.end+this.h:this.j,e>=l&&e<s)return i+this.i}return null},a.get=function(e){var t=this;if(e-=this.i,0>e||e>=this.getNumReferences()||!this.g)return null;var n=this.O[e];if(!n){var i=this.g.timeline[e],s=i.Si,l=this.g.Zf+i.$f;n=this.h-this.g.Nb;var u=this.h+i.end,c=u;e===this.getNumReferences()-1&&this.j!==1/0&&(c=this.j);for(var d=this.g.codecs,g=this.g.mimeType,y=[],w=(i.end-i.start)/i.zb,C={},T=0;T<i.zb;C={we:void 0,kh:void 0},T++){var A=i.start+w*T,b=A+w;C.kh=T+1,C.we=null,C=new Je(this.h+A,this.h+b,function(k){return function(){return t.g?(k.we==null&&(k.we=bv(t.g.Zb,t.C,s,t.A,l,k.kh,t.B)),k.we):[]}}(C),0,null,this.o,n,this.h,this.j,[],"",null,null,Yo,this.s),C.codecs=d,C.mimeType=g,this.F==0?0<T&&C.Xd():T%this.F!=0&&C.Xd(),y.push(C)}n=new Je(this.h+i.start,c,function(){return 0<i.zb||!t.g?[]:bv(t.g.Zb,t.C,s,t.A,l,null,t.B)},0,null,this.o,n,this.h,this.j,y,"",null,null,Yo,this.s,0<i.zb),n.codecs=d,n.mimeType=g,n.j=u,this.O[e]=n}return n};function bv(e,t,n,i,s,l,u){return e=kf(e,t,n,l,i||null,s),Cn(u(),[e]).map(function(c){return c.toString()})}function Ds(e){this.o=null,this.A=e,this.G=new os,this.i=[],this.h=null,this.m=[],this.B=null,this.F=[],this.C=300,this.l=new Map,this.j=new Map,this.g=null,this.s="UNKNOWN"}Ds.prototype.configure=function(e){this.o=e},Ds.prototype.destroy=function(){return this.A=this.o=null,this.i=[],this.h=null,this.m=[],this.F=[],this.l.clear(),this.g!=null&&(this.g.stop(),this.g=null),this.G.destroy()},Ds.prototype.setManifestType=function(e){this.s=e};function rl(e,t){var n,i,s,l,u,c,d;return $(function(g){if(g.g==1)return n=Cn(e.i,[Dk(e,t)]),i=dn(n,e.o.retryParameters),s=e.A.networkingEngine.request(8,i),Ir(e.G,s),ue(g,2),E(g,s.promise,4);if(g.g!=2)return l=g.h,u=Vt(l.data),c=JSON.parse(u),c.VERSION==1&&Nk(e,c,l.uri),ge(g,0);if((d=ie(g))&&d.code==7001)return g.return();e.g!=null&&(e.g.stop(),e.g=null),e.g=new ct(function(){rl(e,t)}),e.g.Y(e.C),F(g)})}function Dk(e,t){if(!e.m.length)return t;t=new tn(t);var n=e.B||e.m[0],i=Math.round(e.A.getBandwidthEstimate()),s=t.g;return e.s=="DASH"?(s.add("_DASH_pathway",n),s.add("_DASH_throughput",String(i))):e.s=="HLS"&&(s.add("_HLS_pathway",n),s.add("_HLS_throughput",String(i))),kg(s)&&ma(t,s),t.toString()}function Nk(e,t,n){e.g!=null&&(e.g.stop(),e.g=null);var i=t["RELOAD-URI"]||n;e.g=new ct(function(){rl(e,i)}),(n=t.TTL)&&(e.C=n),e.g.Y(e.C),e.m=t["PATHWAY-PRIORITY"]||[],e.F=t["PATHWAY-CLONES"]||[]}function Ns(e,t,n,i){var s=e.l.get(t);s||(s=new Map),s.set(n,i),e.l.set(t,s)}Ds.prototype.banLocation=function(e){this.j.set(e,Date.now()+6e4)};function sl(e,t,n){n=n===void 0?!1:n,t=e.l.get(t)||new Map;for(var i=[],s=x(e.m),l=s.next(),u={};!l.done;u={Lc:void 0},l=s.next())if(u.Lc=l.value,l=t.get(u.Lc))i.push({Df:u.Lc,location:l});else if(l=e.F.find(function(d){return function(g){return g.wj==d.Lc}}(u))){var c=t.get(l["BASE-ID"]);c&&(l["URI-REPLACEMENT"].rh?(c=new tn(c),nu(c,l["URI-REPLACEMENT"].rh),i.push({Df:u.Lc,location:c.toString()})):i.push({Df:u.Lc,location:c}))}for(s=Date.now(),u=x(e.j.keys()),l=u.next();!l.done;l=u.next())l=l.value,c=e.j.get(l),s>c&&e.j.delete(l);if(i=i.filter(function(d){for(var g=x(e.j.keys()),y=g.next();!y.done;y=g.next())if(y.value.includes(new tn(d.location).Eb))return!1;return!0}),i.length&&(e.B=i[0].Df),i=i.map(function(d){return d.location}),!i.length&&e.h)for(s=x(e.h.split(",")),u=s.next();!u.done;u=s.next())(u=t.get(u.value))&&(e.B=e.h,i.push(u));if(!i.length)for(t=x(t.values()),s=t.next();!s.done;s=t.next())i.push(s.value);return n?i:Cn(e.i,i)}function Gn(){this.j=[],this.h=[],this.g=[],this.l=[],this.i=[],this.s=this.o=!1,this.m=new Set}a=Gn.prototype,a.release=function(){for(var e=x(this.h.concat(this.g,this.l,this.i)),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();this.h=[],this.g=[],this.l=[],this.i=[],this.j=[]},a.ei=function(){return this.j},a.jf=function(){return this.l.slice()},a.Nh=function(){return this.i};function Iv(e,t){var n=[],i=[],s=[],l=[];e=x(e);for(var u=e.next();!u.done;u=e.next()){var c=u.value;u=new Map(c.audioStreams.map(function(w){return[cp(w),w]}));var d=new Map(c.videoStreams.map(function(w){return[fp(w),w]})),g=new Map(c.textStreams.map(function(w){return[fl(w),w]}));if(c=new Map(c.imageStreams.map(function(w){return[cl(w),w]})),t){var y=Dv(mt);g.set(fl(y),y),y=Dv("image"),c.set(cl(y),y)}n.push(u),i.push(d),s.push(g),l.push(c)}return{jg:n,ph:i,lh:s,Eg:l}}a.Ke=function(e,t,n){n=n===void 0?!1:n;var i=this,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne,oe,xe,pe,we,Me,Te;return $(function(Ne){if(Ne.g==1){if(s=sn,!t&&e.length==1)return l=Iv(e,!1),u=l.jg,c=l.ph,d=l.lh,g=l.Eg,i.h=Array.from(u[0].values()),i.g=Array.from(c[0].values()),i.l=Array.from(d[0].values()),i.i=Array.from(g[0].values()),Ne.u(2);for(y=n?i.m.size:0,w=-1,C=0;C<e.length;C++)T=e[C],i.m.has(T.id)||(i.m.add(T.id),w==-1&&(w=C));return w==-1?Ne.return():(A=Iv(e,!0),b=A.jg,k=A.ph,O=A.lh,D=A.Eg,E(Ne,Promise.all([er(i,i.h,b,w,al,Os,y),er(i,i.g,k,w,al,Os,y),er(i,i.l,O,w,al,Os,y),er(i,i.i,D,w,al,Os,y)]),2))}if(z=0,P=[],i.g.length&&i.h.length)for(te=x(i.h),ne=te.next();!ne.done;ne=te.next())for(oe=ne.value,xe=x(i.g),pe=xe.next();!pe.done;pe=xe.next())we=pe.value,Me=yh(oe.drmInfos,we.drmInfos),oe.drmInfos.length&&we.drmInfos.length&&!Me.length||(Te=z++,P.push({id:Te,language:oe.language,disabledUntilTime:0,primary:oe.primary,audio:oe,video:we,bandwidth:(oe.bandwidth||0)+(we.bandwidth||0),drmInfos:Me,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(B=i.g.length?i.g:i.h,G=x(B),q=G.next();!q.done;q=G.next())J=q.value,fe=z++,P.push({id:fe,language:J.language,disabledUntilTime:0,primary:J.primary,audio:J.type==s.X?J:null,video:J.type==s.ga?J:null,bandwidth:J.bandwidth||0,drmInfos:J.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});i.j=P,F(Ne)})};function Mv(e){var t,n,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne,oe,xe,pe;return $(function(we){switch(we.g){case 1:if(t=sn,e.length==1)return we.return(e[0]);for(n=e.map(function(Me){return new Map(Me.filter(function(Te){return Te.type===t.X}).map(function(Te){return[cp(Te),Te]}))}),i=e.map(function(Me){return new Map(Me.filter(function(Te){return Te.type===t.ga}).map(function(Te){return[fp(Te),Te]}))}),s=e.map(function(Me){return new Map(Me.filter(function(Te){return Te.type===t.ua}).map(function(Te){return[fl(Te),Te]}))}),l=e.map(function(Me){return new Map(Me.filter(function(Te){return Te.type===t.De}).map(function(Te){return[cl(Te),Te]}))}),u=x(s),c=u.next();!c.done;c=u.next())d=c.value,g=Pv(t.ua),d.set(fl(g),g);for(y=x(l),w=y.next();!w.done;w=y.next())C=w.value,T=Pv(t.De),C.set(cl(T),T);return A=new Gn,E(we,er(A,[],n,0,Mf,Rf,0),2);case 2:return b=we.h,E(we,er(A,[],i,0,Mf,Rf,0),3);case 3:return k=we.h,E(we,er(A,[],s,0,Mf,Rf,0),4);case 4:return O=we.h,E(we,er(A,[],l,0,Mf,Rf,0),5);case 5:if(D=we.h,z=0,k.length&&b.length)for(J=x(b),fe=J.next();!fe.done;fe=J.next())for(te=fe.value,ne=x(k),oe=ne.next();!oe.done;oe=ne.next())xe=oe.value,pe=z++,xe.variantIds.push(pe),te.variantIds.push(pe);else for(P=k.concat(b),B=x(P),G=B.next();!G.done;G=B.next())q=G.value,q.variantIds=[z++];return we.return(k.concat(b).concat(O).concat(D))}})}function er(e,t,n,i,s,l,u){var c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe;return $(function(te){switch(te.g){case 1:for(c=[],d=0;d<n.length;d++)d>=i?c.push(new Set(n[d].values())):c.push(new Set);g=x(t),y=g.next();case 2:if(y.done){te.u(4);break}return w=y.value,E(te,Ok(e,w,n,i,l,c,u),5);case 5:if(C=te.h,!C)throw new K(2,4,4037);y=g.next(),te.u(2);break;case 4:for(T=x(c),A=T.next();!A.done;A=T.next())for(b=A.value,k=x(b),O=k.next();!O.done;O=k.next())D=O.value,(z=Uk(e,D,n,s,l,c))&&t.push(z);for(P=x(c),B=P.next();!B.done;B=P.next())for(G=B.value,q=x(G),J=q.next(),fe={};!J.done;fe={Tf:void 0},J=q.next())if(fe.Tf=J.value,!up(fe.Tf)&&t.some(function(ne){return function(oe){return lp(e,ne.Tf,oe)}}(fe)))throw new K(2,4,4037);return te.return(t)}})}function Ok(e,t,n,i,s,l,u){return $(function(c){return c.g==1?(Lv(e,n,t,0<u),t.matchedStreams?t.segmentIndex?E(c,Rv(t,i+u),2):c.u(2):c.return(!1)):(_v(t,i,s,l,u),c.return(!0))})}function Rv(e,t){var n,i,s,l,u,c,d;return $(function(g){if(g.g==1){for(n=[],i=e.matchedStreams,s=x(i),l=s.next();!l.done;l=s.next())u=l.value,n.push(u.createSegmentIndex()),u.trickModeVideo&&!u.trickModeVideo.segmentIndex&&n.push(u.trickModeVideo.createSegmentIndex());return E(g,Promise.all(n),2)}if(e.segmentIndex instanceof Jt)for(c=t;c<i.length;c++)d=i[c],d.segmentIndex&&e.segmentIndex.g.push(d.segmentIndex);F(g)})}function Uk(e,t,n,i,s,l){if(up(t))return null;var u=i(t);return Lv(e,n,u),u.createSegmentIndex&&(u.createSegmentIndex=function(){return $(function(c){return u.segmentIndex?c.u(0):(u.segmentIndex=new Jt,E(c,Rv(u,0),0))})}),!u.matchedStreams||!u.matchedStreams.length?null:(_v(u,0,s,l,0),u)}function _v(e,t,n,i,s){var l=e.matchedStreams;for(t+=s;t<l.length;t++){var u=l[t];n(e,u);var c=!0;if(e.type=="audio"&&kr(e.language,u.language)==0&&(c=!1),c&&(i[t-s].delete(u),u.fullMimeTypes))for(u=x(u.fullMimeTypes.values()),c=u.next();!c.done;c=u.next())e.fullMimeTypes.add(c.value)}}function al(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var n=x(t.matchedStreams),i=n.next();!i.done;i=n.next())i=i.value,i.segmentIndex&&(i.segmentIndex.release(),i.segmentIndex=null)},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set,t.closedCaptions=null,t.trickModeVideo=null,t}function Mf(e){return e=Object.assign({},e),e.roles=e.roles.slice(),e.keyIds=new Set,e.segments=[],e.variantIds=[],e.closedCaptions=null,e}function Os(e,t){function n(u,c){u||(u=[]),c=x(c);for(var d=c.next();!d.done;d=c.next())d=d.value,u.includes(d)||u.push(d);return u}e.roles=n(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=n(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var i=x(t.keyIds),s=i.next();!s.done;s=i.next())e.keyIds.add(s.value);if(e.originalId==null?e.originalId=t.originalId:e.originalId+=","+(t.originalId||""),i=yh(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!i.length)throw new K(2,4,4038);if(e.drmInfos=i,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),i=x(t.closedCaptions),s=i.next();!s.done;s=i.next()){var l=x(s.value);s=l.next().value,l=l.next().value,e.closedCaptions.set(s,l)}e.bandwidth&&t.bandwidth&&(e.bandwidth=Math.max(e.bandwidth,t.bandwidth)),t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=al(t.trickModeVideo),e.trickModeVideo.createSegmentIndex=function(){return e.trickModeVideo.segmentIndex=e.segmentIndex.clone(),Promise.resolve()}),Os(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&Os(e.trickModeVideo,t)}function Rf(e,t){var n=e.roles;n||(n=[]);for(var i=x(t.roles),s=i.next();!s.done;s=i.next())s=s.value,n.includes(s)||n.push(s);for(e.roles=n,n=x(t.keyIds),i=n.next();!i.done;i=n.next())e.keyIds.add(i.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,L(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),t=x(t.closedCaptions),n=t.next();!n.done;n=t.next())i=x(n.value),n=i.next().value,i=i.next().value,e.closedCaptions.set(n,i)}function Lv(e,t,n,i){i=i!==void 0&&i?n.matchedStreams:[],t=x(t);for(var s=t.next();!s.done;s=t.next()){if(s=Bk(e,s.value,n),!s)return;i.push(s)}n.matchedStreams=i}function Bk(e,t,n){var i={audio:cp,video:fp,text:fl,image:cl}[n.type],s=null,l=i(n);if(t.has(l))s=t.get(l);else{l={audio:function(g,y){return lp(e,g,y)},video:function(g,y){return lp(e,g,y)},text:jk,image:Fk}[n.type];for(var u={audio:$k,video:Vk,text:Hk,image:zk}[n.type],c=x(t.values()),d=c.next();!d.done;d=c.next())d=d.value,!l(n,d)||n.fastSwitching!=d.fastSwitching||s&&!u(n,s,d)||(s=d)}return e.s&&!up(s)&&t.delete(i(s)),s}function ll(e,t){return e.mimeType!=t.mimeType?!1:_f(e.codecs)===_f(t.codecs)}a.Zg=function(e){this.o=e},a.gh=function(e){this.s=e};function lp(e,t,n){return!(!ll(t,n)&&!e.o||t.drmInfos&&!bg(t.drmInfos,n.drmInfos))}function jk(e,t){return t.language?!(e.forced!==t.forced||kr(e.language,t.language)==0||t.kind!=e.kind):!0}function Fk(){return!0}function $k(e,t,n){var i=ll(e,t),s=ll(e,n);if(i&&!s)return!1;if(!i&&s||(i=kr(e.language,t.language),s=kr(e.language,n.language),s>i))return!0;if(s<i)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter(function(l){return e.roles.includes(l)}),s=n.roles.filter(function(l){return e.roles.includes(l)}),s.length>i.length)return!0;if(s.length<i.length)return!1;if(n.roles.length!==t.roles.length)return n.roles.length<t.roles.length}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!t.primary&&n.primary?!0:t.primary&&!n.primary?!1:(i=ul(e.channelsCount,t.channelsCount,n.channelsCount),i==eo?!0:i==Uo?!1:(i=ul(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate),i==eo?!0:i==Uo?!1:!!(e.bandwidth&&Nv(e.bandwidth,t.bandwidth,n.bandwidth)==eo)))}function Vk(e,t,n){var i=ll(e,t),s=ll(e,n);if(i&&!s)return!1;if(!i&&s||(i=ul(e.width*e.height,t.width*t.height,n.width*n.height),i==eo))return!0;if(i==Uo)return!1;if(e.frameRate){if(i=ul(e.frameRate,t.frameRate,n.frameRate),i==eo)return!0;if(i==Uo)return!1}return!!(e.bandwidth&&Nv(e.bandwidth,t.bandwidth,n.bandwidth)==eo)}function Hk(e,t,n){var i=kr(e.language,t.language),s=kr(e.language,n.language);if(s>i)return!0;if(s<i)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(t.label!==n.label){if(e.label===t.label)return!1;if(e.label===n.label)return!0}if(e.roles.length){if(i=t.roles.filter(function(l){return e.roles.includes(l)}),s=n.roles.filter(function(l){return e.roles.includes(l)}),s.length>i.length)return!0;if(s.length<i.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return!(n.mimeType!=e.mimeType||n.codecs!=e.codecs||t.mimeType==e.mimeType&&t.codecs==e.codecs)}function zk(e,t,n){return ul(e.width*e.height,t.width*t.height,n.width*n.height)==eo}function Pv(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1}}function Dv(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new xt([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set}}function ul(e,t,n){if(t==e&&e!=n)return Uo;if(n==e&&e!=t)return eo;if(t>e){if(n<=e||n-e<t-e)return eo;if(n-e>t-e)return Uo}else{if(n>e)return Uo;if(e-n<e-t)return eo;if(e-n>e-t)return Uo}return Ov}function Nv(e,t,n){return t=Math.abs(e-t),e=Math.abs(e-n),e<t?eo:t<e?Uo:Ov}function up(e){switch(e.type){case mt:return!e.language;case"image":return!e.tilesLayout;default:return!1}}function fp(e){return JSON.stringify([e.fastSwitching,e.width,e.frameRate,_f(e.codecs),e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth])}function cp(e){return JSON.stringify([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,_f(e.codecs),e.mimeType,e.roles,e.audioSamplingRate,e.primary])}function fl(e){return JSON.stringify([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])}function cl(e){return JSON.stringify([e.width,e.codecs,e.mimeType])}function _f(e){if(!hp.has(e)){var t=Vn(e);hp.set(e,t)}return hp.get(e)}he("shaka.util.PeriodCombiner",Gn),Gn.prototype.setUseStreamOnce=Gn.prototype.gh,Gn.prototype.setAllowMultiTypeVariants=Gn.prototype.Zg,Gn.prototype.combinePeriods=Gn.prototype.Ke,Gn.prototype.getImageStreams=Gn.prototype.Nh,Gn.prototype.getTextStreams=Gn.prototype.jf,Gn.prototype.getVariants=Gn.prototype.ei;var eo=1,Ov=0,Uo=-1,hp=new Map;function Gk(e,t){var n=new DOMParser,i=Xk.value()(e);e=null;try{e=n.parseFromString(i,"text/xml")}catch{return null}if(n=e.documentElement,!n||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;if(!("createNodeIterator"in document))return n;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}function Uv(e,t){try{var n=wo(e);return Gk(n,t)}catch{return null}}var Xk=new Gr(function(){if(typeof trustedTypes<"u"){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(t){return t}});return function(t){return e.createHTML(t)}}return function(t){return t}});function Lf(){var e=this;this.j=this.g=null,this.A=[],this.i=null,this.ea=1,this.B=[],this.l={ae:"",type:"",profiles:[],Kb:null,Ia:0,Ga:null,td:0},this.o=new Map,this.s={},this.ba={},this.m=new Gn,this.H=0,this.da=new ae(5),this.I=new ct(function(){if(e.G&&!e.g.continueLoadingWhenPaused&&(e.C.jb(e.G,"timeupdate"),e.G.paused)){e.C.ha(e.G,"timeupdate",function(){return Hv(e)});return}Hv(e)}),this.N=new os,this.L=null,this.fa=[],this.R=1/0,this.F=!1,this.h=null,this.K=0,this.U=!1,this.C=new lt,this.G=null,this.Z=!1}a=Lf.prototype,a.configure=function(e){var t=this.j&&e.dash.updatePeriod!=this.g.dash.updatePeriod&&0<=e.dash.updatePeriod;this.g=e,t&&this.i&&this.i.presentationTimeline.V()&&this.I.tc(),this.h&&this.h.configure(this.g),this.m&&(this.m.Zg(this.g.dash.multiTypeVariantsAllowed&&ut()),this.m.gh(this.g.dash.useStreamOnceInPeriodFlattening))},a.start=function(e,t){var n=this,i;return $(function(s){if(s.g==1)return n.F=t.isLowLatencyMode(),n.A=[e],n.j=t,E(s,dp(n),2);if(i=s.h,n.j&&pp(n,i),!n.j)throw new K(2,7,7001);return s.return(n.i)})},a.stop=function(){for(var e=x(Object.values(this.s)),t=e.next();!t.done;t=e.next())t=t.value,t.segmentIndex&&t.segmentIndex.release();return this.m&&this.m.release(),this.g=this.j=null,this.A=[],this.i=null,this.s={},this.o.clear(),this.l={ae:"",type:"",profiles:[],Kb:null,Ia:0,Ga:null,td:0},this.m=null,this.I!=null&&(this.I.stop(),this.I=null),this.h&&this.h.destroy(),this.C&&(this.C.release(),this.C=null),this.N.destroy()},a.update=function(){var e=this,t;return $(function(n){if(n.g==1)return ue(n,2),E(n,dp(e),4);if(n.g!=2)return ge(n,0);if(t=ie(n),!e.j||!t)return n.return();e.j.onError(t),F(n)})},a.onExpirationUpdated=function(){},a.onInitialVariantChosen=function(e){if(this.i&&this.i.presentationTimeline.V()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.i.presentationTimeline.Wb();var n=t.segmentIndex.find(e);n!=null&&(t=t.segmentIndex.get(n))&&(this.H=t.endTime-e,pp(this,0))}}},a.banLocation=function(e){this.h&&this.h.banLocation(e)},a.setMediaElement=function(e){this.G=e};function dp(e){var t,n,i,s,l,u,c,d,g,y;return $(function(w){return w.g==1?(t=4,n="MPD",i=sb(e),s=e.A,i.length?(s=i,n="Patch",t=6):1<e.A.length&&e.h&&(l=sl(e.h,"Location",!0),l.length&&(s=l)),u=dn(s,e.g.retryParameters),c=Date.now(),E(w,mp(e,u,0,{type:t}),2)):w.g!=3?(d=w.h,e.j?(d.uri&&d.uri!=d.originalUri&&!e.A.includes(d.uri)&&e.A.unshift(d.uri),E(w,Wk(e,d.data,d.uri,n),3)):w.return(0)):(g=Date.now(),y=(g-c)/1e3,e.da.sample(1,y),w.return(y))})}function Wk(e,t,n,i){var s,l,u,c,d,g,y,w,C,T;return $(function(A){if(A.g==1){if(s=t,l=e.g.dash.manifestPreprocessor,u=qu,l!=u){if(vt("manifest.dash.manifestPreprocessor configuration","Please Use manifest.dash.manifestPreprocessorTXml instead."),c=Uv(s,i),!c)throw new K(2,4,4001,n);l(c),s=qi(c.outerHTML)}if(d=jh(s,i),!d)throw new K(2,4,4001,n);return g=e.g.dash.manifestPreprocessorTXml,y=Yu,g!=y&&g(d),i==="Patch"?A.return(qk(e,d)):e.g.dash.disableXlinkProcessing?A.return(Bv(e,d,n)):(w=e.g.dash.xlinkFailGracefully,C=bf(d,e.g.retryParameters,w,n,e.j.networkingEngine),Ir(e.N,C),E(A,C.promise,2))}return T=A.h,A.return(Bv(e,T,n))})}function Bv(e,t,n){var i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne,oe,xe,pe,we,Me,Te,Ne,rt,gt,Xt,wt,Yt,rn,Wt,At,en,cn,hn,ri,si,Vi,jo,ir,zs,Fo,dc,bl,Il;return $(function(to){switch(to.g){case 1:for(e.h&&e.h.l.clear(),i=[n],s=[],l=new Map,u=Bt(t,"Location"),c=x(u),d=c.next();!d.done;d=c.next())g=d.value,y=g.attributes.serviceLocation,(w=Ui(g))&&(C=Cn(i,[w])[0],y&&(e.h?Ns(e.h,"Location",y,C):l.set(y,C)),s.push(C));if(e.h?(T=sl(e.h,"Location",!0),0<T.length&&(i=e.A=T)):s.length&&(i=e.A=s),e.l.ae=t.attributes.id||"",e.l.td=yt(t,"publishTime",qo)||0,e.B=Bt(t,"PatchLocation"),A=Promise.resolve(),(b=ji(t,"ContentSteering"))&&e.j)for(k=b.attributes.defaultServiceLocation,e.h?(e.h.i=i,e.h.h=k):(e.h=new Ds(e.j),e.h.configure(e.g),e.h.setManifestType("DASH"),e.h.i=i,e.h.h=k,(O=Ui(b))&&(yt(b,"queryBeforeStart",$h,!1)?A=rl(e.h,O):rl(e.h,O))),D=x(l.keys()),z=D.next();!z.done;z=D.next())P=z.value,B=l.get(P),Ns(e.h,"Location",P,B);if(G=Bt(t,"BaseURL"),J=!1,e.h)for(fe=x(G),te=fe.next();!te.done;te=fe.next())ne=te.value,oe=ne.attributes.serviceLocation,xe=Ui(ne),oe&&xe&&(Ns(e.h,"BaseURL",oe,xe),J=!0);if(J&&e.h||(pe=G.map(Ui),q=Cn(i,pe)),we=function(){return e.h&&J?sl(e.h,"BaseURL"):q||[]},e.l.Ga=we,Me=0,G&&G.length&&(Me=yt(G[0],"availabilityTimeOffset",bu)||0),e.l.Ia=Me,Te=e.g.dash.ignoreMinBufferTime,Ne=0,Te||(Ne=yt(t,"minBufferTime",co)||0),e.H=yt(t,"minimumUpdatePeriod",co,-1),rt=yt(t,"availabilityStartTime",qo),gt=yt(t,"timeShiftBufferDepth",co),Xt=e.g.dash.ignoreSuggestedPresentationDelay,wt=null,Xt||(wt=yt(t,"suggestedPresentationDelay",co)),Yt=e.g.dash.ignoreMaxSegmentDuration,rn=null,Yt||(rn=yt(t,"maxSegmentDuration",co)),Wt=t.attributes.type||"static",e.i&&e.i.presentationTimeline&&(e.Z=e.i.presentationTimeline.V()&&Wt=="static"),e.l.type=Wt,e.i)for(At=e.i.presentationTimeline,en=x(Object.values(e.s)),cn=en.next();!cn.done;cn=en.next())hn=cn.value,hn.segmentIndex&&hn.segmentIndex.Ma(At.mb());else ri=e.g.defaultPresentationDelay||1.5*Ne,si=wt??ri,At=new Qe(rt,si,e.g.dash.autoCorrectDrift);return At.sc(Wt=="static"),At.V()&&!isNaN(e.g.availabilityWindowOverride)&&(gt=e.g.availabilityWindowOverride),gt==null&&(gt=1/0),At.pe(gt),Vi=t.attributes.profiles||"",e.l.profiles=Vi.split(","),jo={vb:Wt!="static",presentationTimeline:At,ta:null,ka:null,ja:null,J:null,bandwidth:0,lf:!1,Ia:Me,Kb:null,profiles:Vi.split(","),roles:null},e.K=0,ir=Vv(e,jo,we,t),zs=ir.duration,Fo=ir.periods,(Wt!="static"||e.Z)&&ir.rg||At.Za(zs||1/0),e.U&&!e.F&&e.j.isAutoLowLatencyMode()&&(e.j.enableLowLatencyMode(),e.F=e.j.isLowLatencyMode()),e.F&&At.$g(e.R),At.xf(rn||1),E(to,A,2);case 2:return e.F&&(Ne=0,dc=wt??e.g.defaultPresentationDelay,At.Of(dc)),e.i?(e.i.periodCount=Fo.length,e.i.gapCount=e.K,E(to,jv(e,Fo,!1),4)):E(to,e.m.Ke(Fo,jo.vb),6);case 6:if(e.i={presentationTimeline:At,variants:e.m.j,textStreams:e.m.jf(),imageStreams:e.m.i,offlineSessionIds:[],minBufferTime:Ne||0,sequenceMode:e.g.dash.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:Yk(t),nextUrl:Kk(t),periodCount:Fo.length,gapCount:e.K,isLowLatency:e.U},!At.nh()){to.u(7);break}return bl=Bt(t,"UTCTiming"),E(to,ob(e,we,bl),8);case 8:if(Il=to.h,!e.j)return to.return();At.ah(Il);case 7:At.Wd();case 4:e.j.makeTextStreamsForClosedCaptions(e.i),F(to)}})}function jv(e,t,n){var i;return $(function(s){if(s.g==1)return E(s,e.m.Ke(t,!0,n),2);e.i.variants=e.m.j,i=e.m.jf(),0<i.length&&(e.i.textStreams=i),e.i.imageStreams=e.m.i,e.j.filter(e.i),F(s)})}function qk(e,t){var n,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne,oe;return $(function(xe){if(xe.g==1){if(n=t.attributes.mpdId,i=yt(t,"originalPublishTime",qo),!n||n!==e.l.ae||i!==e.l.td)throw e.B=[],new K(1,4,4052);for(s=[],l=[],u=new Set,c=x(wm(t)),d=c.next();!d.done;d=c.next())if(g=d.value,y=Iu(g.attributes.sel||""),w=y[y.length-1],C=Ui(g)||"",w.name==="MPD")if(w.Sb==="mediaPresentationDuration"){T=Ui(g)||"";var pe=co(T);if(pe!=null){e.l.Kb=pe;for(var we=x(e.o.values()),Me=we.next();!Me.done;Me=we.next())Me.value.Kb=pe}}else if(w.Sb==="type"){for(e.i.presentationTimeline.sc(C=="static"),e.l.type=C,pe=x(e.o.values()),we=pe.next();!we.done;we=pe.next())we.value.vb=C=="dynamic";C=="static"&&(e.H=-1)}else w.Sb==="publishTime"?e.l.td=qo(C)||0:w.Sb===null&&g.tagName==="add"&&l.push(g);else if(w.name==="PatchLocation")Tm(e.B,g);else if(w.name==="Period"){if(g.tagName==="add")l.push(g);else if(g.tagName==="remove"&&w.id){pe=e,we=w.id,pe.i.periodCount--,Me=x(pe.o.keys());for(var Te=Me.next();!Te.done;Te=Me.next())if(Te=Te.value,Te.startsWith(we)){var Ne=pe.o.get(Te);Ls(Ne,Or,"SegmentTimeline").children=[],$v(pe,Te),pe.o.delete(Te)}}}else if(w.name==="SegmentTemplate"){if(we=Iu(g.attributes.sel||""),pe=we[we.length-1],pe.Sb){for(we=Fv(e,we),Me=Ui(g)||"",Te=x(we),Ne=Te.next();!Ne.done;Ne=Te.next())Ne=e.o.get(Ne.value),Em(Ne.J.$b,g.tagName,pe.Sb,Me);pe=we}else pe=[];for(A=pe,b=x(A),k=b.next();!k.done;k=b.next())O=k.value,u.add(O)}else if(w.name==="SegmentTimeline"||w.name==="S"){for(pe=Iu(g.attributes.sel||""),pe=Fv(e,pe),we=x(pe),Me=we.next();!Me.done;Me=we.next())Me=e.o.get(Me.value),Me=Ls(Me,Or,"SegmentTimeline"),Te=Bt(Me,"S"),Tm(Te,g),Me.children=Te;for(D=pe,z=x(D),P=z.next();!P.done;P=z.next())B=P.value,u.add(B)}for(G=x(u),q=G.next();!q.done;q=G.next())J=q.value,$v(e,J);for(fe=x(l),te=fe.next();!te.done;te=fe.next())ne=te.value,s.push.apply(s,L(Vv(e,{vb:e.l.type=="dynamic",presentationTimeline:e.i.presentationTimeline,ta:null,ka:null,ja:null,J:null,bandwidth:0,lf:!1,Ia:e.l.Ia,profiles:e.l.profiles,Kb:e.l.Kb,roles:null},e.l.Ga,ne).periods));return s.length?(e.i.periodCount+=s.length,e.i.gapCount=e.K,E(xe,jv(e,s,!0),2)):xe.u(2)}e.l.type=="static"&&(oe=e.l.Kb,e.i.presentationTimeline.Za(oe||1/0)),F(xe)})}function Fv(e,t){var n="",i="",s=-1,l="";t=x(t);for(var u=t.next();!u.done;u=t.next())u=u.value,u.name==="Period"?n=u.id:u.name==="AdaptationSet"?(i=u.id,u.position!==null&&(s=u.position)):u.name==="Representation"&&(l=u.id);if(t=[],l)t.push(n+","+l);else if(i)for(s=x(e.o.values()),e=s.next();!e.done;e=s.next())e=e.value,e.ta.id===n&&e.ja.id===i&&e.J.id&&t.push(n+","+e.J.id);else if(-1<s)for(i=x(e.o.values()),e=i.next();!e.done;e=i.next())e=e.value,e.ta.id===n&&e.ja.position===s&&e.J.id&&t.push(n+","+e.J.id);return t}function $v(e,t){var n=e.o.get(t),i=e.s[t];i.segmentIndex&&i.segmentIndex.Ma(e.i.presentationTimeline.mb());try{var s=Ev(n,function(l,u,c,d){return Gv(e,l,u,c,d)},e.s,!0,e.g.dash.initialSegmentLimit,e.ba,n.J.aesKey,null,!0);i.createSegmentIndex=function(){return $(function(l){if(l.g==1)return i.segmentIndex?l.u(0):E(l,s.fc(),3);i.segmentIndex=l.h,F(l)})}}catch(l){if(t=n.J.contentType,t!=mt&&t!="application"&&t!="image"||l.code!=4002)throw l}}function Yk(e){var t=ji(e,"ServiceDescription");if(!t||(e=ji(t,"Latency"),t=ji(t,"PlaybackRate"),!e&&!t))return null;var n={};return e&&("target"in e.attributes&&(n.targetLatency=parseInt(e.attributes.target,10)/1e3),"max"in e.attributes&&(n.maxLatency=parseInt(e.attributes.max,10)/1e3),"min"in e.attributes&&(n.minLatency=parseInt(e.attributes.min,10)/1e3)),t&&("max"in t.attributes&&(n.maxPlaybackRate=parseFloat(t.attributes.max)),"min"in t.attributes&&(n.minPlaybackRate=parseFloat(t.attributes.min))),n}function Kk(e){if(e=Bt(e,"SupplementalProperty"),!e.length)return null;e=x(e);for(var t=e.next();!t.done;t=e.next())if(t=t.value,t.attributes.schemeIdUri=="urn:mpeg:dash:chaining:2016")return t.attributes.value;return null}function Vv(e,t,n,i){var s=t.Kb;s||(s=yt(i,"mediaPresentationDuration",co),e.l.Kb=s);var l=0;e.i&&e.i.presentationTimeline&&e.Z&&(l=e.i.presentationTimeline.Vb());var u=[],c=l;i=Bt(i,"Period");for(var d=0;d<i.length;d++){var g=i[d],y=i[d+1],w=yt(g,"start",co,c),C=g.attributes.id,T=yt(g,"duration",co),A=null;if(y){var b=yt(y,"start",co);b!=null&&(A=b-w)}else s!=null&&(A=s-w+l);if(b=CT,A&&T&&Math.abs(A-T)>b&&A>T&&e.K++,A==null&&(A=T),!(e.L!==null&&C!==null&&w!==null&&w<e.L)||e.fa.includes(C)||d+1==i.length){if(w!==null&&(e.L===null||w>e.L)&&(e.L=w),c=Zk(e,t,n,{start:w,duration:A,node:g,ld:A==null||!y}),u.push(c),t.ta.id&&A&&(e.ba[t.ta.id]=A),A==null){c=null;break}c=w+A}}return e.fa=u.map(function(k){return k.id}),s!=null?{periods:u,duration:s+l,rg:!1}:{periods:u,duration:c,rg:!0}}function Zk(e,t,n,i){t.ta=gp(e,i.node,null,n),t.ka=i,t.ta.Ia=t.Ia,t.ta.id||(t.ta.id="__shaka_period_"+i.start);var s=Bt(i.node,"EventStream");n=t.presentationTimeline.mb(),s=x(s);for(var l=s.next();!l.done;l=s.next())rb(e,i.start,i.duration,l.value,n);if(n=Bt(i.node,"AdaptationSet").map(function(y,w){return Qk(e,t,w,y)}).filter(Ar),t.vb){for(i=[],s=x(n),l=s.next();!l.done;l=s.next()){l=x(l.value.Mi);for(var u=l.next();!u.done;u=l.next())i.push(u.value)}if(i.length!=new Set(i).size)throw new K(2,4,4018)}for(i=n.filter(function(y){return!y.Yf}),n=n.filter(function(y){return y.Yf}),n=x(n),s=n.next();!s.done;s=n.next()){s=s.value,l=s.Yf.split(" "),u=x(i);for(var c=u.next();!c.done;c=u.next())if(c=c.value,l.includes(c.id)){c=x(c.streams);for(var d=c.next(),g={};!d.done;g={Sf:void 0},d=c.next())g.Sf=d.value,g.Sf.trickModeVideo=s.streams.find(function(y){return function(w){return Vn(y.Sf.codecs)==Vn(w.codecs)}}(g))}}if(n=Pf(e.g.disableAudio,i,"audio"),s=Pf(e.g.disableVideo,i,"video"),l=Pf(e.g.disableText,i,mt),i=Pf(e.g.disableThumbnails,i,"image"),s.length===0&&n.length===0)throw new K(2,4,4004);return{id:t.ta.id,audioStreams:n,videoStreams:s,textStreams:l,imageStreams:i}}function Pf(e,t,n){return e||!t.length?[]:t.reduce(function(i,s){return s.contentType!=n||i.push.apply(i,L(s.streams)),i},[])}function Qk(e,t,n,i){function s(ne){switch(ne){case 1:case 5:case 6:case 7:return"srgb";case 9:return"rec2020";case 11:case 12:return"p3"}}function l(ne){switch(ne){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}t.ja=gp(e,i,t.ta,null),t.ja.position=n;var u=!1;n=Bt(i,"Role");var c=n.map(function(ne){return ne.attributes.value}).filter(Ar),d=void 0,g=t.ja.contentType==mt;g&&(d="subtitle"),n=x(n);for(var y=n.next();!y.done;y=n.next()){y=y.value;var w=y.attributes.schemeIdUri;if(w==null||w=="urn:mpeg:dash:role:2011")switch(y=y.attributes.value,y){case"main":u=!0;break;case"caption":case"subtitle":d=y}}var C,T;w=Bt(i,"EssentialProperty"),n=null;var A=!1;y=!1,w=x(w);for(var b=w.next();!b.done;b=w.next()){b=b.value;var k=b.attributes.schemeIdUri;k=="http://dashif.org/guidelines/trickmode"?n=b.attributes.value:k=="urn:mpeg:mpegB:cicp:TransferCharacteristics"?C=l(parseInt(b.attributes.value,10)):k=="urn:mpeg:mpegB:cicp:ColourPrimaries"?T=s(parseInt(b.attributes.value,10)):k!="urn:mpeg:mpegB:cicp:MatrixCoefficients"&&(k=="urn:mpeg:dash:ssr:2023"&&e.g.dash.enableFastSwitching?A=!0:y=!0)}var O=null;for(w=Bt(i,"SupplementalProperty"),w=x(w),b=w.next();!b.done;b=w.next())b=b.value,k=b.attributes.schemeIdUri,k=="http://dashif.org/guidelines/last-segment-number"?O=parseInt(b.attributes.value,10)-1:k=="urn:mpeg:mpegB:cicp:TransferCharacteristics"?C=l(parseInt(b.attributes.value,10)):k=="urn:mpeg:mpegB:cicp:ColourPrimaries"&&(T=s(parseInt(b.attributes.value,10)));w=Bt(i,"Accessibility");var D=new Map,z;for(w=x(w),b=w.next();!b.done;b=w.next())if(k=b.value,b=k.attributes.schemeIdUri,k=k.attributes.value,b!="urn:scte:dash:cc:cea-608:2015"||e.g.disableText)if(b!="urn:scte:dash:cc:cea-708:2015"||e.g.disableText)b=="urn:mpeg:dash:role:2011"?k!=null&&(c.push(k),k=="captions"&&(d="caption")):b=="urn:tva:metadata:cs:AudioPurposeCS:2007"&&(k=="1"?z="visually impaired":k=="2"&&(z="hard of hearing"));else if(b=1,k!=null){k=x(k.split(";"));for(var P=k.next();!P.done;P=k.next()){var B=P.value,G=P=void 0;B.includes("=")?(B=B.split("="),P="svc"+B[0],G=B[1].split(",")[0].split(":").pop()):(P="svc"+b,b++,G=B),D.set(P,It(G))}}else D.set("svc1","und");else if(b=1,k!=null)for(k=k.split(";"),P=x(k),B=P.next();!B.done;B=P.next()){G=B.value;var q=B=void 0;G.includes("=")?(G=G.split("="),B=G[0].startsWith("CC")?G[0]:"CC"+G[0],q=G[1]||"und"):(B="CC"+b,k.length==2?b+=2:b++,q=G),D.set(B,It(q))}else D.set("CC1","und");if(y)return null;y=Bt(i,"ContentProtection");var J=pv(y,e.g.dash.ignoreDrmInfo,e.g.dash.keySystemsByURI),fe=It(t.ja.language||"und"),te=t.ja.label;if(y=Bt(i,"Representation"),i=y.map(function(ne){return(ne=Jk(e,t,J,d,fe,te,u,c,D,ne,z,O))&&(ne.hdr=ne.hdr||C,ne.colorGamut=ne.colorGamut||T,ne.fastSwitching=A),ne}).filter(function(ne){return!!ne}),i.length==0){if(n=t.ja.contentType=="image",e.g.dash.ignoreEmptyAdaptationSet||g||n)return null;throw new K(2,4,4003)}if(!t.ja.contentType||t.ja.contentType=="application")for(t.ja.contentType=Xv(i[0].mimeType,i[0].codecs),g=x(i),w=g.next();!w.done;w=g.next())w.value.type=t.ja.contentType;for(g=t.ja.id||"__fake__"+e.ea++,w=x(i),b=w.next();!b.done;b=w.next()){for(b=b.value,k=x(J.drmInfos),P=k.next();!P.done;P=k.next())P=P.value,P.keyIds=P.keyIds&&b.keyIds?new Set([].concat(L(P.keyIds),L(b.keyIds))):P.keyIds||b.keyIds;e.g.dash.enableAudioGroups&&(b.groupId=g)}return y=y.map(function(ne){return ne.attributes.id}).filter(Ar),{id:g,contentType:t.ja.contentType,language:fe,ek:u,streams:i,drmInfos:J.drmInfos,Yf:n,Mi:y}}function Jk(e,t,n,i,s,l,u,c,d,g,y,w){t.J=gp(e,g,t.ja,null);var C=t.J.id;if(e.R=Math.min(e.R,t.J.Ia),e.U=0<e.R,!ib(t.J))return null;var T=t.ka.start;t.bandwidth=yt(g,"bandwidth",bo)||0,t.roles=c;var A=t.J.contentType,b=A==mt||A=="application";A=A=="image";try{var k=void 0;if(n.Fe){var O=t.J.Ga,D=Cn(O(),[n.Fe.ti]),z=dn(D,e.g.retryParameters);k={bitsKey:128,blockCipherMode:"CBC",iv:n.Fe.iv,firstMediaSequenceNumber:0,fetchKey:function(){var oe,xe,pe;return $(function(we){if(we.g==1)return E(we,mp(e,z,6),2);if(we.g!=3){if(oe=we.h,!oe.data||oe.data.byteLength!=16)throw new K(2,4,4049);return xe={name:"AES-CBC"},pe=k,E(we,p.crypto.subtle.importKey("raw",oe.data,xe,!0,["decrypt"]),3)}pe.cryptoKey=we.h,k.fetchKey=void 0,F(we)})}}}if(t.J.aesKey=k,O=function(oe,xe,pe,we){return Gv(e,oe,xe,pe,we)},t.J.Rc)var P=Ck(t,O,k);else if(t.J.Pb)P=Ak(t,e.s,k);else if(t.J.$b)P=Ev(t,O,e.s,!!e.i,e.g.dash.initialSegmentLimit,e.ba,k,w,!1);else{var B=t.ka.duration||0,G=t.J.Ga,q=t.J.mimeType,J=t.J.codecs;P={fc:function(){var oe=ld(T,B,G());return oe.Hb(function(xe){xe.mimeType=q,xe.codecs=J}),Promise.resolve(oe)}}}}catch(oe){if((b||A)&&oe.code==4002)return null;throw oe}w=Bt(g,"ContentProtection"),w=ak(w,n,e.g.dash.ignoreDrmInfo,e.g.dash.keySystemsByURI),w=new Set(w?[w]:[]),O=!1,Bt(g,"SupplementalProperty").some(function(oe){return oe.attributes.schemeIdUri=="tag:dolby.com,2018:dash:EC3_ExtensionType:2018"&&oe.attributes.value=="JOC"})&&(O=!0),D=!1,b&&(D=c.includes("forced_subtitle")||c.includes("forced-subtitle"));var fe;if(A&&((g=Bt(g,"EssentialProperty").find(function(oe){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(oe.attributes.schemeIdUri)}))&&(fe=g.attributes.value),!fe))return null;var te;g=t.J.codecs,t.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(g.includes("hvc1.2.4.L153.B0")||g.includes("hev1.2.4.L153.B0"))&&(te="PQ"),b=t.J.id?t.ta.id+","+t.J.id:"",e.B.length&&C&&e.o.set(t.ta.id+","+C,eb(t));var ne=b&&e.s[b]?e.s[b]:{id:e.ea++,originalId:t.J.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){ne.segmentIndex&&(ne.segmentIndex.release(),ne.segmentIndex=null)},segmentIndex:null,mimeType:t.J.mimeType,codecs:g,frameRate:t.J.frameRate,pixelAspectRatio:t.J.pixelAspectRatio,bandwidth:t.bandwidth,width:t.J.width,height:t.J.height,kind:i,encrypted:0<n.drmInfos.length,drmInfos:n.drmInfos,keyIds:w,language:s,originalLanguage:t.ja.language,label:l,type:t.ja.contentType,primary:u,trickModeVideo:null,emsgSchemeIdUris:t.J.emsgSchemeIdUris,roles:c,forced:D,channelsCount:t.J.Jc,audioSamplingRate:t.J.audioSamplingRate,spatialAudio:O,closedCaptions:d,hdr:te,colorGamut:void 0,videoLayout:void 0,tilesLayout:fe,accessibilityPurpose:y,external:!1,fastSwitching:!1,fullMimeTypes:new Set([an(t.J.mimeType,t.J.codecs)])};return ne.createSegmentIndex=function(){var oe;return $(function(xe){if(xe.g==1)return ne.segmentIndex?xe.u(0):(oe=ne,E(xe,P.fc(),3));oe.segmentIndex=xe.h,F(xe)})},b&&t.vb&&!e.s[b]&&(e.s[b]=ne),ne}function eb(e){for(var t={},n=x(Object.keys(e)),i=n.next();!i.done;i=n.next())if(i=i.value,["period","adaptationSet","representation"].includes(i)){var s=e[i];t[i]={Rc:null,Pb:null,$b:s.$b,Ga:s.Ga,width:s.width,height:s.height,contentType:s.contentType,mimeType:s.mimeType,language:s.language,codecs:s.codecs,frameRate:s.frameRate,pixelAspectRatio:s.pixelAspectRatio,emsgSchemeIdUris:s.emsgSchemeIdUris,id:s.id,position:s.position,Jc:s.Jc,audioSamplingRate:s.audioSamplingRate,Ia:s.Ia,Gc:s.Gc}}else i=="periodInfo"?(s=e[i],t[i]={start:s.start,duration:s.duration,node:null,ld:s.ld}):t[i]=e[i];return t}function Hv(e){var t,n;return $(function(i){switch(i.g){case 1:return t=0,ue(i,2),E(i,dp(e),4);case 4:t=i.h,ge(i,3);break;case 2:if(n=ie(i),e.j){if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.j.onError(n),i.return();n.severity=1,e.j.onError(n)}case 3:if(!e.j)return i.return();e.j.onManifestUpdated(),pp(e,t),F(i)}})}function pp(e,t){if(!(0>e.H)){var n=e.H;0<=e.g.dash.updatePeriod&&(n=e.g.dash.updatePeriod),e.I.Y(Math.max(n-t,Q(e.da)))}}function gp(e,t,n,i){n=n||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,Jc:null,audioSamplingRate:null,Ia:0,Kf:0},i=i||n.Ga;var s=t.attributes.id,l=Bt(t,"BaseURL"),u,c=!1;if(e.h)for(var d=x(l),g=d.next();!g.done;g=d.next()){var y=g.value;g=y.attributes.serviceLocation,y=Ui(y),g&&y&&(Ns(e.h,s,g,y),c=!0)}c&&e.h||(u=l.map(Ui)),d=t.attributes.contentType||n.contentType,g=t.attributes.mimeType||n.mimeType,y=[t.attributes.codecs||n.codecs];var w=ko(t,"urn:scte:dash:scte214-extensions","supplementalCodecs");w&&y.push(w),y=pd(y).join(","),w=yt(t,"frameRate",rC)||n.frameRate;var C=t.attributes.sar||n.pixelAspectRatio,T=tb(Bt(t,"InbandEventStream"),n.emsgSchemeIdUris),A=Bt(t,"AudioChannelConfiguration");A=nb(A)||n.Jc;var b=yt(t,"audioSamplingRate",Ln)||n.audioSamplingRate;d||(d=Xv(g,y));var k=ji(t,"SegmentBase"),O=ji(t,"SegmentTemplate"),D=k&&yt(k,"availabilityTimeOffset",bu)||0,z=O&&yt(O,"availabilityTimeOffset",bu)||0,P=l&&l.length&&yt(l[0],"availabilityTimeOffset",bu)||0;D=n.Ia+P+D+z,z=null,(P=ji(t,"SegmentSequenceProperties"))&&(P=ji(P,"SAP"))&&(z=yt(P,"cadence",ku)),P=t.attributes.label;var B=Bt(t,"Label");return B&&B.length&&(B=B[0],un(B)&&(P=un(B))),{Ga:function(){return Cn(i(),l.length?e.h&&c?sl(e.h,s):u||[]:[])},Rc:k||n.Rc,Pb:ji(t,"SegmentList")||n.Pb,$b:O||n.$b,width:yt(t,"width",Ln)||n.width,height:yt(t,"height",Ln)||n.height,contentType:d,mimeType:g,codecs:y,frameRate:w,pixelAspectRatio:C,emsgSchemeIdUris:T,id:s,language:t.attributes.lang,Jc:A,audioSamplingRate:b,Ia:D,Gc:null,Kf:z||n.Kf,label:P||null}}function tb(e,t){t=t.slice(),e=x(e);for(var n=e.next();!n.done;n=e.next())n=n.value.attributes.schemeIdUri,t.includes(n)||t.push(n);return t}function nb(e){e=x(e);for(var t=e.next();!t.done;t=e.next()){var n=t.value;if((t=n.attributes.schemeIdUri)&&(n=n.attributes.value))switch(t){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(t=parseInt(n,10),!t)continue;return t;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(t=parseInt(n,16),!t)continue;for(e=0;t;)t&1&&++e,t>>=1;return e;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(t=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(n=parseInt(n,10))&&0<n&&n<t.length)return t[n]}}return null}function ib(e){var t=e.Rc?1:0;return t+=e.Pb?1:0,t+=e.$b?1:0,t==0?e.contentType==mt||e.contentType=="application":(t!=1&&(e.Rc&&(e.Pb=null),e.$b=null),!0)}function zv(e,t,n,i){var s,l,u,c,d,g,y;return $(function(w){if(w.g==1)return s=[$n(n)],l=Cn(t(),s),u=dn(l,e.g.retryParameters),u.method=i,c=e.j.networkingEngine.request(4,u),Ir(e.N,c),E(w,c.promise,2);if(d=w.h,i=="HEAD"){if(!d.headers||!d.headers.date)return w.return(0);g=d.headers.date}else g=Vt(d.data);return y=Date.parse(g),isNaN(y)?w.return(0):w.return(y-Date.now())})}function ob(e,t,n){var i,s,l,u,c,d,g,y;return $(function(w){switch(w.g){case 1:i=n.map(function(C){return{scheme:C.attributes.schemeIdUri,value:C.attributes.value}}),s=e.g.dash.clockSyncUri,!i.length&&s&&i.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:s}),l=x(i),u=l.next();case 2:if(u.done){w.u(4);break}switch(c=u.value,ue(w,5),d=c.scheme,g=c.value,d){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return w.u(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return w.u(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return y=Date.parse(g),w.return(isNaN(y)?0:y-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":Fe("NTP UTCTiming scheme is not supported");break;default:Fe("Unrecognized scheme in UTCTiming element",d)}w.u(9);break;case 7:return E(w,zv(e,t,g,"HEAD"),10);case 10:return w.return(w.h);case 8:return E(w,zv(e,t,g,"GET"),11);case 11:return w.return(w.h);case 9:ge(w,3);break;case 5:ie(w);case 3:u=l.next(),w.u(2);break;case 4:return Fe("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),w.return(0)}})}function rb(e,t,n,i,s){var l=i.attributes.schemeIdUri||"",u=i.attributes.value||"",c=yt(i,"timescale",Ln)||1;i=x(Bt(i,"Event"));for(var d=i.next();!d.done;d=i.next()){d=d.value;var g=yt(d,"presentationTime",Ln)||0,y=yt(d,"duration",Ln)||0;g=g/c+t,y=g+y/c,n!=null&&(g=Math.min(g,t+n),y=Math.min(y,t+n)),y<s||(d={schemeIdUri:l,value:u,startTime:g,endTime:y,id:d.attributes.id||"",eventElement:Am(d),eventNode:d},e.j.onTimelineRegionAdded(d))}}function Gv(e,t,n,i,s){var l,u,c,d;return $(function(g){return g.g==1?(l=Ki,u=s?0:1,c=gs(t,n,i,e.g.retryParameters),E(g,mp(e,c,l,{type:u}),2)):(d=g.h,g.return(d.data))})}function Xv(e,t){return t=an(e,t),Ea(t)?mt:e.split("/")[0]}function mp(e,t,n,i){return t=e.j.networkingEngine.request(n,t,i),Ir(e.N,t),t.promise}function sb(e){var t=e.l.td;if(!e.l.ae||!t||!e.B.length)return[];var n=Date.now()/1e3,i=e.B.filter(function(s){return s=Ln(s.attributes.ttl),!s||t+s>n}).map(Ui).filter(Ar);return i.length?Cn(e.A,i):[]}he("shaka.dash.DashParser",Lf),Fi["application/dash+xml"]=function(){return new Lf},Fi["video/vnd.mpeg.dash.mpd"]=function(){return new Lf};function Df(){}he("shaka.dependencies",Df),Df.has=function(e){return yp.has(e)},Df.add=function(e,t){if(!qv[e])throw Error(e+" is not supported");e==Wv?vt("mux.js","mux.js is no longer used in Shaka Player."):yp.set(e,function(){return t})};var Wv="muxjs",qv={fk:Wv,ISOBoxer:"ISOBoxer"};Df.Allowed=qv;var yp=new Map([["ISOBoxer",function(){return p.ISOBoxer}]]);function Yv(e,t,n){this.type=e,this.g=t,this.segments=n||null}function Kv(e,t,n,i){this.id=e,this.name=t,this.attributes=n,this.value=i===void 0?null:i}Kv.prototype.toString=function(e){function t(s){return s.name+"="+(isNaN(Number(s.value))?'"'+s.value+'"':s.value)}var n="#"+this.name,i=this.attributes?this.attributes.filter(function(s){return e?!e.has(s.name):!0}).map(t):[];return this.value&&i.unshift(this.value),0<i.length&&(n+=":"+i.join(",")),n};function Zv(e,t){return t?e.toString():(t=new Set().add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI"),e.toString(t))}function hl(e,t){return e=e.attributes.filter(function(n){return n.name==t}),e.length?e[0]:null}function ze(e,t,n){return(e=hl(e,t))?e.value:n||null}function Mt(e,t){if(e=hl(e,t),!e)throw new K(2,4,4023,t);return e.value}function Qv(e,t,n){n=n===void 0?[]:n,this.g=t,this.h=e,this.zb=n}function Jv(e,t){this.name=e,this.value=t}function bi(e,t){return e.filter(function(n){return n.name==t})}function ex(e,t){return e.filter(function(n){return Mt(n,"TYPE")==t})}function bn(e,t){e=x(e);for(var n=e.next();!n.done;n=e.next())if(n=n.value,n.name===t)return n;return null}function Us(e,t,n){return n=n===void 0?0:n,(e=bn(e,t))?Number(e.value):n}function tr(e,t,n){return t?tx(e,[t],n):[]}function tx(e,t,n){if(!t.length)return[];t=Cn(e,t),e=[],t=x(t);for(var i=t.next();!i.done;i=t.next())e.push(nx(i.value,n));return e}function nx(e,t){if(!t||!t.size)return e;e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}");var n=e.match(/{\$\w*}/g);if(n){n=x(n);for(var i=n.next();!i.done;i=n.next()){i=i.value;var s=i.slice(2,i.length-1),l=t.get(s);if(l)e=e.replace(i,l);else throw new K(2,4,4039,s)}}return e}function ab(){this.g=0}function vp(e,t){t=Vt(t),t=t.replace(/\r\n|\r(?=[^\n]|$)/gm,`
`).trim();var n=t.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new K(2,4,4015);t=0;for(var i=!0,s=x(n),l=s.next();!l.done;l=s.next())if(l=l.value,/^#(?!EXT)/m.test(l)||i)i=!1;else if(l=xp(e,l),--e.g,ix.includes(l.name)){t=1;break}else l.name=="EXT-X-STREAM-INF"&&(i=!0);for(s=[],i=!0,l=0;l<n.length;l++){var u=n[l],c=n[l+1];if(/^#(?!EXT)/m.test(u)||i)i=!1;else{if(u=xp(e,u),lb.includes(u.name)){if(t!=1)throw new K(2,4,4017);u=n.splice(l,n.length-l),n=[],i=[],l=[],c=null,u=x(u);for(var d=u.next();!d.done;d=u.next())d=d.value,/^(#EXT)/.test(d)?(d=xp(e,d),ix.includes(d.name)?s.push(d):d.name=="EXT-X-MAP"?c=d:d.name=="EXT-X-PART"?l.push(d):d.name=="EXT-X-PRELOAD-HINT"?ze(d,"TYPE")=="PART"?l.push(d):ze(d,"TYPE")=="MAP"&&(d.name="EXT-X-MAP",c=d):i.push(d)):/^#(?!EXT)/m.test(d)||(d=d.trim(),c&&i.push(c),n.push(new Qv(d,i,l)),i=[],l=[]);return l.length&&(c&&i.push(c),n.push(new Qv("",i,l))),new Yv(t,s,n)}s.push(u),u.name=="EXT-X-STREAM-INF"&&(u.attributes.push(new Jv("URI",c)),i=!0)}}return new Yv(t,s)}function xp(e,t){e=e.g++;var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new K(2,4,4016,t);t=n[1];var i=n[2];n=[];var s;if(i){i=new Qo(i);var l;(l=Lo(i,/^([^,=]+)(?:,|$)/g))&&(s=l[1]);for(var u=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;l=Lo(i,u);)n.push(new Jv(l[1],l[2]||l[3])),bs(i)}return new Kv(e,t,n,s)}var ix="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF EXT-X-DATERANGE".split(" "),lb="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP EXT-X-GAP".split(" ");function ox(){}function rx(e){try{var t=wp(e);return is({uri:e,originalUri:e,data:t.data,headers:{"content-type":t.contentType}})}catch(n){return br(n)}}function wp(e){var t=e.split(":");if(2>t.length||t[0]!="data")throw new K(2,1,1004,e);if(t=t.slice(1).join(":").split(","),2>t.length)throw new K(2,1,1004,e);var n=t[0];e=p.decodeURIComponent(t.slice(1).join(",")),t=n.split(";"),n=t[0];var i=!1;1<t.length&&t[t.length-1]=="base64"&&(i=!0,t.pop());var s;return i?s=Ti(e):s=qi(e),{data:s,contentType:n}}he("shaka.net.DataUriPlugin",ox),ox.parse=rx,Co("data",rx);function Nf(){var e=this;this.g=this.h=null,this.B=1,this.s=new Map,this.G=new Map,this.N=new Map,this.N.set("video",new Map),this.N.set("audio",new Map),this.N.set(mt,new Map),this.N.set("image",new Map),this.ub=new Set,this.i=new Map,this.l=null,this.L="",this.Fa=new ab,this.H=-1,this.fa=1/0,this.ea=this.Gb=!1,this.A=new ct(function(){if(e.ba&&!e.g.continueLoadingWhenPaused&&(e.Z.jb(e.ba,"timeupdate"),e.ba.paused)){e.Z.ha(e.ba,"timeupdate",function(){return kx(e)});return}kx(e)}),this.xa=Ff,this.m=null,this.ab=0,this.o=1/0,this.Da=this.za=this.U=0,this.da=new os,this.C=new Map,this.F=new Map,this.qa=new Map,this.oa=new Map,this.K=new Map,this.pa=new Map,this.ya=new Map,this.Fb=this.I=!1,this.Db=new ae(5),this.j=null,this.R=!0,this.Ea=new Set,this.Z=new lt,this.ba=null}a=Nf.prototype,a.configure=function(e){this.g=e,this.j&&this.j.configure(this.g)},a.start=function(e,t){var n=this,i;return $(function(s){return s.g==1?(n.h=t,n.I=t.isLowLatencyMode(),E(s,Ip(n,[e]),2)):s.g!=3?(i=s.h,n.L=i.uri,E(s,cb(n,i.data,e),3)):s.return(n.m)})},a.stop=function(){this.A&&(this.A.stop(),this.A=null);var e=[];return this.da&&(e.push(this.da.destroy()),this.da=null),this.g=this.h=null,this.ub.clear(),this.m=null,this.i.clear(),this.G.clear(),this.F.clear(),this.s.clear(),this.qa.clear(),this.oa.clear(),this.K.clear(),this.pa.clear(),this.ya.clear(),this.Ea.clear(),this.j&&this.j.destroy(),this.Z&&(this.Z.release(),this.Z=null),Promise.all(e)},a.update=function(){var e=this,t,n,i,s,l,u,c,d,g,y,w,C;return $(function(T){if(T.g==1){if(!ni(e))return T.return();for(t=[],n=Array.from(e.i.values()),e.o=1/0,e.m.gapCount=0,i=n.filter(function(A){return A.stream.segmentIndex}),s=x(i),l=s.next();!l.done;l=s.next())u=l.value,t.push(ub(e,u));return E(T,Promise.all(t),2)}for(px(e,i.map(function(A){return A.stream})),c=i.some(function(A){return A.ed==0}),i.length&&!c&&(d=Rb,Bf(e,d.sh),g=i.map(function(A){return A.Jb}),e.l.Za(Math.min.apply(Math,L(g))),e.h.updateDuration()),c&&Tp(e),y=x(i),w=y.next();!w.done;w=y.next())C=w.value,C.stream.segmentIndex&&!C.stream.segmentIndex.O[0]&&e.h.disableStream(C.stream);F(T)})};function Sp(e,t){return ni(e)?e.N.get(t.type):t.Yd}function ub(e,t){var n,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne,oe,xe,pe,we,Me,Te,Ne,rt;return $(function(gt){switch(gt.g){case 1:for(n=[],i=x(t.M()),s=i.next();!s.done;s=i.next())l=s.value,u=new tn(l),c=u.g,t.Fd&&(0<=t.ob&&c.add("_HLS_msn",String(t.ob)),0<=t.pb&&c.add("_HLS_part",String(t.pb))),t.Gd&&c.add("_HLS_skip","YES"),kg(c)&&ma(u,c),n.push(u.toString());return ue(gt,2),E(gt,Ip(e,n,!0),4);case 4:d=gt.h,ge(gt,3);break;case 2:throw g=ie(gt),e.h&&e.h.disableStream(t.stream),g;case 3:if(!t.stream.segmentIndex)return gt.return();if(y=vp(e.Fa,d.data),y.type!=1)throw new K(2,4,4017);return w=d.uri,w==d.originalUri||t.M().includes(w)||t.Tg.push(w),C=bi(y.g,"EXT-X-DEFINE"),T=Cp(e,C,w),A=t.stream,b=Sp(e,t),E(gt,vx(e,y,A.mimeType,t.M,T),5);case 5:for(k=gt.h,O=k.keyIds,D=k.drmInfos,z=function(Xt,wt){return Xt.size===wt.size&&[].concat(L(Xt)).every(function(Yt){return wt.has(Yt)})},z(A.keyIds,O)||(A.keyIds=O,A.drmInfos=D,e.h.newDrmInfo(A)),P=Cx(e,y,b,T,t.M,t.type),B=P.segments,(G=P.bandwidth)&&(A.bandwidth=G),q=$u(A),J=x(B),fe=J.next();!fe.done;fe=J.next())te=fe.value,te.$&&(te.$.Hc=q);A.segmentIndex.rd(B,e.l.mb()),B.length&&(ne=Us(y.g,"EXT-X-MEDIA-SEQUENCE",0),xe=(oe=bn(y.g,"EXT-X-SKIP"))?Number(ze(oe,"SKIPPED-SEGMENTS")):0,pe=mx(ne,B),we=pe.ob,Me=pe.pb,t.ob=we+xe,t.pb=Me,Te=b.get(ne),A.segmentIndex.Ma(Te)),(Ne=A.segmentIndex.O[0]||null)&&(t.mc=Ne.startTime,rt=B[B.length-1],t.Jb=rt.endTime),bn(y.g,"EXT-X-ENDLIST")&&(t.ed=!0),Ap(e,y),kp(e,y.g,A.type,T,t.M),F(gt)}})}a.onExpirationUpdated=function(){},a.onInitialVariantChosen=function(){},a.banLocation=function(e){this.j&&this.j.banLocation(e)},a.setMediaElement=function(e){this.ba=e};function sx(e,t){for(var n=e.H==-1,i=x(t),s=i.next();!s.done;s=i.next()){s=s.value;var l=s.stream.segmentIndex,u=Sp(e,s);if(l=l.O[0]||null){u=x(u);for(var c=u.next();!c.done;c=u.next()){c=x(c.value);var d=c.next().value;if(c.next().value==l.startTime){n&&(e.H=Math.max(e.H,d)),s.Re=d;break}}}}if(!(0>e.H))for(t=x(t),n=t.next();!n.done;n=t.next())n=n.value,dl(e,n.type)&&(i=n.stream.segmentIndex)&&(s=e.H-n.Re,0<s&&(i.O.splice(0,s),i=i.O[0]||null)&&(i=-i.startTime,n.stream.segmentIndex.offset(i),ax(e,n,i)))}function fb(e,t){if(e.fa==1/0){t=x(t);for(var n=t.next();!n.done;n=t.next())n=n.value.stream.segmentIndex.O[0]||null,n!=null&&n.h!=null&&(e.fa=Math.min(e.fa,n.h))}if(t=e.fa,t!=1/0){n=x(e.i.values());for(var i=n.next();!i.done;i=n.next())if(i=i.value,!dl(e,i.type)){var s=i.stream.segmentIndex;if(s!=null){var l=s.O[0]||null;if(l)if(l.h==null)Xe("Missing EXT-X-PROGRAM-DATE-TIME for stream",i.M(),"Expect AV sync issues!");else for(ax(e,i,l.h-t-l.startTime),i=x(s),s=i.next();!s.done;s=i.next())s.value.Vf(t)}}}}function ax(e,t,n){t.mc+=n,t.Jb+=n,e=Sp(e,t);for(var i=x(e),s=i.next();!s.done;s=i.next()){var l=x(s.value);s=l.next().value,l=l.next().value,e.set(s,l+n)}t.M()}function cb(e,t,n){var i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne,oe,xe,pe,we,Me,Te,Ne;return $(function(rt){switch(rt.g){case 1:return i=sn,s=vp(e.Fa,t),l=bi(s.g,"EXT-X-DEFINE"),u=[],c=[],d=[],e.l=new Qe(null,0),e.l.sc(!0),g=function(){return[n]},y=null,w=new Map,s.type==1?(e.R=!1,z=bi(s.g,"EXT-X-DEFINE"),w=Cp(e,z,e.L),y=i.ga,P="",B=new Map,E(rt,gx(e,e.B++,w,s,g,"",y,P,!0,"Media Playlist",null,B,null,!1,null,!1),7)):(db(e,l),C=bi(s.g,"EXT-X-MEDIA"),T=bi(s.g,"EXT-X-STREAM-INF"),A=bi(s.g,"EXT-X-IMAGE-STREAM-INF"),b=bi(s.g,"EXT-X-I-FRAME-STREAM-INF"),k=bi(s.g,"EXT-X-SESSION-KEY"),O=bi(s.g,"EXT-X-SESSION-DATA"),D=bi(s.g,"EXT-X-CONTENT-STEERING"),gb(e,O),E(rt,mb(e,D),4));case 4:return pb(e,T),Cb(e,C),E(rt,wb(e,T,k,C,g,e.s),5);case 5:return u=rt.h,c=yb(e,C),E(rt,vb(e,A,b),6);case 6:d=rt.h,rt.u(3);break;case 7:G=rt.h,e.i.set(n,G),G.stream&&(q=$u(G.stream),G.stream.segmentIndex.Hb(function(gt){gt.$&&(gt.$.Hc=q)})),y=G.stream.type,u.push({id:0,language:It(P||"und"),disabledUntilTime:0,primary:!0,audio:y=="audio"?G.stream:null,video:y=="video"?G.stream:null,bandwidth:G.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.h)throw new K(2,7,7001);if(s.type==1&&(ni(e)&&(wx(e,s),J=e.o,e.A.Y(J)),fe=Array.from(e.i.values()),Ep(e,fe),Tp(e),kp(e,s.g,y,w,g)),e.m={presentationTimeline:e.l,variants:u,textStreams:c,imageStreams:d,offlineSessionIds:[],minBufferTime:0,sequenceMode:e.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:e.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1},e.ea||!e.g.hls.disableCodecGuessing){rt.u(8);break}for(te=[],ne=x(e.m.variants),oe=ne.next();!oe.done;oe=ne.next())xe=oe.value,xe.audio&&xe.audio.codecs===""&&te.push(xe.audio.createSegmentIndex()),xe.video&&xe.video.codecs===""&&te.push(xe.video.createSegmentIndex());return E(rt,Promise.all(te),8);case 8:if(e.h.makeTextStreamsForClosedCaptions(e.m),u.length==1){for(pe=[],we=u[0],Me=x([we.video,we.audio]),Te=Me.next();!Te.done;Te=Me.next())(Ne=Te.value)&&!Ne.segmentIndex&&pe.push(Ne.createSegmentIndex());if(0<pe.length)return E(rt,Promise.all(pe),0)}rt.u(0)}})}function hb(e,t){var n,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J;return $(function(fe){switch(fe.g){case 1:if(n=Vu(e.g.hls.mediaPlaylistFullMimeType),!t.length)return fe.return(n);if(i=Ex(e,t),s=i.segment,l=i.segmentIndex,u=s.M(),c=u[0],d=new tn(c),g=d.Pa.split(".").pop(),y=Mp[g])return fe.return(Vu(y));if(w=Ki,T=C=null,A=s.$,!A){fe.u(2);break}return b=gs(A.M(),A.Xb(),A.Ub(),e.g.retryParameters),E(fe,Bo(e,b,w,{type:0}),3);case 3:if(k=fe.h,C=k.data,!A.aesKey){fe.u(4);break}return E(fe,gd(C,A.aesKey,0),5);case 5:C=fe.h;case 4:(T=k.headers["content-type"])&&(T=T.split(";")[0].toLowerCase());case 2:return O=gs(s.M(),s.Xb(),s.Ub(),e.g.retryParameters),E(fe,Bo(e,O,w,{type:1}),6);case 6:if(D=fe.h,z=D.data,!s.aesKey){fe.u(7);break}return E(fe,gd(z,s.aesKey,l),8);case 8:z=fe.h;case 7:if((P=D.headers["content-type"])&&(P=P.split(";")[0].toLowerCase()),B="mp4 mp4a m4s m4i m4a m4f cmfa mp4v m4v cmfv fmp4".split(" "),G=["audio/mp4","video/mp4","video/iso.segment"],Oa(Ze(z))){var te=z,ne=Ze(te);ne=new jt().parse(ne);var oe=ne.$c();ne=ne.kf();var xe=[],pe=!1,we=!1;switch(oe.audio){case"aac":case"aac-loas":xe.push("mp4a.40.2"),pe=!0;break;case"mp3":xe.push("mp4a.40.34"),pe=!0;break;case"ac3":xe.push("ac-3"),pe=!0;break;case"ec3":xe.push("ec-3"),pe=!0;break;case"opus":xe.push("opus"),pe=!0}switch(oe.video){case"avc":ne.codec?xe.push(ne.codec):xe.push("avc1.42E01E"),we=!0;break;case"hvc":ne.codec?xe.push(ne.codec):xe.push("hvc1.1.6.L93.90"),we=!0;break;case"av1":xe.push("av01.0.01M.08"),we=!0}if(xe.length){if(oe=pe&&!we,pe=new Map,we){we=new fn("video/mp2t"),we.i(te),te=x(we.j());for(var Me=te.next();!Me.done;Me=te.next())Me=Me.value,pe.set(Me,Me);we.g()}ne={type:oe?"audio":"video",mimeType:"video/mp2t",codecs:xe.join(", "),language:null,height:ne.height,width:ne.width,channelCount:null,sampleRate:null,closedCaptions:pe,xd:null,colorGamut:null}}else ne=null;if(q=ne)return fe.return(q)}else if((B.includes(g)||G.includes(P)||T&&G.includes(T))&&(J=lE(C,z)))return fe.return(J);return P?fe.return(Vu(P)):T?fe.return(Vu(T)):fe.return(n)}})}function Tp(e){if(ni(e)){if(e.xa==$f){for(var t,n=t=1/0,i=x(e.i.values()),s=i.next();!s.done;s=i.next())s=s.value,s.stream.segmentIndex&&s.stream.type!="text"&&(t=Math.min(t,s.Jb),n=Math.min(n,s.mc));t-=n,e.g.hls.useSafariBehaviorForLive&&(t=e.l.A),isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.l.pe(t)}}else e.l.Za(dx(e));if(!e.l.s)for(t=x(e.i.values()),n=t.next();!n.done;n=t.next())n=n.value,!n.stream.segmentIndex||n.type!="audio"&&n.type!="video"||(n=n.stream.segmentIndex.get(0))&&n.h&&e.l.bh(n.h);e.l.Wd()}function db(e,t){var n=new tn(e.L).g;t=x(t);for(var i=t.next();!i.done;i=t.next()){var s=i.value;i=ze(s,"NAME");var l=ze(s,"VALUE");s=ze(s,"QUERYPARAM"),i&&l&&(e.s.has(i)||e.s.set(i,l)),s&&(i=n.get(s)[0])&&!e.s.has(i)&&e.s.set(s,i)}}function Cp(e,t,n){n=new tn(n).g;var i=new Map;t=x(t);for(var s=t.next();!s.done;s=t.next()){var l=s.value,u=ze(l,"NAME"),c=ze(l,"VALUE");s=ze(l,"QUERYPARAM"),l=ze(l,"IMPORT"),u&&c&&(i.has(u)||i.set(u,c)),s&&(u=n.get(s)[0])&&!i.has(u)&&i.set(s,u),l&&(s=e.s.get(l))&&i.set(l,s)}return i}function pb(e,t){t=x(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,s=ze(i,"AUDIO");n=ze(i,"VIDEO");var l=ze(i,"SUBTITLES");if(i=lx(e,i),l){var u=qn(mt,i);e.F.set(l,u),Fn(i,u)}s&&(l=qn("audio",i),l||(l=e.g.hls.defaultAudioCodec),e.F.set(s,l)),n&&(s=qn("video",i),s||(s=e.g.hls.defaultVideoCodec),e.F.set(n,s))}}function gb(e,t){t=x(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,s=ze(i,"DATA-ID");n=ze(i,"URI");var l=ze(i,"LANGUAGE");i=ze(i,"VALUE"),s=new Map().set("id",s),n&&s.set("uri",tr([e.L],n,e.s)[0]),l&&s.set("language",l),i&&s.set("value",i),n=new Ue("sessiondata",s),e.h&&e.h.onEvent(n)}}function mb(e,t){var n,i,s,l,u,c;return $(function(d){if(!e.h||!e.g)return d.return();for(i=x(t),s=i.next();!s.done;s=i.next())if(l=s.value,u=ze(l,"PATHWAY-ID"),c=ze(l,"SERVER-URI"),u&&c){e.j=new Ds(e.h),e.j.configure(e.g),e.j.i=[e.L],e.j.setManifestType("HLS"),e.j.h=u,n=rl(e.j,c);break}return E(d,n,0)})}function yb(e,t){var n=ex(t,"SUBTITLES");t=n.map(function(u){if(e.g.disableText)return null;try{return hx(e,[u],new Map).stream}catch(c){if(e.g.hls.ignoreTextStreamFailures)return null;throw c}}),n=x(n);for(var i=n.next();!i.done;i=n.next()){var s=Mt(i.value,"GROUP-ID");if((i=e.F.get(s))&&(s=e.G.get(s))){s=x(s);for(var l=s.next();!l.done;l=s.next())l=l.value,l.stream.codecs=i,l.stream.mimeType=bp(mt,i)||Uf(mt),Bs(l.stream)}}return t.filter(function(u){return u})}function Bs(e){var t=new Set([an(e.mimeType,e.codecs)]);e.segmentIndex&&e.segmentIndex.Hb(function(n){n.mimeType&&t.add(an(n.mimeType,e.codecs))}),e.fullMimeTypes=t}function vb(e,t,n){var i,s;return $(function(l){return l.g==1?(i=t.map(function(u){var c,d;return $(function(g){if(g.g==1)return e.g.disableThumbnails?g.return(null):(ue(g,2),E(g,Eb(e,u),4));if(g.g!=2)return c=g.h,g.return(c.stream);if(d=ie(g),e.g.hls.ignoreImageStreamFailures)return g.return(null);throw d})}).concat(n.map(function(u){if(e.g.disableThumbnails)return null;try{var c=Mt(u,"URI"),d=ze(u,"CODECS")||"";if(e.i.has(c))var g=e.i.get(c);else{var y=ze(u,"LANGUAGE"),w=ze(u,"NAME"),C=ze(u,"CHARACTERISTICS"),T=Of(e,e.B++,[c],d,"image",y,!1,w,null,null,C,!1,null,!1),A=ze(u,"RESOLUTION"),b=x(A?A.split("x"):[null,null]),k=b.next().value,O=b.next().value;T.stream.width=Number(k)||void 0,T.stream.height=Number(O)||void 0;var D=ze(u,"BANDWIDTH");D&&(T.stream.bandwidth=Number(D)),e.i.set(c,T),g=T}return u=g,u.stream.codecs!=="mjpg"?null:u.stream}catch(z){if(e.g.hls.ignoreImageStreamFailures)return null;throw z}})),E(l,Promise.all(i),2)):(s=l.h,l.return(s.filter(function(u){return u})))})}function xb(e,t,n){t=t.filter(function(c){var d=ze(c,"URI")||"";return ze(c,"TYPE")!="SUBTITLES"&&d!=""});var i={};t=x(t);for(var s=t.next();!s.done;s=t.next()){s=s.value;var l=Zv(s,!e.j);i[l]?i[l].push(s):i[l]=[s]}for(var u in i)hx(e,i[u],n)}function wb(e,t,n,i,s,l){var u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne,oe,xe,pe,we,Me,Te,Ne,rt,gt,Xt,wt,Yt,rn;return $(function(Wt){switch(Wt.g){case 1:if(u=[],c=new Set,!(0<n.length)){Wt.u(2);break}d=x(n),g=d.next();case 3:if(g.done){Wt.u(2);break}if(y=g.value,w=Mt(y,"METHOD"),C=ze(y,"KEYFORMAT")||"identity",T=null,w=="NONE"){Wt.u(4);break}if(jf(w)){A=tr(s(),Mt(y,"URI"),l),b=A.sort().join(""),e.K.has(b)||(k=dn(A,e.g.retryParameters),O=Bo(e,k,6),e.K.set(b,O)),Wt.u(4);break}if(C!="identity"){T=(D=Mx[C])?D(y,""):null,Wt.u(6);break}return E(Wt,bx(e,y,"",s,null,l),9);case 9:T=Wt.h;case 6:if(T){if(T.keyIds)for(z=x(T.keyIds),P=z.next();!P.done;P=z.next())B=P.value,c.add(B);u.push(T)}case 4:g=d.next(),Wt.u(3);break;case 2:for(G={},q=x(t),J=q.next();!J.done;J=q.next())fe=J.value,te=Zv(fe,!e.j),G[te]?G[te].push(fe):G[te]=[fe];ne=[];for(oe in G)xe=G[oe],pe=xe[0],we=ze(pe,"FRAME-RATE"),Me=Number(ze(pe,"AVERAGE-BANDWIDTH"))||Number(Mt(pe,"BANDWIDTH")),Te=ze(pe,"RESOLUTION"),Ne=x(Te?Te.split("x"):[null,null]),rt=Ne.next().value,gt=Ne.next().value,Xt=ze(pe,"VIDEO-RANGE"),(wt=ze(pe,"REQ-VIDEO-LAYOUT"))&&wt.includes(",")&&(Yt=wt.split(",").filter(function(At){return At=="CH-STEREO"||At=="CH-MONO"}),wt=Yt[0]),wt=wt||"CH-MONO",rn=Sb(e,xe,i),ne.push.apply(ne,L(Tb(e,rn.audio,rn.video,Me,rt,gt,we,Xt,wt,u,c)));return Wt.return(ne.filter(function(At){return At!=null}))}})}function Sb(e,t,n){for(var i={audio:[],video:[]},s=new Map,l=[],u=!1,c=!1,d=x(t),g=d.next();!g.done;g=d.next()){var y=g.value;g=ze(y,"AUDIO");var w=ze(y,"VIDEO"),C=g||w;C&&(l.includes(C)||l.push(C),(y=ze(y,"PATHWAY-ID"))&&s.set(C,y),g?u=!0:w&&(c=!0))}l.length&&n.length&&(d=n.filter(function(b){return l.includes(Mt(b,"GROUP-ID"))}),xb(e,d,s)),d=(s=l.sort().join(","))&&e.G.has(s)?e.G.get(s):[],u?i.audio.push.apply(i.audio,L(d)):c&&i.video.push.apply(i.video,L(d)),g=!1;var T=t.map(function(b){return Mt(b,"URI")});if(c=i.audio.find(function(b){return b&&b.M().find(function(k){return T.includes(k)})}),u=lx(e,t[0]),w=qn("video",u),(C=qn("audio",u))&&!w?(c="audio",g=0<i.audio.length):!i.audio.length&&!i.video.length&&C&&w?(c="video",u=[[w,C].join()]):i.audio.length&&c?(c="audio",g=!0):c=i.video.length&&!i.audio.length?"audio":"video",!g){var A=y=C=w=g=null;!d.length&&(n=n.find(function(b){var k=ze(b,"URI")||"",O=ze(b,"TYPE");return b=Mt(b,"GROUP-ID"),O!="SUBTITLES"&&k==""&&l.includes(b)}))&&(g=ze(n,"LANGUAGE"),w=ze(n,"NAME"),C=ux(n),cx(n),y=ze(n,"CHARACTERISTICS"),A=fx(n)),e=Ab(e,t,u,c,g,w,C,y,A),s&&(e.stream.groupId=s),i[e.stream.type]=[e]}return i}function lx(e,t){var n=ze(t,"CODECS")||"";return t=ze(t,"SUPPLEMENTAL-CODECS"),e.ea=0<n.length,e.ea||e.g.hls.disableCodecGuessing||(n=[],e.g.disableVideo||n.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||n.push(e.g.hls.defaultAudioCodec),n=n.join(",")),e=n.split(/\s*,\s*/),t&&(t=t.split(/\s*,\s*/).map(function(i){return i.split("/")[0]}),e.push.apply(e,L(t))),pd(e)}function ux(e){return(e=ze(e,"CHANNELS"))?parseInt(e.split("/")[0],10):null}function fx(e){return(e=ze(e,"SAMPLE-RATE"))?parseInt(e,10):null}function cx(e){return(e=ze(e,"CHANNELS"))?e.includes("/JOC"):!1}function Tb(e,t,n,i,s,l,u,c,d,g,y){for(var w=x(n),C=w.next();!C.done;C=w.next())Ax(C.value.stream,s,l,u,c,d,null);for(s=e.g.disableAudio,(!t.length||s)&&(t=[null]),s=e.g.disableVideo,(!n.length||s)&&(n=[null]),s=[],t=x(t),l=t.next();!l.done;l=t.next())for(l=l.value,u=x(n),c=u.next();!c.done;c=u.next()){var T=c.value;(c=l?l.stream:null)&&(c.drmInfos=g,c.keyIds=y),(d=T?T.stream:null)&&(d.drmInfos=g,d.keyIds=y),d&&!c&&(d.bandwidth=i),!d&&c&&(c.bandwidth=i),w=l?l.stream.drmInfos:null,C=T?T.stream.drmInfos:null,T=T?T.M().sort().join(","):"";var A=l?l.M().sort().join(","):"";T=T+" - "+A,c&&d&&!bg(w,C)||e.ub.has(T)||(c={id:e.B++,language:c?c.language:"und",disabledUntilTime:0,primary:!!c&&c.primary||!!d&&d.primary,audio:c,video:d,bandwidth:i,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},s.push(c),e.ub.add(T))}return s}function Cb(e,t){t=ex(t,"CLOSED-CAPTIONS"),e.R=t.length==0,t=x(t);for(var n=t.next();!n.done;n=t.next()){var i=n.value,s=ze(i,"LANGUAGE");n=It(s||"und"),s||(s=ze(i,"NAME"))&&(n=s),s=Mt(i,"GROUP-ID"),i=Mt(i,"INSTREAM-ID").replace("SERVICE","svc"),e.C.get(s)||e.C.set(s,new Map),e.C.get(s).set(i,n)}}function hx(e,t,n){for(var i=[],s=[],l=new Map,u=x(t),c=u.next();!c.done;c=u.next()){var d=c.value;c=Mt(d,"URI"),d=Mt(d,"GROUP-ID"),i.push(c),s.push(d),l.set(d,c)}if(u=s.sort().join(","),c=t[0],t="",d=Mt(c,"TYPE").toLowerCase(),d=="subtitles"&&(d=mt),d==mt)t=ze(c,"CODECS")||"";else{s=x(s);for(var g=s.next();!g.done;g=s.next())if(g=g.value,e.F.has(g)){t=e.F.get(g);break}}if(s=i.sort().join(","),e.i.has(s))return e.i.get(s);if(g=e.B++,e.j){l=x(l);for(var y=l.next();!y.done;y=l.next()){var w=x(y.value);y=w.next().value,w=w.next().value,(y=n.get(y))&&Ns(e.j,g,y,w)}}n=ze(c,"LANGUAGE"),l=ze(c,"NAME"),y=ze(c,"DEFAULT")=="YES",w=d=="audio"?ux(c):null;var C=d=="audio"?cx(c):!1,T=ze(c,"CHARACTERISTICS"),A=ze(c,"FORCED")=="YES";return c=d=="audio"?fx(c):null,i=Of(e,g,i,t,d,n,y,l,w,null,T,A,c,C),i.stream&&(i.stream.groupId=u),e.G.has(u)?e.G.get(u).push(i):e.G.set(u,[i]),e.i.set(s,i),i}function Eb(e,t){var n,i,s,l,u,c,d,g,y,w;return $(function(C){return C.g==1?(n=Mt(t,"URI"),i=ze(t,"CODECS","jpeg")||"",e.i.has(n)?C.return(e.i.get(n)):(s=ze(t,"LANGUAGE"),l=ze(t,"NAME"),u=ze(t,"CHARACTERISTICS"),c=Of(e,e.B++,[n],i,"image",s,!1,l,null,null,u,!1,null,!1),(d=ze(t,"RESOLUTION"))?E(C,c.stream.createSegmentIndex(),3):C.u(2))):(C.g!=2&&(g=c.stream.segmentIndex.get(0),y=g.tilesLayout)&&(c.stream.width=Number(d.split("x")[0])*Number(y.split("x")[0]),c.stream.height=Number(d.split("x")[1])*Number(y.split("x")[1])),(w=ze(t,"BANDWIDTH"))&&(c.stream.bandwidth=Number(w)),e.i.set(n,c),C.return(c))})}function Ab(e,t,n,i,s,l,u,c,d){for(var g=e.B++,y=[],w=x(t),C=w.next();!C.done;C=w.next()){var T=C.value;C=Mt(T,"URI"),T=ze(T,"PATHWAY-ID"),e.j&&T&&Ns(e.j,g,T,C),y.push(C)}if(w=y.sort().join(","),e.i.has(w))return e.i.get(w);e:{if(t=ze(t[0],"CLOSED-CAPTIONS"),i=="video"){if(e.g.disableText){e.R=!1,t=null;break e}if(t){if(t!="NONE"){t=e.C.get(t);break e}e.R=!1}else if(!t&&e.C.size)for(t=x(e.C.keys()).next();!t.done;){t=e.C.get(t.value);break e}}t=null}return n=Yr(i,n),i=Of(e,g,y,n,i,s,!1,l,u,t,c,!1,d,!1),e.i.set(w,i),i}function Of(e,t,n,i,s,l,u,c,d,g,y,w,C,T){function A(B){var G,q,J,fe,te,ne,oe,xe,pe,we,Me,Te,Ne,rt,gt,Xt,wt,Yt,rn,Wt,At,en;return $(function(cn){switch(cn.g){case 1:return G=sn,q=D.M(),ue(cn,2),E(cn,Ip(e,D.M(),!0),4);case 4:J=cn.h,ge(cn,3);break;case 2:if(fe=ie(cn),k.closeSegmentIndex(),e.h.disableStream(k))return cn.return();throw fe;case 3:if(B.aborted)return cn.return();if(te=J.uri,te==J.originalUri||q.includes(te)||O.push(te),ne=vp(e.Fa,J.data),ne.type!=1)throw new K(2,4,4017);return oe=bi(ne.g,"EXT-X-DEFINE"),xe=Cp(e,oe,te),pe=!1,(!e.ea&&e.g.hls.disableCodecGuessing||e.R&&s==G.ga&&!e.g.hls.disableClosedCaptionsDetection)&&0<ne.segments.length&&(e.R=!1,pe=!0),we=!e.ea&&e.g.hls.disableCodecGuessing,Me=ni(e),E(cn,gx(e,0,xe,ne,b,i,s,l,u,c,d,g,y,w,C,T,void 0,pe,we),5);case 5:if(Te=cn.h,B.aborted)return cn.return();if(Ne=Te.stream,ni(e)&&!Me&&wx(e,ne),D.mc=Te.mc,D.Jb=Te.Jb,D.Gd=Te.Gd,D.Fd=Te.Fd,D.ed=Te.ed,D.Yd=Te.Yd,D.ob=Te.ob,D.pb=Te.pb,D.vf=!0,k.segmentIndex=Ne.segmentIndex,k.encrypted=Ne.encrypted,k.drmInfos=Ne.drmInfos,k.keyIds=Ne.keyIds,k.mimeType=Ne.mimeType,k.bandwidth=k.bandwidth||Ne.bandwidth,k.codecs=k.codecs||Ne.codecs,k.closedCaptions=k.closedCaptions||Ne.closedCaptions,k.width=k.width||Ne.width,k.height=k.height||Ne.height,k.hdr=k.hdr||Ne.hdr,k.colorGamut=k.colorGamut||Ne.colorGamut,k.language=="und"&&Ne.language!="und"&&(k.language=Ne.language),k.language=k.language||Ne.language,k.channelsCount=k.channelsCount||Ne.channelsCount,k.audioSamplingRate=k.audioSamplingRate||Ne.audioSamplingRate,Bs(k),k.drmInfos.length&&e.h.newDrmInfo(k),rt=!1,(!g&&k.closedCaptions||g&&k.closedCaptions&&g.size!=k.closedCaptions.size)&&(rt=!0),e.m&&rt&&e.h.makeTextStreamsForClosedCaptions(e.m),s==G.ga||s==G.X)for(gt=x(e.i.values()),Xt=gt.next();!Xt.done;Xt=gt.next())wt=Xt.value,wt.vf||wt.type!=s||(wt.stream.mimeType=Ne.mimeType,Bs(wt.stream));s==G.ua&&(Yt=Ne.segmentIndex.get(0))&&Yt.$&&(k.mimeType="application/mp4",Bs(k)),rn=$u(k),k.segmentIndex.Hb(function(hn){hn.$&&(hn.$.Hc=rn)}),kb(e)&&(e.Gb?Ep(e,[D]):(e.Gb=!0,Wt=Array.from(e.i.values()),At=Wt.filter(function(hn){return hn.stream.segmentIndex}),Ep(e,At),Tp(e),en=e.o,0<en&&e.A.Y(en))),kp(e,ne.g,k.type,xe,b),F(cn)}})}function b(){return e.j&&1<n.length?sl(e.j,t):O.concat(tx([e.L],n,e.s))}var k=yx(e,i,s,l,u,c,d,g,y,w,C,T),O=[],D={stream:k,type:s,Tg:O,M:b,mc:0,Jb:0,Yd:new Map,Gd:!1,Fd:!1,ed:!1,Re:-1,ob:-1,pb:-1,vf:!1},z=null,P=new AbortController;return k.createSegmentIndex=function(){return z||(P=new AbortController,z=new Promise(function(B){B(A(P.signal))}))},k.closeSegmentIndex=function(){z&&!k.segmentIndex&&P.abort(),k.segmentIndex&&(k.segmentIndex.release(),k.segmentIndex=null),z=null},D}function dx(e){var t=1/0;e=x(e.i.values());for(var n=e.next();!n.done;n=e.next())n=n.value,n.stream.segmentIndex&&n.stream.type!="text"&&(t=Math.min(t,n.Jb));return t}function px(e,t){var n=[];t=x(t);for(var i=t.next();!i.done;i=t.next())i=i.value,i.segmentIndex&&i.segmentIndex.Hb(function(s){n.push(s)});e.l.sd(n)}function Ep(e,t){if(!ni(e))for(var n=dx(e),i=x(t),s=i.next();!s.done;s=i.next())s.value.stream.segmentIndex.Bc(0,n);px(e,t.map(function(l){return l.stream})),e.g.hls.ignoreManifestProgramDateTime?sx(e,t):(fb(e,t),0<e.g.hls.ignoreManifestProgramDateTimeForTypes.length&&sx(e,t))}function dl(e,t){return e.g.hls.ignoreManifestProgramDateTime?!0:e.g.hls.ignoreManifestProgramDateTimeForTypes.includes(t)}function kb(e){if(!e.m)return!1;var t=[],n=[];e=x(e.m.variants);for(var i=e.next();!i.done;i=e.next())i=i.value,i.video&&t.push(i.video),i.audio&&n.push(i.audio);return!(0<t.length&&!t.some(function(s){return s.segmentIndex})||0<n.length&&!n.some(function(s){return s.segmentIndex}))}function gx(e,t,n,i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D){O=O===void 0?!0:O,D=D===void 0?!0:D;var z,P,B,G,q,J,fe,te,ne,oe,xe,pe,we,Me,Te,Ne,rt,gt,Xt,wt,Yt,rn,Wt,At,en,cn;return $(function(hn){switch(hn.g){case 1:var ri=bn(i.g,"EXT-X-PLAYLIST-TYPE"),si=bn(i.g,"EXT-X-ENDLIST");if(si=ri&&ri.value=="VOD"||si,ri=ri&&ri.value=="EVENT"&&!si,ri=!si&&!ri,si?Bf(e,Ff):ri?Bf(e,$f):Bf(e,Rx),ni(e)&&Ap(e,i),z=ni(e)?e.N.get(u):new Map,P=Cx(e,i,z,n,s,u),B=P.segments,G=P.bandwidth,te=fe=J=q=null,!(0<B.length&&O)){hn.u(2);break}return E(hn,hb(e,B),3);case 3:ne=hn.h,u=ne.type,c=ne.language,y=ne.channelCount,A=ne.sampleRate,e.g.disableText||(w=ne.closedCaptions),J=ne.height,q=ne.width,fe=ne.xd,te=ne.colorGamut,D&&(k=ne.mimeType,l=ne.codecs);case 2:if(k){hn.u(4);break}return E(hn,Mb(e,u,l,B),5);case 5:k=hn.h;case 4:return E(hn,vx(e,i,k,s,n),6);case 6:if(oe=hn.h,xe=oe.drmInfos,pe=oe.keyIds,we=oe.encrypted,Me=oe.wh,we&&!xe.length&&!Me)throw new K(2,4,4026);return Te=yx(e,l,u,c,d,g,y,w,C,T,A,b),Te.encrypted=we,Te.drmInfos=xe,Te.keyIds=pe,Te.mimeType=k,G&&(Te.bandwidth=G),Bs(Te),u=="video"&&(q||J||fe||te)&&Ax(Te,q,J,null,fe,null,te),ni(e)&&Ap(e,i),Ne=B[0].startTime,rt=B[B.length-1],gt=rt.endTime,Xt=new xt(B),Te.segmentIndex=Xt,Yt=(wt=bn(i.g,"EXT-X-SERVER-CONTROL"))?hl(wt,"CAN-SKIP-UNTIL")!=null:!1,rn=wt?hl(wt,"CAN-BLOCK-RELOAD")!=null:!1,Wt=Us(i.g,"EXT-X-MEDIA-SEQUENCE",0),At=mx(Wt,B),en=At.ob,cn=At.pb,hn.return({stream:Te,type:u,Tg:[],M:s,mc:Ne,Jb:gt,Gd:Yt,Fd:rn,ed:!1,Re:-1,ob:en,pb:cn,Yd:z,vf:!1})}})}function mx(e,t){e=e+t.length-1;var n=-1;if(!t.length)return e++,{ob:e,pb:n};t=t[t.length-1];var i=t.g;return t.g.length?(n=i.length-1,i[i.length-1].preload||(e++,n=0),{ob:e,pb:n}):(e++,t.m&&(n=0),{ob:e,pb:n})}function yx(e,t,n,i,s,l,u,c,d,g,y,w){var C=bp(n,t)||Uf(n),T=[];if(d){d=x(d.split(","));for(var A=d.next();!A.done;A=d.next())T.push(A.value)}return d=void 0,A=null,n==mt?d=T.includes("public.accessibility.transcribes-spoken-dialog")&&T.includes("public.accessibility.describes-music-and-sound")?"caption":"subtitle":T.includes("public.accessibility.describes-video")&&(A="visually impaired"),T.length||d!=="subtitle"||T.push("subtitle"),e={id:e.B++,originalId:l,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:C,codecs:t,kind:n==mt?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:It(i||"und"),originalLanguage:i,label:l,type:n,primary:s,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:T,forced:g,channelsCount:u,audioSamplingRate:y,spatialAudio:w,closedCaptions:c,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:A,external:!1,fastSwitching:!1,fullMimeTypes:new Set},Bs(e),e}function vx(e,t,n,i,s){var l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne,oe,xe,pe,we,Me;return $(function(Te){switch(Te.g){case 1:if(l=new Map,t.segments){for(u=x(t.segments),c=u.next();!c.done;c=u.next())if(d=c.value,g=bi(d.g,"EXT-X-KEY"),y=null,g.length)for(y=Sx(e,t,d.g,i,s),w=x(g),C=w.next();!C.done;C=w.next())T=C.value,l.set(T,y)}b=A=!1,k=[],O=new Set,D=x(l),z=D.next();case 2:if(z.done){Te.u(4);break}if(P=z.value,B=x(P),G=B.next().value,q=B.next().value,J=G,fe=q,te=Mt(J,"METHOD"),te=="NONE"){Te.u(3);break}if(A=!0,ne=ze(J,"KEYFORMAT")||"identity",oe=null,jf(te)){b=!0,Te.u(3);break}if(ne!="identity"){oe=(xe=Mx[ne])?xe(J,n):null,Te.u(6);break}return E(Te,bx(e,J,n,i,fe,s),8);case 8:oe=Te.h;case 6:if(oe){if(oe.keyIds)for(pe=x(oe.keyIds),we=pe.next();!we.done;we=pe.next())Me=we.value,O.add(Me);k.push(oe)}case 3:z=D.next(),Te.u(2);break;case 4:return Te.return({drmInfos:k,keyIds:O,encrypted:A,wh:b})}})}function xx(e,t,n,i,s){if(!p.crypto||!p.crypto.subtle)throw Fe("Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)"),new K(2,4,4042);var l=0,u=ze(t,"IV","");if(u){var c=Tr(u.substr(2));if(c.byteLength!=16)throw new K(2,4,4048)}else l=Us(n.g,"EXT-X-MEDIA-SEQUENCE",0);if(n=t.toString()+"-"+l,!e.oa.has(n)){var d={bitsKey:128,blockCipherMode:"CBC",iv:c,firstMediaSequenceNumber:l};switch(Mt(t,"METHOD")){case"AES-256":d.bitsKey=256;break;case"AES-256-CTR":d.bitsKey=256,d.blockCipherMode="CTR"}d.fetchKey=function(){var g,y,w,C,T,A;return $(function(b){if(b.g==1)return g=tr(i(),Mt(t,"URI"),s),y=g.sort().join(""),e.K.has(y)||(w=dn(g,e.g.retryParameters),C=Bo(e,w,6),e.K.set(y,C)),E(b,e.K.get(y),2);if(b.g!=3){if(T=b.h,!T.data||T.data.byteLength!=d.bitsKey/8)throw new K(2,4,4049);return A={name:d.blockCipherMode=="CTR"?"AES-CTR":"AES-CBC",length:d.bitsKey},E(b,p.crypto.subtle.importKey("raw",T.data,A,!0,["decrypt"]),3)}d.cryptoKey=b.h,d.fetchKey=void 0,F(b)})},e.oa.set(n,d)}return e.oa.get(n)}function Ap(e,t){var n=1/0,i=t.segments;if(i.length)for(var s=i.length-1;0<=s;){var l=bn(i[s].g,"EXTINF");if(l){n=Number(l.value.split(",")[0]);break}s--}if(i=bn(t.g,"EXT-X-TARGETDURATION"),!i)throw new K(2,4,4024,"EXT-X-TARGETDURATION");i=Number(i.value),(s=bn(t.g,"EXT-X-PART-INF"))&&(e.U=Number(Mt(s,"PART-TARGET"))),t=bn(t.g,"EXT-X-SERVER-CONTROL"),e.I&&e.U?(e.o=e.Fb?5*e.U<=n?Math.min(e.U,e.o):Math.min(n,e.o):Math.min(e.U,e.o),e.Da=t?Number(Mt(t,"PART-HOLD-BACK")):0):(e.o=Math.min(n,e.o),n=t?hl(t,"HOLD-BACK"):null,e.za=n?Number(n.value):0),e.ab=Math.max(i,e.ab)}function wx(e,t){if(e.g.defaultPresentationDelay)t=e.g.defaultPresentationDelay;else if(e.Da)t=e.Da;else if(e.za)t=e.za;else{t=t.segments.length;var n=e.g.hls.liveSegmentsDelay;n>t-2&&(n=Math.max(1,t-2)),t=e.ab*n}e.l.dh(0),e.l.Of(t),e.l.sc(!1)}function Sx(e,t,n,i,s){var l=bn(n,"EXT-X-MAP");if(!l)return null;var u=Mt(l,"URI"),c=tr(i(),u,s);if(u=[c.toString(),ze(l,"BYTERANGE","")].join("-"),!e.qa.has(u)){var d=void 0,g=null;n=x(n);for(var y=n.next();!y.done;y=n.next())y=y.value,y.name=="EXT-X-KEY"?jf(Mt(y,"METHOD"))&&y.id<l.id&&(d=xx(e,y,t,i,s)):y.name=="EXT-X-BYTERANGE"&&y.id<l.id&&(g=y);t=bb(c,l,g,d),e.qa.set(u,t)}return e.qa.get(u)}function bb(e,t,n,i){var s=0,l=null;return t=ze(t,"BYTERANGE"),!t&&n&&(t=n.value),t&&(s=t.split("@"),l=Number(s[0]),s=Number(s[1]),l=s+l-1,i&&(n=l+1-s,n%16&&(l+=16-n%16))),new Kn(function(){return e},s,l,null,null,null,i)}function Ib(e,t,n,i,s,l,u,c,d){function g(Ne){Ne=new tn(Ne).Pa.split(".").pop();var rt=Rp[u][Ne];return rt||(rt=Mp[Ne]),rt}var y=i.g,w=bn(y,"EXTINF"),C=0,T=0,A=null;i.zb.length&&(e.m.isLowLatency=!0);var b=null;if(!e.g.hls.ignoreManifestProgramDateTime){var k=bn(y,"EXT-X-PROGRAM-DATE-TIME");k&&k.value&&(b=qo(k.value))}var O=Yo;if(bn(y,"EXT-X-GAP")&&(e.m.gapCount++,O=2),!w){if(i.zb.length==0)throw new K(2,4,4024,"EXTINF");if(!e.I)return null}var D=[];k=!1;var z=null,P=!1,B=!1;if(e.I&&i.zb.length){C=t&&p.ReadableStream&&e.g.hls.allowLowLatencyByteRangeOptimization;for(var G=b,q={},J=0;J<i.zb.length;q={xe:void 0,ge:void 0},J++){var fe=i.zb[J],te=J==0?n:D[D.length-1],ne=J==0?s:te.endTime,oe=Number(ze(fe,"DURATION"))||e.U;if(oe){var xe=ne+oe,pe=0,we=null;if(fe.name=="EXT-X-PRELOAD-HINT"?(pe=(pe=ze(fe,"BYTERANGE-START"))?Number(pe):0,(te=ze(fe,"BYTERANGE-LENGTH"))?we=pe+Number(te)-1:pe&&(we=Number.MAX_SAFE_INTEGER)):(pe=ze(fe,"BYTERANGE"),we=x(Tx(te,pe)),pe=we.next().value,we=we.next().value),q.ge=ze(fe,"URI"),q.ge){te=Yo,ze(fe,"GAP")=="YES"&&(e.m.gapCount++,te=2,P=!0),q.xe=null;var Me=function(Ne){return function(){return Ne.xe==null&&(Ne.xe=tr(c(),Ne.ge,l)),Ne.xe}}(q);C&&0<=pe&&we!=null&&(z=Me,k=!0),ne=new Je(ne,xe,Me,pe,we,t,0,0,1/0,[],"",null,G,te,d),fe.name=="EXT-X-PRELOAD-HINT"&&(ne.wf(),B=!0),ze(fe,"INDEPENDENT")!="YES"&&0<J&&ne.Xd(),(q=g(q.ge))&&(ne.mimeType=q,Ix.has(q)&&(ne.$=null)),D.push(ne),G&&(G+=oe)}}}}if(w){if(w=Number(w.value.split(",")[0]),w==0)return null;C=s+w}else if(D.length)C=D[D.length-1].endTime;else return null;k&&(P||D[0].Ha!=0?(k=!1,z=null):D=[]),(w=bn(y,"EXT-X-BYTERANGE"))?(A=x(Tx(n,w.value)),T=A.next().value,A=A.next().value):D.length&&(T=D[0].Ha,A=D[D.length-1].sa),n="",w=null,u=="image"&&(n="1x1",y=bn(y,"EXT-X-TILES"))&&(n=Mt(y,"LAYOUT"),(y=ze(y,"DURATION"))&&(w=Number(y)));var Te=null;return t=new Je(s,C,function(){return z?z():(Te==null&&(Te=tr(c(),i.h,l)),Te||[])},T,A,t,0,0,1/0,D,n,w,b,O,d,0<D.length&&!!i.h),(s=g(i.h))&&(t.mimeType=s,Ix.has(s)&&(t.$=null)),k&&(e.Fb=!0,t.Ig(),B&&t.wf()),t}function Tx(e,t){var n=0,i=null;return t&&(n=t.split("@"),t=Number(n[0]),n=n[1]?Number(n[1]):e.sa+1,i=n+t-1),[n,i]}function kp(e,t,n,i,s){if(n=="video"||n=="audio"){var l=e.l.m;if(l&&!dl(e,n))for(t=bi(t,"EXT-X-DATERANGE"),t=t.sort(function(b,k){return b=Mt(b,"START-DATE"),k=Mt(k,"START-DATE"),b<k?-1:b>k?1:0}),n=0;n<t.length;n++){var u=t[n],c=Mt(u,"ID");if(!e.Ea.has(c)){var d=Mt(u,"START-DATE"),g=qo(d);if(!isNaN(g)){d=Math.max(0,g-l);var y=null,w=ze(u,"END-DATE");if(w&&(w=qo(w),!isNaN(w)&&(y=w-l,0>y))||y==null&&(w=ze(u,"DURATION")||ze(u,"PLANNED-DURATION"))&&(w=parseFloat(w),isNaN(w)||(y=d+w),0>g-l+w))continue;w=ze(u,"CLASS")||"com.apple.quicktime.HLS";var C=ze(u,"END-ON-NEXT")=="YES";if(y==null&&C){for(C=n+1;C<t.length;C++){var T=ze(t[C],"CLASS")||"com.apple.quicktime.HLS";if(w==T&&(T=Mt(t[C],"START-DATE"),T=qo(T),!isNaN(T)&&T&&T>g)){y=Math.max(0,T-l);break}}if(y==null)continue}for(g="ID CLASS START-DATE END-DATE DURATION END-ON-NEXT".split(" "),C=[],u=x(u.attributes),T=u.next();!T.done;T=u.next())if(T=T.value,!g.includes(T.name)){var A=nx(T.value,i);(T.name=="X-ASSET-URI"||T.name=="X-ASSET-LIST")&&(A=tr(s(),T.value,i)[0]),C.push({key:T.name,description:"",data:A,mimeType:null,pictureType:null})}C.length&&e.h.onMetadata(w,d,y,C),e.Ea.add(c)}}}}}function Cx(e,t,n,i,s,l){var u=t.segments,c=void 0,d=Us(t.g,"EXT-X-DISCONTINUITY-SEQUENCE",0),g=Us(t.g,"EXT-X-MEDIA-SEQUENCE",0),y=bn(t.g,"EXT-X-SKIP"),w=y?Number(ze(y,"SKIPPED-SEGMENTS")):0,C=g+w,T=0;ni(e)&&n.has(C)&&(T=n.get(C)),T===0&&e.xa==$f&&0<n.size&&!n.has(C)&&(T=e.l.mb());var A=[],b=null;y=[];for(var k=0;k<u.length;k++){var O=u[k],D=k==0?T:b.endTime;C=g+w+k,bn(O.g,"EXT-X-DISCONTINUITY")&&d++;for(var z=x(O.g),P=z.next();!P.done;P=z.next())P=P.value,P.name=="EXT-X-KEY"&&(jf(Mt(P,"METHOD"))?c=xx(e,P,t,s,i):c=void 0);n.set(C,D),z=Sx(e,t,O.g,s,i),!e.I&&e.h.isAutoLowLatencyMode()&&(e.h.enableLowLatencyMode(),e.I=e.h.isLowLatencyMode()),(D=Ib(e,z,b,O,D,i,l,s,c))&&((b=Us(O.g,"EXT-X-BITRATE"))?y.push({bitrate:b,duration:D.endTime-D.startTime}):y.length&&(b=y.pop(),b.duration+=D.endTime-D.startTime,y.push(b)),b=D,D.i=d,dl(e,l)&&e.H!=null&&C<e.H||A.push(D))}if(t=void 0,y.length&&(t=y.reduce(function(B,G){return B+G.duration},0),t=Math.round(y.reduce(function(B,G){return B+G.bitrate*G.duration},0)/t*1e3)),y=A.some(function(B){return B.h!=null})){for(n={},i=0;i<A.length;n={Kd:void 0,Jd:void 0,Bd:void 0,pc:void 0,zd:void 0},i++)if(n.pc=A[i],n.pc.h==null)for(n.Jd=0,n.Kd=i,s=function(B){return function(){var G=A[B.Kd];if(G){if(G.h!=null)return G.h+B.Jd;B.Jd-=G.endTime-G.startTime,B.Kd+=1}return null}}(n),n.zd=0,n.Bd=i,u=function(B){return function(){var G=A[B.Bd];if(G){if(G!=B.pc&&(B.zd+=G.endTime-G.startTime),G.h!=null)return G.h+B.zd;--B.Bd}return null}}(n);n.pc.h==null;)n.pc.h=u(),n.pc.h==null&&(n.pc.h=s())}if(y)for(n=x(A),i=n.next();!i.done;i=n.next())for(s=i.value,i=s.h,s=x(s.g),u=s.next();!u.done;u=s.next())u=u.value,u.h=i,i+=u.endTime-u.startTime;if(n=e.fa,y&&n!=1/0&&!dl(e,l))for(e=x(A),l=e.next();!l.done;l=e.next())l.value.Vf(n);return{segments:A,bandwidth:t}}function bp(e,t){if(e==mt){if(t=="vtt"||t=="wvtt")return"text/vtt";if(t&&t!=="")return"application/mp4"}return e!="image"||t&&t!="jpeg"?e=="audio"&&t=="mp4a.40.34"?"audio/mpeg":t=="mjpg"?"application/mp4":null:"image/jpeg"}function Uf(e){return e==mt?"text/vtt":Rp[e].mp4}function Ex(e,t){e=ni(e)?Math.trunc((t.length-1)/2):0;for(var n=t[e];n.Yb()==2&&e+1<t.length;)e++,n=t[e];return{segment:n,segmentIndex:e}}function Mb(e,t,n,i){var s,l,u,c,d,g,y,w,C,T,A,b,k,O;return $(function(D){switch(D.g){case 1:return s=Ki,l=Ex(e,i),u=l.segment,u.status==2?D.return(Uf(t)):(c=u.M(),d=new tn(c[0]),g=d.Pa.split(".").pop(),y=Rp[t],(w=y[g])||(w=Mp[g])||(w=bp(t,n))?D.return(w):(T=1,A=dn(c,e.g.retryParameters),ue(D,2),A.method="HEAD",E(D,Bo(e,A,s,{type:T}),4)));case 4:b=D.h,C=b.headers["content-type"],ge(D,3);break;case 2:if(k=ie(D),!k||k.code!=1002&&k.code!=1001){D.u(3);break}return A.method="GET",E(D,Bo(e,A,s,{type:T}),6);case 6:O=D.h,C=O.headers["content-type"];case 3:return C?D.return(C.toLowerCase().split(";")[0]):D.return(Uf(t))}})}function Ax(e,t,n,i,s,l,u){e&&(e.width=Number(t)||void 0,e.height=Number(n)||void 0,e.frameRate=Number(i)||void 0,e.hdr=s||void 0,e.videoLayout=l||void 0,e.colorGamut=u||void 0)}function Ip(e,t,n){return Bo(e,dn(t,e.g.retryParameters),0,{type:n?2:3})}function kx(e){var t,n,i,s,l,u;return $(function(c){switch(c.g){case 1:return e.h?(ue(c,2),t=Date.now(),E(c,e.update(),4)):c.return();case 4:n=Date.now(),ni(e)&&(i=(n-t)/1e3,e.Db.sample(1,i),s=e.o,l=Math.max(0,s-Q(e.Db)),e.A.Y(l)),ge(c,3);break;case 2:if(u=ie(c),!e.h)return c.return();if(e.g.raiseFatalErrorOnManifestUpdateRequestFailure)return e.h.onError(u),c.return();u.severity=1,e.h.onError(u),e.A.Y(.1);case 3:if(!e.h)return c.return();e.h.onManifestUpdated(),F(c)}})}function ni(e){return e.xa!=Ff}function Bf(e,t){e.xa=t,e.l&&e.l.sc(!ni(e)),ni(e)||e.A.stop()}function Bo(e,t,n,i){if(!e.da)throw new K(2,7,7001);return t=e.h.networkingEngine.request(n,t,i),Ir(e.da,t),t.promise}function jf(e){return e=="AES-128"||e=="AES-256"||e=="AES-256-CTR"}function bx(e,t,n,i,s,l){var u,c,d,g,y,w,C,T,A,b,k,O,D,z,P;return $(function(B){switch(B.g){case 1:if(n=="video/mp2t")throw new K(2,4,4040);if(cu())throw new K(2,4,4041);if(u=Mt(t,"METHOD"),c=["SAMPLE-AES","SAMPLE-AES-CTR"],!c.includes(u))return B.return(null);if(d=tr(i(),Mt(t,"URI"),l),d[0].startsWith("data:text/plain;base64,")){g=So(Ti(d[0].split("data:text/plain;base64,").pop())),B.u(2);break}return y=d.sort().join(""),e.pa.has(y)||(w=dn(d,e.g.retryParameters),C=Bo(e,w,6),e.pa.set(y,C)),E(B,e.pa.get(y),3);case 3:T=B.h,g=So(T.data);case 2:if(A="00000000000000000000000000000000",!s){B.u(4);break}if(e.ya.has(s)){b=e.ya.get(s),B.u(5);break}return k=gs(s.M(),s.Xb(),s.Ub(),e.g.retryParameters),O=Ki,E(B,Bo(e,k,O,{type:0}),6);case 6:D=B.h,b=fE(D.data),e.ya.set(s,b);case 5:b&&(A=b);case 4:return z=new Map,z.set(A,g),P="cenc",u=="SAMPLE-AES"&&(P="cbcs"),B.return(Pg(z,P))}})}he("shaka.hls.HlsParser",Nf);var Mp={aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},Rp={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",tsa:"video/mp2t"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t",tsv:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml"},image:{jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif"}},Ix=new Set(["video/mp2t"].concat(L(Xo))),Mx={"com.apple.streamingkeydelivery":function(e,t){if(t=="video/mp2t")throw new K(2,4,4040);if(cu())throw new K(2,4,4041);if(t=Mt(e,"METHOD"),!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t))return null;var n="cenc";return t=="SAMPLE-AES"&&(n="cbcs"),Cr("com.apple.fps",n,[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}],Mt(e,"URI"))},"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=Mt(e,"METHOD");if(!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t))return null;var n="cenc";return t=="SAMPLE-AES"&&(n="cbcs"),t=Mt(e,"URI"),t=wp(t.split("?")[0]),t=Ze(t.data),n=Cr("com.widevine.alpha",n,[{initDataType:"cenc",initData:t}]),(e=ze(e,"KEYID"))&&(n.keyIds=new Set([e.toLowerCase().substr(2)])),n},"com.microsoft.playready":function(e){var t=Mt(e,"METHOD");if(!["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t))return null;var n="cenc";return t=="SAMPLE-AES"&&(n="cbcs"),e=Mt(e,"URI"),e=wp(e.split("?")[0]),e=Ze(e.data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),e=Cu(e,t,new Set,0),Cr("com.microsoft.playready",n,[{initDataType:"cenc",initData:e}])}},Ff="VOD",Rx="EVENT",$f="LIVE",Rb={sh:Ff,qj:Rx,yj:$f};Fi["application/x-mpegurl"]=function(){return new Nf},Fi["application/vnd.apple.mpegurl"]=function(){return new Nf};function _b(e){var t=0,n=xn(e),i=n.getUint32(t,!0);if(i!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){i=n.getUint16(e,!0),e+=2;var s=n.getUint16(e,!0);if(e+=2,s&1||s+e>n.byteLength){n=[];break e}var l=Ze(n,e,s);t.push({type:i,value:l}),e+=s}n=t}return n}function Vf(e){if(e=_x(e))e:{e=x(Bi(e,"DATA"));for(var t=e.next();!t.done;t=e.next())if(t=ji(t.value,"LA_URL")){e=un(t);break e}e=""}else e="";return e}function _x(e){return e=Ti(un(e)),e=_b(e).filter(function(t){return t.type===Lb})[0],e?(e=xo(e.value,!0),(e=ls(e,"WRMHEADER"))?e:null):null}var Lb=1,Pb=new Map().set("com.microsoft.playready",Vf).set("com.microsoft.playready.recommendation",Vf).set("com.microsoft.playready.software",Vf).set("com.microsoft.playready.hardware",Vf);function js(e){if(!Nx){Nx=!0;var t=new Uint8Array([105,115,111,109]),n=new Uint8Array([97,118,99,49]),i=new Uint8Array([0,0,0,1]);Hf=pt("ftyp",t,i,t,n),t=pt("dref",zb),_p=pt("dinf",t)}this.g=e}function Fs(e){for(var t=[],n=x(e.g),i=n.next();!i.done;i=n.next()){var s=t,l=s.push,u=i.value;i=pt;var c=u.id+1,d=u.stream.width||0,g=u.stream.height||0;u.type=="audio"&&(g=d=0);var y=u.duration*u.timescale,w=Math.floor(y/(nr+1));switch(y=Math.floor(y%(nr+1)),c=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(L(Gt(c,4)),[0,0,0,0],L(Gt(w,4)),L(Gt(y,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],L(Gt(d,2)),[0,0],L(Gt(g,2)),[0,0])),c=pt("tkhd",c),d=pt,w=u.duration*u.timescale,g=Math.floor(w/(nr+1)),w=Math.floor(w%(nr+1)),y=u.stream.language,y=y.charCodeAt(0)-96<<10|y.charCodeAt(1)-96<<5|y.charCodeAt(2)-96,g=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(L(Gt(u.timescale,4)),L(Gt(g,4)),L(Gt(w,4)),L(Gt(y,2)),[0,0])),g=pt("mdhd",g),w=u,y=new Uint8Array([]),w.type){case"video":y=Nb;break;case"audio":y=Ob}w=pt("hdlr",y);e:{switch(u.type){case"video":u=pt("minf",pt("vmhd",$b),_p,Lx(u));break e;case"audio":u=pt("minf",pt("smhd",Vb),_p,Lx(u));break e}u=new Uint8Array([])}u=d("mdia",g,w,u),i=i("trak",c,u),l.call(s,i)}for(t=Qt.apply(_n,L(t)),l=e.g[0],n=pt,i=l.duration*l.timescale,s=Math.floor(i/(nr+1)),i=Math.floor(i%(nr+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(L(Gt(l.timescale,4)),L(Gt(s,4)),L(Gt(i,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255])),s=pt("mvhd",s),i=[],e=x(e.g),d=e.next();!d.done;d=e.next())u=i,c=u.push,d=new Uint8Array([0,0,0,0].concat(L(Gt(d.value.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1])),d=pt("trex",d),c.call(u,d);if(e=Qt.apply(_n,L(i)),e=pt("mvex",e),i=[],l.encrypted){for(l=x(l.stream.drmInfos),u=l.next();!u.done;u=l.next())if(u=u.value,u.initData)for(u=x(u.initData),c=u.next();!c.done;c=u.next())i.push(c.value.initData);l=Qt.apply(_n,L(i))}else l=new Uint8Array([]);return e=n("moov",s,t,e,l),t=new Uint8Array(Hf.byteLength+e.byteLength),t.set(Hf),t.set(e,Hf.byteLength),t}function Lx(e){var t=pt,n=new Uint8Array([]);switch(e.type){case"video":if(e.codecs.includes("avc1")){n=e.stream.width||0;var i=e.stream.height||0;if(0<e.wa.byteLength)var s=pt("avcC",e.wa);else{s=pt;for(var l=7,u=[],c=[],d=0,g=0,y=0,w=0;w<e.$a.length;w++){var C=Dx(e.$a[w]);switch(C[0]&31){case 7:u.push(C),l+=C.length+2;break;case 8:c.push(C),l+=C.length+2}}for(0<u.length&&(d=u[0][1],y=u[0][2],g=u[0][3]),l=new Uint8Array(l),w=0,l[w++]=1,l[w++]=d,l[w++]=y,l[w++]=g,l[w++]=255,l[w++]=224|u.length,d=0;d<u.length;d++)l[w++]=(u[d].length&65280)>>8,l[w++]=u[d].length&255,l.set(u[d],w),w+=u[d].length;for(l[w++]=c.length,u=0;u<c.length;u++)l[w++]=(c[u].length&65280)>>8,l[w++]=c[u].length&255,l.set(c[u],w),w+=c[u].length;s=s("avcC",l)}n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(L(Gt(n,2)),L(Gt(i,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),i="avc1",c=Px(e),u=new Uint8Array([]),e.encrypted&&(u=$s(e),i="encv"),n=pt(i,n,s,c,u)}else e.codecs.includes("hvc1")&&(i=e.stream.width||0,s=e.stream.height||0,n=new Uint8Array([]),0<e.wa.byteLength&&(n=pt("hvcC",e.wa)),i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(L(Gt(i,2)),L(Gt(s,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),s="hvc1",c=Px(e),u=new Uint8Array([]),e.encrypted&&(u=$s(e),s="encv"),n=pt(s,i,n,c,u));break;case"audio":e.codecs.includes("mp3")?e=pt(".mp3",pl(e)):e.codecs.includes("ac-3")?(n=pt("dac3",e.ma),i="ac-3",s=new Uint8Array([]),e.encrypted&&(s=$s(e),i="enca"),e=pt(i,pl(e),n,s)):e.codecs.includes("ec-3")?(n=pt("dec3",e.ma),i="ec-3",s=new Uint8Array([]),e.encrypted&&(s=$s(e),i="enca"),e=pt(i,pl(e),n,s)):e.codecs.includes("opus")?(n=pt("dOps",e.ma),i="Opus",s=new Uint8Array([]),e.encrypted&&(s=$s(e),i="enca"),e=pt(i,pl(e),n,s)):(0<e.ma.byteLength?n=pt("esds",e.ma):(n=pt,i=e.id+1,s=e.stream.channelsCount||2,u=e.stream.audioSamplingRate||44100,d=Yr("audio",e.codecs.split(",")),g={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},c=g[u],(d==="mp4a.40.5"||d==="mp4a.40.29")&&(c=g[2*u]),u=parseInt(d.split(".").pop(),10),i=new Uint8Array([0,0,0,0,3,25].concat(L(Gt(i,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,u<<3|c>>>1,c<<7|s<<3,6,1,2])),n=n("esds",i)),i="mp4a",s=new Uint8Array([]),e.encrypted&&(s=$s(e),i="enca"),e=pt(i,pl(e),n,s)),n=e}return e=pt("stsd",Hb,n),t("stbl",e,pt("stts",Ub),pt("stsc",Bb),pt("stsz",Fb),pt("stco",jb))}function Px(e){if(!e.Ba&&!e.Ca)return new Uint8Array([]);var t=e.Ca;return e=new Uint8Array([].concat(L(Gt(e.Ba,4)),L(Gt(t,4)))),pt("pasp",e)}function pl(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat(L(Gt(e.stream.audioSamplingRate||44100,2)),[0,0]))}function $s(e){for(var t=pt,n=e.codecs.substring(0,e.codecs.indexOf(".")),i=0,s=0;s<n.length;s+=1)i|=n.charCodeAt(s)<<8*(n.length-s-1);n=new Uint8Array([].concat(L(Gt(i,4)))),n=pt("frma",n),i=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),i=pt("schm",i),s=pt;var l=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);e=x(e.stream.drmInfos);for(var u=e.next();!u.done;u=e.next())if((u=u.value)&&u.keyIds&&u.keyIds.size){u=x(u.keyIds);for(var c=u.next();!c.done;c=u.next())l=Dx(c.value)}return e=new Uint8Array([0,0,0,0,0,0,1,8]),l=pt("tenc",e,l),t("sinf",n,i,s("schi",l))}function gl(e){var t=[];e=x(e.g);for(var n=e.next();!n.done;n=e.next()){n=n.value;var i=t.push,s=i.apply,l=pt,u=new Uint8Array([0,0,0,0].concat(L(Gt(n.data?n.data.rb:0,4))));u=pt("mfhd",u);var c,d=n.data?n.data.Ya:[],g=new Uint8Array(4+d.length);for(c=0;c<d.length;c++){var y=d[c].flags;g[c+4]=y.Va<<4|y.Xa<<2|y.Wa}d=pt("sdtp",g);var w=d.length+92;g=pt,c=new Uint8Array([0,0,0,58].concat(L(Gt(n.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),c=pt("tfhd",c),y=n.data?n.data.baseMediaDecodeTime:0;var C=Math.floor(y%(nr+1));y=new Uint8Array([1,0,0,0].concat(L(Gt(Math.floor(y/(nr+1)),4)),L(Gt(C,4)))),y=pt("tfdt",y);var T=w;w=n.data?n.data.Ya:[],C=w.length;var A=12+16*C,b=new Uint8Array(A);for(T+=8+A,b.set([n.type==="video"?1:0,0,15,1].concat(L(Gt(C,4)),L(Gt(T,4))),0),T=0;T<C;T++){var k=w[T];A=Gt(k.duration,4);var O=Gt(k.size,4),D=k.flags;k=Gt(k.cb,4),b.set([].concat(L(A),L(O),[D.gb<<2|D.Va,D.Xa<<6|D.Wa<<4|D.hb,D.Ua&61440,D.Ua&15],L(k)),12+16*T)}w=pt("trun",b),d=g("traf",c,y,w,d),l=l("moof",u,d),s.call(i,t,[l,Db(n)])}return Qt.apply(_n,L(t))}function Db(e){return e=(e.data?e.data.Ya:[]).map(function(t){return t.data}),e=Qt.apply(_n,L(e)),pt("mdat",e)}function Gt(e,t){var n=[];for(--t;0<=t;t--)n.push(e>>8*t&255);return n}function Dx(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length/2;n+=1)t[n]=parseInt(String(e[2*n]+e[2*n+1]),16);return t}function pt(e){var t=Pe.apply(1,arguments),n=Ox[e];n||(n=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],Ox[e]=n);for(var i=8,s=t.length-1;0<=s;s--)i+=t[s].byteLength;for(s=new Uint8Array(i),s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=i&255,s.set(n,4),n=0,i=8;n<t.length;n++)s.set(t[n],i),i+=t[n].byteLength;return s}var Nx=!1,nr=Math.pow(2,32)-1,Ox={},Nb=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Ob=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Ub=new Uint8Array([0,0,0,0,0,0,0,0]),Bb=new Uint8Array([0,0,0,0,0,0,0,0]),jb=new Uint8Array([0,0,0,0,0,0,0,0]),Fb=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),$b=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Vb=new Uint8Array([0,0,0,0,0,0,0,0]),Hb=new Uint8Array([0,0,0,0,0,0,0,1]),Hf=new Uint8Array([]),zb=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),_p=new Uint8Array([]);function Lp(){var e=this;this.h=this.g=null,this.l=[],this.j=null,this.s=1,this.i=null,this.B=new ae(5),this.o=new ct(function(){Gb(e)}),this.A=new os,this.m=new Map}a=Lp.prototype,a.configure=function(e){this.g=e},a.start=function(e,t){var n=this;return $(function(i){if(i.g==1)return n.l=[e],n.h=t,E(i,Pp(n),2);if(!n.h)throw new K(2,7,7001);return i.return(n.j)})};function Gb(e){var t;$(function(n){switch(n.g){case 1:return ue(n,2),E(n,Pp(e),4);case 4:ge(n,3);break;case 2:t=ie(n),e.h&&(t.severity=1,e.h.onError(t));case 3:if(!e.h)return n.return();F(n)}})}a.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,this.o!=null&&(this.o.stop(),this.o=null),this.m.clear(),this.A.destroy()},a.update=function(){var e=this,t;return $(function(n){if(n.g==1)return ue(n,2),E(n,Pp(e),4);if(n.g!=2)return ge(n,0);if(t=ie(n),!e.h||!t)return n.return();e.h.onError(t),F(n)})},a.onExpirationUpdated=function(){},a.onInitialVariantChosen=function(){},a.banLocation=function(){},a.setMediaElement=function(){};function Pp(e){var t,n,i,s,l,u,c;return $(function(d){if(d.g==1)return t=dn(e.l,e.g.retryParameters),n=e.h.networkingEngine,i=Date.now(),s=n.request(0,t,{type:5}),Ir(e.A,s),E(d,s.promise,2);if(l=d.h,!e.h)return d.return();l.uri&&!e.l.includes(l.uri)&&e.l.unshift(l.uri);var g=l.uri,y=l.data,w=e.g.mss.manifestPreprocessor;if(w!=qu){if(vt("manifest.mss.manifestPreprocessor configuration","Please Use manifest.mss.manifestPreprocessorTXml instead."),y=Uv(y,"SmoothStreamingMedia"),!y)throw new K(2,4,4046,g);w(y),y=qi(y.outerHTML)}var C=jh(y,"SmoothStreamingMedia");if(!C)throw new K(2,4,4046,g);if(g=e.g.mss.manifestPreprocessorTXml,g!=Yu&&g(C),e.i||(e.i=new Qe(null,0)),g=yt(C,"IsLive",$h,!1))throw new K(2,4,4047);e.i.sc(!g),w=yt(C,"TimeScale",Ln,1e7),y=yt(C,"DVRWindowLength",Ln),g&&(y===0||isNaN(y))&&(y=1/0);var T=yt(C,"CanSeek",$h,!1);y===0&&T&&(y=1/0),T=null,y&&0<y&&(T=y/w),g&&!isNaN(e.g.availabilityWindowOverride)&&(T=e.g.availabilityWindowOverride),T==null&&(T=1/0),e.i.pe(T),y=yt(C,"Duration",Ln,1/0),g||e.i.Za(y/w),g={variants:[],textStreams:[],timescale:w,duration:y/w};var A;for(T=Bt(C,"Protection"),w=e.g.mss.keySystemsBySystemId,y=[],T=x(T),A=T.next();!A.done;A=T.next())y=y.concat(Bt(A.value,"ProtectionHeader"));if(y.length){for(T=[],A=0;A<y.length;A++){var b=y[A],k=b.attributes.SystemID.toLowerCase(),O=w[k];if(O){var D=_x(b);if(D)e:{D=x(Bi(D,"DATA"));for(var z=D.next();!z.done;z=D.next())if(z=ji(z.value,"KID")){D=Ti(un(z)),D=new Uint8Array([D[3],D[2],D[1],D[0],D[5],D[4],D[7],D[6]].concat(L(D.slice(8)))),D=So(D);break e}D=null}else D=null;z=Ti(un(b)),k=Tr(k.replace(/-/g,"")),k=[{initData:Cu(z,k,new Set,0),initDataType:"cenc",keyId:D}],k=Cr(O,"cenc",k),D&&k.keyIds.add(D),(O=Pb.get(O))&&(k.licenseServerUri=O(b)),T.push(k)}}w=T}else w=[];for(A=w,T=[],w=[],y=[],C=Bt(C,"StreamIndex"),C=x(C),b=C.next();!b.done;b=C.next()){b=b.value,O=Bt(b,"QualityLevel"),k=g.timescale,D=g.duration,z=Bt(b,"c");for(var P=[],B=0,G=0;G<z.length;++G){var q=z[G],J=z[G+1],fe=yt(q,"t",Ln),te=yt(q,"d",Ln);if(q=yt(q,"r",ku),!te)break;if(fe=fe??B,q=q||0,0>q)if(J){if(J=yt(J,"t",Ln),J==null)break;if(fe>=J)break;q=Math.ceil((J-fe)/te)-1}else{if(D==1/0)break;if(fe/k>=D)break;q=Math.ceil((D*k-fe)/te)-1}for(J=0;J<=q;++J)B=fe+te,P.push({start:fe/k,end:B/k,$f:fe}),fe=B}for(k=P,O=x(O),D=O.next();!D.done;D=O.next())(D=Xb(e,b,D.value,k,A,g))&&(D.type!="audio"||e.g.disableAudio?D.type!="video"||e.g.disableVideo?D.type!=mt||e.g.disableText||y.push(D):w.push(D):T.push(D))}for(C=[],T=x(0<T.length?T:[null]),A=T.next();!A.done;A=T.next())for(A=A.value,b=x(0<w.length?w:[null]),P=b.next();!P.done;P=b.next())O=C,k=O.push,D=e,z=A,P=P.value,G=0,z&&z.bandwidth&&0<z.bandwidth&&(G+=z.bandwidth),P&&P.bandwidth&&0<P.bandwidth&&(G+=P.bandwidth),D={id:D.s++,language:z?z.language:"und",disabledUntilTime:0,primary:!!z&&z.primary||!!P&&P.primary,audio:z,video:P,bandwidth:G,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},k.call(O,D);g.variants=C,g.textStreams=y,e.j?(e.j.variants=g.variants,e.j.textStreams=g.textStreams,e.h.filter(e.j)):(e.j={presentationTimeline:e.i,variants:g.variants,textStreams:g.textStreams,imageStreams:[],offlineSessionIds:[],minBufferTime:0,sequenceMode:e.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1},e.i.Wd()),Promise.resolve(),u=Date.now(),c=(u-i)/1e3,e.B.sample(1,c),F(d)})}function Xb(e,t,n,i,s,l){var u=t.attributes.Type;if(u!=="audio"&&u!=="video"&&u!=="text")return Fe("Ignoring unrecognized type:",u),null;var c=t.attributes.Language,d=e.s++,g=yt(n,"Bitrate",bo),y=yt(n,"MaxWidth",bo),w=yt(n,"MaxHeight",bo),C=yt(n,"Channels",bo),T=yt(n,"SamplingRate",bo),A=l.duration;i.length&&(A=i[i.length-1].end-i[0].start);var b=e.i.getDuration();e.i.Za(Math.min(A,b));var k={id:d,originalId:t.attributes.Name||String(d),groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:g||0,width:y||void 0,height:w||void 0,kind:"",encrypted:0<s.length,drmInfos:s,keyIds:new Set,language:It(c||"und"),originalLanguage:c,label:"",type:"",primary:!1,trickModeVideo:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:C,audioSamplingRate:T,spatialAudio:!1,closedCaptions:null,hdr:void 0,colorGamut:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:A,timescale:l.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set};if((s=t.attributes.Subtype)&&((s=Qb[s])&&k.roles.push(s),s==="main"&&(k.primary=!0)),s=n.attributes.FourCC,(s===null||s==="")&&(s=t.attributes.FourCC),!s){if(u==="audio")s="AAC";else if(u==="video")return Fe('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null}if(!Zb.includes(s.toUpperCase()))return Fe("Codec not supported:",s),null;switch(n=Wb(n,u,s,k),k.mssPrivateData.codecPrivateData=n,u){case"audio":if(!n)return Fe("Quality unsupported without CodecPrivateData",u),null;k.type="audio",k.mimeType="mss/audio/mp4",k.codecs=qb(s,n);break;case"video":if(!n)return Fe("Quality unsupported without CodecPrivateData",u),null;k.type="video",k.mimeType="mss/video/mp4",k.codecs=Yb(n);break;case"text":k.type=mt,k.mimeType="application/mp4",(s==="TTML"||s==="DFXP")&&(k.codecs="stpp")}return k.fullMimeTypes.add(an(k.mimeType,k.codecs)),k.createSegmentIndex=function(){if(k.segmentIndex)return Promise.resolve();if(e.m.has(k.id))var O=e.m.get(k.id);else O=[],k.type=="video"&&(O=k.mssPrivateData.codecPrivateData.split("00000001").slice(1)),O={id:k.id,type:k.type,codecs:k.codecs,encrypted:k.encrypted,timescale:k.mssPrivateData.timescale,duration:k.mssPrivateData.duration,$a:O,ma:new Uint8Array([]),wa:new Uint8Array([]),Ba:0,Ca:0,data:null,stream:k},O=Fs(new js([O])),e.m.set(k.id,O);return O=Kb(e,new Kn(function(){return[]},0,null,$u(k),k.mssPrivateData.timescale,O),k,t,i),k.segmentIndex=new xt(O),Promise.resolve()},k.closeSegmentIndex=function(){k.segmentIndex&&(k.segmentIndex.release(),k.segmentIndex=null)},k}function Wb(e,t,n,i){if(e=e.attributes.CodecPrivateData)return e;if(t!=="audio")return null;t=i.channelsCount||2,e=i.audioSamplingRate||44100;var s={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return i=s[e],n==="AACH"?(n=new Uint8Array(4),e=s[2*e],n[0]=40|i>>1,n[1]=i<<7|t<<3|e>>1,n[2]=e<<7|8,n[3]=0,t=new Uint16Array(2),t[0]=(n[0]<<8)+n[1],t[1]=(n[2]<<8)+n[3],t[0].toString(16)+t[1].toString(16)):(n=new Uint8Array(2),n[0]=16|i>>1,n[1]=i<<7|t<<3,t=new Uint16Array(1),t[0]=(n[0]<<8)+n[1],t[0].toString(16))}function qb(e,t){var n=0;return e==="AACH"&&(n=5),t?n===0&&(n=(parseInt(t.substr(0,2),16)&248)>>3):(n=2,e==="AACH"&&(n=5)),"mp4a.40."+n}function Yb(e){var t=/00000001[0-9]7/.exec(e);return t.length&&e?"avc1."+e.substr(e.indexOf(t[0])+10,6):""}function Kb(e,t,n,i,s){var l=i.attributes.Url.replace("{bitrate}",String(n.bandwidth));i=[],s=x(s);for(var u=s.next(),c={};!u.done;c={re:void 0},u=s.next())c.re=u.value,i.push(new Je(c.re.start,c.re.end,function(d){return function(){return Cn(e.l,[l.replace("{start time}",String(d.re.$f))])}}(c),0,null,t,0,0,n.mssPrivateData.duration));return i}he("shaka.mss.MssParser",Lp);var Zb="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),Qb={CAPT:"main",SUBT:"alternate",DESC:"main"};Fi["application/vnd.ms-sstr+xml"]=function(){return new Lp};function Ux(e,t,n,i,s,l){if(200<=n&&299>=n&&n!=202)return{uri:s||i,originalUri:i,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"]};var u=null;try{u=wo(t)}catch{}throw new K(n==401||n==403?2:1,1,1001,i,n,u,e,l,s||i)}function Dp(){}function zf(e,t,n,i,s){var l=new i4;Ra(t.headers).forEach(function(g,y){l.append(y,g)});var u=new t4,c={lg:!1,mh:!1};if(e=Jb(e,n,{body:t.body||void 0,headers:l,method:t.method,signal:u.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},c,i,s,t.streamDataCallback),e=new nn(e,function(){return c.lg=!0,u.abort(),Promise.resolve()}),t=t.retryParameters.timeout){var d=new ct(function(){c.mh=!0,u.abort()});d.Y(t/1e3),e.finally(function(){d.stop()})}return e}function Jb(e,t,n,i,s,l,u){var c,d,g,y,w,C,T,A,b,k,O,D,z;return $(function(P){switch(P.g){case 1:return c=e4,d=n4,C=w=0,T=Date.now(),ue(P,2),E(P,c(e,n),4);case 4:if(g=P.h,l(Bx(g.headers)),n.method=="HEAD"){P.u(5);break}return A=g.clone().body.getReader(),k=(b=g.headers.get("Content-Length"))?parseInt(b,10):0,O=function(B){function G(){var q,J,fe;return $(function(te){switch(te.g){case 1:return ue(te,2),E(te,A.read(),4);case 4:q=te.h,ge(te,3);break;case 2:return ie(te),te.return();case 3:if(q.done){te.u(5);break}if(w+=q.value.byteLength,!u){te.u(5);break}return E(te,u(q.value),5);case 5:J=Date.now(),(100<J-T||q.done)&&(fe=q.done?0:k-w,s(J-T,w-C,fe),C=w,T=J),q.done?B.close():(B.enqueue(q.value),G()),F(te)}})}G()},new d({start:O}),E(P,g.arrayBuffer(),6);case 6:y=P.h;case 5:ge(P,3);break;case 2:throw D=ie(P),i.lg?new K(1,1,7001,e,t):i.mh?new K(1,1,1003,e,t):new K(1,1,1002,e,D,t);case 3:return z=Bx(g.headers),P.return(Ux(z,y,g.status,e,g.url,t))}})}function Bx(e){var t={};return e.forEach(function(n,i){t[i.trim()]=n}),t}function jx(){if(p.ReadableStream)try{new ReadableStream({})}catch{return!1}else return!1;if(p.Response){if(!new Response("").body)return!1}else return!1;return!(!p.fetch||"polyfill"in p.fetch||!p.AbortController)}he("shaka.net.HttpFetchPlugin",Dp),Dp.isSupported=jx,Dp.parse=zf;var e4=p.fetch,t4=p.AbortController,n4=p.ReadableStream,i4=p.Headers;jx()&&(Co("http",zf,2,!0),Co("https",zf,2,!0),Co("blob",zf,2,!0));function Fx(){}function Gf(e,t,n,i,s){var l=new o4,u=Date.now(),c=0,d=new Promise(function(g,y){l.open(t.method,e,!0),l.responseType="arraybuffer",l.timeout=t.retryParameters.timeout,l.withCredentials=t.allowCrossSiteCredentials,l.onabort=function(){y(new K(1,1,7001,e,n))};var w=!1;l.onreadystatechange=function(){if(l.readyState==2&&!w){var T=$x(l);s(T),w=!0}},l.onload=function(T){var A=$x(l),b=l.response;try{i(Date.now()-u,T.loaded-c,0);var k=Ux(A,b,l.status,e,l.responseURL,n);g(k)}catch(O){y(O)}},l.onerror=function(T){y(new K(1,1,1002,e,T,n))},l.ontimeout=function(){y(new K(1,1,1003,e,n))},l.onprogress=function(T){var A=Date.now();(100<A-u||T.lengthComputable&&T.loaded==T.total)&&(i(A-u,T.loaded-c,l.readyState==4?0:T.total-T.loaded),c=T.loaded,u=A)};for(var C in t.headers)l.setRequestHeader(C.toLowerCase(),t.headers[C]);l.send(t.body)});return new nn(d,function(){return l.abort(),Promise.resolve()})}function $x(e){var t=e.getAllResponseHeaders().trim().split(`\r
`);e={},t=x(t);for(var n=t.next();!n.done;n=t.next())n=n.value.split(": "),e[n[0].toLowerCase()]=n.slice(1).join(": ");return e}he("shaka.net.HttpXHRPlugin",Fx),Fx.parse=Gf;var o4=p.XMLHttpRequest;Co("http",Gf,1,!0),Co("https",Gf,1,!0),Co("blob",Gf,1,!0);function Vx(e,t,n,i){this.g=e,this.i=t,this.groupId=n,this.h=i}function Np(e){return e.M().map(function(t){return"{"+encodeURI(t)+"}"}).join("")+":"+e.Ha+":"+e.sa}function r4(e,t){return gs(e.g.M(),e.g.Ha,e.g.sa,t.streaming.retryParameters)}function Hx(){this.h=this.j=this.i=0,this.g=new Map,this.l=0}function zx(e,t){e.i+=t;var n=e.l;return e.l++,e.g.set(n,t),n}Hx.prototype.close=function(e,t){if(this.g.has(e)){var n=this.g.get(e);this.g.delete(e),this.j+=n,this.h+=t}};function Gx(e){var t=this;this.o=e,this.j=new Map,this.i=new rs(function(){return Op(t).catch(function(){})}),this.h=[],this.m=function(){},this.l=function(){},this.g=new Hx}Gx.prototype.destroy=function(){return this.i.destroy()};function s4(e,t,n){e.m=t,e.l=n}function Op(e){var t=e.h.map(function(n){return n()});return e.h=[],Promise.all(t)}function a4(e,t,n,i,s,l){Dt(e.i);var u=(e.j.get(t)||Promise.resolve()).then(function(){var c,d,g,y,w,C,T;return $(function(A){if(A.g==1)return E(A,u4(e,n),2);if(c=A.h,e.i.g)throw new K(2,9,7001);if(s)for(y in d=Ze(c),g=new xm(d),g.data)w=Number(y),C=g.data[w],T=g.g[w],e.l(C,T);e.g.close(i,c.byteLength);var b=e.g;return e.m(b.i==0?0:b.j/b.i,e.g.h),A.return(l(c))})});e.j.set(t,u)}function l4(e){return $(function(t){return t.g==1?E(t,Promise.all(e.j.values()),2):t.return(e.g.h)})}function u4(e,t){var n,i,s,l;return $(function(u){return u.g==1?(n=Ki,i=e.o.request(n,t),s=function(){return i.abort()},e.h.push(s),E(u,i.promise,2)):(l=u.h,Fn(e.h,s),u.return(l.data))})}function Xf(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new _t,e.onabort=function(i){i.preventDefault(),n.g.reject()},e.onerror=function(i){i.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}Xf.prototype.abort=function(){var e=this;return $(function(t){if(t.g==1){try{e.i.abort()}catch{}return ue(t,2),E(t,e.g,4)}if(t.g!=2)return ge(t,0);ie(t),F(t)})};function Up(e,t){return new Promise(function(n,i){var s=e.h.openCursor();s.onerror=i,s.onsuccess=function(){var l;return $(function(u){if(u.g==1)return s.result==null?(n(),u.return()):(l=s.result,E(u,t(l.key,l.value,l),2));l.continue(),F(u)})}})}Xf.prototype.store=function(){return this.h},Xf.prototype.promise=function(){return this.g};function Bp(e){this.h=e,this.g=[]}Bp.prototype.destroy=function(){return Promise.all(this.g.map(function(e){return e.abort()}))};function Ur(e,t){return Wf(e,t,"readwrite")}function Wf(e,t,n){n=e.h.transaction([t],n);var i=new Xf(n,t);return e.g.push(i),i.promise().then(function(){Fn(e.g,i)},function(){Fn(e.g,i)}),i}function Br(e,t,n){this.h=new Bp(e),this.i=t,this.g=n}a=Br.prototype,a.destroy=function(){return this.h.destroy()},a.hasFixedKeySpace=function(){return!0},a.addSegments=function(){return Xx(this.i)},a.removeSegments=function(e,t){return Wx(this,this.i,e,t)},a.getSegments=function(e){var t=this,n;return $(function(i){return i.g==1?E(i,qx(t,t.i,e),2):(n=i.h,i.return(n.map(function(s){return t.og(s)})))})},a.addManifests=function(){return Xx(this.g)},a.updateManifest=function(){return Promise.reject(new K(2,9,9016,"Cannot modify values in "+this.g))};function f4(e,t,n){e=Ur(e.h,e.g);var i=e.store();return i.get(t).onsuccess=function(){i.put(n,t)},e.promise()}a.updateManifestExpiration=function(e,t){var n=Ur(this.h,this.g),i=n.store();return i.get(e).onsuccess=function(s){(s=s.target.result)&&(s.expiration=t,i.put(s,e))},n.promise()},a.removeManifests=function(e,t){return Wx(this,this.g,e,t)},a.getManifests=function(e){var t=this,n;return $(function(i){return i.g==1?E(i,qx(t,t.g,e),2):(n=i.h,i.return(Promise.all(n.map(function(s){return t.Wc(s)}))))})},a.getAllManifests=function(){var e=this,t,n;return $(function(i){return i.g==1?(t=Wf(e.h,e.g,"readonly"),n=new Map,E(i,Up(t,function(s,l){var u;return $(function(c){if(c.g==1)return E(c,e.Wc(l),2);u=c.h,n.set(s,u),F(c)})}),2)):i.g!=3?E(i,t.promise(),3):i.return(n)})},a.og=function(e){return e},a.Wc=function(e){return Promise.resolve(e)};function Xx(e){return Promise.reject(new K(2,9,9011,"Cannot add new value to "+e))}a.add=function(e,t){var n=this,i,s,l,u,c,d,g;return $(function(y){if(y.g==1){for(i=Ur(n.h,e),s=i.store(),l=[],u=x(t),c=u.next(),d={};!c.done;d={Hf:void 0},c=u.next())g=c.value,d.Hf=s.add(g),d.Hf.onsuccess=function(w){return function(){l.push(w.Hf.result)}}(d);return E(y,i.promise(),2)}return y.return(l)})};function Wx(e,t,n,i){e=Ur(e.h,t),t=e.store(),n=x(n);for(var s=n.next(),l={};!s.done;l={rf:void 0},s=n.next())l.rf=s.value,t.delete(l.rf).onsuccess=function(u){return function(){return i(u.rf)}}(l);return e.promise()}function qx(e,t,n){var i,s,l,u,c,d,g;return $(function(y){if(y.g==1){for(i=Wf(e.h,t,"readonly"),s=i.store(),l={},u=[],c=x(n),d=c.next(),g={};!d.done;g={le:void 0,Sd:void 0},d=c.next())g.Sd=d.value,g.le=s.get(g.Sd),g.le.onsuccess=function(w){return function(){w.le.result==null&&u.push(w.Sd),l[w.Sd]=w.le.result}}(g);return E(y,i.promise(),2)}if(u.length)throw new K(2,9,9012,"Could not find values for "+u);return y.return(n.map(function(w){return l[w]}))})}function ml(e){this.g=new Bp(e)}ml.prototype.destroy=function(){return this.g.destroy()},ml.prototype.getAll=function(){var e=this,t,n;return $(function(i){return i.g==1?(t=Wf(e.g,"session-ids","readonly"),n=[],E(i,Up(t,function(s,l){n.push(l)}),2)):i.g!=3?E(i,t.promise(),3):i.return(n)})},ml.prototype.add=function(e){var t=Ur(this.g,"session-ids"),n=t.store();e=x(e);for(var i=e.next();!i.done;i=e.next())n.add(i.value);return t.promise()},ml.prototype.remove=function(e){var t=this,n;return $(function(i){return i.g==1?(n=Ur(t.g,"session-ids"),E(i,Up(n,function(s,l,u){e.includes(l.sessionId)&&u.delete()}),2)):E(i,n.promise(),0)})};function Xn(){this.g=new Map}Xn.prototype.destroy=function(){for(var e=[],t=x(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},Xn.prototype.init=function(){var e=this;yl.forEach(function(s,l){(s=s())&&e.g.set(l,s)});for(var t=[],n=x(this.g.values()),i=n.next();!i.done;i=n.next())t.push(i.value.init());return Promise.all(t)};function Yx(e){var t=null;if(e.g.forEach(function(n,i){n.getCells().forEach(function(s,l){s.hasFixedKeySpace()||t||(t={path:{nb:i,Ja:l},Ja:s})})}),t)return t;throw new K(2,9,9013,"Could not find a cell that supports add-operations")}function c4(e,t){e.g.forEach(function(n,i){n.getCells().forEach(function(s,l){t({nb:i,Ja:l},s)})})}function qf(e,t,n){if(e=e.g.get(t),!e)throw new K(2,9,9013,"Could not find mechanism with name "+t);if(t=e.getCells().get(n),!t)throw new K(2,9,9013,"Could not find cell with name "+n);return t}function h4(e,t){e.g.forEach(function(n){t(n.getEmeSessionCell())})}function d4(e){var t=Array.from(e.g.keys());if(!t.length)throw new K(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}function p4(e){var t,n,i;return $(function(s){return s.g==1?(t=Array.from(e.g.values()),n=0<t.length,n||(i=yl,i.forEach(function(l){(l=l())&&t.push(l)})),E(s,Promise.all(t.map(function(l){return l.erase()})),2)):n?s.u(0):E(s,Promise.all(t.map(function(l){return l.destroy()})),0)})}function Kx(e,t){yl.set(e,t)}he("shaka.offline.StorageMuxer",Xn),Xn.unregister=function(e){yl.delete(e)},Xn.register=Kx,Xn.prototype.destroy=Xn.prototype.destroy;var yl=new Map;function vl(){Br.apply(this,arguments)}le(vl,Br),vl.prototype.updateManifestExpiration=function(e,t){var n=this,i,s,l;return $(function(u){return i=Ur(n.h,n.g),s=i.store(),l=new _t,s.get(e).onsuccess=function(c){(c=c.target.result)?(c.expiration=t,s.put(c),l.resolve()):l.reject(new K(2,9,9012,"Could not find values for "+e))},E(u,Promise.all([i.promise(),l]),0)})},vl.prototype.Wc=function(e){var t,n,i,s,l,u;return $(function(c){if(c.g==1){for(t=[],n=0;n<e.periods.length;++n)i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,s=i-e.periods[n].startTime,l=g4(e.periods[n],s),t.push(l);return E(c,Mv(t),2)}return u=c.h,c.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:e.expiration==null?1/0:e.expiration,streams:u,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})})};function g4(e,t){y4(e);for(var n=x(e.streams),i=n.next();!i.done;i=n.next());return e.streams.map(function(s){return m4(s,e.startTime,t)})}function m4(e,t,n){var i=e.initSegmentUri?Zx(e.initSegmentUri):null,s=t+e.presentationTimeOffset,l=t+n;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:i,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(u){var c=Zx(u.uri);return{startTime:t+u.startTime,endTime:t+u.endTime,dataKey:c,initSegmentKey:i,appendWindowStart:t,appendWindowEnd:l,timestampOffset:s,tilesLayout:"",mimeType:null,codecs:null}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1}}vl.prototype.og=function(e){return{data:e.data}};function Zx(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new K(2,9,9004,"Could not parse uri "+e)}function y4(e){var t=e.streams.filter(function(c){return c.contentType=="audio"});if(e=e.streams.filter(function(c){return c.contentType=="video"}),!t.every(function(c){return c.variantIds})||!e.every(function(c){return c.variantIds})){for(var n=x(t),i=n.next();!i.done;i=n.next())i.value.variantIds=[];for(n=x(e),i=n.next();!i.done;i=n.next())i.value.variantIds=[];if(n=0,e.length&&!t.length){i=n++;for(var s=x(e),l=s.next();!l.done;l=s.next())l.value.variantIds.push(i)}if(!e.length&&t.length)for(i=n++,s=x(t),l=s.next();!l.done;l=s.next())l.value.variantIds.push(i);if(e.length&&t.length)for(t=x(t),i=t.next();!i.done;i=t.next())for(i=i.value,s=x(e),l=s.next();!l.done;l=s.next()){l=l.value;var u=n++;i.variantIds.push(u),l.variantIds.push(u)}}}function Yf(){Br.apply(this,arguments)}le(Yf,Br),Yf.prototype.Wc=function(e){var t,n,i,s,l,u;return $(function(c){if(c.g==1){for(t=[],n=0;n<e.periods.length;++n){i=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,s=i-e.periods[n].startTime;for(var d=e.periods[n],g=[],y=x(d.streams),w=y.next();!w.done;w=y.next())w=w.value,w.variantIds.length!=0&&g.push(v4(w,d.startTime,d.startTime+s));l=g,t.push(l)}return E(c,Mv(t),2)}return u=c.h,c.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:e.expiration==null?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:u,sequenceMode:!1})})};function v4(e,t,n){return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,colorGamut:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(i){return{startTime:t+i.startTime,endTime:t+i.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:i.dataKey,tilesLayout:"",mimeType:null,codecs:null}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1}}function jp(){Br.apply(this,arguments)}le(jp,Br),a=jp.prototype,a.hasFixedKeySpace=function(){return!1},a.addSegments=function(e){return this.add(this.i,e)},a.addManifests=function(e){return this.add(this.g,e)},a.updateManifest=function(e,t){return f4(this,e,t)},a.Wc=function(e){return e.expiration==null&&(e.expiration=1/0),Promise.resolve(e)};function Qx(){this.m=this.j=this.i=this.h=this.g=this.l=null}a=Qx.prototype,a.init=function(){var e=this,t=new _t,n=!1,i=new ct(function(){n=!0,t.reject(new K(2,9,9017))});i.Y(5);var s=p.indexedDB.open("shaka_offline_db",5);return s.onsuccess=function(){if(!n){var l=s.result;e.l=l;var u=l.objectStoreNames;u=u.contains("manifest")&&u.contains("segment")?new vl(l,"segment","manifest"):null,e.g=u,u=l.objectStoreNames,u=u.contains("manifest-v2")&&u.contains("segment-v2")?new Yf(l,"segment-v2","manifest-v2"):null,e.h=u,u=l.objectStoreNames,u=u.contains("manifest-v3")&&u.contains("segment-v3")?new Yf(l,"segment-v3","manifest-v3"):null,e.i=u,u=l.objectStoreNames,u=u.contains("manifest-v5")&&u.contains("segment-v5")?new jp(l,"segment-v5","manifest-v5"):null,e.j=u,l=l.objectStoreNames.contains("session-ids")?new ml(l):null,e.m=l,i.stop(),t.resolve()}},s.onupgradeneeded=function(){for(var l=s.result,u=x(["segment-v5","manifest-v5","session-ids"]),c=u.next();!c.done;c=u.next())c=c.value,l.objectStoreNames.contains(c)||l.createObjectStore(c,{autoIncrement:!0})},s.onerror=function(l){n||(t.reject(new K(2,9,9001,s.error)),i.stop(),l.preventDefault())},t},a.destroy=function(){var e=this;return $(function(t){switch(t.g){case 1:if(!e.g){t.u(2);break}return E(t,e.g.destroy(),2);case 2:if(!e.h){t.u(4);break}return E(t,e.h.destroy(),4);case 4:if(!e.i){t.u(6);break}return E(t,e.i.destroy(),6);case 6:if(!e.j){t.u(8);break}return E(t,e.j.destroy(),8);case 8:if(!e.m){t.u(10);break}return E(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),F(t)}})},a.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},a.getEmeSessionCell=function(){return this.m},a.erase=function(){var e=this;return $(function(t){switch(t.g){case 1:if(!e.g){t.u(2);break}return E(t,e.g.destroy(),2);case 2:if(!e.h){t.u(4);break}return E(t,e.h.destroy(),4);case 4:if(!e.i){t.u(6);break}return E(t,e.i.destroy(),6);case 6:if(!e.j){t.u(8);break}return E(t,e.j.destroy(),8);case 8:return e.l&&e.l.close(),E(t,x4(),10);case 10:return e.l=null,e.g=null,e.h=null,e.i=null,e.j=null,E(t,e.init(),0)}})};function x4(){var e=new _t,t=p.indexedDB.deleteDatabase("shaka_offline_db");return t.onblocked=function(){},t.onsuccess=function(){e.resolve()},t.onerror=function(n){e.reject(new K(2,9,9001,t.error)),n.preventDefault()},e}Kx("idb",function(){return hi()||ro()||!p.indexedDB?null:new Qx});function ho(e,t,n,i){this.g=e,this.i=t,this.h=n,this.l=i,this.j=["offline:",e,"/",t,"/",n,"/",i].join("")}ho.prototype.nb=function(){return this.i},ho.prototype.Ja=function(){return this.h},ho.prototype.key=function(){return this.l},ho.prototype.toString=function(){return this.j};function Fp(e){if(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e),e==null)return null;var t=e[1];if(t!="manifest"&&t!="segment")return null;var n=e[2];if(!n)return null;var i=e[3];return i&&t!=null?new ho(t,n,i,Number(e[4])):null}function Jx(e,t){this.h=e,this.g=t}function e2(e,t){var n=new Qe(null,0);n.Za(t.duration);var i=t.streams.filter(function(g){return g.type=="audio"}),s=t.streams.filter(function(g){return g.type=="video"});i=w4(e,i,s,n),s=t.streams.filter(function(g){return g.type==mt}).map(function(g){return Kf(e,g,n)});var l=t.streams.filter(function(g){return g.type=="image"}).map(function(g){return Kf(e,g,n)}),u=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var c=x(i.values()),d=c.next();!d.done;d=c.next())d=d.value,d.audio&&d.audio.encrypted&&(d.audio.drmInfos=u),d.video&&d.video.encrypted&&(d.video.drmInfos=u);return{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,variants:Array.from(i.values()),textStreams:s,imageStreams:l,sequenceMode:t.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:t.type||"UNKNOWN",serviceDescription:null,nextUrl:null,periodCount:1,gapCount:0,isLowLatency:!1}}function w4(e,t,n,i){for(var s=new Set,l=x(t),u=l.next();!u.done;u=l.next()){u=x(u.value.variantIds);for(var c=u.next();!c.done;c=u.next())s.add(c.value)}for(l=x(n),u=l.next();!u.done;u=l.next())for(u=x(u.value.variantIds),c=u.next();!c.done;c=u.next())s.add(c.value);for(l=new Map,s=x(s),u=s.next();!u.done;u=s.next())u=u.value,l.set(u,{id:u,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(t=x(t),s=t.next();!s.done;s=t.next())for(u=s.value,s=Kf(e,u,i),u=x(u.variantIds),c=u.next();!c.done;c=u.next())c=l.get(c.value),c.language=s.language,c.primary=c.primary||s.primary,c.audio=s;for(n=x(n),t=n.next();!t.done;t=n.next())for(s=t.value,t=Kf(e,s,i),s=x(s.variantIds),u=s.next();!u.done;u=s.next())u=l.get(u.value),u.primary=u.primary||t.primary,u.video=t;return l}function Kf(e,t,n){var i=t.segments.map(function(s){return S4(e,s,t)});return n.sd(i),{id:t.id,originalId:t.originalId,groupId:t.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new xt(i),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,colorGamut:t.colorGamut,videoLayout:t.videoLayout,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,originalLanguage:t.originalLanguage||null,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout,accessibilityPurpose:null,external:t.external,fastSwitching:t.fastSwitching,fullMimeTypes:new Set([an(t.mimeType,t.codecs)])}}function S4(e,t,n){var i=new ho("segment",e.h,e.g,t.dataKey);return e=new Je(t.startTime,t.endTime,function(){return[i.toString()]},0,null,t.initSegmentKey!=null?T4(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||""),e.mimeType=t.mimeType||n.mimeType||"",e.codecs=t.codecs||n.codecs||"",e}function T4(e,t){var n=new ho("segment",e.h,e.g,t);return new Kn(function(){return[n.toString()]},0,null)}function t2(){this.g=null}a=t2.prototype,a.configure=function(){},a.start=function(e,t){var n=this,i,s,l,u,c,d,g;return $(function(y){switch(y.g){case 1:if(i=Fp(e),n.g=i,i==null||i.g!="manifest")throw new K(2,1,9004,e);return s=new Xn,ye(y,2),E(y,s.init(),4);case 4:return E(y,qf(s,i.nb(),i.Ja()),5);case 5:return l=y.h,E(y,l.getManifests([i.key()]),6);case 6:return u=y.h,c=u[0],d=new Jx(i.nb(),i.Ja()),g=e2(d,c),t.makeTextStreamsForClosedCaptions(g),y.return(g);case 2:return ee(y),E(y,s.destroy(),7);case 7:de(y,0)}})},a.stop=function(){return Promise.resolve()},a.update=function(){},a.onExpirationUpdated=function(e,t){var n=this,i,s,l,u,c,d,g;return $(function(y){switch(y.g){case 1:return i=n.g,s=new Xn,ue(y,2,3),E(y,s.init(),5);case 5:return E(y,qf(s,i.nb(),i.Ja()),6);case 6:return l=y.h,E(y,l.getManifests([i.key()]),7);case 7:if(u=y.h,c=u[0],d=c.sessionIds.includes(e),g=c.expiration==null||c.expiration>t,!d||!g){y.u(3);break}return E(y,l.updateManifestExpiration(i.key(),t),3);case 3:return ee(y),E(y,s.destroy(),10);case 10:de(y,0);break;case 2:ie(y),y.u(3)}})},a.onInitialVariantChosen=function(){},a.banLocation=function(){},a.setMediaElement=function(){},Fi["application/x-offline-manifest"]=function(){return new t2};function n2(){}function i2(e){var t=Fp(e);return t&&t.g=="manifest"?(e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}},e=is(e)):e=t&&t.g=="segment"?C4(t.key(),t):br(new K(2,1,9004,e)),e}function C4(e,t){var n=new Xn;return is(void 0).Aa(function(){return n.init()}).Aa(function(){return qf(n,t.nb(),t.Ja())}).Aa(function(i){return i.getSegments([t.key()])}).Aa(function(i){return{uri:t,data:i[0].data,headers:{}}}).finally(function(){return n.destroy()})}he("shaka.offline.OfflineScheme",n2),n2.plugin=i2,Co("offline",i2);function o2(e,t,n){var i,s,l,u,c,d;return $(function(g){switch(g.g){case 1:i=[];for(var y=[],w=x(n),C=w.next();!C.done;C=w.next()){C=C.value;for(var T=!1,A=x(y),b=A.next();!b.done;b=A.next())if(b=b.value,A4(b.info,C)){b.sessionIds.push(C.sessionId),T=!0;break}T||y.push({info:C,sessionIds:[C.sessionId]})}s=x(y),l=s.next();case 2:if(l.done){g.u(4);break}return u=l.value,c=E4(e,t,u),E(g,c,5);case 5:d=g.h,i=i.concat(d),l=s.next(),g.u(2);break;case 4:return g.return(i)}})}function E4(e,t,n){var i,s;return $(function(l){switch(l.g){case 1:return i=new Mu({Lb:t,onError:function(){},ee:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),ue(l,2),i.configure(e),E(l,lC(i,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:ge(l,3);break;case 2:return ie(l),E(l,i.destroy(),5);case 5:return l.return([]);case 3:return s=[],E(l,Promise.all(n.sessionIds.map(function(u){return $(function(c){if(c.g==1)return ue(c,2),E(c,cC(i,u),4);if(c.g!=2)return s.push(u),ge(c,0);ie(c),F(c)})})),6);case 6:return E(l,i.destroy(),7);case 7:return l.return(s)}})}function A4(e,t){function n(i,s){return i.robustness==s.robustness&&i.contentType==s.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Xi(e.audioCapabilities,t.audioCapabilities,n)&&Xi(e.videoCapabilities,t.videoCapabilities,n)}function k4(e,t,n){var i=t.presentationTimeline.getDuration();return t=r2(t),{offlineUri:null,originalManifestUri:e,duration:i,size:0,expiration:1/0,tracks:t,appMetadata:n,isIncomplete:!1}}function $p(e,t){var n=e2(new Jx(e.nb(),e.Ja()),t),i=t.appMetadata||{};return n=r2(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i,isIncomplete:t.isIncomplete||!1}}function r2(e){var t=[],n=mu(e.variants);n=x(n);for(var i=n.next();!i.done;i=n.next())t.push(es(i.value));for(e=x(e.textStreams),n=e.next();!n.done;n=e.next())t.push(gu(n.value));return t}function b4(){this.g={}}function I4(e,t){var n=t.audio,i=t.video;if(n&&!i&&(e.g[n.id]=n.bandwidth||t.bandwidth),!n&&i&&(e.g[i.id]=i.bandwidth||t.bandwidth),n&&i){var s=n.bandwidth||393216,l=i.bandwidth||t.bandwidth-s;0>=l&&(l=t.bandwidth),e.g[n.id]=s,e.g[i.id]=l}}function M4(e,t){e.g[t.id]=t.bandwidth||2048}function s2(e,t){return e=e.g[t],e==null&&(e=0),e}function mn(e){var t=this;if(e&&e.constructor!=ve)throw new K(2,9,9008);this.g=this.h=null,e?(this.h=e.g,this.g=e.xb()):(this.h=vs(),this.g=new Ut),this.i=[],this.j=[];var n=!e;this.l=new rs(function(){var i,s,l,u,c;return $(function(d){switch(d.g){case 1:return E(d,Promise.all(t.j.map(function(g){return Op(g)})),2);case 2:for(i=function(){},s=[],l=x(t.i),u=l.next();!u.done;u=l.next())c=u.value,s.push(c.then(i,i));return E(d,Promise.all(s),3);case 3:if(!n){d.u(4);break}return E(d,t.g.destroy(),4);case 4:t.h=null,t.g=null,F(d)}})})}function Vp(){if(Wi())e:{for(var e=x(yl.values()),t=e.next();!t.done;t=e.next())if(t=t.value,t=t()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}a=mn.prototype,a.destroy=function(){return this.l.destroy()},a.configure=function(e,t){return arguments.length==2&&typeof e=="string"&&(e=Wu(e,t)),Zo(this.h,e)},a.getConfiguration=function(){var e=vs();return Zo(e,this.h,vs()),e},a.xb=function(){return this.g},a.store=function(e,t,n){var i=this,s=this.getConfiguration(),l=new Gx(this.g);return this.j.push(l),t=R4(this,e,t||{},function(){var u;return $(function(c){return c.g==1?n?c.u(2):E(c,kd(e,i.g,s.manifest.retryParameters),3):(c.g!=2&&(n=c.h),u=Vm(e,n||null),c.return(u()))})},s,l),t=new nn(t,function(){return Op(l)}),t.finally(function(){Fn(i.j,l)}),H4(this,t)};function R4(e,t,n,i,s,l){var u,c,d,g,y,w,C,T,A,b,k,O,D,z;return $(function(P){switch(P.g){case 1:return Zf(),c=u=null,d=new Xn,w=y=g=null,ue(P,2,3),E(P,i(),5);case 5:return u=P.h,E(P,j4(e,t,u,s),6);case 6:if(C=P.h,An(e),T=!C.presentationTimeline.V()&&!C.presentationTimeline.kc(),!T)throw new K(2,9,9005,t);return E(P,e.yc(C,function(B){w=w||B},s),7);case 7:if(c=P.h,An(e),w)throw w;return E(P,L4(C,c,s),8);case 8:return E(P,d.init(),9);case 9:return An(e),E(P,Yx(d),10);case 10:return g=P.h,An(e),A=P4(c,C,t,n,s,l),b=A.ui,k=A.Xf,E(P,g.Ja.addManifests([b]),11);case 11:if(O=P.h,An(e),y=O[0],An(e),w)throw w;return E(P,_4(e,k,y,b,l,s,g.Ja,C,c),12);case 12:return An(e),f2(C,b,c,s),E(P,g.Ja.updateManifest(y,b),13);case 13:return An(e),D=new ho("manifest",g.path.nb,g.path.Ja,y),P.return($p(D,b));case 3:return ee(P),E(P,d.destroy(),14);case 14:if(!u){P.u(15);break}return E(P,u.stop(),15);case 15:if(!c){P.u(17);break}return E(P,c.destroy(),17);case 17:de(P,0);break;case 2:if(z=ie(P),y==null){P.u(19);break}return E(P,a2(y),19);case 19:throw w||z}})}function _4(e,t,n,i,s,l,u,c,d){var g,y,w,C,T,A,b,k,O,D;return $(function(z){switch(z.g){case 1:if(g={},y=0,w=function(P,B){var G,q,J,fe,te,ne,oe;return $(function(xe){if(xe.g==1){for(G=x(P),q=G.next(),J={};!q.done;J={Ac:void 0},q=G.next())J.Ac=q.value,fe=r4(J.Ac,l),te=J.Ac.i,ne=J.Ac.h,oe=function(pe){return function(we){var Me,Te,Ne;return $(function(rt){if(rt.g==1)return E(rt,u.addSegments([{data:we}]),2);Me=rt.h,An(e),Te=pe.Ac.g,Ne=Np(Te),g[Ne]=Me[0],y+=we.byteLength,F(rt)})}}(J),a4(s,J.Ac.groupId,fe,te,ne,oe);return E(xe,l4(s),2)}return B?(An(e),f2(c,i,d,l),E(xe,u.updateManifest(n,i),0)):xe.u(0)})},C=!1,ue(z,2),!Hp(c)||!C||u2(c)){z.u(4);break}return E(z,w(t.filter(function(P){return P.h}),!0),5);case 5:return An(e),t=t.filter(function(P){return!P.h}),T=g,A=y,g={},y=0,E(z,l2(u,n,i,T,A,function(){return An(e)}),6);case 6:An(e);case 4:if(C){z.u(7);break}return E(z,w(t,!1),8);case 8:return An(e),b=g,k=y,g={},y=0,E(z,l2(u,n,i,b,k,function(){return An(e)}),9);case 9:An(e);case 7:ge(z,0);break;case 2:return O=ie(z),D=Object.values(g),E(z,u.removeSegments(D,function(){}),10);case 10:throw O}})}function a2(e){var t,n,i,s;return $(function(l){switch(l.g){case 1:return t=new Xn,E(l,t.init(),2);case 2:return E(l,Yx(t),3);case 3:return n=l.h,i=new ho("manifest",n.path.nb,n.path.Ja,e),E(l,t.destroy(),4);case 4:return s=new mn,E(l,s.remove(i.toString()),0)}})}function l2(e,t,n,i,s,l){var u,c,d,g,y,w,C,T,A,b,k;return $(function(O){switch(O.g){case 1:for(u=!1,ue(O,2),c=!0,d=x(n.streams),g=d.next();!g.done;g=d.next())for(y=g.value,w=x(y.segments),C=w.next();!C.done;C=w.next())T=C.value,A=T.pendingSegmentRefId?i[T.pendingSegmentRefId]:null,A!=null&&(T.dataKey=A,T.pendingSegmentRefId=void 0),A=T.pendingInitSegmentRefId?i[T.pendingInitSegmentRefId]:null,A!=null&&(T.initSegmentKey=A,T.pendingInitSegmentRefId=void 0),T.pendingSegmentRefId&&(c=!1),T.pendingInitSegmentRefId&&(c=!1);return n.size+=s,c&&(n.isIncomplete=!1),E(O,e.updateManifest(t,n),4);case 4:u=!0,l(),ge(O,0);break;case 2:return b=ie(O),E(O,a2(t),5);case 5:if(u){O.u(6);break}return k=Object.values(i),E(O,e.removeSegments(k,function(){}),6);case 6:throw b}})}function L4(e,t,n){var i,s,l,u,c,d,g,y,w,C,T,A,b,k,O,D,z,P,B,G,q,J,fe,te,ne,oe,xe,pe,we;return $(function(Me){switch(Me.g){case 1:return i={width:1/0,height:1/0},_T(e,n.restrictions,i),E(Me,zg(t,e,n.offline.usePersistentLicense,n.drm.preferredKeySystems),2);case 2:for(s=[],l=n.preferredDecodingAttributes,u=n.preferredVideoCodecs,c=n.preferredAudioCodecs,Vg(e,u,c,l),d=x(e.variants),g=d.next();!g.done;g=d.next())y=g.value,s.push(es(y));for(w=x(e.textStreams),C=w.next();!C.done;C=w.next())T=C.value,s.push(gu(T));for(A=x(e.imageStreams),b=A.next();!b.done;b=A.next())k=b.value,s.push(_h(k));return E(Me,n.offline.trackSelectionCallback(s),3);case 3:for(O=Me.h,D=e.presentationTimeline.getDuration(),z=0,P=x(O),B=P.next();!B.done;B=P.next())G=B.value,q=G.bandwidth*D/8,z+=q;return ue(Me,4),E(Me,n.offline.downloadSizeCallback(z),6);case 6:if(J=Me.h,!J)throw new K(2,9,9014);ge(Me,5);break;case 4:throw fe=ie(Me),fe instanceof K?fe:new K(2,9,9015);case 5:for(te=new Set,ne=new Set,oe=new Set,xe=x(O),pe=xe.next();!pe.done;pe=xe.next())we=pe.value,we.type=="variant"&&te.add(we.id),we.type=="text"&&ne.add(we.id),we.type=="image"&&oe.add(we.id);e.variants=e.variants.filter(function(Te){return te.has(Te.id)}),e.textStreams=e.textStreams.filter(function(Te){return ne.has(Te.id)}),e.imageStreams=e.imageStreams.filter(function(Te){return oe.has(Te.id)}),X4(e),F(Me)}})}function P4(e,t,n,i,s,l){var u=k4(n,t,i),c=s.offline.progressCallback;s4(l,function(T,A){u.size=A,c(u,T)},function(T,A){d&&s.offline.usePersistentLicense&&g==A&&_a(e,"cenc",T)});var d=Hp(t)&&!u2(t),g=null;d&&(g=W4.get(e.g.keySystem));for(var y=new b4,w=x(t.textStreams),C=w.next();!C.done;C=w.next())y.g[C.value.id]=52;for(w=x(t.imageStreams),C=w.next();!C.done;C=w.next())M4(y,C.value);for(w=x(t.variants),C=w.next();!C.done;C=w.next())I4(y,C.value);return y=F4(l,y,t,s),l=y.streams,y=y.Xf,w=e.g,C=s.offline.usePersistentLicense,w&&C&&(w.initData=[]),{ui:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.ad(),streams:l,sessionIds:C?Rm(e):[],drmInfo:w,appMetadata:i,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},Xf:y}}function Hp(e){return e.variants.some(function(t){var n=t.audio&&t.audio.encrypted;return t.video&&t.video.encrypted||n})}function u2(e){return e.variants.some(function(t){return(t.video?t.video.drmInfos:[]).concat(t.audio?t.audio.drmInfos:[]).some(function(n){return n.initData&&n.initData.length})})}function f2(e,t,n,i){if(t.expiration=n.ad(),n=Rm(n),t.sessionIds=i.offline.usePersistentLicense?n:[],Hp(e)&&i.offline.usePersistentLicense&&!n.length)throw new K(2,9,9007)}a.remove=function(e){return zp(this,D4(this,e))};function D4(e,t){var n,i,s,l,u,c;return $(function(d){switch(d.g){case 1:if(Zf(),n=Fp(t),n==null||n.g!="manifest")throw new K(2,9,9004,t);return i=n,s=new Xn,ye(d,2),E(d,s.init(),4);case 4:return E(d,qf(s,i.nb(),i.Ja()),5);case 5:return l=d.h,E(d,l.getManifests([i.key()]),6);case 6:return u=d.h,c=u[0],E(d,Promise.all([N4(e,c,s),O4(l,i,c)]),2);case 2:return ee(d),E(d,s.destroy(),8);case 8:de(d,0)}})}function c2(e,t){for(var n=[],i=x(e.streams),s=i.next();!s.done;s=i.next())s=s.value,t&&s.type=="video"?n.push({contentType:an(s.mimeType,s.codecs),robustness:e.drmInfo.videoRobustness}):t||s.type!="audio"||n.push({contentType:an(s.mimeType,s.codecs),robustness:e.drmInfo.audioRobustness});return n}function N4(e,t,n){return $(function(i){return E(i,G4(e.g,e.h.drm,n,t),0)})}function O4(e,t,n){function i(){}var s=z4(n);return $p(t,n),Promise.all([e.removeSegments(s,i),e.removeManifests([t.key()],i)])}a.Li=function(){return zp(this,U4(this))};function U4(e){var t,n,i,s,l,u,c,d,g,y;return $(function(w){switch(w.g){case 1:return Zf(),t=e.g,n=e.h.drm,i=new Xn,s=!1,ye(w,2),E(w,i.init(),4);case 4:l=[],h4(i,function(C){return l.push(C)}),u=x(l),c=u.next();case 5:if(c.done){w.u(2);break}return d=c.value,E(w,d.getAll(),8);case 8:return g=w.h,E(w,o2(n,t,g),9);case 9:return y=w.h,E(w,d.remove(y),10);case 10:y.length!=g.length&&(s=!0),c=u.next(),w.u(5);break;case 2:return ee(w),E(w,i.destroy(),11);case 11:de(w,3);break;case 3:return w.return(!s)}})}a.list=function(){return zp(this,B4())};function B4(){var e,t,n;return $(function(i){switch(i.g){case 1:return Zf(),e=[],t=new Xn,ye(i,2),E(i,t.init(),4);case 4:return n=Promise.resolve(),c4(t,function(s,l){n=n.then(function(){var u;return $(function(c){if(c.g==1)return E(c,l.getAllManifests(),2);u=c.h,u.forEach(function(d,g){d=$p(new ho("manifest",s.nb,s.Ja,g),d),e.push(d)}),F(c)})})}),E(i,n,2);case 2:return ee(i),E(i,t.destroy(),6);case 6:de(i,3);break;case 3:return i.return(e)}})}function j4(e,t,n,i){var s,l,u,c,d;return $(function(g){if(g.g==1)return s=null,l=e.g,u={networkingEngine:l,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(y){s=y},isLowLatencyMode:function(){return!1},isAutoLowLatencyMode:function(){return!1},enableLowLatencyMode:function(){},updateDuration:function(){},newDrmInfo:function(){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return i.abr.defaultBandwidthEstimate},onMetadata:function(){},disableStream:function(){}},n.configure(i.manifest),An(e),E(g,n.start(t,u),2);if(g.g!=3)return c=g.h,An(e),d=h2(c),E(g,Promise.all(Oh(d,function(y){return y.createSegmentIndex()})),3);if(An(e),s)throw s;return g.return(c)})}a.yc=function(e,t,n){var i=this,s;return $(function(l){return l.g==1?(s=new Mu({Lb:i.g,onError:t,ee:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),s.configure(n.drm),E(l,aC(s,e.variants,n.offline.usePersistentLicense),2)):l.g!=3?E(l,Mm(s),3):l.return(s)})};function F4(e,t,n,i){var s=new Map,l=h2(n),u=new Map;l=x(l);for(var c=l.next();!c.done;c=l.next()){c=c.value;var d=$4(e,t,n,c,i,s);u.set(c.id,d)}for(e=x(n.variants),t=e.next();!t.done;t=e.next())t=t.value,t.audio&&u.get(t.audio.id).variantIds.push(t.id),t.video&&u.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(u.values()),Xf:Array.from(s.values())}}function $4(e,t,n,i,s,l){var u={id:i.id,originalId:i.originalId,groupId:i.groupId,primary:i.primary,type:i.type,mimeType:i.mimeType,codecs:i.codecs,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:i.hdr,colorGamut:i.colorGamut,videoLayout:i.videoLayout,kind:i.kind,language:i.language,originalLanguage:i.originalLanguage,label:i.label,width:i.width||null,height:i.height||null,encrypted:i.encrypted,keyIds:i.keyIds,segments:[],variantIds:[],roles:i.roles,forced:i.forced,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,closedCaptions:i.closedCaptions,tilesLayout:i.tilesLayout,external:i.external,fastSwitching:i.fastSwitching},c=s.offline.numberOfParallelDownloads,d=0;return V4(i,n.presentationTimeline.mb(),function(g){var y=Np(g),w=void 0;if(!l.has(y)){var C=g.endTime-g.startTime;C=s2(t,i.id)*C,C=zx(e.g,C),l.set(y,new Vx(g,C,d,!1))}g.$&&(w=Np(g.$),l.has(w)||(C=.5*s2(t,i.id),C=zx(e.g,C),l.set(w,new Vx(g.$,C,d,!0)))),u.segments.push({pendingInitSegmentRefId:w,initSegmentKey:w?0:null,startTime:g.startTime,endTime:g.endTime,appendWindowStart:g.appendWindowStart,appendWindowEnd:g.appendWindowEnd,timestampOffset:g.timestampOffset,tilesLayout:g.tilesLayout,pendingSegmentRefId:y,dataKey:0,mimeType:g.mimeType,codecs:g.codecs}),d=(d+1)%c}),u}function V4(e,t,n){if(t=e.segmentIndex.find(t),t!=null)for(var i=e.segmentIndex.get(t);i;)n(i),i=e.segmentIndex.get(++t)}function An(e){if(e.l.g)throw new K(2,9,7001)}function Zf(){if(!Vp())throw new K(2,9,9e3)}function zp(e,t){return $(function(n){return n.g==1?(e.i.push(t),ye(n,2),E(n,t,4)):n.g!=2?n.return(n.h):(ee(n),Fn(e.i,t),de(n,0))})}function H4(e,t){var n=t.promise;return e.i.push(n),t.finally(function(){Fn(e.i,n)})}function z4(e){var t=new Set;e=x(e.streams);for(var n=e.next();!n.done;n=e.next()){n=x(n.value.segments);for(var i=n.next();!i.done;i=n.next())i=i.value,i.initSegmentKey!=null&&t.add(i.initSegmentKey),t.add(i.dataKey)}return Array.from(t)}function G4(e,t,n,i){var s,l,u;return $(function(c){return c.g==1?i.drmInfo?(s=d4(n),l=i.sessionIds.map(function(d){return{sessionId:d,keySystem:i.drmInfo.keySystem,licenseUri:i.drmInfo.licenseServerUri,serverCertificate:i.drmInfo.serverCertificate,audioCapabilities:c2(i,!1),videoCapabilities:c2(i,!0)}}),E(c,o2(t,e,l),2)):c.return():c.g!=3?(u=c.h,E(c,s.remove(u),3)):E(c,s.add(l.filter(function(d){return!u.includes(d.sessionId)})),0)})}function h2(e){for(var t=new Set,n=x(e.textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(n=x(e.imageStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(e=x(e.variants),n=e.next();!n.done;n=e.next())n=n.value,n.audio&&t.add(n.audio),n.video&&t.add(n.video);return t}function X4(e){e.variants.map(function(l){return l.video});var t=new Set(e.variants.map(function(l){return l.audio}));e=e.textStreams;for(var n=x(t),i=n.next();!i.done;i=n.next()){i=x(t);for(var s=i.next();!s.done;s=i.next());}for(t=x(e),n=t.next();!n.done;n=t.next())for(n=x(e),i=n.next();!i.done;i=n.next());}he("shaka.offline.Storage",mn),mn.deleteAll=function(){var e;return $(function(t){return t.g==1?(e=new Xn,ye(t,2),E(t,p4(e),2)):t.g!=5?(ee(t),E(t,e.destroy(),5)):de(t,0)})},mn.prototype.list=mn.prototype.list,mn.prototype.removeEmeSessions=mn.prototype.Li,mn.prototype.remove=mn.prototype.remove,mn.prototype.store=mn.prototype.store,mn.prototype.getNetworkingEngine=mn.prototype.xb,mn.prototype.getConfiguration=mn.prototype.getConfiguration,mn.prototype.configure=mn.prototype.configure,mn.prototype.destroy=mn.prototype.destroy,mn.support=Vp;var W4=new Map().set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95");Hd.offline=Vp;function wn(){}function Nn(e,t){for(e={priority:t||0,callback:e},t=0;t<xl.length;t++)if(xl[t].priority<e.priority){xl.splice(t,0,e);return}xl.push(e)}he("shaka.polyfill",wn),wn.register=Nn,wn.installAll=function(){for(var e=x(xl),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(n){Fe("Error installing polyfill!",n)}}};var xl=[];function wl(){this.g=new jr}function d2(){p.AbortController||(p.AbortController=wl,p.AbortSignal=jr)}wl.prototype.abort=function(e){var t=this.g;t.h||(t.h=!0,t.g=e,t.g===void 0&&(t.g=new DOMException("signal is aborted without reason","AbortError")),e=new Ue("abort"),t.onabort&&t.onabort(e),t.dispatchEvent(e))},M.Object.defineProperties(wl.prototype,{signal:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),wn.AbortController=wl,wl.install=d2;function jr(){this.h=!1,this.g=void 0,this.onabort=null,this.i=new Et}jr.prototype.addEventListener=function(e,t,n){return this.i.addEventListener(e,t,n)},jr.prototype.removeEventListener=function(e,t,n){return this.i.removeEventListener(e,t,n)},jr.prototype.dispatchEvent=function(e){return this.i.dispatchEvent(e)},jr.prototype.throwIfAborted=function(){if(this.h)throw this.g},M.Object.defineProperties(jr.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return this.h}},reason:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),Nn(d2);function p2(){}function g2(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var e=x(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())q4(t.value)}function q4(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(n){n==null||n==null?this.removeAttribute(t):this.setAttribute(t,n)}})}wn.Aria=p2,p2.install=g2,Nn(g2);function m2(){}function y2(){Nw()}wn.EncryptionScheme=m2,m2.install=y2,Nn(y2,-2);function v2(){}function x2(){if(p.Document){var e=Element.prototype;e.requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,e=Document.prototype,e.exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Vs),document.addEventListener("webkitfullscreenerror",Vs),document.addEventListener("mozfullscreenchange",Vs),document.addEventListener("mozfullscreenerror",Vs),document.addEventListener("MSFullscreenChange",Vs),document.addEventListener("MSFullscreenError",Vs)}}function Vs(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),n=document.createEvent("Event");n.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(n)}wn.Fullscreen=v2,v2.install=x2,Nn(x2);function Qf(){}function w2(){var e=!0;!hi()||hi()&&fu()||hi()&&Rt("Fuchsia")||(e=!1),(Xr()||lu()||lo()||ao()||so()||Rt("PC=EOS")||uu())&&(e=!1),e&&navigator.mediaCapabilities||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),S2=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=Y4)}function Y4(e){var t,n,i,s,l,u,c,d,g,y,w;return $(function(C){switch(C.g){case 1:if(t={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},n=e.video,i=e.audio,e.type!="media-source"){if(e.type=="file"){if(n&&(s=n.contentType,l=Sa(s),!l)||i&&(u=i.contentType,c=Sa(u),!c))return C.return(t)}else return C.return(t);C.u(2);break}if(!Wi())return C.return(t);if(!n){C.u(3);break}return E(C,K4(n),4);case 4:if(d=C.h,!d)return C.return(t);case 3:if(i){var T=i.contentType;if(hi()&&i.spatialRendering&&(T+="; spatialRendering=true"),g=Lt(T),!g)return C.return(t)}case 2:return e.keySystemConfiguration?(y=e.keySystemConfiguration,E(C,Z4(n,i,y),6)):(t.supported=!0,C.return(t));case 6:(w=C.h)&&(t.supported=!0,t.keySystemAccess=w);case 5:return C.return(t)}})}function K4(e){var t,n;return $(function(i){return i.g==1?hi()?E(i,Q4(e),3):so()?(t=e.contentType,e.width&&e.height&&(t+="; width="+e.width,t+="; height="+e.height),e.framerate&&(t+="; framerate="+e.framerate),e.bitrate&&(t+="; bitrate="+e.bitrate),i.return(Lt(t))):i.u(2):i.g!=2?(n=i.h,i.return(n)):i.return(Lt(e.contentType))})}function Z4(e,t,n){var i,s,l,u,c,d,g,y,w;return $(function(C){switch(C.g){case 1:if(i=[],s=[],n.audio&&(l={robustness:n.audio.robustness||"",contentType:t.contentType},so()&&t.contentType.includes('codecs="ac-3"')&&(l.contentType='audio/mp4; codecs="ec-3"'),n.audio.encryptionScheme&&(l.encryptionScheme=n.audio.encryptionScheme),i.push(l)),n.video&&(u={robustness:n.video.robustness||"",contentType:e.contentType},n.video.encryptionScheme&&(u.encryptionScheme=n.video.encryptionScheme),s.push(u)),c={initDataTypes:[n.initDataType],distinctiveIdentifier:n.distinctiveIdentifier,persistentState:n.persistentState,sessionTypes:n.sessionTypes},i.length&&(c.audioCapabilities=i),s.length&&(c.videoCapabilities=s),d=e?e.contentType:"",g=t?t.contentType:"",y=n.keySystem,w=null,ue(C,2),ru.has(d+"#"+g+"#"+y)){w=ru.get(d+"#"+g+"#"+y)||null,C.u(4);break}return E(C,navigator.requestMediaKeySystemAccess(n.keySystem,[c]),5);case 5:w=C.h,ru.set(d+"#"+g+"#"+y,w);case 4:ge(C,3);break;case 2:ie(C);case 3:return C.return(w)}})}function Q4(e){var t,n;return $(function(i){return i.g==1?p.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(t=e.contentType,e.width&&e.height&&(t+="; width="+e.width+"; height="+e.height),e.framerate&&(t+="; framerate="+e.framerate),e.transferFunction==="pq"&&(t+="; eotf=smpte2084"),n=!1,t in Jf?(n=Jf[t],i.u(2)):E(i,cast.__platform__.canDisplayType(t),3)):i.return(Lt(e.contentType)):(i.g!=2&&(n=i.h,Jf[t]=n),i.return(n))})}wn.MediaCapabilities=Qf,Qf.install=w2;var S2=null;Qf.originalMcap=S2;var Jf={};Qf.memoizedCanDisplayTypeRequests_=Jf,Nn(w2,-1);function T2(){}function C2(){var e=Wr();(p.MediaSource||p.ManagedMediaSource)&&(e&&p.MediaSource?10>=e?p.MediaSource=null:12>=e?(Gp(),E2()):15>=e&&Gp():Rt("DT_STB_BCM")?(Gp(),E2()):(su()||Ca()||Rt("Tizen 4"))&&e3()),(p.MediaSource||p.ManagedMediaSource)&&J4(),p.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&t3()}function Gp(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,Pe.apply(0,arguments));return t.abort=function(){},t}}function E2(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}function J4(){if(p.MediaSource){var e=MediaSource.isTypeSupported.bind(MediaSource);MediaSource.isTypeSupported=function(n){return hu(n)!="mp2t"&&e(n)}}if(p.ManagedMediaSource){var t=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);p.ManagedMediaSource.isTypeSupported=function(n){return hu(n)!="mp2t"&&t(n)}}}function e3(){var e=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(n){return Zr(n)!="opus"&&e(n)},p.ManagedMediaSource){var t=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);p.ManagedMediaSource.isTypeSupported=function(n){return Zr(n)!="opus"&&t(n)}}}function t3(){var e=MediaSource.isTypeSupported;ao()||(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),i=n.findIndex(function(u){return u.startsWith("codecs=")});if(0>i)return e(t);var s=n[i].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),l=s.findIndex(function(u){return u.startsWith("vp09")});return 0<=l&&(s[l]="vp9",n[i]='codecs="'+s.join(",")+'"',t=n.join("; ")),e(t)})}wn.MediaSource=T2,T2.install=C2,Nn(C2);function A2(){}function k2(){screen.orientation&&screen.orientation.unlock||(screen.orientation!=null?n3():p.orientation!=null&&i3())}function n3(){screen.orientation.lock===void 0&&(screen.orientation.lock=function(){return Promise.resolve()}),screen.orientation.unlock===void 0&&(screen.orientation.unlock=function(){})}function i3(){function e(){switch(p.orientation){case-90:t.type="landscape-secondary",t.angle=270;break;case 0:t.type="portrait-primary",t.angle=0;break;case 90:t.type="landscape-primary",t.angle=90;break;case 180:t.type="portrait-secondary",t.angle=180}}var t=new ec;screen.orientation=t,e(),p.addEventListener("orientationchange",function(){e();var n=new Ue("change");t.dispatchEvent(n)})}wn.Orientation=A2,A2.install=k2;function ec(){Et.call(this),this.type="",this.angle=0}le(ec,Et),ec.prototype.lock=function(e){function t(i){return screen.lockOrientation?screen.lockOrientation(i):screen.mozLockOrientation?screen.mozLockOrientation(i):screen.msLockOrientation?screen.msLockOrientation(i):!1}var n=!1;switch(e){case"natural":n=t("default");break;case"any":n=!0,this.unlock();break;default:n=t(e)}return n?Promise.resolve():(e=Error("screen.orientation.lock() is not available on this device"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},ec.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},Nn(k2);function Xp(){}var Wp,qp,Yp,Kp,Zp,Qp;function o3(e,t){try{var n=new tc(e,t);return Promise.resolve(n)}catch(i){return Promise.reject(i)}}function r3(e){var t=this.mediaKeys;return t&&t!=e&&b2(t,null),delete this.mediaKeys,(this.mediaKeys=e)?b2(e,this):Promise.resolve()}function s3(e){if(e=Ze(e.initData),xn(e).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=xo(e.subarray(4),!0),e=qi(e);var t=new Event("encrypted");t.initDataType="skd",t.initData=Pt(e),this.dispatchEvent(t)}wn.PatchedMediaKeysApple=Xp,Xp.uninstall=function(){Wp&&(Wp=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",qp),HTMLMediaElement.prototype.setMediaKeys=Yp,p.MediaKeys=Kp,p.MediaKeySystemAccess=Zp,navigator.requestMediaKeySystemAccess=Qp,qp=Qp=Yp=Zp=Kp=null,p.shakaMediaKeysPolyfill="")},Xp.install=function(e){p.HTMLVideoElement&&p.WebKitMediaKeys&&(e!==void 0&&e&&(Wp=!0,qp=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),Yp=HTMLMediaElement.prototype.setMediaKeys,Kp=p.MediaKeys,Zp=p.MediaKeySystemAccess,Qp=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=r3,p.MediaKeys=Sl,p.MediaKeySystemAccess=tc,navigator.requestMediaKeySystemAccess=o3,p.shakaMediaKeysPolyfill=a3)};function tc(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(e=x(t),t=e.next();!t.done;t=e.next()){var n=t.value;if(n.persistentState=="required")t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var i=!1,s=!1;if(n.audioCapabilities)for(var l=x(n.audioCapabilities),u=l.next();!u.done;u=l.next())u=u.value,u.contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,u.contentType.split(";")[0])&&(t.audioCapabilities.push(u),s=!0));if(n.videoCapabilities)for(n=x(n.videoCapabilities),l=n.next();!l.done;l=n.next())l=l.value,l.contentType&&(i=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,l.contentType.split(";")[0])&&(t.videoCapabilities.push(l),s=!0));i||(s=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=s?t:null}if(t){this.g=t;return}}throw e=Error("Unsupported keySystem"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}tc.prototype.createMediaKeys=function(){var e=new Sl(this.keySystem);return Promise.resolve(e)},tc.prototype.getConfiguration=function(){return this.g};function Sl(e){this.h=new WebKitMediaKeys(e),this.g=new lt}Sl.prototype.createSession=function(e){if(e=e||"temporary",e!="temporary")throw new TypeError("Session type "+e+" is unsupported on this platform.");return new Jp(this.h)},Sl.prototype.setServerCertificate=function(){return Promise.resolve(!1)};function b2(e,t){if(e.g.Ra(),!t)return Promise.resolve();e.g.D(t,"webkitneedkey",s3);try{return ps(t,HTMLMediaElement.HAVE_METADATA,e.g,function(){t.webkitSetMediaKeys(e.h)}),Promise.resolve()}catch(n){return Promise.reject(n)}}Sl.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")};function Jp(e){Et.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new lt,this.sessionId="",this.expiration=NaN,this.closed=new _t,this.keyStatuses=new I2}le(Jp,Et),a=Jp.prototype,a.generateRequest=function(e,t){var n=this;this.h=new _t;try{var i=this.l.createSession("video/mp4",Ze(t));this.i=i,this.sessionId=i.sessionId||"",this.j.D(this.i,"webkitkeymessage",function(s){n.h&&(n.h.resolve(),n.h=null),s=new Map().set("messageType",n.keyStatuses.Yb()==null?"license-request":"license-renewal").set("message",Pt(s.message)),s=new Ue("message",s),n.dispatchEvent(s)}),this.j.D(i,"webkitkeyadded",function(){n.g&&(nc(n,"usable"),n.g.resolve(),n.g=null)}),this.j.D(i,"webkitkeyerror",function(){var s=Error("EME PatchedMediaKeysApple key error");if(s.errorCode=n.i.error,n.h!=null)n.h.reject(s),n.h=null;else if(n.g!=null)n.g.reject(s),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:nc(n,"output-not-allowed");break;default:nc(n,"internal-error")}}),nc(this,"status-pending")}catch(s){this.h.reject(s)}return this.h},a.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},a.update=function(e){this.g=new _t;try{this.i.update(Ze(e))}catch(t){this.g.reject(t)}return this.g},a.close=function(){try{this.i.close(),this.closed.resolve(),this.j.Ra()}catch(e){this.closed.reject(e)}return this.closed},a.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};function nc(e,t){var n=e.keyStatuses;n.size=t==null?0:1,n.g=t,t=new Ue("keystatuseschange"),e.dispatchEvent(t)}function I2(){this.size=0,this.g=void 0}a=I2.prototype,a.Yb=function(){return this.g},a.forEach=function(e){this.g&&e(this.g,ou.value())},a.get=function(e){if(this.has(e))return this.g},a.has=function(e){var t=ou.value();return!!(this.g&&Zt(e,t))},a.entries=function(){},a.keys=function(){},a.values=function(){};var a3="apple";function M2(){}function R2(){p.MediaKeys&&(!MediaKeys.prototype.setServerCertificate||Ca()||Rt("Tizen 4")||Rt("Tizen 5.0")||au())&&(MediaKeys.prototype.setServerCertificate=l3)}function l3(){return Promise.resolve(!1)}wn.PatchedMediaKeysCert=M2,M2.install=R2,Nn(R2);function _2(){}function L2(){!p.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=u3,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=f3,p.MediaKeys=ic,p.MediaKeySystemAccess=e0,p.shakaMediaKeysPolyfill=c3)}function u3(){return Promise.reject(Error("The key system specified is not supported."))}function f3(e){return e==null?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}wn.PatchedMediaKeysNop=_2,_2.install=L2;function ic(){throw new TypeError("Illegal constructor.")}ic.prototype.createSession=function(){},ic.prototype.setServerCertificate=function(){},ic.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")};function e0(){throw this.keySystem="",new TypeError("Illegal constructor.")}e0.prototype.getConfiguration=function(){},e0.prototype.createMediaKeys=function(){};var c3="nop";Nn(L2,-10);function P2(){}function D2(){if(!(!p.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)r0="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=h3,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=d3,p.MediaKeys=Tl,p.MediaKeySystemAccess=oc,p.shakaMediaKeysPolyfill=p3}}function t0(e){var t=r0;return t?t+e.charAt(0).toUpperCase()+e.slice(1):e}function h3(e,t){try{var n=new oc(e,t);return Promise.resolve(n)}catch(i){return Promise.reject(i)}}function d3(e){var t=this.mediaKeys;return t&&t!=e&&N2(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&N2(e,this),Promise.resolve()}wn.PatchedMediaKeysWebkit=P2,P2.install=D2;function oc(e,t){this.g=this.keySystem=e;var n=!1;e=="org.w3.clearkey"&&(this.g="webkit-org.w3.clearkey",n=!1);var i=!1,s=document.getElementsByTagName("video");s=s.length?s[0]:document.createElement("video"),t=x(t);for(var l=t.next();!l.done;l=t.next()){l=l.value;var u={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:l.initDataTypes,sessionTypes:["temporary"],label:l.label},c=!1;if(l.audioCapabilities)for(var d=x(l.audioCapabilities),g=d.next();!g.done;g=d.next())g=g.value,g.contentType&&(c=!0,s.canPlayType(g.contentType.split(";")[0],this.g)&&(u.audioCapabilities.push(g),i=!0));if(l.videoCapabilities)for(d=x(l.videoCapabilities),g=d.next();!g.done;g=d.next())g=g.value,g.contentType&&(c=!0,s.canPlayType(g.contentType,this.g)&&(u.videoCapabilities.push(g),i=!0));if(c||(i=s.canPlayType("video/mp4",this.g)||s.canPlayType("video/webm",this.g)),l.persistentState=="required"&&(n?(u.persistentState="required",u.sessionTypes=["persistent-license"]):i=!1),i){this.h=u;return}}throw n="Unsupported keySystem",(e=="org.w3.clearkey"||e=="com.widevine.alpha")&&(n="None of the requested configurations were supported."),e=Error(n),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}oc.prototype.createMediaKeys=function(){var e=new Tl(this.g);return Promise.resolve(e)},oc.prototype.getConfiguration=function(){return this.h};function Tl(e){this.l=e,this.h=null,this.g=new lt,this.i=[],this.j=new Map}function N2(e,t){e.h=t,e.g.Ra();var n=r0;t&&(e.g.D(t,n+"needkey",function(i){var s=new CustomEvent("encrypted");s.initDataType="cenc",s.initData=Pt(i.initData),e.h.dispatchEvent(s)}),e.g.D(t,n+"keymessage",function(i){var s=n0(e,i.sessionId);s&&(i=new Map().set("messageType",s.keyStatuses.Yb()==null?"licenserequest":"licenserenewal").set("message",i.message),i=new Ue("message",i),s.h&&(s.h.resolve(),s.h=null),s.dispatchEvent(i))}),e.g.D(t,n+"keyadded",function(i){(i=n0(e,i.sessionId))&&i.ready()}),e.g.D(t,n+"keyerror",function(i){var s=n0(e,i.sessionId);if(s){var l=Error("EME v0.1b key error"),u=i.errorCode;u.systemCode=i.systemCode,l.errorCode=u,!i.sessionId&&s.h?(i.systemCode==45&&(l.message="Unsupported session type."),s.h.reject(l),s.h=null):i.sessionId&&s.g?(s.g.reject(l),s.g=null):(l=i.systemCode,i.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?rc(s,"output-restricted"):l==1?rc(s,"expired"):rc(s,"internal-error"))}}))}Tl.prototype.createSession=function(e){if(e=e||"temporary",e!="temporary"&&e!="persistent-license")throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new i0(t,this.l,e),this.i.push(e),e},Tl.prototype.setServerCertificate=function(){return Promise.resolve(!1)},Tl.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")};function n0(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function i0(e,t,n){Et.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new _t,this.keyStatuses=new U2}le(i0,Et),a=i0.prototype,a.ready=function(){rc(this,"usable"),this.g&&this.g.resolve(),this.g=null};function O2(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if(e.l=="persistent-license")if(n)var i=Ze(qi("LOAD_SESSION|"+n));else{var s=qi("PERSISTENT|");i=Qt(s,t)}else i=Ze(t)}catch(u){return Promise.reject(u)}e.h=new _t;var l=t0("generateKeyRequest");try{e.j[l](e.i,i)}catch(u){if(u.name!="InvalidStateError")return e.h=null,Promise.reject(u);new ct(function(){try{e.j[l](e.i,i)}catch(c){e.h.reject(c),e.h=null}}).Y(.01)}return e.h}function o0(e,t,n){if(e.g)e.g.then(function(){return o0(e,t,n)}).catch(function(){return o0(e,t,n)});else{if(e.g=t,e.i=="webkit-org.w3.clearkey"){var i=Vt(n),s=JSON.parse(i);s.keys[0].kty!="oct"&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),i=Ti(s.keys[0].k),s=Ti(s.keys[0].kid)}else i=Ze(n),s=null;var l=t0("addKey");try{e.j[l](e.i,i,s,e.sessionId)}catch(u){e.g.reject(u),e.g=null}}}function rc(e,t){var n=e.keyStatuses;n.size=t==null?0:1,n.g=t,t=new Ue("keystatuseschange"),e.dispatchEvent(t)}a.generateRequest=function(e,t){return O2(this,t,null)},a.load=function(e){return this.l=="persistent-license"?O2(this,null,e):Promise.reject(Error("Not a persistent session."))},a.update=function(e){var t=new _t;return o0(this,t,e),t},a.close=function(){if(this.l!="persistent-license"){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=t0("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch{}}return this.closed.resolve(),this.closed},a.remove=function(){return this.l!="persistent-license"?Promise.reject(Error("Not a persistent session.")):this.close()};function U2(){this.size=0,this.g=void 0}a=U2.prototype,a.Yb=function(){return this.g},a.forEach=function(e){this.g&&e(this.g,ou.value())},a.get=function(e){if(this.has(e))return this.g},a.has=function(e){var t=ou.value();return!!(this.g&&Zt(e,t))},a.entries=function(){},a.keys=function(){},a.values=function(){};var r0="",p3="webkit";Nn(D2);function B2(){}function j2(){if(p.HTMLVideoElement){var e=HTMLVideoElement.prototype;e.requestPictureInPicture&&document.exitPictureInPicture||!e.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=m3,Object.defineProperty(e,"disablePictureInPicture",{get:v3,set:x3,enumerable:!0,configurable:!0}),document.exitPictureInPicture=y3,document.addEventListener("webkitpresentationmodechanged",g3,!0))}}function g3(e){if(e=e.target,e.webkitPresentationMode=="picture-in-picture"){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function m3(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function y3(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function v3(){return this.hasAttribute("disablePictureInPicture")?!0:!this.webkitSupportsPresentationMode("picture-in-picture")}function x3(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}wn.PiPWebkit=B2,B2.install=j2,Nn(j2);function F2(){}function $2(){p.crypto&&("randomUUID"in p.crypto||(p.crypto.randomUUID=w3))}function w3(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}wn.RandomUUID=F2,F2.install=$2,Nn($2);function V2(){}function H2(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:S3})}function S3(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}wn.Symbol=V2,V2.install=H2,Nn(H2);function z2(){}function G2(){if(p.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var t=e.apply(this);return t&&t.catch(function(){}),t}}}wn.VideoPlayPromise=z2,z2.install=G2,Nn(G2);function X2(){}function W2(){if(p.HTMLVideoElement){var e=HTMLVideoElement.prototype;!e.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in e||au())&&(e.getVideoPlaybackQuality=T3)}}function T3(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}wn.VideoPlaybackQuality=X2,X2.install=W2,Nn(W2);function q2(){}function Y2(){if(!p.VTTCue&&p.TextTrackCue){var e=null,t=TextTrackCue.length;if(t==3)e=s0;else if(t==6)e=C3;else{try{var n=!!s0(1,2,"")}catch{n=!1}n&&(e=s0)}e&&(p.VTTCue=function(i,s,l){return e(i,s,l)})}}function s0(e,t,n){return new p.TextTrackCue(e,t,n)}function C3(e,t,n){return new p.TextTrackCue(e+"-"+t+"-"+n,e,t,n)}wn.VTTCue=q2,q2.install=Y2,Nn(Y2);function gi(){}gi.prototype.parseInit=function(){},gi.prototype.setSequenceMode=function(){},gi.prototype.setManifestType=function(){},gi.prototype.parseMedia=function(e,t){var n=null,i=[];e=Vt(e).split(/\r?\n/),e=x(e);for(var s=e.next();!s.done;s=e.next())if((s=s.value)&&!/^\s+$/.test(s)&&(s=E3.exec(s))){var l=A3.exec(s[1]);l=60*parseInt(l[1],10)+parseFloat(l[2].replace(",",".")),s=new St(l,t.segmentEnd?t.segmentEnd:l+2,s[2]),n&&(n.endTime=l,i.push(n)),n=s}return n&&i.push(n),i},he("shaka.text.LrcTextParser",gi),gi.prototype.parseMedia=gi.prototype.parseMedia,gi.prototype.setManifestType=gi.prototype.setManifestType,gi.prototype.setSequenceMode=gi.prototype.setSequenceMode,gi.prototype.parseInit=gi.prototype.parseInit;var E3=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,A3=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;ln["application/x-subtitle-lrc"]=function(){return new gi};function ii(){}ii.prototype.parseInit=function(){},ii.prototype.setSequenceMode=function(){},ii.prototype.setManifestType=function(){},ii.prototype.parseMedia=function(e,t,n){var i=Vt(e);if(e=[],i=="")return e;var s=ls(i,"tt");if(!s)throw new K(2,2,2005,"Failed to parse TTML.");if(i=Bi(s,"body")[0],!i)return[];var l=fo(s,Cl,"frameRate"),u=fo(s,Cl,"subFrameRate"),c=fo(s,Cl,"frameRateMultiplier"),d=fo(s,Cl,"tickRate"),g=fo(s,Cl,"cellResolution"),y=s.attributes["xml:space"]||"default",w=fo(s,lc,"extent");if(y!="default"&&y!="preserve")throw new K(2,2,2005,"Invalid xml:space value: "+y);y=y=="default",l=new I3(l,u,c,d),g=g&&(g=/^(\d+) (\d+)$/.exec(g))?{dc:parseInt(g[1],10),rows:parseInt(g[2],10)}:null,u=(u=Bi(s,"metadata")[0])?u.children:[],c=Bi(s,"style"),s=Bi(s,"region"),d=[];for(var C=x(s),T=C.next();!T.done;T=C.next()){var A=T.value;T=new jn;var b=A.attributes["xml:id"];if(b){T.id=b;var k=null;w&&(k=f0.exec(w)||c0.exec(w)),b=k?Number(k[1]):null,k=k?Number(k[2]):null;var O,D=sc(A,c,"extent");if(D){var z=(O=f0.exec(D))||c0.exec(D);z!=null&&(T.width=Number(z[1]),T.height=Number(z[2]),O||(b!=null&&(T.width=100*T.width/b),k!=null&&(T.height=100*T.height/k)),T.widthUnits=O||b!=null?Wn:0,T.heightUnits=O||k!=null?Wn:0)}(A=sc(A,c,"origin"))&&(z=(O=f0.exec(A))||c0.exec(A),z!=null&&(T.viewportAnchorX=Number(z[1]),T.viewportAnchorY=Number(z[2]),O?D||(T.width=100-T.viewportAnchorX,T.widthUnits=Wn,T.height=100-T.viewportAnchorY,T.heightUnits=Wn):(k!=null&&(T.viewportAnchorY=100*T.viewportAnchorY/k),b!=null&&(T.viewportAnchorX=100*T.viewportAnchorX/b)),T.viewportAnchorUnits=O||b!=null?Wn:0))}else T=null;T&&d.push(T)}if(Bt(i,"p").length)throw new K(2,2,2001,"<p> can only be inside <div> in TTML");for(w=x(Bt(i,"div")),C=w.next();!C.done;C=w.next())if(Bt(C.value,"span").length)throw new K(2,2,2001,"<span> can only be inside <p> in TTML");return(t=K2(i,t,l,u,c,s,d,y,g,null,!1,n))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e};function K2(e,t,n,i,s,l,u,c,d,g,y,w){var C=g;if(Eu(e)){if(!y)return null;var T={tagName:"span",children:[un(e)],attributes:{},parent:null}}else T=e;for(var A=null,b=x(sw),k=b.next();!k.done&&!(A=ac(T,"backgroundImage",i,"#",k.value)[0]);k=b.next());b=null;var O=fo(T,sw,"backgroundImage");if(w&&O&&!O.startsWith("#")&&(k=new tn(w),O=new tn(O),(k=k.resolve(O).toString())&&(b=k)),(e.tagName=="p"||A||b)&&(y=!0),e=y,k=(T.attributes["xml:space"]||(c?"default":"preserve"))=="default",O=T.children.every(Eu),c=[],!O)for(var D=x(T.children),z=D.next();!z.done;z=D.next())(z=K2(z.value,t,n,i,s,l,u,k,d,T,y,w))&&c.push(z);if(i=g!=null,w=un(T),w=T.children.length&&w&&/\S/.test(w),z=T.attributes.begin||T.attributes.end||T.attributes.dur,!(z||w||T.tagName=="br"||c.length!=0||i&&!k))return null;for(D=J2(T,n),w=D.start,D=D.end;C&&C.tagName&&C.tagName!="tt";)D=b3(C,n,w,D),w=D.start,D=D.end,C=C.parent;if(w==null&&(w=0),w+=t.periodStart,D=D==null?1/0:D+t.periodStart,w=Math.max(w,t.segmentStart),D=Math.min(D,t.segmentEnd),!z&&0<c.length)for(w=1/0,D=0,t=x(c),n=t.next();!n.done;n=t.next())n=n.value,w=Math.min(w,n.startTime),D=Math.max(D,n.endTime);if(T.tagName=="br")return s=new St(w,D,""),s.lineBreak=!0,s;if(t="",O&&(t=$n(un(T)||""),k&&(t=t.replace(/\s+/g," "))),t=new St(w,D,t),t.nestedCues=c,y||(t.isContainer=!0),d&&(t.cellResolution=d),d=ac(T,"region",l,"")[0],T.attributes.region&&d&&d.attributes["xml:id"]){var P=d.attributes["xml:id"];t.region=u.filter(function(B){return B.id==P})[0]}return u=d,g&&i&&!T.attributes.region&&!T.attributes.style&&(u=ac(g,"region",l,"")[0]),k3(t,T,u,A,b,s,e,c.length==0),t}function k3(e,t,n,i,s,l,u,c){if(u=u||c,kn(t,n,l,"direction",u)=="rtl"&&(e.direction="rtl"),c=kn(t,n,l,"writingMode",u),c=="tb"||c=="tblr"?e.writingMode="vertical-lr":c=="tbrl"?e.writingMode="vertical-rl":c=="rltb"||c=="rl"?e.direction="rtl":c&&(e.direction=ga),(c=kn(t,n,l,"textAlign",!0))?(e.positionAlign=_3[c],e.lineAlign=R3[c],e.textAlign=fh[c.toUpperCase()]):e.textAlign=yo,(c=kn(t,n,l,"displayAlign",!0))&&(e.displayAlign=xg[c.toUpperCase()]),(c=kn(t,n,l,"color",u))&&(e.color=c),(c=kn(t,n,l,"backgroundColor",u))&&(e.backgroundColor=c),(c=kn(t,n,l,"border",u))&&(e.border=c),c=kn(t,n,l,"fontFamily",u))switch(c){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=c.split(",").filter(function(d){return d!="default"}).join(",")}switch((c=kn(t,n,l,"fontWeight",u))&&c=="bold"&&(e.fontWeight=700),c=kn(t,n,l,"wrapOption",u),e.wrapLine=!(c&&c=="noWrap"),(c=kn(t,n,l,"lineHeight",u))&&c.match(Hs)&&(e.lineHeight=c),(c=kn(t,n,l,"fontSize",u))&&(c.match(Hs)||c.match(M3))&&(e.fontSize=c),(c=kn(t,n,l,"fontStyle",u))&&(e.fontStyle=Cg[c.toUpperCase()]),i?(s=i.attributes.imageType||i.attributes.imagetype,c=i.attributes.encoding,i=un(i).trim(),s=="PNG"&&c=="Base64"&&i&&(e.backgroundImage="data:image/png;base64,"+i)):s&&(e.backgroundImage=s),(i=kn(t,n,l,"textOutline",u))&&(i=i.split(" "),i[0].match(Hs)?e.textStrokeColor=e.color:(e.textStrokeColor=i[0],i.shift()),i[0]&&i[0].match(Hs)?e.textStrokeWidth=i[0]:e.textStrokeColor=""),(i=kn(t,n,l,"letterSpacing",u))&&i.match(Hs)&&(e.letterSpacing=i),(i=kn(t,n,l,"linePadding",u))&&i.match(Hs)&&(e.linePadding=i),(i=kn(t,n,l,"opacity",u))&&(e.opacity=parseFloat(i)),(i=sc(n,l,"textDecoration"))&&Z2(e,i),(i=a0(t,l,"textDecoration"))&&Z2(e,i),(i=kn(t,n,l,"textCombine",u))&&(e.textCombineUpright=i),kn(t,n,l,"ruby",u)){case"container":e.rubyTag="ruby";break;case"text":e.rubyTag="rt"}}function Z2(e,t){t=x(t.split(" "));for(var n=t.next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&Fn(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Fn(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Fn(e.textDecoration,"overline")}}function kn(e,t,n,i,s){return s=s===void 0?!0:s,(e=a0(e,n,i))?e:s?sc(t,n,i):null}function sc(e,t,n){if(!e)return null;var i=fo(e,lc,n);return i||Q2(e,t,n)}function a0(e,t,n){var i=fo(e,lc,n);return i||Q2(e,t,n)}function Q2(e,t,n){e=ac(e,"style",t,"");for(var i=null,s=0;s<e.length;s++){var l=ko(e[s],"urn:ebu:tt:style",n);l||(l=fo(e[s],lc,n)),l||(l=a0(e[s],t,n)),l&&(i=l)}return i}function ac(e,t,n,i,s){var l=[];if(!e||1>n.length)return l;var u=e;for(e=null;!e&&!(e=s?ko(u,s,t):u.attributes[t])&&(u=u.parent,u););if(t=e){for(t=x(t.split(" ")),s=t.next();!s.done;s=t.next())for(s=s.value,e=x(n),u=e.next();!u.done;u=e.next())if(u=u.value,i+u.attributes["xml:id"]==s){l.push(u);break}}return l}function b3(e,t,n,i){return e=J2(e,t),n==null?n=e.start:e.start!=null&&(n+=e.start),i==null?i=e.end:e.start!=null&&(i+=e.start),{start:n,end:i}}function J2(e,t){var n=l0(e.attributes.begin,t),i=l0(e.attributes.end,t);return e=l0(e.attributes.dur,t),i==null&&e!=null&&(i=n+e),{start:n,end:i}}function l0(e,t){var n=null;if(ew.test(e)){e=ew.exec(e),n=Number(e[1]);var i=Number(e[2]),s=Number(e[3]),l=Number(e[4]);l+=(Number(e[5])||0)/t.h,s+=l/t.frameRate,n=s+60*i+3600*n}else if(tw.test(e))n=u0(tw,e);else if(nw.test(e))n=u0(nw,e);else if(iw.test(e))e=iw.exec(e),n=Number(e[1])/t.frameRate;else if(ow.test(e))e=ow.exec(e),n=Number(e[1])/t.g;else if(rw.test(e))n=u0(rw,e);else if(e)throw new K(2,2,2001,"Could not parse cue time range in TTML");return n}function u0(e,t){return e=e.exec(t),e==null||e[0]==""?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}he("shaka.text.TtmlTextParser",ii),ii.prototype.parseMedia=ii.prototype.parseMedia,ii.prototype.setManifestType=ii.prototype.setManifestType,ii.prototype.setSequenceMode=ii.prototype.setSequenceMode,ii.prototype.parseInit=ii.prototype.parseInit;function I3(e,t,n,i){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(i),this.g==0&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}var f0=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,M3=/^(\d{1,4}(?:\.\d+)?|100)%$/,Hs=/^(\d+px|\d+em|\d*\.?\d+c)$/,c0=/^(\d+)px (\d+)px$/,ew=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,tw=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,nw=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,iw=/^(\d*(?:\.\d*)?)f$/,ow=/^(\d*(?:\.\d*)?)t$/,rw=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),R3={left:xr,center:"center",right:"end",start:xr,end:"end"},_3={left:"line-left",center:"center",right:"line-right"},Cl=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],lc=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],sw=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];ln["application/ttml+xml"]=function(){return new ii};function yn(){this.g=new ii}yn.prototype.parseInit=function(e){var t=!1;if(new Ot().box("moov",dt).box("trak",dt).box("mdia",dt).box("minf",dt).box("stbl",dt).S("stsd",Wo).box("stpp",function(n){t=!0,n.parser.stop()}).parse(e),!t)throw new K(2,2,2007)},yn.prototype.setSequenceMode=function(){},yn.prototype.setManifestType=function(){},yn.prototype.parseMedia=function(e,t,n){var i=this,s=!1,l=[];if(new Ot().box("mdat",ss(function(u){s=!0,l=l.concat(i.g.parseMedia(u,t,n))})).parse(e,!1),!s)throw new K(2,2,2007);return l},he("shaka.text.Mp4TtmlParser",yn),yn.prototype.parseMedia=yn.prototype.parseMedia,yn.prototype.setManifestType=yn.prototype.setManifestType,yn.prototype.setSequenceMode=yn.prototype.setSequenceMode,yn.prototype.parseInit=yn.prototype.parseInit,ln['application/mp4; codecs="stpp"']=function(){return new yn},ln['application/mp4; codecs="stpp.ttml"']=function(){return new yn},ln['application/mp4; codecs="stpp.ttml.im1t"']=function(){return new yn},ln['application/mp4; codecs="stpp.ttml.im2t"']=function(){return new yn},ln['application/mp4; codecs="stpp.ttml.etd1"']=function(){return new yn},ln['application/mp4; codecs="stpp.ttml.etd1|im1t"']=function(){return new yn},ln['application/mp4; codecs="stpp.ttml.im1t|etd1"']=function(){return new yn},ln['application/mp4; codecs="stpp.TTML.im1t"']=function(){return new yn};function On(){this.h=!1,this.g="UNKNOWN"}On.prototype.parseInit=function(){},On.prototype.setSequenceMode=function(e){this.h=e},On.prototype.setManifestType=function(e){this.g=e},On.prototype.parseMedia=function(e,t){e=Vt(e),e=e.replace(/\r\n|\r(?=[^\n]|$)/gm,`
`);var n=e.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new K(2,2,2e3);if(e=t.vttOffset,n[0].includes("X-TIMESTAMP-MAP")&&this.g=="HLS")if(this.h){var i=n[0];if(e=i.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),i=i.match(/MPEGTS:(\d+)/m),!e||!i)throw new K(2,2,2e3);if(e=uc(new Qo(e[1])),e==null)throw new K(2,2,2e3);i=Number(i[1]);for(var s=t.segmentStart-t.periodStart;95443.7176888889<=s;)s-=95443.7176888889,i+=8589934592;e=t.periodStart+i/9e4-e}else e=t.segmentStart;for(t=[],i=x(n[0].split(`
`)),s=i.next();!s.done;s=i.next())if(s=s.value,/^Region:/.test(s)){s=new Qo(s);var l=new jn;Pr(s),bs(s);for(var u=Pr(s);u;){var c=l,d=u;(u=/^id=(.*)$/.exec(d))?c.id=u[1]:(u=/^width=(\d{1,2}|100)%$/.exec(d))?c.width=Number(u[1]):(u=/^lines=(\d+)$/.exec(d))?(c.height=Number(u[1]),c.heightUnits=2):(u=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))?(c.regionAnchorX=Number(u[1]),c.regionAnchorY=Number(u[2])):(u=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))?(c.viewportAnchorX=Number(u[1]),c.viewportAnchorY=Number(u[2])):/^scroll=up$/.exec(d)&&(c.scroll="up"),bs(s),u=Pr(s)}t.push(l)}for(i=new Map,aw(i),s=[],n=x(n.slice(1)),l=n.next();!l.done;l=n.next()){if(l=l.value.split(`
`),(l.length!=1||l[0])&&!/^NOTE($|[ \t])/.test(l[0])&&l[0]=="STYLE"){for(c=[],u=-1,d=1;d<l.length;d++)l[d].includes("::cue")&&(c.push([]),u=c.length-1),u!=-1&&(c[u].push(l[d]),l[d].includes("}")&&(u=-1));for(c=x(c),u=c.next();!u.done;u=c.next()){var g=u.value;u="global",(d=g[0].match(/\((.*)\)/))&&(u=d.pop()),d=g.slice(1,-1),g[0].includes("}")&&(g=/\{(.*?)\}/.exec(g[0]))&&(d=g[1].split(";")),(g=i.get(u))||(g=new St(0,0,""));for(var y=!1,w=0;w<d.length;w++){var C=/^\s*([^:]+):\s*(.*)/.exec(d[w]);if(C){var T=C[2].trim().replace(";","");switch(C[1].trim()){case"background-color":case"background":y=!0,g.backgroundColor=T;break;case"color":y=!0,g.color=T;break;case"font-family":y=!0,g.fontFamily=T;break;case"font-size":y=!0,g.fontSize=T;break;case"font-weight":(700<=parseInt(T,10)||T=="bold")&&(y=!0,g.fontWeight=700);break;case"font-style":switch(T){case"normal":y=!0,g.fontStyle=hh;break;case"italic":y=!0,g.fontStyle="italic";break;case"oblique":y=!0,g.fontStyle="oblique"}break;case"opacity":y=!0,g.opacity=parseFloat(T);break;case"text-combine-upright":y=!0,g.textCombineUpright=T;break;case"text-shadow":y=!0,g.textShadow=T;break;case"white-space":y=!0,g.wrapLine=T!="noWrap"}}}y&&i.set(u,g)}}if(g=l,y=e,g.length==1&&!g[0]||/^NOTE($|[ \t])/.test(g[0])||g[0]=="STYLE"||g[0]=="REGION")l=null;else if(l=null,g[0].includes("-->")||(l=g[0],g.splice(0,1)),c=new Qo(g[0]),u=uc(c),w=Lo(c,/[ \t]+--\x3e[ \t]+/g),d=uc(c),u==null||w==null||d==null)Fe("Failed to parse VTT time code. Cue skipped:",l,g),l=null;else{for(u+=y,d+=y,g=g.slice(1).join(`
`).trim(),i.has("global")?(y=i.get("global").clone(),y.startTime=u,y.endTime=d,y.payload=""):y=new St(u,d,""),bs(c),u=Pr(c);u;)fw(y,u,t),bs(c),u=Pr(c);lw(g,y,i),l!=null&&(y.id=l),l=y}l&&s.push(l)}return s};function aw(e){for(var t=x(Object.entries(wg)),n=t.next();!n.done;n=t.next()){var i=x(n.value);n=i.next().value,i=i.next().value;var s=new St(0,0,"");s.color=i,e.set("."+n,s)}for(t=x(Object.entries(Sg)),n=t.next();!n.done;n=t.next())i=x(n.value),n=i.next().value,i=i.next().value,s=new St(0,0,""),s.backgroundColor=i,e.set("."+n,s)}function lw(e,t,n){if(e.includes("<")){n.size===0&&aw(n);var i=e;e=[];for(var s=-1,l=0;l<i.length;l++)i[l]==="<"?s=l+1:i[l]===">"&&0<s&&(s=i.substr(s,l-s),s.match(cw)&&e.push(s),s=-1);for(e=x(e),l=e.next();!l.done;l=e.next())l=l.value,i=i.replace("<"+l+">",'<div time="'+l+'">'),i+="</div>";e=i;e:{l=e,s=[];var u=-1;e="",i=!1;for(var c=0;c<l.length;c++)if(l[c]==="/"){var d=l.indexOf(">",c);if(d===-1){e=l;break e}if((d=l.substring(c+1,d))&&d=="v"){i=!0;var g=null;if(s.length&&(g=s[s.length-1]),g){if(g===d)e+="/"+d+">";else{if(!g.startsWith("v")){e+=l[c];continue}e+="/"+g+">"}c+=d.length+1}else e+=l[c]}else e+=l[c]}else l[c]==="<"?(u=c+1,l[u]!="v"&&(u=-1)):l[c]===">"&&0<u&&(s.push(l.substr(u,c-u)),u=-1),e+=l[c];for(l=x(s),s=l.next();!s.done;s=l.next())s=s.value,u=s.replace(" ",".voice-"),e=e.replace("<"+s+">","<"+u+">"),e=e.replace("</"+s+">","</"+u+">"),i||(e+="</"+u+">")}e=L3(e);try{var y=ls("<span>"+e+"</span>","span")}catch{}if(y)if(y=y.children,y.length!=1||y[0].tagName)for(y=x(y),e=y.next();!e.done;e=y.next())uw(e.value,t,n);else t.payload=$n(e);else t.payload=$n(e)}else t.payload=$n(e)}function L3(e){var t={"< ":""," >":" &gt;"},n=/(< +>|<\s|\s>)/g,i=RegExp(n.source);return e&&i.test(e)?e.replace(n,function(s){return t[s]||""}):e||""}function El(e,t){return e&&0<e.length?e:t}function uw(e,t,n){var i=t.clone();if(i.nestedCues=[],i.payload="",i.rubyTag="",i.line=null,i.region=new jn,i.position=null,i.size=0,e.tagName)for(var s=x(e.tagName.split(/(?=[ .])+/g)),l=s.next();!l.done;l=s.next()){var u=l=l.value;if(u.startsWith(".voice-")){var c=u.split("-").pop();u='v[voice="'+c+'"]',n.has(u)||(u="v[voice="+c+"]")}switch(n.has(u)&&(c=i,u=n.get(u))&&(c.backgroundColor=El(u.backgroundColor,c.backgroundColor),c.color=El(u.color,c.color),c.fontFamily=El(u.fontFamily,c.fontFamily),c.fontSize=El(u.fontSize,c.fontSize),c.textShadow=El(u.textShadow,c.textShadow),c.fontWeight=u.fontWeight,c.fontStyle=u.fontStyle,c.opacity=u.opacity,c.rubyTag=u.rubyTag,c.textCombineUpright=u.textCombineUpright,c.wrapLine=u.wrapLine),l){case"br":i=yr(i.startTime,i.endTime),t.nestedCues.push(i);return;case"b":i.fontWeight=700;break;case"i":i.fontStyle="italic";break;case"u":i.textDecoration.push("underline");break;case"font":(l=e.attributes.color)&&(i.color=l);break;case"div":if(l=e.attributes.time,!l)break;(l=uc(new Qo(l)))&&(i.startTime=l);break;case"ruby":case"rp":case"rt":i.rubyTag=l}}if(s=e.children,Eu(e)||s.length==1&&Eu(s[0]))for(n=un(e).split(`
`),e=!0,n=x(n),s=n.next();!s.done;s=n.next())s=s.value,e||(e=yr(i.startTime,i.endTime),t.nestedCues.push(e)),0<s.length&&(e=i.clone(),e.payload=$n(s),t.nestedCues.push(e)),e=!1;else for(t.nestedCues.push(i),t=x(s),e=t.next();!e.done;e=t.next())uw(e.value,i,n)}function fw(e,t,n){var i;(i=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=i[1],t=="middle"?e.textAlign=yo:e.textAlign=fh[t.toUpperCase()]):(i=/^vertical:(lr|rl)$/.exec(t))?e.writingMode=i[1]=="lr"?"vertical-lr":"vertical-rl":(i=/^size:([\d.]+)%$/.exec(t))?e.size=Number(i[1]):(i=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))?(e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign=t=="line-left"||t=="start"?"line-left":t=="line-right"||t=="end"?"line-right":t=="center"||t=="middle"?"center":Jl)):(i=/^region:(.*)$/.exec(t))?(t=P3(n,i[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=ch[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=eu,e.line=Number(n[1]),n[2]&&(e.lineAlign=ch[n[2].toUpperCase()]))}function P3(e,t){return e=e.filter(function(n){return n.id==t}),e.length?e[0]:null}function uc(e){if(e=Lo(e,cw),e==null)return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}he("shaka.text.VttTextParser",On),On.prototype.parseMedia=On.prototype.parseMedia,On.prototype.setManifestType=On.prototype.setManifestType,On.prototype.setSequenceMode=On.prototype.setSequenceMode,On.prototype.parseInit=On.prototype.parseInit;var cw=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;ln["text/vtt"]=function(){return new On},ln['text/vtt; codecs="vtt"']=function(){return new On},ln['text/vtt; codecs="wvtt"']=function(){return new On};function mi(){this.g=null}mi.prototype.parseInit=function(e){var t=this,n=!1;if(new Ot().box("moov",dt).box("trak",dt).box("mdia",dt).S("mdhd",function(i){i=_u(i.reader,i.version),t.g=i.timescale}).box("minf",dt).box("stbl",dt).S("stsd",Wo).box("wvtt",function(){n=!0}).parse(e),!this.g)throw new K(2,2,2008);if(!n)throw new K(2,2,2008)},mi.prototype.setSequenceMode=function(){},mi.prototype.setManifestType=function(){},mi.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.g)throw new K(2,2,2008);var n=0,i=[],s,l=[],u=!1,c=!1,d=!1,g=null;if(new Ot().box("moof",dt).box("traf",dt).S("tfdt",function(z){u=!0,n=Ru(z.reader,z.version).baseMediaDecodeTime}).S("tfhd",function(z){g=Ym(z.reader,z.flags).Yc}).S("trun",function(z){c=!0,i=Km(z.reader,z.version,z.flags).Wg}).box("mdat",ss(function(z){d=!0,s=z})).parse(e,!1),!d&&!u&&!c)throw new K(2,2,2008);e=n;for(var y=new Nt(s,0),w=x(i),C=w.next();!C.done;C=w.next()){C=C.value;var T=C.Jf||g,A=C.ne?n+C.ne:e;e=A+(T||0);var b=0;do{var k=y.P();b+=k;var O=y.P(),D=null;Tu(O)=="vttc"?8<k&&(D=y.qb(k-8)):y.skip(k-8),T&&D&&(k=D3(D,t.periodStart+A/this.g,t.periodStart+e/this.g),l.push(k))}while(C.sampleSize&&b<C.sampleSize)}return l.filter(Ar)};function D3(e,t,n){var i,s,l;return new Ot().box("payl",ss(function(u){i=Vt(u)})).box("iden",ss(function(u){s=Vt(u)})).box("sttg",ss(function(u){l=Vt(u)})).parse(e),i?N3(i,s,l,t,n):null}function N3(e,t,n,i,s){if(i=new St(i,s,""),lw(e,i,new Map),t&&(i.id=t),n)for(e=new Qo(n),t=Pr(e);t;)fw(i,t,[]),bs(e),t=Pr(e);return i}he("shaka.text.Mp4VttParser",mi),mi.prototype.parseMedia=mi.prototype.parseMedia,mi.prototype.setManifestType=mi.prototype.setManifestType,mi.prototype.setSequenceMode=mi.prototype.setSequenceMode,mi.prototype.parseInit=mi.prototype.parseInit,ln['application/mp4; codecs="wvtt"']=function(){return new mi};function yi(){}yi.prototype.parseInit=function(){},yi.prototype.setSequenceMode=function(){},yi.prototype.setManifestType=function(){},yi.prototype.parseMedia=function(e){var t=Vt(e).replace(/\r+/g,"");if(t=t.trim(),e=[],t=="")return e;t=x(t.split(`

`));for(var n=t.next();!n.done;n=t.next()){n=n.value.split(`
`);var i=new Qo(n[0]),s=hw(i),l=Lo(i,/,/g);if(i=hw(i),s==null||l==null||i==null)throw new K(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new St(s,i,n.slice(1).join(`
`).trim()))}return e};function hw(e){if(e=Lo(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g),e==null)return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}he("shaka.text.SbvTextParser",yi),yi.prototype.parseMedia=yi.prototype.parseMedia,yi.prototype.setManifestType=yi.prototype.setManifestType,yi.prototype.setSequenceMode=yi.prototype.setSequenceMode,yi.prototype.parseInit=yi.prototype.parseInit,ln["text/x-subviewer"]=function(){return new yi};function oi(){this.g=new On}oi.prototype.parseInit=function(){},oi.prototype.setSequenceMode=function(){},oi.prototype.setManifestType=function(){},oi.prototype.parseMedia=function(e,t,n){return e=Vt(e),e=dw(e),e=Ze(qi(e)),this.g.parseMedia(e,t,n)};function dw(e){var t=`WEBVTT

`;if(e=="")return t;e=e.replace(/\r+/g,""),e=e.trim(),e=x(e.split(`

`));for(var n=e.next();!n.done;n=e.next())n=n.value.split(/\n/),n[0].match(/\d+/)&&n.shift(),n[0]=n[0].replace(/,/g,"."),t+=n.join(`
`).replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+`

`;return t}he("shaka.text.SrtTextParser",oi),oi.srt2webvtt=dw,oi.prototype.parseMedia=oi.prototype.parseMedia,oi.prototype.setManifestType=oi.prototype.setManifestType,oi.prototype.setSequenceMode=oi.prototype.setSequenceMode,oi.prototype.parseInit=oi.prototype.parseInit,ln["text/srt"]=function(){return new oi};function vi(){}vi.prototype.parseInit=function(){},vi.prototype.setSequenceMode=function(){},vi.prototype.setManifestType=function(){},vi.prototype.parseMedia=function(e){var t="",n="",i=null,s=null;for(s=Vt(e).split(/\r?\n\s*\r?\n/),e=x(s),s=e.next();!s.done;s=e.next()){var l=s.value;s=l,(l=U3.exec(l))&&(i=l[1],s=l[2]),i=="V4 Styles"||i=="V4+ Styles"?(t=s,t=n?t+(`
`+s):s):i=="Events"&&(n=n?n+(`
`+s):s)}for(i=[],s=null,t=x(t.split(/\r?\n/)),e=t.next();!e.done;e=t.next())if(e=e.value,!/^\s*;/.test(e)&&(l=mw.exec(e))){if(e=l[1].trim(),l=l[2].trim(),e=="Format")s=l.split(fc);else if(e=="Style"){e=l.split(fc),l={};for(var u=0;u<s.length&&u<e.length;u++)l[s[u]]=e[u];i.push(l)}}for(s=[],t=null,n=x(n.split(/\r?\n/)),l=n.next(),e={};!l.done;e={jh:void 0},l=n.next())if(l=l.value,!/^\s*;/.test(l)&&(u=mw.exec(l))){if(l=u[1].trim(),u=u[2].trim(),l=="Format")t=u.split(fc);else if(l=="Dialogue"){u=u.split(fc),l={};for(var c=0;c<t.length&&c<u.length;c++)l[t[c]]=u[c];c=gw(l.Start);var d=gw(l.End);u=new St(c,d,u.slice(t.length-1).join(",").replace(/\\N/g,`
`).replace(/\{[^}]+\}/g,"")),e.jh=l.Style,(e=i.find(function(g){return function(y){return y.Name==g.jh}}(e)))&&O3(u,e),s.push(u)}}return s};function O3(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=pw(n))&&(e.color=n),(n=t.BackColour)&&(n=pw(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=700),t.Italic&&(e.fontStyle="italic"),t.Underline&&e.textDecoration.push("underline"),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=pa,e.textAlign="start";break;case 2:e.displayAlign=pa,e.textAlign=yo;break;case 3:e.displayAlign=pa,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=yo;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=yo;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function pw(e){return e=parseInt(e.replace("&H",""),16),0<=e?"rgba("+(e&255)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function gw(e){return e=B3.exec(e),3600*(e[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}he("shaka.text.SsaTextParser",vi),vi.prototype.parseMedia=vi.prototype.parseMedia,vi.prototype.setManifestType=vi.prototype.setManifestType,vi.prototype.setSequenceMode=vi.prototype.setSequenceMode,vi.prototype.parseInit=vi.prototype.parseInit;var U3=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,mw=/^\s*([^:]+):\s*(.*)/,fc=/\s*,\s*/,B3=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;ln["text/x-ssa"]=function(){return new vi};function yw(e,t){var n=e[t+1]&1?7:9;return t+n<=e.length&&(e=((e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5)-n,0<e)?{Qd:n,ca:e}:null}function vw(e,t){var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=(e[t+2]&60)>>>2;if(i>n.length-1)return null;var s=((e[t+2]&192)>>>6)+1,l=(e[t+2]&1)<<2;return l|=(e[t+3]&192)>>>6,{sampleRate:n[i],channelCount:l,codec:"mp4a.40."+s}}function xw(e,t){if(t+1<e.length&&e[t]===255&&(e[t+1]&246)===240){var n=e[t+1]&1?7:9;if(t+n>=e.length)return!1;var i=(e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5;return i<=n?!1:(t+=i,t===e.length||t+1<e.length&&e[t]===255&&(e[t+1]&246)===240)}return!1}function j3(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2||t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}function xi(e){this.i=e,this.h=0,this.g=new Map}a=xi.prototype,a.destroy=function(){this.g.clear()},a.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/aac"?Lt(this.convertCodecs("audio",e)):!1},a.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/aac"?'audio/mp4; codecs="'+(di(t)||"mp4a.40.2")+'"':t},a.getOriginalMimeType=function(){return this.i},a.transmux=function(e,t,n,i){for(var s=Ze(e),l=us(s),u=l.length;u<s.length&&!xw(s,u);u++);if(e=1e3*n.endTime,l=Mr(l),l.length&&n&&(l=l.find(function(y){return y.description==="com.apple.streaming.transportStreamTimestamp"}))&&(e=l.data),l=vw(s,u),!l)return Promise.reject(new K(2,3,3018,n?n.M()[0]:null));t.audioSamplingRate=l.sampleRate,t.channelsCount=l.channelCount;for(var c=[];u<s.length;){var d=yw(s,u);if(!d)return Promise.reject(new K(2,3,3018,n?n.M()[0]:null));var g=d.Qd+d.ca;u+g<=s.length&&c.push({data:s.subarray(u+d.Qd,u+g),size:d.ca,duration:1024,cb:0,flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:2,hb:0}}),u+=g}return s=l.sampleRate,e=Math.floor(e*s/1e3),i={id:t.id,type:"audio",codecs:l.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:s,duration:i,$a:[],ma:new Uint8Array([]),wa:new Uint8Array([]),Ba:0,Ca:0,data:{rb:this.h,baseMediaDecodeTime:e,Ya:c},stream:t},i=new js([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Fs(i),this.g.set(n,t)),n=gl(i),this.h++,t=Qt(t,n),Promise.resolve(t)},he("shaka.transmuxer.AacTransmuxer",xi),xi.prototype.transmux=xi.prototype.transmux,xi.prototype.getOriginalMimeType=xi.prototype.getOriginalMimeType,xi.prototype.convertCodecs=xi.prototype.convertCodecs,xi.prototype.isSupported=xi.prototype.isSupported,xi.prototype.destroy=xi.prototype.destroy,vo("audio/aac",function(){return new xi("audio/aac")},Go);function ww(e,t){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return null;var n=e[t+4]>>6;if(3<=n)return null;var i=e[t+4]&63,s=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*i+n];if(t+s>e.length)return null;var l=e[t+6]>>5,u=0;l===2?u+=2:(l&1&&l!==1&&(u+=2),l&4&&(u+=2)),u=(e[t+6]<<8|e[t+7])>>12-u&1;var c=e[t+5]&7;return e=new Uint8Array([n<<6|e[t+5]>>3<<1|c>>2,(c&3)<<6|l<<3|u<<2|i>>4,i<<4&224]),{sampleRate:[48e3,44100,32e3][n],channelCount:[2,1,2,3,3,4,4,5][l]+u,ma:e,ca:s}}function F3(e,t){if(e[t]===11&&e[t+1]===119){var n=0,i=5;t+=i;for(var s,l;0<i;){l=e[t];var u=Math.min(i,8),c=8-u;s=4278190080>>>24+c<<c,s=(l&s)>>c,n=n?n<<u|s:s,t+=1,i-=u}if(16>n)return!0}return!1}function Ii(e){this.i=e,this.h=0,this.g=new Map}a=Ii.prototype,a.destroy=function(){this.g.clear()},a.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/ac3"?Lt(this.convertCodecs("audio",e)):!1},a.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/ac3"?'audio/mp4; codecs="ac-3"':t},a.getOriginalMimeType=function(){return this.i},a.transmux=function(e,t,n,i){e=Ze(e);for(var s=us(e),l=s.length;l<e.length&&!F3(e,l);l++);var u=1e3*n.endTime;s=Mr(s),s.length&&n&&(s=s.find(function(y){return y.description==="com.apple.streaming.transportStreamTimestamp"}))&&(u=s.data),s=0;for(var c=new Uint8Array([]),d=[];l<e.length;){var g=ww(e,l);if(!g)return Promise.reject(new K(2,3,3018,n?n.M()[0]:null));t.audioSamplingRate=g.sampleRate,t.channelsCount=g.channelCount,s=g.sampleRate,c=g.ma,d.push({data:e.subarray(l,l+g.ca),size:g.ca,duration:1536,cb:0,flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:2,hb:0}}),l+=g.ca}return e=Math.floor(u*s/1e3),i={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:s,duration:i,$a:[],ma:c,wa:new Uint8Array([]),Ba:0,Ca:0,data:{rb:this.h,baseMediaDecodeTime:e,Ya:d},stream:t},i=new js([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Fs(i),this.g.set(n,t)),n=gl(i),this.h++,t=Qt(t,n),Promise.resolve(t)},he("shaka.transmuxer.Ac3Transmuxer",Ii),Ii.prototype.transmux=Ii.prototype.transmux,Ii.prototype.getOriginalMimeType=Ii.prototype.getOriginalMimeType,Ii.prototype.convertCodecs=Ii.prototype.convertCodecs,Ii.prototype.isSupported=Ii.prototype.isSupported,Ii.prototype.destroy=Ii.prototype.destroy,vo("audio/ac3",function(){return new Ii("audio/ac3")},Go);function Sw(e,t){if(t+8>e.length||(e[t]<<8|e[t+1]<<0)!==2935)return null;var n=new Io(e.subarray(t+2));Qn(n,2),Qn(n,3);var i=ht(n,11)+1<<1,s=ht(n,2);if(s==3){s=ht(n,2),s=[24e3,22060,16e3][s];var l=3}else s=[48e3,44100,32e3][s],l=ht(n,2);var u=ht(n,3),c=ht(n,1);return n=ht(n,5),t+i>e.byteLength?null:(e=Math.floor(i*s/(16*[1,2,3,6][l])),e=new Uint8Array([(e&8160)>>5,(e&31)<<3,s<<6|n<<1|0,0|u<<1|c<<0,0]),{sampleRate:s,channelCount:[2,1,2,3,3,4,4,5][u]+c,ma:e,ca:i})}function Mi(e){this.i=e,this.h=0,this.g=new Map}a=Mi.prototype,a.destroy=function(){this.g.clear()},a.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/ec3"?Lt(this.convertCodecs("audio",e)):!1},a.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/ec3"?'audio/mp4; codecs="ec-3"':t},a.getOriginalMimeType=function(){return this.i},a.transmux=function(e,t,n,i){e=Ze(e);for(var s=us(e),l=s.length;l<e.length&&(e[l]<<8|e[l+1]<<0)!==2935;l++);var u=1e3*n.endTime;s=Mr(s),s.length&&n&&(s=s.find(function(y){return y.description==="com.apple.streaming.transportStreamTimestamp"}))&&(u=s.data),s=0;for(var c=new Uint8Array([]),d=[];l<e.length;){var g=Sw(e,l);if(!g)return Promise.reject(new K(2,3,3018,n?n.M()[0]:null));t.audioSamplingRate=g.sampleRate,t.channelsCount=g.channelCount,s=g.sampleRate,c=g.ma,d.push({data:e.subarray(l,l+g.ca),size:g.ca,duration:1536,cb:0,flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:2,hb:0}}),l+=g.ca}return e=Math.floor(u*s/1e3),i={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:s,duration:i,$a:[],ma:c,wa:new Uint8Array([]),Ba:0,Ca:0,data:{rb:this.h,baseMediaDecodeTime:e,Ya:d},stream:t},i=new js([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Fs(i),this.g.set(n,t)),n=gl(i),this.h++,t=Qt(t,n),Promise.resolve(t)},he("shaka.transmuxer.Ec3Transmuxer",Mi),Mi.prototype.transmux=Mi.prototype.transmux,Mi.prototype.getOriginalMimeType=Mi.prototype.getOriginalMimeType,Mi.prototype.convertCodecs=Mi.prototype.convertCodecs,Mi.prototype.isSupported=Mi.prototype.isSupported,Mi.prototype.destroy=Mi.prototype.destroy,vo("audio/ec3",function(){return new Mi("audio/ec3")},Go);function $3(e){if(!e.length)return null;var t=e.find(function(b){return b.type==7});if(e=e.find(function(b){return b.type==8}),!t||!e)return null;var n=new Io(t.data),i=Tt(n);if(Tt(n),Tt(n),Hn(n),H3.includes(i)&&(i=$e(n),i===3&&Qn(n,1),Hn(n),Hn(n),Qn(n,1),Ye(n))){i=i!==3?8:12;for(var s=0;s<i;s++)Ye(n)&&(6>s?Lu(n,16):Lu(n,64))}if(Hn(n),i=$e(n),i===0)$e(n);else if(i===1)for(Qn(n,1),Hn(n),Hn(n),i=$e(n),s=0;s<i;s++)Hn(n);Hn(n),Qn(n,1);var l=$e(n),u=$e(n),c=ht(n,1);c===0&&Qn(n,1),Qn(n,1);var d=0,g=0,y=0,w=0;if(Ye(n)&&(d=$e(n),g=$e(n),y=$e(n),w=$e(n)),s=i=1,Ye(n)&&Ye(n)){var C=Tt(n),T=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],A=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<C&&16>=C?(i=T[C-1],s=A[C-1]):C===255&&(i=ht(n,16),s=ht(n,16))}return n=(2-c)*(u+1)*16-2*y-2*w,l=16*(l+1)-2*d-2*g,d=[],t=t.fullData,d.push(t.byteLength>>>8&255),d.push(t.byteLength&255),d=d.concat.apply(d,L(t)),t=[],e=e.fullData,t.push(e.byteLength>>>8&255),t.push(e.byteLength&255),t=t.concat.apply(t,L(e)),e=new Uint8Array([1,d[3],d[4],d[5],255,225].concat(d,[1],t)),{height:n,width:l,wa:e,Ba:i,Ca:s}}function V3(e){var t=!1,n=[],i=e.find(function(d){return d.type==7}),s=!1;e=x(e);for(var l=e.next();!l.done;l=e.next()){l=l.value;var u=!1;switch(l.type){case 1:u=s=!0;var c=l.data;i&&4<c.length&&(c=LC(new Io(c)),c===2||c===4||c===7||c===9)&&(t=!0);break;case 5:t=u=s=!0;break;case 6:u=!0;break;case 7:u=!0;break;case 8:u=!0;break;case 9:s=u=!0;break;case 12:u=!0;break;default:u=!1}s&&u&&(u=l.fullData.byteLength,c=new Uint8Array(4),c[0]=u>>24&255,c[1]=u>>16&255,c[2]=u>>8&255,c[3]=u&255,n.push(c),n.push(l.fullData))}return n.length?{data:Qt.apply(_n,L(n)),kd:t}:null}var H3=[100,110,122,244,44,83,86,118,128,138,139,134];function z3(e){if(!e.length)return null;var t=e.find(function(u){return u.type==32}),n=e.find(function(u){return u.type==33}),i=e.find(function(u){return u.type==34});if(!t||!n||!i)return null;var s=G3(t.fullData);e=X3(n.fullData);var l=W3(i.fullData);return t=q3(t.fullData,n.fullData,i.fullData,{yf:s.yf,Wf:s.Wf,df:e.df,ef:e.ef,Ye:e.Ye,cf:e.cf,Ze:e.Ze,$e:e.$e,af:e.af,bf:e.bf,Se:e.Se,Te:e.Te,Ue:e.Ue,Ve:e.Ve,We:e.We,Xe:e.Xe,Le:e.Le,$d:e.$d,Je:e.Je,He:e.He,Ge:e.Ge,Bf:l.Bf}),{height:e.height,width:e.width,wa:t,Ba:e.Ri,Ca:e.Qi}}function G3(e){var t=new Io(e,!0);return Tt(t),Tt(t),ht(t,4),ht(t,2),ht(t,6),e=ht(t,3),t=Ye(t),{yf:e+1,Wf:t}}function X3(e){e=new Io(e,!0),Tt(e),Tt(e);var t=0,n=0,i=0,s=0;ht(e,4);var l=ht(e,3);Ye(e);for(var u=ht(e,2),c=ht(e,1),d=ht(e,5),g=Tt(e),y=Tt(e),w=Tt(e),C=Tt(e),T=Tt(e),A=Tt(e),b=Tt(e),k=Tt(e),O=Tt(e),D=Tt(e),z=Tt(e),P=[],B=[],G=0;G<l;G++)P.push(Ye(e)),B.push(Ye(e));if(0<l)for(G=l;8>G;G++)ht(e,2);for(G=0;G<l;G++)P[G]&&ht(e,88),B[G]&&Tt(e);$e(e),P=$e(e),P==3&&ht(e,1),B=$e(e),G=$e(e),Ye(e)&&(t+=$e(e),n+=$e(e),i+=$e(e),s+=$e(e));var q=$e(e),J=$e(e),fe=$e(e);if(Ye(e))for(var te=0;te<=l;te++)$e(e),$e(e),$e(e);else $e(e),$e(e),$e(e);if($e(e),$e(e),$e(e),$e(e),$e(e),$e(e),Ye(e)&&Ye(e))for(te=0;4>te;te++)for(var ne=0;ne<(te===3?2:6);ne++)if(Ye(e)){var oe=Math.min(64,1<<4+(te<<1));1<te&&fs(e);for(var xe=0;xe<oe;xe++)fs(e)}else $e(e);for(Ye(e),Ye(e),Ye(e)&&(Tt(e),$e(e),$e(e),Ye(e)),te=$e(e),oe=ne=0;oe<te;oe++)if(xe=!1,oe!==0&&(xe=Ye(e)),xe){oe===te&&$e(e),Ye(e),$e(e);for(var pe=xe=0;pe<=ne;pe++){var we=Ye(e),Me=!1;we||(Me=Ye(e)),(we||Me)&&xe++}ne=xe}else{for(pe=$e(e),xe=$e(e),ne=pe+xe,we=0;we<pe;we++)$e(e),Ye(e);for(pe=0;pe<xe;pe++)$e(e),Ye(e)}if(Ye(e))for(te=$e(e),ne=0;ne<te;ne++){for(oe=0;oe<fe+4;oe++)ht(e,1);ht(e,1)}if(te=fe=1,ne=0,Ye(e),Ye(e),Ye(e)){if(Ye(e)&&(oe=Tt(e),xe=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],pe=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1],0<oe&&16>=oe?(fe=xe[oe-1],te=pe[oe-1]):oe===255&&(fe=ht(e,16),te=ht(e,16))),Ye(e)&&Ye(e),Ye(e)&&(ht(e,3),Ye(e),Ye(e)&&(Tt(e),Tt(e),Tt(e))),Ye(e)&&($e(e),$e(e)),Ye(e),Ye(e),Ye(e),(oe=Ye(e))&&($e(e),$e(e),$e(e),$e(e)),Ye(e)&&(ht(e,32),ht(e,32),Ye(e)&&$e(e),Ye(e)))for(pe=!1,oe=Ye(e),xe=Ye(e),(oe||xe)&&((pe=Ye(e))&&(Tt(e),ht(e,5),Ye(e),ht(e,5)),ht(e,4),ht(e,4),pe&&ht(e,4),ht(e,5),ht(e,5),ht(e,5)),we=0;we<=l;we++){var Te=!0;Me=1,Ye(e)||(Te=Ye(e));var Ne=!1;if(Te?$e(e):Ne=Ye(e),Ne||(Me=$e(e)+1),oe){for(Te=0;Te<Me;Te++)$e(e),$e(e),pe&&($e(e),$e(e));Ye(e)}if(xe){for(Te=0;Te<Me;Te++)$e(e),$e(e),pe&&($e(e),$e(e));Ye(e)}}Ye(e)&&(Ye(e),Ye(e),Ye(e),ne=$e(e),$e(e),$e(e),$e(e),$e(e))}return{Ye:z,df:u,ef:c,cf:d,Ze:g,$e:y,af:w,bf:C,Se:T,Te:A,Ue:b,Ve:k,We:O,Xe:D,$d:ne,Le:0,Je:P,He:q,Ge:J,width:B-(t+n)*(P===1||P===2?2:1),height:G-(i+s)*(P===1?2:1),Ri:fe,Qi:te}}function W3(e){var t=new Io(e,!0);Tt(t),Tt(t),$e(t),$e(t),Ye(t),Ye(t),ht(t,3),Ye(t),Ye(t),$e(t),$e(t),fs(t),Ye(t),Ye(t),Ye(t)&&$e(t),fs(t),fs(t),Ye(t),Ye(t),Ye(t),Ye(t),e=Ye(t),t=Ye(t);var n=1;return t&&e?n=0:t?n=3:e&&(n=2),{Bf:n}}function q3(e,t,n,i){var s=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength));return s[0]=1,s[1]=(i.df&3)<<6|(i.ef?1:0)<<5|i.cf&31,s[2]=i.Ze,s[3]=i.$e,s[4]=i.af,s[5]=i.bf,s[6]=i.Se,s[7]=i.Te,s[8]=i.Ue,s[9]=i.Ve,s[10]=i.We,s[11]=i.Xe,s[12]=i.Ye,s[13]=240|(i.$d&3840)>>8,s[14]=i.$d&255,s[15]=252|i.Bf&3,s[16]=252|i.Je&3,s[17]=248|i.He&7,s[18]=248|i.Ge&7,s[19]=0,s[20]=0,s[21]=(i.Le&3)<<6|(i.yf&7)<<3|(i.Wf?1:0)<<2|3,s[22]=3,s[23]=160,s[24]=0,s[25]=1,s[26]=(e.byteLength&65280)>>8,s[27]=(e.byteLength&255)>>0,s.set(e,28),s[23+(5+e.byteLength)]=161,s[e.byteLength+29]=0,s[e.byteLength+30]=1,s[e.byteLength+31]=(t.byteLength&65280)>>8,s[e.byteLength+32]=(t.byteLength&255)>>0,s.set(t,e.byteLength+33),s[23+(e.byteLength+10+t.byteLength)]=162,s[e.byteLength+10+t.byteLength+24]=0,s[e.byteLength+10+t.byteLength+25]=1,s[e.byteLength+10+t.byteLength+26]=(n.byteLength&65280)>>8,s[e.byteLength+10+t.byteLength+27]=(n.byteLength&255)>>0,s.set(n,e.byteLength+10+t.byteLength+28),s}function cc(e,t){var n=e[t+1]>>3&3,i=e[t+1]>>1&3,s=e[t+2]>>4&15,l=e[t+2]>>2&3;if(n!==1&&s!==0&&s!==15&&l!==3){var u=e[t+3]>>6;s=1e3*Y3[14*(n===3?3-i:i===3?3:4)+s-1],l=K3[3*(n===3?0:n===2?1:2)+l],n=Z3[n][i];var c=Q3[i],d=Math.floor(n*s/l+(e[t+2]>>1&1))*c,g=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(g=g?parseInt(g[1],10):0)&&87>=g&&i===2&&224e3<=s&&u===0&&(e[t+3]|=128),{sampleRate:l,channelCount:u===3?1:2,ca:d,Pi:8*n*c}}return null}function Tw(e,t){return e[t]===255&&(e[t+1]&224)===224&&(e[t+1]&6)!==0}function Cw(e,t){if(t+1<e.length&&Tw(e,t)){var n=cc(e,t),i=4;return n&&n.ca&&(i=n.ca),t+=i,t===e.length||t+1<e.length&&Tw(e,t)}return!1}var Y3=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],K3=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Z3=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Q3=[0,1,1,4];function Ri(e){this.i=e,this.h=0,this.g=new Map}a=Ri.prototype,a.destroy=function(){this.g.clear()},a.isSupported=function(e){return e.toLowerCase().split(";")[0]=="audio/mpeg"?Lt(this.convertCodecs("audio",e)):!1},a.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="audio/mpeg"?'audio/mp4; codecs="mp3"':t},a.getOriginalMimeType=function(){return this.i},a.transmux=function(e,t,n,i){for(var s=Ze(e),l=us(s).length;l<s.length&&!Cw(s,l);l++);var u;for(e=[];l<s.length;){var c=cc(s,l);if(!c)return Promise.reject(new K(2,3,3018,n?n.M()[0]:null));u||(u=c),l+c.ca<=s.length&&e.push({data:s.subarray(l,l+c.ca),size:c.ca,duration:1152,cb:0,flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:2,hb:0}}),l+=c.ca}return u?(s=9e4*u.Pi/u.sampleRate*this.h,i={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:u.sampleRate,duration:i,$a:[],ma:new Uint8Array([]),wa:new Uint8Array([]),Ba:0,Ca:0,data:{rb:this.h,baseMediaDecodeTime:s,Ya:e},stream:t},i=new js([i]),n=t.id+"_"+n.i,this.g.has(n)?t=this.g.get(n):(t=Fs(i),this.g.set(n,t)),n=gl(i),this.h++,t=Qt(t,n),Promise.resolve(t)):Promise.reject(new K(2,3,3018,n?n.M()[0]:null))},he("shaka.transmuxer.Mp3Transmuxer",Ri),Ri.prototype.transmux=Ri.prototype.transmux,Ri.prototype.getOriginalMimeType=Ri.prototype.getOriginalMimeType,Ri.prototype.convertCodecs=Ri.prototype.convertCodecs,Ri.prototype.isSupported=Ri.prototype.isSupported,Ri.prototype.destroy=Ri.prototype.destroy,vo("audio/mpeg",function(){return new Ri("audio/mpeg")},Go);function _i(e){this.h=e,this.g=null}a=_i.prototype,a.destroy=function(){},a.isSupported=function(e){if(e.toLowerCase().split(";")[0]!="video/mp2t")return!1;var t=di(e).split(","),n=qn("audio",t);return t=qn("video",t),!n||t||Vn(n)!="mp3"?!1:Lt(this.convertCodecs("audio",e))},a.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="video/mp2t"?"audio/mpeg":t},a.getOriginalMimeType=function(){return this.h},a.transmux=function(e,t,n,i,s){if(this.g?this.g.clearData():this.g=new jt,e=Ze(e),e=this.g.parse(e),e.$c().audio!="mp3"||s!="audio")return Promise.reject(new K(2,3,3018,n?n.M()[0]:null));for(n=new Uint8Array([]),s=x(e.Tb()),e=s.next();!e.done;e=s.next())if(e=e.value.data)for(t=0;t<e.length;)(i=cc(e,t))?(t+i.ca<=e.length&&(n=Qt(n,e.subarray(t,t+i.ca))),t+=i.ca):t++;return Promise.resolve(n)},he("shaka.transmuxer.MpegTsTransmuxer",_i),_i.prototype.transmux=_i.prototype.transmux,_i.prototype.getOriginalMimeType=_i.prototype.getOriginalMimeType,_i.prototype.convertCodecs=_i.prototype.convertCodecs,_i.prototype.isSupported=_i.prototype.isSupported,_i.prototype.destroy=_i.prototype.destroy,vo("video/mp2t",function(){return new _i("video/mp2t")},ph);/*
 @license
 MSS Transmuxer
 Copyright 2015 Dash Industry Forum
 SPDX-License-Identifier: BSD-3-Clause
*/function wi(e){this.h=e,(this.g=yp.get("ISOBoxer")())&&J3(this)}function J3(e){function t(){this._procFullBox(),this.flags&1&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,function(n){this._procEntryField(n,"InitializationVector","data",8),this.flags&2&&(this._procEntryField(n,"NumberOfEntries","uint",16),this._procSubEntries(n,"clearAndCryptedData",n.NumberOfEntries,function(i){this._procEntryField(i,"BytesOfClearData","uint",16),this._procEntryField(i,"BytesOfEncryptedData","uint",32)}))})}e.g.addBoxProcessor("saio",function(){this._procFullBox(),this.flags&1&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",this.version===1?64:32)}),e.g.addBoxProcessor("saiz",function(){this._procFullBox(),this.flags&1&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),this.default_sample_info_size===0&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}),e.g.addBoxProcessor("senc",t),e.g.addBoxProcessor("uuid",function(){for(var n=!0,i=0;16>i;i++)this.usertype[i]!==eI[i]&&(n=!1);n&&(this._parsing&&(this.type="sepiff"),t.call(this))})}a=wi.prototype,a.destroy=function(){},a.isSupported=function(e,t){var n=e.startsWith("mss/");return!this.g||!n?!1:t?Lt(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),Lt(t)||Lt(e))},a.convertCodecs=function(e,t){return t.replace("mss/","")},a.getOriginalMimeType=function(){return this.h},a.transmux=function(e,t,n){if(!n)return Promise.resolve(Ze(e));if(!t.mssPrivateData)return Promise.reject(new K(2,3,3020,n?n.M()[0]:null));try{var i,s=this.g.parseBuffer(e),l=s.fetch("tfhd");l.track_ID=t.id+1;var u=s.fetch("tfdt"),c=s.fetch("traf");u===null&&(u=this.g.createFullBox("tfdt",c,l),u.version=1,u.flags=0,u.baseMediaDecodeTime=Math.floor(n.startTime*t.mssPrivateData.timescale));var d=s.fetch("trun"),g=s.fetch("tfxd");g&&g._parent.boxes.splice(g._parent.boxes.indexOf(g),1);var y=s.fetch("tfrf");y&&y._parent.boxes.splice(y._parent.boxes.indexOf(y),1);var w=s.fetch("sepiff");if(w!==null){w.type="senc",w.usertype=void 0;var C=s.fetch("saio");if(C===null){C=this.g.createFullBox("saio",c),C.version=0,C.flags=0,C.entry_count=1,C.offset=[0];var T=this.g.createFullBox("saiz",c);if(T.version=0,T.flags=0,T.sample_count=w.sample_count,T.default_sample_info_size=0,T.sample_info_size=[],w.flags&2)for(i=0;i<w.sample_count;i+=1)T.sample_info_size[i]=10+6*w.entry[i].NumberOfEntries;else T.default_sample_info_size=8}}l.flags&=16777214,l.flags|=131072,d.flags|=1;var A=s.fetch("moof");d.data_offset=A.getLength()+8;var b=s.fetch("saio");b!==null&&(b.offset[0]=Ew(A,"traf")+Ew(c,"senc")+16);var k=Ze(s.write());return Promise.resolve(k)}catch(O){return O instanceof K?Promise.reject(O):Promise.reject(new K(2,3,3022,n?n.M()[0]:null))}};function Ew(e,t){for(var n=8,i=0;i<e.boxes.length&&e.boxes[i].type!==t;i++)n+=e.boxes[i].size;return n}he("shaka.transmuxer.MssTransmuxer",wi),wi.prototype.transmux=wi.prototype.transmux,wi.prototype.getOriginalMimeType=wi.prototype.getOriginalMimeType,wi.prototype.convertCodecs=wi.prototype.convertCodecs,wi.prototype.isSupported=wi.prototype.isSupported,wi.prototype.destroy=wi.prototype.destroy;var eI=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);vo("mss/audio/mp4",function(){return new wi("mss/audio/mp4")},Go),vo("mss/video/mp4",function(){return new wi("mss/video/mp4")},Go);function Li(e){this.l=e,this.g=0,this.i=new Map,this.h=this.j=null}a=Li.prototype,a.destroy=function(){this.i.clear(),this.h&&this.h.destroy()},a.isSupported=function(e,t){if(e.toLowerCase().split(";")[0]!="video/mp2t")return!1;var n=e;t&&(n=this.convertCodecs(t,e));var i=di(n).split(",");return n=qn("audio",i),i=qn("video",i),n&&(n=Vn(n),!tI.includes(n))||i&&(n=Vn(i),!nI.includes(n))?!1:t?Lt(this.convertCodecs(t,e)):(t=this.convertCodecs("audio",e),e=this.convertCodecs("video",e),Lt(t)||Lt(e))},a.convertCodecs=function(e,t){return t.toLowerCase().split(";")[0]=="video/mp2t"?(t=di(t).replace("mp4a.40.34","mp3").split(",").map(function(n){return Jr(n,"audio/mp4")}).map(ka).join(","),e=="audio"?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'):t},a.getOriginalMimeType=function(){return this.l},a.transmux=function(e,t,n,i,s){var l=Ze(e);if(s=="audio"&&!Oa(l)){for(var u=us(l),c=u.length;c<l.length;c++)if(Cw(l,c))return Promise.reject(new K(2,3,3018,n?n.M()[0]:null));for(c=u.length;c<l.length;c++)if(xw(l,c))return this.h||(this.h=new xi("audio/aac")),this.h.transmux(e,t,n,i,s);return Promise.reject(new K(2,3,3018,n?n.M()[0]:null))}this.j?this.j.clearData():this.j=new jt;var d=this.j.parse(l),g=[],y=d.$c();try{var w=null;if(s=="video"){switch(y.video){case"avc":var C=[],T=null,A=[],b=d.Fc();if(!b.length)throw new K(2,3,3023,n?n.M()[0]:null);for(var k=0;k<b.length;k++){var O=b[k],D=O.nalus;A.push.apply(A,L(D));var z=V3(D);if(z){T==null&&(T=O.dts);var P=void 0;P=k+1<b.length?(b[k+1].dts||0)-(O.dts||0):1<b.length?(O.dts||0)-(b[k-1].dts||0):9e4*(n.endTime-n.startTime),C.push({data:z.data,size:z.data.byteLength,duration:P,cb:Math.round((O.pts||0)-(O.dts||0)),flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:z.kd?2:1,hb:z.kd?0:1}})}}var B=$3(A);if(!B||T==null)throw new K(2,3,3018,n?n.M()[0]:null);t.height=B.height,t.width=B.width,w={id:t.id,type:"video",codecs:"avc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,$a:[],ma:new Uint8Array([]),wa:B.wa,Ba:B.Ba,Ca:B.Ca,data:{rb:this.g,baseMediaDecodeTime:T,Ya:C},stream:t};break;case"hvc":var G=[],q=null,J=[],fe=d.Fc();if(!fe.length)throw new K(2,3,3023,n?n.M()[0]:null);for(var te=0;te<fe.length;te++){var ne=fe[te],oe=ne.nalus;J.push.apply(J,L(oe));for(var xe=!1,pe=[],we=!1,Me=x(oe),Te=Me.next();!Te.done;Te=Me.next()){var Ne=Te.value;switch(Ne.type){case 1:case 0:var rt=we=!0;break;case 19:case 20:case 21:xe=rt=we=!0;break;case 32:rt=!0;break;case 33:rt=!0;break;case 34:rt=!0;break;case 35:we=rt=!0;break;case 39:case 40:rt=!0;break;default:rt=!1}if(we&&rt){var gt=Ne.fullData.byteLength,Xt=new Uint8Array(4);Xt[0]=gt>>24&255,Xt[1]=gt>>16&255,Xt[2]=gt>>8&255,Xt[3]=gt&255,pe.push(Xt),pe.push(Ne.fullData)}}var wt=pe.length?{data:Qt.apply(_n,L(pe)),kd:xe}:null;if(wt){q==null&&ne.dts!=null&&(q=ne.dts);var Yt=void 0;Yt=te+1<fe.length?(fe[te+1].dts||0)-(ne.dts||0):1<fe.length?(ne.dts||0)-(fe[te-1].dts||0):9e4*(n.endTime-n.startTime),G.push({data:wt.data,size:wt.data.byteLength,duration:Yt,cb:Math.round((ne.pts||0)-(ne.dts||0)),flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:wt.kd?2:1,hb:wt.kd?0:1}})}}var rn=z3(J);if(!rn||q==null)throw new K(2,3,3018,n?n.M()[0]:null);t.height=rn.height,t.width=rn.width,w={id:t.id,type:"video",codecs:"hvc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:9e4,duration:i,$a:[],ma:new Uint8Array([]),wa:rn.wa,Ba:rn.Ba,Ca:rn.Ca,data:{rb:this.g,baseMediaDecodeTime:q,Ya:G},stream:t}}w&&(g.push(w),w=null)}if(s=="audio"){switch(y.audio){case"aac":for(var Wt=[],At,en=null,cn=x(d.Tb()),hn=cn.next();!hn.done;hn=cn.next()){var ri=hn.value,si=ri.data;if(si){var Vi=0;if(At=vw(si,Vi),!At)throw new K(2,3,3018,n?n.M()[0]:null);for(t.audioSamplingRate=At.sampleRate,t.channelsCount=At.channelCount,en==null&&ri.pts!==null&&(en=ri.pts);Vi<si.length;){var jo=yw(si,Vi);if(jo){var ir=jo.Qd+jo.ca;Vi+ir<=si.length&&Wt.push({data:si.subarray(Vi+jo.Qd,Vi+ir),size:jo.ca,duration:1024,cb:0,flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:2,hb:0}}),Vi+=ir}else Vi++}}}if(!At||en==null){if(!d.Fc().length)throw new K(2,3,3018,n?n.M()[0]:null);en=9e4*n.startTime;var zs=qn("audio",t.codecs.split(","));if(!zs||!t.channelsCount||!t.audioSamplingRate)throw new K(2,3,3018,n?n.M()[0]:null);At={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,codec:zs};var Fo=j3(zs,t.channelsCount);if(!Fo)throw new K(2,3,3018,n?n.M()[0]:null);for(var dc=en+9e4*(n.endTime-n.startTime),bl=en;bl<dc;)Wt.push({data:Fo,size:Fo.byteLength,duration:1024,cb:0,flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:2,hb:0}}),bl+=1024/At.sampleRate*9e4}var Il=At.sampleRate,to=en/9e4*Il;w={id:t.id,type:"audio",codecs:At.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Il,duration:i,$a:[],ma:new Uint8Array([]),wa:new Uint8Array([]),Ba:0,Ca:0,data:{rb:this.g,baseMediaDecodeTime:to,Ya:Wt},stream:t};break;case"ac3":for(var Ow=[],pc=0,p0=new Uint8Array([]),gc=null,Uw=x(d.Tb()),g0=Uw.next();!g0.done;g0=Uw.next()){var m0=g0.value,y0=m0.data;gc==null&&m0.pts!==null&&(gc=m0.pts);for(var Gs=0;Gs<y0.length;){var or=ww(y0,Gs);or?(t.audioSamplingRate=or.sampleRate,t.channelsCount=or.channelCount,pc=or.sampleRate,p0=or.ma,Ow.push({data:y0.subarray(Gs,Gs+or.ca),size:or.ca,duration:1536,cb:0,flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:2,hb:0}}),Gs+=or.ca):Gs++}}if(pc==0||p0.byteLength==0||gc==null)throw new K(2,3,3018,n?n.M()[0]:null);var aI=gc/9e4*pc;w={id:t.id,type:"audio",codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:pc,duration:i,$a:[],ma:p0,wa:new Uint8Array([]),Ba:0,Ca:0,data:{rb:this.g,baseMediaDecodeTime:aI,Ya:Ow},stream:t};break;case"ec3":for(var Bw=[],mc=0,v0=new Uint8Array([]),yc=null,jw=x(d.Tb()),x0=jw.next();!x0.done;x0=jw.next()){var w0=x0.value,S0=w0.data;yc==null&&w0.pts!==null&&(yc=w0.pts);for(var Xs=0;Xs<S0.length;){var rr=Sw(S0,Xs);rr?(t.audioSamplingRate=rr.sampleRate,t.channelsCount=rr.channelCount,mc=rr.sampleRate,v0=rr.ma,Bw.push({data:S0.subarray(Xs,Xs+rr.ca),size:rr.ca,duration:1536,cb:0,flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:2,hb:0}}),Xs+=rr.ca):Xs++}}if(mc==0||v0.byteLength==0||yc==null)throw new K(2,3,3018,n?n.M()[0]:null);var lI=yc/9e4*mc;w={id:t.id,type:"audio",codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:mc,duration:i,$a:[],ma:v0,wa:new Uint8Array([]),Ba:0,Ca:0,data:{rb:this.g,baseMediaDecodeTime:lI,Ya:Bw},stream:t};break;case"mp3":for(var Fw=[],vc,xc=null,$w=x(d.Tb()),T0=$w.next();!T0.done;T0=$w.next()){var C0=T0.value,Ml=C0.data;if(Ml){xc==null&&C0.pts!==null&&(xc=C0.pts);for(var Fr=0;Fr<Ml.length;){var Ws=cc(Ml,Fr);Ws?(vc||(vc=Ws),Fr+Ws.ca<=Ml.length&&Fw.push({data:Ml.subarray(Fr,Fr+Ws.ca),size:Ws.ca,duration:1152,cb:0,flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:2,hb:0}}),Fr+=Ws.ca):Fr++}}}if(!vc||xc==null)throw new K(2,3,3018,n?n.M()[0]:null);var Vw=vc.sampleRate,uI=xc/9e4*Vw;w={id:t.id,type:"audio",codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Vw,duration:i,$a:[],ma:new Uint8Array([]),wa:new Uint8Array([]),Ba:0,Ca:0,data:{rb:this.g,baseMediaDecodeTime:uI,Ya:Fw},stream:t};break;case"opus":var Hw=[],wc=null,po=d.F;if(!po)throw new K(2,3,3018,n?n.M()[0]:null);var Un=[];switch(po.Ch){case 1:case 2:Un=[0];break;case 0:Un=[255,1,1,0,1];break;case 128:Un=[255,2,0,0,1];break;case 3:Un=[1,2,1,0,2,1];break;case 4:Un=[1,2,2,0,1,2,3];break;case 5:Un=[1,3,2,0,4,1,2,3];break;case 6:Un=[1,4,2,0,4,1,2,3,5];break;case 7:Un=[1,4,2,0,4,1,2,3,5,6];break;case 8:Un=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:Un=[1,1,2,0,1];break;case 131:Un=[1,1,3,0,1,2];break;case 132:Un=[1,1,4,0,1,2,3];break;case 133:Un=[1,1,5,0,1,2,3,4];break;case 134:Un=[1,1,6,0,1,2,3,4,5];break;case 135:Un=[1,1,7,0,1,2,3,4,5,6];break;case 136:Un=[1,1,8,0,1,2,3,4,5,6,7]}for(var zw=new Uint8Array([0,po.channelCount,0,0,po.sampleRate>>>24&255,po.sampleRate>>>17&255,po.sampleRate>>>8&255,po.sampleRate>>>0&255,0,0].concat(L(Un))),Gw=po.sampleRate,Xw=x(d.Tb()),E0=Xw.next();!E0.done;E0=Xw.next()){var A0=E0.value,qs=A0.data;wc==null&&A0.pts!==null&&(wc=A0.pts);for(var Rl=0;Rl<qs.length;){for(var fI=(qs[Rl+1]&16)!==0,cI=(qs[Rl+1]&8)!==0,$o=Rl+2,Sc=0;qs[$o]===255;)Sc+=255,$o+=1;Sc+=qs[$o],$o+=1,$o+=fI?2:0,$o+=cI?2:0;var Ww=qs.slice($o,$o+Sc);Hw.push({data:Ww,size:Ww.byteLength,duration:960,cb:0,flags:{gb:0,Xa:0,Wa:0,Ua:0,Va:2,hb:0}}),Rl=$o+Sc}}if(zw.byteLength==0||wc==null)throw new K(2,3,3018,n?n.M()[0]:null);t.audioSamplingRate=po.sampleRate,t.channelsCount=po.channelCount;var hI=wc/9e4*Gw;w={id:t.id,type:"audio",codecs:"opus",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:Gw,duration:i,$a:[],ma:zw,wa:new Uint8Array([]),Ba:0,Ca:0,data:{rb:this.g,baseMediaDecodeTime:hI,Ya:Hw},stream:t}}w&&(g.push(w),w=null)}}catch(I0){return I0&&I0.code==3023?Promise.resolve(new Uint8Array([])):Promise.reject(I0)}if(!g.length)return Promise.reject(new K(2,3,3018,n?n.M()[0]:null));var qw=new js(g),k0=t.id+"_"+n.i;if(this.i.has(k0))var b0=this.i.get(k0);else b0=Fs(qw),this.i.set(k0,b0);var dI=gl(qw);this.g++;var pI=Qt(b0,dI);return Promise.resolve(pI)},he("shaka.transmuxer.TsTransmuxer",Li),Li.prototype.transmux=Li.prototype.transmux,Li.prototype.getOriginalMimeType=Li.prototype.getOriginalMimeType,Li.prototype.convertCodecs=Li.prototype.convertCodecs,Li.prototype.isSupported=Li.prototype.isSupported,Li.prototype.destroy=Li.prototype.destroy;var tI=["aac","ac-3","ec-3","mp3","opus"],nI=["avc","hevc"];vo("video/mp2t",function(){return new Li("video/mp2t")},gh);/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function Aw(){}var Al;function kw(){Al||navigator.emeEncryptionSchemePolyfilled?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Al=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=iI,navigator.emeEncryptionSchemePolyfilled=!0):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function iI(e,t){var n=this,i;return $(function(s){return s.g==1?(console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),E(s,Al.call(n,e,t),2)):(i=s.h,Dw(i)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Al,s.return(i)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=bw,s.return(bw.call(n,e,t))))})}function bw(e,t){var n=this,i,s,l,u,c,d,g,y,w,C,T,A;return $(function(b){if(b.g==1){for(console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),i=Pw(e),s=[],l=x(t),u=l.next();!u.done;u=l.next())c=u.value,d=Iw(c.videoCapabilities,i),g=Iw(c.audioCapabilities,i),c.videoCapabilities&&c.videoCapabilities.length&&!d.length||c.audioCapabilities&&c.audioCapabilities.length&&!g.length||(y=Object.assign({},c),y.videoCapabilities=d,y.audioCapabilities=g,s.push(y));if(!s.length)throw w=Error("Unsupported keySystem or supportedConfigurations."),w.name="NotSupportedError",w.code=DOMException.NOT_SUPPORTED_ERR,w;return E(b,Al.call(n,e,s),2)}return C=b.h,A=T=null,s[0]&&(s[0].videoCapabilities&&(T=s[0].videoCapabilities[0].encryptionScheme),s[0].audioCapabilities&&(A=s[0].audioCapabilities[0].encryptionScheme)),b.return(new hc(C,T,A))})}function Iw(e,t){return e&&e.filter(function(n){return h0(n.encryptionScheme,t)})}he("EmeEncryptionSchemePolyfill",Aw),Aw.install=kw;function Mw(){}var kl;function Rw(){kl||navigator.mediaCapabilitiesEncryptionSchemePolyfilled?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(kl=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=oI,navigator.mediaCapabilitiesEncryptionSchemePolyfilled=!0):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function oI(e){var t=this,n,i;return $(function(s){switch(s.g){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),E(s,kl.call(t,e),2);case 2:if(n=s.h,!e.keySystemConfiguration)return s.return(n);if((i=n.keySystemAccess)&&Dw(i))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=kl,s.return(n);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=_w,i){s.u(3);break}return E(s,Lw(e),4);case 4:return n.keySystemAccess=s.h,s.return(n);case 3:return s.return(_w.call(t,e))}})}function _w(e){var t=this,n,i,s,l,u,c,d;return $(function(g){switch(g.g){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),i=n=null,!e.keySystemConfiguration||(s=e.keySystemConfiguration,l=s.keySystem,i=s.audio&&s.audio.encryptionScheme,n=s.video&&s.video.encryptionScheme,u=Pw(l),c={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},h0(i,u)&&h0(n,u))?E(g,kl.call(t,e),2):g.return(c);case 2:if(d=g.h,d.keySystemAccess){d.keySystemAccess=new hc(d.keySystemAccess,n,i),g.u(3);break}if(!e.keySystemConfiguration){g.u(3);break}return E(g,Lw(e),5);case 5:d.keySystemAccess=g.h;case 3:return g.return(d)}})}function Lw(e){var t,n;return $(function(i){if(i.g==1){var s=e.keySystemConfiguration,l=[],u=[];return s.audio&&l.push({robustness:s.audio.robustness||"",contentType:e.audio.contentType,encryptionScheme:s.audio.encryptionScheme}),s.video&&u.push({robustness:s.video.robustness||"",contentType:e.video.contentType,encryptionScheme:s.video.encryptionScheme}),s={initDataTypes:s.initDataType?[s.initDataType]:[],distinctiveIdentifier:s.distinctiveIdentifier,persistentState:s.persistentState,sessionTypes:s.sessionTypes},l.length&&(s.audioCapabilities=l),u.length&&(s.videoCapabilities=u),t=s,E(i,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=i.h,i.return(n)})}he("McEncryptionSchemePolyfill",Mw),Mw.install=Rw;function hc(e,t,n){this.g=e,this.i=t||null,this.h=n||null,this.keySystem=e.keySystem}hc.prototype.getConfiguration=function(){var e=this.g.getConfiguration();if(e.videoCapabilities)for(var t=x(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.i;if(e.audioCapabilities)for(t=x(e.audioCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.h;return e},hc.prototype.createMediaKeys=function(){return this.g.createMediaKeys()};function Pw(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function Dw(e){e=e.getConfiguration();var t=e.audioCapabilities&&e.audioCapabilities[0];return!!((e=e.videoCapabilities&&e.videoCapabilities[0]||t)&&e.encryptionScheme!==void 0)}function h0(e,t){return!!(!e||e==t||(e=="cbcs"||e=="cbcs-1-9")&&(sI||rI))}function d0(){}function Nw(){kw(),Rw()}he("EncryptionSchemePolyfills",d0),d0.install=Nw;var rI=navigator.userAgent.includes("CrKey"),sI=100<=parseInt(navigator.userAgent.split("Firefox/").pop(),10);typeof S<"u"&&S.exports&&(S.exports=d0)}).call(o,r,r,void 0);for(var f in o.shaka)h[f]=o.shaka[f]})()})(pT);const SS=H_(pT);let Vr,In;const vg={playingState:!1},z_=async h=>{SS.polyfill.installAll(),In=h,In||(In=document.createElement("video"),In.style.cssText="position: absolute; top: 0; left: 0; z-index: -1",In.width=1920,In.height=1080,Vr=new SS.Player,await Vr.attach(In),In.autoplay=!1,Vr.addEventListener("error",r=>{console.error(r)}),document.body.insertBefore(In,document.body.firstChild))},G_=async h=>{if(!Vr||!In)throw"Player not initialized yet";await Vr.load(h.streamUrl)},X_=()=>{In.play().then(()=>{vg.playingState=!0})},W_=()=>{In.pause(),vg.playingState=!1},q_=async()=>{await Vr.destroy(),Vr=null,In.remove(),In=null},Y_=()=>In.currentTime,K_=()=>In.duration,Z_=()=>{let h=r=>new Date(r*1e3).toISOString().substr(14,5);return`${h(In.currentTime)} : ${h(Math.floor(In.duration))}`},ar={init:z_,load:G_,play:X_,pause:W_,getCurrentTime:Y_,getVideoDuration:K_,getTimeFormat:Z_,state:vg,destroy:q_},Q_=at.Component("Player",{code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.y=1080,I.mount="{y:1}",I.w=1920,I.h=150,I.color={top:"0x00000000",bottom:"0x444444ff"},I.alpha={transition:o.controlsVisibility},a[1].populate(I),r=a[1];const M={};a[2]=this.element({parent:r||"root"},o),M.x=60,M.y=50,a[2].populate(M),r=a[2];const R={};a[3]=this.element({parent:r||"root"},o),R.w=60,R.h=60,R.color="0x0087ceeb",R.effects=[o.shader("radius",{radius:16})],a[3].populate(R),r=a[3];const U={};a[4]=this.element({parent:r||"root"},o),U.y=14,U.x=14,U.w=32,U.h=32,U.src=o.playing?"assets/player/pause.png":"assets/player/play.png",a[4].populate(U),r=a[2];const x={};a[5]=this.element({parent:r||"root"},o),x.y=22,x.x=100,x.w=o.progressLength,x.h=16,x.color="0xffffff80",x.effects=[o.shader("radius",{radius:8})],a[5].populate(x),r=a[5];const L={};a[6]=this.element({parent:r||"root"},o),L.h=16,L.w={transition:{value:o.progress,d:100,f:"ease-in-out"}},L.effects=[o.shader("radius",{radius:8})],L.color="0x0087ceeb",a[6].populate(L);const j=f.components&&f.components.Circle||p.Circle;r=a[5];const H={};a[7]=this.element({parent:r||"root"},o),H.size=28,H.color="0xffffffff",H.y=-6,H.x={transition:{value:o.progress-8,d:100,f:"ease-in-out"}};const Y=[];if(typeof j<"u")for(let ce in j.config.props)delete H[j.config.props[ce]],Y.push(j.config.props[ce]);a[7].populate(H),r=a[7];const Z={};Z.size=28,Z.color="0xffffffff",Z.y=-6,Z.x={transition:{value:o.progress-8,d:100,f:"ease-in-out"}},m=Z.is||"Circle";let X;if(typeof m=="string"){if(X=f.components&&f.components[m]||p[m],!X)throw new Error('Component "Circle" not found')}else typeof m=="function"&&m.name==="factory"&&(X=m);a[8]=X.call(null,{props:Z},a[7],o),a[8][Symbol.for("slots")][0]?(r=a[8][Symbol.for("slots")][0],o=a[8]):r=a[8][Symbol.for("children")][0],r=a[2];const re={};a[9]=this.element({parent:r||"root"},o),re.x=1660,re.y=16,a[9].populate(re),r=a[9];const le={};a[10]=this.element({parent:r||"root"},o),le.content=o.currentTime,le.size=25,le.__textnode=!0,a[10].populate(le),r=a[9];const se={};a[11]=this.element({parent:r||"root"},o),se.x=70,se.size=25,se.content="/",se.__textnode=!0,a[11].populate(se),r=a[9];const W={};return a[12]=this.element({parent:r||"root"},o),W.x=85,W.size=25,W.content=o.duration,W.__textnode=!0,a[12].populate(W),a},effects:[function(r,o,f,p,v,S){o[1].set("color",{top:"0x00000000",bottom:"0x444444ff"})},function(r,o,f,p,v,S){o[1].set("alpha",{transition:r.controlsVisibility})},function(r,o,f,p,v,S){o[3].set("effects",[r.shader("radius",{radius:16})])},function(r,o,f,p,v,S){o[4].set("src",r.playing?"assets/player/pause.png":"assets/player/play.png")},function(r,o,f,p,v,S){o[5].set("effects",[r.shader("radius",{radius:8})])},function(r,o,f,p,v,S){o[6].set("w",{transition:{value:r.progress,d:100,f:"ease-in-out"}})},function(r,o,f,p,v,S){o[6].set("effects",[r.shader("radius",{radius:8})])},function(r,o,f,p,v,S){(typeof skip7>"u"||skip7.indexOf("x")===-1)&&o[7].set("x",{transition:{value:r.progress-8,d:100,f:"ease-in-out"}})},function(r,o,f,p,v,S){o[8][Symbol.for("props")].x={transition:{value:r.progress-8,d:100,f:"ease-in-out"}}},function(r,o,f,p,v,S){o[10].set("content",r.currentTime)},function(r,o,f,p,v,S){o[12].set("content",r.duration)}],context:{}},state(){return{controlsVisibility:0,progressLength:1520,progress:0,currentTime:"00:00",duration:"00:00",playing:!1,hideTimeout:null}},hooks:{focus(){this.$emit("clearBackground")},unfocus(){this.$emit("changeBackground")},async init(){await ar.init()},async ready(){await ar.load({streamUrl:"https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"});const h=o=>new Date(o*1e3).toISOString().substr(14,5),r=ar.getVideoDuration();r&&(this.duration=h(r),this.progressChunkSize=Math.round(this.progressLength/r*100)/100),this.$setInterval(()=>{const o=ar.getCurrentTime();this.currentTime=h(o),this.progress=Math.round(o*this.progressChunkSize)},1e3),this.play()},async destroy(){await ar.destroy()}},input:{space(){this.play()},up(){this.showControls(1)},down(){this.showControls(0)}},methods:{play(){this.showControls(1),this.hideTimeout=this.$setTimeout(()=>this.showControls(0),3e3),ar.state.playingState==!0?(ar.pause(),this.playing=!1):(console.log("play!"),ar.play(),this.playing=!0)},showControls(h){this.$clearTimeout(this.hideTimeout),this.controlsVisibility=h}}}),J_=at.Component("Colors",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.w=1920,m.h=1080,m.color={transition:o.bg},a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.x=20,_.y=20,a[1].populate(_),r=a[1];const I={};a[2]=this.element({parent:r||"root"},o),I.w=100,I.h=100,I.x=0,I.color="0xecfeffff",a[2].populate(I),r=a[1];const M={};a[3]=this.element({parent:r||"root"},o),M.w=100,M.h=100,M.x=120,M.color="0xa5f3fcff",a[3].populate(M),r=a[1];const R={};a[4]=this.element({parent:r||"root"},o),R.w=100,R.h=100,R.x=240,R.color="0x22d3eeff",a[4].populate(R),r=a[1];const U={};a[5]=this.element({parent:r||"root"},o),U.w=100,U.h=100,U.x=360,U.color="0x0891b2ff",a[5].populate(U),r=a[0];const x={};a[6]=this.element({parent:r||"root"},o),x.x=20,x.y=140,a[6].populate(x),r=a[6];const L={};a[7]=this.element({parent:r||"root"},o),L.w=100,L.h=100,L.x=0,L.color="0xecfeffff",a[7].populate(L),r=a[6];const j={};a[8]=this.element({parent:r||"root"},o),j.w=100,j.h=100,j.x=120,j.color="0xa5f3fcff",a[8].populate(j),r=a[6];const H={};a[9]=this.element({parent:r||"root"},o),H.w=100,H.h=100,H.x=240,H.color="0x22d3eeff",a[9].populate(H),r=a[6];const Y={};a[10]=this.element({parent:r||"root"},o),Y.w=100,Y.h=100,Y.x=360,Y.color="0x0891b2ff",a[10].populate(Y),r=a[0];const Z={};a[11]=this.element({parent:r||"root"},o),Z.x=20,Z.y=260,a[11].populate(Z),r=a[11];const X={};a[12]=this.element({parent:r||"root"},o),X.w=100,X.h=100,X.x=0,X.color="0xecfeffaa",a[12].populate(X),r=a[11];const re={};a[13]=this.element({parent:r||"root"},o),re.w=100,re.h=100,re.x=120,re.color="0xa5f3fc33",a[13].populate(re),r=a[11];const le={};a[14]=this.element({parent:r||"root"},o),le.w=100,le.h=100,le.x=240,le.color="0x22d3ee20",a[14].populate(le),r=a[11];const se={};a[15]=this.element({parent:r||"root"},o),se.w=100,se.h=100,se.x=360,se.color="0x0891b2ff",a[15].populate(se),r=a[0];const W={};a[16]=this.element({parent:r||"root"},o),W.x=20,W.y=380,a[16].populate(W),r=a[16];const ce={};a[17]=this.element({parent:r||"root"},o),ce.w=100,ce.h=100,ce.x=0,ce.color="0xecfeffff",a[17].populate(ce),r=a[16];const E={};a[18]=this.element({parent:r||"root"},o),E.w=100,E.h=100,E.x=120,E.color="0xa5f3fcff",a[18].populate(E),r=a[16];const F={};a[19]=this.element({parent:r||"root"},o),F.w=100,F.h=100,F.x=240,F.color="0x22d3eeff",a[19].populate(F),r=a[16];const ue={};a[20]=this.element({parent:r||"root"},o),ue.w=100,ue.h=100,ue.x=360,ue.color="0x0891b2ff",a[20].populate(ue),r=a[0];const ye={};a[21]=this.element({parent:r||"root"},o),ye.x=20,ye.y=500,a[21].populate(ye),r=a[21];const ge={};a[22]=this.element({parent:r||"root"},o),ge.w=100,ge.h=100,ge.x=0,ge.color="0xecfeffab",a[22].populate(ge),r=a[21];const ie={};a[23]=this.element({parent:r||"root"},o),ie.w=100,ie.h=100,ie.x=120,ie.color="0xa5f3fc33",a[23].populate(ie),r=a[21];const ee={};a[24]=this.element({parent:r||"root"},o),ee.w=100,ee.h=100,ee.x=240,ee.color="0x22d3ee21",a[24].populate(ee),r=a[21];const de={};a[25]=this.element({parent:r||"root"},o),de.w=100,de.h=100,de.x=360,de.color="0x0891b2ff",a[25].populate(de),r=a[0];const Ee={};a[26]=this.element({parent:r||"root"},o),Ee.x=20,Ee.y=620,a[26].populate(Ee),r=a[26];const Ie={};a[27]=this.element({parent:r||"root"},o),Ie.w=100,Ie.h=100,Ie.x=0,Ie.color="0x000000ff",a[27].populate(Ie),r=a[26];const ke={};a[28]=this.element({parent:r||"root"},o),ke.w=100,ke.h=100,ke.x=120,ke.color="0xccccccff",a[28].populate(ke),r=a[26];const Le={};a[29]=this.element({parent:r||"root"},o),Le.w=100,Le.h=100,Le.x=240,Le.color="0x889900ff",a[29].populate(Le),r=a[26];const _e={};a[30]=this.element({parent:r||"root"},o),_e.w=100,_e.h=100,_e.x=360,_e.color="0x00ff00ff",a[30].populate(_e),r=a[0];const De={};a[31]=this.element({parent:r||"root"},o),De.x=20,De.y=740,a[31].populate(De),r=a[31];const $={};a[32]=this.element({parent:r||"root"},o),$.w=100,$.h=100,$.x=0,$.color="0x000000ff",a[32].populate($),r=a[31];const Pe={};a[33]=this.element({parent:r||"root"},o),Pe.w=100,Pe.h=100,Pe.x=120,Pe.color="0xccccccff",a[33].populate(Pe),r=a[31];const He={};a[34]=this.element({parent:r||"root"},o),He.w=100,He.h=100,He.x=240,He.color="0x889900ff",a[34].populate(He),r=a[31];const Se={};a[35]=this.element({parent:r||"root"},o),Se.w=100,Se.h=100,Se.x=360,Se.color="0x00ff00ff",a[35].populate(Se),r=a[0];const V={};a[36]=this.element({parent:r||"root"},o),V.x=620,V.y=20,a[36].populate(V),r=a[36];const Ae={};a[37]=this.element({parent:r||"root"},o),Ae.w=300,Ae.h=200,Ae.x=0,Ae.color={transition:o.color1},a[37].populate(Ae),r=a[36];const Ce={};a[38]=this.element({parent:r||"root"},o),Ce.w=300,Ce.h=200,Ce.x=0,Ce.y=250,Ce.color={transition:o.color2},a[38].populate(Ce),r=a[36];const je={};a[39]=this.element({parent:r||"root"},o),je.w=300,je.h=200,je.x=100,je.y=400,je.color={transition:o.color3},a[39].populate(je),r=a[36];const he={};return a[40]=this.element({parent:r||"root"},o),he.w=300,he.h=200,he.x=0,he.y=650,he.color={transition:{value:o.color4,d:1e3,f:"ease-in-out"}},a[40].populate(he),a},effects:[function(r,o,f,p,v,S){o[0].set("color",{transition:r.bg})},function(r,o,f,p,v,S){o[37].set("color",{transition:r.color1})},function(r,o,f,p,v,S){o[38].set("color",{transition:r.color2})},function(r,o,f,p,v,S){o[39].set("color",{transition:r.color3})},function(r,o,f,p,v,S){o[40].set("color",{transition:{value:r.color4,d:1e3,f:"ease-in-out"}})}],context:{}},state(){return{bg:"#fff",color1:"#22d3ee",color2:"#dc2626",color3:"rgba(251, 191, 36)",color4:"#bfdbfe"}},input:{enter(){this.color1=this.color1==="#0891b2"?"#22d3ee":"#0891b2",this.color2=this.color2==="#dc2626"?"#0f0":"#dc2626",this.color3=this.color3==="rgba(251, 191, 36)"?"rgba(30, 64, 175, 0.5)":"rgba(251, 191, 36)",this.color4=this.color4==="#1e3a8a"?"#bfdbfe":"#1e3a8a"}},hooks:{ready(){let h=0;const r=["#fff","#333","#c0ff33","#546aaa","#000","tomato"];this.$setInterval(()=>{h=h+1,h===r.length-1&&(h=0),this.bg=r[h]},2e3)}}}),e5=at.Component("Gradients",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.w=1920/4,_.h=1080,_.color="{top: '0x0891b2ff', bottom: '0xa5f3fcff'}",a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.w=1920/4,I.h=1080,I.x=1920/4,I.color="{left: '0xdc2626ff',  right: '0xf87171ff'}",a[2].populate(I),r=a[0];const M={};a[3]=this.element({parent:r||"root"},o),M.w=1920/4,M.h=1080,M.x=1920/4*2,M.color="{top: '0x0891b2ff', right: '0xf87171ff'}",a[3].populate(M),r=a[0];const R={};return a[4]=this.element({parent:r||"root"},o),R.w=1920/4,R.h=1080,R.x=1920/4*3,R.color="{right: '0x008000ff', bottom: '0xffd700ff'}",a[4].populate(R),a},effects:[function(r,o,f,p,v,S){o[1].set("w",1920/4)},function(r,o,f,p,v,S){o[2].set("w",1920/4)},function(r,o,f,p,v,S){o[2].set("x",1920/4)},function(r,o,f,p,v,S){o[3].set("w",1920/4)},function(r,o,f,p,v,S){o[3].set("x",1920/4*2)},function(r,o,f,p,v,S){o[4].set("w",1920/4)},function(r,o,f,p,v,S){o[4].set("x",1920/4*3)}],context:{}}}),t5=at.Component("Transitions",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.w=200,_.h=200,_.x=50,_.y={transition:o.y},_.color="0xc4b5fdff",a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.w=200,I.h=200,I.x=300,I.y={transition:{value:o.y}},I.color="0xa78bfaff",a[2].populate(I),r=a[0];const M={};a[3]=this.element({parent:r||"root"},o),M.w=200,M.h=200,M.x=550,M.y={transition:{value:o.y,duration:1e3,start:o.start,end:o.doneTransition3}},M.color="0x8b5cf6ff",M.ref="bla",a[3].populate(M),r=a[0];const R={};a[4]=this.element({parent:r||"root"},o),R.w=200,R.h=200,R.x=800,R.y={transition:{value:o.y,duration:500,delay:1e3,start:o.start,end:o.finished}},R.color="0x7c3aedff",a[4].populate(R),r=a[0];const U={};a[5]=this.element({parent:r||"root"},o),U.w=200,U.h=200,U.x=1050,U.y={transition:{value:o.y,easing:"ease-in-out",end:o.finished}},U.color="0x6d28d9ff",a[5].populate(U),r=a[0];const x={};a[6]=this.element({parent:r||"root"},o),x.w=200,x.h=200,x.x=1300,x.y={transition:{value:o.y,duration:3e3,easing:"ease-in-out-back",end:o.finished}},x.color="0x5b21b6ff",a[6].populate(x),r=a[0];const L={};return a[7]=this.element({parent:r||"root"},o),L.w=200,L.h=200,L.x=1550,L.y={transition:{value:o.y,duration:800,easing:"cubic-bezier(1,-0.64,.39,1.44)"}},L.color="0x4c1d95ff",a[7].populate(L),a},effects:[function(r,o,f,p,v,S){o[1].set("y",{transition:r.y})},function(r,o,f,p,v,S){o[2].set("y",{transition:{value:r.y}})},function(r,o,f,p,v,S){o[3].set("y",{transition:{value:r.y,duration:1e3,start:r.start,end:r.doneTransition3}})},function(r,o,f,p,v,S){o[4].set("y",{transition:{value:r.y,duration:500,delay:1e3,start:r.start,end:r.finished}})},function(r,o,f,p,v,S){o[5].set("y",{transition:{value:r.y,easing:"ease-in-out",end:r.finished}})},function(r,o,f,p,v,S){o[6].set("y",{transition:{value:r.y,duration:3e3,easing:"ease-in-out-back",end:r.finished}})},function(r,o,f,p,v,S){o[7].set("y",{transition:{value:r.y,duration:800,easing:"cubic-bezier(1,-0.64,.39,1.44)"}})}],context:{}},state(){return{y:50}},hooks:{ready(){this.$setTimeout(()=>{this.y=1080-50-200},500)}},methods:{doneTransition3(){this.$log.info("Transition 3 is done!")},start(h,r,o){this.$log.info("Start transition",h.nodeId,r,o)},finished(h,r,o){this.$log.info("Finished transition",h.nodeId,r,o)}}}),n5=at.Component("Alpha",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.y=100,a[1].populate(_),r=a[1];const I={};a[2]=this.element({parent:r||"root"},o),I.w=200,I.h=200,I.x=100,I.color="0xffffffff",I.alpha=.2,a[2].populate(I),r=a[1];const M={};a[3]=this.element({parent:r||"root"},o),M.w=200,M.h=200,M.x=320,M.color="0xffffffff",M.alpha=.4,a[3].populate(M),r=a[1];const R={};a[4]=this.element({parent:r||"root"},o),R.w=200,R.h=200,R.x=540,R.color="0xffffffff",R.alpha=.6,a[4].populate(R),r=a[1];const U={};a[5]=this.element({parent:r||"root"},o),U.w=200,U.h=200,U.x=760,U.color="0xffffffff",U.alpha=.8,a[5].populate(U),r=a[1];const x={};a[6]=this.element({parent:r||"root"},o),x.w=200,x.h=200,x.x=980,x.color="0xffffffff",x.alpha=1,a[6].populate(x),r=a[0];const L={};a[7]=this.element({parent:r||"root"},o),L.w=200,L.h=200,L.x=100,L.y=320,L.color="0xffffffff",L.alpha=o.alpha,a[7].populate(L),r=a[0];const j={};a[8]=this.element({parent:r||"root"},o),j.w=200,j.h=200,j.x=100,j.y=540,j.color="0xffffffff",j.alpha=o.alpha,a[8].populate(j),r=a[0];const H={};a[9]=this.element({parent:r||"root"},o),H.w=200,H.h=200,H.x=100,H.y=760,H.color="0xffffffff",H.alpha={transition:{value:o.alpha,duration:1e3,easing:"ease-in-out-circ"}},a[9].populate(H),r=a[0];const Y={};a[10]=this.element({parent:r||"root"},o),Y.w=428,Y.h=234,Y.x=1200,Y.y=100,Y.src=o.image,Y.alpha=1,a[10].populate(Y),r=a[0];const Z={};a[11]=this.element({parent:r||"root"},o),Z.w=428,Z.h=234,Z.x=1300,Z.y=100+234-40,Z.src=o.image,Z.alpha=.4,a[11].populate(Z),r=a[0];const X={};a[12]=this.element({parent:r||"root"},o),X.w=428,X.h=234,X.x=1200,X.y=100+234*2-40*2,X.src=o.image,X.alpha=.1,a[12].populate(X),r=a[0];const re={};a[13]=this.element({parent:r||"root"},o),re.x=400,re.y=400,re.alpha=.2,re.content="Text with alpha applied directly",re.__textnode=!0,a[13].populate(re),r=a[0];const le={};a[14]=this.element({parent:r||"root"},o),le.alpha=.5,le.x=400,le.y=500,a[14].populate(le),r=a[14];const se={};return a[15]=this.element({parent:r||"root"},o),se.content="Text with alpha applied on parent element",se.__textnode=!0,a[15].populate(se),a},effects:[function(r,o,f,p,v,S){o[8].set("alpha",r.alpha)},function(r,o,f,p,v,S){o[9].set("alpha",{transition:{value:r.alpha,duration:1e3,easing:"ease-in-out-circ"}})},function(r,o,f,p,v,S){o[10].set("src",r.image)},function(r,o,f,p,v,S){o[11].set("y",100+234-40)},function(r,o,f,p,v,S){o[11].set("src",r.image)},function(r,o,f,p,v,S){o[12].set("y",100+234*2-40*2)},function(r,o,f,p,v,S){o[12].set("src",r.image)}],context:{}},state(){return{alpha:.5,direction:"up",image:"assets/lightningbolt.png"}},hooks:{ready(){this.$setInterval(()=>{const h=this.direction==="up"?this.alpha+.2:this.alpha-.2;this.alpha=Math.max(Math.min(h,1),.1),this.alpha===1&&(this.direction="down"),this.alpha===.1&&(this.direction="up")},1400)}}}),i5=at.Component("Scaling",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.x=100,_.y=100,_.w=150,_.h=150,_.color="0x64748bff",a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.x=300,I.y=100,I.w=100,I.h=100,I.color="0x64748bff",I.scale=1.5,a[2].populate(I),r=a[0];const M={};a[3]=this.element({parent:r||"root"},o),M.x=100,M.y=400,M.w=100,M.h=100,M.color="0xb45309ff",M.scale=o.scale,a[3].populate(M),r=a[0];const R={};a[4]=this.element({parent:r||"root"},o),R.x=900,R.y=400,R.w=100,R.h=100,R.src=o.balloon,R.scale={transition:{value:o.scale,easing:"ease-in-out"}},a[4].populate(R),r=a[0];const U={};a[5]=this.element({parent:r||"root"},o),U.x=300,U.y=600,U.w=100,U.h=100,U.color="0x059669ff",U.scale=o.scale2,a[5].populate(U),r=a[5];const x={};a[6]=this.element({parent:r||"root"},o),x.x=10,x.y=10,x.h=60,x.w=80,x.color="0x0369a1ff",a[6].populate(x),r=a[0];const L={};a[7]=this.element({parent:r||"root"},o),L.x=1500,L.y=600,L.w=100,L.h=100,L.color="0x059669ff",L.scale=o.scale2,a[7].populate(L),r=a[7];const j={};return a[8]=this.element({parent:r||"root"},o),j.x=10,j.y=10,j.h=60,j.w=80,j.color="0x0369a1ff",j.scale=o.scale2/2,a[8].populate(j),a},effects:[function(r,o,f,p,v,S){o[4].set("src",r.balloon)},function(r,o,f,p,v,S){o[4].set("scale",{transition:{value:r.scale,easing:"ease-in-out"}})},function(r,o,f,p,v,S){o[5].set("scale",r.scale2)},function(r,o,f,p,v,S){o[7].set("scale",r.scale2)},function(r,o,f,p,v,S){o[8].set("scale",r.scale2/2)}],context:{}},state(){return{scale:2,direction:"up",balloon:"assets/balloon.png",scale2:1}},hooks:{ready(){this.$setInterval(()=>{const o=this.direction==="up"?this.scale+.5:0;this.scale=Math.max(Math.min(o,8),0),this.scale===8&&(this.direction="down"),this.scale===0&&(this.direction="up")},500),this.$setInterval(()=>{this.scale2=this.scale2===1?3:1},2e3)}}}),o5=at.Component("Rotation",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.y=70,a[1].populate(_),r=a[1];const I={};a[2]=this.element({parent:r||"root"},o),I.x=100,I.y=0,I.w=200,I.h=100,I.color="0xfee2e2ff",I.rotation=0,a[2].populate(I),r=a[1];const M={};a[3]=this.element({parent:r||"root"},o),M.x=100,M.y=150,M.w=200,M.h=100,M.color="0xfecacaff",M.rotation=10,a[3].populate(M),r=a[1];const R={};a[4]=this.element({parent:r||"root"},o),R.x=100,R.y=300,R.w=200,R.h=100,R.color="0xfca5a5ff",R.rotation=20,a[4].populate(R),r=a[1];const U={};a[5]=this.element({parent:r||"root"},o),U.x=100,U.y=450,U.w=200,U.h=100,U.color="0xf87171ff",U.rotation=30,a[5].populate(U),r=a[1];const x={};a[6]=this.element({parent:r||"root"},o),x.x=100,x.y=610,x.w=200,x.h=100,x.color="0xef4444ff",x.rotation=40,a[6].populate(x),r=a[1];const L={};a[7]=this.element({parent:r||"root"},o),L.x=100,L.y=800,L.w=200,L.h=100,L.color="0xdc2626ff",L.rotation=50,a[7].populate(L),r=a[0];const j={};a[8]=this.element({parent:r||"root"},o),j.y=70,j.x=300,a[8].populate(j),r=a[8];const H={};a[9]=this.element({parent:r||"root"},o),H.x=100,H.y=0,H.w=200,H.h=100,H.color="0xfee2e2ff",H.rotation=60,a[9].populate(H),r=a[8];const Y={};a[10]=this.element({parent:r||"root"},o),Y.x=100,Y.y=150,Y.w=200,Y.h=100,Y.color="0xfecacaff",Y.rotation=70,a[10].populate(Y),r=a[8];const Z={};a[11]=this.element({parent:r||"root"},o),Z.x=100,Z.y=300,Z.w=200,Z.h=100,Z.color="0xfca5a5ff",Z.rotation=80,a[11].populate(Z),r=a[8];const X={};a[12]=this.element({parent:r||"root"},o),X.x=100,X.y=450,X.w=200,X.h=100,X.color="0xf87171ff",X.rotation=90,a[12].populate(X),r=a[8];const re={};a[13]=this.element({parent:r||"root"},o),re.x=100,re.y=610,re.w=200,re.h=100,re.color="0xef4444ff",re.rotation=100,a[13].populate(re),r=a[8];const le={};a[14]=this.element({parent:r||"root"},o),le.x=100,le.y=800,le.w=200,le.h=100,le.color="0xdc2626ff",le.rotation=100,a[14].populate(le),r=a[0];const se={};a[15]=this.element({parent:r||"root"},o),se.y=70,se.x=600,a[15].populate(se),r=a[15];const W={};a[16]=this.element({parent:r||"root"},o),W.x=100,W.y=0,W.w=200,W.h=100,W.color="0xfee2e2ff",W.rotation=110,a[16].populate(W),r=a[15];const ce={};a[17]=this.element({parent:r||"root"},o),ce.x=100,ce.y=150,ce.w=200,ce.h=100,ce.color="0xfecacaff",ce.rotation=120,a[17].populate(ce),r=a[15];const E={};a[18]=this.element({parent:r||"root"},o),E.x=100,E.y=300,E.w=200,E.h=100,E.color="0xfca5a5ff",E.rotation=130,a[18].populate(E),r=a[15];const F={};a[19]=this.element({parent:r||"root"},o),F.x=100,F.y=450,F.w=200,F.h=100,F.color="0xf87171ff",F.rotation=140,a[19].populate(F),r=a[15];const ue={};a[20]=this.element({parent:r||"root"},o),ue.x=100,ue.y=610,ue.w=200,ue.h=100,ue.color="0xef4444ff",ue.rotation=150,a[20].populate(ue),r=a[15];const ye={};a[21]=this.element({parent:r||"root"},o),ye.x=100,ye.y=800,ye.w=200,ye.h=100,ye.color="0xdc2626ff",ye.rotation=160,a[21].populate(ye),r=a[0];const ge={};a[22]=this.element({parent:r||"root"},o),ge.y=70,ge.x=900,a[22].populate(ge),r=a[22];const ie={};a[23]=this.element({parent:r||"root"},o),ie.x=100,ie.y=0,ie.w=200,ie.h=100,ie.color="0xfee2e2ff",ie.rotation=170,a[23].populate(ie),r=a[22];const ee={};a[24]=this.element({parent:r||"root"},o),ee.x=100,ee.y=150,ee.w=200,ee.h=100,ee.color="0xfecacaff",ee.rotation=180,a[24].populate(ee),r=a[22];const de={};a[25]=this.element({parent:r||"root"},o),de.x=100,de.y=300,de.w=200,de.h=100,de.color="0xfca5a5ff",de.rotation=190,a[25].populate(de),r=a[22];const Ee={};a[26]=this.element({parent:r||"root"},o),Ee.x=100,Ee.y=450,Ee.w=200,Ee.h=100,Ee.color="0xf87171ff",Ee.rotation=200,a[26].populate(Ee),r=a[22];const Ie={};a[27]=this.element({parent:r||"root"},o),Ie.x=100,Ie.y=610,Ie.w=200,Ie.h=100,Ie.color="0xef4444ff",Ie.rotation=210,a[27].populate(Ie),r=a[22];const ke={};a[28]=this.element({parent:r||"root"},o),ke.x=100,ke.y=800,ke.w=200,ke.h=100,ke.color="0xdc2626ff",ke.rotation=220,a[28].populate(ke),r=a[0];const Le={};a[29]=this.element({parent:r||"root"},o),Le.y=70,Le.x=1200,a[29].populate(Le),r=a[29];const _e={};a[30]=this.element({parent:r||"root"},o),_e.x=100,_e.y=0,_e.w=200,_e.h=100,_e.color="0xfee2e2ff",_e.rotation=230,a[30].populate(_e),r=a[29];const De={};a[31]=this.element({parent:r||"root"},o),De.x=100,De.y=150,De.w=200,De.h=100,De.color="0xfecacaff",De.rotation=240,a[31].populate(De),r=a[29];const $={};a[32]=this.element({parent:r||"root"},o),$.x=100,$.y=300,$.w=200,$.h=100,$.color="0xfca5a5ff",$.rotation=250,a[32].populate($),r=a[29];const Pe={};a[33]=this.element({parent:r||"root"},o),Pe.x=100,Pe.y=450,Pe.w=200,Pe.h=100,Pe.color="0xf87171ff",Pe.rotation=260,a[33].populate(Pe),r=a[29];const He={};a[34]=this.element({parent:r||"root"},o),He.x=100,He.y=610,He.w=200,He.h=100,He.color="0xef4444ff",He.rotation=270,a[34].populate(He),r=a[29];const Se={};a[35]=this.element({parent:r||"root"},o),Se.x=100,Se.y=800,Se.w=200,Se.h=100,Se.color="0xdc2626ff",Se.rotation=280,a[35].populate(Se),r=a[0];const V={};a[36]=this.element({parent:r||"root"},o),V.y=70,V.x=1500,a[36].populate(V),r=a[36];const Ae={};a[37]=this.element({parent:r||"root"},o),Ae.x=100,Ae.y=0,Ae.w=200,Ae.h=100,Ae.color="0xfee2e2ff",Ae.rotation=290,a[37].populate(Ae),r=a[36];const Ce={};a[38]=this.element({parent:r||"root"},o),Ce.x=100,Ce.y=150,Ce.w=200,Ce.h=100,Ce.color="0xfecacaff",Ce.rotation=300,a[38].populate(Ce),r=a[36];const je={};a[39]=this.element({parent:r||"root"},o),je.x=100,je.y=300,je.w=200,je.h=100,je.color="0xfca5a5ff",je.rotation=310,a[39].populate(je),r=a[36];const he={};a[40]=this.element({parent:r||"root"},o),he.x=100,he.y=450,he.w=200,he.h=100,he.color="0xf87171ff",he.rotation=320,a[40].populate(he),r=a[36];const Re={};a[41]=this.element({parent:r||"root"},o),Re.x=100,Re.y=610,Re.w=200,Re.h=100,Re.color="0xef4444ff",Re.rotation=330,a[41].populate(Re),r=a[36];const Ve={};a[42]=this.element({parent:r||"root"},o),Ve.x=100,Ve.y=800,Ve.w=200,Ve.h=100,Ve.color="0xdc2626ff",Ve.rotation=340,a[42].populate(Ve),r=a[0];const ae={};a[43]=this.element({parent:r||"root"},o),ae.x=200,ae.y=200,ae.w=400,ae.h=400,ae.color="0x0891b2ff",ae.rotation=o.rotation1,a[43].populate(ae),r=a[0];const Q={};a[44]=this.element({parent:r||"root"},o),Q.x=800,Q.y=200,Q.w=400,Q.h=400,Q.color="0x0891b2ff",Q.rotation=o.rotation2,a[44].populate(Q),r=a[0];const be={};return a[45]=this.element({parent:r||"root"},o),be.x=1400,be.y=200,be.w=400,be.h=400,be.color="0x0891b2ff",be.rotation={transition:o.rotation3},a[45].populate(be),a},effects:[function(r,o,f,p,v,S){o[44].set("rotation",r.rotation2)},function(r,o,f,p,v,S){o[45].set("rotation",{transition:r.rotation3})}],context:{}},state(){return{rotation1:38,rotation2:0,rotation3:0}},hooks:{ready(){let h=800,r=2e3;this.$setInterval(()=>{const o=this.rotation2+10;this.rotation2=o<=360?o:0},h),this.$setInterval(()=>{this.rotation3=Math.max(10,Math.min(720,this.rotation3*2)),this.rotation3===720&&(this.rotation3=0)},r)}}}),r5=at.Component("KeyInput",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.x=525,m.y=130,a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.w=200,_.h=200,_.color=o.focusColor,_.x=o.focusedX*220,_.y=o.focusedY*210,a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.w=180,I.h=180,I.x=10,I.y=10,I.color=o.blockColor,a[2].populate(I),r=a[0];const M={};a[3]=this.element({parent:r||"root"},o),M.w=180,M.h=180,M.x=230,M.y=10,M.color=o.blockColor,a[3].populate(M),r=a[0];const R={};a[4]=this.element({parent:r||"root"},o),R.w=180,R.h=180,R.x=450,R.y=10,R.color=o.blockColor,a[4].populate(R),r=a[0];const U={};a[5]=this.element({parent:r||"root"},o),U.w=180,U.h=180,U.x=670,U.y=10,U.color=o.blockColor,a[5].populate(U),r=a[0];const x={};a[6]=this.element({parent:r||"root"},o),x.w=180,x.h=180,x.x=10,x.y=220,x.color=o.blockColor,a[6].populate(x),r=a[0];const L={};a[7]=this.element({parent:r||"root"},o),L.w=180,L.h=180,L.x=230,L.y=220,L.color=o.blockColor,a[7].populate(L),r=a[0];const j={};a[8]=this.element({parent:r||"root"},o),j.w=180,j.h=180,j.x=450,j.y=220,j.color=o.blockColor,a[8].populate(j),r=a[0];const H={};a[9]=this.element({parent:r||"root"},o),H.w=180,H.h=180,H.x=670,H.y=220,H.color=o.blockColor,a[9].populate(H),r=a[0];const Y={};a[10]=this.element({parent:r||"root"},o),Y.w=180,Y.h=180,Y.x=10,Y.y=430,Y.color=o.blockColor,a[10].populate(Y),r=a[0];const Z={};a[11]=this.element({parent:r||"root"},o),Z.w=180,Z.h=180,Z.x=230,Z.y=430,Z.color=o.blockColor,a[11].populate(Z),r=a[0];const X={};a[12]=this.element({parent:r||"root"},o),X.w=180,X.h=180,X.x=450,X.y=430,X.color=o.blockColor,a[12].populate(X),r=a[0];const re={};a[13]=this.element({parent:r||"root"},o),re.w=180,re.h=180,re.x=670,re.y=430,re.color=o.blockColor,a[13].populate(re),r=a[0];const le={};a[14]=this.element({parent:r||"root"},o),le.w=180,le.h=180,le.x=10,le.y=640,le.color=o.blockColor,a[14].populate(le),r=a[0];const se={};a[15]=this.element({parent:r||"root"},o),se.w=180,se.h=180,se.x=230,se.y=640,se.color=o.blockColor,a[15].populate(se),r=a[0];const W={};a[16]=this.element({parent:r||"root"},o),W.w=180,W.h=180,W.x=450,W.y=640,W.color=o.blockColor,a[16].populate(W),r=a[0];const ce={};return a[17]=this.element({parent:r||"root"},o),ce.w=180,ce.h=180,ce.x=670,ce.y=640,ce.color=o.blockColor,a[17].populate(ce),a},effects:[function(r,o,f,p,v,S){o[1].set("color",r.focusColor)},function(r,o,f,p,v,S){o[1].set("x",r.focusedX*220)},function(r,o,f,p,v,S){o[1].set("y",r.focusedY*210)},function(r,o,f,p,v,S){o[2].set("color",r.blockColor)},function(r,o,f,p,v,S){o[3].set("color",r.blockColor)},function(r,o,f,p,v,S){o[4].set("color",r.blockColor)},function(r,o,f,p,v,S){o[5].set("color",r.blockColor)},function(r,o,f,p,v,S){o[6].set("color",r.blockColor)},function(r,o,f,p,v,S){o[7].set("color",r.blockColor)},function(r,o,f,p,v,S){o[8].set("color",r.blockColor)},function(r,o,f,p,v,S){o[9].set("color",r.blockColor)},function(r,o,f,p,v,S){o[10].set("color",r.blockColor)},function(r,o,f,p,v,S){o[11].set("color",r.blockColor)},function(r,o,f,p,v,S){o[12].set("color",r.blockColor)},function(r,o,f,p,v,S){o[13].set("color",r.blockColor)},function(r,o,f,p,v,S){o[14].set("color",r.blockColor)},function(r,o,f,p,v,S){o[15].set("color",r.blockColor)},function(r,o,f,p,v,S){o[16].set("color",r.blockColor)},function(r,o,f,p,v,S){o[17].set("color",r.blockColor)}],context:{}},state(){return{focusedX:0,focusedY:0,colorscheme:"yellow"}},computed:{blockColor(){return this.colorscheme==="yellow"?"#fef08a":"#bae6fd"},focusColor(){return this.colorscheme==="yellow"?"#facc15":"#38bdf8"}},input:{left(){const h=this.focusedX-1;this.focusedX=Math.max(h,0)},right(){const h=this.focusedX+1;this.focusedX=Math.min(h,3)},up(){this.focusedY=Math.max(this.focusedY-1,0)},down(){this.focusedY=Math.min(this.focusedY+1,3)},enter(){this.colorscheme=this.colorscheme==="yellow"?"blue":"yellow"},any(h){const r=parseInt(h.key);isNaN(r)?this.parent.$focus(h):(this.focusedX=Math.max(0,(r-1)%4),this.focusedY=Math.max(0,Math.ceil(r/4)-1))}}}),$0=["#64748b","#ef4444","#f97316","#84cc16","#14b8a6","#3b82f6"],V0=["Iron Man","Captain America","Thor","Hulk","Black Widow","Hawkeye","Scarlet Witch","Vision","Black Panther","Doctor Strange","Spider-Man","Ant-Man","Wasp","Captain Marvel","Falcon","Winter Soldier","War Machine","Quicksilver","Star-Lord","Gamora"],s5=at.Component("Texts",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.x=100,m.y=100,a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.content="Default text",_["@loaded"]=o.textLoaded&&o.textLoaded.bind(o),_.__textnode=!0,a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.content="123456",I.x=400,I.__textnode=!0,a[2].populate(I),r=a[0];const M={};a[3]=this.element({parent:r||"root"},o),M.content="Text with a different fontsize",M.size=o.size,M.y=120,M.font="raleway",M.__textnode=!0,a[3].populate(M),r=a[0];const R={};a[4]=this.element({parent:r||"root"},o),R.content="Text with a different color",R.size=50,R.color=o.color,R.y=250,R.__textnode=!0,a[4].populate(R),r=a[0];const U={};a[5]=this.element({parent:r||"root"},o),U.content="Letterspacing",U.size=50,U.color="0x38bdf8ff",U.y=450,U.letterspacing=40,U.__textnode=!0,a[5].populate(U),r=a[0];const x={};a[6]=this.element({parent:r||"root"},o),x.w=800,x.h=100,x.y=550,x.color="0x94a3b8ff",a[6].populate(x),r=a[6];const L={};a[7]=this.element({parent:r||"root"},o),L.content="Text align center",L.size=50,L.y=15,L.color="0xbae6fdff",L.align="center",L.wordwrap=800,L.__textnode=!0,a[7].populate(L),r=a[0];const j={};a[8]=this.element({parent:r||"root"},o),j.w=800,j.h=200,j.x=900,j.y=550,j.color="0x94a3b8ff",a[8].populate(j),r=a[8];const H={};a[9]=this.element({parent:r||"root"},o),H.content=o.longText,H.size=40,H.color="0xbae6fdff",H.wordwrap=800,H.maxlines=5,H.textoverflow="!!!",H.__textnode=!0,a[9].populate(H),r=a[0];const Y={};a[10]=this.element({parent:r||"root"},o),Y.w=800,Y.h=120,Y.x=900,Y.y=800,Y.color="0x94a3b8ff",a[10].populate(Y),r=a[10];const Z={};a[11]=this.element({parent:r||"root"},o),Z.content=o.longText,Z.size=40,Z.color="0xbae6fdff",Z.wordwrap=800,Z.maxlines=2,Z.lineheight=60,Z.textoverflow=!1,Z.__textnode=!0,a[11].populate(Z),r=a[0];const X={};a[12]=this.element({parent:r||"root"},o),X.content=o.character,X.size=50,X.color=o.color,X.y=750,X.font="opensans",X.__textnode=!0,a[12].populate(X),r=a[0];const re={};a[13]=this.element({parent:r||"root"},o),re.x=1200,re.y=300,a[13].populate(re),r=a[13];const le={};a[14]=this.element({parent:r||"root"},o),le.rotation={transition:o.rotation},le.pivot=0,le.content="Hello",le.__textnode=!0,a[14].populate(le),r=a[13];const se={};a[15]=this.element({parent:r||"root"},o),se.x=150,se.rotation={transition:o.rotation},se.pivot=.5,se.content="World",se.__textnode=!0,a[15].populate(se),r=a[13];const W={};return a[16]=this.element({parent:r||"root"},o),W.x=300,W.rotation={transition:o.rotation},W.pivot=1,W.content="!!",W.__textnode=!0,a[16].populate(W),a},effects:[function(r,o,f,p,v,S){o[3].set("size",r.size)},function(r,o,f,p,v,S){o[4].set("color",r.color)},function(r,o,f,p,v,S){o[12].set("content",r.character)},function(r,o,f,p,v,S){o[12].set("color",r.color)},function(r,o,f,p,v,S){o[14].set("rotation",{transition:r.rotation})},function(r,o,f,p,v,S){o[15].set("rotation",{transition:r.rotation})},function(r,o,f,p,v,S){o[16].set("rotation",{transition:r.rotation})}],context:{}},state(){return{color:$0[0],size:10,character:V0[0],myText:"This is my test yeah",longText:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at ante non mauris commodo tristique. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Ut quis mattis mi. Aliquam ultricies mi vel lobortis luctus. Ut non feugiat urna. Duis sed blandit dui. Donec venenatis, mauris at blandit malesuada, elit nibh scelerisque lacus, non tempus arcu mi at justo.",rotation:0}},hooks:{ready(){let h=0;this.$setInterval(()=>{h++,h>$0.length-1&&(h=0),this.color=$0[h],this.size=10*(h*2+1),this.rotation+=30},1e3);let r=0;this.$setInterval(()=>{r++,r>V0.length-1&&(r=0),this.character=V0[r]},1400)}},methods:{textLoaded(h){this.$log.info(`Text loaded with w: ${h.w} and h: ${h.h}`)}}}),Uc=["https://images.unsplash.com/photo-1690360994204-3d10cc73a08d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=428&q=80","https://images.unsplash.com/photo-1582971103098-bfc707d2ad92?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=428&q=80"],a5=at.Component("Images",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.src="assets/lightningbolt.png",_.w=428,_.h=234,_.x=100,_.y=100,a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.src="https://images.unsplash.com/photo-1611148799269-63df34f63f6c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=428&q=80",I.w=428,I.h=234,I.x=100,I.y=400,a[2].populate(I),r=a[0];const M={};a[3]=this.element({parent:r||"root"},o),M.src=o.image,M.w=428,M.h=234,M.x=100,M.y=700,M["@loaded"]=o.imageLoaded&&o.imageLoaded.bind(o),a[3].populate(M),r=a[0];const R={};a[4]=this.element({parent:r||"root"},o),R.color="{top: '0xff0000ff', bottom: '0xffd700ff'}",R.src="assets/lightningbolt.png",R.w=428,R.h=234,R.x=600,R.y=100,a[4].populate(R),r=a[0];const U={};a[5]=this.element({parent:r||"root"},o),U.x=600,U.y=400,U.w=428,U.h=234,U.clipping=o.clipping,a[5].populate(U),r=a[5];const x={};a[6]=this.element({parent:r||"root"},o),x.src="assets/lightningbolt.png",x.w=856,x.h=468,a[6].populate(x),r=a[0];const L={};return a[7]=this.element({parent:r||"root"},o),L.color=o.color,L.src="assets/lightningbolt.png",L.w=428,L.h=234,L.x=1100,L.y=100,a[7].populate(L),a},effects:[function(r,o,f,p,v,S){o[3].set("src",r.image)},function(r,o,f,p,v,S){o[5].set("clipping",r.clipping)},function(r,o,f,p,v,S){o[7].set("color",r.color)}],context:{}},state(){return{image:Uc[0],clipping:!0,color:"red"}},hooks:{ready(){this.$setInterval(()=>{this.image=this.image===Uc[0]?Uc[1]:Uc[0],this.clipping=!this.clipping,this.color=this.color==="red"?"blue":"red"},2e3)}},methods:{imageLoaded(h){console.log("backstopjs:ready"),this.$log.info(`Image loaded with w: ${h.w} and h: ${h.h}`)}}}),da=at.Component("Square",{code:{render:function(r,o,f,p,v,S){const a=[],m={};return a[0]=this.element({parent:r||"root"},o),m.w={transition:o.size},m.h={transition:o.size},m.color={transition:o.color},a[0].populate(m),a},effects:[function(r,o,f,p,v,S){o[0].set("w",{transition:r.size})},function(r,o,f,p,v,S){o[0].set("h",{transition:r.size})},function(r,o,f,p,v,S){o[0].set("color",{transition:r.color})}],context:{}},props:[{key:"size",default:80}],state(){return{color:"#86198f"}},watch:{size(h,r){this.$log.info(`Size changed from ${r} to ${h}`),this.color=this.color==="#86198f"?"#9d174d":"#86198f"}}}),gT=at.Component("Card",{components:{Square:da},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),_.w=o.w,_.h=o.h,_.color="0x0891b2ff",a[0].populate(_);const I=f.components&&f.components.Square||p.Square;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o),M.x=80,M.y=80;const R=[];if(typeof I<"u")for(let X in I.config.props)delete M[I.config.props[X]],R.push(I.config.props[X]);a[1].populate(M),r=a[1];const U={};U.x=80,U.y=80,m=U.is||"Square";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0];const L=f.components&&f.components.Square||p.Square;r=a[0];const j={};a[3]=this.element({parent:r||"root"},o),j.x=20,j.y=20,j.size=40;const H=[];if(typeof L<"u")for(let X in L.config.props)delete j[L.config.props[X]],H.push(L.config.props[X]);a[3].populate(j),r=a[3];const Y={};Y.x=20,Y.y=20,Y.size=40,m=Y.is||"Square";let Z;if(typeof m=="string"){if(Z=f.components&&f.components[m]||p[m],!Z)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(Z=m);return a[4]=Z.call(null,{props:Y},a[3],o),a[4][Symbol.for("slots")][0]?(r=a[4][Symbol.for("slots")][0],o=a[4]):r=a[4][Symbol.for("children")][0],a},effects:[],context:{}},props:["size"],computed:{w(){return this.size==="large"?400:200},h(){return this.size==="large"?500:300}}}),l5=at.Component("Components",{components:{Square:da,Card:gT},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_);const I=f.components&&f.components.Square||p.Square;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o),M.x=100,M.y=100,M.size=50;const R=[];if(typeof I<"u")for(let Re in I.config.props)delete M[I.config.props[Re]],R.push(I.config.props[Re]);a[1].populate(M),r=a[1];const U={};U.x=100,U.y=100,U.size=50,m=U.is||"Square";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0];const L=f.components&&f.components.Square||p.Square;r=a[0];const j={};a[3]=this.element({parent:r||"root"},o),j.x=100,j.y=200,j.size=100;const H=[];if(typeof L<"u")for(let Re in L.config.props)delete j[L.config.props[Re]],H.push(L.config.props[Re]);a[3].populate(j),r=a[3];const Y={};Y.x=100,Y.y=200,Y.size=100,m=Y.is||"Square";let Z;if(typeof m=="string"){if(Z=f.components&&f.components[m]||p[m],!Z)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(Z=m);a[4]=Z.call(null,{props:Y},a[3],o),a[4][Symbol.for("slots")][0]?(r=a[4][Symbol.for("slots")][0],o=a[4]):r=a[4][Symbol.for("children")][0];const X=f.components&&f.components.Square||p.Square;r=a[0];const re={};a[5]=this.element({parent:r||"root"},o),re.x=100,re.y=350,re.size=200;const le=[];if(typeof X<"u")for(let Re in X.config.props)delete re[X.config.props[Re]],le.push(X.config.props[Re]);a[5].populate(re),r=a[5];const se={};se.x=100,se.y=350,se.size=200,m=se.is||"Square";let W;if(typeof m=="string"){if(W=f.components&&f.components[m]||p[m],!W)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(W=m);a[6]=W.call(null,{props:se},a[5],o),a[6][Symbol.for("slots")][0]?(r=a[6][Symbol.for("slots")][0],o=a[6]):r=a[6][Symbol.for("children")][0];const ce=f.components&&f.components.Square||p.Square;r=a[0];const E={};a[7]=this.element({parent:r||"root"},o),E.x={transition:o.x},E.y=600,E.size=50;const F=[];if(typeof ce<"u")for(let Re in ce.config.props)delete E[ce.config.props[Re]],F.push(ce.config.props[Re]);a[7].populate(E),r=a[7];const ue={};ue.x={transition:o.x},ue.y=600,ue.size=50,m=ue.is||"Square";let ye;if(typeof m=="string"){if(ye=f.components&&f.components[m]||p[m],!ye)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(ye=m);a[8]=ye.call(null,{props:ue},a[7],o),a[8][Symbol.for("slots")][0]?(r=a[8][Symbol.for("slots")][0],o=a[8]):r=a[8][Symbol.for("children")][0];const ge=f.components&&f.components.Card||p.Card;r=a[0];const ie={};a[9]=this.element({parent:r||"root"},o),ie.x=500,ie.y=100;const ee=[];if(typeof ge<"u")for(let Re in ge.config.props)delete ie[ge.config.props[Re]],ee.push(ge.config.props[Re]);a[9].populate(ie),r=a[9];const de={};de.x=500,de.y=100,m=de.is||"Card";let Ee;if(typeof m=="string"){if(Ee=f.components&&f.components[m]||p[m],!Ee)throw new Error('Component "Card" not found')}else typeof m=="function"&&m.name==="factory"&&(Ee=m);a[10]=Ee.call(null,{props:de},a[9],o),a[10][Symbol.for("slots")][0]?(r=a[10][Symbol.for("slots")][0],o=a[10]):r=a[10][Symbol.for("children")][0];const Ie=f.components&&f.components.Card||p.Card;r=a[0];const ke={};a[11]=this.element({parent:r||"root"},o),ke.x=500,ke.y=500,ke.size="large";const Le=[];if(typeof Ie<"u")for(let Re in Ie.config.props)delete ke[Ie.config.props[Re]],Le.push(Ie.config.props[Re]);a[11].populate(ke),r=a[11];const _e={};_e.x=500,_e.y=500,_e.size="large",m=_e.is||"Card";let De;if(typeof m=="string"){if(De=f.components&&f.components[m]||p[m],!De)throw new Error('Component "Card" not found')}else typeof m=="function"&&m.name==="factory"&&(De=m);a[12]=De.call(null,{props:_e},a[11],o),a[12][Symbol.for("slots")][0]?(r=a[12][Symbol.for("slots")][0],o=a[12]):r=a[12][Symbol.for("children")][0],r=a[0];const $={};a[13]=this.element({parent:r||"root"},o),$.x=1e3,$.y=100,a[13].populate($),r=a[13];const Pe={};a[14]=this.element({parent:r||"root"},o),Pe.content="Dynamic components",Pe.__textnode=!0,a[14].populate(Pe);const He=f.components&&f.components.Component||p.Component;r=a[13];const Se={};a[15]=this.element({parent:r||"root"},o),Se.is=o.dynamicComponent,Se.y=100,Se.color="0x0000ffff";const V=[];if(typeof He<"u")for(let Re in He.config.props)delete Se[He.config.props[Re]],V.push(He.config.props[Re]);a[15].populate(Se),r=a[15];const Ae={};Ae.is=o.dynamicComponent,Ae.y=100,Ae.color="0x0000ffff",m=Ae.is||"Component";let Ce;if(typeof m=="string"){if(Ce=f.components&&f.components[m]||p[m],!Ce)throw new Error('Component "Component" not found')}else typeof m=="function"&&m.name==="factory"&&(Ce=m);a[16]=Ce.call(null,{props:Ae},a[15],o),a[16][Symbol.for("slots")][0]?(r=a[16][Symbol.for("slots")][0],o=a[16]):r=a[16][Symbol.for("children")][0],r=a[13];const je=[],he=(Re=[],Ve,ae)=>{const Q=S(Re),be=new Set;let st=Q.length;for(;st--;)Q[st],be.add(""+st);let Xe=ae.length;for(;Xe--;)if(be.has(ae[Xe])===!1){const Ke=ae[Xe];Ve[17][Ke]&&Ve[17][Ke].destroy(),delete Ve[17][Ke],Ve[18][Ke]&&Ve[18][Ke].destroy(),delete Ve[18][Ke]}ae.length=0;const Fe=Q.length;for(let Ke=0;Ke<Fe;Ke++){const kt=Object.create(o);r=Ve[13],kt.index=Ke,kt.bla=Q[Ke],kt.key=""+Ke,ae.push(kt.key);const qt=f.components&&f.components.Component||p.Component;Ve[17]===void 0&&(Ve[17]={});const $t={};Ve[17][kt.key]===void 0&&(Ve[17][kt.key]=this.element({parent:r||"root"},o)),$t.is=kt.bla,$t.x=205*kt.index,$t.y=300;const We=[];if(typeof qt<"u")for(let lt in qt.config.props)delete $t[qt.config.props[lt]],We.push(qt.config.props[lt]);Ve[17][kt.key].nodeId===void 0&&Ve[17][kt.key].populate($t),Ve[18]===void 0&&(Ve[18]={}),r=Ve[17][kt.key];const Sn={};if(Ve[18][kt.key]===void 0){Sn.is=kt.bla,Sn.x=205*kt.index,Sn.y=300,m=Sn.is||"Component";let lt;if(typeof m=="string"){if(lt=f.components&&f.components[m]||p[m],!lt)throw new Error('Component "Component" not found')}else typeof m=="function"&&m.name==="factory"&&(lt=m);Ve[18][kt.key]=lt.call(null,{props:Sn},Ve[17][kt.key],o),Ve[18][kt.key][Symbol.for("slots")][0]?(r=Ve[18][kt.key][Symbol.for("slots")][0],o=Ve[18][kt.key]):r=Ve[18][kt.key][Symbol.for("children")][0]}v(()=>{(typeof We>"u"||We.indexOf("x")===-1)&&Ve[17][kt.key].set("x",205*kt.index)},"dynamicComponents"),Ve[18][kt.key][Symbol.for("props")].x=205*kt.index}};return v(()=>{he(o.dynamicComponents,a,je)},"dynamicComponents"),a},effects:[function(r,o,f,p,v,S){(typeof skip7>"u"||skip7.indexOf("x")===-1)&&o[7].set("x",{transition:r.x})},function(r,o,f,p,v,S){o[8][Symbol.for("props")].x={transition:r.x}}],context:{}},state(){return{x:100,dynamicComponent:oh,dynamicComponents:["Square","Card","Square",oh],toggle:!1,size:50}},hooks:{ready(){this.$setInterval(()=>{this.x=this.x===100?250:100,this.size=this.size===50?200:50},2e3)}}}),Si=["#bbf7d0","#86efac","#4ade80","#22c55e","#16a34a","#15803d"],u5=at.Component("ForLoop",{components:{Square:da},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.y=20,a[1].populate(I),r=a[1];const M=[],R=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;)Ce[he],je.add(""+he);let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[2][ae]&&V[2][ae].destroy(),delete V[2][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[1],Q.index=ae,Q.item=Ce[ae],Q.key=""+ae,Ae.push(Q.key),r=V[1],V[2]===void 0&&(V[2]={});const be={};V[2][Q.key]===void 0&&(V[2][Q.key]=this.element({parent:r||"root"},o)),be.w=80,be.h=80,be.x=Q.item,be.color="0x4d7c0fff",V[2][Q.key].nodeId===void 0&&V[2][Q.key].populate(be)}};v(()=>{R(o.collection1,a,M)},"collection1"),r=a[0];const U={};a[3]=this.element({parent:r||"root"},o),U.y=120,a[3].populate(U),r=a[3];const x=[],L=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;){const ae=Ce[he];je.add(""+ae.id)}let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[4][ae]&&V[4][ae].destroy(),delete V[4][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[3],Q.index=ae,Q.item=Ce[ae],Q.key=""+Q.item.id,Ae.push(Q.key),r=V[3],V[4]===void 0&&(V[4]={});const be={};V[4][Q.key]===void 0&&(V[4][Q.key]=this.element({parent:r||"root"},o)),be.w=80,be.h=80,be.x=Q.item.x*Q.index,be.color=Q.item.color,V[4][Q.key].nodeId===void 0&&V[4][Q.key].populate(be),v(()=>{V[4][Q.key].set("x",Q.item.x*Q.index)},"collection2")}};v(()=>{L(o.collection2,a,x)},"collection2"),r=a[0];const j={};a[5]=this.element({parent:r||"root"},o),j.y=220,a[5].populate(j),r=a[5];const H=[],Y=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;)Ce[he],je.add(""+he);let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[6][ae]&&V[6][ae].destroy(),delete V[6][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[5],Q.index=ae,Q.item=Ce[ae],Q.key=""+ae,Ae.push(Q.key),r=V[5],V[6]===void 0&&(V[6]={});const be={};V[6][Q.key]===void 0&&(V[6][Q.key]=this.element({parent:r||"root"},o)),be.w=80,be.h=80,be.x=Q.item.x,be.color=Q.item.color,V[6][Q.key].nodeId===void 0&&V[6][Q.key].populate(be),v(()=>{V[6][Q.key].set("x",Q.item.x)},null)}};v(()=>{Y(o.collection3,a,H)},"collection3"),r=a[0];const Z={};a[7]=this.element({parent:r||"root"},o),Z.y=320,a[7].populate(Z),r=a[7];const X=[],re=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;)Ce[he],je.add(""+he);let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[8][ae]&&V[8][ae].destroy(),delete V[8][ae],V[9][ae]&&V[9][ae].destroy(),delete V[9][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[7],Q.index=ae,Q.item=Ce[ae],Q.key=""+ae,Ae.push(Q.key);const be=f.components&&f.components.Square||p.Square;V[8]===void 0&&(V[8]={});const st={};V[8][Q.key]===void 0&&(V[8][Q.key]=this.element({parent:r||"root"},o)),st.x=Q.item.x*Q.index,st.ref="square"+Q.index,st.alpha=Q.alpha;const Xe=[];if(typeof be<"u")for(let Ke in be.config.props)delete st[be.config.props[Ke]],Xe.push(be.config.props[Ke]);V[8][Q.key].nodeId===void 0&&V[8][Q.key].populate(st),V[9]===void 0&&(V[9]={}),r=V[8][Q.key];const Fe={};if(V[9][Q.key]===void 0){Fe.x=Q.item.x*Q.index,Fe.ref="square"+Q.index,Fe.alpha=Q.alpha,m=Fe.is||"Square";let Ke;if(typeof m=="string"){if(Ke=f.components&&f.components[m]||p[m],!Ke)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(Ke=m);V[9][Q.key]=Ke.call(null,{props:Fe},V[8][Q.key],o),V[9][Q.key][Symbol.for("slots")][0]?(r=V[9][Q.key][Symbol.for("slots")][0],o=V[9][Q.key]):r=V[9][Q.key][Symbol.for("children")][0]}v(()=>{(typeof Xe>"u"||Xe.indexOf("x")===-1)&&V[8][Q.key].set("x",Q.item.x*Q.index)},"collection2"),v(()=>{(typeof Xe>"u"||Xe.indexOf("ref")===-1)&&V[8][Q.key].set("ref","square"+Q.index)},"collection2"),V[9][Q.key][Symbol.for("props")].x=Q.item.x*Q.index,V[9][Q.key][Symbol.for("props")].ref="square"+Q.index}};v(()=>{re(o.collection2,a,X)},"collection2"),v(()=>{o.alpha;for(let Se=0;Se<o.collection2.length;Se++){const V={};V.index=Se,V.item=o.collection2[Se],V.key=Se,(typeof skip8>"u"||skip8.indexOf("alpha")===-1)&&a[8][V.key].set("alpha",o.alpha)}}),v(()=>{o.alpha;for(let Se=0;Se<o.collection2.length;Se++){const V={};V.index=Se,V.item=o.collection2[Se],V.key=Se,a[9][V.key][Symbol.for("props")].alpha=o.alpha}}),r=a[0];const le={};a[10]=this.element({parent:r||"root"},o),le.y=420,a[10].populate(le),r=a[10];const se=[],W=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;){const ae=Ce[he];je.add(""+ae.color)}let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[11][ae]&&V[11][ae].destroy(),delete V[11][ae],V[12][ae]&&V[12][ae].destroy(),delete V[12][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[10],Q.index=ae,Q.item=Ce[ae],Q.key=""+Q.item.color,Ae.push(Q.key);const be=f.components&&f.components.Square||p.Square;V[11]===void 0&&(V[11]={});const st={};V[11][Q.key]===void 0&&(V[11][Q.key]=this.element({parent:r||"root"},o)),st.x=Q.item.x,st.alpha=Q.alpha;const Xe=[];if(typeof be<"u")for(let Ke in be.config.props)delete st[be.config.props[Ke]],Xe.push(be.config.props[Ke]);V[11][Q.key].nodeId===void 0&&V[11][Q.key].populate(st),V[12]===void 0&&(V[12]={}),r=V[11][Q.key];const Fe={};if(V[12][Q.key]===void 0){Fe.x=Q.item.x,Fe.alpha=Q.alpha,m=Fe.is||"Square";let Ke;if(typeof m=="string"){if(Ke=f.components&&f.components[m]||p[m],!Ke)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(Ke=m);V[12][Q.key]=Ke.call(null,{props:Fe},V[11][Q.key],o),V[12][Q.key][Symbol.for("slots")][0]?(r=V[12][Q.key][Symbol.for("slots")][0],o=V[12][Q.key]):r=V[12][Q.key][Symbol.for("children")][0]}v(()=>{(typeof Xe>"u"||Xe.indexOf("x")===-1)&&V[11][Q.key].set("x",Q.item.x)},null),V[12][Q.key][Symbol.for("props")].x=Q.item.x}};v(()=>{W(o.collection3,a,se)},"collection3"),v(()=>{o.alpha;for(let Se=0;Se<o.collection3.length;Se++){const V={};V.index=Se,V.item=o.collection3[Se],V.key=V.item.color,(typeof skip11>"u"||skip11.indexOf("alpha")===-1)&&a[11][V.key].set("alpha",o.alpha)}}),v(()=>{o.alpha;for(let Se=0;Se<o.collection3.length;Se++){const V={};V.index=Se,V.item=o.collection3[Se],V.key=V.item.color,a[12][V.key][Symbol.for("props")].alpha=o.alpha}}),r=a[0];const ce={};a[13]=this.element({parent:r||"root"},o),ce.y=520,a[13].populate(ce),r=a[13];const E=[],F=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;)Ce[he],je.add(""+he);let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[14][ae]&&V[14][ae].destroy(),delete V[14][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[13],Q.index=ae,Q.item=Ce[ae],Q.key=""+ae,Ae.push(Q.key),r=V[13],V[14]===void 0&&(V[14]={});const be={};V[14][Q.key]===void 0&&(V[14][Q.key]=this.element({parent:r||"root"},o)),be.w=80,be.h=80,be.x=Q.item,be.color="0xeab308ff",be.alpha=Q.alpha,V[14][Q.key].nodeId===void 0&&V[14][Q.key].populate(be)}};v(()=>{F(o.collection1,a,E)},"collection1"),v(()=>{o.item;for(let Se=0;Se<o.collection1.length;Se++){const V={};V.index=Se,V.item=o.collection1[Se],V.key=Se,a[14][V.key].set("x",o.item)}}),v(()=>{o.alpha;for(let Se=0;Se<o.collection1.length;Se++){const V={};V.index=Se,V.item=o.collection1[Se],V.key=Se,a[14][V.key].set("alpha",o.alpha)}}),r=a[0];const ue={};a[15]=this.element({parent:r||"root"},o),ue.y=620,a[15].populate(ue),r=a[15];const ye=[],ge=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;){const ae=Ce[he];je.add(""+ae.id)}let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[16][ae]&&V[16][ae].destroy(),delete V[16][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[15],Q.index=ae,Q.item=Ce[ae],Q.key=""+Q.item.id,Ae.push(Q.key),r=V[15],V[16]===void 0&&(V[16]={});const be={};V[16][Q.key]===void 0&&(V[16][Q.key]=this.element({parent:r||"root"},o)),be.w=80,be.h=80,be.x=Q.item.x,be.color=Q.item.color,be.alpha=Q.alpha,V[16][Q.key].nodeId===void 0&&V[16][Q.key].populate(be),v(()=>{V[16][Q.key].set("x",Q.item.x)},null)}};v(()=>{ge(o.collection2,a,ye)},"collection2"),v(()=>{o.alpha;for(let Se=0;Se<o.collection2.length;Se++){const V={};V.index=Se,V.item=o.collection2[Se],V.key=V.item.id,a[16][V.key].set("alpha",o.alpha)}}),r=a[0];const ie={};a[17]=this.element({parent:r||"root"},o),ie.y=720,a[17].populate(ie),r=a[17];const ee=[],de=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;){const ae=Ce[he];je.add(""+ae.id)}let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[18][ae]&&V[18][ae].destroy(),delete V[18][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[17],Q.index=ae,Q.item=Ce[ae],Q.key=""+Q.item.id,Ae.push(Q.key),r=V[17],V[18]===void 0&&(V[18]={});const be={};V[18][Q.key]===void 0&&(V[18][Q.key]=this.element({parent:r||"root"},o)),be.w=80,be.h=80,be.x=Q.item.x,be.color="0x06b6d4ff",V[18][Q.key].nodeId===void 0&&V[18][Q.key].populate(be),v(()=>{V[18][Q.key].set("x",Q.item.x)},null)}};v(()=>{de(o.collection4,a,ee)},"collection4"),r=a[0];const Ee={};a[19]=this.element({parent:r||"root"},o),Ee.y=720,Ee.x=700,a[19].populate(Ee),r=a[19];const Ie=[],ke=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;)Ce[he],je.add(""+he);let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[20][ae]&&V[20][ae].destroy(),delete V[20][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[19],Q.index=ae,Q.item=Ce[ae],Q.key=""+ae,Ae.push(Q.key),r=V[19],V[20]===void 0&&(V[20]={});const be={};V[20][Q.key]===void 0&&(V[20][Q.key]=this.element({parent:r||"root"},o)),be.w=80,be.h=80,be.x=Q.item.x,be.color="0x8b5cf6ff",V[20][Q.key].nodeId===void 0&&V[20][Q.key].populate(be),v(()=>{V[20][Q.key].set("x",Q.item.x)},null)}};v(()=>{ke(o.collection4,a,Ie)},"collection4"),r=a[0];const Le={};a[21]=this.element({parent:r||"root"},o),Le.y=920,a[21].populate(Le),r=a[21];const _e=[],De=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;){const ae=Ce[he];je.add(""+ae.id)}let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[22][ae]&&V[22][ae].destroy(),delete V[22][ae],V[23][ae]&&V[23][ae].destroy(),delete V[23][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[21],Q.index=ae,Q.item=Ce[ae],Q.key=""+Q.item.id,Ae.push(Q.key);const be=f.components&&f.components.Square||p.Square;V[22]===void 0&&(V[22]={});const st={};V[22][Q.key]===void 0&&(V[22][Q.key]=this.element({parent:r||"root"},o)),st.w=80,st.h=80,st.x=Q.item.x;const Xe=[];if(typeof be<"u")for(let Ke in be.config.props)delete st[be.config.props[Ke]],Xe.push(be.config.props[Ke]);V[22][Q.key].nodeId===void 0&&V[22][Q.key].populate(st),V[23]===void 0&&(V[23]={}),r=V[22][Q.key];const Fe={};if(V[23][Q.key]===void 0){Fe.w=80,Fe.h=80,Fe.x=Q.item.x,m=Fe.is||"Square";let Ke;if(typeof m=="string"){if(Ke=f.components&&f.components[m]||p[m],!Ke)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(Ke=m);V[23][Q.key]=Ke.call(null,{props:Fe},V[22][Q.key],o),V[23][Q.key][Symbol.for("slots")][0]?(r=V[23][Q.key][Symbol.for("slots")][0],o=V[23][Q.key]):r=V[23][Q.key][Symbol.for("children")][0]}v(()=>{(typeof Xe>"u"||Xe.indexOf("x")===-1)&&V[22][Q.key].set("x",Q.item.x)},null),V[23][Q.key][Symbol.for("props")].x=Q.item.x}};v(()=>{De(o.collection4,a,_e)},"collection4"),r=a[0];const $={};a[24]=this.element({parent:r||"root"},o),$.y=920,$.x=700,a[24].populate($),r=a[24];const Pe=[],He=(Se=[],V,Ae)=>{const Ce=S(Se),je=new Set;let he=Ce.length;for(;he--;)Ce[he],je.add(""+he);let Re=Ae.length;for(;Re--;)if(je.has(Ae[Re])===!1){const ae=Ae[Re];V[25][ae]&&V[25][ae].destroy(),delete V[25][ae],V[26][ae]&&V[26][ae].destroy(),delete V[26][ae]}Ae.length=0;const Ve=Ce.length;for(let ae=0;ae<Ve;ae++){const Q=Object.create(o);r=V[24],Q.index=ae,Q.item=Ce[ae],Q.key=""+ae,Ae.push(Q.key);const be=f.components&&f.components.Square||p.Square;V[25]===void 0&&(V[25]={});const st={};V[25][Q.key]===void 0&&(V[25][Q.key]=this.element({parent:r||"root"},o)),st.w=80,st.h=80,st.x=Q.item.x;const Xe=[];if(typeof be<"u")for(let Ke in be.config.props)delete st[be.config.props[Ke]],Xe.push(be.config.props[Ke]);V[25][Q.key].nodeId===void 0&&V[25][Q.key].populate(st),V[26]===void 0&&(V[26]={}),r=V[25][Q.key];const Fe={};if(V[26][Q.key]===void 0){Fe.w=80,Fe.h=80,Fe.x=Q.item.x,m=Fe.is||"Square";let Ke;if(typeof m=="string"){if(Ke=f.components&&f.components[m]||p[m],!Ke)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(Ke=m);V[26][Q.key]=Ke.call(null,{props:Fe},V[25][Q.key],o),V[26][Q.key][Symbol.for("slots")][0]?(r=V[26][Q.key][Symbol.for("slots")][0],o=V[26][Q.key]):r=V[26][Q.key][Symbol.for("children")][0]}v(()=>{(typeof Xe>"u"||Xe.indexOf("x")===-1)&&V[25][Q.key].set("x",Q.item.x)},null),V[26][Q.key][Symbol.for("props")].x=Q.item.x}};return v(()=>{He(o.collection4,a,Pe)},"collection4"),a},effects:[],context:{}},state(){return{collection1:[0,100,200,300,400,500],collection2:[{id:"block1",x:0,color:Si[0]},{id:"block2",x:100,color:Si[1]},{id:"block3",x:200,color:Si[2]},{id:"block4",x:300,color:Si[3]},{id:"block5",x:400,color:Si[4]},{id:"block6",x:500,color:Si[5]}],collection3:[],collection4:[{x:0,id:"one"},{x:200,id:"two"},{x:400,id:"three"}],alpha:.5}},hooks:{ready(){this.$setTimeout(()=>{this.collection2[0].color=Si[5],this.collection2[1].color=Si[4],this.collection2[2].color=Si[3],this.collection2[3].color=Si[2],this.collection2[4].color=Si[1],this.collection2[5].color=Si[0]},4e3);let h=0;const r=this.$setInterval(()=>{this.collection3.push({x:h*100,color:Si[h]}),h++,h===Si.length&&clearInterval(r)},1e3);this.$setInterval(()=>{this.alpha=this.alpha===.5?1:.5},800),this.$setTimeout(()=>{this.collection4=[{x:100,id:4},{x:500,id:5}]},2e3)}}}),TS=["pretty","large","big","small","tall","short","long","handsome","plain","quaint","clean","elegant","easy","angry","crazy","helpful","mushy","odd","unsightly","adorable","important","inexpensive","cheap","expensive","fancy"],CS=["red","yellow","blue","green","pink","brown","purple","brown","white","black","orange"],ES=["table","chair","house","bbq","desk","car","pony","cookie","sandwich","burger","pizza","mouse","keyboard"],H0=h=>Math.round(Math.random()*1e3)%h;let f5=0;const zl=()=>({id:f5++,text:`${TS[H0(TS.length)]} ${CS[H0(CS.length)]} ${ES[H0(ES.length)]}`}),c5=(h=1)=>{const r=[];for(let o=0;o<h;o++)r.push(zl());return r},h5=at.Component("LegendItem",{code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_);const I=f.components&&f.components.Circle||p.Circle;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o),M.color="0xfb923cff",M.size=60;const R=[];if(typeof I<"u")for(let H in I.config.props)delete M[I.config.props[H]],R.push(I.config.props[H]);a[1].populate(M),r=a[1];const U={};U.color="0xfb923cff",U.size=60,m=U.is||"Circle";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "Circle" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0],r=a[0];const L={};a[3]=this.element({parent:r||"root"},o),L.color="0xe5e5e5ff",L.size=32,L.y=10,L.wordwrap=57,L.align="center",L.content=""+o.id,L.__textnode=!0,a[3].populate(L),r=a[0];const j={};return a[4]=this.element({parent:r||"root"},o),j.color="0xe5e5e5ff",j.x=80,j.y=14,j.size=28,j.content=""+o.text,j.__textnode=!0,a[4].populate(j),a},effects:[],context:{}},props:["id","text"]}),mT=at.Component("Row",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.w=500,m.h=60,m.y=o.index*80,m.color="0xfff7edff",a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.w=10,_.h=60,_.color="0x06b6d4ff",a[1].populate(_),r=a[0];const I={};return a[2]=this.element({parent:r||"root"},o),I.content=o.text,I.x=30,I.y=10,I.font="opensans",I.color=o.activeRow==o.index?"0x06b6d4ff":"0x1e293bff",I.__textnode=!0,a[2].populate(I),a},effects:[function(r,o,f,p,v,S){o[0].set("y",r.index*80)},function(r,o,f,p,v,S){o[2].set("content",r.text)},function(r,o,f,p,v,S){o[2].set("color",r.activeRow==r.index?"0x06b6d4ff":"0x1e293bff")}],context:{}},props:["index","text","activeRow"]}),d5=at.Component("Row",{components:{Row:mT},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _=[],I=(M=[],R,U)=>{const x=S(M),L=new Set;let j=x.length;for(;j--;){const Z=x[j];L.add(""+Z.id+"key2")}let H=U.length;for(;H--;)if(L.has(U[H])===!1){const Z=U[H];R[0][Z]&&R[0][Z].destroy(),delete R[0][Z],R[1][Z]&&R[1][Z].destroy(),delete R[1][Z]}U.length=0;const Y=x.length;for(let Z=0;Z<Y;Z++){const X=Object.create(o);r=!1,X.index=Z,X.item=x[Z],X.key=""+X.item.id+"key2",U.push(X.key);const re=f.components&&f.components.Row||p.Row;R[0]===void 0&&(R[0]={});const le={};R[0][X.key]===void 0&&(R[0][X.key]=this.element({parent:r||"root"},o)),le.i=X.index,le.text=X.item.text,le.y=50;const se=[];if(typeof re<"u")for(let ce in re.config.props)delete le[re.config.props[ce]],se.push(re.config.props[ce]);R[0][X.key].nodeId===void 0&&R[0][X.key].populate(le),R[1]===void 0&&(R[1]={}),r=R[0][X.key];const W={};if(R[1][X.key]===void 0){W.i=X.index,W.text=X.item.text,W.y=50,m=W.is||"Row";let ce;if(typeof m=="string"){if(ce=f.components&&f.components[m]||p[m],!ce)throw new Error('Component "Row" not found')}else typeof m=="function"&&m.name==="factory"&&(ce=m);R[1][X.key]=ce.call(null,{props:W},R[0][X.key],o),R[1][X.key][Symbol.for("slots")][0]?(r=R[1][X.key][Symbol.for("slots")][0],o=R[1][X.key]):r=R[1][X.key][Symbol.for("children")][0]}v(()=>{(typeof se>"u"||se.indexOf("i")===-1)&&R[0][X.key].set("i",X.index)},"data"),R[1][X.key][Symbol.for("props")].i=X.index}};return v(()=>{I(o.data,a,_)},"data"),a},effects:[],context:{}},props:["data"]}),p5=at.Component("ForLoop",{components:{Square:da,LegendItem:h5,Row:mT,Rows:d5},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.x=100,I.y=60,I.size=48,I.content="Array operations test",I.__textnode=!0,a[1].populate(I),r=a[0];const M={};a[2]=this.element({parent:r||"root"},o),M.y=170,M.x=140,a[2].populate(M),r=a[2];const R={};a[3]=this.element({parent:r||"root"},o),R.x=-10,R.w=500,R.h=80,R.color="0x64748bff",R.y={transition:o.y},R.alpha={transition:!o.hide},a[3].populate(R);const U=f.components&&f.components.LegendItem||p.LegendItem;r=a[2];const x={};a[4]=this.element({parent:r||"root"},o),x.y=0,x.id="a",x.text="Fill array by assignment";const L=[];if(typeof U<"u")for(let ut in U.config.props)delete x[U.config.props[ut]],L.push(U.config.props[ut]);a[4].populate(x),r=a[4];const j={};j.y=0,j.id="a",j.text="Fill array by assignment",m=j.is||"LegendItem";let H;if(typeof m=="string"){if(H=f.components&&f.components[m]||p[m],!H)throw new Error('Component "LegendItem" not found')}else typeof m=="function"&&m.name==="factory"&&(H=m);a[5]=H.call(null,{props:j},a[4],o),a[5][Symbol.for("slots")][0]?(r=a[5][Symbol.for("slots")][0],o=a[5]):r=a[5][Symbol.for("children")][0];const Y=f.components&&f.components.LegendItem||p.LegendItem;r=a[2];const Z={};a[6]=this.element({parent:r||"root"},o),Z.y=90,Z.id="b",Z.text="Push new item to array";const X=[];if(typeof Y<"u")for(let ut in Y.config.props)delete Z[Y.config.props[ut]],X.push(Y.config.props[ut]);a[6].populate(Z),r=a[6];const re={};re.y=90,re.id="b",re.text="Push new item to array",m=re.is||"LegendItem";let le;if(typeof m=="string"){if(le=f.components&&f.components[m]||p[m],!le)throw new Error('Component "LegendItem" not found')}else typeof m=="function"&&m.name==="factory"&&(le=m);a[7]=le.call(null,{props:re},a[6],o),a[7][Symbol.for("slots")][0]?(r=a[7][Symbol.for("slots")][0],o=a[7]):r=a[7][Symbol.for("children")][0];const se=f.components&&f.components.LegendItem||p.LegendItem;r=a[2];const W={};a[8]=this.element({parent:r||"root"},o),W.y=180,W.id="c",W.text="Pop item from array";const ce=[];if(typeof se<"u")for(let ut in se.config.props)delete W[se.config.props[ut]],ce.push(se.config.props[ut]);a[8].populate(W),r=a[8];const E={};E.y=180,E.id="c",E.text="Pop item from array",m=E.is||"LegendItem";let F;if(typeof m=="string"){if(F=f.components&&f.components[m]||p[m],!F)throw new Error('Component "LegendItem" not found')}else typeof m=="function"&&m.name==="factory"&&(F=m);a[9]=F.call(null,{props:E},a[8],o),a[9][Symbol.for("slots")][0]?(r=a[9][Symbol.for("slots")][0],o=a[9]):r=a[9][Symbol.for("children")][0];const ue=f.components&&f.components.LegendItem||p.LegendItem;r=a[2];const ye={};a[10]=this.element({parent:r||"root"},o),ye.y=270,ye.id="d",ye.text="Shift item from array";const ge=[];if(typeof ue<"u")for(let ut in ue.config.props)delete ye[ue.config.props[ut]],ge.push(ue.config.props[ut]);a[10].populate(ye),r=a[10];const ie={};ie.y=270,ie.id="d",ie.text="Shift item from array",m=ie.is||"LegendItem";let ee;if(typeof m=="string"){if(ee=f.components&&f.components[m]||p[m],!ee)throw new Error('Component "LegendItem" not found')}else typeof m=="function"&&m.name==="factory"&&(ee=m);a[11]=ee.call(null,{props:ie},a[10],o),a[11][Symbol.for("slots")][0]?(r=a[11][Symbol.for("slots")][0],o=a[11]):r=a[11][Symbol.for("children")][0];const de=f.components&&f.components.LegendItem||p.LegendItem;r=a[2];const Ee={};a[12]=this.element({parent:r||"root"},o),Ee.y=360,Ee.id="e",Ee.text="Splice 2 items from array";const Ie=[];if(typeof de<"u")for(let ut in de.config.props)delete Ee[de.config.props[ut]],Ie.push(de.config.props[ut]);a[12].populate(Ee),r=a[12];const ke={};ke.y=360,ke.id="e",ke.text="Splice 2 items from array",m=ke.is||"LegendItem";let Le;if(typeof m=="string"){if(Le=f.components&&f.components[m]||p[m],!Le)throw new Error('Component "LegendItem" not found')}else typeof m=="function"&&m.name==="factory"&&(Le=m);a[13]=Le.call(null,{props:ke},a[12],o),a[13][Symbol.for("slots")][0]?(r=a[13][Symbol.for("slots")][0],o=a[13]):r=a[13][Symbol.for("children")][0];const _e=f.components&&f.components.LegendItem||p.LegendItem;r=a[2];const De={};a[14]=this.element({parent:r||"root"},o),De.y=450,De.id="f",De.text="Unshift 2 items into array";const $=[];if(typeof _e<"u")for(let ut in _e.config.props)delete De[_e.config.props[ut]],$.push(_e.config.props[ut]);a[14].populate(De),r=a[14];const Pe={};Pe.y=450,Pe.id="f",Pe.text="Unshift 2 items into array",m=Pe.is||"LegendItem";let He;if(typeof m=="string"){if(He=f.components&&f.components[m]||p[m],!He)throw new Error('Component "LegendItem" not found')}else typeof m=="function"&&m.name==="factory"&&(He=m);a[15]=He.call(null,{props:Pe},a[14],o),a[15][Symbol.for("slots")][0]?(r=a[15][Symbol.for("slots")][0],o=a[15]):r=a[15][Symbol.for("children")][0];const Se=f.components&&f.components.LegendItem||p.LegendItem;r=a[2];const V={};a[16]=this.element({parent:r||"root"},o),V.y=540,V.id="g",V.text="Empty array by assignment";const Ae=[];if(typeof Se<"u")for(let ut in Se.config.props)delete V[Se.config.props[ut]],Ae.push(Se.config.props[ut]);a[16].populate(V),r=a[16];const Ce={};Ce.y=540,Ce.id="g",Ce.text="Empty array by assignment",m=Ce.is||"LegendItem";let je;if(typeof m=="string"){if(je=f.components&&f.components[m]||p[m],!je)throw new Error('Component "LegendItem" not found')}else typeof m=="function"&&m.name==="factory"&&(je=m);a[17]=je.call(null,{props:Ce},a[16],o),a[17][Symbol.for("slots")][0]?(r=a[17][Symbol.for("slots")][0],o=a[17]):r=a[17][Symbol.for("children")][0];const he=f.components&&f.components.LegendItem||p.LegendItem;r=a[2];const Re={};a[18]=this.element({parent:r||"root"},o),Re.y=630,Re.id="h",Re.text="Concat an array with items";const Ve=[];if(typeof he<"u")for(let ut in he.config.props)delete Re[he.config.props[ut]],Ve.push(he.config.props[ut]);a[18].populate(Re),r=a[18];const ae={};ae.y=630,ae.id="h",ae.text="Concat an array with items",m=ae.is||"LegendItem";let Q;if(typeof m=="string"){if(Q=f.components&&f.components[m]||p[m],!Q)throw new Error('Component "LegendItem" not found')}else typeof m=="function"&&m.name==="factory"&&(Q=m);a[19]=Q.call(null,{props:ae},a[18],o),a[19][Symbol.for("slots")][0]?(r=a[19][Symbol.for("slots")][0],o=a[19]):r=a[19][Symbol.for("children")][0];const be=f.components&&f.components.LegendItem||p.LegendItem;r=a[2];const st={};a[20]=this.element({parent:r||"root"},o),st.y=720,st.id="i",st.text="Sort array alphabetically";const Xe=[];if(typeof be<"u")for(let ut in be.config.props)delete st[be.config.props[ut]],Xe.push(be.config.props[ut]);a[20].populate(st),r=a[20];const Fe={};Fe.y=720,Fe.id="i",Fe.text="Sort array alphabetically",m=Fe.is||"LegendItem";let Ke;if(typeof m=="string"){if(Ke=f.components&&f.components[m]||p[m],!Ke)throw new Error('Component "LegendItem" not found')}else typeof m=="function"&&m.name==="factory"&&(Ke=m);a[21]=Ke.call(null,{props:Fe},a[20],o),a[21][Symbol.for("slots")][0]?(r=a[21][Symbol.for("slots")][0],o=a[21]):r=a[21][Symbol.for("children")][0],r=a[2];const kt={};a[22]=this.element({parent:r||"root"},o),kt.y=840,a[22].populate(kt),r=a[22];const qt={};a[23]=this.element({parent:r||"root"},o),qt.size=26,qt.y=10,qt.content="Array length:",qt.__textnode=!0,a[23].populate(qt),r=a[22];const $t={};a[24]=this.element({parent:r||"root"},o),$t.content=o.data.length,$t.size=40,$t.x=180,$t.color="0xfb923cff",$t.__textnode=!0,a[24].populate($t),r=a[0];const We={};a[25]=this.element({parent:r||"root"},o),We.x=740,We.y=100,a[25].populate(We),r=a[25];const Sn={};a[26]=this.element({parent:r||"root"},o),Sn.content="For loop on Element",Sn.__textnode=!0,a[26].populate(Sn),r=a[25];const lt=[],zr=(ut=[],Be,vn)=>{const vt=S(ut),Bn=new Set;let mo=vt.length;for(;mo--;){const bt=vt[mo];Bn.add(""+bt.id+"key")}let Tn=vn.length;for(;Tn--;)if(Bn.has(vn[Tn])===!1){const bt=vn[Tn];Be[27][bt]&&Be[27][bt].destroy(),delete Be[27][bt],Be[28][bt]&&Be[28][bt].destroy(),delete Be[28][bt],Be[29][bt]&&Be[29][bt].destroy(),delete Be[29][bt]}vn.length=0;const fi=vt.length;for(let bt=0;bt<fi;bt++){const qe=Object.create(o);r=Be[25],qe.index=bt,qe.item=vt[bt],qe.key=""+qe.item.id+"key",vn.push(qe.key),r=Be[25],Be[27]===void 0&&(Be[27]={});const Zt={};Be[27][qe.key]===void 0&&(Be[27][qe.key]=this.element({parent:r||"root"},o)),Zt.w=500,Zt.h=60,Zt.y=qe.index*80+50,Zt.color="0xfff7edff",Be[27][qe.key].nodeId===void 0&&Be[27][qe.key].populate(Zt),r=Be[27][qe.key],Be[28]===void 0&&(Be[28]={});const Rn={};Be[28][qe.key]===void 0&&(Be[28][qe.key]=this.element({parent:r||"root"},o)),Rn.w=10,Rn.h=60,Rn.color="0xfb923cff",Be[28][qe.key].nodeId===void 0&&Be[28][qe.key].populate(Rn),r=Be[27][qe.key],Be[29]===void 0&&(Be[29]={});const Pt={};Be[29][qe.key]===void 0&&(Be[29][qe.key]=this.element({parent:r||"root"},o)),Pt.content=qe.item.text,Pt.x=30,Pt.y=10,Pt.font="opensans",Pt.color=qe.activeRowIndex===qe.index?"0x06b6d4ff":"0x1e293bff",Pt.__textnode=!0,Be[29][qe.key].nodeId===void 0&&Be[29][qe.key].populate(Pt),v(()=>{Be[27][qe.key].set("y",qe.index*80+50)},"data"),v(()=>{Be[29][qe.key].set("content",qe.item.text)},null)}};v(()=>{zr(o.data,a,lt)},"data"),v(()=>{o.activeRowIndex;for(let ut=0;ut<o.data.length;ut++){const Be={};Be.index=ut,Be.item=o.data[ut],Be.key=Be.item.id+"key",a[29][Be.key].set("color",o.activeRowIndex===Be.index?"0x06b6d4ff":"0x1e293bff")}}),r=a[0];const ui={};a[30]=this.element({parent:r||"root"},o),ui.x=1280,ui.y=100,a[30].populate(ui),r=a[30];const oo={};a[31]=this.element({parent:r||"root"},o),oo.content="For loop on Component",oo.__textnode=!0,a[31].populate(oo),r=a[30];const go=[],Lt=(ut=[],Be,vn)=>{const vt=S(ut),Bn=new Set;let mo=vt.length;for(;mo--;){const bt=vt[mo];Bn.add(""+bt.id+"key2")}let Tn=vn.length;for(;Tn--;)if(Bn.has(vn[Tn])===!1){const bt=vn[Tn];Be[32][bt]&&Be[32][bt].destroy(),delete Be[32][bt],Be[33][bt]&&Be[33][bt].destroy(),delete Be[33][bt]}vn.length=0;const fi=vt.length;for(let bt=0;bt<fi;bt++){const qe=Object.create(o);r=Be[30],qe.index=bt,qe.item=vt[bt],qe.key=""+qe.item.id+"key2",vn.push(qe.key);const Zt=f.components&&f.components.Row||p.Row;Be[32]===void 0&&(Be[32]={});const Rn={};Be[32][qe.key]===void 0&&(Be[32][qe.key]=this.element({parent:r||"root"},o)),Rn.activeRow=(qe.count>0,qe.activeRowIndex),Rn.index=qe.index,Rn.text=qe.item.text,Rn.y=50;const Pt=[];if(typeof Zt<"u")for(let ci in Zt.config.props)delete Rn[Zt.config.props[ci]],Pt.push(Zt.config.props[ci]);Be[32][qe.key].nodeId===void 0&&Be[32][qe.key].populate(Rn),Be[33]===void 0&&(Be[33]={}),r=Be[32][qe.key];const Ze={};if(Be[33][qe.key]===void 0){Ze.activeRow=(qe.count>0,qe.activeRowIndex),Ze.index=qe.index,Ze.text=qe.item.text,Ze.y=50,m=Ze.is||"Row";let ci;if(typeof m=="string"){if(ci=f.components&&f.components[m]||p[m],!ci)throw new Error('Component "Row" not found')}else typeof m=="function"&&m.name==="factory"&&(ci=m);Be[33][qe.key]=ci.call(null,{props:Ze},Be[32][qe.key],o),Be[33][qe.key][Symbol.for("slots")][0]?(r=Be[33][qe.key][Symbol.for("slots")][0],o=Be[33][qe.key]):r=Be[33][qe.key][Symbol.for("children")][0]}v(()=>{(typeof Pt>"u"||Pt.indexOf("index")===-1)&&Be[32][qe.key].set("index",qe.index)},"data"),v(()=>{(typeof Pt>"u"||Pt.indexOf("text")===-1)&&Be[32][qe.key].set("text",qe.item.text)},null),Be[33][qe.key][Symbol.for("props")].index=qe.index,Be[33][qe.key][Symbol.for("props")].text=qe.item.text}};return v(()=>{Lt(o.data,a,go)},"data"),v(()=>{o.activeRowIndex,o.count;for(let ut=0;ut<o.data.length;ut++){const Be={};Be.index=ut,Be.item=o.data[ut],Be.key=Be.item.id+"key2",(typeof skip32>"u"||skip32.indexOf("activeRow")===-1)&&a[32][Be.key].set("activeRow",(o.count>0,o.activeRowIndex))}}),v(()=>{o.activeRowIndex,o.count;for(let ut=0;ut<o.data.length;ut++){const Be={};Be.index=ut,Be.item=o.data[ut],Be.key=Be.item.id+"key2",a[33][Be.key][Symbol.for("props")].activeRow=(o.count>0,o.activeRowIndex)}}),a},effects:[function(r,o,f,p,v,S){o[3].set("y",{transition:r.y})},function(r,o,f,p,v,S){o[3].set("alpha",{transition:!r.hide})},function(r,o,f,p,v,S){o[24].set("content",r.data.length)}],context:{}},state(){return{count:0,data:[],x:0,y:0,timeout:null,hide:!0,sortDirection:1,activeRowIndex:0}},computed:{show(){return this.hide===!0},data2(){return this.data}},watch:{y(){this.hide=!1,this.$clearTimeout(this.timeout),this.timeout=this.$setTimeout(()=>{this.hide=!0},600)}},input:{a(){this.y=-10,this.$trigger("y");const h=[];for(let r=0;r<6;r++)h.push(zl());this.data=h},b(){this.y=80,this.$trigger("y"),this.data.push(zl())},c(){this.y=170,this.$trigger("y"),this.data.pop()},d(){this.y=260,this.$trigger("y"),this.data.shift()},e(){this.y=350,this.$trigger("y"),this.data.splice(2,4)},f(){this.y=440,this.data.unshift(zl(),zl())},g(){this.y=530,this.$trigger("y"),this.data=[]},h(){this.y=620,this.$trigger("y"),this.data=this.data.concat(c5(3))},i(){this.y=710,this.$trigger("y"),this.sortDirection=this.sortDirection===1?0:1,this.data=this.data.sort((h,r)=>{const o=h.text.toLowerCase(),f=r.text.toLowerCase();return this.sortDirection===1?o<f?-1:o>f?1:0:o>f?-1:o<f?1:0})},up(){this.activeRowIndex>0&&(this.activeRowIndex-=1)},down(){this.activeRowIndex<this.data.length-1&&(this.activeRowIndex+=1)}}}),g5=at.Component("Effects",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.w=160,_.h=160,_.x=40,_.y=40,_.color="0xfb923cff",_.effects=[o.shader("radius",{radius:44})],a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.w=160,I.h=160,I.x=240,I.y=40,I.color="0xd97706ff",I.effects=[o.shader("radius",{radius:25})],a[2].populate(I),r=a[0];const M={};a[3]=this.element({parent:r||"root"},o),M.w=160,M.h=160,M.x=440,M.y=40,M.color="0xb45309ff",M.effects=[o.shader("radius",{radius:80})],a[3].populate(M),r=a[0];const R={};a[4]=this.element({parent:r||"root"},o),R.w=160,R.h=160,R.x=640,R.y=40,R.color="0x78350fff",R.effects=[o.shader("radius",{radius:10})],a[4].populate(R),r=a[0];const U={};a[5]=this.element({parent:r||"root"},o),U.w=160,U.h=160,U.x=40,U.y=240,U.color="0x65a30dff",U.effects=[o.shader("radius",{radius:o.radius})],a[5].populate(U),r=a[0];const x={};a[6]=this.element({parent:r||"root"},o),x.w=300,x.h=300,x.x=40,x.y=440,x.color="0x0c4a6eff",x.effects=[o.shader("radius",{radius:30})],a[6].populate(x),r=a[6];const L={};a[7]=this.element({parent:r||"root"},o),L.w=200,L.h=200,L.x=50,L.y=50,L.color="0x0284c7ff",L.effects=[o.shader("radius",{radius:40})],a[7].populate(L),r=a[7];const j={};a[8]=this.element({parent:r||"root"},o),j.w=100,j.h=100,j.x=50,j.y=50,j.color="0x38bdf8ff",j.effects=[o.shader("radius",{radius:50})],a[8].populate(j),r=a[8];const H={};a[9]=this.element({parent:r||"root"},o),H.w=40,H.h=40,H.x=30,H.y=30,H.color="0xbae6fdff",H.effects=[o.shader("radius",{radius:20})],a[9].populate(H),r=a[0];const Y={};a[10]=this.element({parent:r||"root"},o),Y.w=160,Y.h=160,Y.x=840,Y.y=40,Y.color="0x3b82f6ff",Y.effects=[o.shader("radius",{radius:10}),o.shader("border",{width:20,color:"0x60a5faff"})],a[10].populate(Y),r=a[0];const Z={};return a[11]=this.element({parent:r||"root"},o),Z.w=160,Z.h=160,Z.x=1040,Z.y=40,Z.color="0x500724ff",Z.effects=o.effects,a[11].populate(Z),a},effects:[function(r,o,f,p,v,S){o[1].set("effects",[r.shader("radius",{radius:44})])},function(r,o,f,p,v,S){o[2].set("effects",[r.shader("radius",{radius:25})])},function(r,o,f,p,v,S){o[3].set("effects",[r.shader("radius",{radius:80})])},function(r,o,f,p,v,S){o[4].set("effects",[r.shader("radius",{radius:10})])},function(r,o,f,p,v,S){o[5].set("effects",[r.shader("radius",{radius:r.radius})])},function(r,o,f,p,v,S){o[6].set("effects",[r.shader("radius",{radius:30})])},function(r,o,f,p,v,S){o[7].set("effects",[r.shader("radius",{radius:40})])},function(r,o,f,p,v,S){o[8].set("effects",[r.shader("radius",{radius:50})])},function(r,o,f,p,v,S){o[9].set("effects",[r.shader("radius",{radius:20})])},function(r,o,f,p,v,S){o[10].set("effects",[r.shader("radius",{radius:10}),r.shader("border",{width:20,color:"0x60a5faff"})])},function(r,o,f,p,v,S){o[11].set("effects",r.effects)}],context:{}},state(){return{direction:"up",radius:0,effects:[this.shader("borderTop",{width:20,color:"#be123c"}),this.shader("borderBottom",{width:20,color:"#f43f5e"})]}},hooks:{ready(){this.$setInterval(()=>{const r=this.direction==="up"?this.radius+10:this.radius-10;this.radius=Math.max(Math.min(r,80),0),this.radius===80&&(this.direction="down"),this.radius===0&&(this.direction="up")},500);let h=0;this.$setInterval(()=>{h++,h%2?this.effects=[this.shader("borderLeft",{width:20,color:"#be123c"}),this.shader("borderRight",{width:20,color:"#f43f5e"})]:this.effects=[this.shader("borderTop",{width:20,color:"#be123c"}),this.shader("borderBottom",{width:20,color:"#f43f5e"})]},2e3)}}}),m5=at.Component("ShowIf",{components:{Square:da},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.y=40,a[1].populate(I),r=a[1];const M={};a[2]=this.element({parent:r||"root"},o),M.x=50,M.w=200,M.h=300,M.color="0xbef264ff",M.show=!0,a[2].populate(M),r=a[1];const R={};a[3]=this.element({parent:r||"root"},o),R.x=350,R.w=200,R.h=300,R.color="0xff0000ff",R.show=!1,a[3].populate(R),r=a[1];const U={};a[4]=this.element({parent:r||"root"},o),U.x=650,U.w=200,U.h=300,U.color="0x84cc16ff",U.show=1,a[4].populate(U),r=a[1];const x={};a[5]=this.element({parent:r||"root"},o),x.x=950,x.w=200,x.h=300,x.color="0xff0000ff",x.show=0,a[5].populate(x),r=a[0];const L={};a[6]=this.element({parent:r||"root"},o),L.y=380,a[6].populate(L),r=a[6];const j={};a[7]=this.element({parent:r||"root"},o),j.x=50,j.w=200,j.h=300,j.color="0xfde047ff",j.show=o.showNr,a[7].populate(j),r=a[6];const H={};a[8]=this.element({parent:r||"root"},o),H.x=350,H.w=200,H.h=300,H.color="0x0000ffff",H.show=o.hideNr,a[8].populate(H),r=a[6];const Y={};a[9]=this.element({parent:r||"root"},o),Y.x=650,Y.w=200,Y.h=300,Y.color="0x84cc16ff",Y.show=o.showBool,a[9].populate(Y),r=a[6];const Z={};a[10]=this.element({parent:r||"root"},o),Z.x=950,Z.w=200,Z.h=300,Z.color="0xff0000ff",Z.show=o.hideBool,a[10].populate(Z),r=a[0];const X={};a[11]=this.element({parent:r||"root"},o),X.y=720,a[11].populate(X),r=a[11];const re={};a[12]=this.element({parent:r||"root"},o),re.x=50,re.w=200,re.h=300,re.color="0x5eead4ff",re.show=o.showHideToggle,a[12].populate(re),r=a[0];const le={};a[13]=this.element({parent:r||"root"},o),le.y=40,le.x=1e3,a[13].populate(le);const se=f.components&&f.components.Square||p.Square;r=a[13];const W={};a[14]=this.element({parent:r||"root"},o),W.show=!0;const ce=[];if(typeof se<"u")for(let _e in se.config.props)delete W[se.config.props[_e]],ce.push(se.config.props[_e]);a[14].populate(W),r=a[14];const E={};E.show=!0,m=E.is||"Square";let F;if(typeof m=="string"){if(F=f.components&&f.components[m]||p[m],!F)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(F=m);a[15]=F.call(null,{props:E},a[14],o),a[15][Symbol.for("slots")][0]?(r=a[15][Symbol.for("slots")][0],o=a[15]):r=a[15][Symbol.for("children")][0];const ue=f.components&&f.components.Square||p.Square;r=a[13];const ye={};a[16]=this.element({parent:r||"root"},o),ye.y=100,ye.show=!1;const ge=[];if(typeof ue<"u")for(let _e in ue.config.props)delete ye[ue.config.props[_e]],ge.push(ue.config.props[_e]);a[16].populate(ye),r=a[16];const ie={};ie.y=100,ie.show=!1,m=ie.is||"Square";let ee;if(typeof m=="string"){if(ee=f.components&&f.components[m]||p[m],!ee)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(ee=m);a[17]=ee.call(null,{props:ie},a[16],o),a[17][Symbol.for("slots")][0]?(r=a[17][Symbol.for("slots")][0],o=a[17]):r=a[17][Symbol.for("children")][0];const de=f.components&&f.components.Square||p.Square;r=a[13];const Ee={};a[18]=this.element({parent:r||"root"},o),Ee.y=200,Ee.show=o.showHideToggle;const Ie=[];if(typeof de<"u")for(let _e in de.config.props)delete Ee[de.config.props[_e]],Ie.push(de.config.props[_e]);a[18].populate(Ee),r=a[18];const ke={};ke.y=200,ke.show=o.showHideToggle,m=ke.is||"Square";let Le;if(typeof m=="string"){if(Le=f.components&&f.components[m]||p[m],!Le)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(Le=m);return a[19]=Le.call(null,{props:ke},a[18],o),a[19][Symbol.for("slots")][0]?(r=a[19][Symbol.for("slots")][0],o=a[19]):r=a[19][Symbol.for("children")][0],a},effects:[function(r,o,f,p,v,S){o[12].set("show",r.showHideToggle)},function(r,o,f,p,v,S){(typeof skip18>"u"||skip18.indexOf("show")===-1)&&o[18].set("show",r.showHideToggle)},function(r,o,f,p,v,S){o[19][Symbol.for("props")].show=r.showHideToggle}],context:{}},state(){return{showNr:1,hideNr:0,showBool:!0,hideBool:!1,showHideToggle:!0}},hooks:{ready(){this.$setInterval(()=>{console.log("backstopjs:ready"),this.showHideToggle=!this.showHideToggle},2e3),this.$setTimeout(()=>{this.showNr=0,this.hideNr=1,this.showBool=!1,this.hideBool=!0},4e3)}}}),y5=at.Component("Events",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.x=400,m.y=360,a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.w=280,_.h=280,_.color="0xe5e7ebff",_.x=o.x,_.y=-5,a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.w=250,I.h=250,I.x=10,I.y=10,I.color=o.colors[0],a[2].populate(I),r=a[0];const M={};a[3]=this.element({parent:r||"root"},o),M.w=250,M.h=250,M.x=290,M.y=10,M.color=o.colors[1],a[3].populate(M),r=a[0];const R={};a[4]=this.element({parent:r||"root"},o),R.w=250,R.h=250,R.x=570,R.y=10,R.color=o.colors[2],a[4].populate(R),r=a[0];const U={};return a[5]=this.element({parent:r||"root"},o),U.w=250,U.h=250,U.x=850,U.y=10,U.color=o.colors[3],a[5].populate(U),a},effects:[function(r,o,f,p,v,S){o[1].set("x",r.x)}],context:{}},state(){return{count:0,colors:["#fbbf24","#a3e635","#22d3ee","#f472b6"]}},computed:{x(){return this.count*280-5}},hooks:{unfocus(){this.$emit("changeBackground")}},input:{left(h){const r=this.count-1;r===-1?this.parent.$focus(h):this.count=Math.max(r,0)},right(h){const r=this.count+1;r===4?this.parent.$focus(h):this.count=Math.min(r,3)},enter(){this.$emit("changeBackground",this.colors[this.count])}}}),v5=at.Component("SlotCard",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.w=300,m.h=500,m.effects=[o.shader("radius",{radius:20}),o.shader("border",{width:6,color:"0xe2e8f0ff"})],m.color="{top: '0x94a3b8ff', bottom: '0x475569ff'}",a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_[Symbol.for("isSlot")]=!0,_.x=20,_.y=20,a[1].populate(_),r=a[0];const I={};return a[2]=this.element({parent:r||"root"},o),I.content=o.label,I.wordwrap=260,I.x=20,I.y=400,I.align="center",I.__textnode=!0,a[2].populate(I),a},effects:[function(r,o,f,p,v,S){o[0].set("effects",[r.shader("radius",{radius:20}),r.shader("border",{width:6,color:"0xe2e8f0ff"})])}],context:{}},props:[{key:"label"}]}),x5=at.Component("NamedSlotCard",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.w=700,m.h=300,m.effects=[o.shader("radius",{radius:20}),o.shader("border",{width:6,color:"0xe2e8f0ff"})],m.color="{top: '0x94a3b8ff', bottom: '0x475569ff'}",a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.x=20,_.y=20,a[1].populate(_),r=a[1];const I={};a[2]=this.element({parent:r||"root"},o),I.content="First slot",I.__textnode=!0,a[2].populate(I),r=a[1];const M={};a[3]=this.element({parent:r||"root"},o),M[Symbol.for("isSlot")]=!0,M.y=40,M.ref="first",a[3].populate(M),r=a[0];const R={};a[4]=this.element({parent:r||"root"},o),R.x=200,R.y=20,a[4].populate(R),r=a[4];const U={};a[5]=this.element({parent:r||"root"},o),U.content="Second slot",U.__textnode=!0,a[5].populate(U),r=a[4];const x={};a[6]=this.element({parent:r||"root"},o),x[Symbol.for("isSlot")]=!0,x.y=40,x.ref="second",a[6].populate(x),r=a[0];const L={};a[7]=this.element({parent:r||"root"},o),L.x=480,L.y=20,a[7].populate(L),r=a[7];const j={};a[8]=this.element({parent:r||"root"},o),j.content="Third slot",j.__textnode=!0,a[8].populate(j),r=a[7];const H={};return a[9]=this.element({parent:r||"root"},o),H[Symbol.for("isSlot")]=!0,H.y=40,H.ref="third",a[9].populate(H),a},effects:[function(r,o,f,p,v,S){o[0].set("effects",[r.shader("radius",{radius:20}),r.shader("border",{width:6,color:"0xe2e8f0ff"})])}],context:{}}}),Bl=["#fff7ed","#fdba74","#f97316","#ea580c","#9a3412","#431407"],w5=at.Component("Components",{components:{SlotCard:v5,NamedSlotCard:x5,Card:gT,Square:da},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_);const I=f.components&&f.components.SlotCard||p.SlotCard;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o),M.x=400,M.y=100,M.label="Element";const R=[];if(typeof I<"u")for(let We in I.config.props)delete M[I.config.props[We]],R.push(I.config.props[We]);a[1].populate(M),r=a[1];const U={};U.x=400,U.y=100,U.label="Element",m=U.is||"SlotCard";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "SlotCard" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0];const L={};a[3]=this.element({parent:r||"root"},o),a[3].populate(L),r=a[3];const j={};a[4]=this.element({parent:r||"root"},o),j.color=o.color,j.w=100,j.h=100,a[4].populate(j);const H=f.components&&f.components.SlotCard||p.SlotCard;r=a[0];const Y={};a[5]=this.element({parent:r||"root"},o),Y.x=800,Y.y=100,Y.label="Component";const Z=[];if(typeof H<"u")for(let We in H.config.props)delete Y[H.config.props[We]],Z.push(H.config.props[We]);a[5].populate(Y),r=a[5];const X={};X.x=800,X.y=100,X.label="Component",m=X.is||"SlotCard";let re;if(typeof m=="string"){if(re=f.components&&f.components[m]||p[m],!re)throw new Error('Component "SlotCard" not found')}else typeof m=="function"&&m.name==="factory"&&(re=m);a[6]=re.call(null,{props:X},a[5],o),a[6][Symbol.for("slots")][0]?(r=a[6][Symbol.for("slots")][0],o=a[6]):r=a[6][Symbol.for("children")][0];const le={};a[7]=this.element({parent:r||"root"},o),a[7].populate(le);const se=f.components&&f.components.Square||p.Square;r=a[7];const W={};a[8]=this.element({parent:r||"root"},o),W.size=200,W.y=50;const ce=[];if(typeof se<"u")for(let We in se.config.props)delete W[se.config.props[We]],ce.push(se.config.props[We]);a[8].populate(W),r=a[8];const E={};E.size=200,E.y=50,m=E.is||"Square";let F;if(typeof m=="string"){if(F=f.components&&f.components[m]||p[m],!F)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(F=m);a[9]=F.call(null,{props:E},a[8],o),a[9][Symbol.for("slots")][0]?(r=a[9][Symbol.for("slots")][0],o=a[9]):r=a[9][Symbol.for("children")][0];const ue=f.components&&f.components.SlotCard||p.SlotCard;r=a[0];const ye={};a[10]=this.element({parent:r||"root"},o),ye.x=1200,ye.y=100,ye.label="Element & Component";const ge=[];if(typeof ue<"u")for(let We in ue.config.props)delete ye[ue.config.props[We]],ge.push(ue.config.props[We]);a[10].populate(ye),r=a[10];const ie={};ie.x=1200,ie.y=100,ie.label="Element & Component",m=ie.is||"SlotCard";let ee;if(typeof m=="string"){if(ee=f.components&&f.components[m]||p[m],!ee)throw new Error('Component "SlotCard" not found')}else typeof m=="function"&&m.name==="factory"&&(ee=m);a[11]=ee.call(null,{props:ie},a[10],o),a[11][Symbol.for("slots")][0]?(r=a[11][Symbol.for("slots")][0],o=a[11]):r=a[11][Symbol.for("children")][0];const de={};a[12]=this.element({parent:r||"root"},o),a[12].populate(de),r=a[12];const Ee={};a[13]=this.element({parent:r||"root"},o),Ee.color=o.color,Ee.w=100,Ee.h=100,a[13].populate(Ee);const Ie=f.components&&f.components.Square||p.Square;r=a[12];const ke={};a[14]=this.element({parent:r||"root"},o),ke.size=200,ke.y=150;const Le=[];if(typeof Ie<"u")for(let We in Ie.config.props)delete ke[Ie.config.props[We]],Le.push(Ie.config.props[We]);a[14].populate(ke),r=a[14];const _e={};_e.size=200,_e.y=150,m=_e.is||"Square";let De;if(typeof m=="string"){if(De=f.components&&f.components[m]||p[m],!De)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(De=m);a[15]=De.call(null,{props:_e},a[14],o),a[15][Symbol.for("slots")][0]?(r=a[15][Symbol.for("slots")][0],o=a[15]):r=a[15][Symbol.for("children")][0];const $=f.components&&f.components.Card||p.Card;r=a[0];const Pe={};a[16]=this.element({parent:r||"root"},o),Pe.x=400,Pe.y=700,Pe.size="small";const He=[];if(typeof $<"u")for(let We in $.config.props)delete Pe[$.config.props[We]],He.push($.config.props[We]);a[16].populate(Pe),r=a[16];const Se={};Se.x=400,Se.y=700,Se.size="small",m=Se.is||"Card";let V;if(typeof m=="string"){if(V=f.components&&f.components[m]||p[m],!V)throw new Error('Component "Card" not found')}else typeof m=="function"&&m.name==="factory"&&(V=m);a[17]=V.call(null,{props:Se},a[16],o),a[17][Symbol.for("slots")][0]?(r=a[17][Symbol.for("slots")][0],o=a[17]):r=a[17][Symbol.for("children")][0];const Ae={};a[18]=this.element({parent:r||"root"},o),a[18].populate(Ae),r=a[18];const Ce={};a[19]=this.element({parent:r||"root"},o),Ce.color=o.color,Ce.w=100,Ce.h=100,a[19].populate(Ce);const je=f.components&&f.components.NamedSlotCard||p.NamedSlotCard;r=a[0];const he={};a[20]=this.element({parent:r||"root"},o),he.x=800,he.y=700;const Re=[];if(typeof je<"u")for(let We in je.config.props)delete he[je.config.props[We]],Re.push(je.config.props[We]);a[20].populate(he),r=a[20];const Ve={};Ve.x=800,Ve.y=700,m=Ve.is||"NamedSlotCard";let ae;if(typeof m=="string"){if(ae=f.components&&f.components[m]||p[m],!ae)throw new Error('Component "NamedSlotCard" not found')}else typeof m=="function"&&m.name==="factory"&&(ae=m);a[21]=ae.call(null,{props:Ve},a[20],o),a[21][Symbol.for("slots")][0]?(r=a[21][Symbol.for("slots")][0],o=a[21]):r=a[21][Symbol.for("children")][0];const Q={};a[22]=this.element({parent:r||"root"},o),a[22].populate(Q),r=a[22];const be={};a[23]=this.element({parent:r||"root"},o),be.color="0x0891b2ff",be.x=10,be.y=140,be.w=80,be.h=60,be.parent=o[Symbol.for("slots")].filter(We=>We.ref==="second").shift()||o[Symbol.for("slots")][0]||r,be.slot="second",a[23].populate(be),r=a[22];const st={};a[24]=this.element({parent:r||"root"},o),st.color=o.color,st.w=100,st.h=100,st.parent=o[Symbol.for("slots")].filter(We=>We.ref==="third").shift()||o[Symbol.for("slots")][0]||r,st.slot="third",a[24].populate(st);const Xe=f.components&&f.components.Square||p.Square;r=a[22];const Fe={};a[25]=this.element({parent:r||"root"},o),Fe.size=100,Fe.parent=o[Symbol.for("slots")].filter(We=>We.ref==="first").shift()||o[Symbol.for("slots")][0]||r,Fe.slot="first";const Ke=[];if(typeof Xe<"u")for(let We in Xe.config.props)delete Fe[Xe.config.props[We]],Ke.push(Xe.config.props[We]);a[25].populate(Fe),r=a[25];const kt={};kt.size=100,kt.slot="first",m=kt.is||"Square";let qt;if(typeof m=="string"){if(qt=f.components&&f.components[m]||p[m],!qt)throw new Error('Component "Square" not found')}else typeof m=="function"&&m.name==="factory"&&(qt=m);a[26]=qt.call(null,{props:kt},a[25],o),a[26][Symbol.for("slots")][0]?(r=a[26][Symbol.for("slots")][0],o=a[26]):r=a[26][Symbol.for("children")][0],r=a[22];const $t={};return a[27]=this.element({parent:r||"root"},o),$t.color="0x4d7c0fff",$t.x=40,$t.y=40,$t.w=40,$t.h=60,$t.parent=o[Symbol.for("slots")].filter(We=>We.ref==="second").shift()||o[Symbol.for("slots")][0]||r,$t.slot="second",a[27].populate($t),a},effects:[function(r,o,f,p,v,S){o[4].set("color",r.color)},function(r,o,f,p,v,S){o[13].set("color",r.color)},function(r,o,f,p,v,S){o[19].set("color",r.color)},function(r,o,f,p,v,S){o[24].set("color",r.color)}],context:{}},state(){return{color:Bl[0]}},hooks:{ready(){this.$setInterval(()=>{const h=Bl.indexOf(this.color)+1;this.color=h<=Bl.length?Bl[h]:Bl[0]},600)}}}),S5=at.Component("MemoryCard",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),m.w=320,m.h=200,m.x=o.col*360,m.y=o.row*250,m.scale={transition:o.scale},m.rotation={transition:o.disabled?-2:0},a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.h={transition:o.h},_.w=320,_.y=125,_.mount="{y: 0.5}",_.color={transition:o.disabled?"#ccc":"#fff"},_.src=o.image+"&w=320&h=200",_.effects=[o.shader("radius",{radius:6})],_.show=o.open,a[1].populate(_),r=a[0];const I={};return a[2]=this.element({parent:r||"root"},o),I.h={transition:o.h},I.w=320,I.y=125,I.mount="{y: 0.5}",I.color=o.open?"0x00000000":{top:"0xefefefff",bottom:"0xaaaaaaff"},I.effects=[o.shader("radius",{radius:6})],a[2].populate(I),a},effects:[function(r,o,f,p,v,S){o[0].set("scale",{transition:r.scale})},function(r,o,f,p,v,S){o[0].set("rotation",{transition:r.disabled?-2:0})},function(r,o,f,p,v,S){o[1].set("h",{transition:r.h})},function(r,o,f,p,v,S){o[1].set("color",{transition:r.disabled?"#ccc":"#fff"})},function(r,o,f,p,v,S){o[1].set("src",r.image+"&w=320&h=200")},function(r,o,f,p,v,S){o[1].set("effects",[r.shader("radius",{radius:6})])},function(r,o,f,p,v,S){o[1].set("show",r.open)},function(r,o,f,p,v,S){o[2].set("h",{transition:r.h})},function(r,o,f,p,v,S){o[2].set("color",r.open?"0x00000000":{top:"0xefefefff",bottom:"0xaaaaaaff"})},function(r,o,f,p,v,S){o[2].set("effects",[r.shader("radius",{radius:6})])}],context:{}},props:["row","col","image","description","index"],state(){return{disabled:!1,open:!1,h:200,scale:1}},hooks:{init(){this.$listen("closeMemoryCard",h=>{h===this.index&&this.$setTimeout(()=>this.flip(),1e3)}),this.$listen("deactivateMemoryCard",h=>{h===this.index&&(this.$setTimeout(()=>{this.scale=1.16},500),this.$setTimeout(()=>{this.disabled=!0,this.scale=1},800))})},focus(h){this.scale=1.08;const r="Card "+(this.index+1)+(this.disabled?" (disabled)":"");this.$announcer.speak(r)},unfocus(){this.scale=1}},input:{enter(){if(!this.disabled){if(this.open){this.$announcer.speak("Card already open. Choose another");return}this.flip(),this.$announcer.speak(`Image of a ${this.description}`),this.$emit("selectMemoryCard",this.index)}}},methods:{flip(){this.h=0,this.$setTimeout(()=>{this.open=!this.open,this.h=200},250)}}}),AS=[{image:"https://images.pexels.com/photos/106399/pexels-photo-106399.jpeg?auto=compress&cs=tinysrgb",description:"House"},{image:"https://images.pexels.com/photos/2902440/pexels-photo-2902440.jpeg?auto=compress&cs=tinysrgb",description:"Tree"},{image:"https://images.pexels.com/photos/686094/pexels-photo-686094.jpeg?auto=compress&cs=tinysrgb",description:"Dog"},{image:"https://images.pexels.com/photos/1302290/pexels-photo-1302290.jpeg?auto=compress&cs=tinysrgb",description:"Cat"},{image:"https://images.pexels.com/photos/627678/pexels-photo-627678.jpeg?auto=compress&cs=tinysrgb",description:"Car"},{image:"https://images.pexels.com/photos/1616566/pexels-photo-1616566.jpeg?auto=compress&cs=tinysrgb",description:"Bicycle"}],T5=at.Component("Announcer",{components:{MemoryCard:S5},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.font="raleway",I.size=80,I.color="0xffffffff",I.content="Let's play memory!",I.x=580,I.y=60,I.__textnode=!0,a[1].populate(I),r=a[0];const M={};a[2]=this.element({parent:r||"root"},o),M.font="kalam",M.size=40,M.color="0xb91c1cff",M.content="the Accessible edition :)",M.x=1200,M.y=170,M.rotation=-6,M.__textnode=!0,a[2].populate(M),r=a[0];const R={};a[3]=this.element({parent:r||"root"},o),R.x=260,R.y=260,a[3].populate(R),r=a[3];const U=[],x=(L=[],j,H)=>{const Y=S(L),Z=new Set;let X=Y.length;for(;X--;){const se=Y[X];Z.add(""+se.id)}let re=H.length;for(;re--;)if(Z.has(H[re])===!1){const se=H[re];j[4][se]&&j[4][se].destroy(),delete j[4][se],j[5][se]&&j[5][se].destroy(),delete j[5][se]}H.length=0;const le=Y.length;for(let se=0;se<le;se++){const W=Object.create(o);r=j[3],W.index=se,W.card=Y[se],W.key=""+W.card.id,H.push(W.key);const ce=f.components&&f.components.MemoryCard||p.MemoryCard;j[4]===void 0&&(j[4]={});const E={};j[4][W.key]===void 0&&(j[4][W.key]=this.element({parent:r||"root"},o)),E.col=W.index%4,E.row=Math.floor(W.index/4)%3,E.image=W.card.image,E.description=W.card.description,E.ref="card"+W.index,E.index=W.index;const F=[];if(typeof ce<"u")for(let ye in ce.config.props)delete E[ce.config.props[ye]],F.push(ce.config.props[ye]);j[4][W.key].nodeId===void 0&&j[4][W.key].populate(E),j[5]===void 0&&(j[5]={}),r=j[4][W.key];const ue={};if(j[5][W.key]===void 0){ue.col=W.index%4,ue.row=Math.floor(W.index/4)%3,ue.image=W.card.image,ue.description=W.card.description,ue.ref="card"+W.index,ue.index=W.index,m=ue.is||"MemoryCard";let ye;if(typeof m=="string"){if(ye=f.components&&f.components[m]||p[m],!ye)throw new Error('Component "MemoryCard" not found')}else typeof m=="function"&&m.name==="factory"&&(ye=m);j[5][W.key]=ye.call(null,{props:ue},j[4][W.key],o),j[5][W.key][Symbol.for("slots")][0]?(r=j[5][W.key][Symbol.for("slots")][0],o=j[5][W.key]):r=j[5][W.key][Symbol.for("children")][0]}v(()=>{(typeof F>"u"||F.indexOf("col")===-1)&&j[4][W.key].set("col",W.index%4)},"cards"),v(()=>{(typeof F>"u"||F.indexOf("row")===-1)&&j[4][W.key].set("row",Math.floor(W.index/4)%3)},"cards"),v(()=>{(typeof F>"u"||F.indexOf("ref")===-1)&&j[4][W.key].set("ref","card"+W.index)},"cards"),v(()=>{(typeof F>"u"||F.indexOf("index")===-1)&&j[4][W.key].set("index",W.index)},"cards"),j[5][W.key][Symbol.for("props")].col=W.index%4,j[5][W.key][Symbol.for("props")].row=Math.floor(W.index/4)%3,j[5][W.key][Symbol.for("props")].ref="card"+W.index,j[5][W.key][Symbol.for("props")].index=W.index}};return v(()=>{x(o.cards,a,U)},"cards"),a},effects:[],context:{}},state(){return{cards:AS.concat(AS).map((h,r)=>({...h,id:`card${r}`})),focusedRow:-1,focusedCol:-1,openCards:[],pairs:0}},hooks:{init(){this.shuffle(),this.$listen("selectMemoryCard",h=>{this.openCards.length<2&&this.openCards.push(h),this.openCards.length===2&&(this.cards[this.openCards[0]].description===this.cards[this.openCards[1]].description?(this.$emit("deactivateMemoryCard",this.openCards[0]),this.$emit("deactivateMemoryCard",this.openCards[1]),this.pairs++,this.$setTimeout(()=>{this.$announcer.speak(this.pairs===this.cards.length/2?"Congratulations, you found all pairs!":`You found a pair! ${this.cards.length/2-this.pairs} more to go.`)},1500)):(this.$emit("closeMemoryCard",this.openCards[0]),this.$emit("closeMemoryCard",this.openCards[1]),this.$setTimeout(()=>{this.$announcer.speak("No match. Try again")},1500)),this.openCards.length=0)})},destroy(){this.$announcer.speak("Thanks for playing Memory")}},watch:{focusedCol(h){if(this.focusedRow===-1){this.focusedRow=0;return}h=h+this.focusedRow*4,this.$select("card"+h).$focus()},focusedRow(h){if(this.focusedCol===-1){this.focusedCol=0;return}h=this.focusedCol+h*4,this.$select("card"+h).$focus()}},methods:{shuffle(){this.cards.sort(()=>.5-Math.random())}},input:{left(){this.focusedCol===0?this.focusedRow===0?this.$announcer.speak("You are already at the first card"):(this.focusedCol=3,this.focusedRow--):this.focusedCol=Math.max(0,this.focusedCol-1)},right(){this.focusedCol===3?this.focusedRow===2?this.$announcer.speak("You are already at the last card"):(this.focusedCol=0,this.focusedRow++):this.focusedCol=Math.min(3,this.focusedCol+1)},up(){this.focusedCol===0&&this.$announcer.speak("You are already at the first card"),this.focusedRow=Math.max(0,this.focusedRow-1)},down(){this.focusedRow===2&&this.$announcer.speak("You are already at the last card"),this.focusedRow=Math.min(2,this.focusedRow+1)}}}),jl=(h,r)=>Math.floor(Math.random()*(r-h+1)+h),C5=at.Component("Item",{code:{render:function(r,o,f,p,v,S){const a=[],m={};return a[0]=this.element({parent:r||"root"},o),m.src="assets/blits-b-small.png",m.w=96,m.h=168,m.x={transition:{value:o.x,duration:2900}},m.y={transition:{value:o.y,duration:2900}},m.rotation={transition:{value:o.rotation,duration:2900}},m.scale={transition:{value:o.scale,duration:1e3}},a[0].populate(m),a},effects:[function(r,o,f,p,v,S){o[0].set("x",{transition:{value:r.x,duration:2900}})},function(r,o,f,p,v,S){o[0].set("y",{transition:{value:r.y,duration:2900}})},function(r,o,f,p,v,S){o[0].set("rotation",{transition:{value:r.rotation,duration:2900}})},function(r,o,f,p,v,S){o[0].set("scale",{transition:{value:r.scale,duration:1e3}})}],context:{}},state(){return{x:jl(20,1560),y:jl(20,720),rotation:0,scale:.1}},hooks:{ready(){this.scale=1,this.$setInterval(()=>{this.scale=1,this.x=jl(20,1740),this.y=jl(20,900),this.rotation=jl(10,360)},3e3)}}}),E5=at.Component("Exponential",{components:{Item:C5},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I=[],M=(R=[],U,x)=>{const L=S(R),j=new Set;let H=L.length;for(;H--;){const X=L[H];j.add(""+X)}let Y=x.length;for(;Y--;)if(j.has(x[Y])===!1){const X=x[Y];U[1][X]&&U[1][X].destroy(),delete U[1][X],U[2][X]&&U[2][X].destroy(),delete U[2][X]}x.length=0;const Z=L.length;for(let X=0;X<Z;X++){const re=Object.create(o);r=U[0],re.index=X,re.item=L[X],re.key=""+re.item,x.push(re.key);const le=f.components&&f.components.Item||p.Item;U[1]===void 0&&(U[1]={});const se={};U[1][re.key]===void 0&&(U[1][re.key]=this.element({parent:r||"root"},o));const W=[];if(typeof le<"u")for(let E in le.config.props)delete se[le.config.props[E]],W.push(le.config.props[E]);U[1][re.key].nodeId===void 0&&U[1][re.key].populate(se),U[2]===void 0&&(U[2]={}),r=U[1][re.key];const ce={};if(U[2][re.key]===void 0){m=ce.is||"Item";let E;if(typeof m=="string"){if(E=f.components&&f.components[m]||p[m],!E)throw new Error('Component "Item" not found')}else typeof m=="function"&&m.name==="factory"&&(E=m);U[2][re.key]=E.call(null,{props:ce},U[1][re.key],o),U[2][re.key][Symbol.for("slots")][0]?(r=U[2][re.key][Symbol.for("slots")][0],o=U[2][re.key]):r=U[2][re.key][Symbol.for("children")][0]}}};return v(()=>{M(o.items,a,I)},"items"),a},effects:[],context:{}},state(){return{items:[]}},hooks:{ready(){const h=this.$setInterval(()=>{for(let r=0;r<=Math.floor(this.items.length/10);r++)this.items.push(`item${this.items.length}`);this.$log.info("# items",this.items.length),this.items.length>100&&clearInterval(h)},2e3)}}}),A5=at.Component("Ball",{code:{render:function(r,o,f,p,v,S){const a=[],m={};return a[0]=this.element({parent:r||"root"},o),m.w=100,m.h=100,m.src="/assets/basketball.png",a[0].populate(m),a},effects:[],context:{}},hooks:{attach(){this.$emit("ballUpdate","Attached to render tree")},detach(){this.$emit("ballUpdate","Detached from render tree")},enter(){this.$emit("ballUpdate","Entered viewport")},exit(){this.$emit("ballUpdate","Exited viewport")}}}),Bc=(h,r)=>Math.floor(Math.random()*(r-h+1)+h),k5=at.Component("Viewport",{components:{Ball:A5},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_),r=a[0];const I={};a[1]=this.element({parent:r||"root"},o),I.size=32,I.x=960,I.y=540,I.mount=.5,I.content=o.status.join(`
`),I.lineheight=52,I.wordwrap=500,I.__textnode=!0,a[1].populate(I);const M=f.components&&f.components.Ball||p.Ball;r=a[0];const R={};a[2]=this.element({parent:r||"root"},o),R.x={transition:{value:o.x,duration:1250}},R.y={transition:{value:o.y,duration:1250}},R.rotation={transition:{value:o.rotation,duration:1400,easing:"ease-in-out"}},R.w=100,R.h=100;const U=[];if(typeof M<"u")for(let j in M.config.props)delete R[M.config.props[j]],U.push(M.config.props[j]);a[2].populate(R),r=a[2];const x={};x.x={transition:{value:o.x,duration:1250}},x.y={transition:{value:o.y,duration:1250}},x.rotation={transition:{value:o.rotation,duration:1400,easing:"ease-in-out"}},x.w=100,x.h=100,m=x.is||"Ball";let L;if(typeof m=="string"){if(L=f.components&&f.components[m]||p[m],!L)throw new Error('Component "Ball" not found')}else typeof m=="function"&&m.name==="factory"&&(L=m);return a[3]=L.call(null,{props:x},a[2],o),a[3][Symbol.for("slots")][0]?(r=a[3][Symbol.for("slots")][0],o=a[3]):r=a[3][Symbol.for("children")][0],a},effects:[function(r,o,f,p,v,S){o[1].set("content",r.status.join(`
`))},function(r,o,f,p,v,S){(typeof skip2>"u"||skip2.indexOf("x")===-1)&&o[2].set("x",{transition:{value:r.x,duration:1250}})},function(r,o,f,p,v,S){(typeof skip2>"u"||skip2.indexOf("y")===-1)&&o[2].set("y",{transition:{value:r.y,duration:1250}})},function(r,o,f,p,v,S){(typeof skip2>"u"||skip2.indexOf("rotation")===-1)&&o[2].set("rotation",{transition:{value:r.rotation,duration:1400,easing:"ease-in-out"}})},function(r,o,f,p,v,S){o[3][Symbol.for("props")].x={transition:{value:r.x,duration:1250}}},function(r,o,f,p,v,S){o[3][Symbol.for("props")].y={transition:{value:r.y,duration:1250}}},function(r,o,f,p,v,S){o[3][Symbol.for("props")].rotation={transition:{value:r.rotation,duration:1400,easing:"ease-in-out"}}}],context:{}},state(){return{x:-400,y:-400,rotation:0,status:[],count:1}},hooks:{ready(){this.$listen("ballUpdate",h=>{this.status.unshift(`${this.count++} -  ${h}`),this.status.length=Math.min(this.status.length,8)}),this.rotation=Bc(-90,90),this.x=(1920-100)/2,this.y=(1080-100)/2,this.$setInterval(()=>{this.x=Bc(-300,2220),this.y=Bc(-300,1380),this.rotation=Bc(-90,90)},2500)}}}),b5=at.Component("Resize",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _={};a[1]=this.element({parent:r||"root"},o),_.y=30,_.content="fit (Resize Mode) sample",_.wordwrap=1920,_.align="center",_.__textnode=!0,a[1].populate(_),r=a[0];const I={};a[2]=this.element({parent:r||"root"},o),I.x={transition:{value:o.pages.x1,duration:200}},I.y=90,a[2].populate(I),r=a[2];const M={};a[3]=this.element({parent:r||"root"},o),M.x=100,M.content="Image dimensions: 2560 X 1440",M.__textnode=!0,a[3].populate(M),r=a[2];const R={};a[4]=this.element({parent:r||"root"},o),R.x=100,R.y=80,R.content=o.titles.t1,R.__textnode=!0,a[4].populate(R),r=a[2];const U={};a[5]=this.element({parent:r||"root"},o),U.y=150,U.x=100,a[5].populate(U),r=a[5];const x={};a[6]=this.element({parent:r||"root"},o),x.w=o.w,x.h=o.w-300,x.src=o.img,x.fit="{type: 'cover', position: { y: 0 } }",a[6].populate(x),r=a[5];const L={};a[7]=this.element({parent:r||"root"},o),L.w=o.w,L.h=o.w-300,L.src=o.img,L.fit="{ type: 'cover', position: { y: 0.5 } }",L.x=600,a[7].populate(L),r=a[5];const j={};a[8]=this.element({parent:r||"root"},o),j.w=o.w,j.h=o.w-300,j.src=o.img,j.fit="{ type: 'cover', position: { y: 1 } }",j.x=1200,a[8].populate(j),r=a[2];const H={};a[9]=this.element({parent:r||"root"},o),H.x=100,H.y=500,H.content=o.titles.t2,H.__textnode=!0,a[9].populate(H),r=a[2];const Y={};a[10]=this.element({parent:r||"root"},o),Y.y=600,Y.x=100,a[10].populate(Y),r=a[10];const Z={};a[11]=this.element({parent:r||"root"},o),Z.w=o.w,Z.h=o.w-150,Z.src=o.img,Z.fit="{ type: 'cover', position: { x: 0 } }",a[11].populate(Z),r=a[10];const X={};a[12]=this.element({parent:r||"root"},o),X.w=o.w,X.h=o.w-150,X.src=o.img,X.fit="{ type: 'cover', position: { x: 0.5 } }",X.x=600,a[12].populate(X),r=a[10];const re={};a[13]=this.element({parent:r||"root"},o),re.w=o.w,re.h=o.w-150,re.src=o.img,re.fit="{ type: 'cover', position: { x: 1 } }",re.x=1200,a[13].populate(re),r=a[0];const le={};a[14]=this.element({parent:r||"root"},o),le.x={transition:{value:o.pages.x2,duration:200}},le.y=90,a[14].populate(le),r=a[14];const se={};a[15]=this.element({parent:r||"root"},o),se.x=100,se.content="Image dimensions: 1440 X 2560",se.__textnode=!0,a[15].populate(se),r=a[14];const W={};a[16]=this.element({parent:r||"root"},o),W.x=100,W.y=80,W.content=o.titles.t3,W.__textnode=!0,a[16].populate(W),r=a[14];const ce={};a[17]=this.element({parent:r||"root"},o),ce.y=150,ce.x=100,a[17].populate(ce),r=a[17];const E={};a[18]=this.element({parent:r||"root"},o),E.w=o.w,E.h=o.w-200,E.src=o.img1,E.fit="{ type: 'cover', position: { y: 0, x: 0 } }",a[18].populate(E),r=a[17];const F={};a[19]=this.element({parent:r||"root"},o),F.w=o.w,F.h=o.w-200,F.src=o.img1,F.fit="{ type: 'cover', position: { y: 0.5, x: 0.5 } }",F.x=600,a[19].populate(F),r=a[17];const ue={};a[20]=this.element({parent:r||"root"},o),ue.w=o.w,ue.h=o.w-200,ue.src=o.img1,ue.fit="{ type: 'cover', position: { y: 1, x: 1 } }",ue.x=1200,a[20].populate(ue),r=a[14];const ye={};a[21]=this.element({parent:r||"root"},o),ye.x=100,ye.y=500,ye.content=o.titles.t4,ye.__textnode=!0,a[21].populate(ye),r=a[14];const ge={};a[22]=this.element({parent:r||"root"},o),ge.y=570,ge.x=100,a[22].populate(ge),r=a[22];const ie={};a[23]=this.element({parent:r||"root"},o),ie.w=o.w-350,ie.h=o.w-100,ie.src=o.img1,ie.fit="{ type: 'cover', position: { x: 0 } }",a[23].populate(ie),r=a[22];const ee={};a[24]=this.element({parent:r||"root"},o),ee.w=o.w-350,ee.h=o.w-100,ee.src=o.img1,ee.fit="{ type: 'cover', position: { x: 0.25 } }",ee.x=250,a[24].populate(ee),r=a[22];const de={};a[25]=this.element({parent:r||"root"},o),de.w=o.w-350,de.h=o.w-100,de.src=o.img1,de.fit="{ type: 'cover', position: { x: 0.5 } }",de.x=500,a[25].populate(de),r=a[22];const Ee={};a[26]=this.element({parent:r||"root"},o),Ee.w=o.w-350,Ee.h=o.w-100,Ee.src=o.img1,Ee.fit="{ type: 'cover', position: { x: 0.75 } }",Ee.x=750,a[26].populate(Ee),r=a[22];const Ie={};a[27]=this.element({parent:r||"root"},o),Ie.w=o.w-350,Ie.h=o.w-100,Ie.src=o.img1,Ie.fit="{ type: 'cover', position: { x: 1 } }",Ie.x=1e3,a[27].populate(Ie),r=a[0];const ke={};a[28]=this.element({parent:r||"root"},o),ke.x={transition:{value:o.pages.x3,duration:200}},ke.y=90,a[28].populate(ke),r=a[28];const Le={};a[29]=this.element({parent:r||"root"},o),Le.x=100,Le.content="Image dimensions: 2560 X 1440",Le.__textnode=!0,a[29].populate(Le),r=a[28];const _e={};a[30]=this.element({parent:r||"root"},o),_e.x=100,_e.y=80,_e.content=o.titles.t5,_e.__textnode=!0,a[30].populate(_e),r=a[28];const De={};a[31]=this.element({parent:r||"root"},o),De.y=150,De.x=100,De.w=o.w+100,De.h=o.w-200,De.color="0x000000ff",a[31].populate(De),r=a[31];const $={};a[32]=this.element({parent:r||"root"},o),$.w=o.w+100,$.h=o.w-200,$.src=o.img,$.fit="contain",a[32].populate($),r=a[28];const Pe={};a[33]=this.element({parent:r||"root"},o),Pe.x=100,Pe.y=500,Pe.content=o.titles.t6,Pe.__textnode=!0,a[33].populate(Pe),r=a[28];const He={};a[34]=this.element({parent:r||"root"},o),He.y=550,He.x=100,He.w=o.w+100,He.h=o.w-100,He.color="0x000000ff",a[34].populate(He),r=a[34];const Se={};a[35]=this.element({parent:r||"root"},o),Se.w=o.w+100,Se.h=o.w-100,Se.src=o.img,Se.fit="contain",a[35].populate(Se),r=a[0];const V={};return a[36]=this.element({parent:r||"root"},o),V.x=1700,V.y=20,V.content="Page "+o.activePage+"/"+o.totalPages,V.__textnode=!0,a[36].populate(V),a},effects:[function(r,o,f,p,v,S){o[2].set("x",{transition:{value:r.pages.x1,duration:200}})},function(r,o,f,p,v,S){o[3].set("content","Image dimensions: 2560 X 1440")},function(r,o,f,p,v,S){o[14].set("x",{transition:{value:r.pages.x2,duration:200}})},function(r,o,f,p,v,S){o[15].set("content","Image dimensions: 1440 X 2560")},function(r,o,f,p,v,S){o[28].set("x",{transition:{value:r.pages.x3,duration:200}})},function(r,o,f,p,v,S){o[29].set("content","Image dimensions: 2560 X 1440")},function(r,o,f,p,v,S){o[36].set("content","Page "+r.activePage+"/"+r.totalPages)}],context:{}},state(){return{activePage:1,pages:{x1:0,x2:1920,x3:1920*2},w:500,img:"assets/testscreen.png",img1:"assets/testscreen_rotated.png",titles:{t1:"Texture width > height - fit cover maximum width of node and position Y - 0, 0.5, 1",t2:"Texture width > height - fit:cover maximum width of node and position X - 0, 0.5, 1",t3:"Texture width < height - fit cover maximum width of node and positionY - 0, 0.5, 1",t4:"Texture width < height - fit cover maximum width of node and position X - 0, 0.25, 0.5, 0.75, 1",t5:"Texture width > height - fit contain maximum height of node",t6:"Texture width > height - fit contain maximum width of node"}}},computed:{totalPages(){return Object.keys(this.pages).length}},input:{right(){if(this.activePage<this.totalPages){for(let h=1;h<=this.totalPages;h++)this.pages[`x${h}`]=this.pages[`x${h}`]-1920;this.activePage+=1}},left(){if(this.activePage>1){for(let h=this.totalPages;h>=1;h--)this.pages[`x${h}`]=this.pages[`x${h}`]+1920;this.activePage-=1}}}}),I5=at.Component("Flags",{code:{render:function(r,o,f,p,v,S){const a=[],m={};a[0]=this.element({parent:r||"root"},o),a[0].populate(m),r=a[0];const _=[],I=(M=[],R,U)=>{const x=S(M),L=new Set;let j=x.length;for(;j--;)x[j],L.add(""+j);let H=U.length;for(;H--;)if(L.has(U[H])===!1){const Z=U[H];R[1][Z]&&R[1][Z].destroy(),delete R[1][Z],R[2][Z]&&R[2][Z].destroy(),delete R[2][Z],R[3][Z]&&R[3][Z].destroy(),delete R[3][Z]}U.length=0;const Y=x.length;for(let Z=0;Z<Y;Z++){const X=Object.create(o);r=R[0],X.index=Z,X.language=x[Z],X.key=""+Z,U.push(X.key),r=R[0],R[1]===void 0&&(R[1]={});const re={};R[1][X.key]===void 0&&(R[1][X.key]=this.element({parent:r||"root"},o)),re.x=X.index*250,R[1][X.key].nodeId===void 0&&R[1][X.key].populate(re),r=R[1][X.key],R[2]===void 0&&(R[2]={});const le={};R[2][X.key]===void 0&&(R[2][X.key]=this.element({parent:r||"root"},o)),le.src=X.language.flag,le.w=150,le.h=150,le.alpha=X.index===X.activeIndex?1:.6,R[2][X.key].nodeId===void 0&&R[2][X.key].populate(le),r=R[1][X.key],R[3]===void 0&&(R[3]={});const se={};R[3][X.key]===void 0&&(R[3][X.key]=this.element({parent:r||"root"},o)),se.content=X.language.name,se.y=150,se.wordwrap=150,se.align="center",se.color=X.index===X.activeIndex?"0xffffffff":"0xaaaaaaff",se.__textnode=!0,R[3][X.key].nodeId===void 0&&R[3][X.key].populate(se)}};return v(()=>{I(o.languages,a,_)},"languages"),v(()=>{o.activeIndex;for(let M=0;M<o.languages.length;M++){const R={};R.index=M,R.language=o.languages[M],R.key=M,a[2][R.key].set("alpha",R.index===o.activeIndex?1:.6)}}),v(()=>{o.activeIndex;for(let M=0;M<o.languages.length;M++){const R={};R.index=M,R.language=o.languages[M],R.key=M,a[3][R.key].set("color",R.index===o.activeIndex?"0xffffffff":"0xaaaaaaff")}}),a},effects:[],context:{}},props:["languages"],state(){return{activeIndex:0}},watch:{activeIndex(h){const r=this.languages[h];r&&r.code&&this.$language.set(r.code)}},input:{right(){this.activeIndex=Math.min(this.activeIndex+1,this.languages.length-1)},left(){this.activeIndex=Math.max(this.activeIndex-1,0)}}}),M5=at.Component("LanguagePlugin",{components:{Flags:I5},code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),a[0].populate(_);const I=f.components&&f.components.Flags||p.Flags;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o),M.languages=o.languages,M.ref="flags",M.x=500,M.y=150;const R=[];if(typeof I<"u")for(let Z in I.config.props)delete M[I.config.props[Z]],R.push(I.config.props[Z]);a[1].populate(M),r=a[1];const U={};U.languages=o.languages,U.ref="flags",U.x=500,U.y=150,m=U.is||"Flags";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "Flags" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0],r=a[0];const L={};a[3]=this.element({parent:r||"root"},o),L.x=960,L.y=540,L.mount=.5,L.content=o.$language.translate("hello"),L.size=80,L.__textnode=!0,a[3].populate(L),r=a[0];const j={};a[4]=this.element({parent:r||"root"},o),j.x=960,j.y=640,j.mount=.5,j.content=o.$language.translate("bye"),j.size=50,j.__textnode=!0,a[4].populate(j),r=a[0];const H={};a[5]=this.element({parent:r||"root"},o),H.x=960,H.y=720,H.mount=.5,H.content=o.$language.translate("replacement",{first:"John",last:"Doe",age:18}),H.size=36,H.__textnode=!0,a[5].populate(H),r=a[0];const Y={};return a[6]=this.element({parent:r||"root"},o),Y.size=32,Y.x=960,Y.y=940,Y.mount=.5,Y.align="center",Y.content="Current language: "+o.$language.language+`
 Language file: `+(o.loaded===!0?"Loaded":"loading ..."),Y.__textnode=!0,a[6].populate(Y),a},effects:[function(r,o,f,p,v,S){o[3].set("content",r.$language.translate("hello"))},function(r,o,f,p,v,S){o[4].set("content",r.$language.translate("bye"))},function(r,o,f,p,v,S){o[5].set("content",r.$language.translate("replacement",{first:"John",last:"Doe",age:18}))},function(r,o,f,p,v,S){o[6].set("content","Current language: "+r.$language.language+`
 Language file: `+(r.loaded===!0?"Loaded":"loading ..."))}],context:{}},state(){return{loaded:!1,languages:[{flag:"/assets/flags/united-states.png",code:"en-US",name:"English"},{flag:"/assets/flags/netherlands.png",code:"nl-NL",name:"Dutch"},{flag:"/assets/flags/france.png",code:"fr-FR",name:"French"},{flag:"/assets/flags/germany.png",code:"de-DE",name:"German"}]}},hooks:{init(){this.$language.set("en-US"),setTimeout(()=>{this.$language.load("/assets/translations.json").then(()=>{this.loaded=!0})},2e3)},focus(){this.select("flags").focus()}}}),R5=at.Application({code:{render:function(r,o,f,p,v,S){const a=[];let m;const _={};a[0]=this.element({parent:r||"root"},o),_.w=1920,_.h=1080,_.color=o.backgroundColor,a[0].populate(_);const I=f.components&&f.components.RouterView||p.RouterView;r=a[0];const M={};a[1]=this.element({parent:r||"root"},o);const R=[];if(typeof I<"u")for(let L in I.config.props)delete M[I.config.props[L]],R.push(I.config.props[L]);a[1].populate(M),r=a[1];const U={};m=U.is||"RouterView";let x;if(typeof m=="string"){if(x=f.components&&f.components[m]||p[m],!x)throw new Error('Component "RouterView" not found')}else typeof m=="function"&&m.name==="factory"&&(x=m);return a[2]=x.call(null,{props:U},a[1],o),a[2][Symbol.for("slots")][0]?(r=a[2][Symbol.for("slots")][0],o=a[2]):r=a[2][Symbol.for("children")][0],a},effects:[function(r,o,f,p,v,S){o[0].set("color",r.backgroundColor)}],context:{}},state(){return{backgroundColor:"#1e293b",showFPS:!0}},routes:[{path:"/",component:x_,options:{keepAlive:!0}},{path:"/demos/loading",component:()=>o_(()=>import("./Loading-6504d1d8.js"),[])},{path:"/demos/intro",component:()=>new Promise(h=>{h(S_)})},{path:"/demos/theming",component:E_},{path:"/demos/tmdb",component:O_},{path:"/demos/sprites",component:B_},{path:"/demos/focushandling",component:F_},{path:"/demos/memory-game",component:T5,announce:"Let's play Memory"},{path:"/demos/player",component:Q_},{path:"/examples/positioning",component:$_},{path:"/examples/colors",component:J_},{path:"/examples/gradients",component:e5},{path:"/examples/transitions",component:t5},{path:"/examples/alpha",component:n5},{path:"/examples/scaling",component:i5},{path:"/examples/rotation",component:o5},{path:"/examples/keyinput",component:r5},{path:"/examples/texts",component:s5},{path:"/examples/images",component:a5},{path:"/examples/components",component:l5},{path:"/examples/forloop",component:u5},{path:"/examples/forloop-advanced",component:p5},{path:"/examples/effects",component:g5},{path:"/examples/showif",component:m5},{path:"/examples/events",component:y5},{path:"/examples/slots",component:w5},{path:"/examples/viewport",component:k5},{path:"/examples/resize",component:b5},{path:"/examples/languageplugin",component:M5},{path:"/benchmarks/exponential",component:E5}],hooks:{ready(){this.$listen("changeBackground",h=>{this.backgroundColor=h?h+80:"#1e293b"}),this.$listen("clearBackground",()=>{this.backgroundColor="transparent"})}},input:{escape(){this.quit()},back(){this.$router.to("/")}}}),kS={light:{color1:"#f8fafc",color2:"#e2e8f0",color3:"#1e293b",color4:"#0369a1",bg:"#f1f5f9"},dark:{color1:"#475569",color2:"#64748b",color3:"#cbd5e1",color4:"#38bdf8",bg:"#1e293b80"}},bS={large:{w:1200,h:900,block1:{h:720},block2:{y:560,h:300,w:890},graph:{x:270,y:140,w:890,h:400,offset:110,size:"large"}},small:{w:500,h:600,block1:{h:180},block2:{y:140,h:180,w:200},graph:{x:32,y:370,w:0,h:0,offset:0,size:"small"}}};at.Plugin(uT,"colors",{themes:{light:kS.light,dark:kS.dark},base:"light",current:"dark"});at.Plugin(uT,"sizes",{themes:{small:bS.small,large:bS.large},base:"small",current:"small"});at.Plugin(JR);at.Launch(R5,"app",{w:1920,h:1080,multithreaded:!1,debugLevel:1,reactivityMode:"Proxy",keymap:t_(),fonts:[{family:"lato",type:"msdf",file:"fonts/Lato-Regular.ttf"},{family:"raleway",type:"msdf",file:"fonts/Raleway-ExtraBold.ttf"},{family:"opensans",type:"web",file:"fonts/OpenSans-Medium.ttf"},{family:"kalam",type:"msdf",file:"fonts/Kalam-Regular.ttf"}],canvasColor:"transparent",viewportMargin:100});export{at as B,da as S};
